/*! For license information please see main.69a63e80.js.LICENSE.txt */
!function(){var t={3361:function(t,e,n){"use strict";n.d(e,{Z:function(){return it}});var r=function(){function t(t){var e=this;this._insertTag=function(t){var n;n=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,n),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(r){0}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),i=Math.abs,o=String.fromCharCode,a=Object.assign;function s(t){return t.trim()}function l(t,e,n){return t.replace(e,n)}function u(t,e){return t.indexOf(e)}function c(t,e){return 0|t.charCodeAt(e)}function h(t,e,n){return t.slice(e,n)}function f(t){return t.length}function p(t){return t.length}function d(t,e){return e.push(t),t}var m=1,g=1,v=0,y=0,_=0,x="";function b(t,e,n,r,i,o,a){return{value:t,root:e,parent:n,type:r,props:i,children:o,line:m,column:g,length:a,return:""}}function w(t,e){return a(b("",null,null,"",null,null,0),t,{length:-t.length},e)}function S(){return _=y>0?c(x,--y):0,g--,10===_&&(g=1,m--),_}function E(){return _=y<v?c(x,y++):0,g++,10===_&&(g=1,m++),_}function k(){return c(x,y)}function C(){return y}function I(t,e){return h(x,t,e)}function T(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function P(t){return m=g=1,v=f(x=t),y=0,[]}function A(t){return x="",t}function M(t){return s(I(y-1,D(91===t?t+2:40===t?t+1:t)))}function L(t){for(;(_=k())&&_<33;)E();return T(t)>2||T(_)>3?"":" "}function R(t,e){for(;--e&&E()&&!(_<48||_>102||_>57&&_<65||_>70&&_<97););return I(t,C()+(e<6&&32==k()&&32==E()))}function D(t){for(;E();)switch(_){case t:return y;case 34:case 39:34!==t&&39!==t&&D(_);break;case 40:41===t&&D(t);break;case 92:E()}return y}function N(t,e){for(;E()&&t+_!==57&&(t+_!==84||47!==k()););return"/*"+I(e,y-1)+"*"+o(47===t?t:E())}function z(t){for(;!T(k());)E();return I(t,y)}var O="-ms-",F="-moz-",B="-webkit-",j="comm",U="rule",V="decl",Z="@keyframes";function q(t,e){for(var n="",r=p(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function G(t,e,n,r){switch(t.type){case"@import":case V:return t.return=t.return||t.value;case j:return"";case Z:return t.return=t.value+"{"+q(t.children,r)+"}";case U:t.value=t.props.join(",")}return f(n=q(t.children,r))?t.return=t.value+"{"+n+"}":""}function W(t){return A(X("",null,null,null,[""],t=P(t),0,[0],t))}function X(t,e,n,r,i,a,s,h,p){for(var m=0,g=0,v=s,y=0,_=0,x=0,b=1,w=1,I=1,T=0,P="",A=i,D=a,O=r,F=P;w;)switch(x=T,T=E()){case 40:if(108!=x&&58==c(F,v-1)){-1!=u(F+=l(M(T),"&","&\f"),"&\f")&&(I=-1);break}case 34:case 39:case 91:F+=M(T);break;case 9:case 10:case 13:case 32:F+=L(x);break;case 92:F+=R(C()-1,7);continue;case 47:switch(k()){case 42:case 47:d(Y(N(E(),C()),e,n),p);break;default:F+="/"}break;case 123*b:h[m++]=f(F)*I;case 125*b:case 59:case 0:switch(T){case 0:case 125:w=0;case 59+g:_>0&&f(F)-v&&d(_>32?$(F+";",r,n,v-1):$(l(F," ","")+";",r,n,v-2),p);break;case 59:F+=";";default:if(d(O=H(F,e,n,m,g,i,h,P,A=[],D=[],v),a),123===T)if(0===g)X(F,e,O,O,A,a,v,h,D);else switch(99===y&&110===c(F,3)?100:y){case 100:case 109:case 115:X(t,O,O,r&&d(H(t,O,O,0,0,i,h,P,i,A=[],v),D),i,D,v,h,r?A:D);break;default:X(F,O,O,O,[""],D,0,h,D)}}m=g=_=0,b=I=1,P=F="",v=s;break;case 58:v=1+f(F),_=x;default:if(b<1)if(123==T)--b;else if(125==T&&0==b++&&125==S())continue;switch(F+=o(T),T*b){case 38:I=g>0?1:(F+="\f",-1);break;case 44:h[m++]=(f(F)-1)*I,I=1;break;case 64:45===k()&&(F+=M(E())),y=k(),g=v=f(P=F+=z(C())),T++;break;case 45:45===x&&2==f(F)&&(b=0)}}return a}function H(t,e,n,r,o,a,u,c,f,d,m){for(var g=o-1,v=0===o?a:[""],y=p(v),_=0,x=0,w=0;_<r;++_)for(var S=0,E=h(t,g+1,g=i(x=u[_])),k=t;S<y;++S)(k=s(x>0?v[S]+" "+E:l(E,/&\f/g,v[S])))&&(f[w++]=k);return b(t,e,n,0===o?U:c,f,d,m)}function Y(t,e,n){return b(t,e,n,j,o(_),h(t,2,-2),0)}function $(t,e,n,r){return b(t,e,n,V,h(t,0,r),h(t,r+1,-1),r)}var K=function(t,e,n){for(var r=0,i=0;r=i,i=k(),38===r&&12===i&&(e[n]=1),!T(i);)E();return I(t,y)},J=function(t,e){return A(function(t,e){var n=-1,r=44;do{switch(T(r)){case 0:38===r&&12===k()&&(e[n]=1),t[n]+=K(y-1,e,n);break;case 2:t[n]+=M(r);break;case 4:if(44===r){t[++n]=58===k()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=o(r)}}while(r=E());return t}(P(t),e))},Q=new WeakMap,tt=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,n=t.parent,r=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||Q.get(n))&&!r){Q.set(t,!0);for(var i=[],o=J(e,i),a=n.props,s=0,l=0;s<o.length;s++)for(var u=0;u<a.length;u++,l++)t.props[l]=i[s]?o[s].replace(/&\f/g,a[u]):a[u]+" "+o[s]}}},et=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function nt(t,e){switch(function(t,e){return 45^c(t,0)?(((e<<2^c(t,0))<<2^c(t,1))<<2^c(t,2))<<2^c(t,3):0}(t,e)){case 5103:return"-webkit-print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return B+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return B+t+F+t+O+t+t;case 6828:case 4268:return B+t+O+t+t;case 6165:return B+t+O+"flex-"+t+t;case 5187:return B+t+l(t,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+t;case 5443:return B+t+O+"flex-item-"+l(t,/flex-|-self/,"")+t;case 4675:return B+t+O+"flex-line-pack"+l(t,/align-content|flex-|-self/,"")+t;case 5548:return B+t+O+l(t,"shrink","negative")+t;case 5292:return B+t+O+l(t,"basis","preferred-size")+t;case 6060:return"-webkit-box-"+l(t,"-grow","")+B+t+O+l(t,"grow","positive")+t;case 4554:return B+l(t,/([^-])(transform)/g,"$1-webkit-$2")+t;case 6187:return l(l(l(t,/(zoom-|grab)/,"-webkit-$1"),/(image-set)/,"-webkit-$1"),t,"")+t;case 5495:case 3959:return l(t,/(image-set\([^]*)/,"-webkit-$1$`$1");case 4968:return l(l(t,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+B+t+t;case 4095:case 3583:case 4068:case 2532:return l(t,/(.+)-inline(.+)/,"-webkit-$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(f(t)-1-e>6)switch(c(t,e+1)){case 109:if(45!==c(t,e+4))break;case 102:return l(t,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1-moz-"+(108==c(t,e+3)?"$3":"$2-$3"))+t;case 115:return~u(t,"stretch")?nt(l(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==c(t,e+1))break;case 6444:switch(c(t,f(t)-3-(~u(t,"!important")&&10))){case 107:return l(t,":",":-webkit-")+t;case 101:return l(t,/(.+:)([^;!]+)(;|!.+)?/,"$1-webkit-"+(45===c(t,14)?"inline-":"")+"box$3$1"+"-webkit-$2$3$1"+"-ms-$2box$3")+t}break;case 5936:switch(c(t,e+11)){case 114:return B+t+O+l(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return B+t+O+l(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return B+t+O+l(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return B+t+O+t+t}return t}var rt=[function(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case V:t.return=nt(t.value,t.length);break;case Z:return q([w(t,{value:l(t.value,"@","@-webkit-")})],r);case U:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=e.exec(t))?t[0]:t}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return q([w(t,{props:[l(e,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return q([w(t,{props:[l(e,/:(plac\w+)/,":-webkit-input-$1")]}),w(t,{props:[l(e,/:(plac\w+)/,":-moz-$1")]}),w(t,{props:[l(e,/:(plac\w+)/,"-ms-input-$1")]})],r)}return""}))}}],it=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var i=t.stylisPlugins||rt;var o,a,s={},l=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)s[e[n]]=!0;l.push(t)}));var u,c,h=[G,(c=function(t){u.insert(t)},function(t){t.root||(t=t.return)&&c(t)})],f=function(t){var e=p(t);return function(n,r,i,o){for(var a="",s=0;s<e;s++)a+=t[s](n,r,i,o)||"";return a}}([tt,et].concat(i,h));a=function(t,e,n,r){u=n,q(W(t?t+"{"+e.styles+"}":e.styles),f),r&&(d.inserted[e.name]=!0)};var d={key:e,sheet:new r({key:e,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:s,registered:{},insert:a};return d.sheet.hydrate(l),d}},9797:function(t,e){"use strict";e.Z=function(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}},9886:function(t,e,n){"use strict";n.d(e,{T:function(){return s},w:function(){return a}});var r=n(2791),i=n(3361),o=(n(9140),n(2561),(0,r.createContext)("undefined"!==typeof HTMLElement?(0,i.Z)({key:"css"}):null));o.Provider;var a=function(t){return(0,r.forwardRef)((function(e,n){var i=(0,r.useContext)(o);return t(e,i,n)}))},s=(0,r.createContext)({})},9140:function(t,e,n){"use strict";n.d(e,{O:function(){return m}});var r=function(t){for(var e,n=0,r=0,i=t.length;i>=4;++r,i-=4)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},i={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o=n(9797),a=/[A-Z]|^ms/g,s=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(t){return 45===t.charCodeAt(1)},u=function(t){return null!=t&&"boolean"!==typeof t},c=(0,o.Z)((function(t){return l(t)?t:t.replace(a,"-$&").toLowerCase()})),h=function(t,e){switch(t){case"animation":case"animationName":if("string"===typeof e)return e.replace(s,(function(t,e,n){return p={name:e,styles:n,next:p},e}))}return 1===i[t]||l(t)||"number"!==typeof e||0===e?e:e+"px"};function f(t,e,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return p={name:n.name,styles:n.styles,next:p},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)p={name:r.name,styles:r.styles,next:p},r=r.next;return n.styles+";"}return function(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=f(t,e,n[i])+";";else for(var o in n){var a=n[o];if("object"!==typeof a)null!=e&&void 0!==e[a]?r+=o+"{"+e[a]+"}":u(a)&&(r+=c(o)+":"+h(o,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=e&&void 0!==e[a[0]]){var s=f(t,e,a);switch(o){case"animation":case"animationName":r+=c(o)+":"+s+";";break;default:r+=o+"{"+s+"}"}}else for(var l=0;l<a.length;l++)u(a[l])&&(r+=c(o)+":"+h(o,a[l])+";")}return r}(t,e,n);case"function":if(void 0!==t){var i=p,o=n(t);return p=i,f(t,e,o)}}if(null==e)return n;var a=e[n];return void 0!==a?a:n}var p,d=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var m=function(t,e,n){if(1===t.length&&"object"===typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var i=!0,o="";p=void 0;var a=t[0];null==a||void 0===a.raw?(i=!1,o+=f(n,e,a)):o+=a[0];for(var s=1;s<t.length;s++)o+=f(n,e,t[s]),i&&(o+=a[s]);d.lastIndex=0;for(var l,u="";null!==(l=d.exec(o));)u+="-"+l[1];return{name:r(o)+u,styles:o,next:p}}},225:function(t,e,n){"use strict";n.d(e,{Z:function(){return _}});var r=n(2791),i=n(7462),o=n(9797),a=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,s=(0,o.Z)((function(t){return a.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),l=n(9886),u=n(5438),c=n(9140),h=n(2561),f=s,p=function(t){return"theme"!==t},d=function(t){return"string"===typeof t&&t.charCodeAt(0)>96?f:p},m=function(t,e,n){var r;if(e){var i=e.shouldForwardProp;r=t.__emotion_forwardProp&&i?function(e){return t.__emotion_forwardProp(e)&&i(e)}:i}return"function"!==typeof r&&n&&(r=t.__emotion_forwardProp),r},g=function(t){var e=t.cache,n=t.serialized,r=t.isStringTag;(0,u.hC)(e,n,r);(0,h.L)((function(){return(0,u.My)(e,n,r)}));return null},v=function t(e,n){var o,a,s=e.__emotion_real===e,h=s&&e.__emotion_base||e;void 0!==n&&(o=n.label,a=n.target);var f=m(e,n,s),p=f||d(h),v=!p("as");return function(){var y=arguments,_=s&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==o&&_.push("label:"+o+";"),null==y[0]||void 0===y[0].raw)_.push.apply(_,y);else{0,_.push(y[0][0]);for(var x=y.length,b=1;b<x;b++)_.push(y[b],y[0][b])}var w=(0,l.w)((function(t,e,n){var i=v&&t.as||h,o="",s=[],m=t;if(null==t.theme){for(var y in m={},t)m[y]=t[y];m.theme=(0,r.useContext)(l.T)}"string"===typeof t.className?o=(0,u.fp)(e.registered,s,t.className):null!=t.className&&(o=t.className+" ");var x=(0,c.O)(_.concat(s),e.registered,m);o+=e.key+"-"+x.name,void 0!==a&&(o+=" "+a);var b=v&&void 0===f?d(i):p,w={};for(var S in t)v&&"as"===S||b(S)&&(w[S]=t[S]);return w.className=o,w.ref=n,(0,r.createElement)(r.Fragment,null,(0,r.createElement)(g,{cache:e,serialized:x,isStringTag:"string"===typeof i}),(0,r.createElement)(i,w))}));return w.displayName=void 0!==o?o:"Styled("+("string"===typeof h?h:h.displayName||h.name||"Component")+")",w.defaultProps=e.defaultProps,w.__emotion_real=w,w.__emotion_base=h,w.__emotion_styles=_,w.__emotion_forwardProp=f,Object.defineProperty(w,"toString",{value:function(){return"."+a}}),w.withComponent=function(e,r){return t(e,(0,i.Z)({},n,r,{shouldForwardProp:m(w,r,!0)})).apply(void 0,_)},w}},y=v.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){y[t]=y(t)}));var _=y},2561:function(t,e,n){"use strict";var r;n.d(e,{L:function(){return a},j:function(){return s}});var i=n(2791),o=!!(r||(r=n.t(i,2))).useInsertionEffect&&(r||(r=n.t(i,2))).useInsertionEffect,a=o||function(t){return t()},s=o||i.useLayoutEffect},5438:function(t,e,n){"use strict";n.d(e,{My:function(){return o},fp:function(){return r},hC:function(){return i}});function r(t,e,n){var r="";return n.split(" ").forEach((function(n){void 0!==t[n]?e.push(t[n]+";"):r+=n+" "})),r}var i=function(t,e,n){var r=t.key+"-"+e.name;!1===n&&void 0===t.registered[r]&&(t.registered[r]=e.styles)},o=function(t,e,n){i(t,e,n);var r=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var o=e;do{t.insert(e===o?"."+r:"",o,t.sheet,!0);o=o.next}while(void 0!==o)}}},4434:function(t,e,n){t.exports=function(){"use strict";var t=function(t,e){var n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},r={on:function(t,e,r){if(void 0===n[t])throw new Error("Invalid event type: "+t);n[t].push({selector:e,fn:r})},render:function(t){e.store.featureChanged(t)}},i=function(t,i){for(var o=n[t],a=o.length;a--;){var s=o[a];if(s.selector(i)){s.fn.call(r,i)||e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(r),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),e.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(t){i("drag",t)},click:function(t){i("click",t)},mousemove:function(t){i("mousemove",t)},mousedown:function(t){i("mousedown",t)},mouseup:function(t){i("mouseup",t)},mouseout:function(t){i("mouseout",t)},keydown:function(t){i("keydown",t)},keyup:function(t){i("keyup",t)},touchstart:function(t){i("touchstart",t)},touchmove:function(t){i("touchmove",t)},touchend:function(t){i("touchend",t)},tap:function(t){i("tap",t)}}},e=6378137;function r(t){var e=0;if(t&&t.length>0){e+=Math.abs(i(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(i(t[n]))}return e}function i(t){var n,r,i,a,s,l,u=0,c=t.length;if(c>2){for(l=0;l<c;l++)l===c-2?(i=c-2,a=c-1,s=0):l===c-1?(i=c-1,a=0,s=1):(i=l,a=l+1,s=l+2),n=t[i],r=t[a],u+=(o(t[s][0])-o(n[0]))*Math.sin(o(r[1]));u=u*e*e/2}return u}function o(t){return t*Math.PI/180}var a={geometry:function t(e){var n,i=0;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=r(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},ring:i},s="mapboxgl-ctrl",l="mapbox-gl-draw_ctrl-draw-btn",u="mapbox-gl-draw_line",c="mapbox-gl-draw_polygon",h="mapbox-gl-draw_point",f="mapbox-gl-draw_trash",p="mapbox-gl-draw_combine",d="mapbox-gl-draw_uncombine",m="mapboxgl-ctrl-group",g="active",v="mapbox-gl-draw_boxselect",y="mapbox-gl-draw-hot",_="mapbox-gl-draw-cold",x="add",b="move",w="drag",S="pointer",E="none",k={POLYGON:"polygon",LINE:"line_string",POINT:"point"},C="Feature",I="Polygon",T="LineString",P="Point",A="FeatureCollection",M="Multi",L="MultiPoint",R="MultiLineString",D="MultiPolygon",N={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},z="draw.create",O="draw.delete",F="draw.update",B="draw.selectionchange",j="draw.modechange",U="draw.actionable",V="draw.render",Z="draw.combine",q="draw.uncombine",G="move",W="change_coordinates",X="feature",H="midpoint",Y="vertex",$="true",K="false",J=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Q={Point:0,LineString:1,Polygon:2};function tt(t,e){var n=Q[t.geometry.type]-Q[e.geometry.type];return 0===n&&t.geometry.type===I?t.area-e.area:n}function et(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,n=t.length;e<n;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}et.prototype.add=function(t){return this.has(t)||(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},et.prototype.delete=function(t){return!1===this.has(t)||(this._length--,delete this._items[t],delete this._nums[t]),this},et.prototype.has=function(t){return("string"==typeof t||"number"==typeof t)&&(void 0!==this._items[t]||void 0!==this._nums[t])},et.prototype.values=function(){var t=this,e=[];return Object.keys(this._items).forEach((function(n){e.push({k:n,v:t._items[n]})})),Object.keys(this._nums).forEach((function(n){e.push({k:JSON.parse(n),v:t._nums[n]})})),e.sort((function(t,e){return t.v-e.v})).map((function(t){return t.k}))},et.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var nt=[X,H,Y],rt={click:function(t,e,n){return it(t,e,n,n.options.clickBuffer)},touch:function(t,e,n){return it(t,e,n,n.options.touchBuffer)}};function it(t,e,n,r){if(null===n.map)return[];var i=t?function(t,e){return void 0===e&&(e=0),[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}(t,r):e,o={};n.options.styles&&(o.layers=n.options.styles.map((function(t){return t.id})));var s=n.map.queryRenderedFeatures(i,o).filter((function(t){return-1!==nt.indexOf(t.properties.meta)})),l=new et,u=[];return s.forEach((function(t){var e=t.properties.id;l.has(e)||(l.add(e),u.push(t))})),function(t){return t.map((function(t){return t.geometry.type===I&&(t.area=a.geometry({type:C,property:{},geometry:t.geometry})),t})).sort(tt).map((function(t){return delete t.area,t}))}(u)}function ot(t,e){var n=rt.click(t,null,e),r={mouse:E};return n[0]&&(r.mouse=n[0].properties.active===$?b:S,r.feature=n[0].properties.meta),-1!==e.events.currentModeName().indexOf("draw")&&(r.mouse=x),e.ui.queueMapClasses(r),e.ui.updateMapClasses(),n[0]}function at(t,e){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function st(t,e,n){void 0===n&&(n={});var r=null!=n.fineTolerance?n.fineTolerance:4,i=null!=n.grossTolerance?n.grossTolerance:12,o=null!=n.interval?n.interval:500;t.point=t.point||e.point,t.time=t.time||e.time;var a=at(t.point,e.point);return a<r||a<i&&e.time-t.time<o}function lt(t,e,n){void 0===n&&(n={});var r=null!=n.tolerance?n.tolerance:25,i=null!=n.interval?n.interval:250;return t.point=t.point||e.point,t.time=t.time||e.time,at(t.point,e.point)<r&&e.time-t.time<i}function ut(t,e){return t(e={exports:{}},e.exports),e.exports}var ct=ut((function(t){var e=t.exports=function(t,n){if(n||(n=16),void 0===t&&(t=128),t<=0)return"0";for(var r=Math.log(Math.pow(2,t))/Math.log(n),i=2;r===1/0;i*=2)r=Math.log(Math.pow(2,t/i))/Math.log(n)*i;var o=r-Math.floor(r),a="";for(i=0;i<Math.floor(r);i++)a=Math.floor(Math.random()*n).toString(n)+a;if(o){var s=Math.pow(n,o);a=Math.floor(Math.random()*s).toString(n)+a}var l=parseInt(a,n);return l!==1/0&&l>=Math.pow(2,t)?e(t,n):a};e.rack=function(t,n,r){var i=function(i){var a=0;do{if(a++>10){if(!r)throw new Error("too many ID collisions, use more bits");t+=r}var s=e(t,n)}while(Object.hasOwnProperty.call(o,s));return o[s]=i,s},o=i.hats={};return i.get=function(t){return i.hats[t]},i.set=function(t,e){return i.hats[t]=e,i},i.bits=t||128,i.base=n||16,i}})),ht=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||ct(),this.type=e.geometry.type};ht.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},ht.prototype.incomingCoords=function(t){this.setCoordinates(t)},ht.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},ht.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},ht.prototype.setProperty=function(t,e){this.properties[t]=e},ht.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:C,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},ht.prototype.internal=function(t){var e={id:this.id,meta:X,"meta:type":this.type,active:K,mode:t};if(this.ctx.options.userProperties)for(var n in this.properties)e["user_"+n]=this.properties[n];return{type:C,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var ft=function(t,e){ht.call(this,t,e)};(ft.prototype=Object.create(ht.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},ft.prototype.updateCoordinate=function(t,e,n){this.coordinates=3===arguments.length?[e,n]:[t,e],this.changed()},ft.prototype.getCoordinate=function(){return this.getCoordinates()};var pt=function(t,e){ht.call(this,t,e)};(pt.prototype=Object.create(ht.prototype)).isValid=function(){return this.coordinates.length>1},pt.prototype.addCoordinate=function(t,e,n){this.changed();var r=parseInt(t,10);this.coordinates.splice(r,0,[e,n])},pt.prototype.getCoordinate=function(t){var e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},pt.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},pt.prototype.updateCoordinate=function(t,e,n){var r=parseInt(t,10);this.coordinates[r]=[e,n],this.changed()};var dt=function(t,e){ht.call(this,t,e),this.coordinates=this.coordinates.map((function(t){return t.slice(0,-1)}))};(dt.prototype=Object.create(ht.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every((function(t){return t.length>2}))},dt.prototype.incomingCoords=function(t){this.coordinates=t.map((function(t){return t.slice(0,-1)})),this.changed()},dt.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},dt.prototype.addCoordinate=function(t,e,n){this.changed();var r=t.split(".").map((function(t){return parseInt(t,10)}));this.coordinates[r[0]].splice(r[1],0,[e,n])},dt.prototype.removeCoordinate=function(t){this.changed();var e=t.split(".").map((function(t){return parseInt(t,10)})),n=this.coordinates[e[0]];n&&(n.splice(e[1],1),n.length<3&&this.coordinates.splice(e[0],1))},dt.prototype.getCoordinate=function(t){var e=t.split(".").map((function(t){return parseInt(t,10)})),n=this.coordinates[e[0]];return JSON.parse(JSON.stringify(n[e[1]]))},dt.prototype.getCoordinates=function(){return this.coordinates.map((function(t){return t.concat([t[0]])}))},dt.prototype.updateCoordinate=function(t,e,n){this.changed();var r=t.split("."),i=parseInt(r[0],10),o=parseInt(r[1],10);void 0===this.coordinates[i]&&(this.coordinates[i]=[]),this.coordinates[i][o]=[e,n]};var mt={MultiPoint:ft,MultiLineString:pt,MultiPolygon:dt},gt=function(t,e,n,r,i){var o=n.split("."),a=parseInt(o[0],10),s=o[1]?o.slice(1).join("."):null;return t[a][e](s,r,i)},vt=function(t,e){if(ht.call(this,t,e),delete this.coordinates,this.model=mt[e.geometry.type],void 0===this.model)throw new TypeError(e.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(e.geometry.coordinates)};function yt(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t}(vt.prototype=Object.create(ht.prototype))._coordinatesToFeatures=function(t){var e=this,n=this.model.bind(this);return t.map((function(t){return new n(e.ctx,{id:ct(),type:C,properties:{},geometry:{coordinates:t,type:e.type.replace("Multi","")}})}))},vt.prototype.isValid=function(){return this.features.every((function(t){return t.isValid()}))},vt.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},vt.prototype.getCoordinate=function(t){return gt(this.features,"getCoordinate",t)},vt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(t){return t.type===I?t.getCoordinates():t.coordinates}))))},vt.prototype.updateCoordinate=function(t,e,n){gt(this.features,"updateCoordinate",t,e,n),this.changed()},vt.prototype.addCoordinate=function(t,e,n){gt(this.features,"addCoordinate",t,e,n),this.changed()},vt.prototype.removeCoordinate=function(t){gt(this.features,"removeCoordinate",t),this.changed()},vt.prototype.getFeatures=function(){return this.features},yt.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},yt.prototype.setSelectedCoordinates=function(t){var e=this;this._ctx.store.setSelectedCoordinates(t),t.reduce((function(t,n){return void 0===t[n.feature_id]&&(t[n.feature_id]=!0,e._ctx.store.get(n.feature_id).changed()),t}),{})},yt.prototype.getSelected=function(){return this._ctx.store.getSelected()},yt.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},yt.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},yt.prototype.getFeature=function(t){return this._ctx.store.get(t)},yt.prototype.select=function(t){return this._ctx.store.select(t)},yt.prototype.deselect=function(t){return this._ctx.store.deselect(t)},yt.prototype.deleteFeature=function(t,e){return void 0===e&&(e={}),this._ctx.store.delete(t,e)},yt.prototype.addFeature=function(t){return this._ctx.store.add(t)},yt.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},yt.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},yt.prototype.setActionableState=function(t){void 0===t&&(t={});var e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)},yt.prototype.changeMode=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),this._ctx.events.changeMode(t,e,n)},yt.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},yt.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},yt.prototype.featuresAt=function(t,e,n){if(void 0===n&&(n="click"),"click"!==n&&"touch"!==n)throw new Error("invalid buffer type");return rt[n](t,e,this._ctx)},yt.prototype.newFeature=function(t){var e=t.geometry.type;return e===P?new ft(this._ctx,t):e===T?new pt(this._ctx,t):e===I?new dt(this._ctx,t):new vt(this._ctx,t)},yt.prototype.isInstanceOf=function(t,e){if(t===P)return e instanceof ft;if(t===T)return e instanceof pt;if(t===I)return e instanceof dt;if("MultiFeature"===t)return e instanceof vt;throw new Error("Unknown feature class: "+t)},yt.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)},yt.prototype.onSetup=function(){},yt.prototype.onDrag=function(){},yt.prototype.onClick=function(){},yt.prototype.onMouseMove=function(){},yt.prototype.onMouseDown=function(){},yt.prototype.onMouseUp=function(){},yt.prototype.onMouseOut=function(){},yt.prototype.onKeyUp=function(){},yt.prototype.onKeyDown=function(){},yt.prototype.onTouchStart=function(){},yt.prototype.onTouchMove=function(){},yt.prototype.onTouchEnd=function(){},yt.prototype.onTap=function(){},yt.prototype.onStop=function(){},yt.prototype.onTrash=function(){},yt.prototype.onCombineFeature=function(){},yt.prototype.onUncombineFeature=function(){},yt.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var _t={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},xt=Object.keys(_t);function bt(t){var e=Object.keys(t);return function(n,r){void 0===r&&(r={});var i={},o=e.reduce((function(e,n){return e[n]=t[n],e}),new yt(n));return{start:function(){var e=this;i=o.onSetup(r),xt.forEach((function(n){var r,a=_t[n],s=function(){return!1};t[a]&&(s=function(){return!0}),e.on(n,s,(r=a,function(t){return o[r](i,t)}))}))},stop:function(){o.onStop(i)},trash:function(){o.onTrash(i)},combineFeatures:function(){o.onCombineFeatures(i)},uncombineFeatures:function(){o.onUncombineFeatures(i)},render:function(t,e){o.toDisplayFeatures(i,t,e)}}}}function wt(t){return[].concat(t).filter((function(t){return void 0!==t}))}function St(){var t=this;if(!t.ctx.map||void 0===t.ctx.map.getSource(y))return l();var e=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:e});var n=[],r=[];t.isDirty?r=t.getAllIds():(n=t.getChangedIds().filter((function(e){return void 0!==t.get(e)})),r=t.sources.hot.filter((function(e){return e.properties.id&&-1===n.indexOf(e.properties.id)&&void 0!==t.get(e.properties.id)})).map((function(t){return t.properties.id}))),t.sources.hot=[];var i=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter((function(t){var e=t.properties.id||t.properties.parent;return-1===n.indexOf(e)}));var o=i!==t.sources.cold.length||r.length>0;function a(n,r){var i=t.get(n).internal(e);t.ctx.events.currentModeRender(i,(function(e){t.sources[r].push(e)}))}if(n.forEach((function(t){return a(t,"hot")})),r.forEach((function(t){return a(t,"cold")})),o&&t.ctx.map.getSource(_).setData({type:A,features:t.sources.cold}),t.ctx.map.getSource(y).setData({type:A,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(B,{features:t.getSelected().map((function(t){return t.toGeoJSON()})),points:t.getSelectedCoordinates().map((function(t){return{type:C,properties:{},geometry:{type:P,coordinates:t.coordinates}}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){var s=t._deletedFeaturesToEmit.map((function(t){return t.toGeoJSON()}));t._deletedFeaturesToEmit=[],t.ctx.map.fire(O,{features:s})}function l(){t.isDirty=!1,t.clearChangedIds()}l(),t.ctx.map.fire(V,{})}function Et(t){var e,n=this;this._features={},this._featureIds=new et,this._selectedFeatureIds=new et,this._selectedCoordinates=[],this._changedFeatureIds=new et,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=function(){e||(e=requestAnimationFrame((function(){e=null,St.call(n)})))},this.isDirty=!1}function kt(t,e){var n=t._selectedCoordinates.filter((function(e){return t._selectedFeatureIds.has(e.feature_id)}));t._selectedCoordinates.length===n.length||e.silent||(t._emitSelectionChange=!0),t._selectedCoordinates=n}Et.prototype.createRenderBatch=function(){var t=this,e=this.render,n=0;return this.render=function(){n++},function(){t.render=e,n>0&&t.render()}},Et.prototype.setDirty=function(){return this.isDirty=!0,this},Et.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this},Et.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Et.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Et.prototype.getAllIds=function(){return this._featureIds.values()},Et.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this},Et.prototype.delete=function(t,e){var n=this;return void 0===e&&(e={}),wt(t).forEach((function(t){n._featureIds.has(t)&&(n._featureIds.delete(t),n._selectedFeatureIds.delete(t),e.silent||-1===n._deletedFeaturesToEmit.indexOf(n._features[t])&&n._deletedFeaturesToEmit.push(n._features[t]),delete n._features[t],n.isDirty=!0)})),kt(this,e),this},Et.prototype.get=function(t){return this._features[t]},Et.prototype.getAll=function(){var t=this;return Object.keys(this._features).map((function(e){return t._features[e]}))},Et.prototype.select=function(t,e){var n=this;return void 0===e&&(e={}),wt(t).forEach((function(t){n._selectedFeatureIds.has(t)||(n._selectedFeatureIds.add(t),n._changedFeatureIds.add(t),e.silent||(n._emitSelectionChange=!0))})),this},Et.prototype.deselect=function(t,e){var n=this;return void 0===e&&(e={}),wt(t).forEach((function(t){n._selectedFeatureIds.has(t)&&(n._selectedFeatureIds.delete(t),n._changedFeatureIds.add(t),e.silent||(n._emitSelectionChange=!0))})),kt(this,e),this},Et.prototype.clearSelected=function(t){return void 0===t&&(t={}),this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},Et.prototype.setSelected=function(t,e){var n=this;return void 0===e&&(e={}),t=wt(t),this.deselect(this._selectedFeatureIds.values().filter((function(e){return-1===t.indexOf(e)})),{silent:e.silent}),this.select(t.filter((function(t){return!n._selectedFeatureIds.has(t)})),{silent:e.silent}),this},Et.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},Et.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Et.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Et.prototype.getSelected=function(){var t=this;return this._selectedFeatureIds.values().map((function(e){return t.get(e)}))},Et.prototype.getSelectedCoordinates=function(){var t=this;return this._selectedCoordinates.map((function(e){return{coordinates:t.get(e.feature_id).getCoordinate(e.coord_path)}}))},Et.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},Et.prototype.setFeatureProperty=function(t,e,n){this.get(t).setProperty(e,n),this.featureChanged(t)},Et.prototype.storeMapConfig=function(){var t=this;J.forEach((function(e){t.ctx.map[e]&&(t._mapInitialConfig[e]=t.ctx.map[e].isEnabled())}))},Et.prototype.restoreMapConfig=function(){var t=this;Object.keys(this._mapInitialConfig).forEach((function(e){t._mapInitialConfig[e]?t.ctx.map[e].enable():t.ctx.map[e].disable()}))},Et.prototype.getInitialConfigValue=function(t){return void 0===this._mapInitialConfig[t]||this._mapInitialConfig[t]};var Ct=function(){for(var t=arguments,e={},n=0;n<arguments.length;n++){var r=t[n];for(var i in r)It.call(r,i)&&(e[i]=r[i])}return e},It=Object.prototype.hasOwnProperty,Tt=["mode","feature","mouse"];function Pt(e){var n=null,r=null,i={onRemove:function(){return e.map.off("load",i.connect),clearInterval(r),i.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,n&&n.parentNode&&n.parentNode.removeChild(n),n=null,this},connect:function(){e.map.off("load",i.connect),clearInterval(r),i.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){var a=o.fire;return o.fire=function(t,e){var n=arguments;return 1===a.length&&1!==arguments.length&&(n=[Ct({},{type:t},e)]),a.apply(o,n)},e.map=o,e.events=function(e){var n=Object.keys(e.options.modes).reduce((function(t,n){return t[n]=bt(e.options.modes[n]),t}),{}),r={},i={},o={},a=null,s=null;o.drag=function(t,n){n({point:t.point,time:(new Date).getTime()})?(e.ui.queueMapClasses({mouse:w}),s.drag(t)):t.originalEvent.stopPropagation()},o.mousedrag=function(t){o.drag(t,(function(t){return!st(r,t)}))},o.touchdrag=function(t){o.drag(t,(function(t){return!lt(i,t)}))},o.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return o.mousedrag(t);var n=ot(t,e);t.featureTarget=n,s.mousemove(t)},o.mousedown=function(t){r={time:(new Date).getTime(),point:t.point};var n=ot(t,e);t.featureTarget=n,s.mousedown(t)},o.mouseup=function(t){var n=ot(t,e);t.featureTarget=n,st(r,{point:t.point,time:(new Date).getTime()})?s.click(t):s.mouseup(t)},o.mouseout=function(t){s.mouseout(t)},o.touchstart=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled){i={time:(new Date).getTime(),point:t.point};var n=rt.touch(t,null,e)[0];t.featureTarget=n,s.touchstart(t)}},o.touchmove=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled)return s.touchmove(t),o.touchdrag(t)},o.touchend=function(t){if(t.originalEvent.preventDefault(),e.options.touchEnabled){var n=rt.touch(t,null,e)[0];t.featureTarget=n,lt(i,{time:(new Date).getTime(),point:t.point})?s.tap(t):s.touchend(t)}};var l=function(t){return!(8===t||46===t||t>=48&&t<=57)};function u(r,i,o){void 0===o&&(o={}),s.stop();var l=n[r];if(void 0===l)throw new Error(r+" is not valid");a=r;var u=l(e,i);s=t(u,e),o.silent||e.map.fire(j,{mode:r}),e.store.setDirty(),e.store.render()}o.keydown=function(t){"mapboxgl-canvas"===(t.srcElement||t.target).classList[0]&&(8!==t.keyCode&&46!==t.keyCode||!e.options.controls.trash?l(t.keyCode)?s.keydown(t):49===t.keyCode&&e.options.controls.point?u(N.DRAW_POINT):50===t.keyCode&&e.options.controls.line_string?u(N.DRAW_LINE_STRING):51===t.keyCode&&e.options.controls.polygon&&u(N.DRAW_POLYGON):(t.preventDefault(),s.trash()))},o.keyup=function(t){l(t.keyCode)&&s.keyup(t)},o.zoomend=function(){e.store.changeZoom()},o.data=function(t){if("style"===t.dataType){var n=e.setup,r=e.map,i=e.options,o=e.store;i.styles.some((function(t){return r.getLayer(t.id)}))||(n.addLayers(),o.setDirty(),o.render())}};var c={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){a=e.options.defaultMode,s=t(n[a](e),e)},changeMode:u,actionable:function(t){var n=!1;Object.keys(t).forEach((function(e){if(void 0===c[e])throw new Error("Invalid action type");c[e]!==t[e]&&(n=!0),c[e]=t[e]})),n&&e.map.fire(U,{actions:c})},currentModeName:function(){return a},currentModeRender:function(t,e){return s.render(t,e)},fire:function(t,e){o[t]&&o[t](e)},addEventListeners:function(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners:function(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash:function(t){s.trash(t)},combineFeatures:function(){s.combineFeatures()},uncombineFeatures:function(){s.uncombineFeatures()},getMode:function(){return a}}}(e),e.ui=function(t){var e={},n=null,r={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function o(t){i=Ct(i,t)}function a(){var e,n;if(t.container){var o=[],a=[];Tt.forEach((function(t){i[t]!==r[t]&&(o.push(t+"-"+r[t]),null!==i[t]&&a.push(t+"-"+i[t]))})),o.length>0&&(e=t.container.classList).remove.apply(e,o),a.length>0&&(n=t.container.classList).add.apply(n,a),r=Ct(r,i)}}function v(t,e){void 0===e&&(e={});var r=document.createElement("button");return r.className=l+" "+e.className,r.setAttribute("title",e.title),e.container.appendChild(r),r.addEventListener("click",(function(r){if(r.preventDefault(),r.stopPropagation(),r.target===n)return y(),void e.onDeactivate();_(t),e.onActivate()}),!0),r}function y(){n&&(n.classList.remove(g),n=null)}function _(t){y();var r=e[t];r&&r&&"trash"!==t&&(r.classList.add(g),n=r)}return{setActiveButton:_,queueMapClasses:o,updateMapClasses:a,clearMapClasses:function(){o({mode:null,feature:null,mouse:null}),a()},addButtons:function(){var n=t.options.controls,r=document.createElement("div");return r.className=m+" "+s,n?(n[k.LINE]&&(e[k.LINE]=v(k.LINE,{container:r,className:u,title:"LineString tool "+(t.options.keybindings?"(l)":""),onActivate:function(){return t.events.changeMode(N.DRAW_LINE_STRING)},onDeactivate:function(){return t.events.trash()}})),n[k.POLYGON]&&(e[k.POLYGON]=v(k.POLYGON,{container:r,className:c,title:"Polygon tool "+(t.options.keybindings?"(p)":""),onActivate:function(){return t.events.changeMode(N.DRAW_POLYGON)},onDeactivate:function(){return t.events.trash()}})),n[k.POINT]&&(e[k.POINT]=v(k.POINT,{container:r,className:h,title:"Marker tool "+(t.options.keybindings?"(m)":""),onActivate:function(){return t.events.changeMode(N.DRAW_POINT)},onDeactivate:function(){return t.events.trash()}})),n.trash&&(e.trash=v("trash",{container:r,className:f,title:"Delete",onActivate:function(){t.events.trash()}})),n.combine_features&&(e.combine_features=v("combineFeatures",{container:r,className:p,title:"Combine",onActivate:function(){t.events.combineFeatures()}})),n.uncombine_features&&(e.uncombine_features=v("uncombineFeatures",{container:r,className:d,title:"Uncombine",onActivate:function(){t.events.uncombineFeatures()}})),r):r},removeButtons:function(){Object.keys(e).forEach((function(t){var n=e[t];n.parentNode&&n.parentNode.removeChild(n),delete e[t]}))}}}(e),e.container=o.getContainer(),e.store=new Et(e),n=e.ui.addButtons(),e.options.boxSelect&&(o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?i.connect():(o.on("load",i.connect),r=setInterval((function(){o.loaded()&&i.connect()}),16)),e.events.start(),n},addLayers:function(){e.map.addSource(_,{data:{type:A,features:[]},type:"geojson"}),e.map.addSource(y,{data:{type:A,features:[]},type:"geojson"}),e.options.styles.forEach((function(t){e.map.addLayer(t)})),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach((function(t){e.map.getLayer(t.id)&&e.map.removeLayer(t.id)})),e.map.getSource(_)&&e.map.removeSource(_),e.map.getSource(y)&&e.map.removeSource(y)}};return e.setup=i,i}function At(t){return function(e){var n=e.featureTarget;return!!n&&!!n.properties&&n.properties.meta===t}}function Mt(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===$&&t.featureTarget.properties.meta===X}function Lt(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===K&&t.featureTarget.properties.meta===X}function Rt(t){return void 0===t.featureTarget}function Dt(t){var e=t.featureTarget;return!!e&&!!e.properties&&e.properties.meta===Y}function Nt(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey}function zt(t){return 27===t.keyCode}function Ot(t){return 13===t.keyCode}var Ft=Bt;function Bt(t,e){this.x=t,this.y=e}function jt(t,e){var n=e.getBoundingClientRect();return new Ft(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}function Ut(t,e,n,r){return{type:C,properties:{meta:Y,parent:t,coord_path:n,active:r?$:K},geometry:{type:P,coordinates:e}}}function Vt(t,e,n){void 0===e&&(e={}),void 0===n&&(n=null);var r,i=t.geometry,o=i.type,a=i.coordinates,s=t.properties&&t.properties.id,l=[];function u(t,n){var r="",i=null;t.forEach((function(t,o){var a=null!=n?n+"."+o:String(o),u=Ut(s,t,a,c(a));if(e.midpoints&&i){var h=function(t,e,n){var r=e.geometry.coordinates,i=n.geometry.coordinates;if(r[1]>85||r[1]<-85||i[1]>85||i[1]<-85)return null;var o={lng:(r[0]+i[0])/2,lat:(r[1]+i[1])/2};return{type:C,properties:{meta:H,parent:t,lng:o.lng,lat:o.lat,coord_path:n.properties.coord_path},geometry:{type:P,coordinates:[o.lng,o.lat]}}}(s,i,u);h&&l.push(h)}i=u;var f=JSON.stringify(t);r!==f&&l.push(u),0===o&&(r=f)}))}function c(t){return!!e.selectedPaths&&-1!==e.selectedPaths.indexOf(t)}return o===P?l.push(Ut(s,a,n,c(n))):o===I?a.forEach((function(t,e){u(t,null!==n?n+"."+e:String(e))})):o===T?u(a,n):0===o.indexOf(M)&&(r=o.replace(M,""),a.forEach((function(n,i){var o={type:C,properties:t.properties,geometry:{type:r,coordinates:n}};l=l.concat(Vt(o,e,i))}))),l}Bt.prototype={clone:function(){return new Bt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Bt.convert=function(t){return t instanceof Bt?t:Array.isArray(t)?new Bt(t[0],t[1]):t};var Zt=function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()}),0)},qt=function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()}),0)},Gt=function(t){if(!t||!t.type)return null;var e=Wt[t.type];return e?"geometry"===e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===e?{type:"FeatureCollection",features:[t]}:"featurecollection"===e?t:void 0:null},Wt={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Xt(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce((function(t,e){return t.concat(Xt(e))}),[]),t;case"Feature":return t.geometry?Xt(t.geometry).map((function(e){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:e};return void 0!==t.id&&(n.id=t.id),n})):[t];case"MultiPoint":return t.coordinates.map((function(t){return{type:"Point",coordinates:t}}));case"MultiPolygon":return t.coordinates.map((function(t){return{type:"Polygon",coordinates:t}}));case"MultiLineString":return t.coordinates.map((function(t){return{type:"LineString",coordinates:t}}));case"GeometryCollection":return t.geometries.map(Xt).reduce((function(t,e){return t.concat(e)}),[]);case"Point":case"Polygon":case"LineString":return[t]}}var Ht=function(t){if(!t)return[];var e=Xt(Gt(t)),n=[];return e.features.forEach((function(t){t.geometry&&(n=n.concat(function t(e){return Array.isArray(e)&&e.length&&"number"==typeof e[0]?[e]:e.reduce((function(e,n){return Array.isArray(n)&&Array.isArray(n[0])?e.concat(t(n)):(e.push(n),e)}),[])}(t.geometry.coordinates)))})),n},Yt=ut((function(t){var e=t.exports=function(t){return new n(t)};function n(t){this.value=t}function r(t,e,n){var r=[],a=[],c=!0;return function t(h){var f=n?i(h):h,p={},d=!0,m={node:f,node_:h,path:[].concat(r),parent:a[a.length-1],parents:a,key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(t,e){m.isRoot||(m.parent.node[m.key]=t),m.node=t,e&&(d=!1)},delete:function(t){delete m.parent.node[m.key],t&&(d=!1)},remove:function(t){s(m.parent.node)?m.parent.node.splice(m.key,1):delete m.parent.node[m.key],t&&(d=!1)},keys:null,before:function(t){p.before=t},after:function(t){p.after=t},pre:function(t){p.pre=t},post:function(t){p.post=t},stop:function(){c=!1},block:function(){d=!1}};if(!c)return m;function g(){if("object"==typeof m.node&&null!==m.node){m.keys&&m.node_===m.node||(m.keys=o(m.node)),m.isLeaf=0==m.keys.length;for(var t=0;t<a.length;t++)if(a[t].node_===h){m.circular=a[t];break}}else m.isLeaf=!0,m.keys=null;m.notLeaf=!m.isLeaf,m.notRoot=!m.isRoot}g();var v=e.call(m,m.node);return void 0!==v&&m.update&&m.update(v),p.before&&p.before.call(m,m.node),d?("object"!=typeof m.node||null===m.node||m.circular||(a.push(m),g(),l(m.keys,(function(e,i){r.push(e),p.pre&&p.pre.call(m,m.node[e],e);var o=t(m.node[e]);n&&u.call(m.node,e)&&(m.node[e]=o.node),o.isLast=i==m.keys.length-1,o.isFirst=0==i,p.post&&p.post.call(m,o),r.pop()})),a.pop()),p.after&&p.after.call(m,m.node),m):m}(t).node}function i(t){if("object"==typeof t&&null!==t){var e;if(s(t))e=[];else if("[object Date]"===a(t))e=new Date(t.getTime?t.getTime():t);else if(function(t){return"[object RegExp]"===a(t)}(t))e=new RegExp(t);else if(function(t){return"[object Error]"===a(t)}(t))e={message:t.message};else if(function(t){return"[object Boolean]"===a(t)}(t))e=new Boolean(t);else if(function(t){return"[object Number]"===a(t)}(t))e=new Number(t);else if(function(t){return"[object String]"===a(t)}(t))e=new String(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},r=function(){};r.prototype=n,e=new r}return l(o(t),(function(n){e[n]=t[n]})),e}return t}n.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!u.call(e,r)){e=void 0;break}e=e[r]}return e},n.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!u.call(e,r))return!1;e=e[r]}return!0},n.prototype.set=function(t,e){for(var n=this.value,r=0;r<t.length-1;r++){var i=t[r];u.call(n,i)||(n[i]={}),n=n[i]}return n[t[r]]=e,e},n.prototype.map=function(t){return r(this.value,t,!0)},n.prototype.forEach=function(t){return this.value=r(this.value,t,!1),this.value},n.prototype.reduce=function(t,e){var n=1===arguments.length,r=n?this.value:e;return this.forEach((function(e){this.isRoot&&n||(r=t.call(this,r,e))})),r},n.prototype.paths=function(){var t=[];return this.forEach((function(e){t.push(this.path)})),t},n.prototype.nodes=function(){var t=[];return this.forEach((function(e){t.push(this.node)})),t},n.prototype.clone=function(){var t=[],e=[];return function n(r){for(var a=0;a<t.length;a++)if(t[a]===r)return e[a];if("object"==typeof r&&null!==r){var s=i(r);return t.push(r),e.push(s),l(o(r),(function(t){s[t]=n(r[t])})),t.pop(),e.pop(),s}return r}(this.value)};var o=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};function a(t){return Object.prototype.toString.call(t)}var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},l=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)};l(o(n.prototype),(function(t){e[t]=function(e){var r=[].slice.call(arguments,1),i=new n(e);return i[t].apply(i,r)}}));var u=Object.hasOwnProperty||function(t,e){return e in t}})),$t=Kt;function Kt(t){if(!(this instanceof Kt))return new Kt(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}Kt.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},Kt.prototype.equals=function(t){var e;return e=t instanceof Kt?t.bbox():t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]},Kt.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Kt.prototype.union=function(t){var e;return this._valid=!0,e=t instanceof Kt?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},Kt.prototype.bbox=function(){return this._valid?this._bbox:null},Kt.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n},Kt.prototype.intersect=function(t){return this._valid?(e=t instanceof Kt?t.bbox():t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])):null;var e},Kt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)},Kt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Jt={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Qt=Object.keys(Jt),te=function(t){return ee(t).bbox()};function ee(t){for(var e=$t(),n=Ht(t),r=0;r<n.length;r++)e.include(n[r]);return e}function ne(t,e){var n=-90,r=90,i=-90,o=90,a=270,s=-270;t.forEach((function(t){var e=te(t),l=e[1],u=e[3],c=e[0],h=e[2];l>n&&(n=l),u<r&&(r=u),u>i&&(i=u),l<o&&(o=l),c<a&&(a=c),h>s&&(s=h)}));var l=e;return n+l.lat>85&&(l.lat=85-n),i+l.lat>90&&(l.lat=90-i),r+l.lat<-85&&(l.lat=-85-r),o+l.lat<-90&&(l.lat=-90-o),a+l.lng<=-270&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),s+l.lng>=270&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l}function re(t,e){var n=ne(t.map((function(t){return t.toGeoJSON()})),e);t.forEach((function(t){var e,r=t.getCoordinates(),i=function(t){var e={lng:t[0]+n.lng,lat:t[1]+n.lat};return[e.lng,e.lat]},o=function(t){return t.map((function(t){return i(t)}))};t.type===P?e=i(r):t.type===T||t.type===L?e=r.map(i):t.type===I||t.type===R?e=r.map(o):t.type===D&&(e=r.map((function(t){return t.map((function(t){return o(t)}))}))),t.incomingCoords(e)}))}te.polygon=function(t){return ee(t).polygon()},te.bboxify=function(t){return Yt(t).map((function(t){t&&Qt.some((function(e){return!!t[e]&&-1!==Jt[e].indexOf(t.type)}))&&(t.bbox=ee(t).bbox(),this.update(t))}))};var ie={onSetup:function(t){var e=this,n={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(n.initiallySelectedFeatureIds.filter((function(t){return void 0!==e.getFeature(t)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),n},fireUpdate:function(){this.map.fire(F,{action:G,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(){var t=this,e=this.getSelected(),n=e.filter((function(e){return t.isInstanceOf("MultiFeature",e)})),r=!1;if(e.length>1){r=!0;var i=e[0].type.replace("Multi","");e.forEach((function(t){t.type.replace("Multi","")!==i&&(r=!1)}))}var o=n.length>0,a=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:o,trash:a})},getUniqueIds:function(t){return t.length?t.map((function(t){return t.properties.id})).filter((function(t){return void 0!==t})).reduce((function(t,e){return t.add(e),t}),new et).values():[]},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){Zt(this)},onMouseMove:function(t){return this.stopExtendedInteractions(t),!0},onMouseOut:function(t){return!t.dragMoving||this.fireUpdate()}};ie.onTap=ie.onClick=function(t,e){return Rt(e)?this.clickAnywhere(t,e):At(Y)(e)?this.clickOnVertex(t,e):function(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.meta===X}(e)?this.clickOnFeature(t,e):void 0},ie.clickAnywhere=function(t){var e=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach((function(t){return e.doRender(t)}))),Zt(this),this.stopExtendedInteractions(t)},ie.clickOnVertex=function(t,e){this.changeMode(N.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:b})},ie.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},ie.clickOnFeature=function(t,e){var n=this;qt(this),this.stopExtendedInteractions(t);var r=Nt(e),i=this.getSelectedIds(),o=e.featureTarget.properties.id,a=this.isSelected(o);if(!r&&a&&this.getFeature(o).type!==P)return this.changeMode(N.DIRECT_SELECT,{featureId:o});a&&r?(this.deselect(o),this.updateUIClasses({mouse:S}),1===i.length&&Zt(this)):!a&&r?(this.select(o),this.updateUIClasses({mouse:b})):a||r||(i.forEach((function(t){return n.doRender(t)})),this.setSelected(o),this.updateUIClasses({mouse:b})),this.doRender(o)},ie.onMouseDown=function(t,e){return Mt(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&function(t){return!!t.originalEvent&&!!t.originalEvent.shiftKey&&0===t.originalEvent.button}(e)?this.startBoxSelect(t,e):void 0},ie.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=jt(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},ie.onTouchStart=function(t,e){if(Mt(e))return this.startOnActiveFeature(t,e)},ie.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},ie.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:x}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(v),this.map.getContainer().appendChild(t.boxSelectElement));var n=jt(e.originalEvent,this.map.getContainer()),r=Math.min(t.boxSelectStartLocation.x,n.x),i=Math.max(t.boxSelectStartLocation.x,n.x),o=Math.min(t.boxSelectStartLocation.y,n.y),a=Math.max(t.boxSelectStartLocation.y,n.y),s="translate("+r+"px, "+o+"px)";t.boxSelectElement.style.transform=s,t.boxSelectElement.style.WebkitTransform=s,t.boxSelectElement.style.width=i-r+"px",t.boxSelectElement.style.height=a-o+"px"},ie.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};re(this.getSelected(),n),t.dragMoveLocation=e.lngLat},ie.onMouseUp=function(t,e){var n=this;if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){var r=[t.boxSelectStartLocation,jt(e.originalEvent,this.map.getContainer())],i=this.featuresAt(null,r,"click"),o=this.getUniqueIds(i).filter((function(t){return!n.isSelected(t)}));o.length&&(this.select(o),o.forEach((function(t){return n.doRender(t)})),this.updateUIClasses({mouse:b}))}this.stopExtendedInteractions(t)},ie.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?$:K,n(e),this.fireActionable(),e.properties.active===$&&e.geometry.type!==P&&Vt(e).forEach(n)},ie.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},ie.onCombineFeatures=function(){var t=this.getSelected();if(!(0===t.length||t.length<2)){for(var e=[],n=[],r=t[0].type.replace("Multi",""),i=0;i<t.length;i++){var o=t[i];if(o.type.replace("Multi","")!==r)return;o.type.includes("Multi")?o.getCoordinates().forEach((function(t){e.push(t)})):e.push(o.getCoordinates()),n.push(o.toGeoJSON())}if(n.length>1){var a=this.newFeature({type:C,properties:n[0].properties,geometry:{type:"Multi"+r,coordinates:e}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.map.fire(Z,{createdFeatures:[a.toGeoJSON()],deletedFeatures:n})}this.fireActionable()}},ie.onUncombineFeatures=function(){var t=this,e=this.getSelected();if(0!==e.length){for(var n=[],r=[],i=function(i){var o=e[i];t.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((function(e){t.addFeature(e),e.properties=o.properties,n.push(e.toGeoJSON()),t.select([e.id])})),t.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))},o=0;o<e.length;o++)i(o);n.length>1&&this.map.fire(q,{createdFeatures:n,deletedFeatures:r}),this.fireActionable()}};var oe=At(Y),ae=At(H),se={fireUpdate:function(){this.map.fire(F,{action:W,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties,r=t.selectedCoordPaths.indexOf(n.coord_path);Nt(e)||-1!==r?Nt(e)&&-1===r&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path];var i=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(i)},onMidpoint:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties;t.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),t.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(t,e){return e.map((function(e){return{feature_id:t,coord_path:e}}))},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){re(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,n){for(var r=t.selectedCoordPaths.map((function(e){return t.feature.getCoordinate(e)})),i=ne(r.map((function(t){return{type:C,properties:{},geometry:{type:P,coordinates:t}}})),n),o=0;o<r.length;o++){var a=r[o];t.feature.updateCoordinate(t.selectedCoordPaths[o],a[0]+i.lng,a[1]+i.lat)}},clickNoTarget:function(){this.changeMode(N.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(N.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){var e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===P)throw new TypeError("direct_select mode doesn't handle point features");var r={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,r.selectedCoordPaths)),this.setSelected(e),qt(this),this.setActionableState({trash:!0}),r},onStop:function(){Zt(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=$,n(e),Vt(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=K,n(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort((function(t,e){return e.localeCompare(t,"en",{numeric:!0})})).forEach((function(e){return t.feature.removeCoordinate(e)})),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),!1===t.feature.isValid()&&(this.deleteFeature([t.featureId]),this.changeMode(N.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){var n=Mt(e),r=oe(e),i=0===t.selectedCoordPaths.length;return n&&i||r&&!i?this.updateUIClasses({mouse:b}):this.updateUIClasses({mouse:E}),this.stopDragging(t),!0},onMouseOut:function(t){return t.dragMoving&&this.fireUpdate(),!0}};se.onTouchStart=se.onMouseDown=function(t,e){return oe(e)?this.onVertex(t,e):Mt(e)?this.onFeature(t,e):ae(e)?this.onMidpoint(t,e):void 0},se.onDrag=function(t,e){if(!0===t.canDragMove){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat}},se.onClick=function(t,e){return Rt(e)?this.clickNoTarget(t,e):Mt(e)?this.clickActiveFeature(t,e):Lt(e)?this.clickInactive(t,e):void this.stopDragging(t)},se.onTap=function(t,e){return Rt(e)?this.clickNoTarget(t,e):Mt(e)?this.clickActiveFeature(t,e):Lt(e)?this.clickInactive(t,e):void 0},se.onTouchEnd=se.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)};var le={};function ue(t,e){return!!t.lngLat&&t.lngLat.lng===e[0]&&t.lngLat.lat===e[1]}le.onSetup=function(){var t=this.newFeature({type:C,properties:{},geometry:{type:P,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:x}),this.activateUIButton(k.POINT),this.setActionableState({trash:!0}),{point:t}},le.stopDrawingAndRemove=function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT)},le.onTap=le.onClick=function(t,e){this.updateUIClasses({mouse:b}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.map.fire(z,{features:[t.point.toGeoJSON()]}),this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.point.id]})},le.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},le.toDisplayFeatures=function(t,e,n){var r=e.properties.id===t.point.id;if(e.properties.active=r?$:K,!r)return n(e)},le.onTrash=le.stopDrawingAndRemove,le.onKeyUp=function(t,e){if(zt(e)||Ot(e))return this.stopDrawingAndRemove(t,e)};var ce={onSetup:function(){var t=this.newFeature({type:C,properties:{},geometry:{type:I,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),qt(this),this.updateUIClasses({mouse:x}),this.activateUIButton(k.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&ue(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:x}),t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),Dt(e)&&this.updateUIClasses({mouse:S})}};ce.onTap=ce.onClick=function(t,e){return Dt(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},ce.onKeyUp=function(t,e){zt(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT)):Ot(e)&&this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},ce.onStop=function(t){this.updateUIClasses({mouse:E}),Zt(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate("0."+t.currentVertexPosition),t.polygon.isValid()?this.map.fire(z,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT,{},{silent:!0})))},ce.toDisplayFeatures=function(t,e,n){var r=e.properties.id===t.polygon.id;if(e.properties.active=r?$:K,!r)return n(e);if(0!==e.geometry.coordinates.length){var i=e.geometry.coordinates[0].length;if(!(i<3)){if(e.properties.meta=X,n(Ut(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),i>3){var o=e.geometry.coordinates[0].length-3;n(Ut(t.polygon.id,e.geometry.coordinates[0][o],"0."+o,!1))}if(i<=4){var a=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:C,properties:e.properties,geometry:{coordinates:a,type:T}}),3===i)return}return n(e)}}},ce.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT)};var he={onSetup:function(t){var e,n,r=(t=t||{}).featureId,i="forward";if(r){if(!(e=this.getFeature(r)))throw new Error("Could not find a feature with the provided featureId");var o=t.from;if(o&&"Feature"===o.type&&o.geometry&&"Point"===o.geometry.type&&(o=o.geometry),o&&"Point"===o.type&&o.coordinates&&2===o.coordinates.length&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");var a=e.coordinates.length-1;if(e.coordinates[a][0]===o[0]&&e.coordinates[a][1]===o[1])n=a+1,e.addCoordinate.apply(e,[n].concat(e.coordinates[a]));else{if(e.coordinates[0][0]!==o[0]||e.coordinates[0][1]!==o[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");i="backwards",n=0,e.addCoordinate.apply(e,[n].concat(e.coordinates[0]))}}else e=this.newFeature({type:C,properties:{},geometry:{type:T,coordinates:[]}}),n=0,this.addFeature(e);return this.clearSelectedFeatures(),qt(this),this.updateUIClasses({mouse:x}),this.activateUIButton(k.LINE),this.setActionableState({trash:!0}),{line:e,currentVertexPosition:n,direction:i}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&ue(e,t.line.coordinates[t.currentVertexPosition-1])||"backwards"===t.direction&&ue(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:x}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),"forward"===t.direction?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),Dt(e)&&this.updateUIClasses({mouse:S})}};he.onTap=he.onClick=function(t,e){if(Dt(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},he.onKeyUp=function(t,e){Ot(e)?this.changeMode(N.SIMPLE_SELECT,{featureIds:[t.line.id]}):zt(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT))},he.onStop=function(t){Zt(this),this.activateUIButton(),void 0!==this.getFeature(t.line.id)&&(t.line.removeCoordinate(""+t.currentVertexPosition),t.line.isValid()?this.map.fire(z,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT,{},{silent:!0})))},he.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(N.SIMPLE_SELECT)},he.toDisplayFeatures=function(t,e,n){var r=e.properties.id===t.line.id;if(e.properties.active=r?$:K,!r)return n(e);e.geometry.coordinates.length<2||(e.properties.meta=X,n(Ut(t.line.id,e.geometry.coordinates["forward"===t.direction?e.geometry.coordinates.length-2:1],""+("forward"===t.direction?e.geometry.coordinates.length-2:1),!1)),n(e))};var fe={simple_select:ie,direct_select:se,draw_point:le,draw_polygon:ce,draw_line_string:he},pe={defaultMode:N.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:fe,controls:{},userProperties:!1},de={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},me={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ge(t,e){return t.map((function(t){return t.source?t:Ct(t,{id:t.id+"."+e,source:"hot"===e?y:_})}))}var ve=ut((function(t,e){var r="[object Arguments]",i="[object Map]",o="[object Object]",a="[object Set]",s=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[r]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u[i]=u["[object Number]"]=u[o]=u["[object RegExp]"]=u[a]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,f=c||h||Function("return this")(),p=e&&!e.nodeType&&e,d=p&&t&&!t.nodeType&&t,m=d&&d.exports===p,g=m&&c.process,v=function(){try{return g&&g.binding&&g.binding("util")}catch(t){}}(),y=v&&v.isTypedArray;function _(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function x(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function b(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var w,S,E,k=Array.prototype,C=Function.prototype,I=Object.prototype,T=f["__core-js_shared__"],P=C.toString,A=I.hasOwnProperty,M=(w=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",L=I.toString,R=RegExp("^"+P.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=m?f.Buffer:void 0,N=f.Symbol,z=f.Uint8Array,O=I.propertyIsEnumerable,F=k.splice,B=N?N.toStringTag:void 0,j=Object.getOwnPropertySymbols,U=D?D.isBuffer:void 0,V=(S=Object.keys,E=Object,function(t){return S(E(t))}),Z=vt(f,"DataView"),q=vt(f,"Map"),G=vt(f,"Promise"),W=vt(f,"Set"),X=vt(f,"WeakMap"),H=vt(Object,"create"),Y=bt(Z),$=bt(q),K=bt(G),J=bt(W),Q=bt(X),tt=N?N.prototype:void 0,et=tt?tt.valueOf:void 0;function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function rt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function it(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ot(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new it;++e<n;)this.add(t[e])}function at(t){var e=this.__data__=new rt(t);this.size=e.size}function st(t,e){var n=Et(t),r=!n&&St(t),i=!n&&!r&&kt(t),o=!n&&!r&&!i&&At(t),a=n||r||i||o,s=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],l=s.length;for(var u in t)!e&&!A.call(t,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||xt(u,l))||s.push(u);return s}function lt(t,e){for(var n=t.length;n--;)if(wt(t[n][0],e))return n;return-1}function ut(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":B&&B in Object(t)?function(t){var e=A.call(t,B),n=t[B];try{t[B]=void 0;var r=!0}catch(t){}var i=L.call(t);return r&&(e?t[B]=n:delete t[B]),i}(t):function(t){return L.call(t)}(t)}function ct(t){return Pt(t)&&ut(t)==r}function ht(t,e,n,s,l){return t===e||(null==t||null==e||!Pt(t)&&!Pt(e)?t!=t&&e!=e:function(t,e,n,s,l,u){var c=Et(t),h=Et(e),f=c?"[object Array]":_t(t),p=h?"[object Array]":_t(e),d=(f=f==r?o:f)==o,m=(p=p==r?o:p)==o,g=f==p;if(g&&kt(t)){if(!kt(e))return!1;c=!0,d=!1}if(g&&!d)return u||(u=new at),c||At(t)?dt(t,e,n,s,l,u):function(t,e,n,r,o,s,l){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new z(t),new z(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return wt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case i:var u=x;case a:var c=1&r;if(u||(u=b),t.size!=e.size&&!c)return!1;var h=l.get(t);if(h)return h==e;r|=2,l.set(t,e);var f=dt(u(t),u(e),r,o,s,l);return l.delete(t),f;case"[object Symbol]":if(et)return et.call(t)==et.call(e)}return!1}(t,e,f,n,s,l,u);if(!(1&n)){var v=d&&A.call(t,"__wrapped__"),y=m&&A.call(e,"__wrapped__");if(v||y){var _=v?t.value():t,w=y?e.value():e;return u||(u=new at),l(_,w,n,s,u)}}return!!g&&(u||(u=new at),function(t,e,n,r,i,o){var a=1&n,s=mt(t),l=s.length;if(l!=mt(e).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in e:A.call(e,c)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var f=!0;o.set(t,e),o.set(e,t);for(var p=a;++u<l;){var d=t[c=s[u]],m=e[c];if(r)var g=a?r(m,d,c,e,t,o):r(d,m,c,t,e,o);if(!(void 0===g?d===m||i(d,m,n,r,o):g)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,n,s,l,u))}(t,e,n,s,ht,l))}function ft(t){return!(!Tt(t)||function(t){return!!M&&M in t}(t))&&(Ct(t)?R:s).test(bt(t))}function pt(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||I))return V(t);var e,n,r=[];for(var i in Object(t))A.call(t,i)&&"constructor"!=i&&r.push(i);return r}function dt(t,e,n,r,i,o){var a=1&n,s=t.length,l=e.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,h=!0,f=2&n?new ot:void 0;for(o.set(t,e),o.set(e,t);++c<s;){var p=t[c],d=e[c];if(r)var m=a?r(d,p,c,e,t,o):r(p,d,c,t,e,o);if(void 0!==m){if(m)continue;h=!1;break}if(f){if(!_(e,(function(t,e){if(a=e,!f.has(a)&&(p===t||i(p,t,n,r,o)))return f.push(e);var a}))){h=!1;break}}else if(p!==d&&!i(p,d,n,r,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function mt(t){return function(t,e,n){var r=e(t);return Et(t)?r:function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}(r,n(t))}(t,Mt,yt)}function gt(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function vt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return ft(n)?n:void 0}nt.prototype.clear=function(){this.__data__=H?H(null):{},this.size=0},nt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},nt.prototype.get=function(t){var e=this.__data__;if(H){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return A.call(e,t)?e[t]:void 0},nt.prototype.has=function(t){var e=this.__data__;return H?void 0!==e[t]:A.call(e,t)},nt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=H&&void 0===e?"__lodash_hash_undefined__":e,this},rt.prototype.clear=function(){this.__data__=[],this.size=0},rt.prototype.delete=function(t){var e=this.__data__,n=lt(e,t);return!(n<0)&&(n==e.length-1?e.pop():F.call(e,n,1),--this.size,!0)},rt.prototype.get=function(t){var e=this.__data__,n=lt(e,t);return n<0?void 0:e[n][1]},rt.prototype.has=function(t){return lt(this.__data__,t)>-1},rt.prototype.set=function(t,e){var n=this.__data__,r=lt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},it.prototype.clear=function(){this.size=0,this.__data__={hash:new nt,map:new(q||rt),string:new nt}},it.prototype.delete=function(t){var e=gt(this,t).delete(t);return this.size-=e?1:0,e},it.prototype.get=function(t){return gt(this,t).get(t)},it.prototype.has=function(t){return gt(this,t).has(t)},it.prototype.set=function(t,e){var n=gt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},ot.prototype.add=ot.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ot.prototype.has=function(t){return this.__data__.has(t)},at.prototype.clear=function(){this.__data__=new rt,this.size=0},at.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},at.prototype.get=function(t){return this.__data__.get(t)},at.prototype.has=function(t){return this.__data__.has(t)},at.prototype.set=function(t,e){var n=this.__data__;if(n instanceof rt){var r=n.__data__;if(!q||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new it(r)}return n.set(t,e),this.size=n.size,this};var yt=j?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}(j(t),(function(e){return O.call(t,e)})))}:function(){return[]},_t=ut;function xt(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||l.test(t))&&t>-1&&t%1==0&&t<e}function bt(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function wt(t,e){return t===e||t!=t&&e!=e}(Z&&"[object DataView]"!=_t(new Z(new ArrayBuffer(1)))||q&&_t(new q)!=i||G&&"[object Promise]"!=_t(G.resolve())||W&&_t(new W)!=a||X&&"[object WeakMap]"!=_t(new X))&&(_t=function(t){var e=ut(t),n=e==o?t.constructor:void 0,r=n?bt(n):"";if(r)switch(r){case Y:return"[object DataView]";case $:return i;case K:return"[object Promise]";case J:return a;case Q:return"[object WeakMap]"}return e});var St=ct(function(){return arguments}())?ct:function(t){return Pt(t)&&A.call(t,"callee")&&!O.call(t,"callee")},Et=Array.isArray,kt=U||function(){return!1};function Ct(t){if(!Tt(t))return!1;var e=ut(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function It(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Tt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Pt(t){return null!=t&&"object"==typeof t}var At=y?function(t){return function(e){return t(e)}}(y):function(t){return Pt(t)&&It(t.length)&&!!u[ut(t)]};function Mt(t){return null!=(e=t)&&It(e.length)&&!Ct(e)?st(t):pt(t);var e}t.exports=function(t,e){return ht(t,e)}})),ye={Polygon:dt,LineString:pt,Point:ft,MultiPolygon:vt,MultiLineString:vt,MultiPoint:vt};function _e(t,e){return e.modes=N,e.getFeatureIdsAt=function(e){return rt.click({point:e},null,t).map((function(t){return t.properties.id}))},e.getSelectedIds=function(){return t.store.getSelectedIds()},e.getSelected=function(){return{type:A,features:t.store.getSelectedIds().map((function(e){return t.store.get(e)})).map((function(t){return t.toGeoJSON()}))}},e.getSelectedPoints=function(){return{type:A,features:t.store.getSelectedCoordinates().map((function(t){return{type:C,properties:{},geometry:{type:P,coordinates:t.coordinates}}}))}},e.set=function(n){if(void 0===n.type||n.type!==A||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");var r=t.store.createRenderBatch(),i=t.store.getAllIds().slice(),o=e.add(n),a=new et(o);return(i=i.filter((function(t){return!a.has(t)}))).length&&e.delete(i),r(),o},e.add=function(e){var n=JSON.parse(JSON.stringify(Gt(e))).features.map((function(e){if(e.id=e.id||ct(),null===e.geometry)throw new Error("Invalid geometry: null");if(void 0===t.store.get(e.id)||t.store.get(e.id).type!==e.geometry.type){var n=ye[e.geometry.type];if(void 0===n)throw new Error("Invalid geometry type: "+e.geometry.type+".");var r=new n(t,e);t.store.add(r)}else{var i=t.store.get(e.id);i.properties=e.properties,ve(i.getCoordinates(),e.geometry.coordinates)||i.incomingCoords(e.geometry.coordinates)}return e.id}));return t.store.render(),n},e.get=function(e){var n=t.store.get(e);if(n)return n.toGeoJSON()},e.getAll=function(){return{type:A,features:t.store.getAll().map((function(t){return t.toGeoJSON()}))}},e.delete=function(n){return t.store.delete(n,{silent:!0}),e.getMode()!==N.DIRECT_SELECT||t.store.getSelectedIds().length?t.store.render():t.events.changeMode(N.SIMPLE_SELECT,void 0,{silent:!0}),e},e.deleteAll=function(){return t.store.delete(t.store.getAllIds(),{silent:!0}),e.getMode()===N.DIRECT_SELECT?t.events.changeMode(N.SIMPLE_SELECT,void 0,{silent:!0}):t.store.render(),e},e.changeMode=function(n,r){return void 0===r&&(r={}),n===N.SIMPLE_SELECT&&e.getMode()===N.SIMPLE_SELECT?(i=r.featureIds||[],o=t.store.getSelectedIds(),i.length===o.length&&JSON.stringify(i.map((function(t){return t})).sort())===JSON.stringify(o.map((function(t){return t})).sort())||(t.store.setSelected(r.featureIds,{silent:!0}),t.store.render()),e):(n===N.DIRECT_SELECT&&e.getMode()===N.DIRECT_SELECT&&r.featureId===t.store.getSelectedIds()[0]||t.events.changeMode(n,r,{silent:!0}),e);var i,o},e.getMode=function(){return t.events.getMode()},e.trash=function(){return t.events.trash({silent:!0}),e},e.combineFeatures=function(){return t.events.combineFeatures({silent:!0}),e},e.uncombineFeatures=function(){return t.events.uncombineFeatures({silent:!0}),e},e.setFeatureProperty=function(n,r,i){return t.store.setFeatureProperty(n,r,i),e},e}var xe=function(t,e){var n={options:t=function(t){void 0===t&&(t={});var e=Ct(t);return t.controls||(e.controls={}),!1===t.displayControlsDefault?e.controls=Ct(me,t.controls):e.controls=Ct(de,t.controls),(e=Ct(pe,e)).styles=ge(e.styles,"cold").concat(ge(e.styles,"hot")),e}(t)};e=_e(n,e),n.api=e;var r=Pt(n);return e.onAdd=r.onAdd,e.onRemove=r.onRemove,e.types=k,e.options=t,e};function be(t){xe(t,this)}return be.modes=fe,be}()},1380:function(t){function e(t,e){var n=t.getCenter(),r=t.getZoom(),i=t.getBearing(),o=t.getPitch();e.forEach((function(t){t.jumpTo({center:n,zoom:r,bearing:i,pitch:o})}))}t.exports=function(){var t,n=arguments.length;if(1===n)t=arguments[0];else{t=[];for(var r=0;r<n;r++)t.push(arguments[r])}var i=[];function o(){t.forEach((function(t,e){t.on("move",i[e])}))}function a(){t.forEach((function(t,e){t.off("move",i[e])}))}function s(t,n){a(),e(t,n),o()}return t.forEach((function(e,n){i[n]=s.bind(null,e,t.filter((function(t,e){return e!==n})))})),o(),function(){a(),i=[]}}},2017:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");e.Z=a},3385:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");e.Z=a},9823:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");e.Z=a},9210:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"}),"DragHandle");e.Z=a},2885:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");e.Z=a},1131:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");e.Z=a},7267:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord");e.Z=a},5403:function(t,e,n){"use strict";var r=n(1941);e.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");e.Z=a},5649:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(8610)},1979:function(t,e,n){"use strict";n.d(e,{Z:function(){return z}});var r=n(2793),i=n(1048),o=n(6189),a=n(2466),s=n(5080),l=n(7416),u=n(104),c=n(4942);function h(t,e){var n;return(0,r.Z)({toolbar:(n={minHeight:56},(0,c.Z)(n,t.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),(0,c.Z)(n,t.up("sm"),{minHeight:64}),n)},e)}var f=n(2065),p={black:"#000",white:"#fff"},d={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},m={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},g={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},v={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},y={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},_={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},x={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},b=["mode","contrastThreshold","tonalOffset"],w={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:p.white,default:p.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},S={text:{primary:p.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:p.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function E(t,e,n,r){var i=r.light||r,o=r.dark||1.5*r;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:"light"===e?t.light=(0,f.$n)(t.main,i):"dark"===e&&(t.dark=(0,f._j)(t.main,o)))}function k(t){var e=t.mode,n=void 0===e?"light":e,s=t.contrastThreshold,l=void 0===s?3:s,u=t.tonalOffset,c=void 0===u?.2:u,h=(0,i.Z)(t,b),k=t.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:y[200],light:y[50],dark:y[400]}:{main:y[700],light:y[400],dark:y[800]}}(n),C=t.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:m[200],light:m[50],dark:m[400]}:{main:m[500],light:m[300],dark:m[700]}}(n),I=t.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:g[500],light:g[300],dark:g[700]}:{main:g[700],light:g[400],dark:g[800]}}(n),T=t.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:_[400],light:_[300],dark:_[700]}:{main:_[700],light:_[500],dark:_[900]}}(n),P=t.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:x[400],light:x[300],dark:x[700]}:{main:x[800],light:x[500],dark:x[900]}}(n),A=t.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:v[400],light:v[300],dark:v[700]}:{main:"#ed6c02",light:v[500],dark:v[900]}}(n);function M(t){return(0,f.mi)(t,S.text.primary)>=l?S.text.primary:w.text.primary}var L=function(t){var e=t.color,n=t.name,i=t.mainShade,a=void 0===i?500:i,s=t.lightShade,l=void 0===s?300:s,u=t.darkShade,h=void 0===u?700:u;if(!(e=(0,r.Z)({},e)).main&&e[a]&&(e.main=e[a]),!e.hasOwnProperty("main"))throw new Error((0,o.Z)(11,n?" (".concat(n,")"):"",a));if("string"!==typeof e.main)throw new Error((0,o.Z)(12,n?" (".concat(n,")"):"",JSON.stringify(e.main)));return E(e,"light",l,c),E(e,"dark",h,c),e.contrastText||(e.contrastText=M(e.main)),e},R={dark:S,light:w};return(0,a.Z)((0,r.Z)({common:(0,r.Z)({},p),mode:n,primary:L({color:k,name:"primary"}),secondary:L({color:C,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:L({color:I,name:"error"}),warning:L({color:A,name:"warning"}),info:L({color:T,name:"info"}),success:L({color:P,name:"success"}),grey:d,contrastThreshold:l,getContrastText:M,augmentColor:L,tonalOffset:c},R[n]),h)}var C=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var I={textTransform:"uppercase"},T='"Roboto", "Helvetica", "Arial", sans-serif';function P(t,e){var n="function"===typeof e?e(t):e,o=n.fontFamily,s=void 0===o?T:o,l=n.fontSize,u=void 0===l?14:l,c=n.fontWeightLight,h=void 0===c?300:c,f=n.fontWeightRegular,p=void 0===f?400:f,d=n.fontWeightMedium,m=void 0===d?500:d,g=n.fontWeightBold,v=void 0===g?700:g,y=n.htmlFontSize,_=void 0===y?16:y,x=n.allVariants,b=n.pxToRem,w=(0,i.Z)(n,C);var S=u/14,E=b||function(t){return"".concat(t/_*S,"rem")},k=function(t,e,n,i,o){return(0,r.Z)({fontFamily:s,fontWeight:t,fontSize:E(e),lineHeight:n},s===T?{letterSpacing:"".concat((a=i/e,Math.round(1e5*a)/1e5),"em")}:{},o,x);var a},P={h1:k(h,96,1.167,-1.5),h2:k(h,60,1.2,-.5),h3:k(p,48,1.167,0),h4:k(p,34,1.235,.25),h5:k(p,24,1.334,0),h6:k(m,20,1.6,.15),subtitle1:k(p,16,1.75,.15),subtitle2:k(m,14,1.57,.1),body1:k(p,16,1.5,.15),body2:k(p,14,1.43,.15),button:k(m,14,1.75,.4,I),caption:k(p,12,1.66,.4),overline:k(p,12,2.66,1,I)};return(0,a.Z)((0,r.Z)({htmlFontSize:_,pxToRem:E,fontFamily:s,fontSize:u,fontWeightLight:h,fontWeightRegular:p,fontWeightMedium:m,fontWeightBold:v},P),w,{clone:!1})}function A(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var M=["none",A(0,2,1,-1,0,1,1,0,0,1,3,0),A(0,3,1,-2,0,2,2,0,0,1,5,0),A(0,3,3,-2,0,3,4,0,0,1,8,0),A(0,2,4,-1,0,4,5,0,0,1,10,0),A(0,3,5,-1,0,5,8,0,0,1,14,0),A(0,3,5,-1,0,6,10,0,0,1,18,0),A(0,4,5,-2,0,7,10,1,0,2,16,1),A(0,5,5,-3,0,8,10,1,0,3,14,2),A(0,5,6,-3,0,9,12,1,0,3,16,2),A(0,6,6,-3,0,10,14,1,0,4,18,3),A(0,6,7,-4,0,11,15,1,0,4,20,3),A(0,7,8,-4,0,12,17,2,0,5,22,4),A(0,7,8,-4,0,13,19,2,0,5,24,4),A(0,7,9,-4,0,14,21,2,0,5,26,4),A(0,8,9,-5,0,15,22,2,0,6,28,5),A(0,8,10,-5,0,16,24,2,0,6,30,5),A(0,8,11,-5,0,17,26,2,0,6,32,5),A(0,9,11,-5,0,18,28,2,0,7,34,6),A(0,9,12,-6,0,19,29,2,0,7,36,6),A(0,10,13,-6,0,20,31,3,0,8,38,7),A(0,10,13,-6,0,21,33,3,0,8,40,7),A(0,10,14,-6,0,22,35,3,0,8,42,7),A(0,11,14,-7,0,23,36,3,0,9,44,8),A(0,11,15,-7,0,24,38,3,0,9,46,8)],L=n(1314),R={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},D=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function N(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.mixins,n=void 0===e?{}:e,c=t.palette,f=void 0===c?{}:c,p=t.transitions,d=void 0===p?{}:p,m=t.typography,g=void 0===m?{}:m,v=(0,i.Z)(t,D);if(t.vars)throw new Error((0,o.Z)(18));var y=k(f),_=(0,s.Z)(t),x=(0,a.Z)(_,{mixins:h(_.breakpoints,n),palette:y,shadows:M.slice(),typography:P(y,g),transitions:(0,L.ZP)(d),zIndex:(0,r.Z)({},R)});x=(0,a.Z)(x,v);for(var b=arguments.length,w=new Array(b>1?b-1:0),S=1;S<b;S++)w[S-1]=arguments[S];return(x=w.reduce((function(t,e){return(0,a.Z)(t,e)}),x)).unstable_sxConfig=(0,r.Z)({},l.Z,null==v?void 0:v.unstable_sxConfig),x.unstable_sx=function(t){return(0,u.Z)({sx:t,theme:this})},x}var z=N},1314:function(t,e,n){"use strict";n.d(e,{ZP:function(){return c},x9:function(){return s}});var r=n(1048),i=n(2793),o=["duration","easing","delay"],a={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},s={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function l(t){return"".concat(Math.round(t),"ms")}function u(t){if(!t)return 0;var e=t/36;return Math.round(10*(4+15*Math.pow(e,.25)+e/5))}function c(t){var e=(0,i.Z)({},a,t.easing),n=(0,i.Z)({},s,t.duration);return(0,i.Z)({getAutoHeightDuration:u,create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.duration,s=void 0===a?n.standard:a,u=i.easing,c=void 0===u?e.easeInOut:u,h=i.delay,f=void 0===h?0:h;(0,r.Z)(i,o);return(Array.isArray(t)?t:[t]).map((function(t){return"".concat(t," ").concat("string"===typeof s?s:l(s)," ").concat(c," ").concat("string"===typeof f?f:l(f))})).join(",")}},t,{easing:e,duration:n})}},6482:function(t,e,n){"use strict";var r=(0,n(1979).Z)();e.Z=r},7630:function(t,e,n){"use strict";n.d(e,{ZP:function(){return T},FO:function(){return k},Dz:function(){return C}});var r=n(2982),i=n(885),o=n(916),a=n(4695),s=n(5917),l=n(5080),u=n(7312),c=["variant"];function h(t){return 0===t.length}function f(t){var e=t.variant,n=(0,o.Z)(t,c),r=e||"";return Object.keys(n).sort().forEach((function(e){r+="color"===e?h(r)?t[e]:(0,u.Z)(t[e]):"".concat(h(r)?e:(0,u.Z)(e)).concat((0,u.Z)(t[e].toString()))})),r}var p=n(104),d=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],m=["theme"],g=["theme"];function v(t){return 0===Object.keys(t).length}function y(t){return"string"===typeof t&&t.charCodeAt(0)>96}var _=function(t,e){return e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null},x=function(t,e){var n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);var r={};return n.forEach((function(t){var e=f(t.props);r[e]=t.style})),r},b=function(t,e,n,r){var i,o,a=t.ownerState,s=void 0===a?{}:a,l=[],u=null==n||null==(i=n.components)||null==(o=i[r])?void 0:o.variants;return u&&u.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(e){s[e]!==n.props[e]&&t[e]!==n.props[e]&&(r=!1)})),r&&l.push(e[f(n.props)])})),l};function w(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t}var S=(0,l.Z)();var E=n(6482),k=function(t){return w(t)&&"classes"!==t},C=w,I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.defaultTheme,n=void 0===e?S:e,l=t.rootShouldForwardProp,u=void 0===l?w:l,c=t.slotShouldForwardProp,h=void 0===c?w:c,f=function(t){var e=v(t.theme)?n:t.theme;return(0,p.Z)((0,a.Z)({},t,{theme:e}))};return f.__mui_systemSx=!0,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.Co)(t,(function(t){return t.filter((function(t){return!(null!=t&&t.__mui_systemSx)}))}));var l,c=e.name,p=e.slot,S=e.skipVariantsResolver,E=e.skipSx,k=e.overridesResolver,C=(0,o.Z)(e,d),I=void 0!==S?S:p&&"Root"!==p||!1,T=E||!1;var P=w;"Root"===p?P=u:p?P=h:y(t)&&(P=void 0);var A=(0,s.ZP)(t,(0,a.Z)({shouldForwardProp:P,label:l},C)),M=function(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),l=1;l<e;l++)s[l-1]=arguments[l];var u=s?s.map((function(t){return"function"===typeof t&&t.__emotion_real!==t?function(e){var r=e.theme,i=(0,o.Z)(e,m);return t((0,a.Z)({theme:v(r)?n:r},i))}:t})):[],h=t;c&&k&&u.push((function(t){var e=v(t.theme)?n:t.theme,r=_(c,e);if(r){var o={};return Object.entries(r).forEach((function(n){var r=(0,i.Z)(n,2),s=r[0],l=r[1];o[s]="function"===typeof l?l((0,a.Z)({},t,{theme:e})):l})),k(t,o)}return null})),c&&!I&&u.push((function(t){var e=v(t.theme)?n:t.theme;return b(t,x(c,e),e,c)})),T||u.push(f);var p=u.length-s.length;if(Array.isArray(t)&&p>0){var d=new Array(p).fill("");(h=[].concat((0,r.Z)(t),(0,r.Z)(d))).raw=[].concat((0,r.Z)(t.raw),(0,r.Z)(d))}else"function"===typeof t&&t.__emotion_real!==t&&(h=function(e){var r=e.theme,i=(0,o.Z)(e,g);return t((0,a.Z)({theme:v(r)?n:r},i))});var y=A.apply(void 0,[h].concat((0,r.Z)(u)));return y};return A.withConfig&&(M.withConfig=A.withConfig),M}}({defaultTheme:E.Z,rootShouldForwardProp:k}),T=I},3736:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(3073),i=n(418);var o=n(6482);function a(t){return function(t){var e=t.props,n=t.name,o=t.defaultTheme,a=(0,i.Z)(o);return(0,r.Z)({theme:a,name:n,props:e})}({props:t.props,name:t.name,defaultTheme:o.Z})}},4036:function(t,e,n){"use strict";var r=n(7312);e.Z=r.Z},1260:function(t,e,n){"use strict";var r=n(8949);e.Z=r.Z},9201:function(t,e,n){"use strict";n.d(e,{Z:function(){return _}});var r=n(2793),i=n(2791),o=n(1048),a=n(8182),s=n(4419),l=n(4036),u=n(3736),c=n(7630),h=n(5878),f=n(1217);function p(t){return(0,f.Z)("MuiSvgIcon",t)}(0,h.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var d=n(184),m=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],g=(0,c.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,"inherit"!==n.color&&e["color".concat((0,l.Z)(n.color))],e["fontSize".concat((0,l.Z)(n.fontSize))]]}})((function(t){var e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y=t.theme,_=t.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:null==(e=y.transitions)||null==(n=e.create)?void 0:n.call(e,"fill",{duration:null==(r=y.transitions)||null==(i=r.duration)?void 0:i.shorter}),fontSize:{inherit:"inherit",small:(null==(o=y.typography)||null==(a=o.pxToRem)?void 0:a.call(o,20))||"1.25rem",medium:(null==(s=y.typography)||null==(l=s.pxToRem)?void 0:l.call(s,24))||"1.5rem",large:(null==(u=y.typography)||null==(c=u.pxToRem)?void 0:c.call(u,35))||"2.1875rem"}[_.fontSize],color:null!=(h=null==(f=(y.vars||y).palette)||null==(p=f[_.color])?void 0:p.main)?h:{action:null==(d=(y.vars||y).palette)||null==(m=d.action)?void 0:m.active,disabled:null==(g=(y.vars||y).palette)||null==(v=g.action)?void 0:v.disabled,inherit:void 0}[_.color]}})),v=i.forwardRef((function(t,e){var n=(0,u.Z)({props:t,name:"MuiSvgIcon"}),i=n.children,c=n.className,h=n.color,f=void 0===h?"inherit":h,v=n.component,y=void 0===v?"svg":v,_=n.fontSize,x=void 0===_?"medium":_,b=n.htmlColor,w=n.inheritViewBox,S=void 0!==w&&w,E=n.titleAccess,k=n.viewBox,C=void 0===k?"0 0 24 24":k,I=(0,o.Z)(n,m),T=(0,r.Z)({},n,{color:f,component:y,fontSize:x,instanceFontSize:t.fontSize,inheritViewBox:S,viewBox:C}),P={};S||(P.viewBox=C);var A=function(t){var e=t.color,n=t.fontSize,r=t.classes,i={root:["root","inherit"!==e&&"color".concat((0,l.Z)(e)),"fontSize".concat((0,l.Z)(n))]};return(0,s.Z)(i,p,r)}(T);return(0,d.jsxs)(g,(0,r.Z)({as:y,className:(0,a.Z)(A.root,c),focusable:"false",color:b,"aria-hidden":!E||void 0,role:E?"img":void 0,ref:e},P,I,{ownerState:T,children:[i,E?(0,d.jsx)("title",{children:E}):null]}))}));v.muiName="SvgIcon";var y=v;function _(t,e){function n(n,i){return(0,d.jsx)(y,(0,r.Z)({"data-testid":"".concat(e,"Icon"),ref:i},n,{children:t}))}return n.muiName=y.muiName,i.memo(i.forwardRef(n))}},3199:function(t,e,n){"use strict";var r=n(3981);e.Z=r.Z},8610:function(t,e,n){"use strict";n.r(e),n.d(e,{capitalize:function(){return i.Z},createChainedFunction:function(){return o.Z},createSvgIcon:function(){return a.Z},debounce:function(){return s.Z},deprecatedPropType:function(){return l},isMuiElement:function(){return u.Z},ownerDocument:function(){return c.Z},ownerWindow:function(){return h.Z},requirePropFactory:function(){return f},setRef:function(){return p},unstable_ClassNameGenerator:function(){return b},unstable_useEnhancedEffect:function(){return d.Z},unstable_useId:function(){return m.Z},unsupportedProp:function(){return g},useControlled:function(){return v.Z},useEventCallback:function(){return y.Z},useForkRef:function(){return _.Z},useIsFocusVisible:function(){return x.Z}});var r=n(5902),i=n(4036),o=n(1260),a=n(9201),s=n(3199);var l=function(t,e){return function(){return null}},u=n(9103),c=n(8301),h=n(7602);n(1860);var f=function(t,e){return function(){return null}},p=n(2971).Z,d=n(162),m=n(7384);var g=function(t,e,n,r,i){return null},v=n(8744),y=n(9683),_=n(2071),x=n(3031),b={configure:function(t){r.Z.configure(t)}}},9103:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(2791);var i=function(t,e){return r.isValidElement(t)&&-1!==e.indexOf(t.type.muiName)}},8301:function(t,e,n){"use strict";var r=n(9723);e.Z=r.Z},7602:function(t,e,n){"use strict";var r=n(7979);e.Z=r.Z},8744:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(885),i=n(2791);var o=function(t){var e=t.controlled,n=t.default,o=(t.name,t.state,i.useRef(void 0!==e).current),a=i.useState(n),s=(0,r.Z)(a,2),l=s[0],u=s[1];return[o?e:l,i.useCallback((function(t){o||u(t)}),[])]}},162:function(t,e,n){"use strict";var r=n(5721);e.Z=r.Z},9683:function(t,e,n){"use strict";var r=n(8956);e.Z=r.Z},2071:function(t,e,n){"use strict";var r=n(7563);e.Z=r.Z},7384:function(t,e,n){"use strict";var r=n(6248);e.Z=r.Z},3031:function(t,e,n){"use strict";n.d(e,{Z:function(){return f}});var r,i=n(2791),o=!0,a=!1,s={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function l(t){t.metaKey||t.altKey||t.ctrlKey||(o=!0)}function u(){o=!1}function c(){"hidden"===this.visibilityState&&a&&(o=!0)}function h(t){var e=t.target;try{return e.matches(":focus-visible")}catch(n){}return o||function(t){var e=t.type,n=t.tagName;return!("INPUT"!==n||!s[e]||t.readOnly)||"TEXTAREA"===n&&!t.readOnly||!!t.isContentEditable}(e)}var f=function(){var t=i.useCallback((function(t){var e;null!=t&&((e=t.ownerDocument).addEventListener("keydown",l,!0),e.addEventListener("mousedown",u,!0),e.addEventListener("pointerdown",u,!0),e.addEventListener("touchstart",u,!0),e.addEventListener("visibilitychange",c,!0))}),[]),e=i.useRef(!1);return{isFocusVisibleRef:e,onFocus:function(t){return!!h(t)&&(e.current=!0,!0)},onBlur:function(){return!!e.current&&(a=!0,window.clearTimeout(r),r=window.setTimeout((function(){a=!1}),100),e.current=!1,!0)},ref:t}}},8023:function(t,e,n){"use strict";var r=n(2791).createContext(null);e.Z=r},9598:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(2791),i=n(8023);function o(){return r.useContext(i.Z)}},5917:function(t,e,n){"use strict";n.d(e,{Co:function(){return o},ZP:function(){return i}});var r=n(225);function i(t,e){return(0,r.Z)(t,e)}var o=function(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}},1184:function(t,e,n){"use strict";n.d(e,{L7:function(){return s},P$:function(){return l},VO:function(){return r},W8:function(){return a},k9:function(){return o}});var r={xs:0,sm:600,md:900,lg:1200,xl:1536},i={keys:["xs","sm","md","lg","xl"],up:function(t){return"@media (min-width:".concat(r[t],"px)")}};function o(t,e,n){var o=t.theme||{};if(Array.isArray(e)){var a=o.breakpoints||i;return e.reduce((function(t,r,i){return t[a.up(a.keys[i])]=n(e[i]),t}),{})}if("object"===typeof e){var s=o.breakpoints||i;return Object.keys(e).reduce((function(t,i){if(-1!==Object.keys(s.values||r).indexOf(i)){t[s.up(i)]=n(e[i],i)}else{var o=i;t[o]=e[o]}return t}),{})}return n(e)}function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null==(t=e.keys)?void 0:t.reduce((function(t,n){return t[e.up(n)]={},t}),{});return n||{}}function s(t,e){return t.reduce((function(t,e){var n=t[e];return(!n||0===Object.keys(n).length)&&delete t[e],t}),e)}function l(t){var e,n=t.values,r=t.breakpoints,i=t.base||function(t,e){if("object"!==typeof t)return{};var n={},r=Object.keys(e);return Array.isArray(t)?r.forEach((function(e,r){r<t.length&&(n[e]=!0)})):r.forEach((function(e){null!=t[e]&&(n[e]=!0)})),n}(n,r),o=Object.keys(i);return 0===o.length?n:o.reduce((function(t,r,i){return Array.isArray(n)?(t[r]=null!=n[i]?n[i]:n[e],e=i):"object"===typeof n?(t[r]=null!=n[r]?n[r]:n[e],e=r):t[r]=n,t}),{})}},2065:function(t,e,n){"use strict";n.d(e,{$n:function(){return h},Fq:function(){return u},_j:function(){return c},mi:function(){return l}});var r=n(6189);function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)}function o(t){if(t.type)return t;if("#"===t.charAt(0))return o(function(t){t=t.slice(1);var e=new RegExp(".{1,".concat(t.length>=6?2:1,"}"),"g"),n=t.match(e);return n&&1===n[0].length&&(n=n.map((function(t){return t+t}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(t,e){return e<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3})).join(", "),")"):""}(t));var e=t.indexOf("("),n=t.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,r.Z)(9,t));var i,a=t.substring(e+1,t.length-1);if("color"===n){if(i=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i))throw new Error((0,r.Z)(10,i))}else a=a.split(",");return{type:n,values:a=a.map((function(t){return parseFloat(t)})),colorSpace:i}}function a(t){var e=t.type,n=t.colorSpace,r=t.values;return-1!==e.indexOf("rgb")?r=r.map((function(t,e){return e<3?parseInt(t,10):t})):-1!==e.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==e.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(e,"(").concat(r,")")}function s(t){var e="hsl"===(t=o(t)).type||"hsla"===t.type?o(function(t){var e=(t=o(t)).values,n=e[0],r=e[1]/100,i=e[2]/100,s=r*Math.min(i,1-i),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+n/30)%12;return i-s*Math.max(Math.min(e-3,9-e,1),-1)},u="rgb",c=[Math.round(255*l(0)),Math.round(255*l(8)),Math.round(255*l(4))];return"hsla"===t.type&&(u+="a",c.push(e[3])),a({type:u,values:c})}(t)).values:t.values;return e=e.map((function(e){return"color"!==t.type&&(e/=255),e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function l(t,e){var n=s(t),r=s(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function u(t,e){return t=o(t),e=i(e),"rgb"!==t.type&&"hsl"!==t.type||(t.type+="a"),"color"===t.type?t.values[3]="/".concat(e):t.values[3]=e,a(t)}function c(t,e){if(t=o(t),e=i(e),-1!==t.type.indexOf("hsl"))t.values[2]*=1-e;else if(-1!==t.type.indexOf("rgb")||-1!==t.type.indexOf("color"))for(var n=0;n<3;n+=1)t.values[n]*=1-e;return a(t)}function h(t,e){if(t=o(t),e=i(e),-1!==t.type.indexOf("hsl"))t.values[2]+=(100-t.values[2])*e;else if(-1!==t.type.indexOf("rgb"))for(var n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(-1!==t.type.indexOf("color"))for(var r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return a(t)}},5080:function(t,e,n){"use strict";n.d(e,{Z:function(){return m}});var r=n(4695),i=n(916),o=n(2466),a=n(4942),s=["values","unit","step"];function l(t){var e=t.values,n=void 0===e?{xs:0,sm:600,md:900,lg:1200,xl:1536}:e,o=t.unit,l=void 0===o?"px":o,u=t.step,c=void 0===u?5:u,h=(0,i.Z)(t,s),f=function(t){var e=Object.keys(t).map((function(e){return{key:e,val:t[e]}}))||[];return e.sort((function(t,e){return t.val-e.val})),e.reduce((function(t,e){return(0,r.Z)({},t,(0,a.Z)({},e.key,e.val))}),{})}(n),p=Object.keys(f);function d(t){var e="number"===typeof n[t]?n[t]:t;return"@media (min-width:".concat(e).concat(l,")")}function m(t){var e="number"===typeof n[t]?n[t]:t;return"@media (max-width:".concat(e-c/100).concat(l,")")}function g(t,e){var r=p.indexOf(e);return"@media (min-width:".concat("number"===typeof n[t]?n[t]:t).concat(l,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[p[r]]?n[p[r]]:e)-c/100).concat(l,")")}return(0,r.Z)({keys:p,values:f,up:d,down:m,between:g,only:function(t){return p.indexOf(t)+1<p.length?g(t,p[p.indexOf(t)+1]):d(t)},not:function(t){var e=p.indexOf(t);return 0===e?d(p[1]):e===p.length-1?m(p[e]):g(t,p[p.indexOf(t)+1]).replace("@media","@media not all and")},unit:l},h)}var u={borderRadius:4},c=n(5682);function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(t.mui)return t;var e=(0,c.hB)({spacing:t}),n=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=0===n.length?[1]:n;return i.map((function(t){var n=e(t);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}var f=n(104),p=n(7416),d=["breakpoints","palette","spacing","shape"];var m=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.breakpoints,n=void 0===e?{}:e,a=t.palette,s=void 0===a?{}:a,c=t.spacing,m=t.shape,g=void 0===m?{}:m,v=(0,i.Z)(t,d),y=l(n),_=h(c),x=(0,o.Z)({breakpoints:y,direction:"ltr",components:{},palette:(0,r.Z)({mode:"light"},s),spacing:_,shape:(0,r.Z)({},u,g)},v),b=arguments.length,w=new Array(b>1?b-1:0),S=1;S<b;S++)w[S-1]=arguments[S];return(x=w.reduce((function(t,e){return(0,o.Z)(t,e)}),x)).unstable_sxConfig=(0,r.Z)({},p.Z,null==v?void 0:v.unstable_sxConfig),x.unstable_sx=function(t){return(0,f.Z)({sx:t,theme:this})},x}},8247:function(t,e,n){"use strict";var r=n(2466);e.Z=function(t,e){return e?(0,r.Z)(t,e,{clone:!1}):t}},5682:function(t,e,n){"use strict";n.d(e,{hB:function(){return m},eI:function(){return d},NA:function(){return g},e6:function(){return _},o3:function(){return x}});var r=n(885),i=n(1184),o=n(8529),a=n(8247);var s={m:"margin",p:"padding"},l={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},u={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}((function(t){if(t.length>2){if(!u[t])return[t];t=u[t]}var e=t.split(""),n=(0,r.Z)(e,2),i=n[0],o=n[1],a=s[i],c=l[o]||"";return Array.isArray(c)?c.map((function(t){return a+t})):[a+c]})),h=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],f=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],p=[].concat(h,f);function d(t,e,n,r){var i,a=null!=(i=(0,o.DW)(t,e,!1))?i:n;return"number"===typeof a?function(t){return"string"===typeof t?t:a*t}:Array.isArray(a)?function(t){return"string"===typeof t?t:a[t]}:"function"===typeof a?a:function(){}}function m(t){return d(t,"spacing",8)}function g(t,e){if("string"===typeof e||null==e)return e;var n=t(Math.abs(e));return e>=0?n:"number"===typeof n?-n:"-".concat(n)}function v(t,e,n,r){if(-1===e.indexOf(n))return null;var o=function(t,e){return function(n){return t.reduce((function(t,r){return t[r]=g(e,n),t}),{})}}(c(n),r),a=t[n];return(0,i.k9)(t,a,o)}function y(t,e){var n=m(t.theme);return Object.keys(t).map((function(r){return v(t,e,r,n)})).reduce(a.Z,{})}function _(t){return y(t,h)}function x(t){return y(t,f)}function b(t){return y(t,p)}_.propTypes={},_.filterProps=h,x.propTypes={},x.filterProps=f,b.propTypes={},b.filterProps=p},8529:function(t,e,n){"use strict";n.d(e,{DW:function(){return a},Jq:function(){return s}});var r=n(4942),i=n(7312),o=n(1184);function a(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||"string"!==typeof e)return null;if(t&&t.vars&&n){var r="vars.".concat(e).split(".").reduce((function(t,e){return t&&t[e]?t[e]:null}),t);if(null!=r)return r}return e.split(".").reduce((function(t,e){return t&&null!=t[e]?t[e]:null}),t)}function s(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof t?t(n):Array.isArray(t)?t[n]||i:a(t,n)||i,e&&(r=e(r,i,t)),r}e.ZP=function(t){var e=t.prop,n=t.cssProperty,l=void 0===n?t.prop:n,u=t.themeKey,c=t.transform,h=function(t){if(null==t[e])return null;var n=t[e],h=a(t.theme,u)||{};return(0,o.k9)(t,n,(function(t){var n=s(h,c,t);return t===n&&"string"===typeof t&&(n=s(h,c,"".concat(e).concat("default"===t?"":(0,i.Z)(t)),t)),!1===l?n:(0,r.Z)({},l,n)}))};return h.propTypes={},h.filterProps=[e],h}},7416:function(t,e,n){"use strict";n.d(e,{Z:function(){return M}});var r=n(5682),i=n(8529),o=n(8247);var a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce((function(t,e){return e.filterProps.forEach((function(n){t[n]=e})),t}),{}),i=function(t){return Object.keys(t).reduce((function(e,n){return r[n]?(0,o.Z)(e,r[n](t)):e}),{})};return i.propTypes={},i.filterProps=e.reduce((function(t,e){return t.concat(e.filterProps)}),[]),i},s=n(1184);function l(t){return"number"!==typeof t?t:"".concat(t,"px solid")}var u=(0,i.ZP)({prop:"border",themeKey:"borders",transform:l}),c=(0,i.ZP)({prop:"borderTop",themeKey:"borders",transform:l}),h=(0,i.ZP)({prop:"borderRight",themeKey:"borders",transform:l}),f=(0,i.ZP)({prop:"borderBottom",themeKey:"borders",transform:l}),p=(0,i.ZP)({prop:"borderLeft",themeKey:"borders",transform:l}),d=(0,i.ZP)({prop:"borderColor",themeKey:"palette"}),m=(0,i.ZP)({prop:"borderTopColor",themeKey:"palette"}),g=(0,i.ZP)({prop:"borderRightColor",themeKey:"palette"}),v=(0,i.ZP)({prop:"borderBottomColor",themeKey:"palette"}),y=(0,i.ZP)({prop:"borderLeftColor",themeKey:"palette"}),_=function(t){if(void 0!==t.borderRadius&&null!==t.borderRadius){var e=(0,r.eI)(t.theme,"shape.borderRadius",4,"borderRadius");return(0,s.k9)(t,t.borderRadius,(function(t){return{borderRadius:(0,r.NA)(e,t)}}))}return null};_.propTypes={},_.filterProps=["borderRadius"];a(u,c,h,f,p,d,m,g,v,y,_);var x=function(t){if(void 0!==t.gap&&null!==t.gap){var e=(0,r.eI)(t.theme,"spacing",8,"gap");return(0,s.k9)(t,t.gap,(function(t){return{gap:(0,r.NA)(e,t)}}))}return null};x.propTypes={},x.filterProps=["gap"];var b=function(t){if(void 0!==t.columnGap&&null!==t.columnGap){var e=(0,r.eI)(t.theme,"spacing",8,"columnGap");return(0,s.k9)(t,t.columnGap,(function(t){return{columnGap:(0,r.NA)(e,t)}}))}return null};b.propTypes={},b.filterProps=["columnGap"];var w=function(t){if(void 0!==t.rowGap&&null!==t.rowGap){var e=(0,r.eI)(t.theme,"spacing",8,"rowGap");return(0,s.k9)(t,t.rowGap,(function(t){return{rowGap:(0,r.NA)(e,t)}}))}return null};w.propTypes={},w.filterProps=["rowGap"];a(x,b,w,(0,i.ZP)({prop:"gridColumn"}),(0,i.ZP)({prop:"gridRow"}),(0,i.ZP)({prop:"gridAutoFlow"}),(0,i.ZP)({prop:"gridAutoColumns"}),(0,i.ZP)({prop:"gridAutoRows"}),(0,i.ZP)({prop:"gridTemplateColumns"}),(0,i.ZP)({prop:"gridTemplateRows"}),(0,i.ZP)({prop:"gridTemplateAreas"}),(0,i.ZP)({prop:"gridArea"}));function S(t,e){return"grey"===e?e:t}a((0,i.ZP)({prop:"color",themeKey:"palette",transform:S}),(0,i.ZP)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:S}),(0,i.ZP)({prop:"backgroundColor",themeKey:"palette",transform:S}));function E(t){return t<=1&&0!==t?"".concat(100*t,"%"):t}var k=(0,i.ZP)({prop:"width",transform:E}),C=function(t){if(void 0!==t.maxWidth&&null!==t.maxWidth){return(0,s.k9)(t,t.maxWidth,(function(e){var n,r,i;return{maxWidth:(null==(n=t.theme)||null==(r=n.breakpoints)||null==(i=r.values)?void 0:i[e])||s.VO[e]||E(e)}}))}return null};C.filterProps=["maxWidth"];var I=(0,i.ZP)({prop:"minWidth",transform:E}),T=(0,i.ZP)({prop:"height",transform:E}),P=(0,i.ZP)({prop:"maxHeight",transform:E}),A=(0,i.ZP)({prop:"minHeight",transform:E}),M=((0,i.ZP)({prop:"size",cssProperty:"width",transform:E}),(0,i.ZP)({prop:"size",cssProperty:"height",transform:E}),a(k,C,I,T,P,A,(0,i.ZP)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:_},color:{themeKey:"palette",transform:S},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:S},backgroundColor:{themeKey:"palette",transform:S},p:{style:r.o3},pt:{style:r.o3},pr:{style:r.o3},pb:{style:r.o3},pl:{style:r.o3},px:{style:r.o3},py:{style:r.o3},padding:{style:r.o3},paddingTop:{style:r.o3},paddingRight:{style:r.o3},paddingBottom:{style:r.o3},paddingLeft:{style:r.o3},paddingX:{style:r.o3},paddingY:{style:r.o3},paddingInline:{style:r.o3},paddingInlineStart:{style:r.o3},paddingInlineEnd:{style:r.o3},paddingBlock:{style:r.o3},paddingBlockStart:{style:r.o3},paddingBlockEnd:{style:r.o3},m:{style:r.e6},mt:{style:r.e6},mr:{style:r.e6},mb:{style:r.e6},ml:{style:r.e6},mx:{style:r.e6},my:{style:r.e6},margin:{style:r.e6},marginTop:{style:r.e6},marginRight:{style:r.e6},marginBottom:{style:r.e6},marginLeft:{style:r.e6},marginX:{style:r.e6},marginY:{style:r.e6},marginInline:{style:r.e6},marginInlineStart:{style:r.e6},marginInlineEnd:{style:r.e6},marginBlock:{style:r.e6},marginBlockStart:{style:r.e6},marginBlockEnd:{style:r.e6},displayPrint:{cssProperty:!1,transform:function(t){return{"@media print":{display:t}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:x},rowGap:{style:w},columnGap:{style:b},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:E},maxWidth:{style:C},minWidth:{transform:E},height:{transform:E},maxHeight:{transform:E},minHeight:{transform:E},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},104:function(t,e,n){"use strict";var r=n(4942),i=n(7312),o=n(8247),a=n(8529),s=n(1184),l=n(7416);var u=function(){function t(t,e,n,o){var l,u=(l={},(0,r.Z)(l,t,e),(0,r.Z)(l,"theme",n),l),c=o[t];if(!c)return(0,r.Z)({},t,e);var h=c.cssProperty,f=void 0===h?t:h,p=c.themeKey,d=c.transform,m=c.style;if(null==e)return null;var g=(0,a.DW)(n,p)||{};if(m)return m(u);return(0,s.k9)(u,e,(function(e){var n=(0,a.Jq)(g,d,e);return e===n&&"string"===typeof e&&(n=(0,a.Jq)(g,d,"".concat(t).concat("default"===e?"":(0,i.Z)(e)),e)),!1===f?n:(0,r.Z)({},f,n)}))}return function e(n){var i,a=n||{},u=a.sx,c=a.theme,h=void 0===c?{}:c;if(!u)return null;var f=null!=(i=h.unstable_sxConfig)?i:l.Z;function p(n){var i=n;if("function"===typeof n)i=n(h);else if("object"!==typeof n)return n;if(!i)return null;var a=(0,s.W8)(h.breakpoints),l=Object.keys(a),u=a;return Object.keys(i).forEach((function(n){var a,l,c=(a=i[n],l=h,"function"===typeof a?a(l):a);if(null!==c&&void 0!==c)if("object"===typeof c)if(f[n])u=(0,o.Z)(u,t(n,c,h,f));else{var p=(0,s.k9)({theme:h},c,(function(t){return(0,r.Z)({},n,t)}));!function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce((function(t,e){return t.concat(Object.keys(e))}),[]),i=new Set(r);return e.every((function(t){return i.size===Object.keys(t).length}))}(p,c)?u=(0,o.Z)(u,p):u[n]=e({sx:c,theme:h})}else u=(0,o.Z)(u,t(n,c,h,f))})),(0,s.L7)(l,u)}return Array.isArray(u)?u.map(p):p(u)}}();u.filterProps=["sx"],e.Z=u},418:function(t,e,n){"use strict";var r=n(5080),i=n(9120),o=(0,r.Z)();e.Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return(0,i.Z)(t)}},3073:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(5735);function i(t){var e=t.theme,n=t.name,i=t.props;return e&&e.components&&e.components[n]&&e.components[n].defaultProps?(0,r.Z)(e.components[n].defaultProps,i):i}},9120:function(t,e,n){"use strict";var r=n(9598);function i(t){return 0===Object.keys(t).length}e.Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=(0,r.Z)();return!e||i(e)?t:e}},5902:function(t,e){"use strict";var n=function(t){return t},r=function(){var t=n;return{configure:function(e){t=e},generate:function(e){return t(e)},reset:function(){t=n}}}();e.Z=r},7312:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(6189);function i(t){if("string"!==typeof t)throw new Error((0,r.Z)(7));return t.charAt(0).toUpperCase()+t.slice(1)}},4419:function(t,e,n){"use strict";function r(t,e,n){var r={};return Object.keys(t).forEach((function(i){r[i]=t[i].reduce((function(t,r){return r&&(t.push(e(r)),n&&n[r]&&t.push(n[r])),t}),[]).join(" ")})),r}n.d(e,{Z:function(){return r}})},8949:function(t,e,n){"use strict";function r(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce((function(t,e){return null==e?t:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r),e.apply(this,r)}}),(function(){}))}n.d(e,{Z:function(){return r}})},3981:function(t,e,n){"use strict";function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=this,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s=function(){t.apply(r,o)};clearTimeout(e),e=setTimeout(s,n)}return r.clear=function(){clearTimeout(e)},r}n.d(e,{Z:function(){return r}})},2466:function(t,e,n){"use strict";n.d(e,{P:function(){return i},Z:function(){return a}});var r=n(1860);function i(t){return null!==t&&"object"===typeof t&&t.constructor===Object}function o(t){if(!i(t))return t;var e={};return Object.keys(t).forEach((function(n){e[n]=o(t[n])})),e}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},s=n.clone?(0,r.Z)({},t):t;return i(t)&&i(e)&&Object.keys(e).forEach((function(r){"__proto__"!==r&&(i(e[r])&&r in t&&i(t[r])?s[r]=a(t[r],e[r],n):n.clone?s[r]=i(e[r])?o(e[r]):e[r]:s[r]=e[r])})),s}},6189:function(t,e,n){"use strict";function r(t){for(var e="https://mui.com/production-error/?code="+t,n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}n.d(e,{Z:function(){return r}})},1217:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(5902),i={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",o=i[e];return o?"".concat(n,"-").concat(o):"".concat(r.Z.generate(t),"-").concat(e)}},5878:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(1217);function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",i={};return e.forEach((function(e){i[e]=(0,r.Z)(t,e,n)})),i}},9723:function(t,e,n){"use strict";function r(t){return t&&t.ownerDocument||document}n.d(e,{Z:function(){return r}})},7979:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(9723);function i(t){return(0,r.Z)(t).defaultView||window}},5735:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(1860);function i(t,e){var n=(0,r.Z)({},e);return Object.keys(t).forEach((function(o){if(o.toString().match(/^(components|slots)$/))n[o]=(0,r.Z)({},t[o],n[o]);else if(o.toString().match(/^(componentsProps|slotProps)$/)){var a=t[o]||{},s=e[o];n[o]={},s&&Object.keys(s)?a&&Object.keys(a)?(n[o]=(0,r.Z)({},s),Object.keys(a).forEach((function(t){n[o][t]=i(a[t],s[t])}))):n[o]=s:n[o]=a}else void 0===n[o]&&(n[o]=t[o])})),n}},2971:function(t,e,n){"use strict";function r(t,e){"function"===typeof t?t(e):t&&(t.current=e)}n.d(e,{Z:function(){return r}})},5721:function(t,e,n){"use strict";var r=n(2791),i="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;e.Z=i},8956:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(2791),i=n(5721);function o(t){var e=r.useRef(t);return(0,i.Z)((function(){e.current=t})),r.useCallback((function(){return e.current.apply(void 0,arguments)}),[])}},7563:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(2791),i=n(2971);function o(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.useMemo((function(){return e.every((function(t){return null==t}))?null:function(t){e.forEach((function(e){(0,i.Z)(e,t)}))}}),e)}},6248:function(t,e,n){"use strict";var r;n.d(e,{Z:function(){return l}});var i=n(885),o=n(2791),a=0;var s=(r||(r=n.t(o,2))).useId;function l(t){if(void 0!==s){var e=s();return null!=t?t:e}return function(t){var e=o.useState(t),n=(0,i.Z)(e,2),r=n[0],s=n[1],l=t||r;return o.useEffect((function(){null==r&&s("mui-".concat(a+=1))}),[r]),l}(t)}},2127:function(t,e,n){"use strict";var r=n(2538);function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.Z=i},7872:function(t,e){"use strict";function n(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function r(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var i=0,o=t;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function o(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function a(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function s(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function l(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function c(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function h(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function f(t){return 180*(t%(2*Math.PI))/Math.PI}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return r(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return s(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,n){return void 0===n&&(n={}),a(t.map((function(t){return r(t,e)})),n)},e.polygon=i,e.polygons=function(t,e,n){return void 0===n&&(n={}),a(t.map((function(t){return i(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),a(t.map((function(t){return o(t,e)})),n)},e.featureCollection=a,e.multiLineString=s,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return f(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=p,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!p(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},2538:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7872);function i(t,e,n){if(null!==t)for(var r,o,a,s,l,u,c,h,f=0,p=0,d=t.type,m="FeatureCollection"===d,g="Feature"===d,v=m?t.features.length:1,y=0;y<v;y++){l=(h=!!(c=m?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var x=0,b=0;if(null!==(s=h?c.geometries[_]:c)){u=s.coordinates;var w=s.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(u,p,y,x,b))return!1;p++,x++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],p,y,x,b))return!1;p++,"MultiPoint"===w&&x++}"LineString"===w&&x++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-f;o++){if(!1===e(u[r][o],p,y,x,b))return!1;p++}"MultiLineString"===w&&x++,"Polygon"===w&&b++}"Polygon"===w&&x++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(b=0,o=0;o<u[r].length;o++){for(a=0;a<u[r][o].length-f;a++){if(!1===e(u[r][o][a],p,y,x,b))return!1;p++}b++}x++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===i(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function s(t,e){var n,r,i,o,a,s,l,u,c,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,m=p?t.features.length:1;for(n=0;n<m;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,u=p?t.features[n].properties:d?t.properties:{},c=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function l(t,e){s(t,(function(t,n,i,o,a){var s,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:a}),n,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:s,coordinates:t.coordinates[u]};if(!1===e(r.feature(c,i),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var a=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var l,u=0,c=0,h=0;return!1!==i(t,(function(i,s,f,p,d){if(void 0===l||n>u||p>c||d>h)return l=i,u=n,c=p,h=d,void(a=0);var m=r.lineString([l,i],t.properties);if(!1===e(m,n,o,d,a))return!1;a++,l=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(r.lineString(a[s],t.properties),n,i,s))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,a,s){o=0===r&&void 0===n?t:e(o,t,r,i,a,s)}),r),o},e.featureEach=a,e.featureReduce=function(t,e,n){var r=n;return a(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point(u[o],l,e);case"LineString":return s<0&&(s=u.length+s),r.point(u[s],l,e);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s),r.point(u[a][s],l,e);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),r.point(u[o][s],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s),r.point(u[o][a][s],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),r.lineString([u[s],u[s+1]],l,e);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s-1),r.lineString([u[a][s],u[a][s+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),r.lineString([u[o][s],u[o][s+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s-1),r.lineString([u[o][a][s],u[o][a][s+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.geomEach=s,e.geomReduce=function(t,e,n){var r=n;return s(t,(function(t,i,o,a,s){r=0===i&&void 0===n?t:e(r,t,i,o,a,s)})),r},e.lineEach=c,e.lineReduce=function(t,e,n){var r=n;return c(t,(function(t,i,o,a){r=0===i&&void 0===n?t:e(r,t,i,o,a)})),r},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.segmentEach=u,e.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,(function(t,o,a,s,l){r=!1===i&&void 0===n?t:e(r,t,o,a,s,l),i=!0})),r}},4037:function(t,e,n){"use strict";var r=n(2506),i=n(9722),o=i(r("String.prototype.indexOf"));t.exports=function(t,e){var n=r(t,!!e);return"function"===typeof n&&o(t,".prototype.")>-1?i(n):n}},9722:function(t,e,n){"use strict";var r=n(3350),i=n(2506),o=i("%Function.prototype.apply%"),a=i("%Function.prototype.call%"),s=i("%Reflect.apply%",!0)||r.call(a,o),l=i("%Object.getOwnPropertyDescriptor%",!0),u=i("%Object.defineProperty%",!0),c=i("%Math.max%");if(u)try{u({},"a",{value:1})}catch(f){u=null}t.exports=function(t){var e=s(r,a,arguments);if(l&&u){var n=l(e,"length");n.configurable&&u(e,"length",{value:1+c(0,t.length-(arguments.length-1))})}return e};var h=function(){return s(r,o,arguments)};u?u(t.exports,"apply",{value:h}):t.exports.apply=h},8182:function(t,e,n){"use strict";function r(t){var e,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=r(t[e]))&&(i&&(i+=" "),i+=n);else for(e in t)t[e]&&(i&&(i+=" "),i+=e);return i}e.Z=function(){for(var t,e,n=0,i="";n<arguments.length;)(t=arguments[n++])&&(e=r(t))&&(i&&(i+=" "),i+=e);return i}},4161:function(t,e,n){"use strict";var r=n(2110),i=n(4613),o=n(5021),a=n(4460).orient2d;function s(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var i=function(t){for(var e=t[0],n=t[0],r=t[0],i=t[0],a=0;a<t.length;a++){var s=t[a];s[0]<e[0]&&(e=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>i[1]&&(i=s)}var l=[e,n,r,i],u=l.slice();for(a=0;a<t.length;a++)o(t[a],l)||u.push(t[a]);return function(t){t.sort(_);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&p(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var r=[],i=t.length-1;i>=0;i--){for(;r.length>=2&&p(r[r.length-2],r[r.length-1],t[i])<=0;)r.pop();r.push(t[i])}return r.pop(),e.pop(),e.concat(r)}(u)}(t),a=new r(16);a.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},a.compareMinX=function(t,e){return t[0]-e[0]},a.compareMinY=function(t,e){return t[1]-e[1]},a.load(t);for(var s,u=[],c=0;c<i.length;c++){var h=i[c];a.remove(h),s=m(h,s),u.push(s)}var f=new r(16);for(c=0;c<u.length;c++)f.insert(d(u[c]));for(var v=e*e,y=n*n;u.length;){var x=u.shift(),b=x.p,w=x.next.p,S=g(b,w);if(!(S<y)){var E=S/v;(h=l(a,x.prev.p,b,w,x.next.next.p,E,f))&&Math.min(g(h,b),g(h,w))<=E&&(u.push(x),u.push(m(h,x)),a.remove(h),f.remove(x),f.insert(d(x)),f.insert(d(x.next)))}}x=s;var k=[];do{k.push(x.p),x=x.next}while(x!==s);return k.push(x.p),k}function l(t,e,n,r,o,a,s){for(var l=new i([],u),h=t.data;h;){for(var p=0;p<h.children.length;p++){var d=h.children[p],m=h.leaf?v(d,n,r):c(n,r,d);m>a||l.push({node:d,dist:m})}for(;l.length&&!l.peek().node.children;){var g=l.pop(),y=g.node,_=v(y,e,n),x=v(y,r,o);if(g.dist<_&&g.dist<x&&f(n,y,s)&&f(r,y,s))return y}(h=l.pop())&&(h=h.node)}return null}function u(t,e){return t.dist-e.dist}function c(t,e,n){if(h(t,n)||h(e,n))return 0;var r=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var o=y(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var a=y(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===a?0:Math.min(r,i,o,a)}function h(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function f(t,e,n){for(var r,i,o,a,s=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),h=n.search({minX:s,minY:l,maxX:u,maxY:c}),f=0;f<h.length;f++)if(r=h[f].p,i=h[f].next.p,o=t,r!==(a=e)&&i!==o&&p(r,i,o)>0!==p(r,i,a)>0&&p(o,a,r)>0!==p(o,a,i)>0)return!1;return!0}function p(t,e,n){return a(t[0],t[1],e[0],e[1],n[0],n[1])}function d(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function m(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function g(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function v(t,e,n){var r=e[0],i=e[1],o=n[0]-r,a=n[1]-i;if(0!==o||0!==a){var s=((t[0]-r)*o+(t[1]-i)*a)/(o*o+a*a);s>1?(r=n[0],i=n[1]):s>0&&(r+=o*s,i+=a*s)}return(o=t[0]-r)*o+(a=t[1]-i)*a}function y(t,e,n,r,i,o,a,s){var l,u,c,h,f=n-t,p=r-e,d=a-i,m=s-o,g=t-i,v=e-o,y=f*f+p*p,_=f*d+p*m,x=d*d+m*m,b=f*g+p*v,w=d*g+m*v,S=y*x-_*_,E=S,k=S;0===S?(u=0,E=1,h=w,k=x):(h=y*w-_*b,(u=_*w-x*b)<0?(u=0,h=w,k=x):u>E&&(u=E,h=w+_,k=x)),h<0?(h=0,-b<0?u=0:-b>y?u=E:(u=-b,E=y)):h>k&&(h=k,-b+_<0?u=0:-b+_>y?u=E:(u=-b+_,E=y));var C=(1-(c=0===h?0:h/k))*i+c*a-((1-(l=0===u?0:u/E))*t+l*n),I=(1-c)*o+c*s-((1-l)*e+l*r);return C*C+I*I}function _(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}i.default&&(i=i.default),t.exports=s,t.exports.default=s},2110:function(t){t.exports=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/s+h)),Math.min(o,Math.floor(r+(s-l)*c/s+h)),a)}var f=n[r],p=i,d=o;for(e(n,i,r),a(n[o],f)>0&&e(n,i,o);p<d;){for(e(n,p,d),p++,d--;a(n[p],f)<0;)p++;for(;a(n[d],f)>0;)d--}0===a(n[i],f)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];s(i,t.leaf?r(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;p(t,s)&&(e.leaf?n.push(a):f(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),a.leaf){var c=i(t,a.children,e);if(-1!==c)return a.children.splice(c,1),l.push(a),this._condense(l),this}o||a.leaf||!f(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=d([])).leaf=!1,i.height=r;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));m(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);m(t,c,h,l,this.compareMinY);for(var f=c;f<=h;f+=l){var p=Math.min(f+l-1,h);i.children.push(this._build(t,f,p,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=c(l),h=(f=t,p=l,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-u);h<o?(o=h,i=u<i?u:i,a=l):h===o&&u<i&&(i=u,a=l)}e=a||e.children[0]}var f,p;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),s(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=d(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,l,u,h,f=1/0,p=1/0,d=e;d<=n-e;d++){var m=a(t,0,d,this.toBBox),g=a(t,d,n,this.toBBox),v=(i=m,o=g,s=void 0,l=void 0,u=void 0,h=void 0,s=Math.max(i.minX,o.minX),l=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,u-s)*Math.max(0,h-l)),y=c(m)+c(g);v<f?(f=v,r=d,p=y<p?y:p):v===f&&y<p&&(p=y,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),l=a(t,n-e,n,i),u=h(o)+h(l),c=e;c<n-e;c++){var f=t.children[c];s(o,t.leaf?i(f):f),u+=h(o)}for(var p=n-e-1;p>=e;p--){var d=t.children[p];s(l,t.leaf?i(d):d),u+=h(l)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},4058:function(t,e,n){var r=n(4892),i=n(5450),o=n(3454),a=n(1146),s=n(3535),l=n(2833),u=Date.prototype.getTime;function c(t,e,n){var p=n||{};return!!(p.strict?o(t,e):t===e)||(!t||!e||"object"!==typeof t&&"object"!==typeof e?p.strict?o(t,e):t==e:function(t,e,n){var o,p;if(typeof t!==typeof e)return!1;if(h(t)||h(e))return!1;if(t.prototype!==e.prototype)return!1;if(i(t)!==i(e))return!1;var d=a(t),m=a(e);if(d!==m)return!1;if(d||m)return t.source===e.source&&s(t)===s(e);if(l(t)&&l(e))return u.call(t)===u.call(e);var g=f(t),v=f(e);if(g!==v)return!1;if(g||v){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!==typeof e)return!1;try{var y=r(t),_=r(e)}catch(x){return!1}if(y.length!==_.length)return!1;for(y.sort(),_.sort(),o=y.length-1;o>=0;o--)if(y[o]!=_[o])return!1;for(o=y.length-1;o>=0;o--)if(!c(t[p=y[o]],e[p],n))return!1;return!0}(t,e,p))}function h(t){return null===t||void 0===t}function f(t){return!(!t||"object"!==typeof t||"number"!==typeof t.length)&&("function"===typeof t.copy&&"function"===typeof t.slice&&!(t.length>0&&"number"!==typeof t[0]))}t.exports=c},9396:function(t,e,n){"use strict";var r=n(4892),i="function"===typeof Symbol&&"symbol"===typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,l=n(4510)(),u=s&&l,c=function(t,e,n,r){var i;(!(e in t)||"function"===typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(u?s(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},h=function(t,e){var n=arguments.length>2?arguments[2]:{},o=r(e);i&&(o=a.call(o,Object.getOwnPropertySymbols(e)));for(var s=0;s<o.length;s+=1)c(t,o[s],e[o[s]],n[o[s]])};h.supportsDescriptors=!!u,t.exports=h},7861:function(t){function e(t,e,n,r){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,r)}e.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var i=0;i<this._datasetLength;i++)if(1!==this._visited[i]){this._visited[i]=1;var o=this._regionQuery(i);if(o.length<this.minPts)this.noise.push(i);else{var a=this.clusters.length;this.clusters.push([]),this._addToCluster(i,a),this._expandCluster(a,o)}}return this.clusters},e.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(1!==this._visited[r]){this._visited[r]=1;var i=this._regionQuery(r);i.length>=this.minPts&&(e=this._mergeArrays(e,i))}1!==this._assigned[r]&&this._addToCluster(r,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++){this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n)}return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,r=0;r<n;r++){var i=e[r];t.indexOf(i)<0&&t.push(i)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=e)},2601:function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],"undefined"!==typeof t&&(this.dataset=t),"undefined"!==typeof e&&(this.k=e),"undefined"!==typeof n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,r=0;r<this.k;r++)this.centroids[r]=this.randomCentroid();for(var i=!0;i;){i=this.assign();for(var o=0;o<this.k;o++){for(var a=new Array(c),s=0,l=0;l<c;l++)a[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)a[l]+=this.dataset[u][l];s++}}if(s>0){for(l=0;l<c;l++)a[l]/=s;this.centroids[o]=a}else this.centroids[o]=this.randomCentroid(),i=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,r=0;r<n;r++)(t=this.argmin(this.dataset[r],this.centroids,this.distance))!=this.assignments[r]&&(this.assignments[r]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)"undefined"===typeof e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var r,i=Number.MAX_VALUE,o=0,a=e.length,s=0;s<a;s++)(r=n(t,e[s]))<i&&(i=r,o=s);return o},e.prototype.distance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;){var i=t[r]-e[r];n+=i*i}return Math.sqrt(n)},t.exports&&(t.exports=e)},3163:function(t,e,n){if(t.exports)var r=n(5047);function i(t,e,n,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,r)}i.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var o=0,a=this.dataset.length;o<a;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var s=this.clusters.length-1;this._orderedList.push(o);var l=new r(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(s,l))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var r=this._orderedList[e],i=this._reachability[r];t.push([r,i])}return t},i.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},i.prototype._updateQueue=function(t,e,n){var r=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===r._processed[e]){var i=r.distance(r.dataset[t],r.dataset[e]),o=Math.max(r._coreDistance,i);void 0===r._reachability[e]?(r._reachability[e]=o,n.insert(e,o)):o<r._reachability[e]&&(r._reachability[e]=o,n.remove(e),n.insert(e,o))}}))},i.prototype._expandCluster=function(t,e){for(var n=e.getElements(),r=0,i=n.length;r<i;r++){var o=n[r];if(void 0===this._processed[o]){var a=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,a,e),this._expandCluster(t,e))}}},i.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++){if(this._regionQuery(t,n).length>=this.minPts)return n}},i.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],r=0,i=this.dataset.length;r<i;r++)this.distance(this.dataset[t],this.dataset[r])<e&&n.push(r);return n},i.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=i)},5047:function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,r=n;r--;){var i=this._priorities[r];"desc"===this._sorting?e>i&&(n=r):e<i&&(n=r)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;){if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var r=0;r<t.length;r++)this.insert(t[r],e[r])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)},5107:function(t,e,n){t.exports&&(t.exports={DBSCAN:n(7861),KMEANS:n(2601),OPTICS:n(3163),PriorityQueue:n(5047)})},7089:function(t){"use strict";function e(t,e,r){r=r||2;var o,a,s,l,h,f,d,m=e&&e.length,g=m?e[0]*r:t.length,v=n(t,0,g,r,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,r,i){var o,a,s,l=[];for(o=0,a=e.length;o<a;o++)(s=n(t,e[o]*i,o<a-1?e[o+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),l.push(p(s));for(l.sort(u),o=0;o<l.length;o++)r=c(l[o],r);return r}(t,e,v,r)),t.length>80*r){o=s=t[0],a=l=t[1];for(var _=r;_<g;_+=r)(h=t[_])<o&&(o=h),(f=t[_+1])<a&&(a=f),h>s&&(s=h),f>l&&(l=f);d=0!==(d=Math.max(s-o,l-a))?32767/d:0}return i(v,y,r,o,a,d,0),y}function n(t,e,n,r,i){var o,a;if(i===C(t,e,n,r)>0)for(o=e;o<n;o+=r)a=S(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=S(o,t[o],t[o+1],a);return a&&v(a,a.next)&&(E(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!v(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(E(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,u,c,h,p){if(t){!p&&h&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=f(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,u,c,h);for(var d,m,g=t;t.prev!==t.next;)if(d=t.prev,m=t.next,h?a(t,u,c,h):o(t))e.push(d.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),E(t),t=m.next,g=m.next;else if((t=m)===g){p?1===p?i(t=s(r(t),e,n),e,n,u,c,h,2):2===p&&l(t,e,n,u,c,h):i(r(t),e,n,u,c,h,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,l=n.y,u=r.y,c=i<o?i<a?i:a:o<a?o:a,h=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,p=s>l?s>u?s:u:l>u?l:u,m=r.next;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=h&&m.y<=p&&d(i,s,o,l,a,u,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function a(t,e,n,r){var i=t.prev,o=t,a=t.next;if(g(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,h=o.y,p=a.y,m=s<l?s<u?s:u:l<u?l:u,v=c<h?c<p?c:p:h<p?h:p,y=s>l?s>u?s:u:l>u?l:u,_=c>h?c>p?c:p:h>p?h:p,x=f(m,v,e,n,r),b=f(y,_,e,n,r),w=t.prevZ,S=t.nextZ;w&&w.z>=x&&S&&S.z<=b;){if(w.x>=m&&w.x<=y&&w.y>=v&&w.y<=_&&w!==i&&w!==a&&d(s,c,l,h,u,p,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,S.x>=m&&S.x<=y&&S.y>=v&&S.y<=_&&S!==i&&S!==a&&d(s,c,l,h,u,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;w&&w.z>=x;){if(w.x>=m&&w.x<=y&&w.y>=v&&w.y<=_&&w!==i&&w!==a&&d(s,c,l,h,u,p,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=b;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=_&&S!==i&&S!==a&&d(s,c,l,h,u,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function s(t,e,n){var i=t;do{var o=i.prev,a=i.next.next;!v(o,a)&&y(o,i,i.next,a)&&b(o,a)&&b(a,o)&&(e.push(o.i/n|0),e.push(i.i/n|0),e.push(a.i/n|0),E(i),E(i.next),i=t=a),i=i.next}while(i!==t);return r(i)}function l(t,e,n,o,a,s){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var c=w(l,u);return l=r(l,l.next),c=r(c,c.next),i(l,e,n,o,a,s,0),void i(c,e,n,o,a,s,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,u=n,c=n.x,f=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&d(o<f?i:a,o,c,f,o<f?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),b(r,t)&&(l<p||l===p&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,p=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var i=w(n,t);return r(i,i.next),r(n,n.next)}function h(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function f(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function d(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,r){var i=x(g(t,e,n)),o=x(g(t,e,r)),a=x(g(n,r,t)),s=x(g(n,r,e));return i!==o&&a!==s||(!(0!==i||!_(t,n,e))||(!(0!==o||!_(t,r,e))||(!(0!==a||!_(n,t,r))||!(0!==s||!_(n,e,r)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x(t){return t>0?1:t<0?-1:0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function w(t,e){var n=new k(t.i,t.x,t.y),r=new k(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function S(t,e,n,r){var i=new k(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(C(t,0,o,n));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(C(t,u,c,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},222:function(t){"use strict";var e="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString,i="[object Function]";t.exports=function(t){var o=this;if("function"!==typeof o||r.call(o)!==i)throw new TypeError(e+o);for(var a,s=n.call(arguments,1),l=function(){if(this instanceof a){var e=o.apply(this,s.concat(n.call(arguments)));return Object(e)===e?e:this}return o.apply(t,s.concat(n.call(arguments)))},u=Math.max(0,o.length-s.length),c=[],h=0;h<u;h++)c.push("$"+h);if(a=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(l),o.prototype){var f=function(){};f.prototype=o.prototype,a.prototype=new f,f.prototype=null}return a}},3350:function(t,e,n){"use strict";var r=n(222);t.exports=Function.prototype.bind||r},4583:function(t){"use strict";var e=function(){return"string"===typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(i){n=null}e.functionsHaveConfigurableNames=function(){if(!e()||!n)return!1;var t=n((function(){}),"name");return!!t&&!!t.configurable};var r=Function.prototype.bind;e.boundFunctionsHaveNames=function(){return e()&&"function"===typeof r&&""!==function(){}.bind().name},t.exports=e},4042:function(t,e,n){var r=n(4058),i=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:s};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function a(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function s(t,e){return r(t,e,{strict:!0})}i.prototype.compare=function(t,e){if(t.type!==e.type||!a(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,r=o(t),i=o(e);return r.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),i)}}return!1},i.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(t,e,n,r){if(!a(t,e))return!1;var i=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!r||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var s=this.compareCoord(i[n],o[n]);return this.direction||s?this.comparePath(i,o):!!this.compareCoord(i[n],o[o.length-(1+n)])&&this.comparePath(i.slice().reverse(),o)}},i.prototype.fixStartIndex=function(t,e){for(var n,r=-1,i=0;i<t.length;i++)if(this.compareCoord(t[i],e[0])){r=i;break}return r>=0&&(n=[].concat(t.slice(r,t.length),t.slice(1,r+1))),n},i.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},i.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),r=e.coordinates.slice(1,e.coordinates.length),i=this;return n.every((function(t){return this.some((function(e){return i.compareLine(t,e,1,!0)}))}),r)}return!1},i.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},i.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},i.prototype.removePseudo=function(t){return t},t.exports=i},9234:function(t,e,n){var r=n(2968),i=n(7872),o=n(2538),a=n(2127).Z,s=o.featureEach,l=(o.coordEach,i.polygon,i.featureCollection);function u(t){var e=new r(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),r.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})):s(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})),r.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),r.prototype.remove.call(this,t,e)},e.clear=function(){return r.prototype.clear.call(this)},e.search=function(t){var e=r.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=r.prototype.all.call(this);return l(t)},e.toJSON=function(){return r.prototype.toJSON.call(this)},e.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=a(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=a(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},2968:function(t){t.exports=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/s+h)),Math.min(o,Math.floor(r+(s-l)*c/s+h)),a)}var f=n[r],p=i,d=o;for(e(n,i,r),a(n[o],f)>0&&e(n,i,o);p<d;){for(e(n,p,d),p++,d--;a(n[p],f)<0;)p++;for(;a(n[d],f)>0;)d--}0===a(n[i],f)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];s(i,t.leaf?r(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;p(t,s)&&(e.leaf?n.push(a):f(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),a.leaf){var c=i(t,a.children,e);if(-1!==c)return a.children.splice(c,1),l.push(a),this._condense(l),this}o||a.leaf||!f(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=d([])).leaf=!1,i.height=r;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));m(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);m(t,c,h,l,this.compareMinY);for(var f=c;f<=h;f+=l){var p=Math.min(f+l-1,h);i.children.push(this._build(t,f,p,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=c(l),h=(f=t,p=l,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-u);h<o?(o=h,i=u<i?u:i,a=l):h===o&&u<i&&(i=u,a=l)}e=a||e.children[0]}var f,p;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),s(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=d(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,l,u,h,f=1/0,p=1/0,d=e;d<=n-e;d++){var m=a(t,0,d,this.toBBox),g=a(t,d,n,this.toBBox),v=(i=m,o=g,s=void 0,l=void 0,u=void 0,h=void 0,s=Math.max(i.minX,o.minX),l=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,u-s)*Math.max(0,h-l)),y=c(m)+c(g);v<f?(f=v,r=d,p=y<p?y:p):v===f&&y<p&&(p=y,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),l=a(t,n-e,n,i),u=h(o)+h(l),c=e;c<n-e;c++){var f=t.children[c];s(o,t.leaf?i(f):f),u+=h(o)}for(var p=n-e-1;p>=e;p--){var d=t.children[p];s(l,t.leaf?i(d):d),u+=h(l)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},2506:function(t,e,n){"use strict";var r,i=SyntaxError,o=Function,a=TypeError,s=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(P){l=null}var u=function(){throw new a},c=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(e){return u}}}():u,h=n(697)(),f=Object.getPrototypeOf||function(t){return t.__proto__},p={},d="undefined"===typeof Uint8Array?r:f(Uint8Array),m={"%AggregateError%":"undefined"===typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"===typeof Atomics?r:Atomics,"%BigInt%":"undefined"===typeof BigInt?r:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":p,"%Int8Array%":"undefined"===typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?f(f([][Symbol.iterator]())):r,"%JSON%":"object"===typeof JSON?JSON:r,"%Map%":"undefined"===typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&h?f((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?r:Promise,"%Proxy%":"undefined"===typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&h?f((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?f(""[Symbol.iterator]()):r,"%Symbol%":h?Symbol:r,"%SyntaxError%":i,"%ThrowTypeError%":c,"%TypedArray%":d,"%TypeError%":a,"%Uint8Array%":"undefined"===typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?r:WeakSet},g=function t(e){var n;if("%AsyncFunction%"===e)n=s("async function () {}");else if("%GeneratorFunction%"===e)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=s("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=t("%AsyncGenerator%");i&&(n=f(i.prototype))}return m[e]=n,n},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=n(3350),_=n(8316),x=y.call(Function.call,Array.prototype.concat),b=y.call(Function.apply,Array.prototype.splice),w=y.call(Function.call,String.prototype.replace),S=y.call(Function.call,String.prototype.slice),E=y.call(Function.call,RegExp.prototype.exec),k=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,I=function(t){var e=S(t,0,1),n=S(t,-1);if("%"===e&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new i("invalid intrinsic syntax, expected opening `%`");var r=[];return w(t,k,(function(t,e,n,i){r[r.length]=n?w(i,C,"$1"):e||t})),r},T=function(t,e){var n,r=t;if(_(v,r)&&(r="%"+(n=v[r])[0]+"%"),_(m,r)){var o=m[r];if(o===p&&(o=g(r)),"undefined"===typeof o&&!e)throw new a("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new i("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!==typeof t||0===t.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof e)throw new a('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/,t))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=I(t),r=n.length>0?n[0]:"",o=T("%"+r+"%",e),s=o.name,u=o.value,c=!1,h=o.alias;h&&(r=h[0],b(n,x([0,1],h)));for(var f=1,p=!0;f<n.length;f+=1){var d=n[f],g=S(d,0,1),v=S(d,-1);if(('"'===g||"'"===g||"`"===g||'"'===v||"'"===v||"`"===v)&&g!==v)throw new i("property names with quotes must have matching quotes");if("constructor"!==d&&p||(c=!0),_(m,s="%"+(r+="."+d)+"%"))u=m[s];else if(null!=u){if(!(d in u)){if(!e)throw new a("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&f+1>=n.length){var y=l(u,d);u=(p=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[d]}else p=_(u,d),u=u[d];p&&!c&&(m[s]=u)}}return u}},4510:function(t,e,n){"use strict";var r=n(2506)("%Object.defineProperty%",!0),i=function(){if(r)try{return r({},"a",{value:1}),!0}catch(t){return!1}return!1};i.hasArrayLengthDefineBug=function(){if(!i())return null;try{return 1!==r([],"length",{value:1}).length}catch(t){return!0}},t.exports=i},697:function(t,e,n){"use strict";var r="undefined"!==typeof Symbol&&Symbol,i=n(3297);t.exports=function(){return"function"===typeof r&&("function"===typeof Symbol&&("symbol"===typeof r("foo")&&("symbol"===typeof Symbol("bar")&&i())))}},3297:function(t){"use strict";t.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"===typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"===typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(t,e);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},4707:function(t,e,n){"use strict";var r=n(3297);t.exports=function(){return r()&&!!Symbol.toStringTag}},8316:function(t,e,n){"use strict";var r=n(3350);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},1975:function(t,e,n){"use strict";var r=n(8309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(t){return r.isMemo(t)?a:s[t.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var u=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.prototype;t.exports=function t(e,n,r){if("string"!==typeof n){if(d){var i=p(n);i&&i!==d&&t(e,i,r)}var a=c(n);h&&(a=a.concat(h(n)));for(var s=l(e),m=l(n),g=0;g<a.length;++g){var v=a[g];if(!o[v]&&(!r||!r[v])&&(!m||!m[v])&&(!s||!s[v])){var y=f(n,v);try{u(e,v,y)}catch(_){}}}}return e}},746:function(t,e){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function b(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case c:case h:case o:case s:case a:case p:return t;default:switch(t=t&&t.$$typeof){case u:case f:case g:case m:case l:return t;default:return e}}case i:return e}}}function w(t){return b(t)===h}e.AsyncMode=c,e.ConcurrentMode=h,e.ContextConsumer=u,e.ContextProvider=l,e.Element=r,e.ForwardRef=f,e.Fragment=o,e.Lazy=g,e.Memo=m,e.Portal=i,e.Profiler=s,e.StrictMode=a,e.Suspense=p,e.isAsyncMode=function(t){return w(t)||b(t)===c},e.isConcurrentMode=w,e.isContextConsumer=function(t){return b(t)===u},e.isContextProvider=function(t){return b(t)===l},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return b(t)===f},e.isFragment=function(t){return b(t)===o},e.isLazy=function(t){return b(t)===g},e.isMemo=function(t){return b(t)===m},e.isPortal=function(t){return b(t)===i},e.isProfiler=function(t){return b(t)===s},e.isStrictMode=function(t){return b(t)===a},e.isSuspense=function(t){return b(t)===p},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===o||t===h||t===s||t===a||t===p||t===d||"object"===typeof t&&null!==t&&(t.$$typeof===g||t.$$typeof===m||t.$$typeof===l||t.$$typeof===u||t.$$typeof===f||t.$$typeof===y||t.$$typeof===_||t.$$typeof===x||t.$$typeof===v)},e.typeOf=b},8309:function(t,e,n){"use strict";t.exports=n(746)},5450:function(t,e,n){"use strict";var r=n(4707)(),i=n(4037)("Object.prototype.toString"),o=function(t){return!(r&&t&&"object"===typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===i(t)},a=function(t){return!!o(t)||null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Array]"!==i(t)&&"[object Function]"===i(t.callee)},s=function(){return o(arguments)}();o.isLegacyArguments=a,t.exports=s?o:a},2833:function(t,e,n){"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o=n(4707)();t.exports=function(t){return"object"===typeof t&&null!==t&&(o?function(t){try{return r.call(t),!0}catch(e){return!1}}(t):"[object Date]"===i.call(t))}},1146:function(t,e,n){"use strict";var r,i,o,a,s=n(4037),l=n(4707)();if(l){r=s("Object.prototype.hasOwnProperty"),i=s("RegExp.prototype.exec"),o={};var u=function(){throw o};a={toString:u,valueOf:u},"symbol"===typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=u)}var c=s("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!==typeof t)return!1;var e=h(t,"lastIndex");if(!(e&&r(e,"value")))return!1;try{i(t,a)}catch(n){return n===o}}:function(t){return!(!t||"object"!==typeof t&&"function"!==typeof t)&&"[object RegExp]"===c(t)}},1725:function(t){"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,o){for(var a,s,l=i(t),u=1;u<arguments.length;u++){for(var c in a=Object(arguments[u]))n.call(a,c)&&(l[c]=a[c]);if(e){s=e(a);for(var h=0;h<s.length;h++)r.call(a,s[h])&&(l[s[h]]=a[s[h]])}}return l}},2592:function(t){"use strict";var e=function(t){return t!==t};t.exports=function(t,n){return 0===t&&0===n?1/t===1/n:t===n||!(!e(t)||!e(n))}},3454:function(t,e,n){"use strict";var r=n(9396),i=n(9722),o=n(2592),a=n(3355),s=n(3118),l=i(a(),Object);r(l,{getPolyfill:a,implementation:o,shim:s}),t.exports=l},3355:function(t,e,n){"use strict";var r=n(2592);t.exports=function(){return"function"===typeof Object.is?Object.is:r}},3118:function(t,e,n){"use strict";var r=n(3355),i=n(9396);t.exports=function(){var t=r();return i(Object,{is:t},{is:function(){return Object.is!==t}}),t}},1949:function(t,e,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=n(7635),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"===typeof window)return!1;for(var t in window)try{if(!f["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"===typeof window[t])try{h(window[t])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(t){var e=null!==t&&"object"===typeof t,n="[object Function]"===o.call(t),r=a(t),s=e&&"[object String]"===o.call(t),f=[];if(!e&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var d=u&&n;if(s&&t.length>0&&!i.call(t,0))for(var m=0;m<t.length;++m)f.push(String(m));if(r&&t.length>0)for(var g=0;g<t.length;++g)f.push(String(g));else for(var v in t)d&&"prototype"===v||!i.call(t,v)||f.push(String(v));if(l)for(var y=function(t){if("undefined"===typeof window||!p)return h(t);try{return h(t)}catch(e){return!1}}(t),_=0;_<c.length;++_)y&&"constructor"===c[_]||!i.call(t,c[_])||f.push(c[_]);return f}}t.exports=r},4892:function(t,e,n){"use strict";var r=Array.prototype.slice,i=n(7635),o=Object.keys,a=o?function(t){return o(t)}:n(1949),s=Object.keys;a.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return i(t)?s(r.call(t)):s(t)})}else Object.keys=a;return Object.keys||a},t.exports=a},7635:function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),r}},5164:function(t){t.exports=function(t,e,n,r){var i=t[0],o=t[1],a=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var s=(r-n)/2,l=0,u=s-1;l<s;u=l++){var c=e[n+2*l+0],h=e[n+2*l+1],f=e[n+2*u+0],p=e[n+2*u+1];h>o!==p>o&&i<(f-c)*(o-h)/(p-h)+c&&(a=!a)}return a}},5021:function(t,e,n){var r=n(5164),i=n(1850);t.exports=function(t,e,n,o){return e.length>0&&Array.isArray(e[0])?i(t,e,n,o):r(t,e,n,o)},t.exports.nested=i,t.exports.flat=r},1850:function(t){t.exports=function(t,e,n,r){var i=t[0],o=t[1],a=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var s=r-n,l=0,u=s-1;l<s;u=l++){var c=e[l+n][0],h=e[l+n][1],f=e[u+n][0],p=e[u+n][1];h>o!==p>o&&i<(f-c)*(o-h)/(p-h)+c&&(a=!a)}return a}},9056:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}var r=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function i(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){for(var i=new r(null,null),o=i,a=i;;){var s=n(t,e.key);if(s<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}a.left=e,a=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,a.left=e.right,e.left=i.right,e.right=i.left,e}function a(t,e,n,i){var a=new r(t,e);if(null===n)return a.left=a.right=null,a;var s=i(t,(n=o(t,n,i)).key);return s<0?(a.left=n.left,a.right=n,n.left=null):s>=0&&(a.right=n.right,a.left=n,n.right=null),a}function s(t,e,n){var r=null,i=null;if(e){var a=n((e=o(t,e,n)).key,t);0===a?(r=e.left,i=e.right):a<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function l(t,e,n){return null===e?t:(null===t||((e=o(t.key,e,n)).left=t),e)}function u(t,e,n,r,i){if(t){r(e+(n?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+i(t)+"\n");var o=e+(n?"    ":"\u2502   ");t.left&&u(t.left,o,!1,r,i),t.right&&u(t.right,o,!0,r,i)}}var c=function(){function t(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new r(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,a=o(t,this._root,i),s=i(t,a.key);return 0===s?this._root=a:(s<0?(n.left=a.left,n.right=a,a.left=null):s>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=o(t,e,n)).key)?(null===e.left?r=e.right:(r=o(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(o((a=i.pop()).key,e)>0)break;if(o(a.key,t)>=0&&n.call(r,a))return this;a=a.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return p(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,i=this._comparator;if(n&&g(t,e,0,r-1,i),null===this._root)this._root=h(t,e,0,r),this._size=r;else{var o=m(this.toList(),f(t,e),i);r=this._size+r,this._root=d({head:o},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return u(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=s(t,this._root,r),o=i.left,u=i.right;r(t,e)<0?u=a(e,n,u,r):o=a(e,n,o,r),this._root=l(o,u,r)},t.prototype.split=function(t){return s(t,this._root,this._comparator)},t}();function h(t,e,n,i){var o=i-n;if(o>0){var a=n+Math.floor(o/2),s=t[a],l=e[a],u=new r(s,l);return u.left=h(t,e,n,a),u.right=h(t,e,a+1,i),u}return null}function f(t,e){for(var n=new r(null,null),i=n,o=0;o<t.length;o++)i=i.next=new r(t[o],e[o]);return i.next=null,n.next}function p(t){for(var e=t,n=[],i=!1,o=new r(null,null),a=o;!i;)e?(n.push(e),e=e.left):n.length>0?e=(e=a=a.next=n.pop()).right:i=!0;return a.next=null,o.next}function d(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=d(t,e,i),a=t.head;return a.left=o,t.head=t.head.next,a.right=d(t,i+1,n),a}return null}function m(t,e,n){for(var i=new r(null,null),o=i,a=t,s=e;null!==a&&null!==s;)n(a.key,s.key)<0?(o.next=a,a=a.next):(o.next=s,s=s.next),o=o.next;return null!==a?o.next=a:null!==s&&(o.next=s),i.next}function g(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],a=n-1,s=r+1;;){do{a++}while(i(t[a],o)<0);do{s--}while(i(t[s],o)>0);if(a>=s)break;var l=t[a];t[a]=t[s],t[s]=l,l=e[a],e[a]=e[s],e[s]=l}g(t,e,n,s,i),g(t,e,s+1,r,i)}}var v=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},y=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},_=Number.EPSILON;void 0===_&&(_=Math.pow(2,-52));var x=_*_,b=function(t,e){if(-_<t&&t<_&&-_<e&&e<_)return 0;var n=t-e;return n*n<x*t*e?0:t<e?-1:1},w=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new S,this.yRounder=new S}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),S=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===b(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===b(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),e}(),E=new w,k=function(t,e){return t.x*e.y-t.y*e.x},C=function(t,e){return t.x*e.x+t.y*e.y},I=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=k(r,i);return b(o,0)},T=function(t){return Math.sqrt(C(t,t))},P=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return k(i,r)/T(i)/T(r)},A=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return C(i,r)/T(i)/T(r)},M=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},L=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},R=function(t,e,n,r){if(0===e.x)return L(n,r,t.x);if(0===r.x)return L(t,e,n.x);if(0===e.y)return M(n,r,t.y);if(0===r.y)return M(t,e,n.y);var i=k(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},a=k(o,e)/i,s=k(o,r)/i;return{x:(t.x+s*e.x+(n.x+a*r.x))/2,y:(t.y+s*e.y+(n.y+a*r.y))/2}},D=function(){function e(n,r){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=r}return n(e,null,[{key:"compare",value:function(t,n){var r=e.comparePoints(t.point,n.point);return 0!==r?r:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:z.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i=r.otherSE;n.set(r,{sine:P(e.point,t.point,i.point),cosine:A(e.point,t.point,i.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,a=i.cosine,s=n.get(e),l=s.sine,u=s.cosine;return o>=0&&l>=0?a<u?1:a>u?-1:0:o<0&&l<0?a<u?-1:a>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),N=0,z=function(){function e(n,r,i,o){t(this,e),this.id=++N,this.leftSE=n,n.segment=this,n.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=n,this.rings=i,this.windings=o}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var a=t.leftSE.point.y,s=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<r){if(s<a&&s<l)return 1;if(s>a&&s>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(n>r){if(a<s&&a<u)return-1;if(a>s&&a>u)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(a<s)return-1;if(a>s)return 1;if(i<o){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(i>o){var m=t.comparePoint(e.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(i!==o){var g=l-a,v=i-n,y=u-s,_=o-r;if(g>v&&y<_)return 1;if(g<v&&y>_)return-1}return i>o?1:i<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var a=(t.x-e.x)/r.x,s=e.y+a*r.y;return t.y===s?0:t.y<s?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=y(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,a=t.leftSE.point,s=t.rightSE.point,l=v(e,a)&&0===this.comparePoint(a),u=v(n,i)&&0===t.comparePoint(i),c=v(e,s)&&0===this.comparePoint(s),h=v(n,o)&&0===t.comparePoint(o);if(u&&l)return h&&!c?o:!h&&c?s:null;if(u)return c&&i.x===s.x&&i.y===s.y?null:i;if(l)return h&&o.x===a.x&&o.y===a.y?null:a;if(h&&c)return null;if(h)return o;if(c)return s;var f=R(i,this.vector(),a,t.vector());return null===f?null:v(r,f)?E.round(f.x,f.y):null}},{key:"split",value:function(t){var n=[],r=void 0!==t.events,i=new D(t,!0),o=new D(t,!1),a=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var s=new e(i,a,this.rings.slice(),this.windings.slice());return D.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),D.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,r=t;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=e.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var a=n;n=r,r=a}for(var s=0,l=r.rings.length;s<l;s++){var u=r.rings[s],c=r.windings[s],h=n.rings.indexOf(u);-1===h?(n.rings.push(u),n.windings.push(c)):n.windings[h]+=c}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var a=this.rings[i],s=this.windings[i],l=e.indexOf(a);-1===l?(e.push(a),n.push(s)):n[l]+=s}for(var u=[],c=[],h=0,f=e.length;h<f;h++)if(0!==n[h]){var p=e[h],d=p.poly;if(-1===c.indexOf(d))if(p.isExterior)u.push(d);else{-1===c.indexOf(d)&&c.push(d);var m=u.indexOf(p.poly);-1!==m&&u.splice(m,1)}}for(var g=0,v=u.length;g<v;g++){var y=u[g].multiPoly;-1===r.indexOf(y)&&r.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(W.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===W.numMultiPolys&&i<o;break;case"xor":var a=Math.abs(t.length-e.length);this._isInResult=a%2===1;break;case"difference":var s=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=s(t)!==s(e);break;default:throw new Error("Unrecognized operation type found ".concat(W.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,r){var i,o,a,s=D.comparePoints(t,n);if(s<0)i=t,o=n,a=1;else{if(!(s>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=n,o=t,a=-1}return new e(new D(i,!0),new D(o,!1),[r],[a])}}]),e}(),O=function(){function e(n,r,i){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!==typeof n[0][0]||"number"!==typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=E.round(n[0][0],n[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var a=o,s=1,l=n.length;s<l;s++){if("number"!==typeof n[s][0]||"number"!==typeof n[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=E.round(n[s][0],n[s][1]);u.x===a.x&&u.y===a.y||(this.segments.push(z.fromRing(a,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),a=u)}o.x===a.x&&o.y===a.y||this.segments.push(z.fromRing(a,o,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),e}(),F=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new O(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=n.length;i<o;i++){var a=new O(n[i],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),B=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof n[0][0][0]&&(n=[n])}catch(s){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=n.length;i<o;i++){var a=new F(n[i],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),j=function(){function e(n){t(this,e),this.events=n;for(var r=0,i=n.length;r<i;r++)n[r].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];if(o.isInResult()&&!o.ringOut){for(var a=null,s=o.leftSE,l=o.rightSE,u=[s],c=s.point,h=[];a=s,s=l,u.push(s),s.point!==c;)for(;;){var f=s.getAvailableLinkedEvents();if(0===f.length){var p=u[0].point,d=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===f.length){l=f[0].otherSE;break}for(var m=null,g=0,v=h.length;g<v;g++)if(h[g].point===s.point){m=g;break}if(null===m){h.push({index:u.length,point:s.point});var y=s.getLeftmostComparator(a);l=f.sort(y)[0].otherSE;break}var _=h.splice(m)[0],x=u.splice(_.index);x.unshift(x[0].otherSE),n.push(new e(x.reverse()))}n.push(new e(u))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==I(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var a=e[0],s=e[1];0===I(a,t,s)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,h=[],f=u;f!=c;f+=l)h.push([e[f].x,e[f].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];D.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),e}(),U=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),e}(),V=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new U(i));else{var o=i.enclosingRing();o.poly||e.push(new U(o)),o.poly.addInterior(i)}}return e}}]),e}(),Z=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z.compare;t(this,e),this.queue=n,this.tree=new c(r),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,a=void 0,s=void 0;void 0===a;)null===(i=this.tree.prev(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);for(;void 0===s;)null===(o=this.tree.next(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);if(t.isLeft){var l=null;if(a){var u=a.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!a.isAnEndpoint(u)))for(var c=this._splitSafely(a,u),h=0,f=c.length;h<f;h++)n.push(c[h])}var p=null;if(s){var d=s.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(p=d),!s.isAnEndpoint(d)))for(var m=this._splitSafely(s,d),g=0,v=m.length;g<v;g++)n.push(m[g])}if(null!==l||null!==p){var y=null;y=null===l?p:null===p||D.comparePoints(l,p)<=0?l:p,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(y),x=0,b=_.length;x<b;x++)n.push(_[x])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=a)}else{if(a&&s){var w=a.getIntersection(s);if(null!==w){if(!a.isAnEndpoint(w))for(var S=this._splitSafely(a,w),E=0,k=S.length;E<k;E++)n.push(S[E]);if(!s.isAnEndpoint(w))for(var C=this._splitSafely(s,w),I=0,T=C.length;I<T;I++)n.push(C[I])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),e}(),q="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,G="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,W=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){W.type=t,E.reset();for(var r=[new B(e,!0)],i=0,o=n.length;i<o;i++)r.push(new B(n[i],!1));if(W.numMultiPolys=r.length,"difference"===W.type)for(var a=r[0],s=1;s<r.length;)null!==y(r[s].bbox,a.bbox)?s++:r.splice(s,1);if("intersection"===W.type)for(var l=0,u=r.length;l<u;l++)for(var h=r[l],f=l+1,p=r.length;f<p;f++)if(null===y(h.bbox,r[f].bbox))return[];for(var d=new c(D.compare),m=0,g=r.length;m<g;m++)for(var v=r[m].getSweepEvents(),_=0,x=v.length;_<x;_++)if(d.insert(v[_]),d.size>q)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var b=new Z(d),w=d.size,S=d.pop();S;){var k=S.key;if(d.size===w){var C=k.segment;throw new Error("Unable to pop() ".concat(k.isLeft?"left":"right"," SweepEvent ")+"[".concat(k.point.x,", ").concat(k.point.y,"] from segment #").concat(C.id," ")+"[".concat(C.leftSE.point.x,", ").concat(C.leftSE.point.y,"] -> ")+"[".concat(C.rightSE.point.x,", ").concat(C.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>q)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(b.segments.length>G)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var I=b.process(k),T=0,P=I.length;T<P;T++){var A=I[T];void 0===A.consumedBy&&d.insert(A)}w=d.size,S=d.pop()}E.reset();var M=j.factory(b.segments);return new V(M).getGeom()}}]),e}()),X=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return W.run("union",t,n)},H=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return W.run("intersection",t,n)},Y=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return W.run("xor",t,n)},$=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return W.run("difference",t,n)};return{union:X,intersection:H,xor:Y,difference:$}}()},888:function(t,e,n){"use strict";var r=n(9047);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},2007:function(t,e,n){t.exports=n(888)()},9047:function(t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1977:function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=n(5287);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],l(i,t.leaf?r(o):o);return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,i,o){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(a=e+Math.ceil((n-e)/i/2)*i,r(t,a,e,n,o),s.push(e,a,a,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!m(t,e))return n;for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],m(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):d(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],m(t,a=e.leaf?n(o):o)){if(e.leaf||d(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,a,s=this.data,l=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),r=u[u.length-1],n=c.pop(),a=!0),s.leaf&&-1!==(i=o(t,s.children,e)))return s.children.splice(i,1),u.push(s),this._condense(u),this;a||s.leaf||!d(s,l)?r?(n++,s=r.children[n],a=!1):s=null:(u.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)return a(i=g(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=g([])).leaf=!1,i.height=r;var l,u,c,h,f=Math.ceil(o/s),p=f*Math.ceil(Math.sqrt(s));for(v(t,e,n,p,this.compareMinX),l=e;l<=n;l+=p)for(v(t,l,c=Math.min(l+p-1,n),f,this.compareMinY),u=l;u<=c;u+=f)h=Math.min(u+f-1,c),i.children.push(this._build(t,u,h,r-1));return a(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,l,u,c,f,p,d;r.push(e),!e.leaf&&r.length-1!==n;){for(c=f=1/0,i=0,o=e.children.length;i<o;i++)l=h(a=e.children[i]),p=t,d=a,(u=(Math.max(d.maxX,p.maxX)-Math.min(d.minX,p.minX))*(Math.max(d.maxY,p.maxY)-Math.min(d.minY,p.minY))-l)<f?(f=u,c=l<c?l:c,s=a):u===f&&l<c&&(c=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),l(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=g(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,a,l,u,c,f;for(u=c=1/0,r=e;r<=n-e;r++)a=p(i=s(t,0,r,this.toBBox),o=s(t,r,n,this.toBBox)),l=h(i)+h(o),a<u?(u=a,f=r,c=l<c?l:c):a===u&&l<c&&(c=l,f=r);return f},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,a=this.toBBox,u=s(t,0,e,a),c=s(t,n-e,n,a),h=f(u)+f(c);for(i=e;i<n-e;i++)o=t.children[i],l(u,t.leaf?a(o):o),h+=f(u);for(i=n-e-1;i>=e;i--)o=t.children[i],l(c,t.leaf?a(o):o),h+=f(c);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},5287:function(t){t.exports=function(){"use strict";function t(t,n,i,o,a){e(t,n,i||0,o||t.length-1,a||r)}function e(t,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-l*c/s+h)),Math.min(o,Math.floor(r+(s-l)*c/s+h)),a)}var f=t[r],p=i,d=o;for(n(t,i,r),a(t[o],f)>0&&n(t,i,o);p<d;){for(n(t,p,d),p++,d--;a(t[p],f)<0;)p++;for(;a(t[d],f)>0;)d--}0===a(t[i],f)?n(t,i,d):n(t,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}function n(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function r(t,e){return t<e?-1:t>e?1:0}return t}()},4463:function(t,e,n){"use strict";var r=n(2791),i=n(1725),o=n(5296);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=new Set,l={};function u(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(l[t]=e,t=0;t<e.length;t++)s.add(e[t])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p=Object.prototype.hasOwnProperty,d={},m={};function g(t,e,n,r,i,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){v[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];v[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){v[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){v[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){v[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){v[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){v[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){v[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){v[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function x(t,e,n,r){var i=v.hasOwnProperty(e)?v[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!p.call(m,t)||!p.call(d,t)&&(f.test(t)?m[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,_);v[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,_);v[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,_);v[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){v[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){v[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=60103,S=60106,E=60107,k=60108,C=60114,I=60109,T=60110,P=60112,A=60113,M=60120,L=60115,R=60116,D=60121,N=60128,z=60129,O=60130,F=60131;if("function"===typeof Symbol&&Symbol.for){var B=Symbol.for;w=B("react.element"),S=B("react.portal"),E=B("react.fragment"),k=B("react.strict_mode"),C=B("react.profiler"),I=B("react.provider"),T=B("react.context"),P=B("react.forward_ref"),A=B("react.suspense"),M=B("react.suspense_list"),L=B("react.memo"),R=B("react.lazy"),D=B("react.block"),B("react.scope"),N=B("react.opaque.id"),z=B("react.debug_trace_mode"),O=B("react.offscreen"),F=B("react.legacy_hidden")}var j,U="function"===typeof Symbol&&Symbol.iterator;function V(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=U&&t[U]||t["@@iterator"])?t:null}function Z(t){if(void 0===j)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);j=e&&e[1]||""}return"\n"+j+t}var q=!1;function G(t,e){if(!t||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s])return"\n"+i[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Z(t):""}function W(t){switch(t.tag){case 5:return Z(t.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return t=G(t.type,!1);case 11:return t=G(t.type.render,!1);case 22:return t=G(t.type._render,!1);case 1:return t=G(t.type,!0);default:return""}}function X(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case E:return"Fragment";case S:return"Portal";case C:return"Profiler";case k:return"StrictMode";case A:return"Suspense";case M:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case T:return(t.displayName||"Context")+".Consumer";case I:return(t._context.displayName||"Context")+".Provider";case P:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case L:return X(t.type);case D:return X(t._render);case R:e=t._payload,t=t._init;try{return X(t(e))}catch(n){}}return null}function H(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function $(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function K(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Y(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function J(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Q(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=H(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&x(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=H(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?it(t,e.type,n):e.hasOwnProperty("defaultValue")&&it(t,e.type,H(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function rt(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function it(t,e,n){"number"===e&&J(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function ot(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function at(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+H(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function st(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:H(n)}}function ut(t,e){var n=H(e.value),r=H(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ct(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ht="http://www.w3.org/1999/xhtml",ft="http://www.w3.org/2000/svg";function pt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?pt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var mt,gt,vt=(gt=function(t,e){if(t.namespaceURI!==ft||"innerHTML"in t)t.innerHTML=e;else{for((mt=mt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return gt(t,e)}))}:gt);function yt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var _t={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xt=["Webkit","ms","Moz","O"];function bt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||_t.hasOwnProperty(t)&&_t[t]?(""+e).trim():e+"px"}function wt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=bt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(_t).forEach((function(t){xt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_t[e]=_t[t]}))}));var St=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Et(t,e){if(e){if(St[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62))}}function kt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ct(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var It=null,Tt=null,Pt=null;function At(t){if(t=ri(t)){if("function"!==typeof It)throw Error(a(280));var e=t.stateNode;e&&(e=oi(e),It(t.stateNode,t.type,e))}}function Mt(t){Tt?Pt?Pt.push(t):Pt=[t]:Tt=t}function Lt(){if(Tt){var t=Tt,e=Pt;if(Pt=Tt=null,At(t),e)for(t=0;t<e.length;t++)At(e[t])}}function Rt(t,e){return t(e)}function Dt(t,e,n,r,i){return t(e,n,r,i)}function Nt(){}var zt=Rt,Ot=!1,Ft=!1;function Bt(){null===Tt&&null===Pt||(Nt(),Lt())}function jt(t,e){var n=t.stateNode;if(null===n)return null;var r=oi(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}var Ut=!1;if(h)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(gt){Ut=!1}function Zt(t,e,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var qt=!1,Gt=null,Wt=!1,Xt=null,Ht={onError:function(t){qt=!0,Gt=t}};function Yt(t,e,n,r,i,o,a,s,l){qt=!1,Gt=null,Zt.apply(Ht,arguments)}function $t(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Kt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Jt(t){if($t(t)!==t)throw Error(a(188))}function Qt(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Jt(i),t;if(o===r)return Jt(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function te(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var ee,ne,re,ie,oe=!1,ae=[],se=null,le=null,ue=null,ce=new Map,he=new Map,fe=[],pe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function de(t,e,n,r,i){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function me(t,e){switch(t){case"focusin":case"focusout":se=null;break;case"dragenter":case"dragleave":le=null;break;case"mouseover":case"mouseout":ue=null;break;case"pointerover":case"pointerout":ce.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":he.delete(e.pointerId)}}function ge(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t=de(e,n,r,i,o),null!==e&&(null!==(e=ri(e))&&ne(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function ve(t){var e=ni(t.target);if(null!==e){var n=$t(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Kt(n)))return t.blockedOn=e,void ie(t.lanePriority,(function(){o.unstable_runWithPriority(t.priority,(function(){re(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ye(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ri(n))&&ne(e),t.blockedOn=n,!1;e.shift()}return!0}function _e(t,e,n){ye(t)&&n.delete(e)}function xe(){for(oe=!1;0<ae.length;){var t=ae[0];if(null!==t.blockedOn){null!==(t=ri(t.blockedOn))&&ee(t);break}for(var e=t.targetContainers;0<e.length;){var n=Qe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&ae.shift()}null!==se&&ye(se)&&(se=null),null!==le&&ye(le)&&(le=null),null!==ue&&ye(ue)&&(ue=null),ce.forEach(_e),he.forEach(_e)}function be(t,e){t.blockedOn===e&&(t.blockedOn=null,oe||(oe=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,xe)))}function we(t){function e(e){return be(e,t)}if(0<ae.length){be(ae[0],t);for(var n=1;n<ae.length;n++){var r=ae[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==se&&be(se,t),null!==le&&be(le,t),null!==ue&&be(ue,t),ce.forEach(e),he.forEach(e),n=0;n<fe.length;n++)(r=fe[n]).blockedOn===t&&(r.blockedOn=null);for(;0<fe.length&&null===(n=fe[0]).blockedOn;)ve(n),null===n.blockedOn&&fe.shift()}function Se(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ee={animationend:Se("Animation","AnimationEnd"),animationiteration:Se("Animation","AnimationIteration"),animationstart:Se("Animation","AnimationStart"),transitionend:Se("Transition","TransitionEnd")},ke={},Ce={};function Ie(t){if(ke[t])return ke[t];if(!Ee[t])return t;var e,n=Ee[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ce)return ke[t]=n[e];return t}h&&(Ce=document.createElement("div").style,"AnimationEvent"in window||(delete Ee.animationend.animation,delete Ee.animationiteration.animation,delete Ee.animationstart.animation),"TransitionEvent"in window||delete Ee.transitionend.transition);var Te=Ie("animationend"),Pe=Ie("animationiteration"),Ae=Ie("animationstart"),Me=Ie("transitionend"),Le=new Map,Re=new Map,De=["abort","abort",Te,"animationEnd",Pe,"animationIteration",Ae,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Me,"transitionEnd","waiting","waiting"];function Ne(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],i=t[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Re.set(r,e),Le.set(r,i),u(i,[r])}}(0,o.unstable_now)();var ze=8;function Oe(t){if(0!==(1&t))return ze=15,1;if(0!==(2&t))return ze=14,2;if(0!==(4&t))return ze=13,4;var e=24&t;return 0!==e?(ze=12,e):0!==(32&t)?(ze=11,32):0!==(e=192&t)?(ze=10,e):0!==(256&t)?(ze=9,256):0!==(e=3584&t)?(ze=8,e):0!==(4096&t)?(ze=7,4096):0!==(e=4186112&t)?(ze=6,e):0!==(e=62914560&t)?(ze=5,e):67108864&t?(ze=4,67108864):0!==(134217728&t)?(ze=3,134217728):0!==(e=805306368&t)?(ze=2,e):0!==(1073741824&t)?(ze=1,1073741824):(ze=8,t)}function Fe(t,e){var n=t.pendingLanes;if(0===n)return ze=0;var r=0,i=0,o=t.expiredLanes,a=t.suspendedLanes,s=t.pingedLanes;if(0!==o)r=o,i=ze=15;else if(0!==(o=134217727&n)){var l=o&~a;0!==l?(r=Oe(l),i=ze):0!==(s&=o)&&(r=Oe(s),i=ze)}else 0!==(o=n&~a)?(r=Oe(o),i=ze):0!==s&&(r=Oe(s),i=ze);if(0===r)return 0;if(r=n&((0>(r=31-qe(r))?0:1<<r)<<1)-1,0!==e&&e!==r&&0===(e&a)){if(Oe(e),i<=ze)return e;ze=i}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-qe(e)),r|=t[n],e&=~i;return r}function Be(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function je(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=Ue(24&~e))?je(10,e):t;case 10:return 0===(t=Ue(192&~e))?je(8,e):t;case 8:return 0===(t=Ue(3584&~e))&&(0===(t=Ue(4186112&~e))&&(t=512)),t;case 2:return 0===(e=Ue(805306368&~e))&&(e=268435456),e}throw Error(a(358,t))}function Ue(t){return t&-t}function Ve(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ze(t,e,n){t.pendingLanes|=e;var r=e-1;t.suspendedLanes&=r,t.pingedLanes&=r,(t=t.eventTimes)[e=31-qe(e)]=n}var qe=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ge(t)/We|0)|0},Ge=Math.log,We=Math.LN2;var Xe=o.unstable_UserBlockingPriority,He=o.unstable_runWithPriority,Ye=!0;function $e(t,e,n,r){Ot||Nt();var i=Je,o=Ot;Ot=!0;try{Dt(i,t,e,n,r)}finally{(Ot=o)||Bt()}}function Ke(t,e,n,r){He(Xe,Je.bind(null,t,e,n,r))}function Je(t,e,n,r){var i;if(Ye)if((i=0===(4&e))&&0<ae.length&&-1<pe.indexOf(t))t=de(null,t,e,n,r),ae.push(t);else{var o=Qe(t,e,n,r);if(null===o)i&&me(t,r);else{if(i){if(-1<pe.indexOf(t))return t=de(o,t,e,n,r),void ae.push(t);if(function(t,e,n,r,i){switch(e){case"focusin":return se=ge(se,t,e,n,r,i),!0;case"dragenter":return le=ge(le,t,e,n,r,i),!0;case"mouseover":return ue=ge(ue,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ce.set(o,ge(ce.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,he.set(o,ge(he.get(o)||null,t,e,n,r,i)),!0}return!1}(o,t,e,n,r))return;me(t,r)}Nr(t,e,r,null,n)}}}function Qe(t,e,n,r){var i=Ct(r);if(null!==(i=ni(i))){var o=$t(i);if(null===o)i=null;else{var a=o.tag;if(13===a){if(null!==(i=Kt(o)))return i;i=null}else if(3===a){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Nr(t,e,r,i,n),null}var tn=null,en=null,nn=null;function rn(){if(nn)return nn;var t,e,n=en,r=n.length,i="value"in tn?tn.value:tn.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return nn=i.slice(t,1<e?1-e:void 0)}function on(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function an(){return!0}function sn(){return!1}function ln(t){function e(e,n,r,i,o){for(var a in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?an:sn,this.isPropagationStopped=sn,this}return i(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),e}var un,cn,hn,fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pn=ln(fn),dn=i({},fn,{view:0,detail:0}),mn=ln(dn),gn=i({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hn&&(hn&&"mousemove"===t.type?(un=t.screenX-hn.screenX,cn=t.screenY-hn.screenY):cn=un=0,hn=t),un)},movementY:function(t){return"movementY"in t?t.movementY:cn}}),vn=ln(gn),yn=ln(i({},gn,{dataTransfer:0})),_n=ln(i({},dn,{relatedTarget:0})),xn=ln(i({},fn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=i({},fn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wn=ln(bn),Sn=ln(i({},fn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Cn[t])&&!!e[t]}function Tn(){return In}var Pn=i({},dn,{key:function(t){if(t.key){var e=En[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=on(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?kn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(t){return"keypress"===t.type?on(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?on(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),An=ln(Pn),Mn=ln(i({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ln=ln(i({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Rn=ln(i({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=i({},gn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=ln(Dn),zn=[9,13,27,32],On=h&&"CompositionEvent"in window,Fn=null;h&&"documentMode"in document&&(Fn=document.documentMode);var Bn=h&&"TextEvent"in window&&!Fn,jn=h&&(!On||Fn&&8<Fn&&11>=Fn),Un=String.fromCharCode(32),Vn=!1;function Zn(t,e){switch(t){case"keyup":return-1!==zn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Gn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Hn(t,e,n,r){Mt(r),0<(e=Or(e,"onChange")).length&&(n=new pn("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Yn=null,$n=null;function Kn(t){Pr(t,0)}function Jn(t){if(K(ii(t)))return t}function Qn(t,e){if("change"===t)return e}var tr=!1;if(h){var er;if(h){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}er=nr}else er=!1;tr=er&&(!document.documentMode||9<document.documentMode)}function ir(){Yn&&(Yn.detachEvent("onpropertychange",or),$n=Yn=null)}function or(t){if("value"===t.propertyName&&Jn($n)){var e=[];if(Hn(e,$n,t,Ct(t)),t=Kn,Ot)t(e);else{Ot=!0;try{Rt(t,e)}finally{Ot=!1,Bt()}}}}function ar(t,e,n){"focusin"===t?(ir(),$n=n,(Yn=e).attachEvent("onpropertychange",or)):"focusout"===t&&ir()}function sr(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Jn($n)}function lr(t,e){if("click"===t)return Jn(e)}function ur(t,e){if("input"===t||"change"===t)return Jn(e)}var cr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},hr=Object.prototype.hasOwnProperty;function fr(t,e){if(cr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!hr.call(e,n[r])||!cr(t[n[r]],e[n[r]]))return!1;return!0}function pr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dr(t,e){var n,r=pr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=pr(r)}}function mr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?mr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function gr(){for(var t=window,e=J();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=J((t=e.contentWindow).document)}return e}function vr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var yr=h&&"documentMode"in document&&11>=document.documentMode,_r=null,xr=null,br=null,wr=!1;function Sr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==_r||_r!==J(r)||("selectionStart"in(r=_r)&&vr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&fr(br,r)||(br=r,0<(r=Or(xr,"onSelect")).length&&(e=new pn("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_r)))}Ne("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ne("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ne(De,2);for(var Er="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),kr=0;kr<Er.length;kr++)Re.set(Er[kr],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ir=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cr));function Tr(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,o,s,l,u){if(Yt.apply(this,arguments),qt){if(!qt)throw Error(a(198));var c=Gt;qt=!1,Gt=null,Wt||(Wt=!0,Xt=c)}}(r,e,void 0,t),t.currentTarget=null}function Pr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break t;Tr(i,s,u),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break t;Tr(i,s,u),o=l}}}if(Wt)throw t=Xt,Wt=!1,Xt=null,t}function Ar(t,e){var n=ai(e),r=t+"__bubble";n.has(r)||(Dr(e,t,2,!1),n.add(r))}var Mr="_reactListening"+Math.random().toString(36).slice(2);function Lr(t){t[Mr]||(t[Mr]=!0,s.forEach((function(e){Ir.has(e)||Rr(e,!1,t,null),Rr(e,!0,t,null)})))}function Rr(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===t&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!e&&Ir.has(t)){if("scroll"!==t)return;i|=2,o=r}var a=ai(o),s=t+"__"+(e?"capture":"bubble");a.has(s)||(e&&(i|=4),Dr(o,t,i,e),a.add(s))}function Dr(t,e,n,r){var i=Re.get(e);switch(void 0===i?2:i){case 0:i=$e;break;case 1:i=Ke;break;default:i=Je}n=i.bind(null,e,n,t),i=void 0,!Ut||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Nr(t,e,n,r,i){var o=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=ni(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue t}s=s.parentNode}}r=r.return}!function(t,e,n){if(Ft)return t(e,n);Ft=!0;try{zt(t,e,n)}finally{Ft=!1,Bt()}}((function(){var r=o,i=Ct(n),a=[];t:{var s=Le.get(t);if(void 0!==s){var l=pn,u=t;switch(t){case"keypress":if(0===on(n))break t;case"keydown":case"keyup":l=An;break;case"focusin":u="focus",l=_n;break;case"focusout":u="blur",l=_n;break;case"beforeblur":case"afterblur":l=_n;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ln;break;case Te:case Pe:case Ae:l=xn;break;case Me:l=Rn;break;case"scroll":l=mn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var c=0!==(4&e),h=!c&&"scroll"===t,f=c?null!==s?s+"Capture":null:s;c=[];for(var p,d=r;null!==d;){var m=(p=d).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==f&&(null!=(m=jt(d,f))&&c.push(zr(d,m,p)))),h)break;d=d.return}0<c.length&&(s=new l(s,u,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||0!==(16&e)||!(u=n.relatedTarget||n.fromElement)||!ni(u)&&!u[ti])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?ni(u):null)&&(u!==(h=$t(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=vn,m="onMouseLeave",f="onMouseEnter",d="mouse","pointerout"!==t&&"pointerover"!==t||(c=Mn,m="onPointerLeave",f="onPointerEnter",d="pointer"),h=null==l?s:ii(l),p=null==u?s:ii(u),(s=new c(m,d+"leave",l,n,i)).target=h,s.relatedTarget=p,m=null,ni(i)===r&&((c=new c(f,d+"enter",u,n,i)).target=p,c.relatedTarget=h,m=c),h=m,l&&u)t:{for(f=u,d=0,p=c=l;p;p=Fr(p))d++;for(p=0,m=f;m;m=Fr(m))p++;for(;0<d-p;)c=Fr(c),d--;for(;0<p-d;)f=Fr(f),p--;for(;d--;){if(c===f||null!==f&&c===f.alternate)break t;c=Fr(c),f=Fr(f)}c=null}else c=null;null!==l&&Br(a,s,l,c,!1),null!==u&&null!==h&&Br(a,h,u,c,!0)}if("select"===(l=(s=r?ii(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Qn;else if(Xn(s))if(tr)g=ur;else{g=sr;var v=ar}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=lr);switch(g&&(g=g(t,r))?Hn(a,g,n,i):(v&&v(t,s,r),"focusout"===t&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&it(s,"number",s.value)),v=r?ii(r):window,t){case"focusin":(Xn(v)||"true"===v.contentEditable)&&(_r=v,xr=r,br=null);break;case"focusout":br=xr=_r=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,Sr(a,n,i);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":Sr(a,n,i)}var y;if(On)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Gn?Zn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(jn&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Gn&&(y=rn()):(en="value"in(tn=i)?tn.value:tn.textContent,Gn=!0)),0<(v=Or(r,_)).length&&(_=new Sn(_,t,null,n,i),a.push({event:_,listeners:v}),y?_.data=y:null!==(y=qn(n))&&(_.data=y))),(y=Bn?function(t,e){switch(t){case"compositionend":return qn(e);case"keypress":return 32!==e.which?null:(Vn=!0,Un);case"textInput":return(t=e.data)===Un&&Vn?null:t;default:return null}}(t,n):function(t,e){if(Gn)return"compositionend"===t||!On&&Zn(t,e)?(t=rn(),nn=en=tn=null,Gn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=Or(r,"onBeforeInput")).length&&(i=new Sn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Pr(a,e)}))}function zr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Or(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=jt(t,n))&&r.unshift(zr(t,o,i)),null!=(o=jt(t,e))&&r.push(zr(t,o,i))),t=t.return}return r}function Fr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Br(t,e,n,r,i){for(var o=e._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=jt(n,o))&&a.unshift(zr(n,l,s)):i||null!=(l=jt(n,o))&&a.push(zr(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}function jr(){}var Ur=null,Vr=null;function Zr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function qr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Gr="function"===typeof setTimeout?setTimeout:void 0,Wr="function"===typeof clearTimeout?clearTimeout:void 0;function Xr(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function Hr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Yr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var $r=0;var Kr=Math.random().toString(36).slice(2),Jr="__reactFiber$"+Kr,Qr="__reactProps$"+Kr,ti="__reactContainer$"+Kr,ei="__reactEvents$"+Kr;function ni(t){var e=t[Jr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ti]||n[Jr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Yr(t);null!==t;){if(n=t[Jr])return n;t=Yr(t)}return e}n=(t=n).parentNode}return null}function ri(t){return!(t=t[Jr]||t[ti])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function ii(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function oi(t){return t[Qr]||null}function ai(t){var e=t[ei];return void 0===e&&(e=t[ei]=new Set),e}var si=[],li=-1;function ui(t){return{current:t}}function ci(t){0>li||(t.current=si[li],si[li]=null,li--)}function hi(t,e){li++,si[li]=t.current,t.current=e}var fi={},pi=ui(fi),di=ui(!1),mi=fi;function gi(t,e){var n=t.type.contextTypes;if(!n)return fi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function vi(t){return null!==(t=t.childContextTypes)&&void 0!==t}function yi(){ci(di),ci(pi)}function _i(t,e,n){if(pi.current!==fi)throw Error(a(168));hi(pi,e),hi(di,n)}function xi(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,X(e)||"Unknown",o));return i({},n,r)}function bi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fi,mi=pi.current,hi(pi,t),hi(di,di.current),!0}function wi(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=xi(t,e,mi),r.__reactInternalMemoizedMergedChildContext=t,ci(di),ci(pi),hi(pi,t)):ci(di),hi(di,n)}var Si=null,Ei=null,ki=o.unstable_runWithPriority,Ci=o.unstable_scheduleCallback,Ii=o.unstable_cancelCallback,Ti=o.unstable_shouldYield,Pi=o.unstable_requestPaint,Ai=o.unstable_now,Mi=o.unstable_getCurrentPriorityLevel,Li=o.unstable_ImmediatePriority,Ri=o.unstable_UserBlockingPriority,Di=o.unstable_NormalPriority,Ni=o.unstable_LowPriority,zi=o.unstable_IdlePriority,Oi={},Fi=void 0!==Pi?Pi:function(){},Bi=null,ji=null,Ui=!1,Vi=Ai(),Zi=1e4>Vi?Ai:function(){return Ai()-Vi};function qi(){switch(Mi()){case Li:return 99;case Ri:return 98;case Di:return 97;case Ni:return 96;case zi:return 95;default:throw Error(a(332))}}function Gi(t){switch(t){case 99:return Li;case 98:return Ri;case 97:return Di;case 96:return Ni;case 95:return zi;default:throw Error(a(332))}}function Wi(t,e){return t=Gi(t),ki(t,e)}function Xi(t,e,n){return t=Gi(t),Ci(t,e,n)}function Hi(){if(null!==ji){var t=ji;ji=null,Ii(t)}Yi()}function Yi(){if(!Ui&&null!==Bi){Ui=!0;var t=0;try{var e=Bi;Wi(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Bi=null}catch(n){throw null!==Bi&&(Bi=Bi.slice(t+1)),Ci(Li,Hi),n}finally{Ui=!1}}}var $i=b.ReactCurrentBatchConfig;function Ki(t,e){if(t&&t.defaultProps){for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var Ji=ui(null),Qi=null,to=null,eo=null;function no(){eo=to=Qi=null}function ro(t){var e=Ji.current;ci(Ji),t.type._context._currentValue=e}function io(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function oo(t,e){Qi=t,eo=to=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Oa=!0),t.firstContext=null)}function ao(t,e){if(eo!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(eo=t,e=1073741823),e={context:t,observedBits:e,next:null},null===to){if(null===Qi)throw Error(a(308));to=e,Qi.dependencies={lanes:0,firstContext:e,responders:null}}else to=to.next=e;return t._currentValue}var so=!1;function lo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function uo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function co(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ho(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function fo(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=e:o=o.next=e}else i=o=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function po(t,e,n,r){var o=t.updateQueue;so=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?a=c:s.next=c,s=u;var h=t.alternate;if(null!==h){var f=(h=h.updateQueue).lastBaseUpdate;f!==s&&(null===f?h.firstBaseUpdate=c:f.next=c,h.lastBaseUpdate=u)}}if(null!==a){for(f=o.baseState,s=0,h=c=u=null;;){l=a.lane;var p=a.eventTime;if((r&l)===l){null!==h&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var d=t,m=a;switch(l=e,p=n,m.tag){case 1:if("function"===typeof(d=m.payload)){f=d.call(p,f,l);break t}f=d;break t;case 3:d.flags=-4097&d.flags|64;case 0:if(null===(l="function"===typeof(d=m.payload)?d.call(p,f,l):d)||void 0===l)break t;f=i({},f,l);break t;case 2:so=!0}}null!==a.callback&&(t.flags|=32,null===(l=o.effects)?o.effects=[a]:l.push(a))}else p={eventTime:p,lane:l,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===h?(c=h=p,u=f):h=h.next=p,s|=l;if(null===(a=a.next)){if(null===(l=o.shared.pending))break;a=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===h&&(u=f),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=h,Us|=s,t.lanes=s,t.memoizedState=f}}function mo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var go=(new r.Component).refs;function vo(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:i({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var yo={isMounted:function(t){return!!(t=t._reactInternals)&&$t(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fl(),i=pl(t),o=co(r,i);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),ho(t,o),dl(t,i,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fl(),i=pl(t),o=co(r,i);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),ho(t,o),dl(t,i,r)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fl(),r=pl(t),i=co(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),ho(t,i),dl(t,r,n)}};function _o(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!fr(n,r)||!fr(i,o))}function xo(t,e,n){var r=!1,i=fi,o=e.contextType;return"object"===typeof o&&null!==o?o=ao(o):(i=vi(e)?mi:pi.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?gi(t,i):fi),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=yo,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function bo(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&yo.enqueueReplaceState(e,e.state,null)}function wo(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=go,lo(t);var o=e.contextType;"object"===typeof o&&null!==o?i.context=ao(o):(o=vi(e)?mi:pi.current,i.context=gi(t,o)),po(t,n,i,r),i.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(vo(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&yo.enqueueReplaceState(i,i.state,null),po(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4)}var So=Array.isArray;function Eo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===i?e.ref:(e=function(t){var e=r.refs;e===go&&(e=r.refs={}),null===t?delete e[i]:e[i]=t},e._stringRef=i,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function ko(t,e){if("textarea"!==t.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function Co(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Wl(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags=2,n):r:(e.flags=2,n):n}function s(e){return t&&null===e.alternate&&(e.flags=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=$l(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function u(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=Eo(t,e,n),r.return=t,r):((r=Xl(n.type,n.key,n.props,null,t.mode,r)).ref=Eo(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Kl(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=Hl(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function f(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=$l(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(n=Xl(e.type,e.key,e.props,null,t.mode,n)).ref=Eo(t,null,e),n.return=t,n;case S:return(e=Kl(e,t.mode,n)).return=t,e}if(So(e)||V(e))return(e=Hl(e,t.mode,n,null)).return=t,e;ko(t,e)}return null}function p(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:l(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?n.type===E?h(t,e,n.props.children,r,i):u(t,e,n,r):null;case S:return n.key===i?c(t,e,n,r):null}if(So(n)||V(n))return null!==i?null:h(t,e,n,r,null);ko(t,n)}return null}function d(t,e,n,r,i){if("string"===typeof r||"number"===typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return t=t.get(null===r.key?n:r.key)||null,r.type===E?h(e,t,r.props.children,i,r.key):u(e,t,r,i);case S:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(So(r)||V(r))return h(e,t=t.get(n)||null,r,i,null);ko(e,r)}return null}function m(i,a,s,l){for(var u=null,c=null,h=a,m=a=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(i,h,s[m],l);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(i,h),a=o(v,a,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===s.length)return n(i,h),u;if(null===h){for(;m<s.length;m++)null!==(h=f(i,s[m],l))&&(a=o(h,a,m),null===c?u=h:c.sibling=h,c=h);return u}for(h=r(i,h);m<s.length;m++)null!==(g=d(h,i,m,s[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(i,t)})),u}function g(i,s,l,u){var c=V(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var h=c=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=p(i,m,y.value,u);if(null===_){null===m&&(m=v);break}t&&m&&null===_.alternate&&e(i,m),s=o(_,s,g),null===h?c=_:h.sibling=_,h=_,m=v}if(y.done)return n(i,m),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=f(i,y.value,u))&&(s=o(y,s,g),null===h?c=y:h.sibling=y,h=y);return c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=d(m,i,g,y.value,u))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===h?c=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(i,t)})),c}return function(t,r,o,l){var u="object"===typeof o&&null!==o&&o.type===E&&null===o.key;u&&(o=o.props.children);var c="object"===typeof o&&null!==o;if(c)switch(o.$$typeof){case w:t:{for(c=o.key,u=r;null!==u;){if(u.key===c){if(7===u.tag){if(o.type===E){n(t,u.sibling),(r=i(u,o.props.children)).return=t,t=r;break t}}else if(u.elementType===o.type){n(t,u.sibling),(r=i(u,o.props)).ref=Eo(t,u,o),r.return=t,t=r;break t}n(t,u);break}e(t,u),u=u.sibling}o.type===E?((r=Hl(o.props.children,t.mode,l,o.key)).return=t,t=r):((l=Xl(o.type,o.key,o.props,null,t.mode,l)).ref=Eo(t,r,o),l.return=t,t=l)}return s(t);case S:t:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Kl(o,t.mode,l)).return=t,t=r}return s(t)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=$l(o,t.mode,l)).return=t,t=r),s(t);if(So(o))return m(t,r,o,l);if(V(o))return g(t,r,o,l);if(c&&ko(t,o),"undefined"===typeof o&&!u)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,X(t.type)||"Component"))}return n(t,r)}}var Io=Co(!0),To=Co(!1),Po={},Ao=ui(Po),Mo=ui(Po),Lo=ui(Po);function Ro(t){if(t===Po)throw Error(a(174));return t}function Do(t,e){switch(hi(Lo,e),hi(Mo,t),hi(Ao,Po),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dt(null,"");break;default:e=dt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}ci(Ao),hi(Ao,e)}function No(){ci(Ao),ci(Mo),ci(Lo)}function zo(t){Ro(Lo.current);var e=Ro(Ao.current),n=dt(e,t.type);e!==n&&(hi(Mo,t),hi(Ao,n))}function Oo(t){Mo.current===t&&(ci(Ao),ci(Mo))}var Fo=ui(0);function Bo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jo=null,Uo=null,Vo=!1;function Zo(t,e){var n=ql(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function qo(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Go(t){if(Vo){var e=Uo;if(e){var n=e;if(!qo(t,e)){if(!(e=Hr(n.nextSibling))||!qo(t,e))return t.flags=-1025&t.flags|2,Vo=!1,void(jo=t);Zo(jo,n)}jo=t,Uo=Hr(e.firstChild)}else t.flags=-1025&t.flags|2,Vo=!1,jo=t}}function Wo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;jo=t}function Xo(t){if(t!==jo)return!1;if(!Vo)return Wo(t),Vo=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!qr(e,t.memoizedProps))for(e=Uo;e;)Zo(t,e),e=Hr(e.nextSibling);if(Wo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Uo=Hr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Uo=null}}else Uo=jo?Hr(t.stateNode.nextSibling):null;return!0}function Ho(){Uo=jo=null,Vo=!1}var Yo=[];function $o(){for(var t=0;t<Yo.length;t++)Yo[t]._workInProgressVersionPrimary=null;Yo.length=0}var Ko=b.ReactCurrentDispatcher,Jo=b.ReactCurrentBatchConfig,Qo=0,ta=null,ea=null,na=null,ra=!1,ia=!1;function oa(){throw Error(a(321))}function aa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function sa(t,e,n,r,i,o){if(Qo=o,ta=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ko.current=null===t||null===t.memoizedState?Ra:Da,t=n(r,i),ia){o=0;do{if(ia=!1,!(25>o))throw Error(a(301));o+=1,na=ea=null,e.updateQueue=null,Ko.current=Na,t=n(r,i)}while(ia)}if(Ko.current=La,e=null!==ea&&null!==ea.next,Qo=0,na=ea=ta=null,ra=!1,e)throw Error(a(300));return t}function la(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===na?ta.memoizedState=na=t:na=na.next=t,na}function ua(){if(null===ea){var t=ta.alternate;t=null!==t?t.memoizedState:null}else t=ea.next;var e=null===na?ta.memoizedState:na.next;if(null!==e)na=e,ea=t;else{if(null===t)throw Error(a(310));t={memoizedState:(ea=t).memoizedState,baseState:ea.baseState,baseQueue:ea.baseQueue,queue:ea.queue,next:null},null===na?ta.memoizedState=na=t:na=na.next=t}return na}function ca(t,e){return"function"===typeof e?e(t):e}function ha(t){var e=ua(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=ea,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=s=o=null,u=i;do{var c=u.lane;if((Qo&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===t?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=h,o=r):l=l.next=h,ta.lanes|=c,Us|=c}u=u.next}while(null!==u&&u!==i);null===l?o=r:l.next=s,cr(r,e.memoizedState)||(Oa=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function fa(t){var e=ua(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);cr(o,e.memoizedState)||(Oa=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function pa(t,e,n){var r=e._getVersion;r=r(e._source);var i=e._workInProgressVersionPrimary;if(null!==i?t=i===r:(t=t.mutableReadLanes,(t=(Qo&t)===t)&&(e._workInProgressVersionPrimary=r,Yo.push(e))),t)return n(e._source);throw Yo.push(e),Error(a(350))}function da(t,e,n,r){var i=Rs;if(null===i)throw Error(a(349));var o=e._getVersion,s=o(e._source),l=Ko.current,u=l.useState((function(){return pa(i,e,n)})),c=u[1],h=u[0];u=na;var f=t.memoizedState,p=f.refs,d=p.getSnapshot,m=f.source;f=f.subscribe;var g=ta;return t.memoizedState={refs:p,source:e,subscribe:r},l.useEffect((function(){p.getSnapshot=n,p.setSnapshot=c;var t=o(e._source);if(!cr(s,t)){t=n(e._source),cr(h,t)||(c(t),t=pl(g),i.mutableReadLanes|=t&i.pendingLanes),t=i.mutableReadLanes,i.entangledLanes|=t;for(var r=i.entanglements,a=t;0<a;){var l=31-qe(a),u=1<<l;r[l]|=t,a&=~u}}}),[n,e,r]),l.useEffect((function(){return r(e._source,(function(){var t=p.getSnapshot,n=p.setSnapshot;try{n(t(e._source));var r=pl(g);i.mutableReadLanes|=r&i.pendingLanes}catch(o){n((function(){throw o}))}}))}),[e,r]),cr(d,n)&&cr(m,e)&&cr(f,r)||((t={pending:null,dispatch:null,lastRenderedReducer:ca,lastRenderedState:h}).dispatch=c=Ma.bind(null,ta,t),u.queue=t,u.baseQueue=null,h=pa(i,e,n),u.memoizedState=u.baseState=h),h}function ma(t,e,n){return da(ua(),t,e,n)}function ga(t){var e=la();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:ca,lastRenderedState:t}).dispatch=Ma.bind(null,ta,t),[e.memoizedState,t]}function va(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=ta.updateQueue)?(e={lastEffect:null},ta.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function ya(t){return t={current:t},la().memoizedState=t}function _a(){return ua().memoizedState}function xa(t,e,n,r){var i=la();ta.flags|=t,i.memoizedState=va(1|e,n,void 0,void 0===r?null:r)}function ba(t,e,n,r){var i=ua();r=void 0===r?null:r;var o=void 0;if(null!==ea){var a=ea.memoizedState;if(o=a.destroy,null!==r&&aa(r,a.deps))return void va(e,n,o,r)}ta.flags|=t,i.memoizedState=va(1|e,n,o,r)}function wa(t,e){return xa(516,4,t,e)}function Sa(t,e){return ba(516,4,t,e)}function Ea(t,e){return ba(4,2,t,e)}function ka(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ca(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ba(4,2,ka.bind(null,e,t),n)}function Ia(){}function Ta(t,e){var n=ua();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&aa(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Pa(t,e){var n=ua();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&aa(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Aa(t,e){var n=qi();Wi(98>n?98:n,(function(){t(!0)})),Wi(97<n?97:n,(function(){var n=Jo.transition;Jo.transition=1;try{t(!1),e()}finally{Jo.transition=n}}))}function Ma(t,e,n){var r=fl(),i=pl(t),o={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},a=e.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),e.pending=o,a=t.alternate,t===ta||null!==a&&a===ta)ia=ra=!0;else{if(0===t.lanes&&(null===a||0===a.lanes)&&null!==(a=e.lastRenderedReducer))try{var s=e.lastRenderedState,l=a(s,n);if(o.eagerReducer=a,o.eagerState=l,cr(l,s))return}catch(u){}dl(t,i,r)}}var La={readContext:ao,useCallback:oa,useContext:oa,useEffect:oa,useImperativeHandle:oa,useLayoutEffect:oa,useMemo:oa,useReducer:oa,useRef:oa,useState:oa,useDebugValue:oa,useDeferredValue:oa,useTransition:oa,useMutableSource:oa,useOpaqueIdentifier:oa,unstable_isNewReconciler:!1},Ra={readContext:ao,useCallback:function(t,e){return la().memoizedState=[t,void 0===e?null:e],t},useContext:ao,useEffect:wa,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,xa(4,2,ka.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xa(4,2,t,e)},useMemo:function(t,e){var n=la();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=la();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Ma.bind(null,ta,t),[r.memoizedState,t]},useRef:ya,useState:ga,useDebugValue:Ia,useDeferredValue:function(t){var e=ga(t),n=e[0],r=e[1];return wa((function(){var e=Jo.transition;Jo.transition=1;try{r(t)}finally{Jo.transition=e}}),[t]),n},useTransition:function(){var t=ga(!1),e=t[0];return ya(t=Aa.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var r=la();return r.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},da(r,t,e,n)},useOpaqueIdentifier:function(){if(Vo){var t=!1,e=function(t){return{$$typeof:N,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+($r++).toString(36))),Error(a(355))})),n=ga(e)[1];return 0===(2&ta.mode)&&(ta.flags|=516,va(5,(function(){n("r:"+($r++).toString(36))}),void 0,null)),e}return ga(e="r:"+($r++).toString(36)),e},unstable_isNewReconciler:!1},Da={readContext:ao,useCallback:Ta,useContext:ao,useEffect:Sa,useImperativeHandle:Ca,useLayoutEffect:Ea,useMemo:Pa,useReducer:ha,useRef:_a,useState:function(){return ha(ca)},useDebugValue:Ia,useDeferredValue:function(t){var e=ha(ca),n=e[0],r=e[1];return Sa((function(){var e=Jo.transition;Jo.transition=1;try{r(t)}finally{Jo.transition=e}}),[t]),n},useTransition:function(){var t=ha(ca)[0];return[_a().current,t]},useMutableSource:ma,useOpaqueIdentifier:function(){return ha(ca)[0]},unstable_isNewReconciler:!1},Na={readContext:ao,useCallback:Ta,useContext:ao,useEffect:Sa,useImperativeHandle:Ca,useLayoutEffect:Ea,useMemo:Pa,useReducer:fa,useRef:_a,useState:function(){return fa(ca)},useDebugValue:Ia,useDeferredValue:function(t){var e=fa(ca),n=e[0],r=e[1];return Sa((function(){var e=Jo.transition;Jo.transition=1;try{r(t)}finally{Jo.transition=e}}),[t]),n},useTransition:function(){var t=fa(ca)[0];return[_a().current,t]},useMutableSource:ma,useOpaqueIdentifier:function(){return fa(ca)[0]},unstable_isNewReconciler:!1},za=b.ReactCurrentOwner,Oa=!1;function Fa(t,e,n,r){e.child=null===t?To(e,null,n,r):Io(e,t.child,n,r)}function Ba(t,e,n,r,i){n=n.render;var o=e.ref;return oo(e,i),r=sa(t,e,n,r,o,i),null===t||Oa?(e.flags|=1,Fa(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,os(t,e,i))}function ja(t,e,n,r,i,o){if(null===t){var a=n.type;return"function"!==typeof a||Gl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Xl(n.type,null,r,e,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Ua(t,e,a,r,i,o))}return a=t.child,0===(i&o)&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:fr)(i,r)&&t.ref===e.ref)?os(t,e,o):(e.flags|=1,(t=Wl(a,r)).ref=e.ref,t.return=e,e.child=t)}function Ua(t,e,n,r,i,o){if(null!==t&&fr(t.memoizedProps,r)&&t.ref===e.ref){if(Oa=!1,0===(o&i))return e.lanes=t.lanes,os(t,e,o);0!==(16384&t.flags)&&(Oa=!0)}return qa(t,e,n,r,o)}function Va(t,e,n){var r=e.pendingProps,i=r.children,o=null!==t?t.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},wl(e,n);else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},wl(e,t),null;e.memoizedState={baseLanes:0},wl(e,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,e.memoizedState=null):r=n,wl(e,r);return Fa(t,e,i,n),e.child}function Za(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function qa(t,e,n,r,i){var o=vi(n)?mi:pi.current;return o=gi(e,o),oo(e,i),n=sa(t,e,n,r,o,i),null===t||Oa?(e.flags|=1,Fa(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,os(t,e,i))}function Ga(t,e,n,r,i){if(vi(n)){var o=!0;bi(e)}else o=!1;if(oo(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),xo(e,n,r),wo(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=ao(u):u=gi(e,u=vi(n)?mi:pi.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==u)&&bo(e,a,r,u),so=!1;var f=e.memoizedState;a.state=f,po(e,r,a,i),l=e.memoizedState,s!==r||f!==l||di.current||so?("function"===typeof c&&(vo(e,n,c,r),l=e.memoizedState),(s=so||_o(e,n,s,r,f,l,u))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4)):("function"===typeof a.componentDidMount&&(e.flags|=4),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"===typeof a.componentDidMount&&(e.flags|=4),r=!1)}else{a=e.stateNode,uo(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:Ki(e.type,s),a.props=u,h=e.pendingProps,f=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=ao(l):l=gi(e,l=vi(n)?mi:pi.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||f!==l)&&bo(e,a,r,l),so=!1,f=e.memoizedState,a.state=f,po(e,r,a,i);var d=e.memoizedState;s!==h||f!==d||di.current||so?("function"===typeof p&&(vo(e,n,p,r),d=e.memoizedState),(u=so||_o(e,n,u,r,f,d,l))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,d,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,d,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=256),e.memoizedProps=r,e.memoizedState=d),a.props=r,a.state=d,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=256),r=!1)}return Wa(t,e,n,r,o,i)}function Wa(t,e,n,r,i,o){Za(t,e);var a=0!==(64&e.flags);if(!r&&!a)return i&&wi(e,n,!1),os(t,e,o);r=e.stateNode,za.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&a?(e.child=Io(e,t.child,null,o),e.child=Io(e,null,s,o)):Fa(t,e,s,o),e.memoizedState=r.state,i&&wi(e,n,!0),e.child}function Xa(t){var e=t.stateNode;e.pendingContext?_i(0,e.pendingContext,e.pendingContext!==e.context):e.context&&_i(0,e.context,!1),Do(t,e.containerInfo)}var Ha,Ya,$a,Ka={dehydrated:null,retryLane:0};function Ja(t,e,n){var r,i=e.pendingProps,o=Fo.current,a=!1;return(r=0!==(64&e.flags))||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(a=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(o|=1),hi(Fo,1&o),null===t?(void 0!==i.fallback&&Go(e),t=i.children,o=i.fallback,a?(t=Qa(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ka,t):"number"===typeof i.unstable_expectedLoadTime?(t=Qa(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ka,e.lanes=33554432,t):((n=Yl({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,a?(i=es(t,e,i.children,i.fallback,n),a=e.child,o=t.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=t.childLanes&~n,e.memoizedState=Ka,i):(n=ts(t,e,i.children,n),e.memoizedState=null,n))}function Qa(t,e,n,r){var i=t.mode,o=t.child;return e={mode:"hidden",children:e},0===(2&i)&&null!==o?(o.childLanes=0,o.pendingProps=e):o=Yl(e,i,0,null),n=Hl(n,i,r,null),o.return=t,n.return=t,o.sibling=n,t.child=o,n}function ts(t,e,n,r){var i=t.child;return t=i.sibling,n=Wl(i,{mode:"visible",children:n}),0===(2&e.mode)&&(n.lanes=r),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}function es(t,e,n,r,i){var o=e.mode,a=t.child;t=a.sibling;var s={mode:"hidden",children:n};return 0===(2&o)&&e.child!==a?((n=e.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=a,a.nextEffect=null):e.firstEffect=e.lastEffect=null):n=Wl(a,s),null!==t?r=Wl(t,r):(r=Hl(r,o,i,null)).flags|=2,r.return=e,n.return=e,n.sibling=r,e.child=n,r}function ns(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),io(t.return,e)}function rs(t,e,n,r,i,o){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:o}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.lastEffect=o)}function is(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Fa(t,e,r.children,n),0!==(2&(r=Fo.current)))r=1&r|2,e.flags|=64;else{if(null!==t&&0!==(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ns(t,n);else if(19===t.tag)ns(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(hi(Fo,r),0===(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===Bo(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),rs(e,!1,i,n,o,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Bo(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}rs(e,!0,n,null,o,e.lastEffect);break;case"together":rs(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function os(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Us|=e.lanes,0!==(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=Wl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Wl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function as(t,e){if(!Vo)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ss(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return vi(e.type)&&yi(),null;case 3:return No(),ci(di),ci(pi),$o(),(r=e.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(Xo(e)?e.flags|=4:r.hydrate||(e.flags|=256)),null;case 5:Oo(e);var o=Ro(Lo.current);if(n=e.type,null!==t&&null!=e.stateNode)Ya(t,e,n,r),t.ref!==e.ref&&(e.flags|=128);else{if(!r){if(null===e.stateNode)throw Error(a(166));return null}if(t=Ro(Ao.current),Xo(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Jr]=e,r[Qr]=s,n){case"dialog":Ar("cancel",r),Ar("close",r);break;case"iframe":case"object":case"embed":Ar("load",r);break;case"video":case"audio":for(t=0;t<Cr.length;t++)Ar(Cr[t],r);break;case"source":Ar("error",r);break;case"img":case"image":case"link":Ar("error",r),Ar("load",r);break;case"details":Ar("toggle",r);break;case"input":tt(r,s),Ar("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ar("invalid",r);break;case"textarea":lt(r,s),Ar("invalid",r)}for(var u in Et(n,s),t=null,s)s.hasOwnProperty(u)&&(o=s[u],"children"===u?"string"===typeof o?r.textContent!==o&&(t=["children",o]):"number"===typeof o&&r.textContent!==""+o&&(t=["children",""+o]):l.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&Ar("scroll",r));switch(n){case"input":$(r),rt(r,s,!0);break;case"textarea":$(r),ct(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=jr)}r=t,e.updateQueue=r,null!==r&&(e.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,t===ht&&(t=pt(n)),t===ht?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=u.createElement(n,{is:r.is}):(t=u.createElement(n),"select"===n&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,n),t[Jr]=e,t[Qr]=r,Ha(t,e),e.stateNode=t,u=kt(n,r),n){case"dialog":Ar("cancel",t),Ar("close",t),o=r;break;case"iframe":case"object":case"embed":Ar("load",t),o=r;break;case"video":case"audio":for(o=0;o<Cr.length;o++)Ar(Cr[o],t);o=r;break;case"source":Ar("error",t),o=r;break;case"img":case"image":case"link":Ar("error",t),Ar("load",t),o=r;break;case"details":Ar("toggle",t),o=r;break;case"input":tt(t,r),o=Q(t,r),Ar("invalid",t);break;case"option":o=ot(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=i({},r,{value:void 0}),Ar("invalid",t);break;case"textarea":lt(t,r),o=st(t,r),Ar("invalid",t);break;default:o=r}Et(n,o);var c=o;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?wt(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&vt(t,h):"children"===s?"string"===typeof h?("textarea"!==n||""!==h)&&yt(t,h):"number"===typeof h&&yt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(l.hasOwnProperty(s)?null!=h&&"onScroll"===s&&Ar("scroll",t):null!=h&&x(t,s,h,u))}switch(n){case"input":$(t),rt(t,r,!1);break;case"textarea":$(t),ct(t);break;case"option":null!=r.value&&t.setAttribute("value",""+H(r.value));break;case"select":t.multiple=!!r.multiple,null!=(s=r.value)?at(t,!!r.multiple,s,!1):null!=r.defaultValue&&at(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(t.onclick=jr)}Zr(n,r)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)$a(0,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(a(166));n=Ro(Lo.current),Ro(Ao.current),Xo(e)?(r=e.stateNode,n=e.memoizedProps,r[Jr]=e,r.nodeValue!==n&&(e.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Jr]=e,e.stateNode=r)}return null;case 13:return ci(Fo),r=e.memoizedState,0!==(64&e.flags)?(e.lanes=n,e):(r=null!==r,n=!1,null===t?void 0!==e.memoizedProps.fallback&&Xo(e):n=null!==t.memoizedState,r&&!n&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Fo.current)?0===Fs&&(Fs=3):(0!==Fs&&3!==Fs||(Fs=4),null===Rs||0===(134217727&Us)&&0===(134217727&Vs)||yl(Rs,Ns))),(r||n)&&(e.flags|=4),null);case 4:return No(),null===t&&Lr(e.stateNode.containerInfo),null;case 10:return ro(e),null;case 19:if(ci(Fo),null===(r=e.memoizedState))return null;if(s=0!==(64&e.flags),null===(u=r.rendering))if(s)as(r,!1);else{if(0!==Fs||null!==t&&0!==(64&t.flags))for(t=e.child;null!==t;){if(null!==(u=Bo(t))){for(e.flags|=64,as(r,!1),null!==(s=u.updateQueue)&&(e.updateQueue=s,e.flags|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=n,n=e.child;null!==n;)t=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(u=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return hi(Fo,1&Fo.current|2),e.child}t=t.sibling}null!==r.tail&&Zi()>Ws&&(e.flags|=64,s=!0,as(r,!1),e.lanes=33554432)}else{if(!s)if(null!==(t=Bo(u))){if(e.flags|=64,s=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),as(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Vo)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Zi()-r.renderingStartTime>Ws&&1073741824!==n&&(e.flags|=64,s=!0,as(r,!1),e.lanes=33554432);r.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=r.last)?n.sibling=u:e.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Zi(),n.sibling=null,e=Fo.current,hi(Fo,s?1&e|2:1&e),n):null;case 23:case 24:return Sl(),null!==t&&null!==t.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(e.flags|=4),null}throw Error(a(156,e.tag))}function ls(t){switch(t.tag){case 1:vi(t.type)&&yi();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(No(),ci(di),ci(pi),$o(),0!==(64&(e=t.flags)))throw Error(a(285));return t.flags=-4097&e|64,t;case 5:return Oo(t),null;case 13:return ci(Fo),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return ci(Fo),null;case 4:return No(),null;case 10:return ro(t),null;case 23:case 24:return Sl(),null;default:return null}}function us(t,e){try{var n="",r=e;do{n+=W(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:i}}function cs(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}Ha=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ya=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Ro(Ao.current);var a,s=null;switch(n){case"input":o=Q(t,o),r=Q(t,r),s=[];break;case"option":o=ot(t,o),r=ot(t,r),s=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),s=[];break;case"textarea":o=st(t,o),r=st(t,r),s=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(t.onclick=jr)}for(h in Et(n,r),n=null,o)if(!r.hasOwnProperty(h)&&o.hasOwnProperty(h)&&null!=o[h])if("style"===h){var u=o[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(u=null!=o?o[h]:void 0,r.hasOwnProperty(h)&&c!==u&&(null!=c||null!=u))if("style"===h)if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(h,n)),n=c;else"dangerouslySetInnerHTML"===h?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(s=s||[]).push(h,c)):"children"===h?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(h,""+c):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=c&&"onScroll"===h&&Ar("scroll",t),s||u===c||(s=[])):"object"===typeof c&&null!==c&&c.$$typeof===N?c.toString():(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}},$a=function(t,e,n,r){n!==r&&(e.flags|=4)};var hs="function"===typeof WeakMap?WeakMap:Map;function fs(t,e,n){(n=co(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$s||($s=!0,Ks=r),cs(0,e)},n}function ps(t,e,n){(n=co(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return cs(0,e),r(i)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Js?Js=new Set([this]):Js.add(this),cs(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var ds="function"===typeof WeakSet?WeakSet:Set;function ms(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){jl(t,n)}else e.current=null}function gs(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Ki(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Xr(e.stateNode.containerInfo))}throw Error(a(163))}function vs(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3===(3&t.tag)){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var i=t;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Ol(n,t),zl(n,t)),t=r}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(r=n.elementType===n.type?e.memoizedProps:Ki(n.type,e.memoizedProps),t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&mo(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}mo(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Zr(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&we(n)))))}throw Error(a(163))}function ys(t,e){for(var n=t;;){if(5===n.tag){var r=n.stateNode;if(e)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=bt("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function _s(t,e){if(Ei&&"function"===typeof Ei.onCommitFiberUnmount)try{Ei.onCommitFiberUnmount(Si,e)}catch(o){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))Ol(e,n);else{r=e;try{i()}catch(o){jl(r,o)}}n=n.next}while(n!==t)}break;case 1:if(ms(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(o){jl(e,o)}break;case 5:ms(e);break;case 4:ks(t,e)}}function xs(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function bs(t){return 5===t.tag||3===t.tag||4===t.tag}function ws(t){t:{for(var e=t.return;null!==e;){if(bs(e))break t;e=e.return}throw Error(a(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.flags&&(yt(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||bs(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}r?Ss(t,n,e):Es(t,n,e)}function Ss(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=jr));else if(4!==r&&null!==(t=t.child))for(Ss(t,e,n),t=t.sibling;null!==t;)Ss(t,e,n),t=t.sibling}function Es(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(Es(t,e,n),t=t.sibling;null!==t;)Es(t,e,n),t=t.sibling}function ks(t,e){for(var n,r,i=e,o=!1;;){if(!o){o=i.return;t:for(;;){if(null===o)throw Error(a(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break t;case 3:case 4:n=n.containerInfo,r=!0;break t}o=o.return}o=!0}if(5===i.tag||6===i.tag){t:for(var s=t,l=i,u=l;;)if(_s(s,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===l)break t;for(;null===u.sibling;){if(null===u.return||u.return===l)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(s=n,l=i.stateNode,8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(_s(t,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;4===(i=i.return).tag&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function Cs(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(t=r.destroy,r.destroy=void 0,void 0!==t&&t()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=e.stateNode)){r=e.memoizedProps;var i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[Qr]=r,"input"===t&&"radio"===r.type&&null!=r.name&&et(n,r),kt(t,i),e=kt(t,r),i=0;i<o.length;i+=2){var s=o[i],l=o[i+1];"style"===s?wt(n,l):"dangerouslySetInnerHTML"===s?vt(n,l):"children"===s?yt(n,l):x(n,s,l,e)}switch(t){case"input":nt(n,r);break;case"textarea":ut(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?at(n,!!r.multiple,o,!1):t!==!!r.multiple&&(null!=r.defaultValue?at(n,!!r.multiple,r.defaultValue,!0):at(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(a(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,we(n.containerInfo)));case 13:return null!==e.memoizedState&&(Gs=Zi(),ys(e.child,!0)),void Is(e);case 19:return void Is(e);case 23:case 24:return void ys(e,null!==e.memoizedState)}throw Error(a(163))}function Is(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new ds),e.forEach((function(e){var r=Vl.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function Ts(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Ps=Math.ceil,As=b.ReactCurrentDispatcher,Ms=b.ReactCurrentOwner,Ls=0,Rs=null,Ds=null,Ns=0,zs=0,Os=ui(0),Fs=0,Bs=null,js=0,Us=0,Vs=0,Zs=0,qs=null,Gs=0,Ws=1/0;function Xs(){Ws=Zi()+500}var Hs,Ys=null,$s=!1,Ks=null,Js=null,Qs=!1,tl=null,el=90,nl=[],rl=[],il=null,ol=0,al=null,sl=-1,ll=0,ul=0,cl=null,hl=!1;function fl(){return 0!==(48&Ls)?Zi():-1!==sl?sl:sl=Zi()}function pl(t){if(0===(2&(t=t.mode)))return 1;if(0===(4&t))return 99===qi()?1:2;if(0===ll&&(ll=js),0!==$i.transition){0!==ul&&(ul=null!==qs?qs.pendingLanes:0),t=ll;var e=4186112&~ul;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=qi(),0!==(4&Ls)&&98===t?t=je(12,ll):t=je(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),ll),t}function dl(t,e,n){if(50<ol)throw ol=0,al=null,Error(a(185));if(null===(t=ml(t,e)))return null;Ze(t,e,n),t===Rs&&(Vs|=e,4===Fs&&yl(t,Ns));var r=qi();1===e?0!==(8&Ls)&&0===(48&Ls)?_l(t):(gl(t,n),0===Ls&&(Xs(),Hi())):(0===(4&Ls)||98!==r&&99!==r||(null===il?il=new Set([t]):il.add(t)),gl(t,n)),qs=t}function ml(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function gl(t,e){for(var n=t.callbackNode,r=t.suspendedLanes,i=t.pingedLanes,o=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-qe(s),u=1<<l,c=o[l];if(-1===c){if(0===(u&r)||0!==(u&i)){c=e,Oe(u);var h=ze;o[l]=10<=h?c+250:6<=h?c+5e3:-1}}else c<=e&&(t.expiredLanes|=u);s&=~u}if(r=Fe(t,t===Rs?Ns:0),e=ze,0===r)null!==n&&(n!==Oi&&Ii(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==Oi&&Ii(n)}15===e?(n=_l.bind(null,t),null===Bi?(Bi=[n],ji=Ci(Li,Yi)):Bi.push(n),n=Oi):14===e?n=Xi(99,_l.bind(null,t)):(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,t))}}(e),n=Xi(n,vl.bind(null,t))),t.callbackPriority=e,t.callbackNode=n}}function vl(t){if(sl=-1,ul=ll=0,0!==(48&Ls))throw Error(a(327));var e=t.callbackNode;if(Nl()&&t.callbackNode!==e)return null;var n=Fe(t,t===Rs?Ns:0);if(0===n)return null;var r=n,i=Ls;Ls|=16;var o=Cl();for(Rs===t&&Ns===r||(Xs(),El(t,r));;)try{Pl();break}catch(l){kl(t,l)}if(no(),As.current=o,Ls=i,null!==Ds?r=0:(Rs=null,Ns=0,r=Fs),0!==(js&Vs))El(t,0);else if(0!==r){if(2===r&&(Ls|=64,t.hydrate&&(t.hydrate=!1,Xr(t.containerInfo)),0!==(n=Be(t))&&(r=Il(t,n))),1===r)throw e=Bs,El(t,0),yl(t,n),gl(t,Zi()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,r){case 0:case 1:throw Error(a(345));case 2:case 5:Ll(t);break;case 3:if(yl(t,n),(62914560&n)===n&&10<(r=Gs+500-Zi())){if(0!==Fe(t,0))break;if(((i=t.suspendedLanes)&n)!==n){fl(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Gr(Ll.bind(null,t),r);break}Ll(t);break;case 4:if(yl(t,n),(4186112&n)===n)break;for(r=t.eventTimes,i=-1;0<n;){var s=31-qe(n);o=1<<s,(s=r[s])>i&&(i=s),n&=~o}if(n=i,10<(n=(120>(n=Zi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ps(n/1960))-n)){t.timeoutHandle=Gr(Ll.bind(null,t),n);break}Ll(t);break;default:throw Error(a(329))}}return gl(t,Zi()),t.callbackNode===e?vl.bind(null,t):null}function yl(t,e){for(e&=~Zs,e&=~Vs,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-qe(e),r=1<<n;t[n]=-1,e&=~r}}function _l(t){if(0!==(48&Ls))throw Error(a(327));if(Nl(),t===Rs&&0!==(t.expiredLanes&Ns)){var e=Ns,n=Il(t,e);0!==(js&Vs)&&(n=Il(t,e=Fe(t,e)))}else n=Il(t,e=Fe(t,0));if(0!==t.tag&&2===n&&(Ls|=64,t.hydrate&&(t.hydrate=!1,Xr(t.containerInfo)),0!==(e=Be(t))&&(n=Il(t,e))),1===n)throw n=Bs,El(t,0),yl(t,e),gl(t,Zi()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ll(t),gl(t,Zi()),null}function xl(t,e){var n=Ls;Ls|=1;try{return t(e)}finally{0===(Ls=n)&&(Xs(),Hi())}}function bl(t,e){var n=Ls;Ls&=-2,Ls|=8;try{return t(e)}finally{0===(Ls=n)&&(Xs(),Hi())}}function wl(t,e){hi(Os,zs),zs|=e,js|=e}function Sl(){zs=Os.current,ci(Os)}function El(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,Wr(n)),null!==Ds)for(n=Ds.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&yi();break;case 3:No(),ci(di),ci(pi),$o();break;case 5:Oo(r);break;case 4:No();break;case 13:case 19:ci(Fo);break;case 10:ro(r);break;case 23:case 24:Sl()}n=n.return}Rs=t,Ds=Wl(t.current,null),Ns=zs=js=e,Fs=0,Bs=null,Zs=Vs=Us=0}function kl(t,e){for(;;){var n=Ds;try{if(no(),Ko.current=La,ra){for(var r=ta.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ra=!1}if(Qo=0,na=ea=ta=null,ia=!1,Ms.current=null,null===n||null===n.return){Fs=1,Bs=e,Ds=null;break}t:{var o=t,a=n.return,s=n,l=e;if(e=Ns,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l;if(0===(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var h=0!==(1&Fo.current),f=a;do{var p;if(p=13===f.tag){var d=f.memoizedState;if(null!==d)p=null!==d.dehydrated;else{var m=f.memoizedProps;p=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!h)}}if(p){var g=f.updateQueue;if(null===g){var v=new Set;v.add(u),f.updateQueue=v}else g.add(u);if(0===(2&f.mode)){if(f.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=co(-1,1);y.tag=2,ho(s,y)}s.lanes|=1;break t}l=void 0,s=e;var _=o.pingCache;if(null===_?(_=o.pingCache=new hs,l=new Set,_.set(u,l)):void 0===(l=_.get(u))&&(l=new Set,_.set(u,l)),!l.has(s)){l.add(s);var x=Ul.bind(null,o,u,s);u.then(x,x)}f.flags|=4096,f.lanes=e;break t}f=f.return}while(null!==f);l=Error((X(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Fs&&(Fs=2),l=us(l,s),f=a;do{switch(f.tag){case 3:o=l,f.flags|=4096,e&=-e,f.lanes|=e,fo(f,fs(0,o,e));break t;case 1:o=l;var b=f.type,w=f.stateNode;if(0===(64&f.flags)&&("function"===typeof b.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Js||!Js.has(w)))){f.flags|=4096,e&=-e,f.lanes|=e,fo(f,ps(f,o,e));break t}}f=f.return}while(null!==f)}Ml(n)}catch(S){e=S,Ds===n&&null!==n&&(Ds=n=n.return);continue}break}}function Cl(){var t=As.current;return As.current=La,null===t?La:t}function Il(t,e){var n=Ls;Ls|=16;var r=Cl();for(Rs===t&&Ns===e||El(t,e);;)try{Tl();break}catch(i){kl(t,i)}if(no(),Ls=n,As.current=r,null!==Ds)throw Error(a(261));return Rs=null,Ns=0,Fs}function Tl(){for(;null!==Ds;)Al(Ds)}function Pl(){for(;null!==Ds&&!Ti();)Al(Ds)}function Al(t){var e=Hs(t.alternate,t,zs);t.memoizedProps=t.pendingProps,null===e?Ml(t):Ds=e,Ms.current=null}function Ml(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(2048&e.flags)){if(null!==(n=ss(n,e,zs)))return void(Ds=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&zs)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==t&&0===(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=ls(e)))return n.flags&=2047,void(Ds=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Ds=e);Ds=e=t}while(null!==e);0===Fs&&(Fs=5)}function Ll(t){var e=qi();return Wi(99,Rl.bind(null,t,e)),null}function Rl(t,e){do{Nl()}while(null!==tl);if(0!==(48&Ls))throw Error(a(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(a(177));t.callbackNode=null;var r=n.lanes|n.childLanes,i=r,o=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;for(var s=t.eventTimes,l=t.expirationTimes;0<o;){var u=31-qe(o),c=1<<u;i[u]=0,s[u]=-1,l[u]=-1,o&=~c}if(null!==il&&0===(24&r)&&il.has(t)&&il.delete(t),t===Rs&&(Ds=Rs=null,Ns=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Ls,Ls|=32,Ms.current=null,Ur=Ye,vr(s=gr())){if("selectionStart"in s)l={start:s.selectionStart,end:s.selectionEnd};else t:if(l=(l=s.ownerDocument)&&l.defaultView||window,(c=l.getSelection&&l.getSelection())&&0!==c.rangeCount){l=c.anchorNode,o=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{l.nodeType,u.nodeType}catch(C){l=null;break t}var h=0,f=-1,p=-1,d=0,m=0,g=s,v=null;e:for(;;){for(var y;g!==l||0!==o&&3!==g.nodeType||(f=h+o),g!==u||0!==c&&3!==g.nodeType||(p=h+c),3===g.nodeType&&(h+=g.nodeValue.length),null!==(y=g.firstChild);)v=g,g=y;for(;;){if(g===s)break e;if(v===l&&++d===o&&(f=h),v===u&&++m===c&&(p=h),null!==(y=g.nextSibling))break;v=(g=v).parentNode}g=y}l=-1===f||-1===p?null:{start:f,end:p}}else l=null;l=l||{start:0,end:0}}else l=null;Vr={focusedElem:s,selectionRange:l},Ye=!1,cl=null,hl=!1,Ys=r;do{try{Dl()}catch(C){if(null===Ys)throw Error(a(330));jl(Ys,C),Ys=Ys.nextEffect}}while(null!==Ys);cl=null,Ys=r;do{try{for(s=t;null!==Ys;){var _=Ys.flags;if(16&_&&yt(Ys.stateNode,""),128&_){var x=Ys.alternate;if(null!==x){var b=x.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&_){case 2:ws(Ys),Ys.flags&=-3;break;case 6:ws(Ys),Ys.flags&=-3,Cs(Ys.alternate,Ys);break;case 1024:Ys.flags&=-1025;break;case 1028:Ys.flags&=-1025,Cs(Ys.alternate,Ys);break;case 4:Cs(Ys.alternate,Ys);break;case 8:ks(s,l=Ys);var w=l.alternate;xs(l),null!==w&&xs(w)}Ys=Ys.nextEffect}}catch(C){if(null===Ys)throw Error(a(330));jl(Ys,C),Ys=Ys.nextEffect}}while(null!==Ys);if(b=Vr,x=gr(),_=b.focusedElem,s=b.selectionRange,x!==_&&_&&_.ownerDocument&&mr(_.ownerDocument.documentElement,_)){null!==s&&vr(_)&&(x=s.start,void 0===(b=s.end)&&(b=x),"selectionStart"in _?(_.selectionStart=x,_.selectionEnd=Math.min(b,_.value.length)):(b=(x=_.ownerDocument||document)&&x.defaultView||window).getSelection&&(b=b.getSelection(),l=_.textContent.length,w=Math.min(s.start,l),s=void 0===s.end?w:Math.min(s.end,l),!b.extend&&w>s&&(l=s,s=w,w=l),l=dr(_,w),o=dr(_,s),l&&o&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==o.node||b.focusOffset!==o.offset)&&((x=x.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),w>s?(b.addRange(x),b.extend(o.node,o.offset)):(x.setEnd(o.node,o.offset),b.addRange(x))))),x=[];for(b=_;b=b.parentNode;)1===b.nodeType&&x.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof _.focus&&_.focus(),_=0;_<x.length;_++)(b=x[_]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Ye=!!Ur,Vr=Ur=null,t.current=n,Ys=r;do{try{for(_=t;null!==Ys;){var S=Ys.flags;if(36&S&&vs(_,Ys.alternate,Ys),128&S){x=void 0;var E=Ys.ref;if(null!==E){var k=Ys.stateNode;Ys.tag,x=k,"function"===typeof E?E(x):E.current=x}}Ys=Ys.nextEffect}}catch(C){if(null===Ys)throw Error(a(330));jl(Ys,C),Ys=Ys.nextEffect}}while(null!==Ys);Ys=null,Fi(),Ls=i}else t.current=n;if(Qs)Qs=!1,tl=t,el=e;else for(Ys=r;null!==Ys;)e=Ys.nextEffect,Ys.nextEffect=null,8&Ys.flags&&((S=Ys).sibling=null,S.stateNode=null),Ys=e;if(0===(r=t.pendingLanes)&&(Js=null),1===r?t===al?ol++:(ol=0,al=t):ol=0,n=n.stateNode,Ei&&"function"===typeof Ei.onCommitFiberRoot)try{Ei.onCommitFiberRoot(Si,n,void 0,64===(64&n.current.flags))}catch(C){}if(gl(t,Zi()),$s)throw $s=!1,t=Ks,Ks=null,t;return 0!==(8&Ls)||Hi(),null}function Dl(){for(;null!==Ys;){var t=Ys.alternate;hl||null===cl||(0!==(8&Ys.flags)?te(Ys,cl)&&(hl=!0):13===Ys.tag&&Ts(t,Ys)&&te(Ys,cl)&&(hl=!0));var e=Ys.flags;0!==(256&e)&&gs(t,Ys),0===(512&e)||Qs||(Qs=!0,Xi(97,(function(){return Nl(),null}))),Ys=Ys.nextEffect}}function Nl(){if(90!==el){var t=97<el?97:el;return el=90,Wi(t,Fl)}return!1}function zl(t,e){nl.push(e,t),Qs||(Qs=!0,Xi(97,(function(){return Nl(),null})))}function Ol(t,e){rl.push(e,t),Qs||(Qs=!0,Xi(97,(function(){return Nl(),null})))}function Fl(){if(null===tl)return!1;var t=tl;if(tl=null,0!==(48&Ls))throw Error(a(331));var e=Ls;Ls|=32;var n=rl;rl=[];for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1],s=i.destroy;if(i.destroy=void 0,"function"===typeof s)try{s()}catch(u){if(null===o)throw Error(a(330));jl(o,u)}}for(n=nl,nl=[],r=0;r<n.length;r+=2){i=n[r],o=n[r+1];try{var l=i.create;i.destroy=l()}catch(u){if(null===o)throw Error(a(330));jl(o,u)}}for(l=t.current.firstEffect;null!==l;)t=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=t;return Ls=e,Hi(),!0}function Bl(t,e,n){ho(t,e=fs(0,e=us(n,e),1)),e=fl(),null!==(t=ml(t,1))&&(Ze(t,1,e),gl(t,e))}function jl(t,e){if(3===t.tag)Bl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Bl(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Js||!Js.has(r))){var i=ps(n,t=us(e,t),1);if(ho(n,i),i=fl(),null!==(n=ml(n,1)))Ze(n,1,i),gl(n,i);else if("function"===typeof r.componentDidCatch&&(null===Js||!Js.has(r)))try{r.componentDidCatch(e,t)}catch(o){}break}}n=n.return}}function Ul(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=fl(),t.pingedLanes|=t.suspendedLanes&n,Rs===t&&(Ns&n)===n&&(4===Fs||3===Fs&&(62914560&Ns)===Ns&&500>Zi()-Gs?El(t,0):Zs|=n),gl(t,e)}function Vl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(0===(2&(e=t.mode))?e=1:0===(4&e)?e=99===qi()?1:2:(0===ll&&(ll=js),0===(e=Ue(62914560&~ll))&&(e=4194304))),n=fl(),null!==(t=ml(t,e))&&(Ze(t,e,n),gl(t,n))}function Zl(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ql(t,e,n,r){return new Zl(t,e,n,r)}function Gl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Wl(t,e){var n=t.alternate;return null===n?((n=ql(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xl(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)Gl(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case E:return Hl(n.children,i,o,e);case z:s=8,i|=16;break;case k:s=8,i|=1;break;case C:return(t=ql(12,n,e,8|i)).elementType=C,t.type=C,t.lanes=o,t;case A:return(t=ql(13,n,e,i)).type=A,t.elementType=A,t.lanes=o,t;case M:return(t=ql(19,n,e,i)).elementType=M,t.lanes=o,t;case O:return Yl(n,i,o,e);case F:return(t=ql(24,n,e,i)).elementType=F,t.lanes=o,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case I:s=10;break t;case T:s=9;break t;case P:s=11;break t;case L:s=14;break t;case R:s=16,r=null;break t;case D:s=22;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=ql(s,n,e,i)).elementType=t,e.type=r,e.lanes=o,e}function Hl(t,e,n,r){return(t=ql(7,t,r,e)).lanes=n,t}function Yl(t,e,n,r){return(t=ql(23,t,r,e)).elementType=O,t.lanes=n,t}function $l(t,e,n){return(t=ql(6,t,null,e)).lanes=n,t}function Kl(t,e,n){return(e=ql(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Jl(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ve(0),this.expirationTimes=Ve(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ve(0),this.mutableSourceEagerHydrationData=null}function Ql(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function tu(t,e,n,r){var i=e.current,o=fl(),s=pl(i);t:if(n){e:{if($t(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(vi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(a(171))}if(1===n.tag){var u=n.type;if(vi(u)){n=xi(n,u,l);break t}}n=l}else n=fi;return null===e.context?e.context=n:e.pendingContext=n,(e=co(o,s)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),ho(i,e),dl(i,s,o),s}function eu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function nu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function ru(t,e){nu(t,e),(t=t.alternate)&&nu(t,e)}function iu(t,e,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Jl(t,e,null!=n&&!0===n.hydrate),e=ql(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,lo(e),t[ti]=n.current,Lr(8===t.nodeType?t.parentNode:t),r)for(t=0;t<r.length;t++){var i=(e=r[t])._getVersion;i=i(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,i]:n.mutableSourceEagerHydrationData.push(e,i)}this._internalRoot=n}function ou(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function au(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof i){var s=i;i=function(){var t=eu(a);s.call(t)}}tu(e,a,t,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new iu(t,0,e?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"===typeof i){var l=i;i=function(){var t=eu(a);l.call(t)}}bl((function(){tu(e,a,t,i)}))}return eu(a)}function su(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ou(e))throw Error(a(200));return Ql(t,e,null,n)}Hs=function(t,e,n){var r=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||di.current)Oa=!0;else{if(0===(n&r)){switch(Oa=!1,e.tag){case 3:Xa(e),Ho();break;case 5:zo(e);break;case 1:vi(e.type)&&bi(e);break;case 4:Do(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value;var i=e.type._context;hi(Ji,i._currentValue),i._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(n&e.child.childLanes)?Ja(t,e,n):(hi(Fo,1&Fo.current),null!==(e=os(t,e,n))?e.sibling:null);hi(Fo,1&Fo.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(64&t.flags)){if(r)return is(t,e,n);e.flags|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),hi(Fo,Fo.current),r)break;return null;case 23:case 24:return e.lanes=0,Va(t,e,n)}return os(t,e,n)}Oa=0!==(16384&t.flags)}else Oa=!1;switch(e.lanes=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=gi(e,pi.current),oo(e,n),i=sa(null,e,r,t,i,n),e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,vi(r)){var o=!0;bi(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,lo(e);var s=r.getDerivedStateFromProps;"function"===typeof s&&vo(e,r,s,t),i.updater=yo,e.stateNode=i,i._reactInternals=e,wo(e,r,t,n),e=Wa(null,e,r,!0,o,n)}else e.tag=0,Fa(null,e,i,n),e=e.child;return e;case 16:i=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=(o=i._init)(i._payload),e.type=i,o=e.tag=function(t){if("function"===typeof t)return Gl(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===P)return 11;if(t===L)return 14}return 2}(i),t=Ki(i,t),o){case 0:e=qa(null,e,i,t,n);break t;case 1:e=Ga(null,e,i,t,n);break t;case 11:e=Ba(null,e,i,t,n);break t;case 14:e=ja(null,e,i,Ki(i.type,t),r,n);break t}throw Error(a(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,qa(t,e,r,i=e.elementType===r?i:Ki(r,i),n);case 1:return r=e.type,i=e.pendingProps,Ga(t,e,r,i=e.elementType===r?i:Ki(r,i),n);case 3:if(Xa(e),r=e.updateQueue,null===t||null===r)throw Error(a(282));if(r=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,uo(t,e),po(e,r,null,n),(r=e.memoizedState.element)===i)Ho(),e=os(t,e,n);else{if((o=(i=e.stateNode).hydrate)&&(Uo=Hr(e.stateNode.containerInfo.firstChild),jo=e,o=Vo=!0),o){if(null!=(t=i.mutableSourceEagerHydrationData))for(i=0;i<t.length;i+=2)(o=t[i])._workInProgressVersionPrimary=t[i+1],Yo.push(o);for(n=To(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Fa(t,e,r,n),Ho();e=e.child}return e;case 5:return zo(e),null===t&&Go(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,qr(r,i)?s=null:null!==o&&qr(r,o)&&(e.flags|=16),Za(t,e),Fa(t,e,s,n),e.child;case 6:return null===t&&Go(e),null;case 13:return Ja(t,e,n);case 4:return Do(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Io(e,null,r,n):Fa(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Ba(t,e,r,i=e.elementType===r?i:Ki(r,i),n);case 7:return Fa(t,e,e.pendingProps,n),e.child;case 8:case 12:return Fa(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value;var l=e.type._context;if(hi(Ji,l._currentValue),l._currentValue=o,null!==s)if(l=s.value,0===(o=cr(l,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(s.children===i.children&&!di.current){e=os(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&o)){1===l.tag&&((c=co(-1,n&-n)).tag=2,ho(l,c)),l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),io(l.return,n),u.lanes|=n;break}c=c.next}}else s=10===l.tag&&l.type===e.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===e){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Fa(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,oo(e,n),r=r(i=ao(i,o.unstable_observedBits)),e.flags|=1,Fa(t,e,r,n),e.child;case 14:return o=Ki(i=e.type,e.pendingProps),ja(t,e,i,o=Ki(i.type,o),r,n);case 15:return Ua(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ki(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,vi(r)?(t=!0,bi(e)):t=!1,oo(e,n),xo(e,r,i),wo(e,r,i,n),Wa(null,e,r,!0,t,n);case 19:return is(t,e,n);case 23:case 24:return Va(t,e,n)}throw Error(a(156,e.tag))},iu.prototype.render=function(t){tu(t,this._internalRoot,null,null)},iu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;tu(null,t,null,(function(){e[ti]=null}))},ee=function(t){13===t.tag&&(dl(t,4,fl()),ru(t,4))},ne=function(t){13===t.tag&&(dl(t,67108864,fl()),ru(t,67108864))},re=function(t){if(13===t.tag){var e=fl(),n=pl(t);dl(t,n,e),ru(t,n)}},ie=function(t,e){return e()},It=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=oi(r);if(!i)throw Error(a(90));K(r),nt(r,i)}}}break;case"textarea":ut(t,n);break;case"select":null!=(e=n.value)&&at(t,!!n.multiple,e,!1)}},Rt=xl,Dt=function(t,e,n,r,i){var o=Ls;Ls|=4;try{return Wi(98,t.bind(null,e,n,r,i))}finally{0===(Ls=o)&&(Xs(),Hi())}},Nt=function(){0===(49&Ls)&&(function(){if(null!==il){var t=il;il=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,gl(t,Zi())}))}Hi()}(),Nl())},zt=function(t,e){var n=Ls;Ls|=2;try{return t(e)}finally{0===(Ls=n)&&(Xs(),Hi())}};var lu={Events:[ri,ii,oi,Mt,Lt,Nl,{current:!1}]},uu={findFiberByHostInstance:ni,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},cu={bundleType:uu.bundleType,version:uu.version,rendererPackageName:uu.rendererPackageName,rendererConfig:uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Qt(t))?null:t.stateNode},findFiberByHostInstance:uu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{Si=hu.inject(cu),Ei=hu}catch(gt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lu,e.createPortal=su,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw Error(a(268,Object.keys(t)))}return t=null===(t=Qt(e))?null:t.stateNode},e.flushSync=function(t,e){var n=Ls;if(0!==(48&n))return t(e);Ls|=1;try{if(t)return Wi(99,t.bind(null,e))}finally{Ls=n,Hi()}},e.hydrate=function(t,e,n){if(!ou(e))throw Error(a(200));return au(null,t,e,!0,n)},e.render=function(t,e,n){if(!ou(e))throw Error(a(200));return au(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!ou(t))throw Error(a(40));return!!t._reactRootContainer&&(bl((function(){au(null,null,t,!1,(function(){t._reactRootContainer=null,t[ti]=null}))})),!0)},e.unstable_batchedUpdates=xl,e.unstable_createPortal=function(t,e){return su(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ou(n))throw Error(a(200));if(null==t||void 0===t._reactInternals)throw Error(a(38));return au(t,e,n,!1,r)},e.version="17.0.2"},4164:function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(4463)},1372:function(t,e){"use strict";var n,r=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function v(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case o:case s:case a:case f:case p:return t;default:switch(t=t&&t.$$typeof){case c:case u:case h:case m:case d:case l:return t;default:return e}}case i:return e}}}n=Symbol.for("react.module.reference")},7441:function(t,e,n){"use strict";n(1372)},6374:function(t,e,n){"use strict";n(1725);var r=n(2791),i=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),e.Fragment=o("react.fragment")}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)s.call(e,r)&&!l.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:i,type:t,key:u,ref:c,props:o,_owner:a.current}}e.jsx=u,e.jsxs=u},9117:function(t,e,n){"use strict";var r=n(1725),i=60103,o=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var a=60109,s=60110,l=60112;e.Suspense=60113;var u=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;i=h("react.element"),o=h("react.portal"),e.Fragment=h("react.fragment"),e.StrictMode=h("react.strict_mode"),e.Profiler=h("react.profiler"),a=h("react.provider"),s=h("react.context"),l=h("react.forward_ref"),e.Suspense=h("react.suspense"),u=h("react.memo"),c=h("react.lazy")}var f="function"===typeof Symbol&&Symbol.iterator;function p(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}function v(){}function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(p(85));this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=g.prototype;var _=y.prototype=new v;_.constructor=y,r(_,g.prototype),_.isPureReactComponent=!0;var x={current:null},b=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,n){var r,o={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)b.call(e,r)&&!w.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:i,type:t,key:a,ref:s,props:o,_owner:x.current}}function E(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var k=/\/+/g;function C(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function I(t,e,n,r,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case o:l=!0}}if(l)return a=a(l=t),t=""===r?"."+C(l,0):r,Array.isArray(a)?(n="",null!=t&&(n=t.replace(k,"$&/")+"/"),I(a,e,n,"",(function(t){return t}))):null!=a&&(E(a)&&(a=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+t)),e.push(a)),1;if(l=0,r=""===r?".":r+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=r+C(s=t[u],u);l+=I(s,e,n,c,a)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),u=0;!(s=t.next()).done;)l+=I(s=s.value,e,n,c=r+C(s,u++),a);else if("object"===s)throw e=""+t,Error(p(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return l}function T(t,e,n){if(null==t)return t;var r=[],i=0;return I(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function P(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var A={current:null};function M(){var t=A.current;if(null===t)throw Error(p(321));return t}var L={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:x,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:T,forEach:function(t,e,n){T(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return T(t,(function(){e++})),e},toArray:function(t){return T(t,(function(t){return t}))||[]},only:function(t){if(!E(t))throw Error(p(143));return t}},e.Component=g,e.PureComponent=y,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(p(267,t));var o=r({},t.props),a=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=x.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)b.call(e,c)&&!w.hasOwnProperty(c)&&(o[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];o.children=u}return{$$typeof:i,type:t.type,key:a,ref:s,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:s,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=E,e.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:P}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return M().useCallback(t,e)},e.useContext=function(t,e){return M().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return M().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return M().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return M().useLayoutEffect(t,e)},e.useMemo=function(t,e){return M().useMemo(t,e)},e.useReducer=function(t,e,n){return M().useReducer(t,e,n)},e.useRef=function(t){return M().useRef(t)},e.useState=function(t){return M().useState(t)},e.version="17.0.2"},2791:function(t,e,n){"use strict";t.exports=n(9117)},184:function(t,e,n){"use strict";t.exports=n(6374)},5844:function(t,e,n){"use strict";var r=n(4583).functionsHaveConfigurableNames(),i=Object,o=TypeError;t.exports=function(){if(null!=this&&this!==i(this))throw new o("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t},r&&Object.defineProperty&&Object.defineProperty(t.exports,"name",{value:"get flags"})},3535:function(t,e,n){"use strict";var r=n(9396),i=n(9722),o=n(5844),a=n(1334),s=n(7888),l=i(a());r(l,{getPolyfill:a,implementation:o,shim:s}),t.exports=l},1334:function(t,e,n){"use strict";var r=n(5844),i=n(9396).supportsDescriptors,o=Object.getOwnPropertyDescriptor;t.exports=function(){if(i&&"gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"===typeof t.get&&"boolean"===typeof RegExp.prototype.dotAll&&"boolean"===typeof RegExp.prototype.hasIndices){var e="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(n,"sticky",{get:function(){e+="y"}}),"dy"===e)return t.get}}return r}},7888:function(t,e,n){"use strict";var r=n(9396).supportsDescriptors,i=n(1334),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!r||!l)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=i(),e=l(u),n=o(e,"flags");return n&&n.get===t||a(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},4460:function(t,e){!function(t){"use strict";var e=134217729,n=33306690738754706e-32;function r(t,e,n,r,i){var o,a,s,l,u=e[0],c=r[0],h=0,f=0;c>u==c>-u?(o=u,u=e[++h]):(o=c,c=r[++f]);var p=0;if(h<t&&f<n)for(c>u==c>-u?(s=o-((a=u+o)-u),u=e[++h]):(s=o-((a=c+o)-c),c=r[++f]),o=a,0!==s&&(i[p++]=s);h<t&&f<n;)c>u==c>-u?(s=o-((a=o+u)-(l=a-o))+(u-l),u=e[++h]):(s=o-((a=o+c)-(l=a-o))+(c-l),c=r[++f]),o=a,0!==s&&(i[p++]=s);for(;h<t;)s=o-((a=o+u)-(l=a-o))+(u-l),u=e[++h],o=a,0!==s&&(i[p++]=s);for(;f<n;)s=o-((a=o+c)-(l=a-o))+(c-l),c=r[++f],o=a,0!==s&&(i[p++]=s);return 0===o&&0!==p||(i[p++]=o),p}function i(t){return new Float64Array(t)}var o=33306690738754716e-32,a=22204460492503146e-32,s=11093356479670487e-47,l=i(4),u=i(8),c=i(12),h=i(16),f=i(4);t.orient2d=function(t,i,p,d,m,g){var v=(i-g)*(p-m),y=(t-m)*(d-g),_=v-y;if(0===v||0===y||v>0!=y>0)return _;var x=Math.abs(v+y);return Math.abs(_)>=o*x?_:-function(t,i,o,p,d,m,g){var v,y,_,x,b,w,S,E,k,C,I,T,P,A,M,L,R,D,N=t-d,z=o-d,O=i-m,F=p-m;b=(M=(E=N-(S=(w=e*N)-(w-N)))*(C=F-(k=(w=e*F)-(w-F)))-((A=N*F)-S*k-E*k-S*C))-(I=M-(R=(E=O-(S=(w=e*O)-(w-O)))*(C=z-(k=(w=e*z)-(w-z)))-((L=O*z)-S*k-E*k-S*C))),l[0]=M-(I+b)+(b-R),b=(P=A-((T=A+I)-(b=T-A))+(I-b))-(I=P-L),l[1]=P-(I+b)+(b-L),b=(D=T+I)-T,l[2]=T-(D-b)+(I-b),l[3]=D;var B=function(t,e){for(var n=e[0],r=1;r<t;r++)n+=e[r];return n}(4,l),j=a*g;if(B>=j||-B>=j)return B;if(v=t-(N+(b=t-N))+(b-d),_=o-(z+(b=o-z))+(b-d),y=i-(O+(b=i-O))+(b-m),x=p-(F+(b=p-F))+(b-m),0===v&&0===y&&0===_&&0===x)return B;if(j=s*g+n*Math.abs(B),(B+=N*x+F*v-(O*_+z*y))>=j||-B>=j)return B;b=(M=(E=v-(S=(w=e*v)-(w-v)))*(C=F-(k=(w=e*F)-(w-F)))-((A=v*F)-S*k-E*k-S*C))-(I=M-(R=(E=y-(S=(w=e*y)-(w-y)))*(C=z-(k=(w=e*z)-(w-z)))-((L=y*z)-S*k-E*k-S*C))),f[0]=M-(I+b)+(b-R),b=(P=A-((T=A+I)-(b=T-A))+(I-b))-(I=P-L),f[1]=P-(I+b)+(b-L),b=(D=T+I)-T,f[2]=T-(D-b)+(I-b),f[3]=D;var U=r(4,l,4,f,u);b=(M=(E=N-(S=(w=e*N)-(w-N)))*(C=x-(k=(w=e*x)-(w-x)))-((A=N*x)-S*k-E*k-S*C))-(I=M-(R=(E=O-(S=(w=e*O)-(w-O)))*(C=_-(k=(w=e*_)-(w-_)))-((L=O*_)-S*k-E*k-S*C))),f[0]=M-(I+b)+(b-R),b=(P=A-((T=A+I)-(b=T-A))+(I-b))-(I=P-L),f[1]=P-(I+b)+(b-L),b=(D=T+I)-T,f[2]=T-(D-b)+(I-b),f[3]=D;var V=r(U,u,4,f,c);b=(M=(E=v-(S=(w=e*v)-(w-v)))*(C=x-(k=(w=e*x)-(w-x)))-((A=v*x)-S*k-E*k-S*C))-(I=M-(R=(E=y-(S=(w=e*y)-(w-y)))*(C=_-(k=(w=e*_)-(w-_)))-((L=y*_)-S*k-E*k-S*C))),f[0]=M-(I+b)+(b-R),b=(P=A-((T=A+I)-(b=T-A))+(I-b))-(I=P-L),f[1]=P-(I+b)+(b-L),b=(D=T+I)-T,f[2]=T-(D-b)+(I-b),f[3]=D;var Z=r(V,c,4,f,h);return h[Z-1]}(t,i,p,d,m,g,x)},t.orient2dfast=function(t,e,n,r,i,o){return(e-o)*(n-i)-(t-i)*(r-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},6813:function(t,e){"use strict";var n,r,i,o;if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,c=null,h=function t(){if(null!==u)try{var n=e.unstable_now();u(!0,n),u=null}catch(r){throw setTimeout(t,0),r}};n=function(t){null!==u?setTimeout(n,0,t):(u=t,setTimeout(h,0))},r=function(t,e){c=setTimeout(t,e)},i=function(){clearTimeout(c)},e.unstable_shouldYield=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var d=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof d&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,g=null,v=-1,y=5,_=0;e.unstable_shouldYield=function(){return e.unstable_now()>=_},o=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<t?Math.floor(1e3/t):5};var x=new MessageChannel,b=x.port2;x.port1.onmessage=function(){if(null!==g){var t=e.unstable_now();_=t+y;try{g(!0,t)?b.postMessage(null):(m=!1,g=null)}catch(n){throw b.postMessage(null),n}}else m=!1},n=function(t){g=t,m||(m=!0,b.postMessage(null))},r=function(t,n){v=f((function(){t(e.unstable_now())}),n)},i=function(){p(v),v=-1}}function w(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,i=t[r];if(!(void 0!==i&&0<k(i,e)))break t;t[r]=e,t[n]=i,n=r}}function S(t){return void 0===(t=t[0])?null:t}function E(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var o=2*(r+1)-1,a=t[o],s=o+1,l=t[s];if(void 0!==a&&0>k(a,n))void 0!==l&&0>k(l,a)?(t[r]=l,t[s]=n,r=s):(t[r]=a,t[o]=n,r=o);else{if(!(void 0!==l&&0>k(l,n)))break t;t[r]=l,t[s]=n,r=s}}}return e}return null}function k(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var C=[],I=[],T=1,P=null,A=3,M=!1,L=!1,R=!1;function D(t){for(var e=S(I);null!==e;){if(null===e.callback)E(I);else{if(!(e.startTime<=t))break;E(I),e.sortIndex=e.expirationTime,w(C,e)}e=S(I)}}function N(t){if(R=!1,D(t),!L)if(null!==S(C))L=!0,n(z);else{var e=S(I);null!==e&&r(N,e.startTime-t)}}function z(t,n){L=!1,R&&(R=!1,i()),M=!0;var o=A;try{for(D(n),P=S(C);null!==P&&(!(P.expirationTime>n)||t&&!e.unstable_shouldYield());){var a=P.callback;if("function"===typeof a){P.callback=null,A=P.priorityLevel;var s=a(P.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?P.callback=s:P===S(C)&&E(C),D(n)}else E(C);P=S(C)}if(null!==P)var l=!0;else{var u=S(I);null!==u&&r(N,u.startTime-n),l=!1}return l}finally{P=null,A=o,M=!1}}var O=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){L||M||(L=!0,n(z))},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return S(C)},e.unstable_next=function(t){switch(A){case 1:case 2:case 3:var e=3;break;default:e=A}var n=A;A=e;try{return t()}finally{A=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=O,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=A;A=t;try{return e()}finally{A=n}},e.unstable_scheduleCallback=function(t,o,a){var s=e.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:T++,callback:o,priorityLevel:t,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(t.sortIndex=a,w(I,t),null===S(C)&&t===S(I)&&(R?i():R=!0,r(N,a-s))):(t.sortIndex=l,w(C,t),L||M||(L=!0,n(z))),t},e.unstable_wrapCallback=function(t){var e=A;return function(){var n=A;A=e;try{return t.apply(this,arguments)}finally{A=n}}}},5296:function(t,e,n){"use strict";t.exports=n(6813)},1848:function(t){"use strict";t.exports={eudist:function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++){var a=(t[o]||0)-(e[o]||0);i+=a*a}return n?Math.sqrt(i):i},mandist:function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++)i+=Math.abs((t[o]||0)-(e[o]||0));return n?Math.sqrt(i):i},dist:function(t,e,n){var r=Math.abs(t-e);return n?r:r*r}}},3556:function(t,e,n){"use strict";var r=n(1848),i=r.eudist,o=r.dist;t.exports={kmrand:function(t,e){for(var n={},r=[],i=e<<2,o=t.length,a=t[0].length>0;r.length<e&&i-- >0;){var s=t[Math.floor(Math.random()*o)],l=a?s.join("_"):""+s;n[l]||(n[l]=!0,r.push(s))}if(r.length<e)throw new Error("Error initializating clusters");return r},kmpp:function(t,e){var n=t[0].length?i:o,r=[],a=t.length,s=t[0].length>0,l=t[Math.floor(Math.random()*a)];s&&l.join("_");for(r.push(l);r.length<e;){for(var u=[],c=r.length,h=0,f=[],p=0;p<a;p++){for(var d=1/0,m=0;m<c;m++){var g=n(t[p],r[m]);g<=d&&(d=g)}u[p]=d}for(var v=0;v<a;v++)h+=u[v];for(var y=0;y<a;y++)f[y]={i:y,v:t[y],pr:u[y]/h,cs:0};f.sort((function(t,e){return t.pr-e.pr})),f[0].cs=f[0].pr;for(var _=1;_<a;_++)f[_].cs=f[_-1].cs+f[_].pr;for(var x=Math.random(),b=0;b<a-1&&f[b++].cs<x;);r.push(f[b-1].v)}return r}}},6530:function(t,e,n){"use strict";var r=n(1848),i=n(3556),o=r.eudist,a=(r.mandist,r.dist,i.kmrand),s=i.kmpp;function l(t,e,n){n=n||[];for(var r=0;r<t;r++)n[r]=e;return n}t.exports=function(t,e,n,r){var i=[],u=[],c=[],h=[],f=!1,p=r||1e4,d=t.length,m=t[0].length,g=m>0,v=[];if(n)i="kmrand"==n?a(t,e):"kmpp"==n?s(t,e):n;else for(var y={};i.length<e;){var _=Math.floor(Math.random()*d);y[_]||(y[_]=!0,i.push(t[_]))}do{l(e,0,v);for(var x=0;x<d;x++){for(var b=1/0,w=0,S=0;S<e;S++){(h=g?o(t[x],i[S]):Math.abs(t[x]-i[S]))<=b&&(b=h,w=S)}c[x]=w,v[w]++}for(var E=[],k=(u=[],0);k<e;k++)E[k]=g?l(m,0,E[k]):0,u[k]=i[k];if(g){for(var C=0;C<e;C++)i[C]=[];for(var I=0;I<d;I++)for(var T=E[c[I]],P=t[I],A=0;A<m;A++)T[A]+=P[A];f=!0;for(var M=0;M<e;M++){for(var L=i[M],R=E[M],D=u[M],N=v[M],z=0;z<m;z++)L[z]=R[z]/N||0;if(f)for(var O=0;O<m;O++)if(D[O]!=L[O]){f=!1;break}}}else{for(var F=0;F<d;F++){E[c[F]]+=t[F]}for(var B=0;B<e;B++)i[B]=E[B]/v[B]||0;f=!0;for(var j=0;j<e;j++)if(u[j]!=i[j]){f=!1;break}}f=f||--p<=0}while(!f);return{it:1e4-p,k:e,idxs:c,centroids:i}}},4613:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return o}});var r=n(5671),i=n(3144),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if((0,r.Z)(this,t),this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}return(0,i.Z)(t,[{key:"push",value:function(t){this.data.push(t),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}},{key:"_down",value:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i}}]),t}();function a(t,e){return t<e?-1:t>e?1:0}},4035:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function r(t){this.message=t||""}function i(t){this.message=t||""}function o(){}function a(t){return null===t?Dt:t.color}function s(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function h(){this.root_=null,this.size_=0}function f(){}function p(){this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}function d(){}function m(t){this.message=t||""}function g(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(void 0===this||null===this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(i=i<0?Math.max(n+arguments[2],0):Math.min(i,n);r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var v=function(){};v.prototype.interfaces_=function(){return[]},v.prototype.getClass=function(){return v},v.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var y=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),_=function(){},x={MAX_VALUE:{configurable:!0}};_.isNaN=function(t){return Number.isNaN(t)},_.doubleToLongBits=function(t){return t},_.longBitsToDouble=function(t){return t},_.isInfinite=function(t){return!Number.isFinite(t)},x.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(_,x);var b=function(){},w=function(){},S=function(){},E=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},k={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};E.prototype.setOrdinate=function(t,e){switch(t){case E.X:this.x=e;break;case E.Y:this.y=e;break;case E.Z:this.z=e;break;default:throw new y("Invalid ordinate index: "+t)}},E.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!v.equalsWithTolerance(this.x,e.x,n)&&!!v.equalsWithTolerance(this.y,e.y,n)}},E.prototype.getOrdinate=function(t){switch(t){case E.X:return this.x;case E.Y:return this.y;case E.Z:return this.z}throw new y("Invalid ordinate index: "+t)},E.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||_.isNaN(this.z))&&_.isNaN(t.z)},E.prototype.equals=function(t){return t instanceof E&&this.equals2D(t)},E.prototype.equalInZ=function(t,e){return v.equalsWithTolerance(this.z,t.z,e)},E.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},E.prototype.clone=function(){},E.prototype.copy=function(){return new E(this)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},E.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},E.prototype.hashCode=function(){var t=17;return 37*(t=37*t+E.hashCode(this.x))+E.hashCode(this.y)},E.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},E.prototype.interfaces_=function(){return[b,w,e]},E.prototype.getClass=function(){return E},E.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=_.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},k.DimensionalComparator.get=function(){return C},k.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},k.NULL_ORDINATE.get=function(){return _.NaN},k.X.get=function(){return 0},k.Y.get=function(){return 1},k.Z.get=function(){return 2},Object.defineProperties(E,k);var C=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new y("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};C.prototype.compare=function(t,e){var n=t,r=e,i=C.compare(n.x,r.x);if(0!==i)return i;var o=C.compare(n.y,r.y);return 0!==o?o:this._dimensionsToTest<=2?0:C.compare(n.z,r.z)},C.prototype.interfaces_=function(){return[S]},C.prototype.getClass=function(){return C},C.compare=function(t,e){return t<e?-1:t>e?1:_.isNaN(t)?_.isNaN(e)?0:-1:_.isNaN(e)?1:0};var I=function(){};I.prototype.create=function(){},I.prototype.interfaces_=function(){return[]},I.prototype.getClass=function(){return I};var T=function(){},P={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};T.prototype.interfaces_=function(){return[]},T.prototype.getClass=function(){return T},T.toLocationSymbol=function(t){switch(t){case T.EXTERIOR:return"e";case T.BOUNDARY:return"b";case T.INTERIOR:return"i";case T.NONE:return"-"}throw new y("Unknown location value: "+t)},P.INTERIOR.get=function(){return 0},P.BOUNDARY.get=function(){return 1},P.EXTERIOR.get=function(){return 2},P.NONE.get=function(){return-1},Object.defineProperties(T,P);var A=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},M=function(){},L={LOG_10:{configurable:!0}};M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M},M.log10=function(t){var e=Math.log(t);return _.isInfinite(e)||_.isNaN(e)?e:e/M.LOG_10},M.min=function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i},M.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}},M.wrap=function(t,e){return t<0?e- -t%e:t%e},M.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var r=arguments[1],i=arguments[2],o=arguments[3],a=arguments[0];return r>a&&(a=r),i>a&&(a=i),o>a&&(a=o),a}},M.average=function(t,e){return(t+e)/2},L.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(M,L);var R=function(t){this.str=t};R.prototype.append=function(t){this.str+=t},R.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},R.prototype.toString=function(t){return this.str};var D=function(t){this.value=t};D.prototype.intValue=function(){return this.value},D.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},D.isNaN=function(t){return Number.isNaN(t)};var N=function(){};N.isWhitespace=function(t){return t<=32&&t>=0||127===t},N.toUpperCase=function(t){return t.toUpperCase()};var z=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r,i)}},O={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};z.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},z.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=z.magnitude(n._hi),i=z.TEN.pow(r);(n=n.divide(i)).gt(z.TEN)?(n=n.divide(z.TEN),r+=1):n.lt(z.ONE)&&(n=n.multiply(z.TEN),r-=1);for(var o=r+1,a=new R,s=z.MAX_PRINT_DIGITS-1,l=0;l<=s;l++){t&&l===o&&a.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,a.append(h),n=n.subtract(z.valueOf(u)).multiply(z.TEN),c&&n.selfAdd(z.TEN);var f=!0,p=z.magnitude(n._hi);if(p<0&&Math.abs(p)>=s-l&&(f=!1),!f)break}return e[0]=r,a.toString()},z.prototype.sqr=function(){return this.multiply(this)},z.prototype.doubleValue=function(){return this._hi+this._lo},z.prototype.subtract=function(){if(arguments[0]instanceof z){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},z.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},z.prototype.isZero=function(){return 0===this._hi&&0===this._lo},z.prototype.selfSubtract=function(){if(arguments[0]instanceof z){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},z.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},z.prototype.min=function(t){return this.le(t)?this:t},z.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,l=null,u=null,c=null,h=null;return l=this._hi/n,h=(i=(u=z.SPLIT*l)-(i=u-l))*(a=(h=z.SPLIT*n)-(a=h-n))-(c=l*n)+i*(s=n-a)+(o=l-i)*a+o*s,h=l+(u=(this._hi-c-h+this._lo-l*r)/n),this._hi=h,this._lo=l-h+u,this}},z.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},z.prototype.divide=function(){if(arguments[0]instanceof z){var t=arguments[0],e=null,n=null,r=null,i=null,o=null,a=null,s=null,l=null;return n=(o=this._hi/t._hi)-(e=(a=z.SPLIT*o)-(e=a-o)),l=e*(r=(l=z.SPLIT*t._hi)-(r=l-t._hi))-(s=o*t._hi)+e*(i=t._hi-r)+n*r+n*i,a=(this._hi-s-l+this._lo-o*t._lo)/t._hi,new z(l=o+a,o-l+a)}if("number"==typeof arguments[0]){var u=arguments[0];return _.isNaN(u)?z.createNaN():z.copy(this).selfDivide(u,0)}},z.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},z.prototype.pow=function(t){if(0===t)return z.valueOf(1);var e=new z(this),n=z.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},z.prototype.ceil=function(){if(this.isNaN())return z.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new z(t,e)},z.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},z.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},z.prototype.setValue=function(){if(arguments[0]instanceof z){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},z.prototype.max=function(t){return this.ge(t)?this:t},z.prototype.sqrt=function(){if(this.isZero())return z.valueOf(0);if(this.isNegative())return z.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=z.valueOf(e),r=this.subtract(n.sqr())._hi*(.5*t);return n.add(r)},z.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,i=null,o=null,a=null,s=null;return o=(i=this._hi+e)-(a=i-this._hi),r=(s=(o=e-a+(this._hi-o))+this._lo)+(i-(n=i+s)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,f=null,p=null,d=null,m=null,g=null;p=this._hi+l,h=this._lo+u,d=p-(m=p-this._hi),f=h-(g=h-this._lo);var v=(c=p+(m=(d=l-m+(this._hi-d))+h))+(m=(f=u-g+(this._lo-f))+(m+(p-c))),y=m+(c-v);return this._hi=v,this._lo=y,this}},z.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,l=null,u=null;i=(l=z.SPLIT*this._hi)-this._hi,u=z.SPLIT*n,i=l-i,o=this._hi-i,a=u-n;var c=(l=this._hi*n)+(u=i*(a=u-a)-l+i*(s=n-a)+o*a+o*s+(this._hi*r+this._lo*n)),h=u+(i=l-c);return this._hi=c,this._lo=h,this}},z.prototype.selfSqr=function(){return this.selfMultiply(this)},z.prototype.floor=function(){if(this.isNaN())return z.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new z(t,e)},z.prototype.negate=function(){return this.isNaN()?this:new z(-this._hi,-this._lo)},z.prototype.clone=function(){},z.prototype.multiply=function(){if(arguments[0]instanceof z){var t=arguments[0];return t.isNaN()?z.createNaN():z.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return _.isNaN(e)?z.createNaN():z.copy(this).selfMultiply(e,0)}},z.prototype.isNaN=function(){return _.isNaN(this._hi)},z.prototype.intValue=function(){return Math.trunc(this._hi)},z.prototype.toString=function(){var t=z.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},z.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,i=n;if("."===n.charAt(0))i="0"+n;else if(r<0)i="0."+z.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var o=r-n.length;i=n+z.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},z.prototype.reciprocal=function(){var t=null,e=null,n=null,r=null,i=null,o=null,a=null,s=null;e=(i=1/this._hi)-(t=(o=z.SPLIT*i)-(t=o-i)),n=(s=z.SPLIT*this._hi)-this._hi;var l=i+(o=(1-(a=i*this._hi)-(s=t*(n=s-n)-a+t*(r=this._hi-n)+e*n+e*r)-i*this._lo)/this._hi);return new z(l,i-l+o)},z.prototype.toSciNotation=function(){if(this.isZero())return z.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=z.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var i="";n.length>1&&(i=n.substring(1));var o=n.charAt(0)+"."+i;return this.isNegative()?"-"+o+r:o+r},z.prototype.abs=function(){return this.isNaN()?z.NaN:this.isNegative()?this.negate():new z(this)},z.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},z.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},z.prototype.add=function(){if(arguments[0]instanceof z){var t=arguments[0];return z.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return z.copy(this).selfAdd(e)}},z.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof z){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}},z.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},z.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},z.prototype.trunc=function(){return this.isNaN()?z.NaN:this.isPositive()?this.floor():this.ceil()},z.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},z.prototype.interfaces_=function(){return[e,b,w]},z.prototype.getClass=function(){return z},z.sqr=function(t){return z.valueOf(t).selfMultiply(t)},z.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return z.parse(t)}if("number"==typeof arguments[0])return new z(arguments[0])},z.sqrt=function(t){return z.valueOf(t).sqrt()},z.parse=function(t){for(var e=0,n=t.length;N.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(r=!0))}for(var o=new z,a=0,s=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,N.isDigit(u)){var c=u-"0";o.selfMultiply(z.TEN),o.selfAdd(c),a++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=D.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}s=a}}var f=o,p=a-s-l;if(0===p)f=o;else if(p>0){var d=z.TEN.pow(p);f=o.divide(d)}else if(p<0){var m=z.TEN.pow(-p);f=o.multiply(m)}return r?f.negate():f},z.createNaN=function(){return new z(_.NaN,_.NaN)},z.copy=function(t){return new z(t)},z.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},z.stringOfChar=function(t,e){for(var n=new R,r=0;r<e;r++)n.append(t);return n.toString()},O.PI.get=function(){return new z(3.141592653589793,12246467991473532e-32)},O.TWO_PI.get=function(){return new z(6.283185307179586,24492935982947064e-32)},O.PI_2.get=function(){return new z(1.5707963267948966,6123233995736766e-32)},O.E.get=function(){return new z(2.718281828459045,14456468917292502e-32)},O.NaN.get=function(){return new z(_.NaN,_.NaN)},O.EPS.get=function(){return 123259516440783e-46},O.SPLIT.get=function(){return 134217729},O.MAX_PRINT_DIGITS.get=function(){return 32},O.TEN.get=function(){return z.valueOf(10)},O.ONE.get=function(){return z.valueOf(1)},O.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},O.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(z,O);var F=function(){},B={DP_SAFE_EPSILON:{configurable:!0}};F.prototype.interfaces_=function(){return[]},F.prototype.getClass=function(){return F},F.orientationIndex=function(t,e,n){var r=F.orientationIndexFilter(t,e,n);if(r<=1)return r;var i=z.valueOf(e.x).selfAdd(-t.x),o=z.valueOf(e.y).selfAdd(-t.y),a=z.valueOf(n.x).selfAdd(-e.x),s=z.valueOf(n.y).selfAdd(-e.y);return i.selfMultiply(s).selfSubtract(o.selfMultiply(a)).signum()},F.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},F.intersection=function(t,e,n,r){var i=z.valueOf(r.y).selfSubtract(n.y).selfMultiply(z.valueOf(e.x).selfSubtract(t.x)),o=z.valueOf(r.x).selfSubtract(n.x).selfMultiply(z.valueOf(e.y).selfSubtract(t.y)),a=i.subtract(o),s=z.valueOf(r.x).selfSubtract(n.x).selfMultiply(z.valueOf(t.y).selfSubtract(n.y)),l=z.valueOf(r.y).selfSubtract(n.y).selfMultiply(z.valueOf(t.x).selfSubtract(n.x)),u=s.subtract(l).selfDivide(a).doubleValue(),c=z.valueOf(t.x).selfAdd(z.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=z.valueOf(e.x).selfSubtract(t.x).selfMultiply(z.valueOf(t.y).selfSubtract(n.y)),f=z.valueOf(e.y).selfSubtract(t.y).selfMultiply(z.valueOf(t.x).selfSubtract(n.x)),p=h.subtract(f).selfDivide(a).doubleValue(),d=z.valueOf(n.y).selfAdd(z.valueOf(r.y).selfSubtract(n.y).selfMultiply(p)).doubleValue();return new E(c,d)},F.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),a=i-o;if(i>0){if(o<=0)return F.signum(a);r=i+o}else{if(!(i<0))return F.signum(a);if(o>=0)return F.signum(a);r=-i-o}var s=F.DP_SAFE_EPSILON*r;return a>=s||-a>=s?F.signum(a):2},F.signum=function(t){return t>0?1:t<0?-1:0},B.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(F,B);var j=function(){},U={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};U.X.get=function(){return 0},U.Y.get=function(){return 1},U.Z.get=function(){return 2},U.M.get=function(){return 3},j.prototype.setOrdinate=function(t,e,n){},j.prototype.size=function(){},j.prototype.getOrdinate=function(t,e){},j.prototype.getCoordinate=function(){},j.prototype.getCoordinateCopy=function(t){},j.prototype.getDimension=function(){},j.prototype.getX=function(t){},j.prototype.clone=function(){},j.prototype.expandEnvelope=function(t){},j.prototype.copy=function(){},j.prototype.getY=function(t){},j.prototype.toCoordinateArray=function(){},j.prototype.interfaces_=function(){return[w]},j.prototype.getClass=function(){return j},Object.defineProperties(j,U);var V=function(){},Z=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(V),q=function(){};q.arraycopy=function(t,e,n,r,i){for(var o=0,a=e;a<e+i;a++)n[r+o]=t[a],o++},q.getProperty=function(t){return{"line.separator":"\n"}[t]};var G=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof E&&arguments[1]instanceof E){var a=arguments[0],s=arguments[1];this.x=a.y-s.y,this.y=s.x-a.x,this.w=a.x*s.y-s.x*a.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3],m=h.y-f.y,g=f.x-h.x,v=h.x*f.y-f.x*h.y,y=p.y-d.y,_=d.x-p.x,x=p.x*d.y-d.x*p.y;this.x=g*x-_*v,this.y=y*v-m*x,this.w=m*_-y*g}};G.prototype.getY=function(){var t=this.y/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new Z;return t},G.prototype.getX=function(){var t=this.x/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new Z;return t},G.prototype.getCoordinate=function(){var t=new E;return t.x=this.getX(),t.y=this.getY(),t},G.prototype.interfaces_=function(){return[]},G.prototype.getClass=function(){return G},G.intersection=function(t,e,n,r){var i=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,s=n.y-r.y,l=r.x-n.x,u=n.x*r.y-r.x*n.y,c=i*l-s*o,h=(o*u-l*a)/c,f=(s*a-i*u)/c;if(_.isNaN(h)||_.isInfinite(h)||_.isNaN(f)||_.isInfinite(f))throw new Z;return new E(h,f)};var W=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof E){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2],l=arguments[3];this.init(o,a,s,l)}},X={serialVersionUID:{configurable:!0}};W.prototype.getArea=function(){return this.getWidth()*this.getHeight()},W.prototype.equals=function(t){if(!(t instanceof W))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},W.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new W;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new W(e,r,n,i)},W.prototype.isNull=function(){return this._maxx<this._minx},W.prototype.getMaxX=function(){return this._maxx},W.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof W){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}},W.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof W){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof E){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}},W.prototype.getMinY=function(){return this._miny},W.prototype.getMinX=function(){return this._minx},W.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof W){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},W.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},W.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},W.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},W.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},W.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},W.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},W.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},W.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},W.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},W.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof W){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof E){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},W.prototype.centre=function(){return this.isNull()?null:new E((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},W.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof W){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];i<o?(this._minx=i,this._maxx=o):(this._minx=o,this._maxx=i),a<s?(this._miny=a,this._maxy=s):(this._miny=s,this._maxy=a)}},W.prototype.getMaxY=function(){return this._maxy},W.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},W.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+E.hashCode(this._minx))+E.hashCode(this._maxx))+E.hashCode(this._miny))+E.hashCode(this._maxy)},W.prototype.interfaces_=function(){return[b,e]},W.prototype.getClass=function(){return W},W.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=Math.min(o.x,a.x),l=Math.max(o.x,a.x),u=Math.min(r.x,i.x),c=Math.max(r.x,i.x);return!(u>l)&&!(c<s)&&(s=Math.min(o.y,a.y),l=Math.max(o.y,a.y),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),!(u>l)&&!(c<s))}},X.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(W,X);var H={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Y=function(t){this.geometryFactory=t||new ve};Y.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var i=H.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=H.emptyTypeStr.exec(t))[2]=void 0),i&&(n=i[1].toLowerCase(),r=i[2],K[n]&&(e=K[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Y.prototype.write=function(t){return this.extractGeometry(t)},Y.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!$[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+$[e].apply(this,[t])+")"};var $={coordinate:function(t){return t.x+" "+t.y},point:function(t){return $.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+$.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push($.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push($.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+$.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+$.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+$.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+$.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},K={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(H.spaces);return this.geometryFactory.createPoint(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(H.trimParens,"$1"),r.push(K.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(H.spaces),r.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(H.spaces),r.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(H.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(H.trimParens,"$1"),r.push(K.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r,i,o=t.trim().split(H.parenComma),a=[],s=0,l=o.length;s<l;++s)e=o[s].replace(H.trimParens,"$1"),n=K.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n._points),0===s?i=r:a.push(r);return this.geometryFactory.createPolygon(i,a)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(H.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(H.trimParens,"$1"),r.push(K.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},J=function(t){this.parser=new Y(t)};J.prototype.write=function(t){return this.parser.write(t)},J.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Q=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Q),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(e=arguments[1],!(t=arguments[0])))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new E,this._intPt[1]=new E,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},rt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new R;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return J.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+J.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var a=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);0!==(o=r>i?a:s)||t.equals(e)||(o=Math.max(a,s))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},rt.DONT_INTERSECT.get=function(){return 0},rt.DO_INTERSECT.get=function(){return 1},rt.COLLINEAR.get=function(){return 2},rt.NO_INTERSECTION.get=function(){return 0},rt.POINT_INTERSECTION.get=function(){return 1},rt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,rt);var it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new W(this._inputLines[0][0],this._inputLines[0][1]),n=new W(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,W.intersects(n,r,e)&&0===st.orientationIndex(n,r,e)&&0===st.orientationIndex(r,n,e))return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.safeHCoordinateIntersection=function(t,n,r,i){var o=null;try{o=G.intersection(t,n,r,i)}catch(a){if(!(a instanceof Z))throw a;o=e.nearestEndpoint(t,n,r,i)}return o},e.prototype.intersection=function(t,n,r,i){var o=this.intersectionWithNormalization(t,n,r,i);return this.isInSegmentEnvelopes(o)||(o=new E(e.nearestEndpoint(t,n,r,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,r){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(n)<o&&(i=n,o=Math.abs(n)),Math.abs(r)<o&&(i=r),i},e.prototype.checkDD=function(t,e,n,r,i){var o=F.intersection(t,e,n,r),a=this.isInSegmentEnvelopes(o);q.out.println("DD in env = "+a+"  --------------------- "+o),i.distance(o)>1e-4&&q.out.println("Distance = "+i.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,r){var i=new E(t),o=new E(e),a=new E(n),s=new E(r),l=new E;this.normalizeToEnvCentre(i,o,a,s,l);var u=this.safeHCoordinateIntersection(i,o,a,s);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,r,i){var o=W.intersects(e,n,r),a=W.intersects(e,n,i),s=W.intersects(r,i,e),l=W.intersects(r,i,n);return o&&a?(this._intPt[0]=r,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):s&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&s?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||a||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||a||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&s?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||o||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,r,i){var o=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,s=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<r.x?n.x:r.x,c=n.y<r.y?n.y:r.y,h=n.x>r.x?n.x:r.x,f=n.y>r.y?n.y:r.y,p=((o>u?o:u)+(s<h?s:h))/2,d=((a>c?a:c)+(l<f?l:f))/2;i.x=p,i.y=d,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.computeIntersect=function(e,n,r,i){if(this._isProper=!1,!W.intersects(e,n,r,i))return t.NO_INTERSECTION;var o=st.orientationIndex(e,n,r),a=st.orientationIndex(e,n,i);if(o>0&&a>0||o<0&&a<0)return t.NO_INTERSECTION;var s=st.orientationIndex(r,i,e),l=st.orientationIndex(r,i,n);return s>0&&l>0||s<0&&l<0?t.NO_INTERSECTION:0===o&&0===a&&0===s&&0===l?this.computeCollinearIntersection(e,n,r,i):(0===o||0===a||0===s||0===l?(this._isProper=!1,e.equals2D(r)||e.equals2D(i)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(i)?this._intPt[0]=n:0===o?this._intPt[0]=new E(r):0===a?this._intPt[0]=new E(i):0===s?this._intPt[0]=new E(e):0===l&&(this._intPt[0]=new E(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,i)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,r){var i=t,o=st.distancePointLine(t,n,r),a=st.distancePointLine(e,n,r);return a<o&&(o=a,i=e),(a=st.distancePointLine(n,t,e))<o&&(o=a,i=n),(a=st.distancePointLine(r,t,e))<o&&(o=a,i=r),i},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,a=n.y-e.y;return ot.signOfDet2x2(r,i,o,a)},ot.signOfDet2x2=function(t,e,n,r){var i=null,o=null,a=null;if(i=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-i:i:n>0?i:-i;if(0===e||0===n)return r>0?t>0?i:-i:t>0?-i:i;if(e>0?r>0?e<=r||(i=-i,o=t,t=n,n=o,o=e,e=r,r=o):e<=-r?(i=-i,n=-n,r=-r):(o=t,t=-n,n=o,o=e,e=-r,r=o):r>0?-e<=r?(i=-i,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=r,r=o):e>=r?(t=-t,e=-e,n=-n,r=-r):(i=-i,o=-t,t=-n,n=o,o=-e,e=-r,r=o),t>0){if(!(n>0))return i;if(!(t<=n))return i}else{if(n>0)return-i;if(!(t>=n))return-i;i=-i,t=-t,n=-n}for(;;){if((r-=(a=Math.floor(n/t))*e)<0)return-i;if(r>e)return i;if(t>(n-=a*t)+n){if(e<r+r)return i}else{if(e>r+r)return-i;n=t-n,r=e-r,i=-i}if(0===r)return 0===n?0:-i;if(0===n)return i;if((e-=(a=Math.floor(t/n))*r)<0)return i;if(e>r)return-i;if(n>(t-=a*n)+t){if(r<e+e)return-i}else{if(r>e+e)return i;t=n-t,e=r-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}};var at=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};at.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=t.x-this._p.x,o=t.y-this._p.y,a=e.x-this._p.x,s=e.y-this._p.y,l=ot.signOfDet2x2(i,o,a,s);if(0===l)return this._isPointOnSegment=!0,null;s<o&&(l=-l),l>0&&this._crossingCount++}},at.prototype.isPointInPolygon=function(){return this.getLocation()!==T.EXTERIOR},at.prototype.getLocation=function(){return this._isPointOnSegment?T.BOUNDARY:this._crossingCount%2==1?T.INTERIOR:T.EXTERIOR},at.prototype.isOnSegment=function(){return this._isPointOnSegment},at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.locatePointInRing=function(){if(arguments[0]instanceof E&&A(arguments[1],j)){for(var t=arguments[1],e=new at(arguments[0]),n=new E,r=new E,i=1;i<t.size();i++)if(t.getCoordinate(i,n),t.getCoordinate(i-1,r),e.countSegment(n,r),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof E&&arguments[1]instanceof Array){for(var o=arguments[1],a=new at(arguments[0]),s=1;s<o.length;s++){var l=o[s],u=o[s-1];if(a.countSegment(l,u),a.isOnSegment())return a.getLocation()}return a.getLocation()}};var st=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.orientationIndex=function(t,e,n){return F.orientationIndex(t,e,n)},st.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(A(arguments[0],j)){var a=arguments[0],s=a.size();if(s<3)return 0;var l=new E,u=new E,c=new E;a.getCoordinate(0,u),a.getCoordinate(1,c);var h=u.x;c.x-=h;for(var f=0,p=1;p<s-1;p++)l.y=u.y,u.x=c.x,u.y=c.y,a.getCoordinate(p+1,c),c.x-=h,f+=u.x*(l.y-c.y);return f/2}},st.distanceLineLine=function(t,e,n,r){if(t.equals(e))return st.distancePointLine(t,n,r);if(n.equals(r))return st.distancePointLine(r,t,e);var i=!1;if(W.intersects(t,e,n,r)){var o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===o)i=!0;else{var a=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),s=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=a/o;(l<0||l>1||s<0||s>1)&&(i=!0)}}else i=!0;return i?M.min(st.distancePointLine(t,n,r),st.distancePointLine(e,n,r),st.distancePointLine(n,t,e),st.distancePointLine(r,t,e)):0},st.isPointInRing=function(t,e){return st.locatePointInRing(t,e)!==T.EXTERIOR},st.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new E;t.getCoordinate(0,r);for(var i=r.x,o=r.y,a=1;a<e;a++){t.getCoordinate(a,r);var s=r.x,l=r.y,u=s-i,c=l-o;n+=Math.sqrt(u*u+c*c),i=s,o=l}return n},st.isCCW=function(t){var e=t.length-1;if(e<3)throw new y("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,i=1;i<=e;i++){var o=t[i];o.y>n.y&&(n=o,r=i)}var a=r;do{(a-=1)<0&&(a=e)}while(t[a].equals2D(n)&&a!==r);var s=r;do{s=(s+1)%e}while(t[s].equals2D(n)&&s!==r);var l=t[a],u=t[s];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=st.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},st.locatePointInRing=function(t,e){return at.locatePointInRing(t,e)},st.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)},st.computeOrientation=function(t,e,n){return st.orientationIndex(t,e,n)},st.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new y("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var i=st.distancePointLine(t,e[r],e[r+1]);i<n&&(n=i)}return n}if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];if(a.x===s.x&&a.y===s.y)return o.distance(a);var l=(s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y),u=((o.x-a.x)*(s.x-a.x)+(o.y-a.y)*(s.y-a.y))/l;if(u<=0)return o.distance(a);if(u>=1)return o.distance(s);var c=((a.y-o.y)*(s.x-a.x)-(a.x-o.x)*(s.y-a.y))/l;return Math.abs(c)*Math.sqrt(l)}},st.isOnLine=function(t,e){for(var n=new it,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return st.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return st.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return st.COLLINEAR},Object.defineProperties(st,lt);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ht={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new y("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new W(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),a=i.compareTo(o);if(0!==a)return a}return n.hasNext()?1:r.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[w,b,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ht.serialVersionUID.get=function(){return 0x799ea46522854c00},ht.SORTINDEX_POINT.get=function(){return 0},ht.SORTINDEX_MULTIPOINT.get=function(){return 1},ht.SORTINDEX_LINESTRING.get=function(){return 2},ht.SORTINDEX_LINEARRING.get=function(){return 3},ht.SORTINDEX_MULTILINESTRING.get=function(){return 4},ht.SORTINDEX_POLYGON.get=function(){return 5},ht.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ht.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ht.geometryChangedFilter.get=function(){return ft},Object.defineProperties(ct,ht);var ft=function(){};ft.interfaces_=function(){return[ut]},ft.filter=function(t){t.geometryChangedAction()};var pt=function(){};pt.prototype.filter=function(t){},pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt};var dt=function(){},mt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};dt.prototype.isInBoundary=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},mt.Mod2BoundaryNodeRule.get=function(){return gt},mt.EndPointBoundaryNodeRule.get=function(){return vt},mt.MultiValentEndPointBoundaryNodeRule.get=function(){return yt},mt.MonoValentEndPointBoundaryNodeRule.get=function(){return _t},mt.MOD2_BOUNDARY_RULE.get=function(){return new gt},mt.ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},mt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},mt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},mt.OGC_SFS_BOUNDARY_RULE.get=function(){return dt.MOD2_BOUNDARY_RULE},Object.defineProperties(dt,mt);var gt=function(){};gt.prototype.isInBoundary=function(t){return t%2==1},gt.prototype.interfaces_=function(){return[dt]},gt.prototype.getClass=function(){return gt};var vt=function(){};vt.prototype.isInBoundary=function(t){return t>0},vt.prototype.interfaces_=function(){return[dt]},vt.prototype.getClass=function(){return vt};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>1},yt.prototype.interfaces_=function(){return[dt]},yt.prototype.getClass=function(){return yt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 1===t},_t.prototype.interfaces_=function(){return[dt]},_t.prototype.getClass=function(){return _t};var xt=function(){};xt.prototype.add=function(){},xt.prototype.addAll=function(){},xt.prototype.isEmpty=function(){},xt.prototype.iterator=function(){},xt.prototype.size=function(){},xt.prototype.toArray=function(){},xt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var bt=function(){};bt.prototype.hasNext=function(){},bt.prototype.next=function(){},bt.prototype.remove=function(){};var wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(xt);(r.prototype=new Error).name="NoSuchElementException";var St=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,xt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Et(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(wt),Et=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new r;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(bt),kt=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof E&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;t.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<s.length;u++)this.add(s[u],l);else for(var c=s.length-1;c>=0;c--)this.add(s[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof E){var h=arguments[0],f=arguments[1];if(!arguments[2]){var p=this.size();if(p>0){if(h>0&&this.get(h-1).equals2D(f))return null;if(h<p&&this.get(h).equals2D(f))return null}}t.prototype.add.call(this,h,f)}}else if(4===arguments.length){var d=arguments[0],m=arguments[1],g=arguments[2],v=arguments[3],y=1;g>v&&(y=-1);for(var _=g;_!==v;_+=y)this.add(d[_],m);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new E(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(St),Ct=function(){},It={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};It.ForwardComparator.get=function(){return Tt},It.BidirectionalComparator.get=function(){return Pt},It.coordArrayType.get=function(){return new Array(0).fill(null)},Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Ct.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(Ct.indexOf(r,e)<0)return r}return null},Ct.scroll=function(t,e){var n=Ct.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);q.arraycopy(t,n,r,0,t.length-n),q.arraycopy(t,0,r,t.length-n,n),q.arraycopy(r,0,t,0,t.length)},Ct.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var a=0;a<r.length;a++)if(0!==o.compare(r[a],i[a]))return!1;return!0}},Ct.intersection=function(t,e){for(var n=new kt,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},Ct.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Ct.removeRepeatedPoints=function(t){return Ct.hasRepeatedPoints(t)?new kt(t,!1).toCoordinateArray():t},Ct.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},Ct.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r},Ct.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new E(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=arguments[4],l=0;l<s;l++)o[a+l]=new E(r[i+l])},Ct.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},Ct.envelope=function(t){for(var e=new W,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Ct.toCoordinateArray=function(t){return t.toArray(Ct.coordArrayType)},Ct.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Ct.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Ct.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},Ct.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},Ct.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Ct.extract=function(t,e,n){e=M.clamp(e,0,t.length);var r=(n=M.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,a=e;a<=n;a++)i[o++]=t[a];return i},Object.defineProperties(Ct,It);var Tt=function(){};Tt.prototype.compare=function(t,e){return Ct.compare(t,e)},Tt.prototype.interfaces_=function(){return[S]},Tt.prototype.getClass=function(){return Tt};var Pt=function(){};Pt.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=Ct.compare(n,r);return Ct.isEqualReversed(n,r)?0:i},Pt.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=Ct.increasingDirection(n),o=Ct.increasingDirection(r),a=i>0?0:n.length-1,s=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[a].compareTo(r[s]);if(0!==u)return u;a+=i,s+=o}return 0},Pt.prototype.interfaces_=function(){return[S]},Pt.prototype.getClass=function(){return Pt};var At=function(){};At.prototype.get=function(){},At.prototype.put=function(){},At.prototype.size=function(){},At.prototype.values=function(){},At.prototype.entrySet=function(){};var Mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(At);(i.prototype=new Error).name="OperationNotSupported",(o.prototype=new xt).contains=function(){};var Lt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Rt(this)},e}(o),Rt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new r;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new i},e}(bt),Dt=0;(h.prototype=new Mt).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},h.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Dt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var a={key:t,left:null,right:null,value:e,parent:n,color:Dt,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=a:n.right=a,this.fixAfterInsertion(a),this.size_++,null},h.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(s(t)===u(s(s(t)))){var e=c(s(s(t)));1===a(e)?(l(s(t),Dt),l(e,Dt),l(s(s(t)),1),t=s(s(t))):(t===c(s(t))&&(t=s(t),this.rotateLeft(t)),l(s(t),Dt),l(s(s(t)),1),this.rotateRight(s(s(t))))}else{var n=u(s(s(t)));1===a(n)?(l(s(t),Dt),l(n,Dt),l(s(s(t)),1),t=s(s(t))):(t===u(s(t))&&(t=s(t),this.rotateRight(t)),l(s(t),Dt),l(s(s(t)),1),this.rotateLeft(s(s(t))))}this.root_.color=Dt},h.prototype.values=function(){var t=new St,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=h.successor(e));)t.add(e.value);return t},h.prototype.entrySet=function(){var t=new Lt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=h.successor(e));)t.add(e);return t},h.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},h.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},h.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},h.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)r=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var Nt=function(){};Nt.prototype.interfaces_=function(){return[]},Nt.prototype.getClass=function(){return Nt},f.prototype=new o,(p.prototype=new f).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},p.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},p.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},p.prototype.remove=function(t){throw new i},p.prototype.size=function(){return this.array_.length},p.prototype.isEmpty=function(){return 0===this.array_.length},p.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},p.prototype.iterator=function(){return new zt(this)};var zt=function(t){this.treeSet_=t,this.position_=0};zt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new r;return this.treeSet_.array_[this.position_++]},zt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},zt.prototype.remove=function(){throw new i};var Ot=function(){};Ot.sort=function(){var t,e,n,r,i=arguments[0];if(1===arguments.length)r=function(t,e){return t.compareTo(e)},i.sort(r);else if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},i.sort(r);else if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])}else if(4===arguments.length)for(e=i.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])},Ot.asList=function(t){for(var e=new St,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var Ft=function(){},Bt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bt.P.get=function(){return 0},Bt.L.get=function(){return 1},Bt.A.get=function(){return 2},Bt.FALSE.get=function(){return-1},Bt.TRUE.get=function(){return-2},Bt.DONTCARE.get=function(){return-3},Bt.SYM_FALSE.get=function(){return"F"},Bt.SYM_TRUE.get=function(){return"T"},Bt.SYM_DONTCARE.get=function(){return"*"},Bt.SYM_P.get=function(){return"0"},Bt.SYM_L.get=function(){return"1"},Bt.SYM_A.get=function(){return"2"},Ft.prototype.interfaces_=function(){return[]},Ft.prototype.getClass=function(){return Ft},Ft.toDimensionSymbol=function(t){switch(t){case Ft.FALSE:return Ft.SYM_FALSE;case Ft.TRUE:return Ft.SYM_TRUE;case Ft.DONTCARE:return Ft.SYM_DONTCARE;case Ft.P:return Ft.SYM_P;case Ft.L:return Ft.SYM_L;case Ft.A:return Ft.SYM_A}throw new y("Unknown dimension value: "+t)},Ft.toDimensionValue=function(t){switch(N.toUpperCase(t)){case Ft.SYM_FALSE:return Ft.FALSE;case Ft.SYM_TRUE:return Ft.TRUE;case Ft.SYM_DONTCARE:return Ft.DONTCARE;case Ft.SYM_P:return Ft.P;case Ft.SYM_L:return Ft.L;case Ft.SYM_A:return Ft.A}throw new y("Unknown dimension symbol: "+t)},Object.defineProperties(Ft,Bt);var jt=function(){};jt.prototype.filter=function(t){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var Ut=function(){};Ut.prototype.filter=function(t,e){},Ut.prototype.isDone=function(){},Ut.prototype.isGeometryChanged=function(){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var Vt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new y("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new W,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._geometries.length!==r._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(r._geometries[i],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ot.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Ft.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Ft.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new p(Ot.asList(this._geometries)),n=new p(Ot.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[1],i=arguments[0],o=this.getNumGeometries(),a=i.getNumGeometries(),s=0;s<o&&s<a;){var l=this.getGeometryN(s),u=i.getGeometryN(s),c=l.compareToSameClass(u,r);if(0!==c)return c;s++}return s<o?1:s<a?-1:0}},e.prototype.apply=function(){if(A(arguments[0],pt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(A(arguments[0],Ut)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(A(arguments[0],jt)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(A(arguments[0],ut)){var a=arguments[0];a.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),Zt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Ft.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new qt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Nt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Vt),qt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=dt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};qt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},qt.prototype.getBoundary=function(){return this._geom instanceof Yt?this.boundaryLineString(this._geom):this._geom instanceof Zt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},qt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},qt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},qt.prototype.computeBoundaryCoordinates=function(t){var e=new St;this._endpointMap=new h;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),a=o.getValue().count;this._bnRule.isInBoundary(a)&&e.add(o.getKey())}return Ct.toCoordinateArray(e)},qt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Gt,this._endpointMap.put(t,e)),e.count++},qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.getBoundary=function(){return 1===arguments.length?new qt(arguments[0]).getBoundary():2===arguments.length?new qt(arguments[0],arguments[1]).getBoundary():void 0};var Gt=function(){this.count=null};Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt};var Wt=function(){},Xt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},Wt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o="",a=new function(){}(new function(){}(Wt.getStackTrace(r))),s=0;s<i;s++)try{o+=a.readLine()+Wt.NEWLINE}catch(t){if(!(t instanceof d))throw t;et.shouldNeverReachHere()}return o}},Wt.split=function(t,e){for(var n=e.length,r=new St,i=""+t,o=i.indexOf(e);o>=0;){var a=i.substring(0,o);r.add(a),o=(i=i.substring(o+n)).indexOf(e)}i.length>0&&r.add(i);for(var s=new Array(r.size()).fill(null),l=0;l<s.length;l++)s[l]=r.get(l);return s},Wt.toString=function(){if(1===arguments.length){var t=arguments[0];return Wt.SIMPLE_ORDINATE_FORMAT.format(t)}},Wt.spaces=function(t){return Wt.chars(" ",t)},Xt.NEWLINE.get=function(){return q.getProperty("line.separator")},Xt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Wt,Xt);var Ht=function(){};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht},Ht.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},Ht.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,j.X)===t.getOrdinate(e-1,j.X)&&t.getOrdinate(0,j.Y)===t.getOrdinate(e-1,j.Y)},Ht.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var a=t.getOrdinate(i,o),s=e.getOrdinate(i,o);if(t.getOrdinate(i,o)!==e.getOrdinate(i,o)&&(!_.isNaN(a)||!_.isNaN(s)))return!1}return!0},Ht.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(Ht.copy(e,0,r,0,i),i>0)for(var o=i;o<n;o++)Ht.copy(e,i-1,r,o,1);return r},Ht.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)Ht.swap(t,r,e-r)},Ht.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},Ht.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)Ht.copyCoord(t,e+o,n,r+o)},Ht.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new R;r.append("(");for(var i=0;i<e;i++){i>0&&r.append(" ");for(var o=0;o<n;o++)o>0&&r.append(","),r.append(Wt.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},Ht.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Ht.createClosedRing(t,e,4):e.getOrdinate(0,j.X)===e.getOrdinate(n-1,j.X)&&e.getOrdinate(0,j.Y)===e.getOrdinate(n-1,j.Y)?e:Ht.createClosedRing(t,e,n+1)},Ht.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();Ht.copy(e,0,r,0,i);for(var o=i;o<n;o++)Ht.copy(e,0,r,o,1);return r};var Yt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new W:this._points.expandEnvelope(new W)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._points.size()!==r._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),r._points.getCoordinate(i),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Ht.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Ft.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return st.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Ht.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}},e.prototype.apply=function(){if(A(arguments[0],pt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(A(arguments[0],Ut)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(A(arguments[0],jt)||A(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new qt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new y("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Nt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),$t=function(){};$t.prototype.interfaces_=function(){return[]},$t.prototype.getClass=function(){return $t};var Kt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new W;var t=new W;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Ft.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(A(arguments[0],pt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(A(arguments[0],Ut)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(A(arguments[0],jt)||A(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),Jt=function(){};Jt.prototype.interfaces_=function(){return[]},Jt.prototype.getClass=function(){return Jt};var Qt=function(t){function e(e,n,r){if(t.call(this,r),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new y("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new y("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),a=0;a<o.length;a++)t[++e]=o[a];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(st.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(st.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var i=t.getY(n);if(i!==e.getMinY()&&i!==e.getMaxY())return!1}for(var o=t.getX(0),a=t.getY(0),s=1;s<=4;s++){var l=t.getX(s),u=t.getY(s);if(l!==o===(u!==a))return!1;o=l,a=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e,i=this._shell,o=r._shell;if(!i.equalsExact(o,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(r._holes[a],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Ot.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null);q.arraycopy(e.getCoordinates(),0,r,0,r.length);var i=Ct.minCoordinate(e.getCoordinates());Ct.scroll(r,i),q.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],st.isCCW(e.getCoordinates())===n&&Ct.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[1],i=arguments[0],o=this._shell,a=i._shell,s=o.compareToSameClass(a,r);if(0!==s)return s;for(var l=this.getNumInteriorRing(),u=i.getNumInteriorRing(),c=0;c<l&&c<u;){var h=this.getInteriorRingN(c),f=i.getInteriorRingN(c),p=h.compareToSameClass(f,r);if(0!==p)return p;c++}return c<l?1:c<u?-1:0}},e.prototype.apply=function(t){if(A(t,pt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(A(t,Ut)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(A(t,jt))t.filter(this);else if(A(t,ut)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<n.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Ft.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Vt),ee=function(t){function e(e,n){e instanceof E&&n instanceof ve&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Ft.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Ht.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new y("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new y("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Yt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new St,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Vt),re=function(t){this._factory=t||null,this._isUserDataCopied=!1},ie={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};re.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},re.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},re.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Vt?this.editGeometryCollection(t,e):t instanceof Qt?this.editPolygon(t,e):t instanceof Kt||t instanceof Yt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},re.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new St,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===te?this._factory.createMultiPoint(r.toArray([])):n.getClass()===Zt?this._factory.createMultiLineString(r.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},re.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var i=new St,o=0;o<n.getNumInteriorRing();o++){var a=this.edit(n.getInteriorRingN(o),e);null===a||a.isEmpty()||i.add(a)}return this._factory.createPolygon(r,i.toArray([]))},re.prototype.interfaces_=function(){return[]},re.prototype.getClass=function(){return re},re.GeometryEditorOperation=function(){},ie.NoOpGeometryOperation.get=function(){return oe},ie.CoordinateOperation.get=function(){return ae},ie.CoordinateSequenceOperation.get=function(){return se},Object.defineProperties(re,ie);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var ae=function(){};ae.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Yt?e.createLineString(n):t instanceof Kt?n.length>0?e.createPoint(n[0]):e.createPoint():t},ae.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var se=function(){};se.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Yt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},se.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new E}else if(A(arguments[0],j)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this._coordinates=i,this._dimension=o,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],s=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=s;for(var l=0;l<a;l++)this._coordinates[l]=new E}},ue={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,n){switch(e){case j.X:this._coordinates[t].x=n;break;case j.Y:this._coordinates[t].y=n;break;case j.Z:this._coordinates[t].z=n;break;default:throw new y("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case j.X:return this._coordinates[t].x;case j.Y:return this._coordinates[t].y;case j.Z:return this._coordinates[t].z}return _.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new E(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new R(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[j,e]},le.prototype.getClass=function(){return le},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,ue);var ce=function(){},he={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new le(arguments[0]);if(A(arguments[0],j))return new le(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new le(t):new le(t,e)}},ce.prototype.interfaces_=function(){return[I,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},he.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},he.instanceObject.get=function(){return new ce},Object.defineProperties(ce,he);var fe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new St,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Lt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(At),pe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof me){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}},de={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};pe.prototype.equals=function(t){if(!(t instanceof pe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},pe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new D(n).compareTo(new D(r))},pe.prototype.getScale=function(){return this._scale},pe.prototype.isFloating=function(){return this._modelType===pe.FLOATING||this._modelType===pe.FLOATING_SINGLE},pe.prototype.getType=function(){return this._modelType},pe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===pe.FLOATING?t="Floating":this._modelType===pe.FLOATING_SINGLE?t="Floating-Single":this._modelType===pe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},pe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return _.isNaN(t)||this._modelType===pe.FLOATING_SINGLE?t:this._modelType===pe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof E){var e=arguments[0];if(this._modelType===pe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},pe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===pe.FLOATING?t=16:this._modelType===pe.FLOATING_SINGLE?t=6:this._modelType===pe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},pe.prototype.setScale=function(t){this._scale=Math.abs(t)},pe.prototype.interfaces_=function(){return[e,b]},pe.prototype.getClass=function(){return pe},pe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},de.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},de.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(pe,de);var me=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ge={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};me.prototype.readResolve=function(){return me.nameToTypeMap.get(this._name)},me.prototype.toString=function(){return this._name},me.prototype.interfaces_=function(){return[e]},me.prototype.getClass=function(){return me},ge.serialVersionUID.get=function(){return-552860263173159e4},ge.nameToTypeMap.get=function(){return new fe},Object.defineProperties(me,ge),pe.Type=me,pe.FIXED=new me("FIXED"),pe.FLOATING=new me("FLOATING"),pe.FLOATING_SINGLE=new me("FLOATING SINGLE");var ve=function t(){this._precisionModel=new pe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?A(arguments[0],I)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof pe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},ye={serialVersionUID:{configurable:!0}};ve.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new E(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new E(t.getMinX(),t.getMinY()),new E(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new E(t.getMinX(),t.getMinY()),new E(t.getMinX(),t.getMaxY()),new E(t.getMaxX(),t.getMaxY()),new E(t.getMaxX(),t.getMinY()),new E(t.getMinX(),t.getMinY())]),null)},ve.prototype.createLineString=function(t){return t?t instanceof Array?new Yt(this.getCoordinateSequenceFactory().create(t),this):A(t,j)?new Yt(t,this):void 0:new Yt(this.getCoordinateSequenceFactory().create([]),this)},ve.prototype.createMultiLineString=function(){return 0===arguments.length?new Zt(null,this):1===arguments.length?new Zt(arguments[0],this):void 0},ve.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),a=o.getClass();null===e&&(e=a),a!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(ve.toGeometryArray(t));var s=t.iterator().next();if(t.size()>1){if(s instanceof Qt)return this.createMultiPolygon(ve.toPolygonArray(t));if(s instanceof Yt)return this.createMultiLineString(ve.toLineStringArray(t));if(s instanceof Kt)return this.createMultiPoint(ve.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+s.getClass().getName())}return s},ve.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},ve.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(A(arguments[0],j))return new Kt(arguments[0],this)}},ve.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},ve.prototype.createPolygon=function(){if(0===arguments.length)return new Qt(null,null,this);if(1===arguments.length){if(A(arguments[0],j)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Qt(arguments[0],arguments[1],this)},ve.prototype.getSRID=function(){return this._SRID},ve.prototype.createGeometryCollection=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},ve.prototype.createGeometry=function(t){return new re(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},ve.prototype.getPrecisionModel=function(){return this._precisionModel},ve.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(A(arguments[0],j))return new ee(arguments[0],this)}},ve.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},ve.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(A(arguments[0],j)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),r=0;r<e.size();r++){var i=this.getCoordinateSequenceFactory().create(1,e.getDimension());Ht.copy(e,r,i,0,1),n[r]=this.createPoint(i)}return this.createMultiPoint(n)}}},ve.prototype.interfaces_=function(){return[e]},ve.prototype.getClass=function(){return ve},ve.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},ve.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ve.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ye.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(ve,ye);var _e=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],xe=function(t){this.geometryFactory=t||new ve};xe.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!be[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_e.indexOf(n)?be[n].apply(this,[e.coordinates]):"GeometryCollection"===n?be[n].apply(this,[e.geometries]):be[n].apply(this,[e])},xe.prototype.write=function(t){var e=t.getGeometryType();if(!we[e])throw new Error("Geometry is not supported");return we[e].apply(this,[t])};var be={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!be[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=be.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new E(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new E(t[0],t[1]),new E(t[2],t[1]),new E(t[2],t[3]),new E(t[0],t[3]),new E(t[0],t[1])])},Point:function(t){var e=new E(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=be.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=be.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],a=be.coordinates.apply(this,[o]),s=this.geometryFactory.createLinearRing(a);r.push(s)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(be.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},we={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:we.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.Point.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(we.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=we.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],o=we.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.Polygon.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(we[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},Se=function(t){this.geometryFactory=t||new ve,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new xe(this.geometryFactory)};Se.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===pe.FIXED&&this.reducePrecision(e),e},Se.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ee=function(){this.parser=new xe(this.geometryFactory)};Ee.prototype.write=function(t){return this.parser.write(t)};var ke=function(){},Ce={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};ke.prototype.interfaces_=function(){return[]},ke.prototype.getClass=function(){return ke},ke.opposite=function(t){return t===ke.LEFT?ke.RIGHT:t===ke.RIGHT?ke.LEFT:t},Ce.ON.get=function(){return 0},Ce.LEFT.get=function(){return 1},Ce.RIGHT.get=function(){return 2},Object.defineProperties(ke,Ce),(m.prototype=new Error).name="EmptyStackException",(g.prototype=new wt).add=function(t){return this.array_.push(t),!0},g.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},g.prototype.push=function(t){return this.array_.push(t),t},g.prototype.pop=function(t){if(0===this.array_.length)throw new m;return this.array_.pop()},g.prototype.peek=function(){if(0===this.array_.length)throw new m;return this.array_[this.array_.length-1]},g.prototype.empty=function(){return 0===this.array_.length},g.prototype.isEmpty=function(){return this.empty()},g.prototype.search=function(t){return this.array_.indexOf(t)},g.prototype.size=function(){return this.array_.length},g.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Ie=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ie.prototype.getCoordinate=function(){return this._minCoord},Ie.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Ie.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=st.computeOrientation(this._minCoord,n,e),i=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===st.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===st.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)},Ie.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=ke.LEFT;return n[e].y<n[e+1].y&&(r=ke.RIGHT),r},Ie.prototype.getEdge=function(){return this._orientedDe},Ie.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Ie.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ie.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===ke.LEFT&&(this._orientedDe=this._minDe.getSym())},Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie};var Te=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new E(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(Q),Pe=function(){this.array_=[]};Pe.prototype.addLast=function(t){this.array_.push(t)},Pe.prototype.removeFirst=function(){return this.array_.shift()},Pe.prototype.isEmpty=function(){return 0===this.array_.length};var Ae=function(){this._finder=null,this._dirEdgeList=new St,this._nodes=new St,this._rightMostCoord=null,this._env=null,this._finder=new Ie};Ae.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ae.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ae.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new Te("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},Ae.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(ke.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ae.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ae.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(ke.RIGHT)>=1&&e.getDepth(ke.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ae.prototype.computeDepths=function(t){var e=new Lt,n=new Pe,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var a=o.next().getSym();if(!a.isVisited()){var s=a.getNode();e.contains(s)||(n.addLast(s),e.add(s))}}}},Ae.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ae.prototype.getEnvelope=function(){if(null===this._env){for(var t=new W,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},Ae.prototype.addReachable=function(t){var e=new g;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Ae.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(ke.LEFT,t.getDepth(ke.RIGHT)),e.setDepth(ke.RIGHT,t.getDepth(ke.LEFT))},Ae.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}},Ae.prototype.getNodes=function(){return this._nodes},Ae.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ae.prototype.interfaces_=function(){return[b]},Ae.prototype.getClass=function(){return Ae};var Me=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[ke.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.init(3),this.location[ke.ON]=o,this.location[ke.LEFT]=a,this.location[ke.RIGHT]=s}};Me.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Me.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==T.NONE)return!1;return!0},Me.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===T.NONE&&(this.location[e]=t)},Me.prototype.isLine=function(){return 1===this.location.length},Me.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[ke.ON]=this.location[ke.ON],e[ke.LEFT]=T.NONE,e[ke.RIGHT]=T.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===T.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Me.prototype.getLocations=function(){return this.location},Me.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[ke.LEFT];this.location[ke.LEFT]=this.location[ke.RIGHT],this.location[ke.RIGHT]=t},Me.prototype.toString=function(){var t=new R;return this.location.length>1&&t.append(T.toLocationSymbol(this.location[ke.LEFT])),t.append(T.toLocationSymbol(this.location[ke.ON])),this.location.length>1&&t.append(T.toLocationSymbol(this.location[ke.RIGHT])),t.toString()},Me.prototype.setLocations=function(t,e,n){this.location[ke.ON]=t,this.location[ke.LEFT]=e,this.location[ke.RIGHT]=n},Me.prototype.get=function(t){return t<this.location.length?this.location[t]:T.NONE},Me.prototype.isArea=function(){return this.location.length>1},Me.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===T.NONE)return!0;return!1},Me.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(ke.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Me.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(T.NONE)},Me.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Me.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me};var Le=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Me(e),this.elt[1]=new Me(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Me(n.elt[0]),this.elt[1]=new Me(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.elt[0]=new Me(T.NONE),this.elt[1]=new Me(T.NONE),this.elt[r].setLocation(i)}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.elt[0]=new Me(o,a,s),this.elt[1]=new Me(o,a,s)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new Me(T.NONE,T.NONE,T.NONE),this.elt[1]=new Me(T.NONE,T.NONE,T.NONE),this.elt[l].setLocations(u,c,h)}};Le.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Le.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Le.prototype.isNull=function(t){return this.elt[t].isNull()},Le.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Le.prototype.isLine=function(t){return this.elt[t].isLine()},Le.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Me(t.elt[e]):this.elt[e].merge(t.elt[e])},Le.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Le.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(ke.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Le.prototype.toString=function(){var t=new R;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Le.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Le.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Le.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(ke.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}},Le.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Le.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Le.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Me(this.elt[t].location[0]))},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.toLineLabel=function(t){for(var e=new Le(T.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Re=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new St,this._pts=new St,this._label=new Le(T.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new St,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Re.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=st.isCCW(this._ring.getCoordinates())},Re.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Re.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Te("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Te("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();et.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Re.prototype.getLinearRing=function(){return this._ring},Re.prototype.getCoordinate=function(t){return this._pts.get(t)},Re.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Re.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this._pts.add(r[o])}else{var a=r.length-2;n&&(a=r.length-1);for(var s=a;s>=0;s--)this._pts.add(r[s])}},Re.prototype.isHole=function(){return this._isHole},Re.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Re.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!st.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Re.prototype.addHole=function(t){this._holes.add(t)},Re.prototype.isShell=function(){return null===this._shell},Re.prototype.getLabel=function(){return this._label},Re.prototype.getEdges=function(){return this._edges},Re.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Re.prototype.getShell=function(){return this._shell},Re.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,ke.RIGHT);if(n===T.NONE)return null;if(this._label.getLocation(e)===T.NONE)return this._label.setLocation(e,n),null}},Re.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Re.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var De=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Re),Ne=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new St,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new De(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Re),ze=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};ze.prototype.setVisited=function(t){this._isVisited=t},ze.prototype.setInResult=function(t){this._isInResult=t},ze.prototype.isCovered=function(){return this._isCovered},ze.prototype.isCoveredSet=function(){return this._isCoveredSet},ze.prototype.setLabel=function(t){this._label=t},ze.prototype.getLabel=function(){return this._label},ze.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},ze.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},ze.prototype.isInResult=function(){return this._isInResult},ze.prototype.isVisited=function(){return this._isVisited},ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze};var Oe=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Le(0,T.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=T.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==T.BOUNDARY&&(n=r)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Le(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Le)for(var n=arguments[0],r=0;r<2;r++){var i=this.computeMergedLocation(n,r);this._label.getLocation(r)===T.NONE&&this._label.setLocation(r,i)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=T.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case T.BOUNDARY:n=T.INTERIOR;break;case T.INTERIOR:default:n=T.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ze),Fe=function(){this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Fe.prototype.find=function(t){return this.nodeMap.get(t)},Fe.prototype.addNode=function(){if(arguments[0]instanceof E){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Oe){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}},Fe.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Fe.prototype.iterator=function(){return this.nodeMap.values().iterator()},Fe.prototype.values=function(){return this.nodeMap.values()},Fe.prototype.getBoundaryNodes=function(t){for(var e=new St,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===T.BOUNDARY&&e.add(r)}return e},Fe.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var Be=function(){},je={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Be.NE:Be.SE:e>=0?Be.NW:Be.SW}if(arguments[0]instanceof E&&arguments[1]instanceof E){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new y("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?Be.NE:Be.SE:r.y>=n.y?Be.NW:Be.SW}},je.NE.get=function(){return 0},je.NW.get=function(){return 1},je.SW.get=function(){return 2},je.SE.get=function(){return 3},Object.defineProperties(Be,je);var Ue=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._edge=e,this.init(n,r),this._label=null}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._edge=i,this.init(o,a),this._label=s}};Ue.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:st.computeOrientation(t._p0,t._p1,this._p1)},Ue.prototype.getDy=function(){return this._dy},Ue.prototype.getCoordinate=function(){return this._p0},Ue.prototype.setNode=function(t){this._node=t},Ue.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Ue.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Ue.prototype.getDirectedCoordinate=function(){return this._p1},Ue.prototype.getDx=function(){return this._dx},Ue.prototype.getLabel=function(){return this._label},Ue.prototype.getEdge=function(){return this._edge},Ue.prototype.getQuadrant=function(){return this._quadrant},Ue.prototype.getNode=function(){return this._node},Ue.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Ue.prototype.computeLabel=function(t){},Ue.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Be.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Ue.prototype.interfaces_=function(){return[b]},Ue.prototype.getClass=function(){return Ue};var Ve=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;this.init(e.getCoordinate(r),e.getCoordinate(r-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Le(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Te("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,ke.LEFT)===T.INTERIOR&&this._label.getLocation(e,ke.RIGHT)===T.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[ke.LEFT]+"/"+this._depth[ke.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,T.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,T.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===ke.LEFT&&(r=-1);var i=ke.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===T.EXTERIOR&&e===T.INTERIOR?1:t===T.INTERIOR&&e===T.EXTERIOR?-1:0},e}(Ue),Ze=function(){};Ze.prototype.createNode=function(t){return new Oe(t,null)},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var qe=function(){if(this._edges=new St,this._nodes=null,this._edgeEndList=new St,0===arguments.length)this._nodes=new Fe(new Ze);else if(1===arguments.length){var t=arguments[0];this._nodes=new Fe(t)}};qe.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},qe.prototype.find=function(t){return this._nodes.find(t)},qe.prototype.addNode=function(){if(arguments[0]instanceof Oe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof E){var e=arguments[0];return this._nodes.addNode(e)}},qe.prototype.getNodeIterator=function(){return this._nodes.iterator()},qe.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},qe.prototype.debugPrintln=function(t){q.out.println(t)},qe.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===T.BOUNDARY},qe.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},qe.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&st.computeOrientation(t,e,r)===st.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,r)},qe.prototype.getEdgeEnds=function(){return this._edgeEndList},qe.prototype.debugPrint=function(t){q.out.print(t)},qe.prototype.getEdgeIterator=function(){return this._edges.iterator()},qe.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},qe.prototype.insertEdge=function(t){this._edges.add(t)},qe.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},qe.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var r=new Ve(n,!0),i=new Ve(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}},qe.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},qe.prototype.getNodes=function(){return this._nodes.values()},qe.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe},qe.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ge=function(){this._geometryFactory=null,this._shellList=new St;var t=arguments[0];this._geometryFactory=t};Ge.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}},Ge.prototype.computePolygons=function(t){for(var e=new St,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},Ge.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new Te("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},Ge.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new St,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var a=o.buildMinimalRings(),s=this.findShell(a);null!==s?(this.placePolygonHoles(s,a),e.add(s)):n.addAll(a)}else r.add(o)}return r},Ge.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ge.prototype.buildMaximalEdgeRings=function(t){for(var e=new St,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new Ne(r,this._geometryFactory);e.add(i),i.setInResult()}}return e},Ge.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},Ge.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ge.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,a=null,s=e.iterator();s.hasNext();){var l=s.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(a=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(r)&&st.isPointInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||a.contains(c))&&(o=l)}return o},Ge.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Ge.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];qe.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new St,o=this.buildMinimalEdgeRings(r,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var We=function(){};We.prototype.getBounds=function(){},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var Xe=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Xe.prototype.getItem=function(){return this._item},Xe.prototype.getBounds=function(){return this._bounds},Xe.prototype.interfaces_=function(){return[We,e]},Xe.prototype.getClass=function(){return Xe};var He=function(){this._size=null,this._items=null,this._size=0,this._items=new St,this._items.add(null)};He.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},He.prototype.size=function(){return this._size},He.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},He.prototype.clear=function(){this._size=0,this._items.clear()},He.prototype.isEmpty=function(){return 0===this._size},He.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Ye=function(){};Ye.prototype.visitItem=function(t){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var $e=function(){};$e.prototype.insert=function(t,e){},$e.prototype.remove=function(t,e){},$e.prototype.query=function(){},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e};var Ke=function(){if(this._childBoundables=new St,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Je={serialVersionUID:{configurable:!0}};Ke.prototype.getLevel=function(){return this._level},Ke.prototype.size=function(){return this._childBoundables.size()},Ke.prototype.getChildBoundables=function(){return this._childBoundables},Ke.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Ke.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Ke.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Ke.prototype.interfaces_=function(){return[We,e]},Ke.prototype.getClass=function(){return Ke},Je.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Ke,Je);var Qe=function(){};Qe.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Qe.min=function(t){return Qe.sort(t),t.get(0)},Qe.sort=function(t,e){var n=t.toArray();e?Ot.sort(n,e):Ot.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},Qe.singletonList=function(t){var e=new St;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),r=tn.isComposite(this._boundable2);if(n&&r)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new y("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),a=new tn(o,e,this._itemDistance);a.getDistance()<r&&n.add(a)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[b]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Ke};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new St,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ke?t+=this.size(n):n instanceof Xe&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof Xe&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new St:t}if(1===arguments.length){for(var e=arguments[0],n=new St,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Ke){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof Xe?n.add(i.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Xe(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new St;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(et.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Ke?this.boundablesAtLevel(n,a,i):(et.isTrue(a instanceof Xe),-1===n&&i.add(a))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new St;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(A(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var i=arguments[0],o=arguments[2],a=arguments[1].getChildBoundables(),s=0;s<a.size();s++){var l=a.get(s);this.getIntersectsOp().intersects(l.getBounds(),i)&&(l instanceof Ke?this.query(i,l,o):l instanceof Xe?o.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(A(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var u=arguments[0],c=arguments[2],h=arguments[1].getChildBoundables(),f=0;f<h.size();f++){var p=h.get(f);this.getIntersectsOp().intersects(p.getBounds(),u)&&(p instanceof Ke?this.query(u,p,c):p instanceof Xe?c.add(p.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var a=null,s=r.getChildBoundables().iterator();s.hasNext();){var l=s.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Ke&&(o=this.remove(n,l,i))){a=l;break}}return null!==a&&a.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(a),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ke){var r=this.depth(n);r>t&&(t=r)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new St;n.add(this.createNode(e));var r=new St(t);Qe.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var an=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var r={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new St,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},n.prototype.createNode=function(t){return new sn(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new St;for(var a=0;i.hasNext()&&a<n;){var s=i.next();r[o].add(s),a++}}return r},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];t.prototype.query.call(this,n,r)}else if(3===arguments.length)if(A(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var i=arguments[0],o=arguments[1],a=arguments[2];t.prototype.query.call(this,i,o,a)}else if(A(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var s=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,s,l,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new St(t);Qe.sort(i,n.xComparator);var o=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(A(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var r=arguments[0];return this.nearestNeighbour(r,_.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&A(arguments[1],on)){var i=arguments[0],o=arguments[1],a=new tn(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(a)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var s=arguments[0],l=arguments[1],u=null,c=new He;for(c.add(s);!c.isEmpty()&&l>0;){var h=c.poll(),f=h.getDistance();if(f>=l)break;h.isLeaves()?(l=f,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[2],d=new Xe(arguments[0],arguments[1]),m=new tn(this.getRoot(),d,p);return this.nearestNeighbour(m)[0]}},n.prototype.interfaces_=function(){return[$e,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},r.STRtreeNode.get=function(){return sn},r.serialVersionUID.get=function(){return 0x39920f7d5f261e0},r.xComparator.get=function(){return{interfaces_:function(){return[S]},compare:function(e,r){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(r.getBounds()))}}},r.yComparator.get=function(){return{interfaces_:function(){return[S]},compare:function(e,r){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(r.getBounds()))}}},r.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},r.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,r),n}(en),sn=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new W(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ke),ln=function(){};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ln.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=ln.relativeSign(e.x,n.x),i=ln.relativeSign(e.y,n.y);switch(t){case 0:return ln.compareValue(r,i);case 1:return ln.compareValue(i,r);case 2:return ln.compareValue(i,-r);case 3:return ln.compareValue(-r,i);case 4:return ln.compareValue(-r,-i);case 5:return ln.compareValue(-i,-r);case 6:return ln.compareValue(-i,r);case 7:return ln.compareValue(r,-i)}return et.shouldNeverReachHere("invalid octant value"),0},ln.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new E(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ln.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[b]},un.prototype.getClass=function(){return un};var cn=function(){this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new kt;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new St;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new D(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);n.add(new E(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));i&&n.add(new E(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new D(e[0])),r=i}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new E(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this._edge.getCoordinate(s);return i&&(o[a]=new E(e.coord)),new dn(o,this._edge.getData())},cn.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(et.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Q("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new Q("bad split edge end point at "+i)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var hn=function(){};hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof E&&arguments[1]instanceof E){var i=arguments[0],o=arguments[1],a=o.x-i.x,s=o.y-i.y;if(0===a&&0===s)throw new y("Cannot compute the octant for two identical points "+i);return hn.octant(a,s)}};var fn=function(){};fn.prototype.getCoordinates=function(){},fn.prototype.size=function(){},fn.prototype.getCoordinate=function(t){},fn.prototype.isClosed=function(){},fn.prototype.setData=function(t){},fn.prototype.getData=function(){},fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn};var pn=function(){};pn.prototype.addIntersection=function(t,e){},pn.prototype.interfaces_=function(){return[fn]},pn.prototype.getClass=function(){return pn};var dn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};dn.prototype.getCoordinates=function(){return this._pts},dn.prototype.size=function(){return this._pts.length},dn.prototype.getCoordinate=function(t){return this._pts[t]},dn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},dn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},dn.prototype.setData=function(t){this._data=t},dn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:hn.octant(t,e)},dn.prototype.getData=function(){return this._data},dn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],r=arguments[3],i=new E(arguments[0].getIntersection(r));this.addIntersection(i,n)}},dn.prototype.toString=function(){return J.toLineString(new le(this._pts))},dn.prototype.getNodeList=function(){return this._nodeList},dn.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var i=this._pts[r];t.equals2D(i)&&(n=r)}return this._nodeList.add(t,n)},dn.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},dn.prototype.interfaces_=function(){return[pn]},dn.prototype.getClass=function(){return dn},dn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new St;return dn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};var mn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new E,this.p1=new E;else if(1===arguments.length){var t=arguments[0];this.p0=new E(t.p0),this.p1=new E(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.p0=new E(e,n),this.p1=new E(r,i)}},gn={serialVersionUID:{configurable:!0}};mn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},mn.prototype.orientationIndex=function(){if(arguments[0]instanceof mn){var t=arguments[0],e=st.orientationIndex(this.p0,this.p1,t.p0),n=st.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof E){var r=arguments[0];return st.orientationIndex(this.p0,this.p1,r)}},mn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},mn.prototype.isVertical=function(){return this.p0.x===this.p1.x},mn.prototype.equals=function(t){if(!(t instanceof mn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},mn.prototype.intersection=function(t){var e=new it;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},mn.prototype.project=function(){if(arguments[0]instanceof E){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new E(t);var e=this.projectionFactor(t),n=new E;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof mn){var r=arguments[0],i=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var a=this.project(r.p0);i<0&&(a=this.p0),i>1&&(a=this.p1);var s=this.project(r.p1);return o<0&&(s=this.p0),o>1&&(s=this.p1),new mn(a,s)}},mn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},mn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},mn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},mn.prototype.distancePerpendicular=function(t){return st.distancePointLinePerpendicular(t,this.p0,this.p1)},mn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},mn.prototype.midPoint=function(){return mn.midPoint(this.p0,this.p1)},mn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?_.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},mn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=_.MAX_VALUE,i=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var a=this.closestPoint(t.p1);(i=a.distance(t.p1))<r&&(r=i,n[0]=a,n[1]=t.p1);var s=t.closestPoint(this.p0);(i=s.distance(this.p0))<r&&(r=i,n[0]=this.p0,n[1]=s);var l=t.closestPoint(this.p1);return(i=l.distance(this.p1))<r&&(r=i,n[0]=this.p1,n[1]=l),n},mn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},mn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},mn.prototype.getLength=function(){return this.p0.distance(this.p1)},mn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},mn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},mn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},mn.prototype.lineIntersection=function(t){try{return G.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof Z))throw t}return null},mn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},mn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,a=Math.sqrt(i*i+o*o),s=0,l=0;if(0!==e){if(a<=0)throw new Error("Cannot compute offset from zero-length line segment");s=e*i/a,l=e*o/a}return new E(n-l,r+s)},mn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},mn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||_.isNaN(e))&&(e=1),e},mn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},mn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},mn.prototype.distance=function(){if(arguments[0]instanceof mn){var t=arguments[0];return st.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof E){var e=arguments[0];return st.distancePointLine(e,this.p0,this.p1)}},mn.prototype.pointAlong=function(t){var e=new E;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},mn.prototype.hashCode=function(){var t=_.doubleToLongBits(this.p0.x);t^=31*_.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=_.doubleToLongBits(this.p1.x);return n^=31*_.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},mn.prototype.interfaces_=function(){return[b,e]},mn.prototype.getClass=function(){return mn},mn.midPoint=function(t,e){return new E((t.x+e.x)/2,(t.y+e.y)/2)},gn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(mn,gn);var vn=function(){this.tempEnv1=new W,this.tempEnv2=new W,this._overlapSeg1=new mn,this._overlapSeg2=new mn};vn.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var yn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};yn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},yn.prototype.computeSelect=function(t,e,n,r){var i=this._pts[e],o=this._pts[n];if(r.tempEnv1.init(i,o),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var a=Math.trunc((e+n)/2);e<a&&this.computeSelect(t,e,a,r),a<n&&this.computeSelect(t,a,n,r)},yn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},yn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},yn.prototype.setId=function(t){this._id=t},yn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},yn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new W(t,e)}return this._env},yn.prototype.getEndIndex=function(){return this._end},yn.prototype.getStartIndex=function(){return this._start},yn.prototype.getContext=function(){return this._context},yn.prototype.getId=function(){return this._id},yn.prototype.computeOverlapsInternal=function(t,e,n,r,i,o){var a=this._pts[t],s=this._pts[e],l=n._pts[r],u=n._pts[i];if(e-t==1&&i-r==1)return o.overlap(this,t,n,r),null;if(o.tempEnv1.init(a,s),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((r+i)/2);t<c&&(r<h&&this.computeOverlapsInternal(t,c,n,r,h,o),h<i&&this.computeOverlapsInternal(t,c,n,h,i,o)),c<e&&(r<h&&this.computeOverlapsInternal(c,e,n,r,h,o),h<i&&this.computeOverlapsInternal(c,e,n,h,i,o))},yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.getChainStartIndices=function(t){var e=0,n=new St;n.add(new D(e));do{var r=_n.findChainEnd(t,e);n.add(new D(r)),e=r}while(e<t.length-1);return _n.toIntArray(n)},_n.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=Be.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||Be.quadrant(t[i-1],t[i])===r);)i++;return i-1},_n.getChains=function(){if(1===arguments.length){var t=arguments[0];return _n.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new St,i=_n.getChainStartIndices(e),o=0;o<i.length-1;o++){var a=new yn(e,i[o],i[o+1],n);r.add(a)}return r}},_n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var xn=function(){};xn.prototype.computeNodes=function(t){},xn.prototype.getNodedSubstrings=function(){},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn};var bn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};bn.prototype.setSegmentIntersector=function(t){this._segInt=t},bn.prototype.interfaces_=function(){return[xn]},bn.prototype.getClass=function(){return bn};var wn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new St,this._index=new an,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_n.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new Sn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return Sn},Object.defineProperties(e,n),e}(bn),Sn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[0].getContext(),o=n.getContext();this._si.processIntersections(i,e,o,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vn),En=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(a),this.setMitreLimit(s)}},kn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};En.prototype.getEndCapStyle=function(){return this._endCapStyle},En.prototype.isSingleSided=function(){return this._isSingleSided},En.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=En.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=En.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==En.JOIN_ROUND&&(this._quadrantSegments=En.DEFAULT_QUADRANT_SEGMENTS)},En.prototype.getJoinStyle=function(){return this._joinStyle},En.prototype.setJoinStyle=function(t){this._joinStyle=t},En.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},En.prototype.getSimplifyFactor=function(){return this._simplifyFactor},En.prototype.getQuadrantSegments=function(){return this._quadrantSegments},En.prototype.setEndCapStyle=function(t){this._endCapStyle=t},En.prototype.getMitreLimit=function(){return this._mitreLimit},En.prototype.setMitreLimit=function(t){this._mitreLimit=t},En.prototype.setSingleSided=function(t){this._isSingleSided=t},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},En.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},kn.CAP_ROUND.get=function(){return 1},kn.CAP_FLAT.get=function(){return 2},kn.CAP_SQUARE.get=function(){return 3},kn.JOIN_ROUND.get=function(){return 1},kn.JOIN_MITRE.get=function(){return 2},kn.JOIN_BEVEL.get=function(){return 3},kn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},kn.DEFAULT_MITRE_LIMIT.get=function(){return 5},kn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(En,kn);var Cn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=st.COUNTERCLOCKWISE,this._inputLine=t||null},In={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Cn.prototype.isDeletable=function(t,e,n,r){var i=this._inputLine[t],o=this._inputLine[e],a=this._inputLine[n];return!!this.isConcave(i,o,a)&&!!this.isShallow(i,o,a,r)&&this.isShallowSampled(i,o,t,n,r)},Cn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),r=!1;n<this._inputLine.length;){var i=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Cn.DELETE,i=!0,r=!0),t=i?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return r},Cn.prototype.isShallowConcavity=function(t,e,n,r){return st.computeOrientation(t,e,n)===this._angleOrientation&&st.distancePointLine(e,t,n)<r},Cn.prototype.isShallowSampled=function(t,e,n,r,i){var o=Math.trunc((r-n)/Cn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=n;a<r;a+=o)if(!this.isShallow(t,e,this._inputLine[a],i))return!1;return!0},Cn.prototype.isConcave=function(t,e,n){return st.computeOrientation(t,e,n)===this._angleOrientation},Cn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=st.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Cn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Cn.DELETE;)e++;return e},Cn.prototype.isShallow=function(t,e,n,r){return st.distancePointLine(e,t,n)<r},Cn.prototype.collapseLine=function(){for(var t=new kt,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Cn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.simplify=function(t,e){return new Cn(t).simplify(e)},In.INIT.get=function(){return 0},In.DELETE.get=function(){return 1},In.KEEP.get=function(){return 1},In.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Cn,In);var Tn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new St},Pn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Tn.prototype.getCoordinates=function(){return this._ptList.toArray(Tn.COORDINATE_ARRAY_TYPE)},Tn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Tn.prototype.addPt=function(t){var e=new E(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Tn.prototype.revere=function(){},Tn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])},Tn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Tn.prototype.toString=function(){return(new ve).createLineString(this.getCoordinates()).toString()},Tn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new E(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Tn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Pn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Tn,Pn);var An=function(){},Mn={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An},An.toDegrees=function(t){return 180*t/Math.PI},An.normalize=function(t){for(;t>Math.PI;)t-=An.PI_TIMES_2;for(;t<=-Math.PI;)t+=An.PI_TIMES_2;return t},An.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}},An.isAcute=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0},An.isObtuse=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0},An.interiorAngle=function(t,e,n){var r=An.angle(e,t),i=An.angle(e,n);return Math.abs(i-r)},An.normalizePositive=function(t){if(t<0){for(;t<0;)t+=An.PI_TIMES_2;t>=An.PI_TIMES_2&&(t=0)}else{for(;t>=An.PI_TIMES_2;)t-=An.PI_TIMES_2;t<0&&(t=0)}return t},An.angleBetween=function(t,e,n){var r=An.angle(e,t),i=An.angle(e,n);return An.diff(r,i)},An.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},An.toRadians=function(t){return t*Math.PI/180},An.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?An.COUNTERCLOCKWISE:n<0?An.CLOCKWISE:An.NONE},An.angleBetweenOriented=function(t,e,n){var r=An.angle(e,t),i=An.angle(e,n)-r;return i<=-Math.PI?i+An.PI_TIMES_2:i>Math.PI?i-An.PI_TIMES_2:i},Mn.PI_TIMES_2.get=function(){return 2*Math.PI},Mn.PI_OVER_2.get=function(){return Math.PI/2},Mn.PI_OVER_4.get=function(){return Math.PI/4},Mn.COUNTERCLOCKWISE.get=function(){return st.COUNTERCLOCKWISE},Mn.CLOCKWISE.get=function(){return st.CLOCKWISE},Mn.NONE.get=function(){return st.COLLINEAR},Object.defineProperties(An,Mn);var Ln=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new mn,this._seg1=new mn,this._offset0=new mn,this._offset1=new mn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new it,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===En.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Rn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ln.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=st.computeOrientation(this._s0,this._s1,this._s2),r=n===st.CLOCKWISE&&this._side===ke.LEFT||n===st.COUNTERCLOCKWISE&&this._side===ke.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Ln.prototype.addLineEndCap=function(t,e){var n=new mn(t,e),r=new mn;this.computeOffsetSegment(n,ke.LEFT,this._distance,r);var i=new mn;this.computeOffsetSegment(n,ke.RIGHT,this._distance,i);var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o);switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,s+Math.PI/2,s-Math.PI/2,st.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case En.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case En.CAP_SQUARE:var l=new E;l.x=Math.abs(this._distance)*Math.cos(s),l.y=Math.abs(this._distance)*Math.sin(s);var u=new E(r.p1.x+l.x,r.p1.y+l.y),c=new E(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},Ln.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Ln.prototype.addMitreJoin=function(t,e,n,r){var i=!0,o=null;try{o=G.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof Z))throw t;o=new E(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},Ln.prototype.addFilletCorner=function(t,e,n,r,i){var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);r===st.CLOCKWISE?s<=c&&(s+=2*Math.PI):s>=c&&(s-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,s,c,r,i),this._segList.addPt(n)},Ln.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ln.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===En.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===En.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Ln.prototype.createSquare=function(t){this._segList.addPt(new E(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new E(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Ln.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Ln.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Ln.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Ln.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Ln.prototype.addLimitedMitreJoin=function(t,e,n,r){var i=this._seg0.p1,o=An.angle(i,this._seg0.p0),a=An.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,s=An.normalize(o+a),l=An.normalize(s+Math.PI),u=r*n,c=n-u*Math.abs(Math.sin(a)),h=i.x+u*Math.cos(l),f=i.y+u*Math.sin(l),p=new E(h,f),d=new mn(i,p),m=d.pointAlongOffset(1,c),g=d.pointAlongOffset(1,-c);this._side===ke.LEFT?(this._segList.addPt(m),this._segList.addPt(g)):(this._segList.addPt(g),this._segList.addPt(m))},Ln.prototype.computeOffsetSegment=function(t,e,n,r){var i=e===ke.LEFT?1:-1,o=t.p1.x-t.p0.x,a=t.p1.y-t.p0.y,s=Math.sqrt(o*o+a*a),l=i*n*o/s,u=i*n*a/s;r.p0.x=t.p0.x-u,r.p0.y=t.p0.y+l,r.p1.x=t.p1.x-u,r.p1.y=t.p1.y+l},Ln.prototype.addFilletArc=function(t,e,n,r,i){var o=r===st.CLOCKWISE?-1:1,a=Math.abs(e-n),s=Math.trunc(a/this._filletAngleQuantum+.5);if(s<1)return null;for(var l=a/s,u=0,c=new E;u<a;){var h=e+o*u;c.x=t.x+i*Math.cos(h),c.y=t.y+i*Math.sin(h),this._segList.addPt(c),u+=l}},Ln.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ln.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new E((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new E((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Ln.prototype.createCircle=function(t){var e=new E(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Ln.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Ln.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Tn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Ln.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Ln.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===En.JOIN_BEVEL||this._bufParams.getJoinStyle()===En.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,st.CLOCKWISE,this._distance))},Ln.prototype.closeRing=function(){this._segList.closeRing()},Ln.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Rn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Rn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Rn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Rn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Ln,Rn);var Dn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Dn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&Ct.reverse(o),o},Dn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=Cn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],ke.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{n.addSegments(t,!1);var s=Cn.simplify(t,r),l=s.length-1;n.initSideSegments(s[0],s[1],ke.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(s[u],!0)}n.addLastSegment(),n.closeRing()},Dn.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===ke.RIGHT&&(r=-r);var i=Cn.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var a=1;a<=o;a++){var s=1!==a;n.addNextSegment(i[a],s)}n.closeRing()},Dn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=Cn.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],ke.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var a=Cn.simplify(t,-n),s=a.length-1;e.initSideSegments(a[s],a[s-1],ke.LEFT);for(var l=s-2;l>=0;l--)e.addNextSegment(a[l],!0);e.addLastSegment(),e.addLineEndCap(a[1],a[0]),e.closeRing()},Dn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:e.createCircle(t);break;case En.CAP_SQUARE:e.createSquare(t)}},Dn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},Dn.prototype.getBufferParameters=function(){return this._bufParams},Dn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Dn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Dn.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},Dn.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=Cn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],ke.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{var s=Cn.simplify(t,r),l=s.length-1;n.initSideSegments(s[0],s[1],ke.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(s[u],!0)}n.addLastSegment()},Dn.prototype.getSegGen=function(t){return new Ln(this._precisionModel,this._bufParams,t)},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Dn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new E(t[n]);return e};var Nn=function(){this._subgraphs=null,this._seg=new mn,this._cga=new st;var t=arguments[0];this._subgraphs=t},zn={DepthSegment:{configurable:!0}};Nn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new St,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(A(arguments[2],wt)&&arguments[0]instanceof E&&arguments[1]instanceof Ve){for(var o=arguments[0],a=arguments[1],s=arguments[2],l=a.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x)&&!(this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||st.computeOrientation(this._seg.p0,this._seg.p1,o)===st.RIGHT)){var c=a.getDepth(ke.LEFT);this._seg.p0.equals(l[u])||(c=a.getDepth(ke.RIGHT));var h=new On(this._seg,c);s.add(h)}}else if(A(arguments[2],wt)&&arguments[0]instanceof E&&A(arguments[1],wt))for(var f=arguments[0],p=arguments[2],d=arguments[1].iterator();d.hasNext();){var m=d.next();m.isForward()&&this.findStabbedSegments(f,m,p)}},Nn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Qe.min(e)._leftDepth},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},zn.DepthSegment.get=function(){return On},Object.defineProperties(Nn,zn);var On=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new mn(t),this._leftDepth=e};On.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},On.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},On.prototype.toString=function(){return this._upwardSeg.toString()},On.prototype.interfaces_=function(){return[b]},On.prototype.getClass=function(){return On};var Fn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Fn.prototype.area=function(){return Fn.area(this.p0,this.p1,this.p2)},Fn.prototype.signedArea=function(){return Fn.signedArea(this.p0,this.p1,this.p2)},Fn.prototype.interpolateZ=function(t){if(null===t)throw new y("Supplied point is null.");return Fn.interpolateZ(t,this.p0,this.p1,this.p2)},Fn.prototype.longestSideLength=function(){return Fn.longestSideLength(this.p0,this.p1,this.p2)},Fn.prototype.isAcute=function(){return Fn.isAcute(this.p0,this.p1,this.p2)},Fn.prototype.circumcentre=function(){return Fn.circumcentre(this.p0,this.p1,this.p2)},Fn.prototype.area3D=function(){return Fn.area3D(this.p0,this.p1,this.p2)},Fn.prototype.centroid=function(){return Fn.centroid(this.p0,this.p1,this.p2)},Fn.prototype.inCentre=function(){return Fn.inCentre(this.p0,this.p1,this.p2)},Fn.prototype.interfaces_=function(){return[]},Fn.prototype.getClass=function(){return Fn},Fn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Fn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Fn.det=function(t,e,n,r){return t*r-e*n},Fn.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,a=n.x-i,s=r.x-i,l=n.y-o,u=r.y-o,c=a*u-s*l,h=t.x-i,f=t.y-o,p=(u*h-s*f)/c,d=(-l*h+a*f)/c;return e.z+p*(n.z-e.z)+d*(r.z-e.z)},Fn.longestSideLength=function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),a=r;return i>a&&(a=i),o>a&&(a=o),a},Fn.isAcute=function(t,e,n){return!!An.isAcute(t,e,n)&&!!An.isAcute(e,n,t)&&!!An.isAcute(n,t,e)},Fn.circumcentre=function(t,e,n){var r=n.x,i=n.y,o=t.x-r,a=t.y-i,s=e.x-r,l=e.y-i,u=2*Fn.det(o,a,s,l),c=Fn.det(a,o*o+a*a,l,s*s+l*l),h=Fn.det(o,o*o+a*a,s,s*s+l*l);return new E(r-c/u,i+h/u)},Fn.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new G(t.x+n/2,t.y+r/2,1),o=new G(t.x-r+n/2,t.y+n+r/2,1);return new G(i,o)},Fn.angleBisector=function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,a=n.y-t.y;return new E(t.x+i*o,t.y+i*a)},Fn.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,a=n.x-t.x,s=n.y-t.y,l=n.z-t.z,u=i*l-o*s,c=o*a-r*l,h=r*s-i*a,f=u*u+c*c+h*h;return Math.sqrt(f)/2},Fn.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,i=(t.y+e.y+n.y)/3;return new E(r,i)},Fn.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),a=r+i+o,s=(r*t.x+i*e.x+o*n.x)/a,l=(r*t.y+i*e.y+o*n.y)/a;return new E(s,l)};var Bn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new St;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Bn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,T.EXTERIOR,T.INTERIOR)},Bn.prototype.addPolygon=function(t){var e=this._distance,n=ke.LEFT;this._distance<0&&(e=-this._distance,n=ke.RIGHT);var r=t.getExteriorRing(),i=Ct.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,T.EXTERIOR,T.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var a=t.getInteriorRingN(o),s=Ct.removeRepeatedPoints(a.getCoordinates());this._distance>0&&this.isErodedCompletely(a,-this._distance)||this.addPolygonRing(s,e,ke.opposite(n),T.INTERIOR,T.EXTERIOR)}},Bn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Fn(t[0],t[1],t[2]),r=n.inCentre();return st.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},Bn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Ct.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,T.EXTERIOR,T.INTERIOR)},Bn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var r=new dn(t,new Le(0,T.BOUNDARY,e,n));this._curveList.add(r)},Bn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Bn.prototype.addPolygonRing=function(t,e,n,r,i){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=r,a=i;t.length>=ee.MINIMUM_VALID_SIZE&&st.isCCW(t)&&(o=i,a=r,n=ke.opposite(n));var s=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(s,o,a)},Bn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Qt?this.addPolygon(t):t instanceof Yt?this.addLineString(t):t instanceof Kt?this.addPoint(t):(t instanceof te||t instanceof Zt||t instanceof ne||t instanceof Vt)&&this.addCollection(t)},Bn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i},Bn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var jn=function(){};jn.prototype.locate=function(t){},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var Un=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Un.prototype.next=function(){if(this._atStart)return this._atStart=!1,Un.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new r;var t=this._parent.getGeometryN(this._index++);return t instanceof Vt?(this._subcollectionIterator=new Un(t),this._subcollectionIterator.next()):t},Un.prototype.remove=function(){throw new Error(this.getClass().getName())},Un.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Un.prototype.interfaces_=function(){return[bt]},Un.prototype.getClass=function(){return Un},Un.isAtomic=function(t){return!(t instanceof Vt)};var Vn=function(){this._geom=null;var t=arguments[0];this._geom=t};Vn.prototype.locate=function(t){return Vn.locate(t,this._geom)},Vn.prototype.interfaces_=function(){return[jn]},Vn.prototype.getClass=function(){return Vn},Vn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&st.isPointInRing(t,e.getCoordinates())},Vn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Vn.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(Vn.isPointInRing(t,i))return!1}return!0},Vn.containsPoint=function(t,e){if(e instanceof Qt)return Vn.containsPointInPolygon(t,e);if(e instanceof Vt)for(var n=new Un(e);n.hasNext();){var r=n.next();if(r!==e&&Vn.containsPoint(t,r))return!0}return!1},Vn.locate=function(t,e){return e.isEmpty()?T.EXTERIOR:Vn.containsPoint(t,e)?T.INTERIOR:T.EXTERIOR};var Zn=function(){this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[T.NONE,T.NONE]};Zn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Zn.prototype.propagateSideLabels=function(t){for(var e=T.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,ke.LEFT)!==T.NONE&&(e=r.getLocation(t,ke.LEFT))}if(e===T.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();if(s.getLocation(t,ke.ON)===T.NONE&&s.setLocation(t,ke.ON,i),s.isArea(t)){var l=s.getLocation(t,ke.LEFT),u=s.getLocation(t,ke.RIGHT);if(u!==T.NONE){if(u!==i)throw new Te("side location conflict",a.getCoordinate());l===T.NONE&&et.shouldNeverReachHere("found single null side (at "+a.getCoordinate()+")"),i=l}else et.isTrue(s.getLocation(t,ke.LEFT)===T.NONE,"found single null side"),s.setLocation(t,ke.RIGHT,i),s.setLocation(t,ke.LEFT,i)}}},Zn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Zn.prototype.print=function(t){q.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Zn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Zn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,ke.LEFT);et.isTrue(r!==T.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var a=o.next().getLabel();et.isTrue(a.isArea(t),"Found non-area edge");var s=a.getLocation(t,ke.LEFT),l=a.getLocation(t,ke.RIGHT);if(s===l)return!1;if(l!==i)return!1;i=s}return!0},Zn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Zn.prototype.iterator=function(){return this.getEdges().iterator()},Zn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new St(this._edgeMap.values())),this._edgeList},Zn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===T.NONE&&(this._ptInAreaLocation[t]=Vn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Zn.prototype.toString=function(){var t=new R;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Zn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Zn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===T.BOUNDARY&&(e[i]=!0);for(var o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),l=0;l<2;l++)if(s.isAnyNull(l)){var u=T.NONE;if(e[l])u=T.EXTERIOR;else{var c=a.getCoordinate();u=this.getLocation(l,c,t)}s.setAllLocationsIfNull(l,u)}},Zn.prototype.getDegree=function(){return this._edgeMap.size()},Zn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn};var qn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Te("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return Be.isNorthern(i)&&Be.isNorthern(o)?n:Be.isNorthern(i)||Be.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},e.prototype.print=function(t){q.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new St;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(ke.LEFT),r=t.getDepth(ke.RIGHT),i=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,i)!==r)throw new Te("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],a=arguments[2],s=arguments[0];s<o;s++){var l=this._edgeList.get(s);l.setEdgeDepths(ke.RIGHT,a),a=l.getDepth(ke.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),a=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=T.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=T.INTERIOR;break}if(r.isInResult()){t=T.EXTERIOR;break}}}if(t===T.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();a.isLineEdge()?a.getEdge().setCovered(i===T.INTERIOR):(a.isInResult()&&(i=T.EXTERIOR),s.isInResult()&&(i=T.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Le(T.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),i=0;i<2;i++){var o=r.getLocation(i);o!==T.INTERIOR&&o!==T.BOUNDARY||this._label.setLocation(i,T.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Zn),Gn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Oe(t,new qn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ze),Wn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Wn.prototype.compareTo=function(t){var e=t;return Wn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Wn.prototype.interfaces_=function(){return[b]},Wn.prototype.getClass=function(){return Wn},Wn.orientation=function(t){return 1===Ct.increasingDirection(t)},Wn.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,a=e?t.length:-1,s=r?n.length:-1,l=e?0:t.length-1,u=r?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=i)===a,f=(u+=o)===s;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}};var Xn=function(){this._edges=new St,this._ocaMap=new h};Xn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},Xn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Xn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Xn.prototype.iterator=function(){return this._edges.iterator()},Xn.prototype.getEdges=function(){return this._edges},Xn.prototype.get=function(t){return this._edges.get(t)},Xn.prototype.findEqualEdge=function(t){var e=new Wn(t.getCoordinates());return this._ocaMap.get(e)},Xn.prototype.add=function(t){this._edges.add(t);var e=new Wn(t.getCoordinates());this._ocaMap.put(e,t)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Hn=function(){};Hn.prototype.processIntersections=function(t,e,n,r){},Hn.prototype.isDone=function(){},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn};var Yn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Yn.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Yn.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},Yn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Yn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Yn.prototype.getLineIntersector=function(){return this._li},Yn.prototype.hasProperIntersection=function(){return this._hasProper},Yn.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Yn.prototype.hasIntersection=function(){return this._hasIntersection},Yn.prototype.isDone=function(){return!1},Yn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Yn.prototype.interfaces_=function(){return[Hn]},Yn.prototype.getClass=function(){return Yn},Yn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var $n=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new E(t),this.segmentIndex=e,this.dist=n};$n.prototype.getSegmentIndex=function(){return this.segmentIndex},$n.prototype.getCoordinate=function(){return this.coord},$n.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},$n.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},$n.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},$n.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},$n.prototype.getDistance=function(){return this.dist},$n.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},$n.prototype.interfaces_=function(){return[b]},$n.prototype.getClass=function(){return $n};var Kn=function(){this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t};Kn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Kn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Kn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Kn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Kn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new E(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this.edge.pts[s];return i&&(o[a]=e.coord),new nr(o,new Le(this.edge._label))},Kn.prototype.add=function(t,e,n){var r=new $n(t,e,n),i=this._nodeMap.get(r);return null!==i?i:(this._nodeMap.put(r,r),r)},Kn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var Jn=function(){};Jn.prototype.getChainStartIndices=function(t){var e=0,n=new St;n.add(new D(e));do{var r=this.findChainEnd(t,e);n.add(new D(r)),e=r}while(e<t.length-1);return Jn.toIntArray(n)},Jn.prototype.findChainEnd=function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&Be.quadrant(t[r-1],t[r])===n;)r++;return r-1},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn},Jn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Qn=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new W,this.env2=new W;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Jn;this.startIndex=e.getChainStartIndices(this.pts)};Qn.prototype.getCoordinates=function(){return this.pts},Qn.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Qn.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Qn.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[i],h=this.pts[o],f=a.pts[s],p=a.pts[l];if(o-i==1&&l-s==1)return u.addIntersections(this.e,i,a.e,s),null;if(this.env1.init(c,h),this.env2.init(f,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((i+o)/2),m=Math.trunc((s+l)/2);i<d&&(s<m&&this.computeIntersectsForChain(i,d,a,s,m,u),m<l&&this.computeIntersectsForChain(i,d,a,m,l,u)),d<o&&(s<m&&this.computeIntersectsForChain(d,o,a,s,m,u),m<l&&this.computeIntersectsForChain(d,o,a,m,l,u))}},Qn.prototype.getStartIndexes=function(){return this.startIndex},Qn.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn};var tr=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},er={NULL_VALUE:{configurable:!0}};tr.prototype.getDepth=function(t,e){return this._depth[t][e]},tr.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},tr.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==tr.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===tr.NULL_VALUE}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._depth[r][i]===tr.NULL_VALUE}},tr.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}},tr.prototype.getDelta=function(t){return this._depth[t][ke.RIGHT]-this._depth[t][ke.LEFT]},tr.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?T.EXTERIOR:T.INTERIOR},tr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},tr.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var r=t.getLocation(e,n);r!==T.EXTERIOR&&r!==T.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=tr.depthAtLocation(r):this._depth[e][n]+=tr.depthAtLocation(r))}else if(3===arguments.length){var i=arguments[0],o=arguments[1];arguments[2]===T.INTERIOR&&this._depth[i][o]++}},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},tr.depthAtLocation=function(t){return t===T.EXTERIOR?0:t===T.INTERIOR?1:tr.NULL_VALUE},er.NULL_VALUE.get=function(){return-1},Object.defineProperties(tr,er);var nr=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Kn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new tr,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Le.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,i=!0,o=this.pts.length,a=0;a<this.pts.length;a++)if(this.pts[a].equals2D(n.pts[a])||(r=!1),this.pts[a].equals2D(n.pts[--o])||(i=!1),!r&&!i)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Qn(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new W;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,r){var i=new E(t.getIntersection(r)),o=e,a=t.getEdgeDistance(n,r),s=o+1;if(s<this.pts.length){var l=this.pts[s];i.equals2D(l)&&(o=s,a=0)}this.eiList.add(i,o,a)},e.prototype.toString=function(){var t=new R;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,ke.ON),e.getLocation(1,ke.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,ke.LEFT),e.getLocation(1,ke.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,ke.RIGHT),e.getLocation(1,ke.RIGHT),2))},e}(ze),rr=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Xn,this._bufParams=t||null};rr.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},rr.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Le(t.getLabel())).flip(),n.merge(r);var i=rr.depthDelta(r),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(rr.depthDelta(t.getLabel()))},rr.prototype.buildSubgraphs=function(t,e){for(var n=new St,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),a=new Nn(n).getDepth(o);i.computeDepth(a),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},rr.prototype.createSubgraphs=function(t){for(var e=new St,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new Ae;i.create(r),e.add(i)}}return Qe.sort(e,Qe.reverseOrder()),e},rr.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},rr.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new wn,n=new it;return n.setPrecisionModel(t),e.setSegmentIntersector(new Yn(n)),e},rr.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new Dn(n,this._bufParams),i=new Bn(t,e,r).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this._graph=new qe(new Gn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),a=new Ge(this._geomFact);this.buildSubgraphs(o,a);var s=a.getPolygons();return s.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(s)},rr.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=i.getData(),s=new nr(i.getCoordinates(),new Le(a));this.insertUniqueEdge(s)}}},rr.prototype.setNoder=function(t){this._workingNoder=t},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.depthDelta=function(t){var e=t.getLocation(0,ke.LEFT),n=t.getLocation(0,ke.RIGHT);return e===T.INTERIOR&&n===T.EXTERIOR?1:e===T.EXTERIOR&&n===T.INTERIOR?-1:0},rr.convertSegStrings=function(t){for(var e=new ve,n=new St;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)};var ir=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=i,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ir.prototype.rescale=function(){if(A(arguments[0],xt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&q.out.println(n)}},ir.prototype.scale=function(){if(A(arguments[0],xt)){for(var t=arguments[0],e=new St,n=t.iterator();n.hasNext();){var r=n.next();e.add(new dn(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),a=0;a<i.length;a++)o[a]=new E(Math.round((i[a].x-this._offsetX)*this._scaleFactor),Math.round((i[a].y-this._offsetY)*this._scaleFactor),i[a].z);return Ct.removeRepeatedPoints(o)}},ir.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ir.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ir.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ir.prototype.interfaces_=function(){return[xn]},ir.prototype.getClass=function(){return ir};var or=function(){this._li=new it,this._segStrings=null;var t=arguments[0];this._segStrings=t},ar={fact:{configurable:!0}};or.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new Q("found endpt/interior pt intersection at index "+o+" :pt "+n)},or.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],a=i.getCoordinates(),s=o.getCoordinates(),l=0;l<a.length-1;l++)for(var u=0;u<s.length-1;u++)this.checkInteriorIntersections(i,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],p=arguments[3];if(c===f&&h===p)return null;var d=c.getCoordinates()[h],m=c.getCoordinates()[h+1],g=f.getCoordinates()[p],v=f.getCoordinates()[p+1];if(this._li.computeIntersection(d,m,g,v),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,m)||this.hasInteriorIntersection(this._li,g,v)))throw new Q("found non-noded intersection at "+d+"-"+m+" and "+g+"-"+v)}},or.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},or.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])},or.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},or.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Q("found non-noded collapse at "+or.fact.createLineString([t,e,n]))},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},ar.fact.get=function(){return new ve},Object.defineProperties(or,ar);var sr=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new y("Scale factor must be non-zero");1!==e&&(this._pt=new E(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new E,this._p1Scaled=new E),this.initCorners(this._pt)},lr={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};sr.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),a=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;if(a)return!1;var s=this.intersectsToleranceSquare(t,e);return et.isTrue(!(a&&s),"Found bad envelope test"),s},sr.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new E(this._maxx,this._maxy),this._corner[1]=new E(this._minx,this._maxy),this._corner[2]=new E(this._minx,this._miny),this._corner[3]=new E(this._maxx,this._miny)},sr.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},sr.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},sr.prototype.getCoordinate=function(){return this._originalPt},sr.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},sr.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=sr.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new W(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},sr.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},sr.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!r)||!!t.equals(this._pt)||!!e.equals(this._pt))))},sr.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr},lr.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(sr,lr);var ur=function(){this.tempEnv1=new W,this.selectedSegment=new mn};ur.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var cr=function(){this._index=null;var t=arguments[0];this._index=t},hr={HotPixelSnapAction:{configurable:!0}};cr.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getSafeEnvelope(),o=new fr(e,n,r);return this._index.query(i,{interfaces_:function(){return[Ye]},visitItem:function(t){t.select(i,o)}}),o.isNodeAdded()}},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},hr.HotPixelSnapAction.get=function(){return fr},Object.defineProperties(cr,hr);var fr=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ur),pr=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new St};pr.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},pr.prototype.isDone=function(){return!1},pr.prototype.getInteriorIntersections=function(){return this._interiorIntersections},pr.prototype.interfaces_=function(){return[Hn]},pr.prototype.getClass=function(){return pr};var dr=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new it,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};dr.prototype.checkCorrectness=function(t){var e=dn.getNodedSubstrings(t),n=new or(e);try{n.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},dr.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},dr.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},dr.prototype.findInteriorIntersections=function(t,e){var n=new pr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},dr.prototype.computeVertexSnaps=function(){if(A(arguments[0],xt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof dn)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new sr(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}},dr.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new wn,this._pointSnapper=new cr(this._noder.getIndex()),this.snapRound(t,this._li)},dr.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=new sr(n,this._scaleFactor,this._li);this._pointSnapper.snap(r)}},dr.prototype.interfaces_=function(){return[xn]},dr.prototype.getClass=function(){return dr};var mr=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new En,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},gr={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};mr.prototype.bufferFixedPrecision=function(t){var e=new ir(new dr(new pe(1)),t.getScale()),n=new rr(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},mr.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=mr.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Te))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=mr.precisionScaleFactor(this._argGeom,this._distance,n),i=new pe(r);this.bufferFixedPrecision(i)}},mr.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===pe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},mr.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},mr.prototype.bufferOriginalPrecision=function(){try{var t=new rr(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Q))throw t;this._saveException=t}},mr.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},mr.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},mr.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new mr(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],r=new mr(arguments[0]);return r.setQuadrantSegments(n),r.getResultGeometry(e)}if(arguments[2]instanceof En&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var i=arguments[1];return new mr(arguments[0],arguments[2]).getResultGeometry(i)}}else if(4===arguments.length){var o=arguments[1],a=arguments[2],s=arguments[3],l=new mr(arguments[0]);return l.setQuadrantSegments(a),l.setEndCapStyle(s),l.getResultGeometry(o)}},mr.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),i=M.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},gr.CAP_ROUND.get=function(){return En.CAP_ROUND},gr.CAP_BUTT.get=function(){return En.CAP_FLAT},gr.CAP_FLAT.get=function(){return En.CAP_FLAT},gr.CAP_SQUARE.get=function(){return En.CAP_SQUARE},gr.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(mr,gr);var vr=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};vr.prototype.getCoordinates=function(){return this._pt},vr.prototype.getCoordinate=function(t){return this._pt[t]},vr.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},vr.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},vr.prototype.getDistance=function(){return this._distance},vr.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},vr.prototype.interfaces_=function(){return[]},vr.prototype.getClass=function(){return vr};var yr=function(){};yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr},yr.computeDistance=function(){if(arguments[2]instanceof vr&&arguments[0]instanceof Yt&&arguments[1]instanceof E)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),r=new mn,i=0;i<n.length-1;i++){r.setCoordinates(n[i],n[i+1]);var o=r.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof vr&&arguments[0]instanceof Qt&&arguments[1]instanceof E){var a=arguments[0],s=arguments[1],l=arguments[2];yr.computeDistance(a.getExteriorRing(),s,l);for(var u=0;u<a.getNumInteriorRing();u++)yr.computeDistance(a.getInteriorRingN(u),s,l)}else if(arguments[2]instanceof vr&&arguments[0]instanceof ct&&arguments[1]instanceof E){var c=arguments[0],h=arguments[1],f=arguments[2];if(c instanceof Yt)yr.computeDistance(c,h,f);else if(c instanceof Qt)yr.computeDistance(c,h,f);else if(c instanceof Vt)for(var p=c,d=0;d<p.getNumGeometries();d++){var m=p.getGeometryN(d);yr.computeDistance(m,h,f)}else f.setMinimum(c.getCoordinate(),h)}else if(arguments[2]instanceof vr&&arguments[0]instanceof mn&&arguments[1]instanceof E){var g=arguments[1],v=arguments[2],y=arguments[0].closestPoint(g);v.setMinimum(y,g)}};var _r=function(t){this._maxPtDist=new vr,this._inputGeom=t||null},xr={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_r.prototype.computeMaxMidpointDistance=function(t){var e=new wr(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.computeMaxVertexDistance=function(t){var e=new br(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},_r.prototype.getDistancePoints=function(){return this._maxPtDist},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r},xr.MaxPointDistanceFilter.get=function(){return br},xr.MaxMidpointDistanceFilter.get=function(){return wr},Object.defineProperties(_r,xr);var br=function(t){this._maxPtDist=new vr,this._minPtDist=new vr,this._geom=t||null};br.prototype.filter=function(t){this._minPtDist.initialize(),yr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},br.prototype.getMaxPointDistance=function(){return this._maxPtDist},br.prototype.interfaces_=function(){return[pt]},br.prototype.getClass=function(){return br};var wr=function(t){this._maxPtDist=new vr,this._minPtDist=new vr,this._geom=t||null};wr.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=new E((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),yr.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wr.prototype.isDone=function(){return!1},wr.prototype.isGeometryChanged=function(){return!1},wr.prototype.getMaxPointDistance=function(){return this._maxPtDist},wr.prototype.interfaces_=function(){return[Ut]},wr.prototype.getClass=function(){return wr};var Sr=function(t){this._comps=t||null};Sr.prototype.filter=function(t){t instanceof Qt&&this._comps.add(t)},Sr.prototype.interfaces_=function(){return[jt]},Sr.prototype.getClass=function(){return Sr},Sr.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Sr.getPolygons(t,new St)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Qt?n.add(e):e instanceof Vt&&e.apply(new Sr(n)),n}};var Er=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Er.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Yt&&this._lines.add(t)},Er.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Er.prototype.interfaces_=function(){return[ut]},Er.prototype.getClass=function(){return Er},Er.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Er.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Er.getLines(e,n))}},Er.getLines=function(){if(1===arguments.length){var t=arguments[0];return Er.getLines(t,!1)}if(2===arguments.length){if(A(arguments[0],xt)&&A(arguments[1],xt)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var r=n.next();Er.getLines(r,e)}return e}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var i=arguments[0],o=arguments[1],a=new St;return i.apply(new Er(a,o)),a}if(arguments[0]instanceof ct&&A(arguments[1],xt)){var s=arguments[0],l=arguments[1];return s instanceof Yt?l.add(s):s.apply(new Er(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&A(arguments[0],xt)&&A(arguments[1],xt)){for(var u=arguments[1],c=arguments[2],h=arguments[0].iterator();h.hasNext();){var f=h.next();Er.getLines(f,u,c)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&A(arguments[1],xt)){var p=arguments[1],d=arguments[2];return arguments[0].apply(new Er(p,d)),p}}};var kr=function(){if(this._boundaryRule=dt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new y("Rule must be non-null");this._boundaryRule=t}};kr.prototype.locateInternal=function(){if(arguments[0]instanceof E&&arguments[1]instanceof Qt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return T.EXTERIOR;var n=e.getExteriorRing(),r=this.locateInPolygonRing(t,n);if(r===T.EXTERIOR)return T.EXTERIOR;if(r===T.BOUNDARY)return T.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),a=this.locateInPolygonRing(t,o);if(a===T.INTERIOR)return T.EXTERIOR;if(a===T.BOUNDARY)return T.BOUNDARY}return T.INTERIOR}if(arguments[0]instanceof E&&arguments[1]instanceof Yt){var s=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(s))return T.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!s.equals(u[0])&&!s.equals(u[u.length-1])?st.isOnLine(s,u)?T.INTERIOR:T.EXTERIOR:T.BOUNDARY}if(arguments[0]instanceof E&&arguments[1]instanceof Kt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?T.INTERIOR:T.EXTERIOR}},kr.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?st.locatePointInRing(t,e.getCoordinates()):T.EXTERIOR},kr.prototype.intersects=function(t,e){return this.locate(t,e)!==T.EXTERIOR},kr.prototype.updateLocationInfo=function(t){t===T.INTERIOR&&(this._isIn=!0),t===T.BOUNDARY&&this._numBoundaries++},kr.prototype.computeLocation=function(t,e){if(e instanceof Kt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Yt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Qt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Zt)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof ne)for(var o=e,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);this.updateLocationInfo(this.locateInternal(t,s))}else if(e instanceof Vt)for(var l=new Un(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},kr.prototype.locate=function(t,e){return e.isEmpty()?T.EXTERIOR:e instanceof Yt||e instanceof Qt?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?T.BOUNDARY:this._numBoundaries>0||this._isIn?T.INTERIOR:T.EXTERIOR)},kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr};var Cr=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._component=e,this._segIndex=n,this._pt=r}},Ir={INSIDE_AREA:{configurable:!0}};Cr.prototype.isInsideArea=function(){return this._segIndex===Cr.INSIDE_AREA},Cr.prototype.getCoordinate=function(){return this._pt},Cr.prototype.getGeometryComponent=function(){return this._component},Cr.prototype.getSegmentIndex=function(){return this._segIndex},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Ir.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Cr,Ir);var Tr=function(t){this._pts=t||null};Tr.prototype.filter=function(t){t instanceof Kt&&this._pts.add(t)},Tr.prototype.interfaces_=function(){return[jt]},Tr.prototype.getClass=function(){return Tr},Tr.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Kt?Qe.singletonList(t):Tr.getPoints(t,new St)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Kt?n.add(e):e instanceof Vt&&e.apply(new Tr(n)),n}};var Pr=function(){this._locations=null;var t=arguments[0];this._locations=t};Pr.prototype.filter=function(t){(t instanceof Kt||t instanceof Yt||t instanceof Qt)&&this._locations.add(new Cr(t,0,t.getCoordinate()))},Pr.prototype.interfaces_=function(){return[jt]},Pr.prototype.getClass=function(){return Pr},Pr.getLocations=function(t){var e=new St;return t.apply(new Pr(e)),e};var Ar=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new kr,this._minDistanceLocation=null,this._minDistance=_.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=i}};Ar.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=1-e,i=Sr.getPolygons(this._geom[e]);if(i.size()>0){var o=Pr.getLocations(this._geom[r]);if(this.computeContainmentDistance(o,i,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&A(arguments[0],wt)&&A(arguments[1],wt)){for(var a=arguments[0],s=arguments[1],l=arguments[2],u=0;u<a.size();u++)for(var c=a.get(u),h=0;h<s.size();h++)if(this.computeContainmentDistance(c,s.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Cr&&arguments[1]instanceof Qt){var f=arguments[0],p=arguments[1],d=arguments[2],m=f.getCoordinate();if(T.EXTERIOR!==this._ptLocator.locate(m,p))return this._minDistance=0,d[0]=f,d[1]=new Cr(p,m),null}},Ar.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this._minDistance<=this._terminateDistance)return null}},Ar.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Er.getLines(this._geom[0]),n=Er.getLines(this._geom[1]),r=Tr.getPoints(this._geom[0]),i=Tr.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))))},Ar.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ar.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Ar.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ar.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Yt&&arguments[1]instanceof Kt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){var a=st.distancePointLine(i,r[o],r[o+1]);if(a<this._minDistance){this._minDistance=a;var s=new mn(r[o],r[o+1]).closestPoint(i);n[0]=new Cr(t,o,s),n[1]=new Cr(e,0,i)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Yt&&arguments[1]instanceof Yt){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),f=u.getCoordinates(),p=0;p<h.length-1;p++)for(var d=0;d<f.length-1;d++){var m=st.distanceLineLine(h[p],h[p+1],f[d],f[d+1]);if(m<this._minDistance){this._minDistance=m;var g=new mn(h[p],h[p+1]),v=new mn(f[d],f[d+1]),y=g.closestPoints(v);c[0]=new Cr(l,p,y[0]),c[1]=new Cr(u,d,y[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ar.prototype.computeMinDistancePoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o),s=i.getCoordinate().distance(a.getCoordinate());if(s<this._minDistance&&(this._minDistance=s,n[0]=new Cr(i,0,i.getCoordinate()),n[1]=new Cr(a,0,a.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ar.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new y("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ar.prototype.computeMinDistanceLines=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this._minDistance<=this._terminateDistance)return null}},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar},Ar.distance=function(t,e){return new Ar(t,e).distance()},Ar.isWithinDistance=function(t,e,n){return new Ar(t,e,n).distance()<=n},Ar.nearestPoints=function(t,e){return new Ar(t,e).nearestPoints()};var Mr=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};Mr.prototype.getCoordinates=function(){return this._pt},Mr.prototype.getCoordinate=function(t){return this._pt[t]},Mr.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Mr.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},Mr.prototype.toString=function(){return J.toLineString(this._pt[0],this._pt[1])},Mr.prototype.getDistance=function(){return this._distance},Mr.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr};var Lr=function(){};Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.computeDistance=function(){if(arguments[2]instanceof Mr&&arguments[0]instanceof Yt&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new mn,i=t.getCoordinates(),o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var a=r.closestPoint(e);n.setMinimum(a,e)}else if(arguments[2]instanceof Mr&&arguments[0]instanceof Qt&&arguments[1]instanceof E){var s=arguments[0],l=arguments[1],u=arguments[2];Lr.computeDistance(s.getExteriorRing(),l,u);for(var c=0;c<s.getNumInteriorRing();c++)Lr.computeDistance(s.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Mr&&arguments[0]instanceof ct&&arguments[1]instanceof E){var h=arguments[0],f=arguments[1],p=arguments[2];if(h instanceof Yt)Lr.computeDistance(h,f,p);else if(h instanceof Qt)Lr.computeDistance(h,f,p);else if(h instanceof Vt)for(var d=h,m=0;m<d.getNumGeometries();m++){var g=d.getGeometryN(m);Lr.computeDistance(g,f,p)}else p.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof Mr&&arguments[0]instanceof mn&&arguments[1]instanceof E){var v=arguments[1],y=arguments[2],_=arguments[0].closestPoint(v);y.setMinimum(_,v)}};var Rr=function(){this._g0=null,this._g1=null,this._ptDist=new Mr,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Dr={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Rr.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Rr.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new y("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Rr.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Rr.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Rr.prototype.computeOrientedDistance=function(t,e,n){var r=new Nr(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var i=new zr(e,this._densifyFrac);t.apply(i),n.setMaximum(i.getMaxPointDistance())}},Rr.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr},Rr.distance=function(){if(2===arguments.length)return new Rr(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Rr(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},Dr.MaxPointDistanceFilter.get=function(){return Nr},Dr.MaxDensifiedByFractionDistanceFilter.get=function(){return zr},Object.defineProperties(Rr,Dr);var Nr=function(){this._maxPtDist=new Mr,this._minPtDist=new Mr,this._euclideanDist=new Lr,this._geom=null;var t=arguments[0];this._geom=t};Nr.prototype.filter=function(t){this._minPtDist.initialize(),Lr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Nr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Nr.prototype.interfaces_=function(){return[pt]},Nr.prototype.getClass=function(){return Nr};var zr=function(){this._maxPtDist=new Mr,this._minPtDist=new Mr,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};zr.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=(r.x-n.x)/this._numSubSegs,o=(r.y-n.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var s=n.x+a*i,l=n.y+a*o,u=new E(s,l);this._minPtDist.initialize(),Lr.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},zr.prototype.isDone=function(){return!1},zr.prototype.isGeometryChanged=function(){return!1},zr.prototype.getMaxPointDistance=function(){return this._maxPtDist},zr.prototype.interfaces_=function(){return[Ut]},zr.prototype.getClass=function(){return zr};var Or=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Fr={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Or.prototype.checkMaximumDistance=function(t,e,n){var r=new Rr(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var i=r.getCoordinates();this._errorLocation=i[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+J.toLineString(i[0],i[1])+")"}},Or.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Or.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Or.VERBOSE&&q.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Or.prototype.checkNegativeValid=function(){if(!(this._input instanceof Qt||this._input instanceof ne||this._input instanceof Vt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Or.prototype.getErrorIndicator=function(){return this._errorIndicator},Or.prototype.checkMinimumDistance=function(t,e,n){var r=new Ar(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var i=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+J.toLineString(i[0],i[1])+" )"}},Or.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Or.prototype.getErrorLocation=function(){return this._errorLocation},Or.prototype.getPolygonLines=function(t){for(var e=new St,n=new Er(e),r=Sr.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},Or.prototype.getErrorMessage=function(){return this._errMsg},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Fr.VERBOSE.get=function(){return!1},Fr.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Or,Fr);var Br=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},jr={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Br.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Br.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Br.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new W(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new W(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Br.prototype.checkDistance=function(){var t=new Or(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Br.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Br.prototype.checkPolygonal=function(){this._result instanceof Qt||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Br.prototype.getErrorIndicator=function(){return this._errorIndicator},Br.prototype.getErrorLocation=function(){return this._errorLocation},Br.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Br.prototype.report=function(t){if(!Br.VERBOSE)return null;q.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Br.prototype.getErrorMessage=function(){return this._errorMsg},Br.prototype.interfaces_=function(){return[]},Br.prototype.getClass=function(){return Br},Br.isValidMsg=function(t,e,n){var r=new Br(t,e,n);return r.isValid()?null:r.getErrorMessage()},Br.isValid=function(t,e,n){return!!new Br(t,e,n).isValid()},jr.VERBOSE.get=function(){return!1},jr.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Br,jr);var Ur=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Ur.prototype.getCoordinates=function(){return this._pts},Ur.prototype.size=function(){return this._pts.length},Ur.prototype.getCoordinate=function(t){return this._pts[t]},Ur.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ur.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:hn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Ur.prototype.setData=function(t){this._data=t},Ur.prototype.getData=function(){return this._data},Ur.prototype.toString=function(){return J.toLineString(new le(this._pts))},Ur.prototype.interfaces_=function(){return[fn]},Ur.prototype.getClass=function(){return Ur};var Vr=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new St,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Vr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Vr.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Vr.prototype.getIntersectionSegments=function(){return this._intSegments},Vr.prototype.count=function(){return this._intersectionCount},Vr.prototype.getIntersections=function(){return this._intersections},Vr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vr.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Vr.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=s,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Vr.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Vr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Vr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Vr.prototype.interfaces_=function(){return[Hn]},Vr.prototype.getClass=function(){return Vr},Vr.createAllIntersectionsFinder=function(t){var e=new Vr(t);return e.setFindAllIntersections(!0),e},Vr.createAnyIntersectionFinder=function(t){return new Vr(t)},Vr.createIntersectionCounter=function(t){var e=new Vr(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Zr=function(){this._li=new it,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Zr.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Zr.prototype.getIntersections=function(){return this._segInt.getIntersections()},Zr.prototype.isValid=function(){return this.execute(),this._isValid},Zr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Zr.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Vr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new wn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Zr.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Te(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Zr.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+J.toLineString(t[0],t[1])+" and "+J.toLineString(t[2],t[3])},Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr},Zr.computeIntersections=function(t){var e=new Zr(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var qr=function t(){this._nv=null;var e=arguments[0];this._nv=new Zr(t.toSegmentStrings(e))};qr.prototype.checkValid=function(){this._nv.checkValid()},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},qr.toSegmentStrings=function(t){for(var e=new St,n=t.iterator();n.hasNext();){var r=n.next();e.add(new Ur(r.getCoordinates(),r))}return e},qr.checkValid=function(t){new qr(t).checkValid()};var Gr=function(t){this._mapOp=t};Gr.prototype.map=function(t){for(var e=new St,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(ve.toGeometryArray(e))},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr},Gr.map=function(t,e){return new Gr(e).map(t)};var Wr=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new St,this._resultLineList=new St;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Wr.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Wr.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Wr.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Wr.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Ci.isResultOfOp(r,e)||i.isCovered()||(n.add(i),t.setVisitedEdge(!0)))},Wr.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var i=this._op.isCoveredByA(n.getCoordinate());r.setCovered(i)}}},Wr.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Wr.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},Wr.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Ci.isResultOfOp(r,e)&&e===Ci.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr};var Xr=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new St;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Xr.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Xr.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===Ci.INTERSECTION)){var r=n.getLabel();Ci.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},Xr.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Xr.prototype.interfaces_=function(){return[]},Xr.prototype.getClass=function(){return Xr};var Hr=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Hr.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Hr.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof ee&&!r.isEmpty()||(n=!1);for(var i=new St,o=0;o<t.getNumInteriorRing();o++){var a=this.transformLinearRing(t.getInteriorRingN(o),t);null===a||a.isEmpty()||(a instanceof ee||(n=!1),i.add(a))}if(n)return this._factory.createPolygon(r,i.toArray([]));var s=new St;return null!==r&&s.add(r),s.addAll(i),this._factory.buildGeometry(s)},Hr.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Hr.prototype.getInputGeometry=function(){return this._inputGeom},Hr.prototype.transformMultiLineString=function(t,e){for(var n=new St,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Hr.prototype.transformCoordinates=function(t,e){return this.copy(t)},Hr.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Hr.prototype.transformMultiPoint=function(t,e){for(var n=new St,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Hr.prototype.transformMultiPolygon=function(t,e){for(var n=new St,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Hr.prototype.copy=function(t){return t.copy()},Hr.prototype.transformGeometryCollection=function(t,e){for(var n=new St,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(ve.toGeometryArray(n)):this._factory.buildGeometry(n)},Hr.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Kt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Yt)return this.transformLineString(t,null);if(t instanceof Zt)return this.transformMultiLineString(t,null);if(t instanceof Qt)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Vt)return this.transformGeometryCollection(t,null);throw new y("Unknown Geometry subtype: "+t.getClass().getName())},Hr.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr};var Yr=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new mn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Yt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=r}};Yr.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),o=this.findSnapForVertex(i,e);null!==o&&(t.set(r,new E(o)),0===r&&this._isClosed&&t.set(t.size()-1,new E(o)))}},Yr.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Yr.prototype.snapTo=function(t){var e=new kt(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Yr.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new E(i),!1)}},Yr.prototype.findSegmentIndexToSnap=function(t,e){for(var n=_.MAX_VALUE,r=-1,i=0;i<e.size()-1;i++){if(this._seg.p0=e.get(i),this._seg.p1=e.get(i+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,r=i)}return r},Yr.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var $r=function(t){this._srcGeom=t||null},Kr={SNAP_PRECISION_FACTOR:{configurable:!0}};$r.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Jr(e,n).transform(this._srcGeom)},$r.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new Jr(t,n,!0).transform(this._srcGeom),i=r;return e&&A(i,Jt)&&(i=r.buffer(0)),i},$r.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},$r.prototype.extractTargetCoordinates=function(t){for(var e=new p,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},$r.prototype.computeMinimumSegmentLength=function(t){for(var e=_.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.snap=function(t,e,n){var r=new Array(2).fill(null),i=new $r(t);r[0]=i.snapTo(e,n);var o=new $r(e);return r[1]=o.snapTo(r[0],n),r},$r.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=$r.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===pe.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min($r.computeOverlaySnapTolerance(i),$r.computeOverlaySnapTolerance(o))}},$r.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*$r.SNAP_PRECISION_FACTOR},$r.snapToSelf=function(t,e,n){return new $r(t).snapToSelf(e,n)},Kr.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties($r,Kr);var Jr=function(t){function e(e,n,r){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Yr(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Hr),Qr=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Qr.prototype.getCommon=function(){return _.longBitsToDouble(this._commonBits)},Qr.prototype.add=function(t){var e=_.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Qr.signExpBits(this._commonBits),this._isFirst=!1,null):Qr.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Qr.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Qr.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Qr.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=_.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+_.toBinaryString(t),r=n.substring(n.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+e+" ]"}},Qr.prototype.interfaces_=function(){return[]},Qr.prototype.getClass=function(){return Qr},Qr.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Qr.signExpBits=function(t){return t>>52},Qr.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Qr.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(Qr.getBit(t,r)!==Qr.getBit(e,r))return n;n++}return 52};var ti=function(){this._commonCoord=null,this._ccFilter=new ni},ei={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};ti.prototype.addCommonBits=function(t){var e=new ri(this._commonCoord);t.apply(e),t.geometryChanged()},ti.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new E(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ri(e);return t.apply(n),t.geometryChanged(),t},ti.prototype.getCommonCoordinate=function(){return this._commonCoord},ti.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ei.CommonCoordinateFilter.get=function(){return ni},ei.Translater.get=function(){return ri},Object.defineProperties(ti,ei);var ni=function(){this._commonBitsX=new Qr,this._commonBitsY=new Qr};ni.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},ni.prototype.getCommonCoordinate=function(){return new E(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ni.prototype.interfaces_=function(){return[pt]},ni.prototype.getClass=function(){return ni};var ri=function(){this.trans=null;var t=arguments[0];this.trans=t};ri.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},ri.prototype.isDone=function(){return!1},ri.prototype.isGeometryChanged=function(){return!0},ri.prototype.interfaces_=function(){return[Ut]},ri.prototype.getClass=function(){return ri};var ii=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};ii.prototype.selfSnap=function(t){return new $r(t).snapTo(t,this._snapTolerance)},ii.prototype.removeCommonBits=function(t){this._cbr=new ti,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},ii.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},ii.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Ci.overlayOp(e[0],e[1],t);return this.prepareResult(n)},ii.prototype.checkValid=function(t){t.isValid()||q.out.println("Snapped geometry is invalid")},ii.prototype.computeSnapTolerance=function(){this._snapTolerance=$r.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ii.prototype.snap=function(t){var e=this.removeCommonBits(t);return $r.snap(e[0],e[1],this._snapTolerance)},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.overlayOp=function(t,e,n){return new ii(t,e).getResultGeometry(n)},ii.union=function(t,e){return ii.overlayOp(t,e,Ci.UNION)},ii.intersection=function(t,e){return ii.overlayOp(t,e,Ci.INTERSECTION)},ii.symDifference=function(t,e){return ii.overlayOp(t,e,Ci.SYMDIFFERENCE)},ii.difference=function(t,e){return ii.overlayOp(t,e,Ci.DIFFERENCE)};var oi=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};oi.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=Ci.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Q))throw t;r=t}if(!n)try{e=ii.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Q?r:t}return e},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.overlayOp=function(t,e,n){return new oi(t,e).getResultGeometry(n)},oi.union=function(t,e){return oi.overlayOp(t,e,Ci.UNION)},oi.intersection=function(t,e){return oi.overlayOp(t,e,Ci.INTERSECTION)},oi.symDifference=function(t,e){return oi.overlayOp(t,e,Ci.SYMDIFFERENCE)},oi.difference=function(t,e){return oi.overlayOp(t,e,Ci.DIFFERENCE)};var ai=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};ai.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai};var si=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=i,this._obj=o}},li={INSERT:{configurable:!0},DELETE:{configurable:!0}};si.prototype.isDelete=function(){return this._eventType===si.DELETE},si.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},si.prototype.getObject=function(){return this._obj},si.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},si.prototype.getInsertEvent=function(){return this._insertEvent},si.prototype.isInsert=function(){return this._eventType===si.INSERT},si.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},si.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},si.prototype.interfaces_=function(){return[b]},si.prototype.getClass=function(){return si},li.INSERT.get=function(){return 1},li.DELETE.get=function(){return 2},Object.defineProperties(si,li);var ui=function(){};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var ci=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};ci.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(ci.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},ci.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ci.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},ci.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ci.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},ci.prototype.hasProperIntersection=function(){return this._hasProper},ci.prototype.hasIntersection=function(){return this._hasIntersection},ci.prototype.isDone=function(){return this._isDone},ci.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},ci.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},ci.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},ci.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hi=function(t){function e(){t.call(this),this.events=new St,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Qe.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ci&&A(arguments[0],wt)&&A(arguments[1],wt)){var r=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(r,r),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&A(arguments[0],wt)&&arguments[1]instanceof ci){var a=arguments[0],s=arguments[1];arguments[2]?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(s)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new ai(n,i),a=new si(e,n.getMinX(i),o);this.events.add(a),this.events.add(new si(n.getMaxX(i),a))}},e.prototype.processOverlaps=function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var a=this.events.get(o);if(a.isInsert()){var s=a.getObject();n.isSameLabel(a)||(i.computeIntersections(s,r),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();){var i=r.next();this.addEdge(i,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ui),fi=function(){this._min=_.POSITIVE_INFINITY,this._max=_.NEGATIVE_INFINITY},pi={NodeComparator:{configurable:!0}};fi.prototype.getMin=function(){return this._min},fi.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},fi.prototype.getMax=function(){return this._max},fi.prototype.toString=function(){return J.toLineString(new E(this._min,0),new E(this._max,0))},fi.prototype.interfaces_=function(){return[]},fi.prototype.getClass=function(){return fi},pi.NodeComparator.get=function(){return di},Object.defineProperties(fi,pi);var di=function(){};di.prototype.compare=function(t,e){var n=t,r=e,i=(n._min+n._max)/2,o=(r._min+r._max)/2;return i<o?-1:i>o?1:0},di.prototype.interfaces_=function(){return[S]},di.prototype.getClass=function(){return di};var mi=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._min=e,this._max=n,this._item=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fi),gi=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fi),vi=function(){this._leaves=new St,this._root=null,this._level=0};vi.prototype.buildTree=function(){Qe.sort(this._leaves,new fi.NodeComparator);for(var t=this._leaves,e=null,n=new St;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},vi.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new mi(t,e,n))},vi.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},vi.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},vi.prototype.printNode=function(t){q.out.println(J.toLineString(new E(t._min,this._level),new E(t._max,this._level)))},vi.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},vi.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var i=new gi(t.get(n),t.get(n+1));e.add(i)}}},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var yi=function(){this._items=new St};yi.prototype.visitItem=function(t){this._items.add(t)},yi.prototype.getItems=function(){return this._items},yi.prototype.interfaces_=function(){return[Ye]},yi.prototype.getClass=function(){return yi};var _i=function(){this._index=null;var t=arguments[0];if(!A(t,Jt))throw new y("Argument must be Polygonal");this._index=new wi(t)},xi={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};_i.prototype.locate=function(t){var e=new at(t),n=new bi(e);return this._index.query(t.y,t.y,n),e.getLocation()},_i.prototype.interfaces_=function(){return[jn]},_i.prototype.getClass=function(){return _i},xi.SegmentVisitor.get=function(){return bi},xi.IntervalIndexedGeometry.get=function(){return wi},Object.defineProperties(_i,xi);var bi=function(){this._counter=null;var t=arguments[0];this._counter=t};bi.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},bi.prototype.interfaces_=function(){return[Ye]},bi.prototype.getClass=function(){return bi};var wi=function(){this._index=new vi;var t=arguments[0];this.init(t)};wi.prototype.init=function(t){for(var e=Er.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},wi.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new mn(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this._index.insert(r,i,n)}},wi.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new yi;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._index.query(r,i,o)}},wi.prototype.interfaces_=function(){return[]},wi.prototype.getClass=function(){return wi};var Si=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new fe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new kr,2===arguments.length){var e=arguments[0],n=arguments[1],r=dt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=r,null!==n&&this.add(n)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this._argIndex=i,this._parentGeom=o,this._boundaryNodeRule=a,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var r=this._nodes.addNode(n).getLabel(),i=1;T.NONE,r.getLocation(t,ke.ON)===T.BOUNDARY&&i++;var o=e.determineBoundary(this._boundaryNodeRule,i);r.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],r=arguments[2],i=new ci(arguments[0],!0,!1);i.setIsDoneIfProperInt(r);var o=this.createEdgeSetIntersector(),a=this._parentGeom instanceof ee||this._parentGeom instanceof Qt||this._parentGeom instanceof ne,s=n||!a;return o.computeIntersections(this._edges,i,s),this.addSelfIntersectionNodes(this._argIndex),i}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var r=new ci(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Kt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,T.INTERIOR)}else if(arguments[0]instanceof E){var e=arguments[0];this.insertPoint(this._argIndex,e,T.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),T.EXTERIOR,T.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,T.INTERIOR,T.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],T.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],T.BOUNDARY)},e.prototype.addLineString=function(t){var e=Ct.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new nr(e,new Le(this._argIndex,T.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===T.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var r=Ct.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var i=e,o=n;st.isCCW(r)&&(i=n,o=e);var a=new nr(r,new Le(this._argIndex,T.BOUNDARY,i,o));this._lineEdgeMap.put(t,a),this.insertEdge(a),this.insertPoint(this._argIndex,r[0],T.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var r=this._nodes.addNode(e),i=r.getLabel();null===i?r._label=new Le(t,n):i.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hi},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof Qt)this.addPolygon(e);else if(e instanceof Yt)this.addLineString(e);else if(e instanceof Kt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Zt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Vt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return A(this._parentGeom,Jt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new _i(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?T.BOUNDARY:T.INTERIOR},e}(qe),Ei=function(){if(this._li=new it,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Si(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=dt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Si(0,e,r),this._arg[1]=new Si(1,n,r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];i.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Si(0,i,a),this._arg[1]=new Si(1,o,a)}};Ei.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Ei.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei};var ki=function(){};ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki.map=function(){if(arguments[0]instanceof ct&&A(arguments[1],ki.MapOp)){for(var t=arguments[0],e=arguments[1],n=new St,r=0;r<t.getNumGeometries();r++){var i=e.map(t.getGeometryN(r));null!==i&&n.add(i)}return t.getFactory().buildGeometry(n)}if(A(arguments[0],xt)&&A(arguments[1],ki.MapOp)){for(var o=arguments[0],a=arguments[1],s=new St,l=o.iterator();l.hasNext();){var u=l.next(),c=a.map(u);null!==c&&s.add(c)}return s}},ki.MapOp=function(){};var Ci=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new kr,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Xn,this._resultPolyList=new St,this._resultLineList=new St,this._resultPointList=new St,this._graph=new qe(new Gn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Le(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(n),i.add(r),n.merge(r)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,r,i){var o=new St;return o.addAll(t),o.addAll(n),o.addAll(r),o.isEmpty()?e.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==T.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new St,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new St;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),qr.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Ge(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var r=new Wr(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var i=new Xr(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),i=r.getLabel();i.isArea()&&!r.isInteriorAreaEdge()&&e.isResultOfOp(i.getLocation(0,ke.RIGHT),i.getLocation(1,ke.RIGHT),t)&&r.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(et.isTrue(!r.isNull(i,ke.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,ke.LEFT,r.getLocation(i,ke.LEFT)),et.isTrue(!r.isNull(i,ke.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,ke.RIGHT,r.getLocation(i,ke.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ei);Ci.overlayOp=function(t,e,n){return new Ci(t,e).getResultGeometry(n)},Ci.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Ci.createEmptyResult(Ci.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Gr.map(t,{interfaces_:function(){return[ki.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ci.INTERSECTION)},Ci.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Ci.createEmptyResult(Ci.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ci.SYMDIFFERENCE)},Ci.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case Ci.INTERSECTION:o=Math.min(r,i);break;case Ci.UNION:o=Math.max(r,i);break;case Ci.DIFFERENCE:o=r;break;case Ci.SYMDIFFERENCE:o=Math.max(r,i)}return o},Ci.createEmptyResult=function(t,e,n,r){var i=null;switch(Ci.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},Ci.difference=function(t,e){return t.isEmpty()?Ci.createEmptyResult(Ci.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ci.DIFFERENCE))},Ci.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Ci.isResultOfOp(n,r,e)}if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];switch(i===T.BOUNDARY&&(i=T.INTERIOR),o===T.BOUNDARY&&(o=T.INTERIOR),a){case Ci.INTERSECTION:return i===T.INTERIOR&&o===T.INTERIOR;case Ci.UNION:return i===T.INTERIOR||o===T.INTERIOR;case Ci.DIFFERENCE:return i===T.INTERIOR&&o!==T.INTERIOR;case Ci.SYMDIFFERENCE:return i===T.INTERIOR&&o!==T.INTERIOR||i!==T.INTERIOR&&o===T.INTERIOR}return!1}},Ci.INTERSECTION=1,Ci.UNION=2,Ci.DIFFERENCE=3,Ci.SYMDIFFERENCE=4;var Ii=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new kr,this._seg=new mn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Ii.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,this._seg.p0),n.getCoordinate(r+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Ii.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?T.BOUNDARY:this._ptLocator.locate(t,this._g)},Ii.prototype.extractLinework=function(t){var e=new Ti;t.apply(e);var n=e.getLinework(),r=ve.toLineStringArray(n);return t.getFactory().createMultiLineString(r)},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii};var Ti=function(){this._linework=null,this._linework=new St};Ti.prototype.getLinework=function(){return this._linework},Ti.prototype.filter=function(t){if(t instanceof Qt){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Ti.prototype.interfaces_=function(){return[jt]},Ti.prototype.getClass=function(){return Ti};var Pi=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Pi.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),i=0;i<r.length-1;i++)this.computeOffsetPoints(r[i],r[i+1],e,n)},Pi.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Pi.prototype.getPoints=function(t){for(var e=new St,n=Er.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},Pi.prototype.computeOffsetPoints=function(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,a=Math.sqrt(i*i+o*o),s=n*i/a,l=n*o/a,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new E(u-l,c+s);r.add(h)}if(this._doRight){var f=new E(u+l,c-s);r.add(f)}},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi};var Ai=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new St;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new Ii(this._geom[0],this._boundaryDistanceTolerance),new Ii(this._geom[1],this._boundaryDistanceTolerance),new Ii(this._geom[2],this._boundaryDistanceTolerance)]},Mi={TOLERANCE:{configurable:!0}};Ai.prototype.reportResult=function(t,e,n){q.out.println("Overlay result invalid - A:"+T.toLocationSymbol(e[0])+" B:"+T.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+T.toLocationSymbol(e[2]))},Ai.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Ai.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._location[0]=this._locFinder[0].getLocation(i),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!Ai.hasLocation(this._location,T.BOUNDARY)||this.isValidResult(r,this._location)}},Ai.prototype.addTestPts=function(t){var e=new Pi(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Ai.prototype.isValidResult=function(t,e){var n=Ci.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===T.INTERIOR);return r||this.reportResult(t,e,n),r},Ai.prototype.getInvalidLocation=function(){return this._invalidLocation},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai},Ai.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Ai.computeBoundaryDistanceTolerance=function(t,e){return Math.min($r.computeSizeBasedSnapTolerance(t),$r.computeSizeBasedSnapTolerance(e))},Ai.isValid=function(t,e,n,r){return new Ai(t,e,r).isValid(n)},Mi.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Ai,Mi);var Li=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Li.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},Li.prototype.combine=function(){for(var t=new St,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.combine=function(){if(1===arguments.length)return new Li(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Li(Li.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];return new Li(Li.createList(n,r,i)).combine()}},Li.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Li.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new St;return n.add(t),n.add(e),n}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=new St;return a.add(r),a.add(i),a.add(o),a}};var Ri=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new St)},Di={STRTREE_NODE_CAPACITY:{configurable:!0}};Ri.prototype.reduceToGeometries=function(t){for(var e=new St,n=t.iterator();n.hasNext();){var r=n.next(),i=null;A(r,wt)?i=this.unionTree(r):r instanceof ct&&(i=r),e.add(i)}return e},Ri.prototype.extractByEnvelope=function(t,e,n){for(var r=new St,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?r.add(o):n.add(o)}return this._geomFactory.buildGeometry(r)},Ri.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return Li.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,i)},Ri.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new an(Ri.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},Ri.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var i=Ri.getGeometry(e,n);return this.unionSafe(i,null)}if(r-n==2)return this.unionSafe(Ri.getGeometry(e,n),Ri.getGeometry(e,n+1));var o=Math.trunc((r+n)/2),a=this.binaryUnion(e,n,o),s=this.binaryUnion(e,o,r);return this.unionSafe(a,s)}},Ri.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},Ri.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Ri.prototype.unionActual=function(t,e){return Ri.restrictToPolygons(t.union(e))},Ri.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Ri.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new St,i=this.extractByEnvelope(n,t,r),o=this.extractByEnvelope(n,e,r),a=this.unionActual(i,o);return r.add(a),Li.combine(r)},Ri.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.restrictToPolygons=function(t){if(A(t,Jt))return t;var e=Sr.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(ve.toPolygonArray(e))},Ri.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Ri.union=function(t){return new Ri(t).union()},Di.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Ri,Di);var Ni=function(){};Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Ci.createEmptyResult(Ci.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ci.UNION)},t.GeoJSONReader=Se,t.GeoJSONWriter=Ee,t.OverlayOp=Ci,t.UnionOp=Ni,t.BufferOp=mr,Object.defineProperty(t,"__esModule",{value:!0})}(e)},8655:function(t,e,n){function r(t){this.options=t||{locator:{}}}function i(){this.cdata=!1}function o(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function a(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function s(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function l(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}r.prototype.parseFromString=function(t,e){var n=this.options,r=new h,o=n.domBuilder||new i,s=n.errorHandler,l=n.locator,c=n.xmlns||{},f=/\/x?html?$/.test(e),p=f?u.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return l&&o.setDocumentLocator(l),r.errorHandler=function(t,e,n){if(!t){if(e instanceof i)return e;t=e}var r={},o=t instanceof Function;function s(e){var i=t[e];!i&&o&&(i=2==t.length?function(n){t(e,n)}:t),r[e]=i&&function(t){i("[xmldom "+e+"]\t"+t+a(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),r}(s,o,l),r.domBuilder=n.domBuilder||o,f&&(c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",t&&"string"===typeof t?r.parse(t,c,p):r.errorHandler.error("invalid doc source"),o.doc},i.prototype={startDocument:function(){this.doc=(new p).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var i=this.doc,a=i.createElementNS(t,n||e),s=r.length;l(this,a),this.currentElement=a,this.locator&&o(this.locator,a);for(var u=0;u<s;u++){t=r.getURI(u);var c=r.getValue(u),h=(n=r.getQName(u),i.createAttributeNS(t,n));this.locator&&o(r.getLocator(u),h),h.value=h.nodeValue=c,a.setAttributeNode(h)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&o(this.locator,n),l(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=s.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(t);else r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&o(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=s.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&o(this.locator,r),l(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(t,e,n);this.locator&&o(this.locator,i),l(this,i)}},warning:function(t){console.warn("[xmldom warning]\t"+t,a(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,a(this.locator))},fatalError:function(t){throw new f(t,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(t){i.prototype[t]=function(){return null}}));var u=n(5456),c=n(1265),h=c.XMLReader,f=c.ParseError,p=n(1928).DOMImplementation;e.XMLSerializer=n(1928).XMLSerializer},1928:function(t,e){function n(t,e){for(var n in t)e[n]=t[n]}function r(t,e){var r=t.prototype;if(!(r instanceof e)){var i=function(){};i.prototype=e.prototype,n(r,i=new i),t.prototype=r=i}r.constructor!=t&&("function"!=typeof t&&console.error("unknow Class:"+t),r.constructor=t)}var i={},o=i.ELEMENT_NODE=1,a=i.ATTRIBUTE_NODE=2,s=i.TEXT_NODE=3,l=i.CDATA_SECTION_NODE=4,u=i.ENTITY_REFERENCE_NODE=5,c=i.ENTITY_NODE=6,h=i.PROCESSING_INSTRUCTION_NODE=7,f=i.COMMENT_NODE=8,p=i.DOCUMENT_NODE=9,d=i.DOCUMENT_TYPE_NODE=10,m=i.DOCUMENT_FRAGMENT_NODE=11,g=i.NOTATION_NODE=12,v={},y={},_=(v.INDEX_SIZE_ERR=(y[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(y[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(y[3]="Hierarchy request error",3)),x=(v.WRONG_DOCUMENT_ERR=(y[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(y[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(y[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(y[7]="No modification allowed",7),v.NOT_FOUND_ERR=(y[8]="Not found",8)),b=(v.NOT_SUPPORTED_ERR=(y[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(y[10]="Attribute in use",10));v.INVALID_STATE_ERR=(y[11]="Invalid state",11),v.SYNTAX_ERR=(y[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(y[13]="Invalid modification",13),v.NAMESPACE_ERR=(y[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(y[15]="Invalid access",15);function w(t,e){if(e instanceof Error)var n=e;else n=this,Error.call(this,y[t]),this.message=y[t],Error.captureStackTrace&&Error.captureStackTrace(this,w);return n.code=t,e&&(this.message=this.message+": "+e),n}function S(){}function E(t,e){this._node=t,this._refresh=e,k(this)}function k(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var r=t._refresh(t._node);rt(t,"length",r.length),n(r,t),t._inc=e}}function C(){}function I(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function T(t,e,n,r){if(r?e[I(e,r)]=n:e[e.length++]=n,t){n.ownerElement=t;var i=t.ownerDocument;i&&(r&&N(i,t,r),function(t,e,n){t&&t._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(e._nsMap[n.prefix?n.localName:""]=n.value)}(i,t,n))}}function P(t,e,n){var r=I(e,n);if(!(r>=0))throw w(x,new Error(t.tagName+"@"+n));for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,t){var o=t.ownerDocument;o&&(N(o,t,n),n.ownerElement=null)}}function A(t){if(this._features={},t)for(var e in t)this._features=t[e]}function M(){}function L(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function R(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(R(t,e))return!0}while(t=t.nextSibling)}function D(){}function N(t,e,n,r){t&&t._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete e._nsMap[n.prefix?n.localName:""]}function z(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n)r[r.length++]=n;else{for(var i=e.firstChild,o=0;i;)r[o++]=i,i=i.nextSibling;r.length=o}}}function O(t,e){var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,z(t.ownerDocument,t),e}function F(t,e,n){var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===m){var i=e.firstChild;if(null==i)return e;var o=e.lastChild}else i=o=e;var a=n?n.previousSibling:t.lastChild;i.previousSibling=a,o.nextSibling=n,a?a.nextSibling=i:t.firstChild=i,null==n?t.lastChild=o:n.previousSibling=o;do{i.parentNode=t}while(i!==o&&(i=i.nextSibling));return z(t.ownerDocument||t,t),e.nodeType==m&&(e.firstChild=e.lastChild=null),e}function B(){this._nsMap={}}function j(){}function U(){}function V(){}function Z(){}function q(){}function G(){}function W(){}function X(){}function H(){}function Y(){}function $(){}function K(){}function J(t,e){var n=[],r=9==this.nodeType&&this.documentElement||this,i=r.prefix,o=r.namespaceURI;if(o&&null==i&&null==(i=r.lookupPrefix(o)))var a=[{namespace:o,prefix:null}];return tt(this,n,t,e,a),n.join("")}function Q(t,e,n){var r=t.prefix||"",i=t.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var o=n.length;o--;){var a=n[o];if(a.prefix==r)return a.namespace!=i}return!0}function tt(t,e,n,r,i){if(r){if(!(t=r(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case o:i||(i=[]);i.length;var c=t.attributes,g=c.length,v=t.firstChild,y=t.tagName;n="http://www.w3.org/1999/xhtml"===t.namespaceURI||n,e.push("<",y);for(var _=0;_<g;_++){"xmlns"==(x=c.item(_)).prefix?i.push({prefix:x.localName,namespace:x.value}):"xmlns"==x.nodeName&&i.push({prefix:"",namespace:x.value})}for(_=0;_<g;_++){var x;if(Q(x=c.item(_),0,i)){var b=x.prefix||"",w=x.namespaceURI,S=b?" xmlns:"+b:" xmlns";e.push(S,'="',w,'"'),i.push({prefix:b,namespace:w})}tt(x,e,n,r,i)}if(Q(t,0,i)){b=t.prefix||"";if(w=t.namespaceURI){S=b?" xmlns:"+b:" xmlns";e.push(S,'="',w,'"'),i.push({prefix:b,namespace:w})}}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(y)){if(e.push(">"),n&&/^script$/i.test(y))for(;v;)v.data?e.push(v.data):tt(v,e,n,r,i),v=v.nextSibling;else for(;v;)tt(v,e,n,r,i),v=v.nextSibling;e.push("</",y,">")}else e.push("/>");return;case p:case m:for(v=t.firstChild;v;)tt(v,e,n,r,i),v=v.nextSibling;return;case a:return e.push(" ",t.name,'="',t.value.replace(/[<&"]/g,L),'"');case s:return e.push(t.data.replace(/[<&]/g,L).replace(/]]>/g,"]]&gt;"));case l:return e.push("<![CDATA[",t.data,"]]>");case f:return e.push("\x3c!--",t.data,"--\x3e");case d:var E=t.publicId,k=t.systemId;if(e.push("<!DOCTYPE ",t.name),E)e.push(" PUBLIC ",E),k&&"."!=k&&e.push(" ",k),e.push(">");else if(k&&"."!=k)e.push(" SYSTEM ",k,">");else{var C=t.internalSubset;C&&e.push(" [",C,"]"),e.push(">")}return;case h:return e.push("<?",t.target," ",t.data,"?>");case u:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function et(t,e,n){var r;switch(e.nodeType){case o:(r=e.cloneNode(!1)).ownerDocument=t;case m:break;case a:n=!0}if(r||(r=e.cloneNode(!1)),r.ownerDocument=t,r.parentNode=null,n)for(var i=e.firstChild;i;)r.appendChild(et(t,i,n)),i=i.nextSibling;return r}function nt(t,e,n){var r=new e.constructor;for(var i in e){var s=e[i];"object"!=typeof s&&s!=r[i]&&(r[i]=s)}switch(e.childNodes&&(r.childNodes=new S),r.ownerDocument=t,r.nodeType){case o:var l=e.attributes,u=r.attributes=new C,c=l.length;u._ownerElement=r;for(var h=0;h<c;h++)r.setAttributeNode(nt(t,l.item(h),!0));break;case a:n=!0}if(n)for(var f=e.firstChild;f;)r.appendChild(nt(t,f,n)),f=f.nextSibling;return r}function rt(t,e,n){t[e]=n}w.prototype=Error.prototype,n(v,w),S.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var n=[],r=0;r<this.length;r++)tt(this[r],n,t,e);return n.join("")}},E.prototype.item=function(t){return k(this),this[t]},r(E,S),C.prototype={length:0,item:S.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new w(b);var n=this.getNamedItem(t.nodeName);return T(this._ownerElement,this,t,n),n},setNamedItemNS:function(t){var e,n=t.ownerElement;if(n&&n!=this._ownerElement)throw new w(b);return e=this.getNamedItemNS(t.namespaceURI,t.localName),T(this._ownerElement,this,t,e),e},removeNamedItem:function(t){var e=this.getNamedItem(t);return P(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);return P(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var r=this[n];if(r.localName==e&&r.namespaceURI==t)return r}return null}},A.prototype={hasFeature:function(t,e){var n=this._features[t.toLowerCase()];return!(!n||e&&!(e in n))},createDocument:function(t,e,n){var r=new D;if(r.implementation=this,r.childNodes=new S,r.doctype=n,n&&r.appendChild(n),e){var i=r.createElementNS(t,e);r.appendChild(i)}return r},createDocumentType:function(t,e,n){var r=new G;return r.name=t,r.nodeName=t,r.publicId=e,r.systemId=n,r}},M.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return F(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return O(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return nt(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==s&&t.nodeType==s?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n)for(var r in n)if(n[r]==t)return r;e=e.nodeType==a?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&t in n)return n[t];e=e.nodeType==a?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)}},n(i,M),n(i,M.prototype),D.prototype={nodeName:"#document",nodeType:p,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==m){for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}return t}return null==this.documentElement&&t.nodeType==o&&(this.documentElement=t),F(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),O(this,t)},importNode:function(t,e){return et(this,t,e)},getElementById:function(t){var e=null;return R(this.documentElement,(function(n){if(n.nodeType==o&&n.getAttribute("id")==t)return e=n,!0})),e},getElementsByClassName:function(t){var e=new RegExp("(^|\\s)"+t+"(\\s|$)");return new E(this,(function(t){var n=[];return R(t.documentElement,(function(r){r!==t&&r.nodeType==o&&e.test(r.getAttribute("class"))&&n.push(r)})),n}))},createElement:function(t){var e=new B;return e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.childNodes=new S,(e.attributes=new C)._ownerElement=e,e},createDocumentFragment:function(){var t=new Y;return t.ownerDocument=this,t.childNodes=new S,t},createTextNode:function(t){var e=new V;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new Z;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new q;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new $;return n.ownerDocument=this,n.tagName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new j;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new H;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new B,r=e.split(":"),i=n.attributes=new C;return n.childNodes=new S,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,i._ownerElement=n,n},createAttributeNS:function(t,e){var n=new j,r=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,n}},r(D,M),B.prototype={nodeType:o,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var n=this.ownerDocument.createAttribute(t);n.value=n.nodeValue=""+e,this.setAttributeNode(n)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===m?this.insertBefore(t,null):function(t,e){var n=e.parentNode;if(n){var r=t.lastChild;n.removeChild(e),r=t.lastChild}return r=t.lastChild,e.parentNode=t,e.previousSibling=r,e.nextSibling=null,r?r.nextSibling=e:t.firstChild=e,t.lastChild=e,z(t.ownerDocument,t,e),e}(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n&&n.value||""},setAttributeNS:function(t,e,n){var r=this.ownerDocument.createAttributeNS(t,e);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new E(this,(function(e){var n=[];return R(e,(function(r){r===e||r.nodeType!=o||"*"!==t&&r.tagName!=t||n.push(r)})),n}))},getElementsByTagNameNS:function(t,e){return new E(this,(function(n){var r=[];return R(n,(function(i){i===n||i.nodeType!==o||"*"!==t&&i.namespaceURI!==t||"*"!==e&&i.localName!=e||r.push(i)})),r}))}},D.prototype.getElementsByTagName=B.prototype.getElementsByTagName,D.prototype.getElementsByTagNameNS=B.prototype.getElementsByTagNameNS,r(B,M),j.prototype.nodeType=a,r(j,M),U.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(y[_])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){n=this.data.substring(0,t)+n+this.data.substring(t+e),this.nodeValue=this.data=n,this.length=n.length}},r(U,M),V.prototype={nodeName:"#text",nodeType:s,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(V,U),Z.prototype={nodeName:"#comment",nodeType:f},r(Z,U),q.prototype={nodeName:"#cdata-section",nodeType:l},r(q,U),G.prototype.nodeType=d,r(G,M),W.prototype.nodeType=g,r(W,M),X.prototype.nodeType=c,r(X,M),H.prototype.nodeType=u,r(H,M),Y.prototype.nodeName="#document-fragment",Y.prototype.nodeType=m,r(Y,M),$.prototype.nodeType=h,r($,M),K.prototype.serializeToString=function(t,e,n){return J.call(t,e,n)},M.prototype.toString=J;try{if(Object.defineProperty){var it=function t(e){switch(e.nodeType){case o:case m:var n=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&n.push(t(e)),e=e.nextSibling;return n.join("");default:return e.nodeValue}};Object.defineProperty(E.prototype,"length",{get:function(){return k(this),this.$$length}}),Object.defineProperty(M.prototype,"textContent",{get:function(){return it(this)},set:function(t){switch(this.nodeType){case o:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),rt=function(t,e,n){t["$$"+e]=n}}}catch(ot){}e.DOMImplementation=A,e.XMLSerializer=K},5456:function(t,e){e.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xc0",Aacute:"\xc1",Acirc:"\xc2",Atilde:"\xc3",Auml:"\xc4",Aring:"\xc5",AElig:"\xc6",Ccedil:"\xc7",Egrave:"\xc8",Eacute:"\xc9",Ecirc:"\xca",Euml:"\xcb",Igrave:"\xcc",Iacute:"\xcd",Icirc:"\xce",Iuml:"\xcf",ETH:"\xd0",Ntilde:"\xd1",Ograve:"\xd2",Oacute:"\xd3",Ocirc:"\xd4",Otilde:"\xd5",Ouml:"\xd6",Oslash:"\xd8",Ugrave:"\xd9",Uacute:"\xda",Ucirc:"\xdb",Uuml:"\xdc",Yacute:"\xdd",THORN:"\xde",szlig:"\xdf",agrave:"\xe0",aacute:"\xe1",acirc:"\xe2",atilde:"\xe3",auml:"\xe4",aring:"\xe5",aelig:"\xe6",ccedil:"\xe7",egrave:"\xe8",eacute:"\xe9",ecirc:"\xea",euml:"\xeb",igrave:"\xec",iacute:"\xed",icirc:"\xee",iuml:"\xef",eth:"\xf0",ntilde:"\xf1",ograve:"\xf2",oacute:"\xf3",ocirc:"\xf4",otilde:"\xf5",ouml:"\xf6",oslash:"\xf8",ugrave:"\xf9",uacute:"\xfa",ucirc:"\xfb",uuml:"\xfc",yacute:"\xfd",thorn:"\xfe",yuml:"\xff",nbsp:"\xa0",iexcl:"\xa1",cent:"\xa2",pound:"\xa3",curren:"\xa4",yen:"\xa5",brvbar:"\xa6",sect:"\xa7",uml:"\xa8",copy:"\xa9",ordf:"\xaa",laquo:"\xab",not:"\xac",shy:"\xad\xad",reg:"\xae",macr:"\xaf",deg:"\xb0",plusmn:"\xb1",sup2:"\xb2",sup3:"\xb3",acute:"\xb4",micro:"\xb5",para:"\xb6",middot:"\xb7",cedil:"\xb8",sup1:"\xb9",ordm:"\xba",raquo:"\xbb",frac14:"\xbc",frac12:"\xbd",frac34:"\xbe",iquest:"\xbf",times:"\xd7",divide:"\xf7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220b",prod:"\u220f",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221a",prop:"\u221d",infin:"\u221e",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222a",int:"\u222b",there4:"\u2234",sim:"\u223c",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22a5",sdot:"\u22c5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039a",Lambda:"\u039b",Mu:"\u039c",Nu:"\u039d",Xi:"\u039e",Omicron:"\u039f",Pi:"\u03a0",Rho:"\u03a1",Sigma:"\u03a3",Tau:"\u03a4",Upsilon:"\u03a5",Phi:"\u03a6",Chi:"\u03a7",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u03b5",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",omicron:"\u03bf",pi:"\u03c0",rho:"\u03c1",sigmaf:"\u03c2",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",thetasym:"\u03d1",upsih:"\u03d2",piv:"\u03d6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02c6",tilde:"\u02dc",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200c",zwj:"\u200d",lrm:"\u200e",rlm:"\u200f",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203a",oline:"\u203e",euro:"\u20ac",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21b5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230a",rfloor:"\u230b",loz:"\u25ca",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}},1265:function(t,e){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$");function o(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,o)}function a(){}function s(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function l(t,e,n,r,i,o){function a(t,e,r){t in n.attributeNames&&o.fatalError("Attribute "+t+" redefined"),n.addValue(t,e,r)}for(var s,l=++e,u=0;;){var c=t.charAt(l);switch(c){case"=":if(1===u)s=t.slice(e,l),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(o.warning('attribute value must after "="'),s=t.slice(e,l)),e=l+1,!((l=t.indexOf(c,e))>0))throw new Error("attribute value no end '"+c+"' match");a(s,h=t.slice(e,l).replace(/&#?\w+;/g,i),e-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');a(s,h=t.slice(e,l).replace(/&#?\w+;/g,i),e),o.warning('attribute "'+s+'" missed start quot('+c+")!!"),e=l+1,u=5}break;case"/":switch(u){case 0:n.setTagName(t.slice(e,l));case 5:case 6:case 7:u=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==u&&n.setTagName(t.slice(e,l)),l;case">":switch(u){case 0:n.setTagName(t.slice(e,l));case 5:case 6:case 7:break;case 4:case 1:"/"===(h=t.slice(e,l)).slice(-1)&&(n.closed=!0,h=h.slice(0,-1));case 2:2===u&&(h=s),4==u?(o.warning('attribute "'+h+'" missed quot(")!'),a(s,h.replace(/&#?\w+;/g,i),e)):("http://www.w3.org/1999/xhtml"===r[""]&&h.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+h+'" missed value!! "'+h+'" instead!!'),a(h,h,e));break;case 3:throw new Error("attribute value missed!!")}return l;case"\x80":c=" ";default:if(c<=" ")switch(u){case 0:n.setTagName(t.slice(e,l)),u=6;break;case 1:s=t.slice(e,l),u=2;break;case 4:var h=t.slice(e,l).replace(/&#?\w+;/g,i);o.warning('attribute "'+h+'" missed quot(")!!'),a(s,h,e);case 5:u=6}else switch(u){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&s.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),a(s,s,e),e=l,u=1;break;case 5:o.warning('attribute space is required"'+s+'"!!');case 6:u=1,e=l;break;case 3:u=4,e=l;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function u(t,e,n){for(var r=t.tagName,i=null,o=t.length;o--;){var a=t[o],s=a.qName,l=a.value;if((p=s.indexOf(":"))>0)var u=a.prefix=s.slice(0,p),c=s.slice(p+1),h="xmlns"===u&&c;else c=s,u=null,h="xmlns"===s&&"";a.localName=c,!1!==h&&(null==i&&(i={},f(n,n={})),n[h]=i[h]=l,a.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(h,l))}for(o=t.length;o--;){(u=(a=t[o]).prefix)&&("xml"===u&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(a.uri=n[u||""]))}var p;(p=r.indexOf(":"))>0?(u=t.prefix=r.slice(0,p),c=t.localName=r.slice(p+1)):(u=null,c=t.localName=r);var d=t.uri=n[u||""];if(e.startElement(d,c,r,t),!t.closed)return t.currentNSMap=n,t.localNSMap=i,!0;if(e.endElement(d,c,r),i)for(u in i)e.endPrefixMapping(u)}function c(t,e,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var o=t.indexOf("</"+n+">",e),a=t.substring(e+1,o);if(/[&<]/.test(a))return/^script$/i.test(n)?(i.characters(a,0,a.length),o):(a=a.replace(/&#?\w+;/g,r),i.characters(a,0,a.length),o)}return e+1}function h(t,e,n,r){var i=r[n];return null==i&&((i=t.lastIndexOf("</"+n+">"))<e&&(i=t.lastIndexOf("</"+n)),r[n]=i),i<e}function f(t,e){for(var n in t)e[n]=t[n]}function p(t,e,n,r){if("-"===t.charAt(e+2))return"-"===t.charAt(e+3)?(i=t.indexOf("--\x3e",e+4))>e?(n.comment(t,e+4,i-e-4),i+3):(r.error("Unclosed comment"),-1):-1;if("CDATA["==t.substr(e+3,6)){var i=t.indexOf("]]>",e+9);return n.startCDATA(),n.characters(t,e+9,i-e-9),n.endCDATA(),i+3}var o=function(t,e){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=e,i.exec(t);for(;n=i.exec(t);)if(r.push(n),n[1])return r}(t,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var s=o[1][0],l=!1,u=!1;a>3&&(/^public$/i.test(o[2][0])?(l=o[3][0],u=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(u=o[3][0]));var c=o[a-1];return n.startDTD(s,l,u),n.endDTD(),c.index+c[0].length}return-1}function d(t,e,n){var r=t.indexOf("?>",e);if(r){var i=t.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function m(){this.attributeNames={}}o.prototype=new Error,o.prototype.name=o.name,a.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),f(e,e={}),function(t,e,n,r,i){function a(t){if(t>65535){var e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}function f(t){var e=t.slice(1,-1);return e in n?n[e]:"#"===e.charAt(0)?a(parseInt(e.substr(1).replace("x","0x"))):(i.error("entity not found:"+t),t)}function g(e){if(e>E){var n=t.substring(E,e).replace(/&#?\w+;/g,f);b&&v(E),r.characters(n,0,e-E),E=e}}function v(e,n){for(;e>=_&&(n=x.exec(t));)y=n.index,_=y+n[0].length,b.lineNumber++;b.columnNumber=e-y+1}var y=0,_=0,x=/.*(?:\r\n?|\n)|.*$/g,b=r.locator,w=[{currentNSMap:e}],S={},E=0;for(;;){try{var k=t.indexOf("<",E);if(k<0){if(!t.substr(E).match(/^\s*$/)){var C=r.doc,I=C.createTextNode(t.substr(E));C.appendChild(I),r.currentElement=I}return}switch(k>E&&g(k),t.charAt(k+1)){case"/":var T=t.indexOf(">",k+3),P=t.substring(k+2,T),A=w.pop();T<0?(P=t.substring(k+2).replace(/[\s<].*/,""),i.error("end tag name: "+P+" is not complete:"+A.tagName),T=k+1+P.length):P.match(/\s</)&&(P=P.replace(/[\s<].*/,""),i.error("end tag name: "+P+" maybe not complete"),T=k+1+P.length);var M=A.localNSMap,L=A.tagName==P;if(L||A.tagName&&A.tagName.toLowerCase()==P.toLowerCase()){if(r.endElement(A.uri,A.localName,P),M)for(var R in M)r.endPrefixMapping(R);L||i.fatalError("end tag name: "+P+" is not match the current start tagName:"+A.tagName)}else w.push(A);T++;break;case"?":b&&v(k),T=d(t,k,r);break;case"!":b&&v(k),T=p(t,k,r,i);break;default:b&&v(k);var D=new m,N=w[w.length-1].currentNSMap,z=(T=l(t,k,D,N,f,i),D.length);if(!D.closed&&h(t,T,D.tagName,S)&&(D.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),b&&z){for(var O=s(b,{}),F=0;F<z;F++){var B=D[F];v(B.offset),B.locator=s(b,{})}r.locator=O,u(D,r,N)&&w.push(D),r.locator=b}else u(D,r,N)&&w.push(D);"http://www.w3.org/1999/xhtml"!==D.uri||D.closed?T++:T=c(t,T,D.tagName,f,r)}}catch(j){if(j instanceof o)throw j;i.error("element parse error: "+j),T=-1}T>E?E=T:g(Math.max(k,E)+1)}}(t,e,n,r,this.errorHandler),r.endDocument()}},m.prototype={setTagName:function(t){if(!i.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!i.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},e.XMLReader=a,e.ParseError=o},3897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},5372:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3405:function(t,e,n){var r=n(3897);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6115:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},3515:function(t,e,n){var r=n(6015),i=n(9617);function o(e,n,a){return i()?(t.exports=o=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},t.exports.__esModule=!0,t.exports.default=t.exports),o.apply(null,arguments)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},9728:function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,n){var r=n(6116);t.exports=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6389:function(t,e,n){var r=n(3808),i=n(9617),o=n(4993);t.exports=function(t){var e=i();return function(){var n,i=r(t);if(e){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}},t.exports.__esModule=!0,t.exports.default=t.exports},8416:function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},1588:function(t,e,n){var r=n(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},3808:function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1655:function(t,e,n){var r=n(6015);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},6035:function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.__esModule=!0,t.exports.default=t.exports},9617:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},9498:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},8872:function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},2281:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},4993:function(t,e,n){var r=n(8698).default,i=n(6115);t.exports=function(t,e){if(e&&("object"===r(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6015:function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7424:function(t,e,n){var r=n(5372),i=n(8872),o=n(6116),a=n(2218);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},1753:function(t,e,n){var r=n(3808);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},1589:function(t,e,n){var r=n(5372),i=n(9498),o=n(6116),a=n(2218);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},861:function(t,e,n){var r=n(3405),i=n(9498),o=n(6116),a=n(2281);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:function(t,e,n){var r=n(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},3496:function(t,e,n){var r=n(3808),i=n(6015),o=n(6035),a=n(3515);function s(e){var n="function"===typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!o(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return a(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports,s(e)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},1941:function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports},596:function(t,e,n){var r=n(8416).default,i=n(6115).default,o=n(3515).default,a=n(1588).default,s=n(3808).default,l=n(4993).default,u=n(1589).default,c=n(861).default,h=n(7424).default,f=n(4704).default,p=n(9728).default,d=n(6690).default,m=n(1655).default,g=n(6389).default,v=n(3496).default;t.exports=function(){"use strict";var t,e,n;function y(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),n=i(a),"undefined"!==typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=i;else t=i}return y(["exports"],(function(t){var e=n;function n(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=r}function r(t,n,r,i){var o=new e(t,n,r,i);return function(t){return o.solve(t)}}n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,r=0;r<8;r++){var i=this.sampleCurveX(n)-t;if(Math.abs(i)<e)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n-=i/o}var a=0,s=1;for(n=t,r=0;r<20&&(i=this.sampleCurveX(n),!(Math.abs(i-t)<e));r++)t>i?a=n:s=n,n=.5*(s-a)+a;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var i=r(.25,.1,.25,1);function y(t,e,n){return Math.min(n,Math.max(e,t))}function _(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function x(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)t[s]=a[s]}return t}var b=1;function w(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function S(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function E(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function k(t){return Array.isArray(t)?t.map(k):"object"==typeof t&&t?S(t,k):t}var C={};function I(t){C[t]||("undefined"!=typeof console&&console.warn(t),C[t]=!0)}function T(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function P(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}function A(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function M(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,r,i){var o=r||i;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var L,R,D=null;function N(t){if(null==D){var e=t.navigator?t.navigator.userAgent:null;D=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return D}function z(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}var O={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame:function(t){var e=requestAnimationFrame(t);return{cancel:function(){return cancelAnimationFrame(e)}}},getImageData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=window.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return L||(L=document.createElement("a")),L.href=t,L.href},hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==R&&(R=matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}},F=B;function B(t,e){this.x=t,this.y=e}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(t){return t instanceof B?t:Array.isArray(t)?new B(t[0],t[1]):t};var j,U,V={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Z="mapbox-tiles",q=500,G=50;function W(){"undefined"==typeof caches||j||(j=caches.open(Z))}var X,H,Y=1/0,$={supported:!1,testSupport:function(t){!K&&H&&(J?Q(t):X=t)}},K=!1,J=!1;function Q(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,H),t.isContextLost())return;$.supported=!0}catch(t){}t.deleteTexture(e),K=!0}"undefined"!=typeof document&&((H=document.createElement("img")).onload=function(){X&&Q(X),X=null,J=!0},H.onerror=function(){K=!0,X=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var tt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(tt);var et=function(t){m(n,t);var e=g(n);function n(t,r,i,o){var a;return d(this,n),(a=e.call(this,"AJAXError: ".concat(r," (").concat(t,"): ").concat(i))).status=t,a.statusText=r,a.url=i,a.body=o,a}return p(n)}(v(Error)),nt=A()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===window.location.protocol?window.parent:window).location.href};function rt(t,e){var n=new AbortController,r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:nt(),signal:n.signal}),i=!1,o=!1;return"json"===t.type&&r.headers.set("Accept","application/json"),function(n,a,s){if(!o){var l=Date.now();fetch(r).then((function(n){return n.ok?function(n,a,s){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){o||(a&&s&&function(t,e,n){if(W(),j){var r={status:e.status,statusText:e.statusText,headers:new Headers};e.headers.forEach((function(t,e){return r.headers.set(e,t)}));var i=M(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===U)try{new Response(new ReadableStream),U=!0}catch(t){U=!1}U?e(t.body):t.blob().then(e)}(e,(function(e){var n=new Response(e,r);W(),j&&j.then((function(e){return e.put(function(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}(t.url),n)})).catch((function(t){return I(t.message)}))})))}}(r,a,s),i=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){o||e(new Error(t.message))}))}(n,null,l):n.blob().then((function(r){return e(new et(n.status,n.statusText,t.url,r))}))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}}(),{cancel:function(){o=!0,i||n.abort()}}}var it=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(A()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!A()){var n=t.url.substring(0,t.url.indexOf("://"));return(V.REGISTERED_PROTOCOLS[n]||rt)(t,e)}}if(!(/^file:/.test(r=t.url)||/^file:/.test(nt())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return rt(t,e);if(A()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(t,e){var n=new XMLHttpRequest;for(var r in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else{var i=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});e(new et(n.status,n.statusText,t.url,i))}},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},ot=function(t,e){return it(x(t,{type:"arrayBuffer"}),e)};function at(t){var e=window.document.createElement("a");return e.href=t,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}var st,lt,ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";st=[],lt=0;var ct=function t(e,n){if($.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),lt>=V.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return st.push(r),r}lt++;var i=!1,o=function(){if(!i)for(i=!0,lt--;st.length&&lt<V.MAX_PARALLEL_IMAGE_REQUESTS;){var e=st.shift(),n=e.requestParameters,r=e.callback;e.cancelled||(e.cancel=t(n,r).cancel)}},a=ot(e,(function(t,e,r,i){o(),t?n(t):e&&function(t,e){"function"==typeof createImageBitmap?function(t,e){var n=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(t,e):function(t,e){var n=new Image;n.onload=function(){e(null,n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((function(){n.src=ut}))},n.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var r=new Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?URL.createObjectURL(r):ut}(t,e)}(e,(function(t,e){null!=t?n(t):null!=e&&n(null,e,{cacheControl:r,expires:i})}))}));return{cancel:function(){a.cancel(),o()}}};function ht(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function ft(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}var pt=p((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,t),x(this,n),this.type=e})),dt=function(t){m(n,t);var e=g(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,n),e.call(this,"error",x({error:t},r))}return p(n)}(pt),mt=function(){function t(){d(this,t)}return p(t,[{key:"on",value:function(t,e){return this._listeners=this._listeners||{},ht(t,e,this._listeners),this}},{key:"off",value:function(t,e){return ft(t,e,this._listeners),ft(t,e,this._oneTimeListeners),this}},{key:"once",value:function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},ht(t,e,this._oneTimeListeners),this}},{key:"fire",value:function(t,e){"string"==typeof t&&(t=new pt(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;var r,i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[],o=f(i);try{for(o.s();!(r=o.n()).done;)r.value.call(this,t)}catch(h){o.e(h)}finally{o.f()}var a,s=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[],l=f(s);try{for(l.s();!(a=l.n()).done;){var u=a.value;ft(n,u,this._oneTimeListeners),u.call(this,t)}}catch(h){l.e(h)}finally{l.f()}var c=this._eventedParent;c&&(x(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),c.fire(t))}else t instanceof dt&&console.error(t.error);return this}},{key:"listens",value:function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}},{key:"setEventedParent",value:function(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}]),t}(),gt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},vt=p((function t(e,n,r,i){d(this,t),this.message=(e?"".concat(e,": "):"")+r,i&&(this.identifier=i),null!=n&&n.__line__&&(this.line=n.__line__)}));function yt(t){var e=t.value;return e?[new vt(t.key,e,"constants have been deprecated as of v8")]:[]}function _t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)t[s]=a[s]}return t}function xt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function bt(t){if(Array.isArray(t))return t.map(bt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=bt(t[n]);return e}return xt(t)}var wt=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,r)).message=r,i.key=t,i}return p(n)}(v(Error)),St=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];d(this,t),this.parent=e,this.bindings={};var r,i=f(n);try{for(i.s();!(r=i.n()).done;){var o=h(r.value,2),a=o[0],s=o[1];this.bindings[a]=s}}catch(l){i.e(l)}finally{i.f()}}return p(t,[{key:"concat",value:function(e){return new t(this,e)}},{key:"get",value:function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error("".concat(t," not found in scope."))}},{key:"has",value:function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}]),t}(),Et={kind:"null"},kt={kind:"number"},Ct={kind:"string"},It={kind:"boolean"},Tt={kind:"color"},Pt={kind:"object"},At={kind:"value"},Mt={kind:"collator"},Lt={kind:"formatted"},Rt={kind:"padding"},Dt={kind:"resolvedImage"};function Nt(t,e){return{kind:"array",itemType:t,N:e}}function zt(t){if("array"===t.kind){var e=zt(t.itemType);return"number"==typeof t.N?"array<".concat(e,", ").concat(t.N,">"):"value"===t.itemType.kind?"array":"array<".concat(e,">")}return t.kind}var Ot=[Et,kt,Ct,It,Tt,Lt,Pt,Nt(At),Rt,Dt];function Ft(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Ft(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind){var n,r=f(Ot);try{for(r.s();!(n=r.n()).done;)if(!Ft(n.value,e))return null}catch(i){r.e(i)}finally{r.f()}}}return"Expected ".concat(zt(t)," but found ").concat(zt(e)," instead.")}function Bt(t,e){return e.some((function(e){return e.kind===t.kind}))}function jt(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var Ut,Vt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Zt(t){return(t=Math.round(t))<0?0:t>255?255:t}function qt(t){return Zt("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Gt(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Wt(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Ut={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Vt)return Vt[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var r=n.indexOf("("),i=n.indexOf(")");if(-1!==r&&i+1===n.length){var o=n.substr(0,r),a=n.substr(r+1,i-(r+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=Gt(a.pop());case"rgb":return 3!==a.length?null:[qt(a[0]),qt(a[1]),qt(a[2]),s];case"hsla":if(4!==a.length)return null;s=Gt(a.pop());case"hsl":if(3!==a.length)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=Gt(a[1]),c=Gt(a[2]),h=c<=.5?c*(u+1):c+u-c*u,f=2*c-h;return[Zt(255*Wt(f,h,l+1/3)),Zt(255*Wt(f,h,l)),Zt(255*Wt(f,h,l-1/3)),s];default:return null}}return null}}catch(t){}var Xt=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;d(this,t),this.r=e,this.g=n,this.b=r,this.a=i}return p(t,[{key:"toString",value:function(){var t=this.toArray(),e=h(t,4),n=e[0],r=e[1],i=e[2],o=e[3];return"rgba(".concat(Math.round(n),",").concat(Math.round(r),",").concat(Math.round(i),",").concat(o,")")}},{key:"toArray",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]}}],[{key:"parse",value:function(e){if(e){if(e instanceof t)return e;if("string"==typeof e){var n=Ut(e);return n?new t(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}}}}]),t}();Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);var Ht=function(){function t(e,n,r){d(this,t),this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}return p(t,[{key:"compare",value:function(t,e){return this.collator.compare(t,e)}},{key:"resolvedLocale",value:function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}]),t}(),Yt=p((function t(e,n,r,i,o){d(this,t),this.text=e,this.image=n,this.scale=r,this.fontStack=i,this.textColor=o})),$t=function(){function t(e){d(this,t),this.sections=e}return p(t,[{key:"isEmpty",value:function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))}},{key:"toString",value:function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")}}],[{key:"fromString",value:function(e){return new t([new Yt(e,null,null,null,null)])}},{key:"factory",value:function(e){return e instanceof t?e:t.fromString(e)}}]),t}(),Kt=function(){function t(e){d(this,t),this.values=e.slice()}return p(t,[{key:"toString",value:function(){return JSON.stringify(this.values)}}],[{key:"parse",value:function(e){if(e instanceof t)return e;if("number"==typeof e)return new t([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){var n,r=f(e);try{for(r.s();!(n=r.n()).done;)if("number"!=typeof n.value)return}catch(i){r.e(i)}finally{r.f()}switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new t(e)}}}]),t}(),Jt=function(){function t(e){d(this,t),this.name=e.name,this.available=e.available}return p(t,[{key:"toString",value:function(){return this.name}}],[{key:"fromString",value:function(e){return e?new t({name:e,available:!1}):null}}]),t}();function Qt(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value [".concat([t,e,n,r].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function te(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Xt)return!0;if(t instanceof Ht)return!0;if(t instanceof $t)return!0;if(t instanceof Kt)return!0;if(t instanceof Jt)return!0;if(Array.isArray(t)){var e,n=f(t);try{for(n.s();!(e=n.n()).done;)if(!te(e.value))return!1}catch(i){n.e(i)}finally{n.f()}return!0}if("object"==typeof t){for(var r in t)if(!te(t[r]))return!1;return!0}return!1}function ee(t){if(null===t)return Et;if("string"==typeof t)return Ct;if("boolean"==typeof t)return It;if("number"==typeof t)return kt;if(t instanceof Xt)return Tt;if(t instanceof Ht)return Mt;if(t instanceof $t)return Lt;if(t instanceof Kt)return Rt;if(t instanceof Jt)return Dt;if(Array.isArray(t)){var e,n,r=t.length,i=f(t);try{for(i.s();!(n=i.n()).done;){var o=ee(n.value);if(e){if(e===o)continue;e=At;break}e=o}}catch(a){i.e(a)}finally{i.f()}return Nt(e||At,r)}return Pt}function ne(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Xt||t instanceof $t||t instanceof Kt||t instanceof Jt?t.toString():JSON.stringify(t)}var re=function(){function t(e,n){d(this,t),this.type=e,this.value=n}return p(t,[{key:"evaluate",value:function(){return this.value}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}}],[{key:"parse",value:function(e,n){if(2!==e.length)return n.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!te(e[1]))return n.error("invalid value");var r=e[1],i=ee(r),o=n.expectedType;return"array"!==i.kind||0!==i.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(i=o),new t(i,r)}}]),t}(),ie=function(){function t(e){d(this,t),this.name="ExpressionEvaluationError",this.message=e}return p(t,[{key:"toJSON",value:function(){return this.message}}]),t}(),oe={string:Ct,number:kt,boolean:It,object:Pt},ae=function(){function t(e,n){d(this,t),this.type=e,this.args=n}return p(t,[{key:"evaluate",value:function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Ft(this.type,ee(n)))return n;if(e===this.args.length-1)throw new ie("Expected value to be of type ".concat(zt(this.type),", but found ").concat(zt(ee(n))," instead."))}throw new Error}},{key:"eachChild",value:function(t){this.args.forEach(t)}},{key:"outputDefined",value:function(){return this.args.every((function(t){return t.outputDefined()}))}}],[{key:"parse",value:function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var r,i=1,o=e[0];if("array"===o){var a,s;if(e.length>2){var l=e[1];if("string"!=typeof l||!(l in oe)||"object"===l)return n.error('The item type argument of "array" must be one of string, number, boolean',1);a=oe[l],i++}else a=At;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);s=e[2],i++}r=Nt(a,s)}else{if(!oe[o])throw new Error("Types doesn't contain name = ".concat(o));r=oe[o]}for(var u=[];i<e.length;i++){var c=n.parse(e[i],i,At);if(!c)return null;u.push(c)}return new t(r,u)}}]),t}(),se={"to-boolean":It,"to-color":Tt,"to-number":kt,"to-string":Ct},le=function(){function t(e,n){d(this,t),this.type=e,this.args=n}return p(t,[{key:"evaluate",value:function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){var e,n,r,i=f(this.args);try{for(i.s();!(r=i.n()).done;){if(e=r.value.evaluate(t),n=null,e instanceof Xt)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value ".concat(JSON.stringify(e),": expected an array containing either three or four numeric values."):Qt(e[0],e[1],e[2],e[3])))return new Xt(e[0]/255,e[1]/255,e[2]/255,e[3])}}catch(m){i.e(m)}finally{i.f()}throw new ie(n||"Could not parse color from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}if("padding"===this.type.kind){var a,s,l=f(this.args);try{for(l.s();!(s=l.n()).done;){a=s.value.evaluate(t);var u=Kt.parse(a);if(u)return u}}catch(m){l.e(m)}finally{l.f()}throw new ie("Could not parse padding from value '".concat("string"==typeof a?a:JSON.stringify(a),"'"))}if("number"===this.type.kind){var c,h=null,p=f(this.args);try{for(p.s();!(c=p.n()).done;){if(null===(h=c.value.evaluate(t)))return 0;var d=Number(h);if(!isNaN(d))return d}}catch(m){p.e(m)}finally{p.f()}throw new ie("Could not convert ".concat(JSON.stringify(h)," to number."))}return"formatted"===this.type.kind?$t.fromString(ne(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Jt.fromString(ne(this.args[0].evaluate(t))):ne(this.args[0].evaluate(t))}},{key:"eachChild",value:function(t){this.args.forEach(t)}},{key:"outputDefined",value:function(){return this.args.every((function(t){return t.outputDefined()}))}}],[{key:"parse",value:function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var r=e[0];if(!se[r])throw new Error("Can't parse ".concat(r," as it is not part of the known types"));if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return n.error("Expected one argument.");for(var i=se[r],o=[],a=1;a<e.length;a++){var s=n.parse(e[a],a,At);if(!s)return null;o.push(s)}return new t(i,o)}}]),t}(),ue=["Unknown","Point","LineString","Polygon"],ce=function(){function t(){d(this,t),this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}return p(t,[{key:"id",value:function(){return this.feature&&"id"in this.feature?this.feature.id:null}},{key:"geometryType",value:function(){return this.feature?"number"==typeof this.feature.type?ue[this.feature.type]:this.feature.type:null}},{key:"geometry",value:function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}},{key:"canonicalID",value:function(){return this.canonical}},{key:"properties",value:function(){return this.feature&&this.feature.properties||{}}},{key:"parseColor",value:function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Xt.parse(t)),e}}]),t}(),he=function(){function t(e,n,r,i){d(this,t),this.name=e,this.type=n,this._evaluate=r,this.args=i}return p(t,[{key:"evaluate",value:function(t){return this._evaluate(t,this.args)}},{key:"eachChild",value:function(t){this.args.forEach(t)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){var r,i=e[0],o=t.definitions[i];if(!o)return n.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);var a,s=Array.isArray(o)?o[0]:o.type,l=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,u=l.filter((function(t){var n=h(t,1)[0];return!Array.isArray(n)||n.length===e.length-1})),p=null,d=f(u);try{for(d.s();!(a=d.n()).done;){var m=h(a.value,2),g=m[0],v=m[1];p=new De(n.registry,n.path,null,n.scope);for(var y=[],_=!1,x=1;x<e.length;x++){var b=e[x],w=Array.isArray(g)?g[x-1]:g.type,S=p.parse(b,1+y.length,w);if(!S){_=!0;break}y.push(S)}if(!_)if(Array.isArray(g)&&g.length!==y.length)p.error("Expected ".concat(g.length," arguments, but found ").concat(y.length," instead."));else{for(var E=0;E<y.length;E++){var k=Array.isArray(g)?g[E]:g.type,C=y[E];p.concat(E+1).checkSubtype(k,C.type)}if(0===p.errors.length)return new t(i,s,v,y)}}}catch(M){d.e(M)}finally{d.f()}if(1===u.length)(r=n.errors).push.apply(r,c(p.errors));else{for(var I=(u.length?u:l).map((function(t){var e;return e=h(t,1)[0],Array.isArray(e)?"(".concat(e.map(zt).join(", "),")"):"(".concat(zt(e.type),"...)")})).join(" | "),T=[],P=1;P<e.length;P++){var A=n.parse(e[P],1+T.length);if(!A)return null;T.push(zt(A.type))}n.error("Expected arguments of type ".concat(I,", but found (").concat(T.join(", "),") instead."))}return null}},{key:"register",value:function(e,n){for(var r in t.definitions=n,n)e[r]=t}}]),t}(),fe=function(){function t(e,n,r){d(this,t),this.type=Mt,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=n}return p(t,[{key:"evaluate",value:function(t){return new Ht(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}},{key:"eachChild",value:function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(2!==e.length)return n.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return n.error("Collator options argument must be an object.");var i=n.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,It);if(!i)return null;var o=n.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,It);if(!o)return null;var a=null;return r.locale&&!(a=n.parse(r.locale,1,Ct))?null:new t(i,o,a)}}]),t}(),pe=8192;function de(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function me(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function ge(t,e){var n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(n*i*pe),Math.round(r*i*pe)]}function ve(t,e,n){var r=t[0]-e[0],i=t[1]-e[1],o=t[0]-n[0],a=t[1]-n[1];return r*a-o*i==0&&r*o<=0&&i*a<=0}function ye(t,e){for(var n,r,i,o=!1,a=0,s=e.length;a<s;a++)for(var l=e[a],u=0,c=l.length;u<c-1;u++){if(ve(t,l[u],l[u+1]))return!1;(r=l[u])[1]>(n=t)[1]!=(i=l[u+1])[1]>n[1]&&n[0]<(i[0]-r[0])*(n[1]-r[1])/(i[1]-r[1])+r[0]&&(o=!o)}return o}function _e(t,e){for(var n=0;n<e.length;n++)if(ye(t,e[n]))return!0;return!1}function xe(t,e,n,r){var i=r[0]-n[0],o=r[1]-n[1],a=(t[0]-n[0])*o-i*(t[1]-n[1]),s=(e[0]-n[0])*o-i*(e[1]-n[1]);return a>0&&s<0||a<0&&s>0}function be(t,e,n){var r,i,o,a,s,l,u,c=f(n);try{for(c.s();!(r=c.n()).done;)for(var h=r.value,p=0;p<h.length-1;++p)if(0!=(l=[(s=h[p+1])[0]-(a=h[p])[0],s[1]-a[1]])[0]*(u=[(o=e)[0]-(i=t)[0],o[1]-i[1]])[1]-l[1]*u[0]&&xe(i,o,a,s)&&xe(a,s,i,o))return!0}catch(d){c.e(d)}finally{c.f()}return!1}function we(t,e){for(var n=0;n<t.length;++n)if(!ye(t[n],e))return!1;for(var r=0;r<t.length-1;++r)if(be(t[r],t[r+1],e))return!1;return!0}function Se(t,e){for(var n=0;n<e.length;n++)if(we(t,e[n]))return!0;return!1}function Ee(t,e,n){for(var r=[],i=0;i<t.length;i++){for(var o=[],a=0;a<t[i].length;a++){var s=ge(t[i][a],n);de(e,s),o.push(s)}r.push(o)}return r}function ke(t,e,n){for(var r=[],i=0;i<t.length;i++){var o=Ee(t[i],e,n);r.push(o)}return r}function Ce(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){var i=.5*r,o=t[0]-n[0]>i?-r:n[0]-t[0]>i?r:0;0===o&&(o=t[0]-n[2]>i?-r:n[2]-t[0]>i?r:0),t[0]+=o}de(e,t)}function Ie(t,e,n,r){var i,o=Math.pow(2,r.z)*pe,a=[r.x*pe,r.y*pe],s=[],l=f(t);try{for(l.s();!(i=l.n()).done;){var u,c=i.value,h=f(c);try{for(h.s();!(u=h.n()).done;){var p=u.value,d=[p.x+a[0],p.y+a[1]];Ce(d,e,n,o),s.push(d)}}catch(m){h.e(m)}finally{h.f()}}}catch(m){l.e(m)}finally{l.f()}return s}function Te(t,e,n,r){var i,o,a=Math.pow(2,r.z)*pe,s=[r.x*pe,r.y*pe],l=[],u=f(t);try{for(u.s();!(i=u.n()).done;){var c,h=i.value,p=[],d=f(h);try{for(d.s();!(c=d.n()).done;){var m=c.value,g=[m.x+s[0],m.y+s[1]];de(e,g),p.push(g)}}catch(w){d.e(w)}finally{d.f()}l.push(p)}}catch(w){u.e(w)}finally{u.f()}if(e[2]-e[0]<=a/2){(o=e)[0]=o[1]=1/0,o[2]=o[3]=-1/0;var v,y=f(l);try{for(y.s();!(v=y.n()).done;){var _,x=v.value,b=f(x);try{for(b.s();!(_=b.n()).done;)Ce(_.value,e,n,a)}catch(w){b.e(w)}finally{b.f()}}}catch(w){y.e(w)}finally{y.f()}}return l}var Pe=function(){function t(e,n){d(this,t),this.type=It,this.geojson=e,this.geometries=n}return p(t,[{key:"evaluate",value:function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Ee(e.coordinates,r,i),a=Ie(t.geometry(),n,r,i);if(!me(n,r))return!1;var s,l=f(a);try{for(l.s();!(s=l.n()).done;)if(!ye(s.value,o))return!1}catch(d){l.e(d)}finally{l.f()}}if("MultiPolygon"===e.type){var u=ke(e.coordinates,r,i),c=Ie(t.geometry(),n,r,i);if(!me(n,r))return!1;var h,p=f(c);try{for(p.s();!(h=p.n()).done;)if(!_e(h.value,u))return!1}catch(d){p.e(d)}finally{p.f()}}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Ee(e.coordinates,r,i),a=Te(t.geometry(),n,r,i);if(!me(n,r))return!1;var s,l=f(a);try{for(l.s();!(s=l.n()).done;)if(!we(s.value,o))return!1}catch(d){l.e(d)}finally{l.f()}}if("MultiPolygon"===e.type){var u=ke(e.coordinates,r,i),c=Te(t.geometry(),n,r,i);if(!me(n,r))return!1;var h,p=f(c);try{for(p.s();!(h=p.n()).done;)if(!Se(h.value,u))return!1}catch(d){p.e(d)}finally{p.f()}}return!0}(t,this.geometries)}return!1}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}}],[{key:"parse",value:function(e,n){if(2!==e.length)return n.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(te(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var i=0;i<r.features.length;++i){var o=r.features[i].geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new t(r,r.features[i].geometry)}else if("Feature"===r.type){var a=r.geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new t(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new t(r,r)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}}]),t}();function Ae(t){if(t instanceof he){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Pe)return!1;var e=!0;return t.eachChild((function(t){e&&!Ae(t)&&(e=!1)})),e}function Me(t){if(t instanceof he&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Me(t)&&(e=!1)})),e}function Le(t,e){if(t instanceof he&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!Le(t,e)&&(n=!1)})),n}var Re=function(){function t(e,n){d(this,t),this.type=n.type,this.name=e,this.boundExpression=n}return p(t,[{key:"evaluate",value:function(t){return this.boundExpression.evaluate(t)}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(2!==e.length||"string"!=typeof e[1])return n.error("'var' expression requires exactly one string literal argument.");var r=e[1];return n.scope.has(r)?new t(r,n.scope.get(r)):n.error('Unknown variable "'.concat(r,'". Make sure "').concat(r,'" has been bound in an enclosing "let" expression before using it.'),1)}}]),t}(),De=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new St,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];d(this,t),this.registry=e,this.path=n,this.key=n.map((function(t){return"[".concat(t,"]")})).join(""),this.scope=i,this.errors=o,this.expectedType=r}return p(t,[{key:"parse",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)}},{key:"_parse",value:function(t,e){function n(t,e,n){return"assert"===n?new ae(e,[t]):"coerce"===n?new le(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found ".concat(typeof r,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;var i=this.registry[r];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind)if("padding"!==a.kind||"value"!==s.kind&&"number"!==s.kind&&"array"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof re)&&"resolvedImage"!==o.type.kind&&Ne(o)){var l=new ce;try{o=new re(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof t," instead."))}},{key:"concat",value:function(e,n,r){var i="number"==typeof e?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new t(this.registry,i,n||null,o,this.errors)}},{key:"error",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i="".concat(this.key).concat(n.map((function(t){return"[".concat(t,"]")})).join(""));this.errors.push(new wt(i,t))}},{key:"checkSubtype",value:function(t,e){var n=Ft(t,e);return n&&this.error(n),n}}]),t}();function Ne(t){if(t instanceof Re)return Ne(t.boundExpression);if(t instanceof he&&"error"===t.name)return!1;if(t instanceof fe)return!1;if(t instanceof Pe)return!1;var e=t instanceof le||t instanceof ae,n=!0;return t.eachChild((function(t){n=e?n&&Ne(t):n&&t instanceof re})),!!n&&Ae(t)&&Le(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ze(t,e){for(var n,r,i=t.length-1,o=0,a=i,s=0;o<=a;)if(n=t[s=Math.floor((o+a)/2)],r=t[s+1],n<=e){if(s===i||e<r)return s;o=s+1}else{if(!(n>e))throw new ie("Input is not a number.");a=s-1}return 0}var Oe=function(){function t(e,n,r){d(this,t),this.type=e,this.input=n,this.labels=[],this.outputs=[];var i,o=f(r);try{for(o.s();!(i=o.n()).done;){var a=h(i.value,2),s=a[0],l=a[1];this.labels.push(s),this.outputs.push(l)}}catch(u){o.e(u)}finally{o.f()}}return p(t,[{key:"evaluate",value:function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[ze(e,r)].evaluate(t)}},{key:"eachChild",value:function(t){t(this.input);var e,n=f(this.outputs);try{for(n.s();!(e=n.n()).done;)t(e.value)}catch(r){n.e(r)}finally{n.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(t){return t.outputDefined()}))}}],[{key:"parse",value:function(e,n){if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");var r=n.parse(e[1],1,kt);if(!r)return null;var i=[],o=null;n.expectedType&&"value"!==n.expectedType.kind&&(o=n.expectedType);for(var a=1;a<e.length;a+=2){var s=1===a?-1/0:e[a],l=e[a+1],u=a,c=a+1;if("number"!=typeof s)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=n.parse(l,c,o);if(!h)return null;o=o||h.type,i.push([s,h])}return new t(o,r,i)}}]),t}();function Fe(t,e,n){return t*(1-n)+e*n}var Be=Object.freeze({__proto__:null,number:Fe,color:function(t,e,n){return new Xt(Fe(t.r,e.r,n),Fe(t.g,e.g,n),Fe(t.b,e.b,n),Fe(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,r){return Fe(t,e[r],n)}))},padding:function(t,e,n){var r=t.values,i=e.values;return new Kt([Fe(r[0],i[0],n),Fe(r[1],i[1],n),Fe(r[2],i[2],n),Fe(r[3],i[3],n)])}}),je=.95047,Ue=1.08883,Ve=4/29,Ze=6/29,qe=3*Ze*Ze,Ge=Math.PI/180,We=180/Math.PI;function Xe(t){return t>.008856451679035631?Math.pow(t,1/3):t/qe+Ve}function He(t){return t>Ze?t*t*t:qe*(t-Ve)}function Ye(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function $e(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ke(t){var e=$e(t.r),n=$e(t.g),r=$e(t.b),i=Xe((.4124564*e+.3575761*n+.1804375*r)/je),o=Xe((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-Xe((.0193339*e+.119192*n+.9503041*r)/Ue)),alpha:t.a}}function Je(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*He(e),n=je*He(n),r=Ue*He(r),new Xt(Ye(3.2404542*n-1.5371385*e-.4985314*r),Ye(-.969266*n+1.8760108*e+.041556*r),Ye(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function Qe(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}var tn={forward:Ke,reverse:Je,interpolate:function(t,e,n){return{l:Fe(t.l,e.l,n),a:Fe(t.a,e.a,n),b:Fe(t.b,e.b,n),alpha:Fe(t.alpha,e.alpha,n)}}},en={forward:function(t){var e=Ke(t),n=e.l,r=e.a,i=e.b,o=Math.atan2(i,r)*We;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Ge,n=t.c;return Je({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Qe(t.h,e.h,n),c:Fe(t.c,e.c,n),l:Fe(t.l,e.l,n),alpha:Fe(t.alpha,e.alpha,n)}}},nn=Object.freeze({__proto__:null,lab:tn,hcl:en}),rn=function(){function t(e,n,r,i,o){d(this,t),this.type=e,this.operator=n,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];var a,s=f(o);try{for(s.s();!(a=s.n()).done;){var l=h(a.value,2),u=l[0],c=l[1];this.labels.push(u),this.outputs.push(c)}}catch(p){s.e(p)}finally{s.f()}}return p(t,[{key:"evaluate",value:function(e){var n=this.labels,r=this.outputs;if(1===n.length)return r[0].evaluate(e);var i=this.input.evaluate(e);if(i<=n[0])return r[0].evaluate(e);var o=n.length;if(i>=n[o-1])return r[o-1].evaluate(e);var a=ze(n,i),s=t.interpolationFactor(this.interpolation,i,n[a],n[a+1]),l=r[a].evaluate(e),u=r[a+1].evaluate(e);return"interpolate"===this.operator?Be[this.type.kind.toLowerCase()](l,u,s):"interpolate-hcl"===this.operator?en.reverse(en.interpolate(en.forward(l),en.forward(u),s)):tn.reverse(tn.interpolate(tn.forward(l),tn.forward(u),s))}},{key:"eachChild",value:function(t){t(this.input);var e,n=f(this.outputs);try{for(n.s();!(e=n.n()).done;)t(e.value)}catch(r){n.e(r)}finally{n.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(t){return t.outputDefined()}))}}],[{key:"interpolationFactor",value:function(t,n,r,i){var o=0;if("exponential"===t.name)o=on(n,t.base,r,i);else if("linear"===t.name)o=on(n,1,r,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new e(a[0],a[1],a[2],a[3]).solve(on(n,1,r,i))}return o}},{key:"parse",value:function(e,n){var r=u(e),i=r[0],o=r[1],a=r[2],s=r.slice(3);if(!Array.isArray(o)||0===o.length)return n.error("Expected an interpolation type expression.",1);if("linear"===o[0])o={name:"linear"};else if("exponential"===o[0]){var l=o[1];if("number"!=typeof l)return n.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:l}}else{if("cubic-bezier"!==o[0])return n.error("Unknown interpolation type ".concat(String(o[0])),1,0);var c=o.slice(1);if(4!==c.length||c.some((function(t){return"number"!=typeof t||t<0||t>1})))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:c}}if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(a=n.parse(a,2,kt)))return null;var h=[],f=null;"interpolate-hcl"===i||"interpolate-lab"===i?f=Tt:n.expectedType&&"value"!==n.expectedType.kind&&(f=n.expectedType);for(var p=0;p<s.length;p+=2){var d=s[p],m=s[p+1],g=p+3,v=p+4;if("number"!=typeof d)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',g);if(h.length&&h[h.length-1][0]>=d)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',g);var y=n.parse(m,v,f);if(!y)return null;f=f||y.type,h.push([d,y])}return"number"===f.kind||"color"===f.kind||"padding"===f.kind||"array"===f.kind&&"number"===f.itemType.kind&&"number"==typeof f.N?new t(f,i,o,a,h):n.error("Type ".concat(zt(f)," is not interpolatable."))}}]),t}();function on(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var an=function(){function t(e,n){d(this,t),this.type=e,this.args=n}return p(t,[{key:"evaluate",value:function(t){var e,n,r=null,i=0,o=f(this.args);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(i++,(r=a.evaluate(t))&&r instanceof Jt&&!r.available&&(e||(e=r.name),r=null,i===this.args.length&&(r=e)),null!==r)break}}catch(s){o.e(s)}finally{o.f()}return r}},{key:"eachChild",value:function(t){this.args.forEach(t)}},{key:"outputDefined",value:function(){return this.args.every((function(t){return t.outputDefined()}))}}],[{key:"parse",value:function(e,n){if(e.length<2)return n.error("Expectected at least one argument.");var r=null,i=n.expectedType;i&&"value"!==i.kind&&(r=i);var o,a=[],s=f(e.slice(1));try{for(s.s();!(o=s.n()).done;){var l=o.value,u=n.parse(l,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!u)return null;r=r||u.type,a.push(u)}}catch(h){s.e(h)}finally{s.f()}if(!r)throw new Error("No output type");var c=i&&a.some((function(t){return Ft(i,t.type)}));return new t(c?At:r,a)}}]),t}(),sn=function(){function t(e,n){d(this,t),this.type=n.type,this.bindings=[].concat(e),this.result=n}return p(t,[{key:"evaluate",value:function(t){return this.result.evaluate(t)}},{key:"eachChild",value:function(t){var e,n=f(this.bindings);try{for(n.s();!(e=n.n()).done;)t(e.value[1])}catch(r){n.e(r)}finally{n.f()}t(this.result)}},{key:"outputDefined",value:function(){return this.result.outputDefined()}}],[{key:"parse",value:function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));for(var r=[],i=1;i<e.length-1;i+=2){var o=e[i];if("string"!=typeof o)return n.error("Expected string, but found ".concat(typeof o," instead."),i);if(/[^a-zA-Z0-9_]/.test(o))return n.error("Variable names must contain only alphanumeric characters or '_'.",i);var a=n.parse(e[i+1],i+1);if(!a)return null;r.push([o,a])}var s=n.parse(e[e.length-1],e.length-1,n.expectedType,r);return s?new t(r,s):null}}]),t}(),ln=function(){function t(e,n,r){d(this,t),this.type=e,this.index=n,this.input=r}return p(t,[{key:"evaluate",value:function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ie("Array index out of bounds: ".concat(e," < 0."));if(e>=n.length)throw new ie("Array index out of bounds: ".concat(e," > ").concat(n.length-1,"."));if(e!==Math.floor(e))throw new ie("Array index must be an integer, but found ".concat(e," instead."));return n[e]}},{key:"eachChild",value:function(t){t(this.index),t(this.input)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(3!==e.length)return n.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));var r=n.parse(e[1],1,kt),i=n.parse(e[2],2,Nt(n.expectedType||At));return r&&i?new t(i.type.itemType,r,i):null}}]),t}(),un=function(){function t(e,n){d(this,t),this.type=It,this.needle=e,this.haystack=n}return p(t,[{key:"evaluate",value:function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!jt(e,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(zt(ee(e))," instead."));if(!jt(n,["string","array"]))throw new ie("Expected second argument to be of type array or string, but found ".concat(zt(ee(n))," instead."));return n.indexOf(e)>=0}},{key:"eachChild",value:function(t){t(this.needle),t(this.haystack)}},{key:"outputDefined",value:function(){return!0}}],[{key:"parse",value:function(e,n){if(3!==e.length)return n.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));var r=n.parse(e[1],1,At),i=n.parse(e[2],2,At);return r&&i?Bt(r.type,[It,Ct,kt,Et,At])?new t(r,i):n.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(zt(r.type)," instead")):null}}]),t}(),cn=function(){function t(e,n,r){d(this,t),this.type=kt,this.needle=e,this.haystack=n,this.fromIndex=r}return p(t,[{key:"evaluate",value:function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!jt(e,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(zt(ee(e))," instead."));if(!jt(n,["string","array"]))throw new ie("Expected second argument to be of type array or string, but found ".concat(zt(ee(n))," instead."));if(this.fromIndex){var r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)}},{key:"eachChild",value:function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));var r=n.parse(e[1],1,At),i=n.parse(e[2],2,At);if(!r||!i)return null;if(!Bt(r.type,[It,Ct,kt,Et,At]))return n.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(zt(r.type)," instead"));if(4===e.length){var o=n.parse(e[3],3,kt);return o?new t(r,i,o):null}return new t(r,i)}}]),t}(),hn=function(){function t(e,n,r,i,o,a){d(this,t),this.inputType=e,this.type=n,this.input=r,this.cases=i,this.outputs=o,this.otherwise=a}return p(t,[{key:"evaluate",value:function(t){var e=this.input.evaluate(t);return(ee(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}},{key:"eachChild",value:function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}},{key:"outputDefined",value:function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()}}],[{key:"parse",value:function(e,n){if(e.length<5)return n.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=1)return n.error("Expected an even number of arguments.");var r,i;n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var o={},a=[],s=2;s<e.length-1;s+=2){var l=e[s],u=e[s+1];Array.isArray(l)||(l=[l]);var c=n.concat(s);if(0===l.length)return c.error("Expected at least one branch label.");var h,p=f(l);try{for(p.s();!(h=p.n()).done;){var d=h.value;if("number"!=typeof d&&"string"!=typeof d)return c.error("Branch labels must be numbers or strings.");if("number"==typeof d&&Math.abs(d)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof d&&Math.floor(d)!==d)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,ee(d)))return null}else r=ee(d);if(void 0!==o[String(d)])return c.error("Branch labels must be unique.");o[String(d)]=a.length}}catch(y){p.e(y)}finally{p.f()}var m=n.parse(u,s,i);if(!m)return null;i=i||m.type,a.push(m)}var g=n.parse(e[1],1,At);if(!g)return null;var v=n.parse(e[e.length-1],e.length-1,i);return v?"value"!==g.type.kind&&n.concat(1).checkSubtype(r,g.type)?null:new t(r,i,g,o,a,v):null}}]),t}(),fn=function(){function t(e,n,r){d(this,t),this.type=e,this.branches=n,this.otherwise=r}return p(t,[{key:"evaluate",value:function(t){var e,n=f(this.branches);try{for(n.s();!(e=n.n()).done;){var r=h(e.value,2),i=r[0],o=r[1];if(i.evaluate(t))return o.evaluate(t)}}catch(a){n.e(a)}finally{n.f()}return this.otherwise.evaluate(t)}},{key:"eachChild",value:function(t){var e,n=f(this.branches);try{for(n.s();!(e=n.n()).done;){var r=h(e.value,2),i=r[0],o=r[1];t(i),t(o)}}catch(a){n.e(a)}finally{n.f()}t(this.otherwise)}},{key:"outputDefined",value:function(){return this.branches.every((function(t){var e=h(t,2);return e[0],e[1].outputDefined()}))&&this.otherwise.outputDefined()}}],[{key:"parse",value:function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=0)return n.error("Expected an odd number of arguments.");var r;n.expectedType&&"value"!==n.expectedType.kind&&(r=n.expectedType);for(var i=[],o=1;o<e.length-1;o+=2){var a=n.parse(e[o],o,It);if(!a)return null;var s=n.parse(e[o+1],o+1,r);if(!s)return null;i.push([a,s]),r=r||s.type}var l=n.parse(e[e.length-1],e.length-1,r);if(!l)return null;if(!r)throw new Error("Can't infer output type");return new t(r,i,l)}}]),t}(),pn=function(){function t(e,n,r,i){d(this,t),this.type=e,this.input=n,this.beginIndex=r,this.endIndex=i}return p(t,[{key:"evaluate",value:function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!jt(e,["string","array"]))throw new ie("Expected first argument to be of type array or string, but found ".concat(zt(ee(e))," instead."));if(this.endIndex){var r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)}},{key:"eachChild",value:function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));var r=n.parse(e[1],1,At),i=n.parse(e[2],2,kt);if(!r||!i)return null;if(!Bt(r.type,[Nt(At),Ct,At]))return n.error("Expected first argument to be of type array or string, but found ".concat(zt(r.type)," instead"));if(4===e.length){var o=n.parse(e[3],3,kt);return o?new t(r.type,r,i,o):null}return new t(r.type,r,i)}}]),t}();function dn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function mn(t,e,n,r){return 0===r.compare(e,n)}function gn(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){d(this,i),this.type=It,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return p(i,[{key:"evaluate",value:function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=ee(o),l=ee(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new ie('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(s.kind,", ").concat(l.kind,") instead."))}if(this.collator&&!r&&this.hasUntypedArgument){var u=ee(o),c=ee(a);if("string"!==u.kind||"string"!==c.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)}},{key:"eachChild",value:function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}},{key:"outputDefined",value:function(){return!0}}],[{key:"parse",value:function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,At);if(!o)return null;if(!dn(n,o.type))return e.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(zt(o.type),"'."));var a=e.parse(t[2],2,At);if(!a)return null;if(!dn(n,a.type))return e.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(zt(a.type),"'."));if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '".concat(zt(o.type),"' and '").concat(zt(a.type),"'."));r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new ae(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new ae(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Mt)))return null}return new i(o,a,s)}}]),i}()}var vn=gn("==",(function(t,e,n){return e===n}),mn),yn=gn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!mn(0,e,n,r)})),_n=gn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),xn=gn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),bn=gn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),wn=gn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0})),Sn=function(){function t(e,n,r,i,o){d(this,t),this.type=Ct,this.number=e,this.locale=n,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=o}return p(t,[{key:"evaluate",value:function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}},{key:"eachChild",value:function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(3!==e.length)return n.error("Expected two arguments.");var r=n.parse(e[1],1,kt);if(!r)return null;var i=e[2];if("object"!=typeof i||Array.isArray(i))return n.error("NumberFormat options argument must be an object.");var o=null;if(i.locale&&!(o=n.parse(i.locale,1,Ct)))return null;var a=null;if(i.currency&&!(a=n.parse(i.currency,1,Ct)))return null;var s=null;if(i["min-fraction-digits"]&&!(s=n.parse(i["min-fraction-digits"],1,kt)))return null;var l=null;return i["max-fraction-digits"]&&!(l=n.parse(i["max-fraction-digits"],1,kt))?null:new t(r,o,a,s,l)}}]),t}(),En=function(){function t(e){d(this,t),this.type=Lt,this.sections=e}return p(t,[{key:"evaluate",value:function(t){return new $t(this.sections.map((function(e){var n=e.content.evaluate(t);return ee(n)===Dt?new Yt("",n,null,null,null):new Yt(ne(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}},{key:"eachChild",value:function(t){var e,n=f(this.sections);try{for(n.s();!(e=n.n()).done;){var r=e.value;t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}}catch(i){n.e(i)}finally{n.f()}}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return n.error("First argument must be an image or text section.");for(var i=[],o=!1,a=1;a<=e.length-1;++a){var s=e[a];if(o&&"object"==typeof s&&!Array.isArray(s)){o=!1;var l=null;if(s["font-scale"]&&!(l=n.parse(s["font-scale"],1,kt)))return null;var u=null;if(s["text-font"]&&!(u=n.parse(s["text-font"],1,Nt(Ct))))return null;var c=null;if(s["text-color"]&&!(c=n.parse(s["text-color"],1,Tt)))return null;var h=i[i.length-1];h.scale=l,h.font=u,h.textColor=c}else{var f=n.parse(e[a],1,At);if(!f)return null;var p=f.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:f,scale:null,font:null,textColor:null})}}return new t(i)}}]),t}(),kn=function(){function t(e){d(this,t),this.type=Dt,this.input=e}return p(t,[{key:"evaluate",value:function(t){var e=this.input.evaluate(t),n=Jt.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}},{key:"eachChild",value:function(t){t(this.input)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(2!==e.length)return n.error("Expected two arguments.");var r=n.parse(e[1],1,Ct);return r?new t(r):n.error("No image name provided.")}}]),t}(),Cn=function(){function t(e){d(this,t),this.type=kt,this.input=e}return p(t,[{key:"evaluate",value:function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ie("Expected value to be of type string or array, but found ".concat(zt(ee(e))," instead."))}},{key:"eachChild",value:function(t){t(this.input)}},{key:"outputDefined",value:function(){return!1}}],[{key:"parse",value:function(e,n){if(2!==e.length)return n.error("Expected 1 argument, but found ".concat(e.length-1," instead."));var r=n.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?n.error("Expected argument of type string or array, but found ".concat(zt(r.type)," instead.")):new t(r):null}}]),t}(),In={"==":vn,"!=":yn,">":xn,"<":_n,">=":wn,"<=":bn,array:ae,at:ln,boolean:ae,case:fn,coalesce:an,collator:fe,format:En,image:kn,in:un,"index-of":cn,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:Cn,let:sn,literal:re,match:hn,number:ae,"number-format":Sn,object:ae,slice:pn,step:Oe,string:ae,"to-boolean":le,"to-color":le,"to-number":le,"to-string":le,var:Re,within:Pe};function Tn(t,e){var n=h(e,4),r=n[0],i=n[1],o=n[2],a=n[3];r=r.evaluate(t),i=i.evaluate(t),o=o.evaluate(t);var s=a?a.evaluate(t):1,l=Qt(r,i,o,s);if(l)throw new ie(l);return new Xt(r/255*s,i/255*s,o/255*s,s)}function Pn(t,e){return t in e}function An(t,e){var n=e[t];return void 0===n?null:n}function Mn(t){return{type:t}}function Ln(t){return{result:"success",value:t}}function Rn(t){return{result:"error",value:t}}function Dn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Nn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function zn(t){return!!t.expression&&t.expression.interpolated}function On(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Fn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Bn(t){return t}function jn(t,e){var n,r,i,o="color"===e.type,a=t.stops&&"object"==typeof t.stops[0][0],s=a||!(a||void 0!==t.property),l=t.type||(zn(e)?"exponential":"interval");if(o||"padding"===e.type){var u=o?Xt.parse:Kt.parse;(t=_t({},t)).stops&&(t.stops=t.stops.map((function(t){return[t[0],u(t[1])]}))),t.default=u(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==t.colorSpace&&!nn[t.colorSpace])throw new Error("Unknown color space: ".concat(t.colorSpace));if("exponential"===l)n=qn;else if("interval"===l)n=Zn;else if("categorical"===l){n=Vn,r=Object.create(null);var c,h=f(t.stops);try{for(h.s();!(c=h.n()).done;){var p=c.value;r[p[0]]=p[1]}}catch(k){h.e(k)}finally{h.f()}i=typeof t.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'.concat(l,'"'));n=Gn}if(a){for(var d={},m=[],g=0;g<t.stops.length;g++){var v=t.stops[g],y=v[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:t.type,property:t.property,default:t.default,stops:[]},m.push(y)),d[y].stops.push([v[0].value,v[1]])}for(var _=[],x=0,b=m;x<b.length;x++){var w=b[x];_.push([d[w].zoom,jn(d[w],e)])}var S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:rn.interpolationFactor.bind(void 0,S),zoomStops:_.map((function(t){return t[0]})),evaluate:function(n,r){var i=n.zoom;return qn({stops:_,base:t.base},e,i).evaluate(i,r)}}}if(s){var E="exponential"===l?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:rn.interpolationFactor.bind(void 0,E),zoomStops:t.stops.map((function(t){return t[0]})),evaluate:function(o){var a=o.zoom;return n(t,e,a,r,i)}}}return{kind:"source",evaluate:function(o,a){var s=a&&a.properties?a.properties[t.property]:void 0;return void 0===s?Un(t.default,e.default):n(t,e,s,r,i)}}}function Un(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Vn(t,e,n,r,i){return Un(typeof n===i?r[n]:void 0,t.default,e.default)}function Zn(t,e,n){if("number"!==On(n))return Un(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=ze(t.stops.map((function(t){return t[0]})),n);return t.stops[i][1]}function qn(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==On(n))return Un(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var o=ze(t.stops.map((function(t){return t[0]})),n),a=function(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Be[e.type]||Bn;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=nn[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=s.evaluate.apply(void 0,e),i=l.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==i)return u(r,i,a)}}:u(s,l,a)}function Gn(t,e,n){switch(e.type){case"color":n=Xt.parse(n);break;case"formatted":n=$t.fromString(n.toString());break;case"resolvedImage":n=Jt.fromString(n.toString());break;case"padding":n=Kt.parse(n);break;default:On(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0)}return Un(n,t.default,e.default)}he.register(In,{error:[{kind:"error"},[Ct],function(t,e){var n=h(e,1)[0];throw new ie(n.evaluate(t))}],typeof:[Ct,[At],function(t,e){return zt(ee(h(e,1)[0].evaluate(t)))}],"to-rgba":[Nt(kt,4),[Tt],function(t,e){return h(e,1)[0].evaluate(t).toArray()}],rgb:[Tt,[kt,kt,kt],Tn],rgba:[Tt,[kt,kt,kt,kt],Tn],has:{type:It,overloads:[[[Ct],function(t,e){return Pn(h(e,1)[0].evaluate(t),t.properties())}],[[Ct,Pt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return Pn(r.evaluate(t),i.evaluate(t))}]]},get:{type:At,overloads:[[[Ct],function(t,e){return An(h(e,1)[0].evaluate(t),t.properties())}],[[Ct,Pt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return An(r.evaluate(t),i.evaluate(t))}]]},"feature-state":[At,[Ct],function(t,e){return An(h(e,1)[0].evaluate(t),t.featureState||{})}],properties:[Pt,[],function(t){return t.properties()}],"geometry-type":[Ct,[],function(t){return t.geometryType()}],id:[At,[],function(t){return t.id()}],zoom:[kt,[],function(t){return t.globals.zoom}],"heatmap-density":[kt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[kt,[],function(t){return t.globals.lineProgress||0}],accumulated:[At,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[kt,Mn(kt),function(t,e){var n,r=0,i=f(e);try{for(i.s();!(n=i.n()).done;)r+=n.value.evaluate(t)}catch(o){i.e(o)}finally{i.f()}return r}],"*":[kt,Mn(kt),function(t,e){var n,r=1,i=f(e);try{for(i.s();!(n=i.n()).done;)r*=n.value.evaluate(t)}catch(o){i.e(o)}finally{i.f()}return r}],"-":{type:kt,overloads:[[[kt,kt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return r.evaluate(t)-i.evaluate(t)}],[[kt],function(t,e){return-h(e,1)[0].evaluate(t)}]]},"/":[kt,[kt,kt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return r.evaluate(t)/i.evaluate(t)}],"%":[kt,[kt,kt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return r.evaluate(t)%i.evaluate(t)}],ln2:[kt,[],function(){return Math.LN2}],pi:[kt,[],function(){return Math.PI}],e:[kt,[],function(){return Math.E}],"^":[kt,[kt,kt],function(t,e){var n=h(e,2),r=n[0],i=n[1];return Math.pow(r.evaluate(t),i.evaluate(t))}],sqrt:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.sqrt(n.evaluate(t))}],log10:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.log(n.evaluate(t))}],log2:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.sin(n.evaluate(t))}],cos:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.cos(n.evaluate(t))}],tan:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.tan(n.evaluate(t))}],asin:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.asin(n.evaluate(t))}],acos:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.acos(n.evaluate(t))}],atan:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.atan(n.evaluate(t))}],min:[kt,Mn(kt),function(t,e){return Math.min.apply(Math,c(e.map((function(e){return e.evaluate(t)}))))}],max:[kt,Mn(kt),function(t,e){return Math.max.apply(Math,c(e.map((function(e){return e.evaluate(t)}))))}],abs:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.abs(n.evaluate(t))}],round:[kt,[kt],function(t,e){var n=h(e,1)[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.floor(n.evaluate(t))}],ceil:[kt,[kt],function(t,e){var n=h(e,1)[0];return Math.ceil(n.evaluate(t))}],"filter-==":[It,[Ct,At],function(t,e){var n=h(e,2),r=n[0],i=n[1];return t.properties()[r.value]===i.value}],"filter-id-==":[It,[At],function(t,e){var n=h(e,1)[0];return t.id()===n.value}],"filter-type-==":[It,[Ct],function(t,e){var n=h(e,1)[0];return t.geometryType()===n.value}],"filter-<":[It,[Ct,At],function(t,e){var n=h(e,2),r=n[0],i=n[1],o=t.properties()[r.value],a=i.value;return typeof o==typeof a&&o<a}],"filter-id-<":[It,[At],function(t,e){var n=h(e,1)[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[It,[Ct,At],function(t,e){var n=h(e,2),r=n[0],i=n[1],o=t.properties()[r.value],a=i.value;return typeof o==typeof a&&o>a}],"filter-id->":[It,[At],function(t,e){var n=h(e,1)[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[It,[Ct,At],function(t,e){var n=h(e,2),r=n[0],i=n[1],o=t.properties()[r.value],a=i.value;return typeof o==typeof a&&o<=a}],"filter-id-<=":[It,[At],function(t,e){var n=h(e,1)[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[It,[Ct,At],function(t,e){var n=h(e,2),r=n[0],i=n[1],o=t.properties()[r.value],a=i.value;return typeof o==typeof a&&o>=a}],"filter-id->=":[It,[At],function(t,e){var n=h(e,1)[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[It,[At],function(t,e){return h(e,1)[0].value in t.properties()}],"filter-has-id":[It,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[It,[Nt(Ct)],function(t,e){return h(e,1)[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[It,[Nt(At)],function(t,e){return h(e,1)[0].value.indexOf(t.id())>=0}],"filter-in-small":[It,[Ct,Nt(At)],function(t,e){var n=h(e,2),r=n[0];return n[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[It,[Ct,Nt(At)],function(t,e){var n=h(e,2),r=n[0],i=n[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[r.value],i.value,0,i.value.length-1)}],all:{type:It,overloads:[[[It,It],function(t,e){var n=h(e,2),r=n[0],i=n[1];return r.evaluate(t)&&i.evaluate(t)}],[Mn(It),function(t,e){var n,r=f(e);try{for(r.s();!(n=r.n()).done;)if(!n.value.evaluate(t))return!1}catch(i){r.e(i)}finally{r.f()}return!0}]]},any:{type:It,overloads:[[[It,It],function(t,e){var n=h(e,2),r=n[0],i=n[1];return r.evaluate(t)||i.evaluate(t)}],[Mn(It),function(t,e){var n,r=f(e);try{for(r.s();!(n=r.n()).done;)if(n.value.evaluate(t))return!0}catch(i){r.e(i)}finally{r.f()}return!1}]]},"!":[It,[It],function(t,e){return!h(e,1)[0].evaluate(t)}],"is-supported-script":[It,[Ct],function(t,e){var n=h(e,1)[0],r=t.globals&&t.globals.isSupportedScript;return!r||r(n.evaluate(t))}],upcase:[Ct,[Ct],function(t,e){return h(e,1)[0].evaluate(t).toUpperCase()}],downcase:[Ct,[Ct],function(t,e){return h(e,1)[0].evaluate(t).toLowerCase()}],concat:[Ct,Mn(At),function(t,e){return e.map((function(e){return ne(e.evaluate(t))})).join("")}],"resolved-locale":[Ct,[Mt],function(t,e){return h(e,1)[0].evaluate(t).resolvedLocale()}]});var Wn=function(){function t(e,n){d(this,t),this.expression=e,this._warningHistory={},this._evaluator=new ce,this._defaultValue=n?function(t){return"color"===t.type&&Fn(t.default)?new Xt(0,0,0,0):"color"===t.type?Xt.parse(t.default)||null:"padding"===t.type?Kt.parse(t.default)||null:void 0===t.default?null:t.default}(n):null,this._enumValues=n&&"enum"===n.type?n.values:null}return p(t,[{key:"evaluateWithoutErrorHandling",value:function(t,e,n,r,i,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}},{key:"evaluate",value:function(t,e,n,r,i,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ie("Expected value to be one of ".concat(Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", "),", but found ").concat(JSON.stringify(a)," instead."));return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}]),t}();function Xn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in In}function Hn(t,e){var n=new De(In,[],e?function(t){var e={color:Tt,string:Ct,number:kt,enum:Ct,boolean:It,formatted:Lt,padding:Rt,resolvedImage:Dt};return"array"===t.type?Nt(e[t.value]||At,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Ln(new Wn(r,e)):Rn(n.errors)}var Yn=function(){function t(e,n){d(this,t),this.kind=e,this._styleExpression=n,this.isStateDependent="constant"!==e&&!Me(n.expression)}return p(t,[{key:"evaluateWithoutErrorHandling",value:function(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}},{key:"evaluate",value:function(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}}]),t}(),$n=function(){function t(e,n,r,i){d(this,t),this.kind=e,this.zoomStops=r,this._styleExpression=n,this.isStateDependent="camera"!==e&&!Me(n.expression),this.interpolationType=i}return p(t,[{key:"evaluateWithoutErrorHandling",value:function(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}},{key:"evaluate",value:function(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}},{key:"interpolationFactor",value:function(t,e,n){return this.interpolationType?rn.interpolationFactor(this.interpolationType,t,e,n):0}}]),t}();function Kn(t,e){var n=Hn(t,e);if("error"===n.result)return n;var r=n.value.expression,i=Ae(r);if(!i&&!Dn(e))return Rn([new wt("","data expressions not supported")]);var o=Le(r,["zoom"]);if(!o&&!Nn(e))return Rn([new wt("","zoom expressions not supported")]);var a=Qn(r);return a||o?a instanceof wt?Rn([a]):a instanceof rn&&!zn(e)?Rn([new wt("",'"interpolate" expressions cannot be used with this property')]):Ln(a?new $n(i?"camera":"composite",n.value,a.labels,a instanceof rn?a.interpolation:void 0):new Yn(i?"constant":"source",n.value)):Rn([new wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}var Jn=function(){function t(e,n){d(this,t),this._parameters=e,this._specification=n,_t(this,jn(this._parameters,this._specification))}return p(t,null,[{key:"deserialize",value:function(e){return new t(e._parameters,e._specification)}},{key:"serialize",value:function(t){return{_parameters:t._parameters,_specification:t._specification}}}]),t}();function Qn(t){var e=null;if(t instanceof sn)e=Qn(t.result);else if(t instanceof an){var n,r=f(t.args);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e=Qn(i))break}}catch(o){r.e(o)}finally{r.f()}}else(t instanceof Oe||t instanceof rn)&&t.input instanceof he&&"zoom"===t.input.name&&(e=t);return e instanceof wt||t.eachChild((function(t){var n=Qn(t);n instanceof wt?e=n:!e&&n?e=new wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new wt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function tr(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=On(n);if("object"!==l)return[new vt(e,n,"object expected, ".concat(l," found"))];for(var u in n){var c=u.split(".")[0],h=r[c]||r["*"],f=void 0;if(i[c])f=i[c];else if(r[c])f=Tr;else if(i["*"])f=i["*"];else{if(!r["*"]){s.push(new vt(e,n[u],'unknown property "'.concat(u,'"')));continue}f=Tr}s=s.concat(f({key:(e?"".concat(e,"."):e)+u,value:n[u],valueSpec:h,style:o,styleSpec:a,object:n,objectKey:u},n))}for(var p in r)i[p]||r[p].required&&void 0===r[p].default&&void 0===n[p]&&s.push(new vt(e,n,'missing required property "'.concat(p,'"')));return s}function er(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||Tr;if("array"!==On(e))return[new vt(o,e,"array expected, ".concat(On(e)," found"))];if(n.length&&e.length!==n.length)return[new vt(o,e,"array length ".concat(n.length," expected, length ").concat(e.length," found"))];if(n["min-length"]&&e.length<n["min-length"])return[new vt(o,e,"array length at least ".concat(n["min-length"]," expected, length ").concat(e.length," found"))];var s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===On(n.value)&&(s=n.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:r,styleSpec:i,key:"".concat(o,"[").concat(u,"]")}));return l}function nr(t){var e=t.key,n=t.value,r=t.valueSpec,i=On(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new vt(e,n,"number expected, ".concat(i," found"))]:"minimum"in r&&n<r.minimum?[new vt(e,n,"".concat(n," is less than the minimum value ").concat(r.minimum))]:"maximum"in r&&n>r.maximum?[new vt(e,n,"".concat(n," is greater than the maximum value ").concat(r.maximum))]:[]}function rr(t){var e,n,r,i=t.valueSpec,o=xt(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,u="array"===On(t.value.stops)&&"array"===On(t.value.stops[0])&&"object"===On(t.value.stops[0][0]),c=tr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new vt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(er({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===On(n)&&0===n.length&&e.push(new vt(t.key,n,"array must have at least one stop")),e},default:function(t){return Tr({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&c.push(new vt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||c.push(new vt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!zn(t.valueSpec)&&c.push(new vt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Dn(t.valueSpec)?c.push(new vt(t.key,t.value,"property functions not supported")):s&&!Nn(t.valueSpec)&&c.push(new vt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==t.value.property||c.push(new vt(t.key,t.value,'"property" property is required')),c;function h(t){var e=[],o=t.value,s=t.key;if("array"!==On(o))return[new vt(s,o,"array expected, ".concat(On(o)," found"))];if(2!==o.length)return[new vt(s,o,"array length 2 expected, length ".concat(o.length," found"))];if(u){if("object"!==On(o[0]))return[new vt(s,o,"object expected, ".concat(On(o[0])," found"))];if(void 0===o[0].zoom)return[new vt(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new vt(s,o,"object stop key must have value")];if(r&&r>xt(o[0].zoom))return[new vt(s,o[0].zoom,"stop zoom values must appear in ascending order")];xt(o[0].zoom)!==r&&(r=xt(o[0].zoom),n=void 0,a={}),e=e.concat(tr({key:"".concat(s,"[0]"),value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:nr,value:f}}))}else e=e.concat(f({key:"".concat(s,"[0]"),value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return Xn(bt(o[1]))?e.concat([new vt("".concat(s,"[1]"),o[1],"expressions are not allowed in function stops.")]):e.concat(Tr({key:"".concat(s,"[1]"),value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function f(t,r){var s=On(t.value),l=xt(t.value),u=null!==t.value?t.value:r;if(e){if(s!==e)return[new vt(t.key,u,"".concat(s," stop domain type must match previous stop domain type ").concat(e))]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new vt(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var c="number expected, ".concat(s," found");return Dn(i)&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vt(t.key,u,c)]}return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==n&&l<n?[new vt(t.key,u,"stop domain values must appear in ascending order")]:(n=l,"categorical"===o&&l in a?[new vt(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new vt(t.key,u,"integer expected, found ".concat(l))]}}function ir(t){var e=("property"===t.expressionContext?Kn:Hn)(bt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new vt("".concat(t.key).concat(e.key),t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new vt(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Me(n))return[new vt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Me(n))return[new vt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Le(n,["zoom","feature-state"]))return[new vt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ae(n))return[new vt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function or(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(xt(n))&&i.push(new vt(e,n,"expected one of [".concat(r.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(r.values).indexOf(xt(n))&&i.push(new vt(e,n,"expected one of [".concat(Object.keys(r.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),i}function ar(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":var e,n=f(t.slice(1));try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!ar(r)&&"boolean"!=typeof r)return!1}}catch(i){n.e(i)}finally{n.f()}return!0;default:return!0}}var sr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function lr(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};ar(t)||(t=hr(t));var e=Hn(t,sr);if("error"===e.result)throw new Error(e.value.map((function(t){return"".concat(t.key,": ").concat(t.message)})).join(", "));return{filter:function(t,n,r){return e.value.evaluate(t,n,{},r)},needGeometry:cr(t)}}function ur(t,e){return t<e?-1:t>e?1:0}function cr(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var e=1;e<t.length;e++)if(cr(t[e]))return!0;return!1}function hr(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?fr(t[1],t[2],"=="):"!="===n?mr(fr(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?fr(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(hr))):"all"===n?["all"].concat(t.slice(1).map(hr)):"none"===n?["all"].concat(t.slice(1).map(hr).map(mr)):"in"===n?pr(t[1],t.slice(2)):"!in"===n?mr(pr(t[1],t.slice(2))):"has"===n?dr(t[1]):"!has"===n?mr(dr(t[1])):"within"!==n||t}function fr(t,e,n){switch(t){case"$type":return["filter-type-".concat(n),e];case"$id":return["filter-id-".concat(n),e];default:return["filter-".concat(n),t,e]}}function pr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(ur)]]:["filter-in-small",t,["literal",e]]}}function dr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function mr(t){return["!",t]}function gr(t){return ar(bt(t.value))?ir(_t({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vr(t)}function vr(t){var e=t.value,n=t.key;if("array"!==On(e))return[new vt(n,e,"array expected, ".concat(On(e)," found"))];var r,i=t.styleSpec,o=[];if(e.length<1)return[new vt(n,e,"filter array must have at least 1 element")];switch(o=o.concat(or({key:"".concat(n,"[0]"),value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),xt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===xt(e[1])&&o.push(new vt(n,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":3!==e.length&&o.push(new vt(n,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&"string"!==(r=On(e[1]))&&o.push(new vt("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found")));for(var a=2;a<e.length;a++)r=On(e[a]),"$type"===xt(e[1])?o=o.concat(or({key:"".concat(n,"[").concat(a,"]"),value:e[a],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new vt("".concat(n,"[").concat(a,"]"),e[a],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(var s=1;s<e.length;s++)o=o.concat(vr({key:"".concat(n,"[").concat(s,"]"),value:e[s],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=On(e[1]),2!==e.length?o.push(new vt(n,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):"string"!==r&&o.push(new vt("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found")));break;case"within":r=On(e[1]),2!==e.length?o.push(new vt(n,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):"object"!==r&&o.push(new vt("".concat(n,"[1]"),e[1],"object expected, ".concat(r," found")))}return o}function yr(t,e){var n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i["".concat(e,"_").concat(t.layerType)];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Tr({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var u,c=t.valueSpec||s[a];if(!c)return[new vt(n,o,'unknown property "'.concat(a,'"'))];if("string"===On(o)&&Dn(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new vt(n,o,'"'.concat(a,'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ').concat(JSON.stringify(u[1])," }`."))];var h=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&h.push(new vt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Fn(bt(o))&&"identity"===xt(o.type)&&h.push(new vt(n,o,'"text-font" does not support identity functions'))),h.concat(Tr({key:t.key,value:o,valueSpec:c,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function _r(t){return yr(t,"paint")}function xr(t){return yr(t,"layout")}function br(t){var e=[],n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new vt(r,n,'either "type" or "ref" is required'));var a,s=xt(n.type),l=xt(n.ref);if(n.id)for(var u=xt(n.id),c=0;c<t.arrayIndex;c++){var h=i.layers[c];xt(h.id)===u&&e.push(new vt(r,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(h.id.__line__)))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new vt(r,n[t],'"'.concat(t,'" is prohibited for ref layers')))})),i.layers.forEach((function(t){xt(t.id)===l&&(a=t)})),a?a.ref?e.push(new vt(r,n.ref,"ref cannot reference another ref layer")):s=xt(a.type):e.push(new vt(r,n.ref,'ref layer "'.concat(l,'" not found')));else if("background"!==s)if(n.source){var f=i.sources&&i.sources[n.source],p=f&&xt(f.type);f?"vector"===p&&"raster"===s?e.push(new vt(r,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster"===p&&"raster"!==s?e.push(new vt(r,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==p||n["source-layer"]?"raster-dem"===p&&"hillshade"!==s?e.push(new vt(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===p&&f.lineMetrics||e.push(new vt(r,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new vt(r,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):e.push(new vt(r,n.source,'source "'.concat(n.source,'" not found')))}else e.push(new vt(r,n,'missing required property "source"'));return e=e.concat(tr({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Tr({key:"".concat(r,".type"),value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:gr,layout:function(t){return tr({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return xr(_t({layerType:s},t))}}})},paint:function(t){return tr({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return _r(_t({layerType:s},t))}}})}}})),e}function wr(t){var e=t.value,n=t.key,r=On(e);return"string"!==r?[new vt(n,e,"string expected, ".concat(r," found"))]:[]}var Sr={promoteId:function(t){var e=t.key,n=t.value;if("string"===On(n))return wr({key:e,value:n});var r=[];for(var i in n)r.push.apply(r,c(wr({key:"".concat(e,".").concat(i),value:n[i]})));return r}};function Er(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new vt(n,e,'"type" is required')];var o,a=xt(e.type);switch(a){case"vector":case"raster":case"raster-dem":return o=tr({key:n,value:e,valueSpec:r["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:r,objectElementValidators:Sr});case"geojson":if(o=tr({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:Sr}),e.cluster)for(var s in e.clusterProperties){var l,u,f=h(e.clusterProperties[s],2),p=f[0],d=f[1],m="string"==typeof p?[p,["accumulated"],["get",s]]:p;(l=o).push.apply(l,c(ir({key:"".concat(n,".").concat(s,".map"),value:d,expressionContext:"cluster-map"}))),(u=o).push.apply(u,c(ir({key:"".concat(n,".").concat(s,".reduce"),value:m,expressionContext:"cluster-reduce"})))}return o;case"video":return tr({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return tr({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new vt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return or({key:"".concat(n,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function kr(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,o=[],a=On(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new vt("light",e,"object expected, ".concat(a," found"))]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=o.concat(l&&r[l[1]]&&r[l[1]].transition?Tr({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n}):r[s]?Tr({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n}):[new vt(s,e[s],'unknown property "'.concat(s,'"'))])}return o}function Cr(t){var e=t.value,n=t.styleSpec,r=n.terrain,i=t.style,o=[],a=On(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new vt("terrain",e,"object expected, ".concat(a," found"))]);for(var s in e)o=o.concat(r[s]?Tr({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n}):[new vt(s,e[s],'unknown property "'.concat(s,'"'))]);return o}var Ir={"*":function(){return[]},array:er,boolean:function(t){var e=t.value,n=t.key,r=On(e);return"boolean"!==r?[new vt(n,e,"boolean expected, ".concat(r," found"))]:[]},number:nr,color:function(t){var e=t.key,n=t.value,r=On(n);return"string"!==r?[new vt(e,n,"color expected, ".concat(r," found"))]:null===Ut(n)?[new vt(e,n,'color expected, "'.concat(n,'" found'))]:[]},constants:yt,enum:or,filter:gr,function:rr,layer:br,object:tr,source:Er,light:kr,terrain:Cr,string:wr,formatted:function(t){return 0===wr(t).length?[]:ir(t)},resolvedImage:function(t){return 0===wr(t).length?[]:ir(t)},padding:function(t){var e=t.key,n=t.value;if("array"===On(n)){if(n.length<1||n.length>4)return[new vt(e,n,"padding requires 1 to 4 values; ".concat(n.length," values found"))];for(var r={type:"number"},i=[],o=0;o<n.length;o++)i=i.concat(Tr({key:"".concat(e,"[").concat(o,"]"),value:n[o],valueSpec:r}));return i}return nr({key:e,value:n,valueSpec:{}})}};function Tr(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&Fn(xt(e))?rr(t):n.expression&&Xn(bt(e))?ir(t):n.type&&Ir[n.type]?Ir[n.type](t):tr(_t({},t,{valueSpec:n.type?r[n.type]:n}))}function Pr(t){var e=t.value,n=t.key,r=wr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new vt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new vt(n,e,'"glyphs" url must include a "{range}" token'))),r}function Ar(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt,n=[];return n=n.concat(Tr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Pr,"*":function(){return[]}}})),t.constants&&(n=n.concat(yt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Mr(n)}function Mr(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Lr(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Mr(t.apply(this,n))}}Ar.source=Lr(Er),Ar.light=Lr(kr),Ar.terrain=Lr(Cr),Ar.layer=Lr(br),Ar.filter=Lr(gr),Ar.paintProperty=Lr(_r),Ar.layoutProperty=Lr(xr);var Rr=Ar,Dr=Rr.light,Nr=Rr.paintProperty,zr=Rr.layoutProperty;function Or(t,e){var n=!1;if(e&&e.length){var r,i=f(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.fire(new dt(new Error(o.message))),n=!0}}catch(a){i.e(a)}finally{i.f()}}return n}var Fr=function(){function t(e,n,r){d(this,t);var i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var o=new Int32Array(this.arrayBuffer);e=o[0],this.d=(n=o[1])+2*(r=o[2]);for(var a=0;a<this.d*this.d;a++){var s=o[3+a],l=o[3+a+1];i.push(s===l?null:o.subarray(s,l))}var u=o[3+i.length+1];this.keys=o.subarray(o[3+i.length],u),this.bboxes=o.subarray(u),this.insert=this._insertReadonly}else{this.d=n+2*r;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=r,this.scale=n/e,this.uid=0;var h=r/n*e;this.min=-h,this.max=e+h}return p(t,[{key:"insert",value:function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"_insertReadonly",value:function(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}},{key:"_insertCell",value:function(t,e,n,r,i,o){this.cells[i].push(o)}},{key:"query",value:function(t,e,n,r,i){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,n,r,this._queryCell,s,{},i),s}},{key:"_queryCell",value:function(t,e,n,r,i,o,a,s){var l=this.cells[i];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var f=l[h];if(void 0===a[f]){var p=4*f;(s?s(c[p+0],c[p+1],c[p+2],c[p+3]):t<=c[p+2]&&e<=c[p+3]&&n>=c[p+0]&&r>=c[p+1])?(a[f]=!0,o.push(u[f])):a[f]=!1}}}},{key:"_forEachCell",value:function(t,e,n,r,i,o,a,s){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),h=this._convertToCellCoord(r),f=l;f<=c;f++)for(var p=u;p<=h;p++){var d=this.d*p+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(p),this._convertFromCellCoord(f+1),this._convertFromCellCoord(p+1)))&&i.call(this,t,e,n,r,d,o,a,s))return}}},{key:"_convertFromCellCoord",value:function(t){return(t-this.padding)/this.scale}},{key:"_convertToCellCoord",value:function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}},{key:"toArrayBuffer",value:function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}}],[{key:"serialize",value:function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}}},{key:"deserialize",value:function(e){return new t(e.buffer)}}]),t}(),Br={};function jr(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Br[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Br[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var Ur in jr("Object",Object),jr("TransferableGridIndex",Fr),jr("Color",Xt),jr("Error",Error),jr("AJAXError",et),jr("ResolvedImage",Jt),jr("StylePropertyFunction",Jn),jr("StyleExpression",Wn,{omit:["_evaluator"]}),jr("ZoomDependentExpression",$n),jr("ZoomConstantExpression",Yn),jr("CompoundExpression",he,{omit:["_evaluate"]}),In)In[Ur]._classRegistryKey||jr("Expression_".concat(Ur),In[Ur]);function Vr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Zr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob)return t;if(Vr(t))return e&&e.push(t),t;if(z(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){var r,i=[],o=f(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.push(Zr(a,e))}}catch(p){o.e(p)}finally{o.f()}return i}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!Br[l])throw new Error("".concat(l," is not registered."));var u=s.serialize?s.serialize(t,e):{};if(s.serialize){if(e&&u===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(var c in t)if(t.hasOwnProperty(c)&&!(Br[l].omit.indexOf(c)>=0)){var h=t[c];u[c]=Br[l].shallow.indexOf(c)>=0?h:Zr(h,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof t)}function qr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||Vr(t)||z(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(qr);if("object"==typeof t){var e=t.$name||"Object";if(!Br[e])throw new Error("can't deserialize unregistered class ".concat(e));var n=Br[e].klass;if(!n)throw new Error("can't deserialize unregistered class ".concat(e));if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,o=Object.keys(t);i<o.length;i++){var a=o[i];if("$name"!==a){var s=t[a];r[a]=Br[e].shallow.indexOf(a)>=0?s:qr(s)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var Gr=function(){function t(){d(this,t),this.first=!0}return p(t,[{key:"update",value:function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}]),t}(),Wr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Xr(t){var e,n=f(t);try{for(n.s();!(e=n.n()).done;)if($r(e.value.charCodeAt(0)))return!0}catch(r){n.e(r)}finally{n.f()}return!1}function Hr(t){var e,n=f(t);try{for(n.s();!(e=n.n()).done;)if(!Yr(e.value.charCodeAt(0)))return!1}catch(r){n.e(r)}finally{n.f()}return!0}function Yr(t){return!(Wr.Arabic(t)||Wr["Arabic Supplement"](t)||Wr["Arabic Extended-A"](t)||Wr["Arabic Presentation Forms-A"](t)||Wr["Arabic Presentation Forms-B"](t))}function $r(t){return!(746!==t&&747!==t&&(t<4352||!(Wr["Bopomofo Extended"](t)||Wr.Bopomofo(t)||Wr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Wr["CJK Compatibility Ideographs"](t)||Wr["CJK Compatibility"](t)||Wr["CJK Radicals Supplement"](t)||Wr["CJK Strokes"](t)||!(!Wr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Wr["CJK Unified Ideographs Extension A"](t)||Wr["CJK Unified Ideographs"](t)||Wr["Enclosed CJK Letters and Months"](t)||Wr["Hangul Compatibility Jamo"](t)||Wr["Hangul Jamo Extended-A"](t)||Wr["Hangul Jamo Extended-B"](t)||Wr["Hangul Jamo"](t)||Wr["Hangul Syllables"](t)||Wr.Hiragana(t)||Wr["Ideographic Description Characters"](t)||Wr.Kanbun(t)||Wr["Kangxi Radicals"](t)||Wr["Katakana Phonetic Extensions"](t)||Wr.Katakana(t)&&12540!==t||!(!Wr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Wr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Wr["Unified Canadian Aboriginal Syllabics"](t)||Wr["Unified Canadian Aboriginal Syllabics Extended"](t)||Wr["Vertical Forms"](t)||Wr["Yijing Hexagram Symbols"](t)||Wr["Yi Syllables"](t)||Wr["Yi Radicals"](t))))}function Kr(t){return!($r(t)||function(t){return!!(Wr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Wr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Wr["Letterlike Symbols"](t)||Wr["Number Forms"](t)||Wr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Wr["Control Pictures"](t)&&9251!==t||Wr["Optical Character Recognition"](t)||Wr["Enclosed Alphanumerics"](t)||Wr["Geometric Shapes"](t)||Wr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Wr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Wr["CJK Symbols and Punctuation"](t)||Wr.Katakana(t)||Wr["Private Use Area"](t)||Wr["CJK Compatibility Forms"](t)||Wr["Small Form Variants"](t)||Wr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Jr(t){return t>=1424&&t<=2303||Wr["Arabic Presentation Forms-A"](t)||Wr["Arabic Presentation Forms-B"](t)}function Qr(t,e){return!(!e&&Jr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Wr.Khmer(t))}function ti(t){var e,n=f(t);try{for(n.s();!(e=n.n()).done;)if(Jr(e.value.charCodeAt(0)))return!0}catch(r){n.e(r)}finally{n.f()}return!1}var ei="deferred",ni="loading",ri="loaded",ii=null,oi="unavailable",ai=null,si=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(oi="error"),ii&&ii(t)};function li(){ui.fire(new pt("pluginStateChange",{pluginStatus:oi,pluginURL:ai}))}var ui=new mt,ci=function(){return oi},hi=function(){if(oi!==ei||!ai)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");oi=ni,li(),ai&&ot({url:ai},(function(t){t?si(t):(oi=ri,li())}))},fi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return oi===ri||null!=fi.applyArabicShaping},isLoading:function(){return oi===ni},setState:function(t){if(!A())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");oi=t.pluginStatus,ai=t.pluginURL},isParsed:function(){if(!A())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=fi.applyArabicShaping&&null!=fi.processBidirectionalText&&null!=fi.processStyledBidirectionalText},getPluginURL:function(){if(!A())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ai}},pi=function(){function t(e,n){d(this,t),this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gr,this.transition={})}return p(t,[{key:"isSupportedScript",value:function(t){return function(t,e){var n,r=f(t);try{for(r.s();!(n=r.n()).done;)if(!Qr(n.value.charCodeAt(0),e))return!1}catch(i){r.e(i)}finally{r.f()}return!0}(t,fi.isLoaded())}},{key:"crossFadingFactor",value:function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}},{key:"getCrossfadeParameters",value:function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}]),t}(),di=function(){function t(e,n){d(this,t),this.property=e,this.value=n,this.expression=function(t,e){if(Fn(t))return new Jn(t,e);if(Xn(t)){var n=Kn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return"".concat(t.key,": ").concat(t.message)})).join(", "));return n.value}var r=t;return"color"===e.type&&"string"==typeof t?r=Xt.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)||(r=Kt.parse(t)),{kind:"constant",evaluate:function(){return r}}}(void 0===n?e.specification.default:n,e.specification)}return p(t,[{key:"isDataDriven",value:function(){return"source"===this.expression.kind||"composite"===this.expression.kind}},{key:"possiblyEvaluate",value:function(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}]),t}(),mi=function(){function t(e){d(this,t),this.property=e,this.value=new di(e,void 0)}return p(t,[{key:"transitioned",value:function(t,e){return new vi(this.property,this.value,e,x({},t.transition,this.transition),t.now)}},{key:"untransitioned",value:function(){return new vi(this.property,this.value,null,{},0)}}]),t}(),gi=function(){function t(e){d(this,t),this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}return p(t,[{key:"getValue",value:function(t){return k(this._values[t].value.value)}},{key:"setValue",value:function(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new mi(this._values[t].property)),this._values[t].value=new di(this._values[t].property,null===e?void 0:k(e))}},{key:"getTransition",value:function(t){return k(this._values[t].transition)}},{key:"setTransition",value:function(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new mi(this._values[t].property)),this._values[t].transition=k(e)||void 0}},{key:"serialize",value:function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e++){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var o=this.getTransition(r);void 0!==o&&(t["".concat(r,"-transition")]=o)}return t}},{key:"transitioned",value:function(t,e){for(var n=new yi(this._properties),r=0,i=Object.keys(this._values);r<i.length;r++){var o=i[r];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n}},{key:"untransitioned",value:function(){for(var t=new yi(this._properties),e=0,n=Object.keys(this._values);e<n.length;e++){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t}}]),t}(),vi=function(){function t(e,n,r,i,o){d(this,t),this.property=e,this.value=n,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=r)}return p(t,[{key:"possiblyEvaluate",value:function(t,e,n){var r=t.now||0,i=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(t,e,n);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),i,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(a))}return i}}]),t}(),yi=function(){function t(e){d(this,t),this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}return p(t,[{key:"possiblyEvaluate",value:function(t,e,n){for(var r=new bi(this._properties),i=0,o=Object.keys(this._values);i<o.length;i++){var a=o[i];r._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return r}},{key:"hasTransition",value:function(){for(var t=0,e=Object.keys(this._values);t<e.length;t++){var n=e[t];if(this._values[n].prior)return!0}return!1}}]),t}(),_i=function(){function t(e){d(this,t),this._properties=e,this._values=Object.create(e.defaultPropertyValues)}return p(t,[{key:"getValue",value:function(t){return k(this._values[t].value)}},{key:"setValue",value:function(t,e){this._values[t]=new di(this._values[t].property,null===e?void 0:k(e))}},{key:"serialize",value:function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e++){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t}},{key:"possiblyEvaluate",value:function(t,e,n){for(var r=new bi(this._properties),i=0,o=Object.keys(this._values);i<o.length;i++){var a=o[i];r._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return r}}]),t}(),xi=function(){function t(e,n,r){d(this,t),this.property=e,this.value=n,this.parameters=r}return p(t,[{key:"isConstant",value:function(){return"constant"===this.value.kind}},{key:"constantOr",value:function(t){return"constant"===this.value.kind?this.value.value:t}},{key:"evaluate",value:function(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)}}]),t}(),bi=function(){function t(e){d(this,t),this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}return p(t,[{key:"get",value:function(t){return this._values[t]}}]),t}(),wi=function(){function t(e){d(this,t),this.specification=e}return p(t,[{key:"possiblyEvaluate",value:function(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}},{key:"interpolate",value:function(t,e,n){var r=Be[this.specification.type];return r?r(t,e,n):t}}]),t}(),Si=function(){function t(e,n){d(this,t),this.specification=e,this.overrides=n}return p(t,[{key:"possiblyEvaluate",value:function(t,e,n,r){return new xi(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)}},{key:"interpolate",value:function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new xi(this,{kind:"constant",value:void 0},t.parameters);var r=Be[this.specification.type];return r?new xi(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t}},{key:"evaluate",value:function(t,e,n,r,i,o){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i,o)}}]),t}(),Ei=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"possiblyEvaluate",value:function(t,e,n,r){if(void 0===t.value)return new xi(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r),o="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(o,o,o,e);return new xi(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new xi(this,{kind:"constant",value:s},e)}return new xi(this,t.expression,e)}},{key:"evaluate",value:function(t,e,n,r,i,o){if("source"===t.kind){var a=t.evaluate(e,n,r,i,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value}},{key:"_calculate",value:function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}},{key:"interpolate",value:function(t){return t}}]),n}(Si),ki=function(){function t(e){d(this,t),this.specification=e}return p(t,[{key:"possiblyEvaluate",value:function(t,e,n,r){if(void 0!==t.value){if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new pi(Math.floor(e.zoom-1),e)),t.expression.evaluate(new pi(Math.floor(e.zoom),e)),t.expression.evaluate(new pi(Math.floor(e.zoom+1),e)),e)}}},{key:"_calculate",value:function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}},{key:"interpolate",value:function(t){return t}}]),t}(),Ci=function(){function t(e){d(this,t),this.specification=e}return p(t,[{key:"possiblyEvaluate",value:function(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)}},{key:"interpolate",value:function(){return!1}}]),t}(),Ii=p((function t(e){for(var n in d(this,t),this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[n];r.specification.overridable&&this.overridableProperties.push(n);var i=this.defaultPropertyValues[n]=new di(r,void 0),o=this.defaultTransitionablePropertyValues[n]=new mi(r);this.defaultTransitioningPropertyValues[n]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=i.possiblyEvaluate({})}}));jr("DataDrivenProperty",Si),jr("DataConstantProperty",wi),jr("CrossFadedDataDrivenProperty",Ei),jr("CrossFadedProperty",ki),jr("ColorRampProperty",Ci);var Ti="-transition",Pi=function(t){m(n,t);var e=g(n);function n(t,r){var i;if(d(this,n),(i=e.call(this)).id=t.id,i.type=t.type,i._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(i.metadata=t.metadata,i.minzoom=t.minzoom,i.maxzoom=t.maxzoom,"background"!==t.type&&(i.source=t.source,i.sourceLayer=t["source-layer"],i.filter=t.filter),r.layout&&(i._unevaluatedLayout=new _i(r.layout)),r.paint)){for(var o in i._transitionablePaint=new gi(r.paint),t.paint)i.setPaintProperty(o,t.paint[o],{validate:!1});for(var a in t.layout)i.setLayoutProperty(a,t.layout[a],{validate:!1});i._transitioningPaint=i._transitionablePaint.untransitioned(),i.paint=new bi(r.paint)}return l(i)}return p(n,[{key:"getCrossfadeParameters",value:function(){return this._crossfadeParameters}},{key:"getLayoutProperty",value:function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}},{key:"setLayoutProperty",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=e&&this._validate(zr,"layers.".concat(this.id,".layout.").concat(t),t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}},{key:"getPaintProperty",value:function(t){return t.endsWith(Ti)?this._transitionablePaint.getTransition(t.slice(0,-Ti.length)):this._transitionablePaint.getValue(t)}},{key:"setPaintProperty",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&this._validate(Nr,"layers.".concat(this.id,".paint.").concat(t),t,e,n))return!1;if(t.endsWith(Ti))return this._transitionablePaint.setTransition(t.slice(0,-Ti.length),e||void 0),!1;var r=this._transitionablePaint._values[t],i="cross-faded-data-driven"===r.property.specification["property-type"],o=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||o||i||this._handleOverridablePaintPropertyUpdate(t,a,s)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(t){}},{key:"_handleOverridablePaintPropertyUpdate",value:function(t,e,n){return!1}},{key:"isHidden",value:function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}},{key:"updateTransitions",value:function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}},{key:"hasTransition",value:function(){return this._transitioningPaint.hasTransition()}},{key:"recalculate",value:function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}},{key:"serialize",value:function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),E(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))}},{key:"_validate",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&Or(this,t.call(Rr,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:gt,style:{glyphs:!0,sprite:!0}}))}},{key:"is3D",value:function(){return!1}},{key:"isTileClipped",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return!1}},{key:"resize",value:function(){}},{key:"isStateDependent",value:function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof xi&&Dn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}]),n}(mt),Ai={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Mi=p((function t(e,n){d(this,t),this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8})),Li=function(){function t(){d(this,t),this.isTransferred=!1,this.capacity=-1,this.resize(0)}return p(t,[{key:"_trim",value:function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}},{key:"clear",value:function(){this.length=0}},{key:"resize",value:function(t){this.reserve(t),this.length=t}},{key:"reserve",value:function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}},{key:"_refreshViews",value:function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}],[{key:"serialize",value:function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}},{key:"deserialize",value:function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}}]),t}();function Ri(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=0;return{members:t.map((function(t){var i=Ai[t.type].BYTES_PER_ELEMENT,o=n=Di(n,Math.max(e,i)),a=t.components||1;return r=Math.max(r,i),n+=i*a,{name:t.name,type:t.type,components:a,offset:o}})),size:Di(n,Math.max(r,e)),alignment:e}}function Di(t,e){return Math.ceil(t/e)*e}var Ni=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)}},{key:"emplace",value:function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t}}]),n}(Li);Ni.prototype.bytesPerElement=4,jr("StructArrayLayout2i4",Ni);var zi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}},{key:"emplace",value:function(t,e,n,r,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t}}]),n}(Li);zi.prototype.bytesPerElement=8,jr("StructArrayLayout4i8",zi);var Oi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}},{key:"emplace",value:function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t}}]),n}(Li);Oi.prototype.bytesPerElement=12,jr("StructArrayLayout2i4i12",Oi);var Fi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}},{key:"emplace",value:function(t,e,n,r,i,o,a){var s=4*t,l=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[l+4]=r,this.uint8[l+5]=i,this.uint8[l+6]=o,this.uint8[l+7]=a,t}}]),n}(Li);Fi.prototype.bytesPerElement=8,jr("StructArrayLayout2i4ub8",Fi);var Bi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)}},{key:"emplace",value:function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t}}]),n}(Li);Bi.prototype.bytesPerElement=8,jr("StructArrayLayout2f8",Bi);var ji=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o,a,s,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,r,i,o,a,s,l,u)}},{key:"emplace",value:function(t,e,n,r,i,o,a,s,l,u,c){var h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=r,this.uint16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,t}}]),n}(Li);ji.prototype.bytesPerElement=20,jr("StructArrayLayout10ui20",ji);var Ui=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o,a,s,l,u,c,h){var f=this.length;return this.resize(f+1),this.emplace(f,t,e,n,r,i,o,a,s,l,u,c,h)}},{key:"emplace",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f){var p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=r,this.int16[p+3]=i,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=u,this.int16[p+9]=c,this.int16[p+10]=h,this.int16[p+11]=f,t}}]),n}(Li);Ui.prototype.bytesPerElement=24,jr("StructArrayLayout4i4ui4i24",Ui);var Vi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}},{key:"emplace",value:function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t}}]),n}(Li);Vi.prototype.bytesPerElement=12,jr("StructArrayLayout3f12",Vi);var Zi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)}},{key:"emplace",value:function(t,e){return this.uint32[1*t+0]=e,t}}]),n}(Li);Zi.prototype.bytesPerElement=4,jr("StructArrayLayout1ul4",Zi);var qi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o,a,s,l){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s,l)}},{key:"emplace",value:function(t,e,n,r,i,o,a,s,l,u){var c=10*t,h=5*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.int16[c+4]=o,this.int16[c+5]=a,this.uint32[h+3]=s,this.uint16[c+8]=l,this.uint16[c+9]=u,t}}]),n}(Li);qi.prototype.bytesPerElement=20,jr("StructArrayLayout6i1ul2ui20",qi);var Gi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}},{key:"emplace",value:function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t}}]),n}(Li);Gi.prototype.bytesPerElement=12,jr("StructArrayLayout2i2i2i12",Gi);var Wi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r,i)}},{key:"emplace",value:function(t,e,n,r,i,o){var a=4*t,s=8*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=r,this.int16[s+6]=i,this.int16[s+7]=o,t}}]),n}(Li);Wi.prototype.bytesPerElement=16,jr("StructArrayLayout2f1f2i16",Wi);var Xi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}},{key:"emplace",value:function(t,e,n,r,i){var o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=r,this.float32[a+2]=i,t}}]),n}(Li);Xi.prototype.bytesPerElement=12,jr("StructArrayLayout2ub2f12",Xi);var Hi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}},{key:"emplace",value:function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t}}]),n}(Li);Hi.prototype.bytesPerElement=6,jr("StructArrayLayout3ui6",Hi);var Yi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g){var v=this.length;return this.resize(v+1),this.emplace(v,t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g)}},{key:"emplace",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v){var y=24*t,_=12*t,x=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=r,this.uint16[y+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[y+10]=l,this.uint16[y+11]=u,this.uint16[y+12]=c,this.float32[_+7]=h,this.float32[_+8]=f,this.uint8[x+36]=p,this.uint8[x+37]=d,this.uint8[x+38]=m,this.uint32[_+10]=g,this.int16[y+22]=v,t}}]),n}(Li);Yi.prototype.bytesPerElement=48,jr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Yi);var $i=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I){var T=this.length;return this.resize(T+1),this.emplace(T,t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I)}},{key:"emplace",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I,T){var P=34*t,A=17*t;return this.int16[P+0]=e,this.int16[P+1]=n,this.int16[P+2]=r,this.int16[P+3]=i,this.int16[P+4]=o,this.int16[P+5]=a,this.int16[P+6]=s,this.int16[P+7]=l,this.uint16[P+8]=u,this.uint16[P+9]=c,this.uint16[P+10]=h,this.uint16[P+11]=f,this.uint16[P+12]=p,this.uint16[P+13]=d,this.uint16[P+14]=m,this.uint16[P+15]=g,this.uint16[P+16]=v,this.uint16[P+17]=y,this.uint16[P+18]=_,this.uint16[P+19]=x,this.uint16[P+20]=b,this.uint16[P+21]=w,this.uint16[P+22]=S,this.uint32[A+12]=E,this.float32[A+13]=k,this.float32[A+14]=C,this.float32[A+15]=I,this.float32[A+16]=T,t}}]),n}(Li);$i.prototype.bytesPerElement=68,jr("StructArrayLayout8i15ui1ul4f68",$i);var Ki=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)}},{key:"emplace",value:function(t,e){return this.float32[1*t+0]=e,t}}]),n}(Li);Ki.prototype.bytesPerElement=4,jr("StructArrayLayout1f4",Ki);var Ji=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}},{key:"emplace",value:function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t}}]),n}(Li);Ji.prototype.bytesPerElement=6,jr("StructArrayLayout3i6",Ji);var Qi=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}},{key:"emplace",value:function(t,e,n,r){var i=4*t;return this.uint32[2*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=r,t}}]),n}(Li);Qi.prototype.bytesPerElement=8,jr("StructArrayLayout1ul2ui8",Qi);var to=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)}},{key:"emplace",value:function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t}}]),n}(Li);to.prototype.bytesPerElement=4,jr("StructArrayLayout2ui4",to);var eo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)}},{key:"emplace",value:function(t,e){return this.uint16[1*t+0]=e,t}}]),n}(Li);eo.prototype.bytesPerElement=2,jr("StructArrayLayout1ui2",eo);var no=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}},{key:"emplace",value:function(t,e,n,r,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t}}]),n}(Li);no.prototype.bytesPerElement=16,jr("StructArrayLayout4f16",no);var ro=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"anchorPointX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"anchorPointY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"x1",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"y1",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"x2",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"y2",get:function(){return this._structArray.int16[this._pos2+5]}},{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+3]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+8]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+9]}},{key:"anchorPoint",get:function(){return new F(this.anchorPointX,this.anchorPointY)}}]),n}(Mi);ro.prototype.size=20;var io=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"get",value:function(t){return new ro(this,t)}}]),n}(qi);jr("CollisionBoxArray",io);var oo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"anchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"anchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"glyphStartIndex",get:function(){return this._structArray.uint16[this._pos2+2]}},{key:"numGlyphs",get:function(){return this._structArray.uint16[this._pos2+3]}},{key:"vertexStartIndex",get:function(){return this._structArray.uint32[this._pos4+2]}},{key:"lineStartIndex",get:function(){return this._structArray.uint32[this._pos4+3]}},{key:"lineLength",get:function(){return this._structArray.uint32[this._pos4+4]}},{key:"segment",get:function(){return this._structArray.uint16[this._pos2+10]}},{key:"lowerSize",get:function(){return this._structArray.uint16[this._pos2+11]}},{key:"upperSize",get:function(){return this._structArray.uint16[this._pos2+12]}},{key:"lineOffsetX",get:function(){return this._structArray.float32[this._pos4+7]}},{key:"lineOffsetY",get:function(){return this._structArray.float32[this._pos4+8]}},{key:"writingMode",get:function(){return this._structArray.uint8[this._pos1+36]}},{key:"placedOrientation",get:function(){return this._structArray.uint8[this._pos1+37]},set:function(t){this._structArray.uint8[this._pos1+37]=t}},{key:"hidden",get:function(){return this._structArray.uint8[this._pos1+38]},set:function(t){this._structArray.uint8[this._pos1+38]=t}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+10]},set:function(t){this._structArray.uint32[this._pos4+10]=t}},{key:"associatedIconIndex",get:function(){return this._structArray.int16[this._pos2+22]}}]),n}(Mi);oo.prototype.size=48;var ao=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"get",value:function(t){return new oo(this,t)}}]),n}(Yi);jr("PlacedSymbolArray",ao);var so=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"anchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"anchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"rightJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"centerJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"leftJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"verticalPlacedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+5]}},{key:"placedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+6]}},{key:"verticalPlacedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+7]}},{key:"key",get:function(){return this._structArray.uint16[this._pos2+8]}},{key:"textBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+9]}},{key:"textBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+10]}},{key:"verticalTextBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+11]}},{key:"verticalTextBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+12]}},{key:"iconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+13]}},{key:"iconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"verticalIconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+15]}},{key:"verticalIconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"featureIndex",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"numHorizontalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"numVerticalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+19]}},{key:"numIconVertices",get:function(){return this._structArray.uint16[this._pos2+20]}},{key:"numVerticalIconVertices",get:function(){return this._structArray.uint16[this._pos2+21]}},{key:"useRuntimeCollisionCircles",get:function(){return this._structArray.uint16[this._pos2+22]}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+12]},set:function(t){this._structArray.uint32[this._pos4+12]=t}},{key:"textBoxScale",get:function(){return this._structArray.float32[this._pos4+13]}},{key:"textOffset0",get:function(){return this._structArray.float32[this._pos4+14]}},{key:"textOffset1",get:function(){return this._structArray.float32[this._pos4+15]}},{key:"collisionCircleDiameter",get:function(){return this._structArray.float32[this._pos4+16]}}]),n}(Mi);so.prototype.size=68;var lo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"get",value:function(t){return new so(this,t)}}]),n}($i);jr("SymbolInstanceArray",lo);var uo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getoffsetX",value:function(t){return this.float32[1*t+0]}}]),n}(Ki);jr("GlyphOffsetArray",uo);var co=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getx",value:function(t){return this.int16[3*t+0]}},{key:"gety",value:function(t){return this.int16[3*t+1]}},{key:"gettileUnitDistanceFromAnchor",value:function(t){return this.int16[3*t+2]}}]),n}(Ji);jr("SymbolLineVertexArray",co);var ho=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+0]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+2]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+3]}}]),n}(Mi);ho.prototype.size=8;var fo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"get",value:function(t){return new ho(this,t)}}]),n}(Qi);jr("FeatureIndexArray",fo);var po=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Ni),mo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Ni),go=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Ni),vo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Oi),yo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Fi),_o=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Bi),xo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(ji),bo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Ui),wo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Vi),So=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Zi),Eo=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Gi),ko=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Xi),Co=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Hi),Io=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(to),To=Ri([{name:"a_pos",components:2,type:"Int16"}],4).members,Po=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];d(this,t),this.segments=e}return p(t,[{key:"prepareSegment",value:function(e,n,r,i){var o=this.segments[this.segments.length-1];return e>t.MAX_VERTEX_ARRAY_LENGTH&&I("Max vertices per segment is ".concat(t.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!o||o.vertexLength+e>t.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:n.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==i&&(o.sortKey=i),this.segments.push(o)),o}},{key:"get",value:function(){return this.segments}},{key:"destroy",value:function(){var t,e=f(this.segments);try{for(e.s();!(t=e.n()).done;){var n=t.value;for(var r in n.vaos)n.vaos[r].destroy()}}catch(i){e.e(i)}finally{e.f()}}}],[{key:"simpleSegment",value:function(e,n,r,i){return new t([{vertexOffset:e,primitiveOffset:n,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])}}]),t}();function Ao(t,e){return 256*(t=y(Math.floor(t),0,255))+y(Math.floor(e),0,255)}Po.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jr("SegmentVector",Po);var Mo=Ri([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Lo={exports:{}},Ro={exports:{}};Ro.exports=function(t,e){var n,r,i,o,a,s,l,u;for(r=t.length-(n=3&t.length),i=e,a=3432918353,s=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};var Do={exports:{}};Do.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};var No=Ro.exports,zo=Do.exports;Lo.exports=No,Lo.exports.murmur3=No,Lo.exports.murmur2=zo;var Oo=function(){function t(){d(this,t),this.ids=[],this.positions=[],this.indexed=!1}return p(t,[{key:"add",value:function(t,e,n,r){this.ids.push(Fo(t)),this.positions.push(e,n,r)}},{key:"getPositions",value:function(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");for(var e=Fo(t),n=0,r=this.ids.length-1;n<r;){var i=n+r>>1;this.ids[i]>=e?r=i:n=i+1}for(var o=[];this.ids[n]===e;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o}}],[{key:"serialize",value:function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return Bo(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}}},{key:"deserialize",value:function(e){var n=new t;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}]),t}();function Fo(t){var e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Lo.exports(String(t))}function Bo(t,e,n,r){for(;n<r;){for(var i=t[n+r>>1],o=n-1,a=r+1;;){do{o++}while(t[o]<i);do{a--}while(t[a]>i);if(o>=a)break;jo(t,o,a),jo(e,3*o,3*a),jo(e,3*o+1,3*a+1),jo(e,3*o+2,3*a+2)}a-n<r-a?(Bo(t,e,n,a),n=a+1):(Bo(t,e,a+1,r),r=a)}}function jo(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}jr("FeaturePositionMap",Oo);var Uo=p((function t(e,n){d(this,t),this.gl=e.gl,this.location=n})),Vo=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=0,i}return p(n,[{key:"set",value:function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}]),n}(Uo),Zo=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=[0,0,0,0],i}return p(n,[{key:"set",value:function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}]),n}(Uo),qo=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=Xt.transparent,i}return p(n,[{key:"set",value:function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}]),n}(Uo),Go=new Float32Array(16);function Wo(t){return[Ao(255*t.r,255*t.g),Ao(255*t.b,255*t.a)]}var Xo=function(){function t(e,n,r){d(this,t),this.value=e,this.uniformNames=n.map((function(t){return"u_".concat(t)})),this.type=r}return p(t,[{key:"setUniform",value:function(t,e,n){t.set(n.constantOr(this.value))}},{key:"getBinding",value:function(t,e,n){return"color"===this.type?new qo(t,e):new Vo(t,e)}}]),t}(),Ho=function(){function t(e,n){d(this,t),this.uniformNames=n.map((function(t){return"u_".concat(t)})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}return p(t,[{key:"setConstantPatternPositions",value:function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}},{key:"setUniform",value:function(t,e,n,r){var i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&t.set(i)}},{key:"getBinding",value:function(t,e,n){return"u_pattern"===n.substr(0,9)?new Zo(t,e):new Vo(t,e)}}]),t}(),Yo=function(){function t(e,n,r,i){d(this,t),this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=n.map((function(t){return{name:"a_".concat(t),type:"Float32",components:"color"===r?2:1,offset:0}})),this.paintVertexArray=new i}return p(t,[{key:"populatePaintArray",value:function(t,e,n,r,i){var o=this.paintVertexArray.length,a=this.expression.evaluate(new pi(0),e,{},r,[],i);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)}},{key:"updatePaintArray",value:function(t,e,n,r){var i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(t,e,i)}},{key:"_setPaintValue",value:function(t,e,n){if("color"===this.type)for(var r=Wo(n),i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}},{key:"upload",value:function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}]),t}(),$o=function(){function t(e,n,r,i,o,a){d(this,t),this.expression=e,this.uniformNames=n.map((function(t){return"u_".concat(t,"_t")})),this.type=r,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=n.map((function(t){return{name:"a_".concat(t),type:"Float32",components:"color"===r?4:2,offset:0}})),this.paintVertexArray=new a}return p(t,[{key:"populatePaintArray",value:function(t,e,n,r,i){var o=this.expression.evaluate(new pi(this.zoom),e,{},r,[],i),a=this.expression.evaluate(new pi(this.zoom+1),e,{},r,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)}},{key:"updatePaintArray",value:function(t,e,n,r){var i=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(t,e,i,o)}},{key:"_setPaintValue",value:function(t,e,n,r){if("color"===this.type)for(var i=Wo(n),o=Wo(r),a=t;a<e;a++)this.paintVertexArray.emplace(a,i[0],i[1],o[0],o[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}},{key:"upload",value:function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},{key:"setUniform",value:function(t,e){var n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=y(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(r)}},{key:"getBinding",value:function(t,e,n){return new Vo(t,e)}}]),t}(),Ko=function(){function t(e,n,r,i,o,a){d(this,t),this.expression=e,this.type=n,this.useIntegerZoom=r,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}return p(t,[{key:"populatePaintArray",value:function(t,e,n){var r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)}},{key:"updatePaintArray",value:function(t,e,n,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)}},{key:"_setPaintValues",value:function(t,e,n,r){if(r&&n){var i=n.min,o=n.mid,a=n.max,s=r[i],l=r[o],u=r[a];if(s&&l&&u)for(var c=t;c<e;c++)this.zoomInPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}}},{key:"upload",value:function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Mo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Mo.members,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}]),t}(),Jo=function(){function t(e,n,r){d(this,t),this.binders={},this._buffers=[];var i=[];for(var o in e.paint._values)if(r(o)){var a=e.paint.get(o);if(a instanceof xi&&Dn(a.property.specification)){var s=ta(o,e.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,h=a.property.specification["property-type"],f="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===l.kind)this.binders[o]=f?new Ho(l.value,s):new Xo(l.value,s,u),i.push("/u_".concat(o));else if("source"===l.kind||f){var p=ea(o,u,"source");this.binders[o]=f?new Ko(l,u,c,n,p,e.id):new Yo(l,s,u,p),i.push("/a_".concat(o))}else{var m=ea(o,u,"composite");this.binders[o]=new $o(l,s,u,c,n,m),i.push("/z_".concat(o))}}}this.cacheKey=i.sort().join("")}return p(t,[{key:"getMaxValue",value:function(t){var e=this.binders[t];return e instanceof Yo||e instanceof $o?e.maxValue:0}},{key:"populatePaintArrays",value:function(t,e,n,r,i){for(var o in this.binders){var a=this.binders[o];(a instanceof Yo||a instanceof $o||a instanceof Ko)&&a.populatePaintArray(t,e,n,r,i)}}},{key:"setConstantPatternPositions",value:function(t,e){for(var n in this.binders){var r=this.binders[n];r instanceof Ho&&r.setConstantPatternPositions(t,e)}}},{key:"updatePaintArrays",value:function(t,e,n,r,i){var o=!1;for(var a in t){var s,l=e.getPositions(a),u=f(l);try{for(u.s();!(s=u.n()).done;){var c=s.value,h=n.feature(c.index);for(var p in this.binders){var d=this.binders[p];if((d instanceof Yo||d instanceof $o||d instanceof Ko)&&!0===d.expression.isStateDependent){var m=r.paint.get(p);d.expression=m.value,d.updatePaintArray(c.start,c.end,h,t[a],i),o=!0}}}}catch(g){u.e(g)}finally{u.f()}}return o}},{key:"defines",value:function(){var t=[];for(var e in this.binders){var n=this.binders[e];(n instanceof Xo||n instanceof Ho)&&t.push.apply(t,c(n.uniformNames.map((function(t){return"#define HAS_UNIFORM_".concat(t)}))))}return t}},{key:"getBinderAttributes",value:function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Yo||n instanceof $o)for(var r=0;r<n.paintVertexAttributes.length;r++)t.push(n.paintVertexAttributes[r].name);else if(n instanceof Ko)for(var i=0;i<Mo.members.length;i++)t.push(Mo.members[i].name)}return t}},{key:"getBinderUniforms",value:function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Xo||n instanceof Ho||n instanceof $o){var r,i=f(n.uniformNames);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.push(o)}}catch(a){i.e(a)}finally{i.f()}}}return t}},{key:"getPaintVertexBuffers",value:function(){return this._buffers}},{key:"getUniforms",value:function(t,e){var n=[];for(var r in this.binders){var i=this.binders[r];if(i instanceof Xo||i instanceof Ho||i instanceof $o){var o,a=f(i.uniformNames);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(e[s]){var l=i.getBinding(t,e[s],s);n.push({name:s,property:r,binding:l})}}}catch(u){a.e(u)}finally{a.f()}}}return n}},{key:"setUniforms",value:function(t,e,n,r){var i,o=f(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.name,l=a.property,u=a.binding;this.binders[l].setUniform(u,r,n.get(l),s)}}catch(c){o.e(c)}finally{o.f()}}},{key:"updatePaintBuffers",value:function(t){for(var e in this._buffers=[],this.binders){var n=this.binders[e];if(t&&n instanceof Ko){var r=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof Yo||n instanceof $o)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}},{key:"upload",value:function(t){for(var e in this.binders){var n=this.binders[e];(n instanceof Yo||n instanceof $o||n instanceof Ko)&&n.upload(t)}this.updatePaintBuffers()}},{key:"destroy",value:function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Yo||e instanceof $o||e instanceof Ko)&&e.destroy()}}}]),t}(),Qo=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};d(this,t),this.programConfigurations={};var i,o=f(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.programConfigurations[a.id]=new Jo(a,n,r)}}catch(s){o.e(s)}finally{o.f()}this.needsUpload=!1,this._featureMap=new Oo,this._bufferOffset=0}return p(t,[{key:"populatePaintArrays",value:function(t,e,n,r,i,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,r,i,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}},{key:"updatePaintArrays",value:function(t,e,n,r){var i,o=f(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,r)||this.needsUpload}}catch(s){o.e(s)}finally{o.f()}}},{key:"get",value:function(t){return this.programConfigurations[t]}},{key:"upload",value:function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}},{key:"destroy",value:function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()}}]),t}();function ta(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function ea(t,e,n){var r={color:{source:Bi,composite:no},number:{source:Ki,composite:Bi}},i=function(t){return{"line-pattern":{source:xo,composite:xo},"fill-pattern":{source:xo,composite:xo},"fill-extrusion-pattern":{source:xo,composite:xo}}[t]}(t);return i&&i[n]||r[e][n]}jr("ConstantBinder",Xo),jr("CrossFadedConstantBinder",Ho),jr("SourceExpressionBinder",Yo),jr("CrossFadedCompositeBinder",Ko),jr("CompositeExpressionBinder",$o),jr("ProgramConfiguration",Jo,{omit:["_buffers"]}),jr("ProgramConfigurationSet",Qo);var na=8192,ra=Math.pow(2,14)-1,ia=-ra-1;function oa(t){for(var e=na/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=y(s,ia,ra),a.y=y(l,ia,ra),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&I("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function aa(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?oa(t):[]}}function sa(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var la=function(){function t(e){d(this,t),this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new mo,this.indexArray=new Co,this.segments=new Po,this.programConfigurations=new Qo(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}return p(t,[{key:"populate",value:function(t,e,n){var r=this.layers[0],i=[],o=null,a=!1;"circle"===r.type&&(a=!(o=r.layout.get("circle-sort-key")).isConstant());var s,l=f(t);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.feature,h=u.id,p=u.index,d=u.sourceLayerIndex,m=this.layers[0]._featureFilter.needGeometry,g=aa(c,m);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),g,n)){var v=a?o.evaluate(g,{},n):void 0,y={id:h,properties:c.properties,type:c.type,sourceLayerIndex:d,index:p,geometry:m?g.geometry:oa(c),patterns:{},sortKey:v};i.push(y)}}}catch(C){l.e(C)}finally{l.f()}a&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var _=0,x=i;_<x.length;_++){var b=x[_],w=b.geometry,S=b.index,E=b.sourceLayerIndex,k=t[S].feature;this.addFeature(b,w,S,n),e.featureIndex.insert(k,w,S,E,this.index)}}},{key:"update",value:function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,To),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"addFeature",value:function(t,e,n,r){var i,o=f(e);try{for(o.s();!(i=o.n()).done;){var a,s=i.value,l=f(s);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=u.x,h=u.y;if(!(c<0||c>=na||h<0||h>=na)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),d=p.vertexLength;sa(this.layoutVertexArray,c,h,-1,-1),sa(this.layoutVertexArray,c,h,1,-1),sa(this.layoutVertexArray,c,h,1,1),sa(this.layoutVertexArray,c,h,-1,1),this.indexArray.emplaceBack(d,d+1,d+2),this.indexArray.emplaceBack(d,d+3,d+2),p.vertexLength+=4,p.primitiveLength+=2}}}catch(m){l.e(m)}finally{l.f()}}}catch(m){o.e(m)}finally{o.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r)}}]),t}();function ua(t,e){for(var n=0;n<t.length;n++)if(ya(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(ya(t,e[r]))return!0;return!!pa(t,e)}function ca(t,e,n){return!!ya(t,e)||!!ma(e,t,n)}function ha(t,e){if(1===t.length)return va(e,t[0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if(ya(t,r[i]))return!0;for(var o=0;o<t.length;o++)if(va(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(pa(t,e[a]))return!0;return!1}function fa(t,e,n){if(t.length>1){if(pa(t,e))return!0;for(var r=0;r<e.length;r++)if(ma(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(ma(t[i],e,n))return!0;return!1}function pa(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],o=0;o<e.length-1;o++)if(da(r,i,e[o],e[o+1]))return!0;return!1}function da(t,e,n,r){return T(t,n,r)!==T(e,n,r)&&T(t,e,n)!==T(t,e,r)}function ma(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(ga(t,e[i-1],e[i])<r)return!0;return!1}function ga(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(i<0?e:i>1?n:n.sub(e)._mult(i)._add(e))}function va(t,e){for(var n,r,i,o=!1,a=0;a<t.length;a++)for(var s=0,l=(n=t[a]).length-1;s<n.length;l=s++)r=n[s],i=n[l],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function ya(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function _a(t,e,n){var r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;var o=T(t,e,n[0]);return o!==T(t,e,n[1])||o!==T(t,e,n[2])||o!==T(t,e,n[3])}function xa(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function ba(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function wa(t,e,n,r,i){if(!e[0]&&!e[1])return t;var o=F.convert(e)._mult(i);"viewport"===n&&o._rotate(-r);for(var a=[],s=0;s<t.length;s++)a.push(t[s].sub(o));return a}jr("CircleBucket",la,{omit:["layers"]});var Sa=new Ii({"circle-sort-key":new Si(gt.layout_circle["circle-sort-key"])}),Ea={paint:new Ii({"circle-radius":new Si(gt.paint_circle["circle-radius"]),"circle-color":new Si(gt.paint_circle["circle-color"]),"circle-blur":new Si(gt.paint_circle["circle-blur"]),"circle-opacity":new Si(gt.paint_circle["circle-opacity"]),"circle-translate":new wi(gt.paint_circle["circle-translate"]),"circle-translate-anchor":new wi(gt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wi(gt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wi(gt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Si(gt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Si(gt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Si(gt.paint_circle["circle-stroke-opacity"])}),layout:Sa},ka=1e-6,Ca="undefined"!=typeof Float32Array?Float32Array:Array;function Ia(){var t=new Ca(9);return Ca!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ta(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Pa(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*r+x*s+b*h+w*m,t[1]=_*i+x*l+b*f+w*g,t[2]=_*o+x*u+b*p+w*v,t[3]=_*a+x*c+b*d+w*y,t[4]=(_=n[4])*r+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,t[5]=_*i+x*l+b*f+w*g,t[6]=_*o+x*u+b*p+w*v,t[7]=_*a+x*c+b*d+w*y,t[8]=(_=n[8])*r+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,t[9]=_*i+x*l+b*f+w*g,t[10]=_*o+x*u+b*p+w*v,t[11]=_*a+x*c+b*d+w*y,t[12]=(_=n[12])*r+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,t[13]=_*i+x*l+b*f+w*g,t[14]=_*o+x*u+b*p+w*v,t[15]=_*a+x*c+b*d+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Aa,Ma=Pa;function La(){var t=new Ca(3);return Ca!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ra(t,e,n){var r=new Ca(3);return r[0]=t,r[1]=e,r[2]=n,r}function Da(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function Na(){var t=new Ca(4);return Ca!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function za(t,e){var n=Da([],[t.x,t.y,0,1],e);return new F(n[0]/n[3],n[1]/n[3])}La(),Aa=new Ca(4),Ca!=Float32Array&&(Aa[0]=0,Aa[1]=0,Aa[2]=0,Aa[3]=0),La(),Ra(1,0,0),Ra(0,1,0),Na(),Na(),Ia(),function(){var t;t=new Ca(2),Ca!=Float32Array&&(t[0]=0,t[1]=0)}();var Oa=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(la);jr("HeatmapBucket",Oa,{omit:["layers"]});var Fa={paint:new Ii({"heatmap-radius":new Si(gt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Si(gt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wi(gt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ci(gt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wi(gt.paint_heatmap["heatmap-opacity"])})};function Ba(t,e,n,r){var i=e.width,o=e.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*o*n)throw new RangeError("mismatched image size. expected: ".concat(r.length," but got: ").concat(i*o*n))}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function ja(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=Ba({},{width:r,height:i},n);Ua(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}function Ua(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");var a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(var l=0;l<i.height;l++)for(var u=((n.y+l)*t.width+n.x)*o,c=((r.y+l)*e.width+r.x)*o,h=0;h<i.width*o;h++)s[c+h]=a[u+h];return e}var Va=function(){function t(e,n){d(this,t),Ba(this,e,1,n)}return p(t,[{key:"resize",value:function(t){ja(this,t,1)}},{key:"clone",value:function(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(t,e,n,r,i){Ua(t,e,n,r,i,1)}}]),t}(),Za=function(){function t(e,n){d(this,t),Ba(this,e,4,n)}return p(t,[{key:"resize",value:function(t){ja(this,t,4)}},{key:"replace",value:function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}},{key:"clone",value:function(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(t,e,n,r,i){Ua(t,e,n,r,i,4)}}]),t}();function qa(t){var e={},n=t.resolution||256,r=t.clips?t.clips.length:1,i=t.image||new Za({width:n,height:r});if(Math.log(n)/Math.LN2%1!=0)throw new Error("width is not a power of 2 - ".concat(n));var o=function(n,r,o){e[t.evaluationKey]=o;var a=t.expression.evaluate(e);i.data[n+r+0]=Math.floor(255*a.r/a.a),i.data[n+r+1]=Math.floor(255*a.g/a.a),i.data[n+r+2]=Math.floor(255*a.b/a.a),i.data[n+r+3]=Math.floor(255*a.a)};if(t.clips)for(var a=0,s=0;a<r;++a,s+=4*n)for(var l=0,u=0;l<n;l++,u+=4){var c=l/(n-1),h=t.clips[a];o(s,u,h.start*(1-c)+h.end*c)}else for(var f=0,p=0;f<n;f++,p+=4)o(0,p,f/(n-1));return i}jr("AlphaImage",Va),jr("RGBAImage",Za);var Ga={paint:new Ii({"hillshade-illumination-direction":new wi(gt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wi(gt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wi(gt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wi(gt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wi(gt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wi(gt.paint_hillshade["hillshade-accent-color"])})},Wa=Ri([{name:"a_pos",components:2,type:"Int16"}],4).members,Xa={exports:{}};function Ha(t,e,n){n=n||2;var r,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,f=Ya(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;if(c&&(f=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Ya(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(as(a));for(s.sort(ns),i=0;i<s.length;i++)n=rs(s[i],n);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(l=t[d+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-i))?32767/u:0}return Ka(f,p,n,r,i,u,0),p}function Ya(t,e,n,r,i){var o,a;if(i===_s(t,e,n,r)>0)for(o=e;o<n;o+=r)a=gs(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=gs(o,t[o],t[o+1],a);return a&&cs(a,a.next)&&(vs(a),a=a.next),a}function $a(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!cs(r,r.next)&&0!==us(r.prev,r,r.next))r=r.next;else{if(vs(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ka(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=os(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,r,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Qa(t,r,i,o):Ja(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),vs(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?Ka(t=ts($a(t),e,n),e,n,r,i,o,2):2===a&&es(t,e,n,r,i,o):Ka($a(t),e,n,r,i,o,1);break}}}function Ja(t){var e=t.prev,n=t,r=t.next;if(us(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,l=n.y,u=r.y,c=i<o?i<a?i:a:o<a?o:a,h=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,p=s>l?s>u?s:u:l>u?l:u,d=r.next;d!==e;){if(d.x>=c&&d.x<=f&&d.y>=h&&d.y<=p&&ss(i,s,o,l,a,u,d.x,d.y)&&us(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function Qa(t,e,n,r){var i=t.prev,o=t,a=t.next;if(us(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,h=o.y,f=a.y,p=s<l?s<u?s:u:l<u?l:u,d=c<h?c<f?c:f:h<f?h:f,m=s>l?s>u?s:u:l>u?l:u,g=c>h?c>f?c:f:h>f?h:f,v=os(p,d,e,n,r),y=os(m,g,e,n,r),_=t.prevZ,x=t.nextZ;_&&_.z>=v&&x&&x.z<=y;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&ss(s,c,l,h,u,f,_.x,_.y)&&us(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&ss(s,c,l,h,u,f,x.x,x.y)&&us(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&ss(s,c,l,h,u,f,_.x,_.y)&&us(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&ss(s,c,l,h,u,f,x.x,x.y)&&us(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function ts(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!cs(i,o)&&hs(i,r,r.next,o)&&ds(i,o)&&ds(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),vs(r),vs(r.next),r=t=o),r=r.next}while(r!==t);return $a(r)}function es(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ls(a,s)){var l=ms(a,s);return a=$a(a,a.next),l=$a(l,l.next),Ka(a,e,n,r,i,o,0),void Ka(l,e,n,r,i,o,0)}s=s.next}a=a.next}while(a!==t)}function ns(t,e){return t.x-e.x}function rs(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,u=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&ss(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),ds(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&is(n,r)))&&(n=r,f=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var r=ms(n,t);return $a(r,r.next),$a(n,n.next)}function is(t,e){return us(t.prev,t,e.prev)<0&&us(e.next,t,t.next)<0}function os(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function as(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ss(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function ls(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&hs(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(ds(t,e)&&ds(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(us(t.prev,t,e.prev)||us(t,e.prev,e))||cs(t,e)&&us(t.prev,t,t.next)>0&&us(e.prev,e,e.next)>0)}function us(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function cs(t,e){return t.x===e.x&&t.y===e.y}function hs(t,e,n,r){var i=ps(us(t,e,n)),o=ps(us(t,e,r)),a=ps(us(n,r,t)),s=ps(us(n,r,e));return i!==o&&a!==s||!(0!==i||!fs(t,n,e))||!(0!==o||!fs(t,r,e))||!(0!==a||!fs(n,t,r))||!(0!==s||!fs(n,e,r))}function fs(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function ps(t){return t>0?1:t<0?-1:0}function ds(t,e){return us(t.prev,t,t.next)<0?us(t,e,t.next)>=0&&us(t,t.prev,e)>=0:us(t,e,t.prev)<0||us(t,t.next,e)<0}function ms(t,e){var n=new ys(t.i,t.x,t.y),r=new ys(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function gs(t,e,n,r){var i=new ys(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function vs(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ys(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _s(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function xs(t,e,n,r,i){bs(t,e,n||0,r||t.length-1,i||Ss)}function bs(t,e,n,r,i){for(;r>n;){if(r-n>600){var o=r-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);bs(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(r,Math.floor(e+(o-a)*l/o+u)),i)}var c=t[e],h=n,f=r;for(ws(t,n,e),i(t[r],c)>0&&ws(t,n,r);h<f;){for(ws(t,h,f),h++,f--;i(t[h],c)<0;)h++;for(;i(t[f],c)>0;)f--}0===i(t[n],c)?ws(t,n,f):ws(t,++f,r),f<=e&&(n=f+1),e<=f&&(r=f-1)}}function ws(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Ss(t,e){return t<e?-1:t>e?1:0}function Es(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,o=[],a=0;a<n;a++){var s=P(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[t[a]]):r.push(t[a]))}if(r&&o.push(r),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(xs(o[l],e,1,o[l].length-1,ks),o[l]=o[l].slice(0,e));return o}function ks(t,e){return e.area-t.area}function Cs(t,e,n){var r,i=n.patternDependencies,o=!1,a=f(e);try{for(a.s();!(r=a.n()).done;){var s=r.value.paint.get("".concat(t,"-pattern"));s.isConstant()||(o=!0);var l=s.constantOr(null);l&&(o=!0,i[l.to]=!0,i[l.from]=!0)}}catch(u){a.e(u)}finally{a.f()}return o}function Is(t,e,n,r,i){var o,a=i.patternDependencies,s=f(e);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=l.paint.get("".concat(t,"-pattern")).value;if("constant"!==u.kind){var c=u.evaluate({zoom:r-1},n,{},i.availableImages),h=u.evaluate({zoom:r},n,{},i.availableImages),p=u.evaluate({zoom:r+1},n,{},i.availableImages);c=c&&c.name?c.name:c,h=h&&h.name?h.name:h,p=p&&p.name?p.name:p,a[c]=!0,a[h]=!0,a[p]=!0,n.patterns[l.id]={min:c,mid:h,max:p}}}}catch(d){s.e(d)}finally{s.f()}return n}Xa.exports=Ha,Xa.exports.default=Ha,Ha.deviation=function(t,e,n,r){var i=e&&e.length,o=Math.abs(_s(t,0,i?e[0]*n:t.length,n));if(i)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(_s(t,e[a]*n,a<s-1?e[a+1]*n:t.length,n));var l=0;for(a=0;a<r.length;a+=3){var u=r[a]*n,c=r[a+1]*n,h=r[a+2]*n;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Ha.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&n.holes.push(r+=t[i-1].length)}return n};var Ts=function(){function t(e){d(this,t),this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new go,this.indexArray=new Co,this.indexArray2=new Io,this.programConfigurations=new Qo(e.layers,e.zoom),this.segments=new Po,this.segments2=new Po,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}return p(t,[{key:"populate",value:function(t,e,n){this.hasPattern=Cs("fill",this.layers,e);var r,i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[],s=f(t);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,p=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,m=aa(u,d);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),m,n)){var g=o?i.evaluate(m,{},n,e.availableImages):void 0,v={id:c,properties:u.properties,type:u.type,sourceLayerIndex:p,index:h,geometry:d?m.geometry:oa(u),patterns:{},sortKey:g};a.push(v)}}}catch(k){s.e(k)}finally{s.f()}o&&a.sort((function(t,e){return t.sortKey-e.sortKey}));for(var y=0,_=a;y<_.length;y++){var x=_[y],b=x.geometry,w=x.index,S=x.sourceLayerIndex;if(this.hasPattern){var E=Is("fill",this.layers,x,this.zoom,e);this.patternFeatures.push(E)}else this.addFeature(x,b,w,n,{});e.featureIndex.insert(t[w].feature,b,w,S,this.index)}}},{key:"update",value:function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}},{key:"addFeatures",value:function(t,e,n){var r,i=f(this.patternFeatures);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.addFeature(o,o.geometry,o.index,e,n)}}catch(a){i.e(a)}finally{i.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Wa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}},{key:"addFeature",value:function(t,e,n,r,i){var o,a=f(Es(e,500));try{for(a.s();!(o=a.n()).done;){var s,l=o.value,u=0,c=f(l);try{for(c.s();!(s=c.n()).done;)u+=s.value.length}catch(E){c.e(E)}finally{c.f()}var h,p=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),d=p.vertexLength,m=[],g=[],v=f(l);try{for(v.s();!(h=v.n()).done;){var y=h.value;if(0!==y.length){y!==l[0]&&g.push(m.length/2);var _=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),x=_.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(x+y.length-1,x),m.push(y[0].x),m.push(y[0].y);for(var b=1;b<y.length;b++)this.layoutVertexArray.emplaceBack(y[b].x,y[b].y),this.indexArray2.emplaceBack(x+b-1,x+b),m.push(y[b].x),m.push(y[b].y);_.vertexLength+=y.length,_.primitiveLength+=y.length}}}catch(E){v.e(E)}finally{v.f()}for(var w=Xa.exports(m,g),S=0;S<w.length;S+=3)this.indexArray.emplaceBack(d+w[S],d+w[S+1],d+w[S+2]);p.vertexLength+=u,p.primitiveLength+=w.length/3}}catch(E){a.e(E)}finally{a.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}}]),t}();jr("FillBucket",Ts,{omit:["layers","patternFeatures"]});var Ps=new Ii({"fill-sort-key":new Si(gt.layout_fill["fill-sort-key"])}),As={paint:new Ii({"fill-antialias":new wi(gt.paint_fill["fill-antialias"]),"fill-opacity":new Si(gt.paint_fill["fill-opacity"]),"fill-color":new Si(gt.paint_fill["fill-color"]),"fill-outline-color":new Si(gt.paint_fill["fill-outline-color"]),"fill-translate":new wi(gt.paint_fill["fill-translate"]),"fill-translate-anchor":new wi(gt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ei(gt.paint_fill["fill-pattern"])}),layout:Ps},Ms=Ri([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ls=Ri([{name:"a_centroid",components:2,type:"Int16"}],4),Rs=Ms.members,Ds={},Ns=F,zs=Os;function Os(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(Fs,this,e)}function Fs(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Bs(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)r+=((n=t[a]).x-(e=t[i]).x)*(e.y+n.y);return r}Os.types=["Unknown","Point","LineString","Polygon"],Os.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,i=0,o=0,a=0,s=[];t.pos<n;){if(i<=0){var l=t.readVarint();r=7&l,i=l>>3}if(i--,1===r||2===r)o+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e.push(new Ns(o,a));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&s.push(e),s},Os.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,u]},Os.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=Os.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<l.length;r++)h[r]=l[r][0];c(l=h);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=Bs(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)c(l[r][i])}1===l.length?l=l[0]:u="Multi"+u;var f={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(f.id=this.id),f};var js=zs,Us=Vs;function Vs(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Zs,this,e),this.length=this._features.length}function Zs(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}Vs.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new js(this._pbf,e,this.extent,this._keys,this._values)};var qs=Us;function Gs(t,e,n){if(3===t){var r=new qs(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}Ds.VectorTile=function(t,e){this.layers=t.readFields(Gs,{},e)},Ds.VectorTileFeature=zs,Ds.VectorTileLayer=Us;var Ws=Ds.VectorTileFeature.types,Xs=Math.pow(2,13);function Hs(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*Xs)+a,i*Xs*2,o*Xs*2,Math.round(s))}var Ys=function(){function t(e){d(this,t),this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new vo,this.centroidVertexArray=new po,this.indexArray=new Co,this.programConfigurations=new Qo(e.layers,e.zoom),this.segments=new Po,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}return p(t,[{key:"populate",value:function(t,e,n){this.features=[],this.hasPattern=Cs("fill-extrusion",this.layers,e);var r,i=f(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.feature,s=o.id,l=o.index,u=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,h=aa(a,c);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),h,n)){var p={id:s,sourceLayerIndex:u,index:l,geometry:c?h.geometry:oa(a),properties:a.properties,type:a.type,patterns:{}};this.hasPattern?this.features.push(Is("fill-extrusion",this.layers,p,this.zoom,e)):this.addFeature(p,p.geometry,l,n,{}),e.featureIndex.insert(a,p.geometry,l,u,this.index,!0)}}}catch(d){i.e(d)}finally{i.f()}}},{key:"addFeatures",value:function(t,e,n){var r,i=f(this.features);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.geometry;this.addFeature(o,a,o.index,e,n)}}catch(s){i.e(s)}finally{i.f()}}},{key:"update",value:function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Rs),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ls.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}},{key:"addFeature",value:function(t,e,n,r,i){var o,a={x:0,y:0,vertexCount:0},s=f(Es(e,500));try{for(s.s();!(o=s.n()).done;){var l,u=o.value,c=0,h=f(u);try{for(h.s();!(l=h.n()).done;)c+=l.value.length}catch(N){h.e(N)}finally{h.f()}var p,d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),m=f(u);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(0!==g.length&&!Ks(g))for(var v=0,y=0;y<g.length;y++){var _=g[y];if(y>=1){var x=g[y-1];if(!$s(_,x)){d.vertexLength+4>Po.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var b=_.sub(x)._perp()._unit(),w=x.dist(_);v+w>32768&&(v=0),Hs(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,0,v),Hs(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,1,v),a.x+=2*_.x,a.y+=2*_.y,a.vertexCount+=2,v+=w,Hs(this.layoutVertexArray,x.x,x.y,b.x,b.y,0,0,v),Hs(this.layoutVertexArray,x.x,x.y,b.x,b.y,0,1,v),a.x+=2*x.x,a.y+=2*x.y,a.vertexCount+=2;var S=d.vertexLength;this.indexArray.emplaceBack(S,S+2,S+1),this.indexArray.emplaceBack(S+1,S+2,S+3),d.vertexLength+=4,d.primitiveLength+=2}}}}}catch(N){m.e(N)}finally{m.f()}if(d.vertexLength+c>Po.MAX_VERTEX_ARRAY_LENGTH&&(d=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray)),"Polygon"===Ws[t.type]){var E,k=[],C=[],I=d.vertexLength,T=f(u);try{for(T.s();!(E=T.n()).done;){var P=E.value;if(0!==P.length){P!==u[0]&&C.push(k.length/2);for(var A=0;A<P.length;A++){var M=P[A];Hs(this.layoutVertexArray,M.x,M.y,0,0,1,1,0),a.x+=M.x,a.y+=M.y,a.vertexCount+=1,k.push(M.x),k.push(M.y)}}}}catch(N){T.e(N)}finally{T.f()}for(var L=Xa.exports(k,C),R=0;R<L.length;R+=3)this.indexArray.emplaceBack(I+L[R],I+L[R+2],I+L[R+1]);d.primitiveLength+=L.length/3,d.vertexLength+=c}}}catch(N){s.e(N)}finally{s.f()}for(var D=0;D<a.vertexCount;D++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}}]),t}();function $s(t,e){return t.x===e.x&&(t.x<0||t.x>na)||t.y===e.y&&(t.y<0||t.y>na)}function Ks(t){return t.every((function(t){return t.x<0}))||t.every((function(t){return t.x>na}))||t.every((function(t){return t.y<0}))||t.every((function(t){return t.y>na}))}jr("FillExtrusionBucket",Ys,{omit:["layers","features"]});var Js={paint:new Ii({"fill-extrusion-opacity":new wi(gt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Si(gt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wi(gt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wi(gt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ei(gt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Si(gt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Si(gt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wi(gt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Qs(t,e){return t.x*e.x+t.y*e.y}function tl(t,e){if(1===t.length){for(var n,r=0,i=e[r++];!n||i.equals(n);)if(!(n=e[r++]))return 1/0;for(;r<e.length;r++){var o=e[r],a=t[0],s=n.sub(i),l=o.sub(i),u=a.sub(i),c=Qs(s,s),h=Qs(s,l),p=Qs(l,l),d=Qs(u,s),m=Qs(u,l),g=c*p-h*h,v=(p*d-h*m)/g,y=(c*m-h*d)/g,_=i.z*(1-v-y)+n.z*v+o.z*y;if(isFinite(_))return _}return 1/0}var x,b=1/0,w=f(e);try{for(w.s();!(x=w.n()).done;){var S=x.value;b=Math.min(b,S.z)}}catch(E){w.e(E)}finally{w.f()}return b}var el=Ri([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,nl=Ri([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,rl=Ds.VectorTileFeature.types,il=Math.cos(Math.PI/180*37.5),ol=Math.pow(2,14)/.5,al=function(){function t(e){var n=this;d(this,t),this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(t){n.gradients[t.id]={}})),this.layoutVertexArray=new yo,this.layoutVertexArray2=new _o,this.indexArray=new Co,this.programConfigurations=new Qo(e.layers,e.zoom),this.segments=new Po,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}return p(t,[{key:"populate",value:function(t,e,n){this.hasPattern=Cs("line",this.layers,e);var r,i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[],s=f(t);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,p=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,m=aa(u,d);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),m,n)){var g=o?i.evaluate(m,{},n):void 0,v={id:c,properties:u.properties,type:u.type,sourceLayerIndex:p,index:h,geometry:d?m.geometry:oa(u),patterns:{},sortKey:g};a.push(v)}}}catch(k){s.e(k)}finally{s.f()}o&&a.sort((function(t,e){return t.sortKey-e.sortKey}));for(var y=0,_=a;y<_.length;y++){var x=_[y],b=x.geometry,w=x.index,S=x.sourceLayerIndex;if(this.hasPattern){var E=Is("line",this.layers,x,this.zoom,e);this.patternFeatures.push(E)}else this.addFeature(x,b,w,n,{});e.featureIndex.insert(t[w].feature,b,w,S,this.index)}}},{key:"update",value:function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}},{key:"addFeatures",value:function(t,e,n){var r,i=f(this.patternFeatures);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.addFeature(o,o.geometry,o.index,e,n)}}catch(a){i.e(a)}finally{i.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,nl)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,el),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"lineFeatureClips",value:function(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}},{key:"addFeature",value:function(t,e,n,r,i){var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);var c,h=f(e);try{for(h.s();!(c=h.n()).done;){var p=c.value;this.addLine(p,t,a,s,l,u)}}catch(d){h.e(d)}finally{h.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}},{key:"addLine",value:function(t,e,n,r,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===rl[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var u=0;u<l-1&&t[u].equals(t[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===n&&(i=1.05);var c,h,f,p,d,m=this.overscaling<=16?122880/(512*this.overscaling):0,g=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,s&&(c=t[l-2],d=t[u].sub(c)._unit()._perp());for(var v=u;v<l;v++)if(!(f=v===l-1?s?t[u+1]:void 0:t[v+1])||!t[v].equals(f)){d&&(p=d),c&&(h=c),c=t[v],d=f?f.sub(c)._unit()._perp():p;var y=(p=p||d).add(d);0===y.x&&0===y.y||y._unit();var _=p.x*d.x+p.y*d.y,x=y.x*d.x+y.y*d.y,b=0!==x?1/x:1/0,w=2*Math.sqrt(2-2*x),S=x<il&&h&&f,E=p.x*d.y-p.y*d.x>0;if(S&&v>u){var k=c.dist(h);if(k>2*m){var C=c.sub(c.sub(h)._mult(m/k)._round());this.updateDistance(h,C),this.addCurrentVertex(C,p,0,0,g),h=C}}var I=h&&f,T=I?n:s?"butt":r;if(I&&"round"===T&&(b<o?T="miter":b<=2&&(T="fakeround")),"miter"===T&&b>i&&(T="bevel"),"bevel"===T&&(b>2&&(T="flipbevel"),b<i&&(T="miter")),h&&this.updateDistance(h,c),"miter"===T)y._mult(b),this.addCurrentVertex(c,y,0,0,g);else if("flipbevel"===T){if(b>100)y=d.mult(-1);else{var P=b*p.add(d).mag()/p.sub(d).mag();y._perp()._mult(P*(E?-1:1))}this.addCurrentVertex(c,y,0,0,g),this.addCurrentVertex(c,y.mult(-1),0,0,g)}else if("bevel"===T||"fakeround"===T){var A=-Math.sqrt(b*b-1),M=E?A:0,L=E?0:A;if(h&&this.addCurrentVertex(c,p,M,L,g),"fakeround"===T)for(var R=Math.round(180*w/Math.PI/20),D=1;D<R;D++){var N=D/R;if(.5!==N){var z=N-.5;N+=N*z*(N-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*z*z+(.848013+_*(.215638*_-1.06021)))}var O=d.sub(p)._mult(N)._add(p)._unit()._mult(E?-1:1);this.addHalfVertex(c,O.x,O.y,!1,E,0,g)}f&&this.addCurrentVertex(c,d,-M,-L,g)}else if("butt"===T)this.addCurrentVertex(c,y,0,0,g);else if("square"===T){var F=h?1:-1;this.addCurrentVertex(c,y,F,F,g)}else"round"===T&&(h&&(this.addCurrentVertex(c,p,0,0,g),this.addCurrentVertex(c,p,1,1,g,!0)),f&&(this.addCurrentVertex(c,d,-1,-1,g,!0),this.addCurrentVertex(c,d,0,0,g)));if(S&&v<l-1){var B=c.dist(f);if(B>2*m){var j=c.add(f.sub(c)._mult(m/B)._round());this.updateDistance(c,j),this.addCurrentVertex(j,d,0,0,g),c=j}}}}}},{key:"addCurrentVertex",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=e.y*r-e.x,s=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,i),this.addHalfVertex(t,a,s,o,!0,-r,i),this.distance>ol/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,r,i,o))}},{key:"addHalfVertex",value:function(t,e,n,r,i,o,a){var s=t.x,l=t.y,u=.5*(this.lineClips?this.scaledDistance*(ol-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(r?1:0),(l<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&u)<<2,u>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var c=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),a.primitiveLength++),i?this.e2=c:this.e1=c}},{key:"updateScaledDistance",value:function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}},{key:"updateDistance",value:function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}]),t}();jr("LineBucket",al,{omit:["layers","patternFeatures"]});var sl=new Ii({"line-cap":new wi(gt.layout_line["line-cap"]),"line-join":new Si(gt.layout_line["line-join"]),"line-miter-limit":new wi(gt.layout_line["line-miter-limit"]),"line-round-limit":new wi(gt.layout_line["line-round-limit"]),"line-sort-key":new Si(gt.layout_line["line-sort-key"])}),ll={paint:new Ii({"line-opacity":new Si(gt.paint_line["line-opacity"]),"line-color":new Si(gt.paint_line["line-color"]),"line-translate":new wi(gt.paint_line["line-translate"]),"line-translate-anchor":new wi(gt.paint_line["line-translate-anchor"]),"line-width":new Si(gt.paint_line["line-width"]),"line-gap-width":new Si(gt.paint_line["line-gap-width"]),"line-offset":new Si(gt.paint_line["line-offset"]),"line-blur":new Si(gt.paint_line["line-blur"]),"line-dasharray":new ki(gt.paint_line["line-dasharray"]),"line-pattern":new Ei(gt.paint_line["line-pattern"]),"line-gradient":new Ci(gt.paint_line["line-gradient"])}),layout:sl},ul=new(function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"possiblyEvaluate",value:function(t,e){return e=new pi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),a(s(n.prototype),"possiblyEvaluate",this).call(this,t,e)}},{key:"evaluate",value:function(t,e,r,i){return e=x({},e,{zoom:Math.floor(e.zoom)}),a(s(n.prototype),"evaluate",this).call(this,t,e,r,i)}}]),n}(Si))(ll.paint.properties["line-width"].specification);function cl(t,e){return e>0?e+2*t:t}ul.useIntegerZoom=!0;var hl=Ri([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fl=Ri([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ri([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var pl=Ri([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ri([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var dl=Ri([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ml=Ri([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gl(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),fi.applyArabicShaping&&(t=fi.applyArabicShaping(t)),t}(t.text,e,n)})),t}Ri([{name:"triangle",components:3,type:"Uint16"}]),Ri([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ri([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ri([{type:"Float32",name:"offsetX"}]),Ri([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var vl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},yl=24,_l=wl,xl=function(t,e,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},bl=function(t,e,n,r,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*m};function wl(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}wl.Varint=0,wl.Fixed64=1,wl.Bytes=2,wl.Fixed32=5;var Sl,El=4294967296,kl=1/El,Cl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Il(t){return t.type===wl.Bytes?t.readVarint()+t.pos:t.pos+1}function Tl(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Pl(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Al(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Ml(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Ll(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Rl(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Dl(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Nl(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function zl(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Ol(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Fl(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Bl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function jl(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ul(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Vl(t,e,n){1===t&&n.readMessage(Zl,e)}function Zl(t,e,n){if(3===t){var r=n.readMessage(ql,{}),i=r.id,o=r.bitmap,a=r.width,s=r.height,l=r.left,u=r.top,c=r.advance;e.push({id:i,bitmap:new Va({width:a+6,height:s+6},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function ql(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Gl(t){var e,n=0,r=0,i=f(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;n+=o.w*o.h,r=Math.max(r,o.w)}}catch(g){i.e(g)}finally{i.f()}t.sort((function(t,e){return e.h-t.h}));var a,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),r),h:1/0}],l=0,u=0,c=f(t);try{for(c.s();!(a=c.n()).done;)for(var h=a.value,p=s.length-1;p>=0;p--){var d=s[p];if(!(h.w>d.w||h.h>d.h)){if(h.x=d.x,h.y=d.y,u=Math.max(u,h.y+h.h),l=Math.max(l,h.x+h.w),h.w===d.w&&h.h===d.h){var m=s.pop();p<s.length&&(s[p]=m)}else h.h===d.h?(d.x+=h.w,d.w-=h.w):h.w===d.w?(d.y+=h.h,d.h-=h.h):(s.push({x:d.x+h.w,y:d.y,w:d.w-h.w,h:h.h}),d.y+=h.h,d.h-=h.h);break}}}catch(g){c.e(g)}finally{c.f()}return{w:l,h:u,fill:n/(l*u)||0}}wl.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Bl(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ul(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Bl(this.buf,this.pos)+Bl(this.buf,this.pos+4)*El;return this.pos+=8,t},readSFixed64:function(){var t=Bl(this.buf,this.pos)+Ul(this.buf,this.pos+4)*El;return this.pos+=8,t},readFloat:function(){var t=xl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=xl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return Tl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return Tl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return Tl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return Tl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return Tl(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return Tl(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Cl?function(t,e,n){return Cl.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(a=t[i+2],128==(192&(o=t[i+1]))&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=t[i+2],s=t[i+3],128==(192&(o=t[i+1]))&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==wl.Bytes)return t.push(this.readVarint(e));var n=Il(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==wl.Bytes)return t.push(this.readSVarint());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==wl.Bytes)return t.push(this.readBoolean());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==wl.Bytes)return t.push(this.readFloat());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==wl.Bytes)return t.push(this.readDouble());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==wl.Bytes)return t.push(this.readFixed32());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==wl.Bytes)return t.push(this.readSFixed32());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==wl.Bytes)return t.push(this.readFixed64());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==wl.Bytes)return t.push(this.readSFixed64());var e=Il(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===wl.Varint)for(;this.buf[this.pos++]>127;);else if(e===wl.Bytes)this.pos=this.readVarint()+this.pos;else if(e===wl.Fixed32)this.pos+=4;else{if(e!==wl.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),jl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),jl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),jl(this.buf,-1&t,this.pos),jl(this.buf,Math.floor(t*kl),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),jl(this.buf,-1&t,this.pos),jl(this.buf,Math.floor(t*kl),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Pl(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),bl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),bl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Pl(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,wl.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Al,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ml,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Dl,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Ll,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Rl,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Nl,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,zl,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Ol,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Fl,e)},writeBytesField:function(t,e){this.writeTag(t,wl.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,wl.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,wl.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,wl.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,wl.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,wl.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,wl.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,wl.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,wl.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,wl.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Wl=function(){function t(e,n){var r=n.pixelRatio,i=n.version,o=n.stretchX,a=n.stretchY,s=n.content;d(this,t),this.paddedRect=e,this.pixelRatio=r,this.stretchX=o,this.stretchY=a,this.content=s,this.version=i}return p(t,[{key:"tl",get:function(){return[this.paddedRect.x+1,this.paddedRect.y+1]}},{key:"br",get:function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}},{key:"tlbr",get:function(){return this.tl.concat(this.br)}},{key:"displaySize",get:function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}]),t}(),Xl=function(){function t(e,n){d(this,t);var r={},i={};this.haveRenderCallbacks=[];var o=[];this.addImages(e,r,o),this.addImages(n,i,o);var a=Gl(o),s=a.w,l=a.h,u=new Za({width:s||1,height:l||1});for(var c in e){var h=e[c],f=r[c].paddedRect;Za.copy(h.data,u,{x:0,y:0},{x:f.x+1,y:f.y+1},h.data)}for(var p in n){var m=n[p],g=i[p].paddedRect,v=g.x+1,y=g.y+1,_=m.data.width,x=m.data.height;Za.copy(m.data,u,{x:0,y:0},{x:v,y:y},m.data),Za.copy(m.data,u,{x:0,y:x-1},{x:v,y:y-1},{width:_,height:1}),Za.copy(m.data,u,{x:0,y:0},{x:v,y:y+x},{width:_,height:1}),Za.copy(m.data,u,{x:_-1,y:0},{x:v-1,y:y},{width:1,height:x}),Za.copy(m.data,u,{x:0,y:0},{x:v+_,y:y},{width:1,height:x})}this.image=u,this.iconPositions=r,this.patternPositions=i}return p(t,[{key:"addImages",value:function(t,e,n){for(var r in t){var i=t[r],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};n.push(o),e[r]=new Wl(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}},{key:"patchUpdatedImages",value:function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}},{key:"patchUpdatedImage",value:function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var r=h(t.tl,2),i=r[0],o=r[1];n.update(e.data,void 0,{x:i,y:o})}}}]),t}();jr("ImagePosition",Wl),jr("ImageAtlas",Xl),t.WritingMode=void 0,(Sl=t.WritingMode||(t.WritingMode={}))[Sl.none=0]="none",Sl[Sl.horizontal=1]="horizontal",Sl[Sl.vertical=2]="vertical",Sl[Sl.horizontalOnly=3]="horizontalOnly";var Hl=-17,Yl=function(){function t(){d(this,t),this.scale=1,this.fontStack="",this.imageName=null}return p(t,null,[{key:"forText",value:function(e,n){var r=new t;return r.scale=e||1,r.fontStack=n,r}},{key:"forImage",value:function(e){var n=new t;return n.imageName=e,n}}]),t}(),$l=function(){function t(){d(this,t),this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}return p(t,[{key:"length",value:function(){return this.text.length}},{key:"getSection",value:function(t){return this.sections[this.sectionIndex[t]]}},{key:"getSectionIndex",value:function(t){return this.sectionIndex[t]}},{key:"getCharCode",value:function(t){return this.text.charCodeAt(t)}},{key:"verticalizePunctuation",value:function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;e+=r&&Kr(r)&&!vl[t[n+1]]||i&&Kr(i)&&!vl[t[n-1]]||!vl[t[n]]?t[n]:vl[t[n]]}return e}(this.text)}},{key:"trim",value:function(){for(var t=0,e=0;e<this.text.length&&Jl[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&Jl[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}},{key:"substring",value:function(e,n){var r=new t;return r.text=this.text.substring(e,n),r.sectionIndex=this.sectionIndex.slice(e,n),r.sections=this.sections,r}},{key:"toString",value:function(){return this.text}},{key:"getMaxScale",value:function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)}},{key:"addTextSection",value:function(t,e){this.text+=t.text,this.sections.push(Yl.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,r=0;r<t.text.length;++r)this.sectionIndex.push(n)}},{key:"addImageSection",value:function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Yl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):I("Reached maximum number of images 6401")}else I("Can't add FormattedSection with an empty image.")}},{key:"getNextImageSectionCharCode",value:function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}],[{key:"fromFeature",value:function(e,n){for(var r=new t,i=0;i<e.sections.length;i++){var o=e.sections[i];o.image?r.addImageSection(o):r.addTextSection(o,n)}return r}}]),t}();function Kl(e,n,r,i,o,a,s,l,u,c,h,p,d,m,g,v){var y,_=$l.fromFeature(e,o);p===t.WritingMode.vertical&&_.verticalizePunctuation();var x=fi.processBidirectionalText,b=fi.processStyledBidirectionalText;if(x&&1===_.sections.length){y=[];var w,S=x(_.toString(),ou(_,c,a,n,i,m,g)),E=f(S);try{for(E.s();!(w=E.n()).done;){var k=w.value,C=new $l;C.text=k,C.sections=_.sections;for(var I=0;I<k.length;I++)C.sectionIndex.push(0);y.push(C)}}catch(N){E.e(N)}finally{E.f()}}else if(b){y=[];var T,P=b(_.text,_.sectionIndex,ou(_,c,a,n,i,m,g)),A=f(P);try{for(A.s();!(T=A.n()).done;){var M=T.value,L=new $l;L.text=M[0],L.sectionIndex=M[1],L.sections=_.sections,y.push(L)}}catch(N){A.e(N)}finally{A.f()}}else y=function(t,e){var n,r=[],i=t.text,o=0,a=f(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;r.push(t.substring(o,s)),o=s}}catch(N){a.e(N)}finally{a.f()}return o<i.length&&r.push(t.substring(o,i.length)),r}(_,ou(_,c,a,n,i,m,g));var R=[],D={positionedLines:R,text:_.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(e,n,r,i,o,a,s,l,u,c,h,p){var d,m,g=0,v=Hl,y=0,_=0,x="right"===l?1:"left"===l?0:.5,b=0,w=f(o);try{for(w.s();!(d=w.n()).done;){var S=d.value;S.trim();var E=S.getMaxScale(),k=(E-1)*yl,C={positionedGlyphs:[],lineOffset:0};e.positionedLines[b]=C;var I=C.positionedGlyphs,T=0;if(S.length()){for(var P=0;P<S.length();P++){var A=S.getSection(P),M=S.getSectionIndex(P),L=S.getCharCode(P),R=0,D=null,z=null,O=null,F=yl,B=!(u===t.WritingMode.horizontal||!h&&!$r(L)||h&&(Jl[L]||(m=L,Wr.Arabic(m)||Wr["Arabic Supplement"](m)||Wr["Arabic Extended-A"](m)||Wr["Arabic Presentation Forms-A"](m)||Wr["Arabic Presentation Forms-B"](m))));if(A.imageName){var j=i[A.imageName];if(!j)continue;O=A.imageName,e.iconsInText=e.iconsInText||!0,z=j.paddedRect;var U=j.displaySize;A.scale=A.scale*yl/p,D={width:U[0],height:U[1],left:1,top:-3,advance:B?U[1]:U[0]},R=k+(yl-U[1]*A.scale),F=D.advance;var V=B?U[0]*A.scale-yl*E:U[1]*A.scale-yl*E;V>0&&V>T&&(T=V)}else{var Z=r[A.fontStack],q=Z&&Z[L];if(q&&q.rect)z=q.rect,D=q.metrics;else{var G=n[A.fontStack],W=G&&G[L];if(!W)continue;D=W.metrics}R=(E-A.scale)*yl}B?(e.verticalizable=!0,I.push({glyph:L,imageName:O,x:g,y:v+R,vertical:B,scale:A.scale,fontStack:A.fontStack,sectionIndex:M,metrics:D,rect:z}),g+=F*A.scale+c):(I.push({glyph:L,imageName:O,x:g,y:v+R,vertical:B,scale:A.scale,fontStack:A.fontStack,sectionIndex:M,metrics:D,rect:z}),g+=D.advance*A.scale+c)}0!==I.length&&(y=Math.max(g-c,y),su(I,0,I.length-1,x,T)),g=0;var X=a*E+T;C.lineOffset=Math.max(T,k),v+=X,_=Math.max(X,_),++b}else v+=a,++b}}catch(N){w.e(N)}finally{w.f()}var H=v-Hl,Y=au(s),$=Y.horizontalAlign,K=Y.verticalAlign;(function(t,e,n,r,i,o,a,s,l){var u=(e-n)*i,c=0;c=o!==a?-s*r-Hl:(-r*l+.5)*a;var h,p=f(t);try{for(p.s();!(h=p.n()).done;){var d,m=h.value,g=f(m.positionedGlyphs);try{for(g.s();!(d=g.n()).done;){var v=d.value;v.x+=u,v.y+=c}}catch(N){g.e(N)}finally{g.f()}}}catch(N){p.e(N)}finally{p.f()}})(e.positionedLines,x,$,K,y,_,a,H,o.length),e.top+=-K*H,e.bottom=e.top+H,e.left+=-$*y,e.right=e.left+y}(D,n,r,i,y,s,l,u,p,c,d,v),!function(t){var e,n=f(t);try{for(n.s();!(e=n.n()).done;)if(0!==e.value.positionedGlyphs.length)return!1}catch(N){n.e(N)}finally{n.f()}return!0}(R)&&D}var Jl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ql={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tu(t,e,n,r,i,o){if(e.imageName){var a=r[e.imageName];return a?a.displaySize[0]*e.scale*yl/o+i:0}var s=n[e.fontStack],l=s&&s[t];return l?l.metrics.advance*e.scale+i:0}function eu(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function nu(t,e,n){var r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function ru(t,e,n,r,i,o){var a,s=null,l=eu(e,n,i,o),u=f(r);try{for(u.s();!(a=u.n()).done;){var c=a.value,h=eu(e-c.x,n,i,o)+c.badness;h<=l&&(s=c,l=h)}}catch(p){u.e(p)}finally{u.f()}return{index:t,x:e,priorBreak:s,badness:l}}function iu(t){return t?iu(t.priorBreak).concat(t.index):[]}function ou(t,e,n,r,i,o,a){if("point"!==o)return[];if(!t)return[];for(var s,l=[],u=function(t,e,n,r,i,o){for(var a=0,s=0;s<t.length();s++){var l=t.getSection(s);a+=tu(t.getCharCode(s),l,r,i,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,r,i,a),c=t.text.indexOf("\u200b")>=0,h=0,f=0;f<t.length();f++){var p=t.getSection(f),d=t.getCharCode(f);if(Jl[d]||(h+=tu(d,p,r,i,e,a)),f<t.length()-1){var m=!((s=d)<11904||!(Wr["Bopomofo Extended"](s)||Wr.Bopomofo(s)||Wr["CJK Compatibility Forms"](s)||Wr["CJK Compatibility Ideographs"](s)||Wr["CJK Compatibility"](s)||Wr["CJK Radicals Supplement"](s)||Wr["CJK Strokes"](s)||Wr["CJK Symbols and Punctuation"](s)||Wr["CJK Unified Ideographs Extension A"](s)||Wr["CJK Unified Ideographs"](s)||Wr["Enclosed CJK Letters and Months"](s)||Wr["Halfwidth and Fullwidth Forms"](s)||Wr.Hiragana(s)||Wr["Ideographic Description Characters"](s)||Wr["Kangxi Radicals"](s)||Wr["Katakana Phonetic Extensions"](s)||Wr.Katakana(s)||Wr["Vertical Forms"](s)||Wr["Yi Radicals"](s)||Wr["Yi Syllables"](s)));(Ql[d]||m||p.imageName)&&l.push(ru(f+1,h,u,l,nu(d,t.getCharCode(f+1),m&&c),!1))}}return iu(ru(t.length(),h,u,l,0,!0))}function au(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function su(t,e,n,r,i){if(r||i)for(var o=t[n],a=(t[n].x+o.metrics.advance*o.scale)*r,s=e;s<=n;s++)t[s].x-=a,t[s].y+=i}function lu(t,e,n){var r=au(n),i=r.horizontalAlign,o=r.verticalAlign,a=e[0]-t.displaySize[0]*i,s=e[1]-t.displaySize[1]*o;return{image:t,top:s,bottom:s+t.displaySize[1],left:a,right:a+t.displaySize[0]}}function uu(t,e,n,r,i,o){var a,s=t.image;if(s.content){var l=s.content,u=s.pixelRatio||1;a=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,h,f,p,d=e.left*o,m=e.right*o;"width"===n||"both"===n?(p=i[0]+d-r[3],h=i[0]+m+r[1]):h=(p=i[0]+(d+m-s.displaySize[0])/2)+s.displaySize[0];var g=e.top*o,v=e.bottom*o;return"height"===n||"both"===n?(c=i[1]+g-r[0],f=i[1]+v+r[2]):f=(c=i[1]+(g+v-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:h,bottom:f,left:p,collisionPadding:a}}var cu=128;function hu(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new pi(t+1))};if("source"===n.kind)return{kind:"source"};for(var r=n.zoomStops,i=n.interpolationType,o=0;o<r.length&&r[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<r.length&&r[a]<t+1;)a++;a=Math.min(r.length-1,a);var s=r[o],l=r[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:l,minSize:n.evaluate(new pi(s)),maxSize:n.evaluate(new pi(l)),interpolationType:i}}var fu=function(t){m(n,t);var e=g(n);function n(t,r,i,o){var a;return d(this,n),(a=e.call(this,t,r)).angle=i,void 0!==o&&(a.segment=o),a}return p(n,[{key:"clone",value:function(){return new n(this.x,this.y,this.angle,this.segment)}}]),n}(F);function pu(t,e,n,r,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<n/2;){var c=t[a],h=t[a+1];if(!h)return!1;var f=t[a-1].angleTo(c)-c.angleTo(h);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:f}),u+=f;s-l[0].distance>r;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=c.dist(h)}return!0}function du(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function mu(t,e,n){return t?.6*e*n:0}function gu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function vu(t,e,n,r,i,o){for(var a=mu(n,i,o),s=gu(n,r)*o,l=0,u=du(t)/2,c=0;c<t.length-1;c++){var h=t[c],f=t[c+1],p=h.dist(f);if(l+p>u){var d=(u-l)/p,m=Fe(h.x,f.x,d),g=Fe(h.y,f.y,d),v=new fu(m,g,f.angleTo(h),c);return v._round(),!a||pu(t,v,s,a,e)?v:void 0}l+=p}}function yu(t,e,n,r,i,o,a,s,l){var u=mu(r,o,a),c=gu(r,i),h=c*a,f=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),_u(t,f?e/2*s%e:(c/2+2*o)*a*s%e,e,u,n,h,f,!1,l)}function _u(t,e,n,r,i,o,a,s,l){for(var u=o/2,c=du(t),h=0,f=e-n,p=[],d=0;d<t.length-1;d++){for(var m=t[d],g=t[d+1],v=m.dist(g),y=g.angleTo(m);f+n<h+v;){var _=((f+=n)-h)/v,x=Fe(m.x,g.x,_),b=Fe(m.y,g.y,_);if(x>=0&&x<l&&b>=0&&b<l&&f-u>=0&&f+u<=c){var w=new fu(x,b,y,d);w._round(),r&&!pu(t,w,o,r,i)||p.push(w)}}h+=v}return s||p.length||a||(p=_u(t,h/2,n,r,i,o,a,!0,l)),p}function xu(t,e,n,r,i){for(var o=[],a=0;a<t.length;a++)for(var s=t[a],l=void 0,u=0;u<s.length-1;u++){var c=s[u],h=s[u+1];c.x<e&&h.x<e||(c.x<e?c=new F(e,c.y+(e-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x<e&&(h=new F(e,c.y+(e-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y<n&&h.y<n||(c.y<n?c=new F(c.x+(n-c.y)/(h.y-c.y)*(h.x-c.x),n)._round():h.y<n&&(h=new F(c.x+(n-c.y)/(h.y-c.y)*(h.x-c.x),n)._round()),c.x>=r&&h.x>=r||(c.x>=r?c=new F(r,c.y+(r-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x>=r&&(h=new F(r,c.y+(r-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y>=i&&h.y>=i||(c.y>=i?c=new F(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round():h.y>=i&&(h=new F(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round()),l&&c.equals(l[l.length-1])||(l=[c],o.push(l)),l.push(h)))))}return o}function bu(t,e,n,r){var i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2,l=o.paddedRect.h-2,u=t.right-t.left,c=t.bottom-t.top,h=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],p=function(t,e){return t+e[1]-e[0]},d=h.reduce(p,0),m=f.reduce(p,0),g=s-d,v=l-m,y=0,_=d,x=0,b=m,w=0,S=g,E=0,k=v;if(o.content&&r){var C=o.content;y=wu(h,0,C[0]),x=wu(f,0,C[1]),_=wu(h,C[0],C[2]),b=wu(f,C[1],C[3]),w=C[0]-y,E=C[1]-x,S=C[2]-C[0]-_,k=C[3]-C[1]-b}var I=function(r,i,s,l){var h=Eu(r.stretch-y,_,u,t.left),f=ku(r.fixed-w,S,r.stretch,d),p=Eu(i.stretch-x,b,c,t.top),g=ku(i.fixed-E,k,i.stretch,m),v=Eu(s.stretch-y,_,u,t.left),C=ku(s.fixed-w,S,s.stretch,d),I=Eu(l.stretch-x,b,c,t.top),T=ku(l.fixed-E,k,l.stretch,m),P=new F(h,p),A=new F(v,p),M=new F(v,I),L=new F(h,I),R=new F(f/a,g/a),D=new F(C/a,T/a),N=e*Math.PI/180;if(N){var z=Math.sin(N),O=Math.cos(N),B=[O,-z,z,O];P._matMult(B),A._matMult(B),L._matMult(B),M._matMult(B)}var j=r.stretch+r.fixed,U=i.stretch+i.fixed;return{tl:P,tr:A,bl:L,br:M,tex:{x:o.paddedRect.x+1+j,y:o.paddedRect.y+1+U,w:s.stretch+s.fixed-j,h:l.stretch+l.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:D,minFontScaleX:S/a/u,minFontScaleY:k/a/c,isSDF:n}};if(r&&(o.stretchX||o.stretchY))for(var T=Su(h,g,d),P=Su(f,v,m),A=0;A<T.length-1;A++)for(var M=T[A],L=T[A+1],R=0;R<P.length-1;R++)i.push(I(M,P[R],L,P[R+1]));else i.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));return i}function wu(t,e,n){var r,i=0,o=f(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]))}}catch(s){o.e(s)}finally{o.f()}return i}function Su(t,e,n){var r,i=[{fixed:-1,stretch:0}],o=f(t);try{for(o.s();!(r=o.n()).done;){var a=h(r.value,2),s=a[0],l=a[1],u=i[i.length-1];i.push({fixed:s-u.stretch,stretch:u.stretch}),i.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}}catch(c){o.e(c)}finally{o.f()}return i.push({fixed:e+1,stretch:n}),i}function Eu(t,e,n,r){return t/e*n+r}function ku(t,e,n,r){return t-e*n/r}jr("Anchor",fu);var Cu=p((function t(e,n,r,i,o,a,s,l,u,c){if(d(this,t),this.boxStartIndex=e.length,u){var h=a.top,f=a.bottom,p=a.collisionPadding;p&&(h-=p[1],f+=p[3]);var m=f-h;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{var g=a.top*s-l[0],v=a.bottom*s+l[2],y=a.left*s-l[3],_=a.right*s+l[1],x=a.collisionPadding;if(x&&(y-=x[0]*s,g-=x[1]*s,_+=x[2]*s,v+=x[3]*s),c){var b=new F(y,g),w=new F(_,g),S=new F(y,v),E=new F(_,v),k=c*Math.PI/180;b._rotate(k),w._rotate(k),S._rotate(k),E._rotate(k),y=Math.min(b.x,w.x,S.x,E.x),_=Math.max(b.x,w.x,S.x,E.x),g=Math.min(b.y,w.y,S.y,E.y),v=Math.max(b.y,w.y,S.y,E.y)}e.emplaceBack(n.x,n.y,y,g,_,v,r,i,o)}this.boxEndIndex=e.length})),Iu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tu;if(d(this,t),this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}return p(t,[{key:"push",value:function(t){this.data.push(t),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}},{key:"_down",value:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i}}]),t}();function Tu(t,e){return t<e?-1:t>e?1:0}function Pu(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1/0,i=1/0,o=-1/0,a=-1/0,s=t[0],l=0;l<s.length;l++){var u=s[l];(!l||u.x<r)&&(r=u.x),(!l||u.y<i)&&(i=u.y),(!l||u.x>o)&&(o=u.x),(!l||u.y>a)&&(a=u.y)}var c=Math.min(o-r,a-i),h=c/2,f=new Iu([],Au);if(0===c)return new F(r,i);for(var p=r;p<o;p+=c)for(var d=i;d<a;d+=c)f.push(new Mu(p+h,d+h,h,t));for(var m=function(t){for(var e=0,n=0,r=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;n+=(l.x+u.x)*c,r+=(l.y+u.y)*c,e+=3*c}return new Mu(n/e,r/e,0,t)}(t),g=f.length;f.length;){var v=f.pop();(v.d>m.d||!m.d)&&(m=v,n&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,g)),v.max-m.d<=e||(h=v.h/2,f.push(new Mu(v.p.x-h,v.p.y-h,h,t)),f.push(new Mu(v.p.x+h,v.p.y-h,h,t)),f.push(new Mu(v.p.x-h,v.p.y+h,h,t)),f.push(new Mu(v.p.x+h,v.p.y+h,h,t)),g+=4)}return n&&(console.log("num probes: ".concat(g)),console.log("best distance: ".concat(m.d))),m.p}function Au(t,e){return e.max-t.max}function Mu(t,e,n,r){this.p=new F(t,e),this.h=n,this.d=function(t,e){for(var n=!1,r=1/0,i=0;i<e.length;i++)for(var o=e[i],a=0,s=o.length,l=s-1;a<s;l=a++){var u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(n=!n),r=Math.min(r,ga(t,u,c))}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}var Lu=Number.POSITIVE_INFINITY;function Ru(t,e){return e[1]!==Lu?function(t,e,n){var r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-n}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){var n=0,r=0;e<0&&(e=0);var i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function Du(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Nu(e,n,r,i,o,a,s,l,u,c,p){var d=a.textMaxSize.evaluate(n,{});void 0===d&&(d=s);var m,g=e.layers[0].layout,v=g.get("icon-offset").evaluate(n,{},p),y=Fu(r.horizontal),_=s/24,x=e.tilePixelRatio*_,b=e.tilePixelRatio*d/24,w=e.tilePixelRatio*l,S=e.tilePixelRatio*g.get("symbol-spacing"),E=g.get("text-padding")*e.tilePixelRatio,k=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=t.get("icon-padding").evaluate(e,{},n),o=i&&i.values;return[o[0]*r,o[1]*r,o[2]*r,o[3]*r]}(g,n,p,e.tilePixelRatio),C=g.get("text-max-angle")/180*Math.PI,T="viewport"!==g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),P="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),A=g.get("symbol-placement"),M=S/2,L=g.get("icon-text-fit");i&&"none"!==L&&(e.allowVerticalPlacement&&r.vertical&&(m=uu(i,r.vertical,L,g.get("icon-text-fit-padding"),v,_)),y&&(i=uu(i,y,L,g.get("icon-text-fit-padding"),v,_)));var R=function(l,f){f.x<0||f.x>=na||f.y<0||f.y>=na||function(e,n,r,i,o,a,s,l,u,c,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C){var T,P,A,M,L,R,D=e.addToLineVertexArray(n,r),N=0,z=0,O=0,F=0,B=-1,j=-1,U={},V=Lo.exports(""),Z=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?(T=l.layout.get("text-offset").evaluate(w,{},k).map((function(t){return t*yl})),Z=(P=h(T,2))[0],q=P[1]):(Z=l.layout.get("text-radial-offset").evaluate(w,{},k)*yl,q=Lu),e.allowVerticalPlacement&&i.vertical){var G=l.layout.get("text-rotate").evaluate(w,{},k)+90;L=new Cu(u,n,c,f,p,i.vertical,d,m,g,G),s&&(R=new Cu(u,n,c,f,p,s,y,_,g,G))}if(o){var W=l.layout.get("icon-rotate").evaluate(w,{}),X="none"!==l.layout.get("icon-text-fit"),H=bu(o,W,E,X),Y=s?bu(s,W,E,X):void 0;M=new Cu(u,n,c,f,p,o,y,_,!1,W),N=4*H.length;var $=e.iconSizeData,K=null;"source"===$.kind?(K=[cu*l.layout.get("icon-size").evaluate(w,{})])[0]>zu&&I("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')):"composite"===$.kind&&((K=[cu*S.compositeIconSizes[0].evaluate(w,{},k),cu*S.compositeIconSizes[1].evaluate(w,{},k)])[0]>zu||K[1]>zu)&&I("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')),e.addSymbols(e.icon,H,K,b,x,w,t.WritingMode.none,n,D.lineStartIndex,D.lineLength,-1,k),B=e.icon.placedSymbolArray.length-1,Y&&(z=4*Y.length,e.addSymbols(e.icon,Y,K,b,x,w,t.WritingMode.vertical,n,D.lineStartIndex,D.lineLength,-1,k),j=e.icon.placedSymbolArray.length-1)}for(var J=Object.keys(i.horizontal),Q=0,tt=J;Q<tt.length;Q++){var et=tt[Q],nt=i.horizontal[et];if(!A){V=Lo.exports(nt.text);var rt=l.layout.get("text-rotate").evaluate(w,{},k);A=new Cu(u,n,c,f,p,nt,d,m,g,rt)}var it=1===nt.positionedLines.length;if(O+=Ou(e,n,nt,a,l,g,w,v,D,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,it?J:[et],U,B,S,k),it)break}i.vertical&&(F+=Ou(e,n,i.vertical,a,l,g,w,v,D,t.WritingMode.vertical,["vertical"],U,j,S,k));var ot=A?A.boxStartIndex:e.collisionBoxArray.length,at=A?A.boxEndIndex:e.collisionBoxArray.length,st=L?L.boxStartIndex:e.collisionBoxArray.length,lt=L?L.boxEndIndex:e.collisionBoxArray.length,ut=M?M.boxStartIndex:e.collisionBoxArray.length,ct=M?M.boxEndIndex:e.collisionBoxArray.length,ht=R?R.boxStartIndex:e.collisionBoxArray.length,ft=R?R.boxEndIndex:e.collisionBoxArray.length,pt=-1,dt=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};pt=dt(A,pt),pt=dt(L,pt),pt=dt(M,pt);var mt=(pt=dt(R,pt))>-1?1:0;mt&&(pt*=C/yl),e.glyphOffsetArray.length>=Xu.MAX_GLYPHS&&I("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,w.sortKey),e.symbolInstances.emplaceBack(n.x,n.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical||-1,B,j,V,ot,at,st,lt,ut,ct,ht,ft,c,O,F,N,z,mt,0,d,Z,q,pt)}(e,f,l,r,i,o,m,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,x,[E,E,E,E],T,u,w,k,P,v,n,a,c,p,s)};if("line"===A){var D,N=f(xu(n.geometry,0,0,na,na));try{for(N.s();!(D=N.n()).done;){var z,O=D.value,F=yu(O,S,C,r.vertical||y,i,24,b,e.overscaling,na),B=f(F);try{for(B.s();!(z=B.n()).done;){var j=z.value;y&&Bu(e,y.text,M,j)||R(O,j)}}catch(it){B.e(it)}finally{B.f()}}}catch(it){N.e(it)}finally{N.f()}}else if("line-center"===A){var U,V=f(n.geometry);try{for(V.s();!(U=V.n()).done;){var Z=U.value;if(Z.length>1){var q=vu(Z,C,r.vertical||y,i,24,b);q&&R(Z,q)}}}catch(it){V.e(it)}finally{V.f()}}else if("Polygon"===n.type){var G,W=f(Es(n.geometry,0));try{for(W.s();!(G=W.n()).done;){var X=G.value,H=Pu(X,16);R(X[0],new fu(H.x,H.y,0))}}catch(it){W.e(it)}finally{W.f()}}else if("LineString"===n.type){var Y,$=f(n.geometry);try{for($.s();!(Y=$.n()).done;){var K=Y.value;R(K,new fu(K[0].x,K[0].y,0))}}catch(it){$.e(it)}finally{$.f()}}else if("Point"===n.type){var J,Q=f(n.geometry);try{for(Q.s();!(J=Q.n()).done;){var tt,et=J.value,nt=f(et);try{for(nt.s();!(tt=nt.n()).done;){var rt=tt.value;R([rt],new fu(rt.x,rt.y,0))}}catch(it){nt.e(it)}finally{nt.f()}}}catch(it){Q.e(it)}finally{Q.f()}}}var zu=32640;function Ou(t,e,n,r,i,a,s,l,u,h,p,d,m,g,v){var y=function(t,e,n,r,i,a,s,l){var u,h=r.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,p=[],d=f(e.positionedLines);try{for(d.s();!(u=d.n()).done;){var m,g=u.value,v=f(g.positionedGlyphs);try{for(v.s();!(m=v.n()).done;){var y=m.value;if(y.rect){var _=y.rect||{},x=4,b=!0,w=1,S=0,E=(i||l)&&y.vertical,k=y.metrics.advance*y.scale/2;if(l&&e.verticalizable){var C=(y.scale-1)*yl,I=(yl-y.metrics.width*y.scale)/2;S=g.lineOffset/2-(y.imageName?-I:C)}if(y.imageName){var T=s[y.imageName];b=T.sdf,x=1/(w=T.pixelRatio)}var P=i?[y.x+k,y.y]:[0,0],A=i?[0,0]:[y.x+k+n[0],y.y+n[1]-S],M=[0,0];E&&(M=A,A=[0,0]);var L=(y.metrics.left-x)*y.scale-k+A[0],R=(-y.metrics.top-x)*y.scale+A[1],D=L+_.w*y.scale/w,N=R+_.h*y.scale/w,z=new F(L,R),O=new F(D,R),B=new F(L,N),j=new F(D,N);if(E){var U=new F(-k,k-Hl),V=-Math.PI/2,Z=12-k,q=new F(22-Z,-(y.imageName?Z:0)),G=o(F,c(M));z._rotateAround(V,U)._add(q)._add(G),O._rotateAround(V,U)._add(q)._add(G),B._rotateAround(V,U)._add(q)._add(G),j._rotateAround(V,U)._add(q)._add(G)}if(h){var W=Math.sin(h),X=Math.cos(h),H=[X,-W,W,X];z._matMult(H),O._matMult(H),B._matMult(H),j._matMult(H)}var Y=new F(0,0),$=new F(0,0);p.push({tl:z,tr:O,bl:B,br:j,tex:_,writingMode:e.writingMode,glyphOffset:P,sectionIndex:y.sectionIndex,isSDF:b,pixelOffsetTL:Y,pixelOffsetBR:$,minFontScaleX:0,minFontScaleY:0})}}}catch(K){v.e(K)}finally{v.f()}}}catch(K){d.e(K)}finally{d.f()}return p}(0,n,l,i,a,s,r,t.allowVerticalPlacement),_=t.textSizeData,x=null;"source"===_.kind?(x=[cu*i.layout.get("text-size").evaluate(s,{})])[0]>zu&&I("".concat(t.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')):"composite"===_.kind&&((x=[cu*g.compositeTextSizes[0].evaluate(s,{},v),cu*g.compositeTextSizes[1].evaluate(s,{},v)])[0]>zu||x[1]>zu)&&I("".concat(t.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')),t.addSymbols(t.text,y,x,l,a,s,h,e,u.lineStartIndex,u.lineLength,m,v);var b,w=f(p);try{for(w.s();!(b=w.n()).done;)d[b.value]=t.text.placedSymbolArray.length-1}catch(S){w.e(S)}finally{w.f()}return 4*y.length}function Fu(t){for(var e in t)return t[e];return null}function Bu(t,e,n,r){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[e]=[];return i[e].push(r),!1}var ju=Ds.VectorTileFeature.types,Uu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vu(t,e,n,r,i,o,a,s,l,u,c,h,f){var p=s?Math.min(zu,Math.round(s[0])):0,d=s?Math.min(zu,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,(p<<1)+(l?1:0),d,16*u,16*c,256*h,256*f)}function Zu(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function qu(t){var e,n=f(t.sections);try{for(n.s();!(e=n.n()).done;)if(ti(e.value.text))return!0}catch(r){n.e(r)}finally{n.f()}return!1}var Gu=function(){function t(e){d(this,t),this.layoutVertexArray=new bo,this.indexArray=new Co,this.programConfigurations=e,this.segments=new Po,this.dynamicLayoutVertexArray=new wo,this.opacityVertexArray=new So,this.placedSymbolArray=new ao}return p(t,[{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}},{key:"upload",value:function(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,fl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Uu,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}]),t}();jr("SymbolBuffers",Gu);var Wu=function(){function t(e,n,r){d(this,t),this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new r,this.segments=new Po,this.collisionVertexArray=new ko}return p(t,[{key:"upload",value:function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,pl.members,!0)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}]),t}();jr("CollisionBuffers",Wu);var Xu=function(){function e(n){d(this,e),this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ta([]),this.placementViewportMatrix=Ta([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hu(this.zoom,r["text-size"]),this.iconSizeData=hu(this.zoom,r["icon-size"]);var i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap="never"!==Ju(i,"text-overlap","text-allow-overlap")||"never"!==Ju(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!o.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map((function(e){return t.WritingMode[e]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=n.sourceID}return p(e,[{key:"createArrays",value:function(){this.text=new Gu(new Qo(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new Gu(new Qo(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new uo,this.lineVertexArray=new co,this.symbolInstances=new lo}},{key:"calculateGlyphDependencies",value:function(t,e,n,r,i){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||r)&&i){var a=vl[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}}},{key:"populate",value:function(e,n,r){var i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=("constant"!==s.value.kind||s.value.value instanceof $t&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),c="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],u||c){var p,d=n.iconDependencies,m=n.glyphDependencies,g=n.availableImages,v=new pi(this.zoom),y=f(e);try{for(y.s();!(p=y.n()).done;){var _=p.value,x=_.feature,b=_.id,w=_.index,S=_.sourceLayerIndex,E=i._featureFilter.needGeometry,k=aa(x,E);if(i._featureFilter.filter(v,k,r)){var C=void 0,I=void 0;if(E||(k.geometry=oa(x)),u){var T=i.getValueAndResolveTokens("text-field",k,r,g),P=$t.factory(T);qu(P)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ci()||this.hasRTLText&&fi.isParsed())&&(C=gl(P,i,k))}if(c){var A=i.getValueAndResolveTokens("icon-image",k,r,g);I=A instanceof Jt?A:Jt.fromString(A)}if(C||I){var M=this.sortFeaturesByKey?h.evaluate(k,{},r):void 0;if(this.features.push({id:b,text:C,icon:I,index:w,sourceLayerIndex:S,geometry:k.geometry,properties:x.properties,type:ju[x.type],sortKey:M}),I&&(d[I.name]=!0),C){var L=a.evaluate(k,{},r).join(","),R="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.WritingMode.vertical)>=0;var D,N=f(C.sections);try{for(N.s();!(D=N.n()).done;){var z=D.value;if(z.image)d[z.image.name]=!0;else{var O=Xr(C.toString()),F=z.fontStack||L,B=m[F]=m[F]||{};this.calculateGlyphDependencies(z.text,B,R,this.allowVerticalPlacement,O)}}}catch(j){N.e(j)}finally{N.f()}}}}}}catch(j){y.e(j)}finally{y.f()}"line"===o.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){var o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){var o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function l(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return"".concat(t,":").concat(r.x,":").concat(r.y)}for(var u=0;u<t.length;u++){var c=t[u],h=c.geometry,f=c.text?c.text.toString():null;if(f){var p=l(f,h),d=l(f,h,!0);if(p in n&&d in e&&n[p]!==e[d]){var m=s(p,d,h),g=a(p,d,r[m].geometry);delete e[p],delete n[d],n[l(f,r[g].geometry,!0)]=g,r[m].geometry=null}else p in n?a(p,d,h):d in e?s(p,d,h):(o(u),e[p]=i-1,n[d]=i-1)}else o(u)}return r.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}}},{key:"update",value:function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}},{key:"isEmpty",value:function(){return 0===this.symbolInstances.length&&!this.hasRTLText}},{key:"uploadPending",value:function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}},{key:"upload",value:function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}},{key:"destroyDebugData",value:function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}},{key:"destroy",value:function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}},{key:"addToLineVertexArray",value:function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}},{key:"addSymbols",value:function(e,n,r,i,o,a,s,l,u,c,h,f){for(var p=e.indexArray,d=e.layoutVertexArray,m=e.segments.prepareSegment(4*n.length,d,p,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,v=m.vertexLength,y=this.allowVerticalPlacement&&s===t.WritingMode.vertical?Math.PI/2:0,_=a.text&&a.text.sections,x=0;x<n.length;x++){var b=n[x],w=b.tl,S=b.tr,E=b.bl,k=b.br,C=b.tex,I=b.pixelOffsetTL,T=b.pixelOffsetBR,P=b.minFontScaleX,A=b.minFontScaleY,M=b.glyphOffset,L=b.isSDF,R=b.sectionIndex,D=m.vertexLength,N=M[1];Vu(d,l.x,l.y,w.x,N+w.y,C.x,C.y,r,L,I.x,I.y,P,A),Vu(d,l.x,l.y,S.x,N+S.y,C.x+C.w,C.y,r,L,T.x,I.y,P,A),Vu(d,l.x,l.y,E.x,N+E.y,C.x,C.y+C.h,r,L,I.x,T.y,P,A),Vu(d,l.x,l.y,k.x,N+k.y,C.x+C.w,C.y+C.h,r,L,T.x,T.y,P,A),Zu(e.dynamicLayoutVertexArray,l,y),p.emplaceBack(D,D+1,D+2),p.emplaceBack(D+1,D+2,D+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),x!==n.length-1&&R===n[x+1].sectionIndex||e.programConfigurations.populatePaintArrays(d.length,a,a.index,{},f,_&&_[R])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,v,u,c,l.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],s,0,!1,0,h)}},{key:"_addCollisionDebugVertex",value:function(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))}},{key:"addCollisionDebugVertices",value:function(t,e,n,r,i,o,a){var s=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=s.vertexLength,u=i.layoutVertexArray,c=i.collisionVertexArray,h=a.anchorX,f=a.anchorY;this._addCollisionDebugVertex(u,c,o,h,f,new F(t,e)),this._addCollisionDebugVertex(u,c,o,h,f,new F(n,e)),this._addCollisionDebugVertex(u,c,o,h,f,new F(n,r)),this._addCollisionDebugVertex(u,c,o,h,f,new F(t,r)),s.vertexLength+=4;var p=i.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),s.primitiveLength+=4}},{key:"addDebugCollisionBoxes",value:function(t,e,n,r){for(var i=t;i<e;i++){var o=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}}},{key:"generateCollisionDebugBuffers",value:function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wu(Eo,dl.members,Io),this.iconCollisionBox=new Wu(Eo,dl.members,Io);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}},{key:"_deserializeCollisionBoxesForSymbol",value:function(t,e,n,r,i,o,a,s,l){for(var u={},c=e;c<n;c++){var h=t.get(c);u.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},u.textFeatureIndex=h.featureIndex;break}for(var f=r;f<i;f++){var p=t.get(f);u.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.verticalTextFeatureIndex=p.featureIndex;break}for(var d=o;d<a;d++){var m=t.get(d);u.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},u.iconFeatureIndex=m.featureIndex;break}for(var g=s;g<l;g++){var v=t.get(g);u.verticalIconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},u.verticalIconFeatureIndex=v.featureIndex;break}return u}},{key:"deserializeCollisionBoxes",value:function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}},{key:"hasTextData",value:function(){return this.text.segments.get().length>0}},{key:"hasIconData",value:function(){return this.icon.segments.get().length>0}},{key:"hasDebugData",value:function(){return this.textCollisionBox&&this.iconCollisionBox}},{key:"hasTextCollisionBoxData",value:function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}},{key:"hasIconCollisionBoxData",value:function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}},{key:"addIndicesForPlacedSymbol",value:function(t,e){for(var n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs,i=n.vertexStartIndex;i<r;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)}},{key:"getSortedSymbolIndexes",value:function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),r=[],i=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);r.push(0|Math.round(e*s.anchorX+n*s.anchorY)),i.push(s.featureIndex)}return o.sort((function(t,e){return r[t]-r[e]||i[e]-i[t]})),o}},{key:"addToSortKeyRanges",value:function(t,e){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}},{key:"sortFeatures",value:function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];var n,r=f(this.symbolInstanceIndexes);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t,n,r){t>=0&&r.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}}catch(a){r.e(a)}finally{r.f()}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}]),e}();jr("SymbolBucket",Xu,{omit:["layers","collisionBoxArray","features","compareText"]}),Xu.MAX_GLYPHS=65535,Xu.addDynamicAttributes=Zu;var Hu=new Ii({"symbol-placement":new wi(gt.layout_symbol["symbol-placement"]),"symbol-spacing":new wi(gt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wi(gt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Si(gt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wi(gt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wi(gt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wi(gt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wi(gt.layout_symbol["icon-ignore-placement"]),"icon-optional":new wi(gt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wi(gt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Si(gt.layout_symbol["icon-size"]),"icon-text-fit":new wi(gt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wi(gt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Si(gt.layout_symbol["icon-image"]),"icon-rotate":new Si(gt.layout_symbol["icon-rotate"]),"icon-padding":new Si(gt.layout_symbol["icon-padding"]),"icon-keep-upright":new wi(gt.layout_symbol["icon-keep-upright"]),"icon-offset":new Si(gt.layout_symbol["icon-offset"]),"icon-anchor":new Si(gt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wi(gt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wi(gt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wi(gt.layout_symbol["text-rotation-alignment"]),"text-field":new Si(gt.layout_symbol["text-field"]),"text-font":new Si(gt.layout_symbol["text-font"]),"text-size":new Si(gt.layout_symbol["text-size"]),"text-max-width":new Si(gt.layout_symbol["text-max-width"]),"text-line-height":new wi(gt.layout_symbol["text-line-height"]),"text-letter-spacing":new Si(gt.layout_symbol["text-letter-spacing"]),"text-justify":new Si(gt.layout_symbol["text-justify"]),"text-radial-offset":new Si(gt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wi(gt.layout_symbol["text-variable-anchor"]),"text-anchor":new Si(gt.layout_symbol["text-anchor"]),"text-max-angle":new wi(gt.layout_symbol["text-max-angle"]),"text-writing-mode":new wi(gt.layout_symbol["text-writing-mode"]),"text-rotate":new Si(gt.layout_symbol["text-rotate"]),"text-padding":new wi(gt.layout_symbol["text-padding"]),"text-keep-upright":new wi(gt.layout_symbol["text-keep-upright"]),"text-transform":new Si(gt.layout_symbol["text-transform"]),"text-offset":new Si(gt.layout_symbol["text-offset"]),"text-allow-overlap":new wi(gt.layout_symbol["text-allow-overlap"]),"text-overlap":new wi(gt.layout_symbol["text-overlap"]),"text-ignore-placement":new wi(gt.layout_symbol["text-ignore-placement"]),"text-optional":new wi(gt.layout_symbol["text-optional"])}),Yu={paint:new Ii({"icon-opacity":new Si(gt.paint_symbol["icon-opacity"]),"icon-color":new Si(gt.paint_symbol["icon-color"]),"icon-halo-color":new Si(gt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Si(gt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Si(gt.paint_symbol["icon-halo-blur"]),"icon-translate":new wi(gt.paint_symbol["icon-translate"]),"icon-translate-anchor":new wi(gt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Si(gt.paint_symbol["text-opacity"]),"text-color":new Si(gt.paint_symbol["text-color"],{runtimeType:Tt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Si(gt.paint_symbol["text-halo-color"]),"text-halo-width":new Si(gt.paint_symbol["text-halo-width"]),"text-halo-blur":new Si(gt.paint_symbol["text-halo-blur"]),"text-translate":new wi(gt.paint_symbol["text-translate"]),"text-translate-anchor":new wi(gt.paint_symbol["text-translate-anchor"])}),layout:Hu},$u=function(){function t(e){if(d(this,t),void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Et,this.defaultValue=e}return p(t,[{key:"evaluate",value:function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}},{key:"eachChild",value:function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return null}}]),t}();jr("FormatSectionOverride",$u,{omit:["defaultValue"]});var Ku=function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,Yu)}return p(n,[{key:"recalculate",value:function(t,e){if(a(s(n.prototype),"recalculate",this).call(this,t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){var i,o=[],l=f(r);try{for(l.s();!(i=l.n()).done;){var u=i.value;o.indexOf(u)<0&&o.push(u)}}catch(c){l.e(c)}finally{l.f()}this.layout._values["text-writing-mode"]=o}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}},{key:"getValueAndResolveTokens",value:function(t,e,n,r){var i=this.layout.get(t).evaluate(e,{},n,r),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||Xn(o.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,i)}},{key:"createBucket",value:function(t){return new Xu(t)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){throw new Error("Should take a different path in FeatureIndex")}},{key:"_setPaintOverrides",value:function(){var t,e=f(Yu.paint.overridableProperties);try{for(e.s();!(t=e.n()).done;){var r=t.value;if(n.hasPaintOverride(this.layout,r)){var i=this.paint.get(r),o=new $u(i),a=new Wn(o,i.property.specification),s=null;s="constant"===i.value.kind||"source"===i.value.kind?new Yn("source",a):new $n("composite",a,i.value.zoomStops),this.paint._values[r]=new xi(i.property,s,i.parameters)}}}catch(l){e.e(l)}finally{e.f()}}},{key:"_handleOverridablePaintPropertyUpdate",value:function(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven())&&n.hasPaintOverride(this.layout,t)}}],[{key:"hasPaintOverride",value:function(t,e){var n=t.get("text-field"),r=Yu.paint.properties[e],i=!1,o=function(t){var e,n=f(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(r.overrides&&r.overrides.hasOverride(o))return void(i=!0)}}catch(a){n.e(a)}finally{n.f()}};if("constant"===n.value.kind&&n.value.value instanceof $t)o(n.value.value.sections);else if("source"===n.value.kind){var a=function t(e){i||(e instanceof re&&ee(e.value)===Lt?o(e.value.sections):e instanceof En?o(e.sections):e.eachChild(t))},s=n.value;s._styleExpression&&a(s._styleExpression.expression)}return i}}]),n}(Pi);function Ju(t,e,n){var r="never",i=t.get(e);return i?r=i:t.get(n)&&(r="always"),r}var Qu={paint:new Ii({"background-color":new wi(gt.paint_background["background-color"]),"background-pattern":new ki(gt.paint_background["background-pattern"]),"background-opacity":new wi(gt.paint_background["background-opacity"])})},tc={paint:new Ii({"raster-opacity":new wi(gt.paint_raster["raster-opacity"]),"raster-hue-rotate":new wi(gt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wi(gt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wi(gt.paint_raster["raster-brightness-max"]),"raster-saturation":new wi(gt.paint_raster["raster-saturation"]),"raster-contrast":new wi(gt.paint_raster["raster-contrast"]),"raster-resampling":new wi(gt.paint_raster["raster-resampling"]),"raster-fade-duration":new wi(gt.paint_raster["raster-fade-duration"])})},ec=function(t){m(n,t);var e=g(n);function n(t){var r;return d(this,n),(r=e.call(this,t,{})).onAdd=function(t){r.implementation.onAdd&&r.implementation.onAdd(t,t.painter.context.gl)},r.onRemove=function(t){r.implementation.onRemove&&r.implementation.onRemove(t,t.painter.context.gl)},r.implementation=t,r}return p(n,[{key:"is3D",value:function(){return"3d"===this.implementation.renderingMode}},{key:"hasOffscreenPass",value:function(){return void 0!==this.implementation.prerender}},{key:"recalculate",value:function(){}},{key:"updateTransitions",value:function(){}},{key:"hasTransition",value:function(){return!1}},{key:"serialize",value:function(){throw new Error("Custom layers cannot be serialized")}}]),n}(Pi),nc={circle:function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,Ea)}return p(n,[{key:"createBucket",value:function(t){return new la(t)}},{key:"queryRadius",value:function(t){var e=t;return xa("circle-radius",this,e)+xa("circle-stroke-width",this,e)+ba(this.paint.get("circle-translate"))}},{key:"queryIntersectsFeature",value:function(t,e,n,r,i,o,a,s){var l,u=wa(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),h="map"===this.paint.get("circle-pitch-alignment"),p=h?u:function(t,e){return t.map((function(t){return za(t,e)}))}(u,s),d=h?c*a:c,m=f(r);try{for(m.s();!(l=m.n()).done;){var g,v=l.value,y=f(v);try{for(y.s();!(g=y.n()).done;){var _=g.value,x=h?_:za(_,s),b=d,w=Da([],[_.x,_.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?b*=w[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(b*=o.cameraToCenterDistance/w[3]),ca(p,x,b))return!0}}catch(S){y.e(S)}finally{y.f()}}}catch(S){m.e(S)}finally{m.f()}return!1}}]),n}(Pi),heatmap:function(t){m(n,t);var e=g(n);function n(t){var r;return d(this,n),(r=e.call(this,t,Fa))._updateColorRamp(),r}return p(n,[{key:"createBucket",value:function(t){return new Oa(t)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(t){"heatmap-color"===t&&this._updateColorRamp()}},{key:"_updateColorRamp",value:function(){this.colorRamp=qa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}},{key:"resize",value:function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}]),n}(Pi),hillshade:function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,Ga)}return p(n,[{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}]),n}(Pi),fill:function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,As)}return p(n,[{key:"recalculate",value:function(t,e){a(s(n.prototype),"recalculate",this).call(this,t,e);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}},{key:"createBucket",value:function(t){return new Ts(t)}},{key:"queryRadius",value:function(){return ba(this.paint.get("fill-translate"))}},{key:"queryIntersectsFeature",value:function(t,e,n,r,i,o,a){return ha(wa(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)}},{key:"isTileClipped",value:function(){return!0}}]),n}(Pi),"fill-extrusion":function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,Js)}return p(n,[{key:"createBucket",value:function(t){return new Ys(t)}},{key:"queryRadius",value:function(){return ba(this.paint.get("fill-extrusion-translate"))}},{key:"is3D",value:function(){return!0}},{key:"queryIntersectsFeature",value:function(t,e,n,r,i,o,a,s){var l=wa(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),u=this.paint.get("fill-extrusion-height").evaluate(e,n),c=this.paint.get("fill-extrusion-base").evaluate(e,n),h=function(t,e,n,r){var i,o=[],a=f(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,l=[s.x,s.y,0,1];Da(l,l,e),o.push(new F(l[0]/l[3],l[1]/l[3]))}}catch(u){a.e(u)}finally{a.f()}return o}(l,s),p=function(t,e,n,r){var i,o=[],a=[],s=r[8]*e,l=r[9]*e,u=r[10]*e,c=r[11]*e,h=r[8]*n,p=r[9]*n,d=r[10]*n,m=r[11]*n,g=f(t);try{for(g.s();!(i=g.n()).done;){var v,y=i.value,_=[],x=[],b=f(y);try{for(b.s();!(v=b.n()).done;){var w=v.value,S=w.x,E=w.y,k=r[0]*S+r[4]*E+r[12],C=r[1]*S+r[5]*E+r[13],I=r[2]*S+r[6]*E+r[14],T=r[3]*S+r[7]*E+r[15],P=I+u,A=T+c,M=k+h,L=C+p,R=I+d,D=T+m,N=new F((k+s)/A,(C+l)/A);N.z=P/A,_.push(N);var z=new F(M/D,L/D);z.z=R/D,x.push(z)}}catch(O){b.e(O)}finally{b.f()}o.push(_),a.push(x)}}catch(O){g.e(O)}finally{g.f()}return[o,a]}(r,c,u,s);return function(t,e,n){var r=1/0;ha(n,e)&&(r=tl(n,e[0]));for(var i=0;i<e.length;i++)for(var o=e[i],a=t[i],s=0;s<o.length-1;s++){var l=o[s],u=[l,o[s+1],a[s+1],a[s],l];ua(n,u)&&(r=Math.min(r,tl(n,u)))}return r!==1/0&&r}(p[0],p[1],h)}}]),n}(Pi),line:function(t){m(n,t);var e=g(n);function n(t){var r;return d(this,n),(r=e.call(this,t,ll)).gradientVersion=0,r}return p(n,[{key:"_handleSpecialPaintPropertyUpdate",value:function(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Oe,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}},{key:"gradientExpression",value:function(){return this._transitionablePaint._values["line-gradient"].value.expression}},{key:"recalculate",value:function(t,e){a(s(n.prototype),"recalculate",this).call(this,t,e),this.paint._values["line-floorwidth"]=ul.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}},{key:"createBucket",value:function(t){return new al(t)}},{key:"queryRadius",value:function(t){var e=t,n=cl(xa("line-width",this,e),xa("line-gap-width",this,e)),r=xa("line-offset",this,e);return n/2+Math.abs(r)+ba(this.paint.get("line-translate"))}},{key:"queryIntersectsFeature",value:function(t,e,n,r,i,o,a){var s=wa(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),l=a/2*cl(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(r=function(t,e){for(var n=[],r=0;r<t.length;r++){for(var i=t[r],o=[],a=0;a<i.length;a++){var s=i[a-1],l=i[a],u=i[a+1],c=0===a?new F(0,0):l.sub(s)._unit()._perp(),h=a===i.length-1?new F(0,0):u.sub(l)._unit()._perp(),f=c._add(h)._unit(),p=f.x*h.x+f.y*h.y;0!==p&&f._mult(1/p),o.push(f._mult(e)._add(l))}n.push(o)}return n}(r,u*a)),function(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];if(t.length>=3)for(var o=0;o<i.length;o++)if(ya(t,i[o]))return!0;if(fa(t,i,n))return!0}return!1}(s,r,l)}},{key:"isTileClipped",value:function(){return!0}}]),n}(Pi),symbol:Ku,background:function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,Qu)}return p(n)}(Pi),raster:function(t){m(n,t);var e=g(n);function n(t){return d(this,n),e.call(this,t,tc)}return p(n)}(Pi)},rc=function(){function t(e){var n=this;d(this,t),this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})}return p(t,[{key:"trigger",value:function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))}},{key:"remove",value:function(){delete this._channel,this._callback=function(){}}}]),t}(),ic=6371008.8,oc=function(){function t(e,n){if(d(this,t),isNaN(e)||isNaN(n))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(n,")"));if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return p(t,[{key:"wrap",value:function(){return new t(_(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(t){var e=Math.PI/180,n=this.lat*e,r=t.lat*e,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return ic*Math.acos(Math.min(i,1))}},{key:"toBounds",value:function(){var e=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new ac(new t(this.lng-n,this.lat-e),new t(this.lng+n,this.lat+e))}}],[{key:"convert",value:function(e){if(e instanceof t)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),t}(),ac=function(){function t(e,n){d(this,t),e&&(n?this.setSouthWest(e).setNorthEast(n):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}return p(t,[{key:"setNorthEast",value:function(t){return this._ne=t instanceof oc?new oc(t.lng,t.lat):oc.convert(t),this}},{key:"setSouthWest",value:function(t){return this._sw=t instanceof oc?new oc(t.lng,t.lat):oc.convert(t),this}},{key:"extend",value:function(e){var n,r,i=this._sw,o=this._ne;if(e instanceof oc)n=e,r=e;else{if(!(e instanceof t))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(t.convert(e)):this.extend(oc.convert(e)):this;if(n=e._sw,r=e._ne,!n||!r)return this}return i||o?(i.lng=Math.min(n.lng,i.lng),i.lat=Math.min(n.lat,i.lat),o.lng=Math.max(r.lng,o.lng),o.lat=Math.max(r.lat,o.lat)):(this._sw=new oc(n.lng,n.lat),this._ne=new oc(r.lng,r.lat)),this}},{key:"getCenter",value:function(){return new oc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}},{key:"getSouthWest",value:function(){return this._sw}},{key:"getNorthEast",value:function(){return this._ne}},{key:"getNorthWest",value:function(){return new oc(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new oc(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this._sw.lng}},{key:"getSouth",value:function(){return this._sw.lat}},{key:"getEast",value:function(){return this._ne.lng}},{key:"getNorth",value:function(){return this._ne.lat}},{key:"toArray",value:function(){return[this._sw.toArray(),this._ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this._sw&&this._ne)}},{key:"contains",value:function(t){var e=oc.convert(t),n=e.lng,r=e.lat,i=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i}}],[{key:"convert",value:function(e){return e instanceof t?e:e?new t(e):e}}]),t}(),sc=2*Math.PI*ic;function lc(t){return sc*Math.cos(t*Math.PI/180)}function uc(t){return(180+t)/360}function cc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function hc(t,e){return t/lc(e)}function fc(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var pc=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;d(this,t),this.x=+e,this.y=+n,this.z=+r}return p(t,[{key:"toLngLat",value:function(){return new oc(360*this.x-180,fc(this.y))}},{key:"toAltitude",value:function(){return this.z*lc(fc(this.y))}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/sc*(t=fc(this.y),1/Math.cos(t*Math.PI/180));var t}}],[{key:"fromLngLat",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=oc.convert(e);return new t(uc(r.lng),cc(r.lat),hc(n,r.lat))}}]),t}();function dc(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}var mc=function(){function t(e,n,r){if(d(this,t),e<0||e>25||r<0||r>=Math.pow(2,e)||n<0||n>=Math.pow(2,e))throw new Error("x=".concat(n,", y=").concat(r,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=n,this.y=r,this.key=yc(0,e,e,n,r)}return p(t,[{key:"equals",value:function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}},{key:"url",value:function(t,e,n){var r,i,o,a,s,l=(i=this.y,o=this.z,a=dc(256*(r=this.x),256*(i=Math.pow(2,o)-i-1),o),s=dc(256*(r+1),256*(i+1),o),a[0]+","+a[1]+","+s[0]+","+s[1]),u=function(t,e,n){for(var r,i="",o=t;o>0;o--)i+=(e&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,l)}},{key:"isChildOf",value:function(t){var e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}},{key:"getTilePoint",value:function(t){var e=Math.pow(2,this.z);return new F((t.x*e-this.x)*na,(t.y*e-this.y)*na)}},{key:"toString",value:function(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}]),t}(),gc=p((function t(e,n){d(this,t),this.wrap=e,this.canonical=n,this.key=yc(e,n.z,n.z,n.x,n.y)})),vc=function(){function t(e,n,r,i,o){if(d(this,t),e<r)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(r));this.overscaledZ=e,this.wrap=n,this.canonical=new mc(r,+i,+o),this.key=yc(n,e,r,i,o)}return p(t,[{key:"clone",value:function(){return new t(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"equals",value:function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}},{key:"scaledTo",value:function(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));var n=this.canonical.z-e;return e>this.canonical.z?new t(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new t(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}},{key:"calculateScaledKey",value:function(t,e){if(t>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(t,"; overscaledZ = ").concat(this.overscaledZ));var n=this.canonical.z-t;return t>this.canonical.z?yc(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):yc(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}},{key:"isChildOf",value:function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}},{key:"children",value:function(e){if(this.overscaledZ>=e)return[new t(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new t(n,this.wrap,n,r,i),new t(n,this.wrap,n,r+1,i),new t(n,this.wrap,n,r,i+1),new t(n,this.wrap,n,r+1,i+1)]}},{key:"isLessThan",value:function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}},{key:"wrapped",value:function(){return new t(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"unwrapTo",value:function(e){return new t(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"overscaleFactor",value:function(){return Math.pow(2,this.overscaledZ-this.canonical.z)}},{key:"toUnwrapped",value:function(){return new gc(this.wrap,this.canonical)}},{key:"toString",value:function(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}},{key:"getTilePoint",value:function(t){return this.canonical.getTilePoint(new pc(t.x-this.wrap,t.y))}}]),t}();function yc(t,e,n,r,i){(t*=2)<0&&(t=-1*t-1);var o=1<<n;return(o*o*t+o*i+r).toString(36)+n.toString(36)+e.toString(36)}jr("CanonicalTileID",mc),jr("OverscaledTileID",vc,{omit:["posMatrix"]});var _c=function(){function t(e,n,r){if(d(this,t),this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)I('"'.concat(r,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));else{this.stride=n.height;var i=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=r||"mapbox";for(var o=0;o<i;o++)this.data[this._idx(-1,o)]=this.data[this._idx(0,o)],this.data[this._idx(i,o)]=this.data[this._idx(i-1,o)],this.data[this._idx(o,-1)]=this.data[this._idx(o,0)],this.data[this._idx(o,i)]=this.data[this._idx(o,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(var a=0;a<i;a++)for(var s=0;s<i;s++){var l=this.get(a,s);l>this.max&&(this.max=l),l<this.min&&(this.min=l)}}}return p(t,[{key:"get",value:function(t,e){var n=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])}},{key:"getUnpackVector",value:function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}},{key:"_idx",value:function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}},{key:"_unpackMapbox",value:function(t,e,n){return(256*t*256+256*e+n)/10-1e4}},{key:"_unpackTerrarium",value:function(t,e,n){return 256*t+e+n/256-32768}},{key:"getPixels",value:function(){return new Za({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}},{key:"backfillBorder",value:function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,l=-n*this.dim,u=o;u<a;u++)for(var c=r;c<i;c++)this.data[this._idx(c,u)]=t.data[this._idx(c+s,u+l)]}}]),t}();jr("DEMData",_c);var xc,bc=function(){function t(e){d(this,t),this._stringToNumber={},this._numberToString=[];for(var n=0;n<e.length;n++){var r=e[n];this._stringToNumber[r]=n,this._numberToString[n]=r}}return p(t,[{key:"encode",value:function(t){return this._stringToNumber[t]}},{key:"decode",value:function(t){if(t>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(t," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[t]}}]),t}(),wc=function(){function t(e,n,r,i,o){d(this,t),this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=r,e._y=i,this.properties=e.properties,this.id=o}return p(t,[{key:"geometry",get:function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},set:function(t){this._geometry=t}},{key:"toJSON",value:function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}]),t}(),Sc=function(){function t(e,n){d(this,t),this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Fr(na,16,0),this.grid3D=new Fr(na,16,0),this.featureIndexArray=new fo,this.promoteId=n}return p(t,[{key:"insert",value:function(t,e,n,r,i,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var s=o?this.grid3D:this.grid,l=0;l<e.length;l++){for(var u=e[l],c=[1/0,1/0,-1/0,-1/0],h=0;h<u.length;h++){var f=u[h];c[0]=Math.min(c[0],f.x),c[1]=Math.min(c[1],f.y),c[2]=Math.max(c[2],f.x),c[3]=Math.max(c[3],f.y)}c[0]<na&&c[1]<na&&c[2]>=0&&c[3]>=0&&s.insert(a,c[0],c[1],c[2],c[3])}}},{key:"loadVTLayers",value:function(){return this.vtLayers||(this.vtLayers=new Ds.VectorTile(new _l(this.rawTileData)).layers,this.sourceLayerCoder=new bc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}},{key:"query",value:function(t,e,n,r){var i=this;this.loadVTLayers();var o,a=t.params||{},s=na/t.tileSize/t.scale,l=lr(a.filter),u=t.queryGeometry,c=t.queryPadding*s,h=kc(u),p=this.grid.query(h.minX-c,h.minY-c,h.maxX+c,h.maxY+c),d=kc(t.cameraQueryGeometry),m=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,(function(e,n,r,i){return function(t,e,n,r,i){var o,a=f(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(e<=s.x&&n<=s.y&&r>=s.x&&i>=s.y)return!0}}catch(p){a.e(p)}finally{a.f()}var l=[new F(e,n),new F(e,i),new F(r,i),new F(r,n)];if(t.length>2){var u,c=f(l);try{for(c.s();!(u=c.n()).done;)if(ya(t,u.value))return!0}catch(p){c.e(p)}finally{c.f()}}for(var h=0;h<t.length-1;h++)if(_a(t[h],t[h+1],l))return!0;return!1}(t.cameraQueryGeometry,e-c,n-c,r+c,i+c)})),g=f(m);try{for(g.s();!(o=g.n()).done;){var v=o.value;p.push(v)}}catch(w){g.e(w)}finally{g.f()}p.sort(Cc);for(var y,_={},x=function(o){var c=p[o];if(c===y)return"continue";y=c;var h=i.featureIndexArray.get(c),f=null;i.loadMatchingFeature(_,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,l,a.layers,a.availableImages,e,n,r,(function(e,n,r){return f||(f=oa(e)),n.queryIntersectsFeature(u,e,r,f,i.z,t.transform,s,t.pixelPosMatrix)}))},b=0;b<p.length;b++)x(b);return _}},{key:"loadMatchingFeature",value:function(t,e,n,r,i,o,a,s,l,u,c){var h=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,h)){var f=this.sourceLayerCoder.decode(n),p=this.vtLayers[f].feature(r);if(i.needGeometry){var d=aa(p,!0);if(!i.filter(new pi(this.tileID.overscaledZ),d,this.tileID.canonical))return}else if(!i.filter(new pi(this.tileID.overscaledZ),p))return;for(var m=this.getId(p,f),g=0;g<h.length;g++){var v=h[g];if(!(o&&o.indexOf(v)<0)){var y=s[v];if(y){var _={};m&&u&&(_=u.getState(y.sourceLayer||"_geojsonTileLayer",m));var b=x({},l[v]);b.paint=Ec(b.paint,y.paint,p,_,a),b.layout=Ec(b.layout,y.layout,p,_,a);var w=!c||c(p,y,_);if(w){var S=new wc(p,this.z,this.x,this.y,m);S.layer=b;var E=t[v];void 0===E&&(E=t[v]=[]),E.push({featureIndex:r,feature:S,intersectionZ:w})}}}}}}},{key:"lookupSymbolFeatures",value:function(t,e,n,r,i,o,a,s){var l={};this.loadVTLayers();var u,c=lr(i),h=f(t);try{for(h.s();!(u=h.n()).done;){var p=u.value;this.loadMatchingFeature(l,n,r,p,c,o,a,s,e)}}catch(d){h.e(d)}finally{h.f()}return l}},{key:"hasLayer",value:function(t){var e,n=f(this.bucketLayerIDs);try{for(n.s();!(e=n.n()).done;){var r,i=e.value,o=f(i);try{for(o.s();!(r=o.n()).done;)if(t===r.value)return!0}catch(a){o.e(a)}finally{o.f()}}}catch(a){n.e(a)}finally{n.f()}return!1}},{key:"getId",value:function(t,e){var n=t.id;return this.promoteId&&"boolean"==typeof(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(n=Number(n)),n}}]),t}();function Ec(t,e,n,r,i){return S(t,(function(t,o){var a=e instanceof bi?e.get(o):null;return a&&a.evaluate?a.evaluate(n,r,i):a}))}function kc(t){var e,n=1/0,r=1/0,i=-1/0,o=-1/0,a=f(t);try{for(a.s();!(e=a.n()).done;){var s=e.value;n=Math.min(n,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),o=Math.max(o,s.y)}}catch(l){a.e(l)}finally{a.f()}return{minX:n,minY:r,maxX:i,maxY:o}}function Cc(t,e){return e-t}jr("FeatureIndex",Sc,{omit:["rawTileData","sourceLayerCoder"]}),t.PerformanceMarkers=void 0,(xc=t.PerformanceMarkers||(t.PerformanceMarkers={})).create="create",xc.load="load",xc.fullLoad="fullLoad";var Ic=null,Tc=[],Pc=1e3/30,Ac={mark:function(t){performance.mark(t)},frame:function(t){var e=t;null!=Ic&&Tc.push(e-Ic),Ic=e},clearMetrics:function(){for(var e in Ic=null,Tc=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime"),t.PerformanceMarkers)performance.clearMarks(t.PerformanceMarkers[e])},getPerformanceMetrics:function(){performance.measure("loadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.load),performance.measure("fullLoadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.fullLoad);var e=performance.getEntriesByName("loadTime")[0].duration,n=performance.getEntriesByName("fullLoadTime")[0].duration,r=Tc.length,i=1/(Tc.reduce((function(t,e){return t+e}),0)/r/1e3),o=Tc.filter((function(t){return t>Pc})).reduce((function(t,e){return t+(e-Pc)/Pc}),0);return{loadTime:e,fullLoadTime:n,fps:i,percentDroppedFrames:o/(r+o)*100}}};t.AJAXError=et,t.ARRAY_TYPE=Ca,t.Actor=function(){function t(e,n,r){d(this,t),this.target=e,this.parent=n,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},w(["receive","process"],this),this.invoker=new rc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=A()?e:window}return p(t,[{key:"send",value:function(t,e,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var s=N(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!n,targetMapId:r,mustQueue:o,sourceMapId:this.mapId,data:Zr(e,s)},s),{cancel:function(){n&&delete i.callbacks[a],i.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:i.mapId})}}}},{key:"receive",value:function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r()}else A()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)}},{key:"process",value:function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}}},{key:"processTask",value:function(t,e){var n=this;if("<response>"===e.type){var r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(qr(e.error)):r(null,qr(e.data)))}else{var i=!1,o=N(this.globalScope)?void 0:[],a=e.hasCallback?function(e,r){i=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?Zr(e):null,data:Zr(r,o)},o)}:function(t){i=!0},s=null,l=qr(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,l,a);else if(this.parent.getWorkerSource){var u=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,u[0],l.source)[u[1]](l,a)}else a(new Error("Could not find function ".concat(e.type)));!i&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}}},{key:"remove",value:function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}}]),t}(),t.AlphaImage=Va,t.CanonicalTileID=mc,t.CollisionBoxArray=io,t.CollisionCircleLayoutArray=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Wi),t.Color=Xt,t.DEMData=_c,t.DataConstantProperty=wi,t.DictionaryCoder=bc,t.EXTENT=na,t.ErrorEvent=dt,t.EvaluationParameters=pi,t.Event=pt,t.Evented=mt,t.FeatureIndex=Sc,t.FillBucket=Ts,t.FillExtrusionBucket=Ys,t.GeoJSONFeature=wc,t.ImageAtlas=Xl,t.ImagePosition=Wl,t.LineBucket=al,t.LineStripIndexArray=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(eo),t.LngLat=oc,t.LngLatBounds=ac,t.MercatorCoordinate=pc,t.ONE_EM=yl,t.OverscaledTileID=vc,t.PerformanceUtils=Ac,t.PosArray=po,t.Properties=Ii,t.QuadTriangleArray=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(Hi),t.RGBAImage=Za,t.RasterBoundsArray=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(zi),t.RequestPerformance=function(){function t(e){d(this,t),this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}return p(t,[{key:"finish",value:function(){performance.mark(this._marks.end);var t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}}]),t}(),t.ResourceType=tt,t.SegmentVector=Po,t.SymbolBucket=Xu,t.Transitionable=gi,t.TriangleIndexArray=Co,t.Uniform1f=Vo,t.Uniform1i=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=0,i}return p(n,[{key:"set",value:function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}}]),n}(Uo),t.Uniform2f=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=[0,0],i}return p(n,[{key:"set",value:function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}}]),n}(Uo),t.Uniform3f=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=[0,0,0],i}return p(n,[{key:"set",value:function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}}]),n}(Uo),t.Uniform4f=Zo,t.UniformColor=qo,t.UniformMatrix4f=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t,r)).current=Go,i}return p(n,[{key:"set",value:function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}}]),n}(Uo),t.UnwrappedTileID=gc,t.ValidationError=vt,t.ZoomHistory=Gr,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=Zu,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),i[a]=e,0==--r&&n(o,i)}))}))},t.bezier=r,t.bindAll=w,t.cacheEntryPossiblyAdded=function(t){++Y>G&&(t.getActor().send("enforceCacheSizeLimit",q),Y=0)},t.clamp=y,t.clearTileCache=function(t){var e=caches.delete(Z);t&&e.catch(t).then((function(){return t()}))},t.clipLine=xu,t.clone=function(t){var e=new Ca(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=k,t.clone$2=function(t){var e=new Ca(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=ml,t.config=V,t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.create=function(){var t=new Ca(16);return Ca!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=Ia,t.createExpression=Hn,t.createFilter=lr,t.createLayout=Ri,t.createStyleLayer=function(t){return"custom"===t.type?new ec(t):new nc[t.type](t)},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=i*l-o*s,t[1]=o*a-r*l,t[2]=r*s-i*a,t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=i,t.emitValidationErrors=Or,t.enforceCacheSizeLimit=function(t){W(),j&&j.then((function(e){e.keys().then((function(n){for(var r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],p=t[11],d=t[12],m=t[13],g=t[14],v=t[15],y=e[0],_=e[1],x=e[2],b=e[3],w=e[4],S=e[5],E=e[6],k=e[7],C=e[8],I=e[9],T=e[10],P=e[11],A=e[12],M=e[13],L=e[14],R=e[15];return Math.abs(n-y)<=ka*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-_)<=ka*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-x)<=ka*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-b)<=ka*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=ka*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=ka*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-E)<=ka*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-k)<=ka*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(c-C)<=ka*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-I)<=ka*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(f-T)<=ka*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(p-P)<=ka*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-A)<=ka*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-M)<=ka*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-L)<=ka*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(v-R)<=ka*Math.max(1,Math.abs(v),Math.abs(R))},t.evaluateSizeForFeature=function(t,e,n){var r=e.uSize,i=e.uSizeT,o=n.lowerSize,a=n.upperSize;return"source"===t.kind?o/cu:"composite"===t.kind?Fe(o/cu,a/cu,i):r},t.evaluateSizeForZoom=function(t,e){var n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){var i=t.interpolationType,o=t.minZoom,a=t.maxZoom,s=i?y(rn.interpolationFactor(i,e,o,a),0,1):0;"camera"===t.kind?r=Fe(t.minSize,t.maxSize,s):n=s}return{uSizeT:n,uSize:r}},t.evaluateVariableOffset=Ru,t.evented=ui,t.exported=O,t.exported$1=$,t.extend=x,t.filterObject=E,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.getAnchorAlignment=au,t.getAnchorJustification=Du,t.getArrayBuffer=ot,t.getImage=ct,t.getJSON=function(t,e){return it(x(t,{type:"json"}),e)},t.getOverlapMode=Ju,t.getRTLTextPluginStatus=ci,t.getReferrer=nt,t.getVideo=function(t,e){var n=window.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(var r=0;r<t.length;r++){var i=window.document.createElement("source");at(t[r])||(n.crossOrigin="Anonymous"),i.src=t[r],n.appendChild(i)}return{cancel:function(){}}},t.identity=Ta,t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],g=e[14],v=e[15],y=n*s-r*a,_=n*l-i*a,x=n*u-o*a,b=r*l-i*s,w=r*u-o*s,S=i*u-o*l,E=c*m-h*d,k=c*g-f*d,C=c*v-p*d,I=h*g-f*m,T=h*v-p*m,P=f*v-p*g,A=y*P-_*T+x*I+b*C-w*k+S*E;return A?(t[0]=(s*P-l*T+u*I)*(A=1/A),t[1]=(i*T-r*P-o*I)*A,t[2]=(m*S-g*w+v*b)*A,t[3]=(f*w-h*S-p*b)*A,t[4]=(l*C-a*P-u*k)*A,t[5]=(n*P-i*C+o*k)*A,t[6]=(g*x-d*S-v*_)*A,t[7]=(c*S-f*x+p*_)*A,t[8]=(a*T-s*C+u*E)*A,t[9]=(r*C-n*T-o*E)*A,t[10]=(d*w-m*x+v*y)*A,t[11]=(h*x-c*w-p*y)*A,t[12]=(s*k-a*I-l*E)*A,t[13]=(n*I-r*k+i*E)*A,t[14]=(m*_-d*b-g*y)*A,t[15]=(c*b-h*_+f*y)*A,t):null},t.isImageBitmap=z,t.isSafari=N,t.isWorker=A,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.lazyLoadRTLTextPlugin=function(){fi.isLoading()||fi.isLoaded()||"deferred"!==ci()||hi()},t.makeRequest=it,t.mapObject=S,t.mercatorXfromLng=uc,t.mercatorYfromLat=cc,t.mercatorZfromAltitude=hc,t.mul=Ma,t.mul$1=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.multiply=Pa,t.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Fe,t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),l=1/(r-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(a+o)*u,t[15]=1,t},t.parseCacheControl=M,t.parseGlyphPbf=function(t){return new _l(t).readFields(Vl,[])},t.pbf=_l,t.performSymbolLayout=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=na/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;var n=e.bucket.layers[0].layout,r=e.bucket.layers[0]._unevaluatedLayout._values,i={layoutIconSize:r["icon-size"].possiblyEvaluate(new pi(e.bucket.zoom+1),e.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new pi(e.bucket.zoom+1),e.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new pi(18))};if("composite"===e.bucket.textSizeData.kind){var o=e.bucket.textSizeData,a=o.minZoom,s=o.maxZoom;i.compositeTextSizes=[r["text-size"].possiblyEvaluate(new pi(a),e.canonical),r["text-size"].possiblyEvaluate(new pi(s),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){var l=e.bucket.iconSizeData,u=l.minZoom,c=l.maxZoom;i.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new pi(u),e.canonical),r["icon-size"].possiblyEvaluate(new pi(c),e.canonical)]}var h,p=n.get("text-line-height")*yl,d="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),m=n.get("text-keep-upright"),g=n.get("text-size"),v=f(e.bucket.features);try{var y=function(){var r=h.value,o=n.get("text-font").evaluate(r,{},e.canonical).join(","),a=g.evaluate(r,{},e.canonical),s=i.layoutTextSize.evaluate(r,{},e.canonical),l=i.layoutIconSize.evaluate(r,{},e.canonical),u={horizontal:{},vertical:void 0},c=r.text,f=void 0,v=[0,0];if(c){var y=c.toString(),_=n.get("text-letter-spacing").evaluate(r,{},e.canonical)*yl,x=Hr(y)?_:0,b=n.get("text-anchor").evaluate(r,{},e.canonical),w=n.get("text-variable-anchor");if(!w){var S=n.get("text-radial-offset").evaluate(r,{},e.canonical);v=S?Ru(b,[S*yl,Lu]):n.get("text-offset").evaluate(r,{},e.canonical).map((function(t){return t*yl}))}var E=d?"center":n.get("text-justify").evaluate(r,{},e.canonical),k=n.get("symbol-placement"),C="point"===k?n.get("text-max-width").evaluate(r,{},e.canonical)*yl:0,T=function(){e.bucket.allowVerticalPlacement&&Xr(y)&&(u.vertical=Kl(c,e.glyphMap,e.glyphPositions,e.imagePositions,o,C,p,b,"left",x,v,t.WritingMode.vertical,!0,k,s,a))};if(!d&&w){for(var P="auto"===E?w.map((function(t){return Du(t)})):[E],A=!1,M=0;M<P.length;M++){var L=P[M];if(!u.horizontal[L])if(A)u.horizontal[L]=u.horizontal[0];else{var R=Kl(c,e.glyphMap,e.glyphPositions,e.imagePositions,o,C,p,"center",L,x,v,t.WritingMode.horizontal,!1,k,s,a);R&&(u.horizontal[L]=R,A=1===R.positionedLines.length)}}T()}else{"auto"===E&&(E=Du(b));var D=Kl(c,e.glyphMap,e.glyphPositions,e.imagePositions,o,C,p,b,E,x,v,t.WritingMode.horizontal,!1,k,s,a);D&&(u.horizontal[E]=D),T(),Xr(y)&&d&&m&&(u.vertical=Kl(c,e.glyphMap,e.glyphPositions,e.imagePositions,o,C,p,b,E,x,v,t.WritingMode.vertical,!1,k,s,a))}}var N=!1;if(r.icon&&r.icon.name){var z=e.imageMap[r.icon.name];z&&(f=lu(e.imagePositions[r.icon.name],n.get("icon-offset").evaluate(r,{},e.canonical),n.get("icon-anchor").evaluate(r,{},e.canonical)),N=!!z.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=N:e.bucket.sdfIcons!==N&&I("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(z.pixelRatio!==e.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}var O=Fu(u.horizontal)||u.vertical;e.bucket.iconsInText=!!O&&O.iconsInText,(O||f)&&Nu(e.bucket,r,u,f,e.imageMap,i,s,l,v,N,e.canonical)};for(v.s();!(h=v.n()).done;)y()}catch(_){v.e(_)}finally{v.f()}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(o=1/(r-i)),t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=fi,t.pointGeometry=F,t.polygonIntersectsPolygon=ua,t.potpack=Gl,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=jr,t.registerForPluginStateChange=function(t){return t({pluginStatus:oi,pluginURL:ai}),ui.on("pluginStateChange",t),t},t.renderColorRamp=qa,t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=a*i+c*r,t[6]=s*i+h*r,t[7]=l*i+f*r,t[8]=u*i-o*r,t[9]=c*i-a*r,t[10]=h*i-s*r,t[11]=f*i-l*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=a*i+c*r,t[2]=s*i+h*r,t[3]=l*i+f*r,t[4]=u*i-o*r,t[5]=c*i-a*r,t[6]=h*i-s*r,t[7]=f*i-l*r,t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){q=t,G=e},t.setRTLTextPlugin=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(oi===ei||oi===ni||oi===ri)throw new Error("setRTLTextPlugin cannot be called multiple times.");ai=O.resolveURL(t),oi=ei,ii=e,li(),n||hi()},t.spec=gt,t.sphericalToCartesian=function(t){var e=h(t,3),n=e[0],r=e[1],i=e[2];return r+=90,r*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(r)*Math.sin(i),y:n*Math.sin(r)*Math.sin(i),z:n*Math.cos(i)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.toEvaluationFeature=aa,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.transformMat4=Da,t.transformMat4$1=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},t.translate=function(t,e,n){var r,i,o,a,s,l,u,c,h,f,p,d,m=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=r=e[0],t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=r*m+s*g+h*v+e[12],t[13]=i*m+l*g+f*v+e[13],t[14]=o*m+u*g+p*v+e[14],t[15]=a*m+c*g+d*v+e[15]),t},t.triggerPluginCompletionEvent=si,t.unicodeBlockLookup=Wr,t.uniqueId=function(){return b++},t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===t.render&&e.push({message:"layers.".concat(n,': missing required method "render"')}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),e},t.validateLight=Dr,t.validateStyle=Rr,t.vectorTile=Ds,t.warnOnce=I,t.wrap=_})),y(["./shared"],(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){var r,i="[",o=f(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i+="".concat(e(a),",")}}catch(c){o.e(c)}finally{o.f()}return"".concat(i,"]")}for(var s=Object.keys(t).sort(),l="{",u=0;u<s.length;u++)l+="".concat(JSON.stringify(s[u]),":").concat(e(t[s[u]]),",");return"".concat(l,"}")}function n(n){var r,i="",o=f(t.refProperties);try{for(o.s();!(r=o.n()).done;){var a=r.value;i+="/".concat(e(n[a]))}}catch(s){o.e(s)}finally{o.f()}return i}var r=function(){function e(t){d(this,e),this.keyCache={},t&&this.replace(t)}return p(e,[{key:"replace",value:function(t){this._layerConfigs={},this._layers={},this.update(t,[])}},{key:"update",value:function(e,r){var i,o=this,a=f(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;this._layerConfigs[s.id]=s;var l=this._layers[s.id]=t.createStyleLayer(s);l._featureFilter=t.createFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}}catch(w){a.e(w)}finally{a.f()}var u,c=f(r);try{for(c.s();!(u=c.n()).done;){var h=u.value;delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}}catch(w){c.e(w)}finally{c.f()}this.familiesBySource={};var p,d=function(t,e){for(var r={},i=0;i<t.length;i++){var o=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=o);var a=r[o];a||(a=r[o]=[]),a.push(t[i])}var s=[];for(var l in r)s.push(r[l]);return s}(Object.values(this._layerConfigs),this.keyCache),m=f(d);try{for(m.s();!(p=m.n()).done;){var g=p.value.map((function(t){return o._layers[t.id]})),v=g[0];if("none"!==v.visibility){var y=v.source||"",_=this.familiesBySource[y];_||(_=this.familiesBySource[y]={});var x=v.sourceLayer||"_geojsonTileLayer",b=_[x];b||(b=_[x]=[]),b.push(g)}}}catch(w){m.e(w)}finally{m.f()}}}]),e}(),i=p((function e(n){d(this,e);var r={},i=[];for(var o in n){var a=n[o],s=r[o]={};for(var l in a){var u=a[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};i.push(c),s[l]={rect:c,metrics:u.metrics}}}}var h=t.potpack(i),f=h.w,p=h.h,m=new t.AlphaImage({width:f||1,height:p||1});for(var g in n){var v=n[g];for(var y in v){var _=v[+y];if(_&&0!==_.bitmap.width&&0!==_.bitmap.height){var x=r[g][y].rect;t.AlphaImage.copy(_.bitmap,m,{x:0,y:0},{x:x.x+1,y:x.y+1},_.bitmap)}}}this.image=m,this.positions=r}));t.register("GlyphAtlas",i);var o=function(){function e(n){d(this,e),this.tileID=new t.OverscaledTileID(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.uid=n.uid,this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId}return p(e,[{key:"parse",value:function(e,n,r,o,a){var s=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var u=new t.DictionaryCoder(Object.keys(e.layers).sort()),c=new t.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var h,p,d,m,g={},v={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},y=n.familiesBySource[this.source];for(var _ in y){var x=e.layers[_];if(x){1===x.version&&t.warnOnce('Vector tile source "'.concat(this.source,'" layer "').concat(_,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));for(var b=u.encode(_),w=[],S=0;S<x.length;S++){var E=x.feature(S),k=c.getId(E,_);w.push({feature:E,id:k,index:S,sourceLayerIndex:b})}var C,I=f(y[_]);try{for(I.s();!(C=I.n()).done;){var T=C.value,P=T[0];P.source!==this.source&&t.warnOnce("layer.source = ".concat(P.source," does not equal this.source = ").concat(this.source)),P.minzoom&&this.zoom<Math.floor(P.minzoom)||P.maxzoom&&this.zoom>=P.maxzoom||"none"!==P.visibility&&(l(T,this.zoom,r),(g[P.id]=P.createBucket({index:c.bucketLayerIDs.length,layers:T,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(w,v,this.tileID.canonical),c.bucketLayerIDs.push(T.map((function(t){return t.id}))))}}catch(D){I.e(D)}finally{I.f()}}}var A=t.mapObject(v.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(A).length?o.send("getGlyphs",{uid:this.uid,stacks:A},(function(t,e){h||(h=t,p=e,R.call(s))})):p={};var M=Object.keys(v.iconDependencies);M.length?o.send("getImages",{icons:M,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){h||(h=t,d=e,R.call(s))})):d={};var L=Object.keys(v.patternDependencies);function R(){if(h)return a(h);if(p&&d&&m){var e=new i(p),n=new t.ImageAtlas(d,m);for(var o in g){var s=g[o];s instanceof t.SymbolBucket?(l(s.layers,this.zoom,r),t.performSymbolLayout({bucket:s,glyphMap:p,glyphPositions:e.positions,imageMap:d,imagePositions:n.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):s.hasPattern&&(s instanceof t.LineBucket||s instanceof t.FillBucket||s instanceof t.FillExtrusionBucket)&&(l(s.layers,this.zoom,r),s.addFeatures(v,this.tileID.canonical,n.patternPositions))}this.status="done",a(null,{buckets:Object.values(g).filter((function(t){return!t.isEmpty()})),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}L.length?o.send("getImages",{icons:L,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){h||(h=t,m=e,R.call(s))})):m={},R.call(this)}}]),e}();function l(e,n,r){var i,o=new t.EvaluationParameters(n),a=f(e);try{for(a.s();!(i=a.n()).done;)i.value.recalculate(o,r)}catch(s){a.e(s)}finally{a.f()}}function u(e,n){var r=t.getArrayBuffer(e.request,(function(e,r,i,o){e?n(e):r&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(r)),rawData:r,cacheControl:i,expires:o})}));return function(){r.cancel(),n()}}var c=function(){function e(t,n,r,i){d(this,e),this.actor=t,this.layerIndex=n,this.availableImages=r,this.loadVectorData=i||u,this.loading={},this.loaded={}}return p(e,[{key:"loadTile",value:function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),s=this.loading[i]=new o(e);s.abort=this.loadVectorData(e,(function(e,o){if(delete r.loading[i],e||!o)return s.status="done",r.loaded[i]=s,n(e);var l=o.rawData,u={};o.expires&&(u.expires=o.expires),o.cacheControl&&(u.cacheControl=o.cacheControl);var c={};if(a){var h=a.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:l.slice(0)},r,u,c))})),r.loaded=r.loaded||{},r.loaded[i]=s}))}},{key:"reloadTile",value:function(t,e){var n=this,r=this.loaded,i=t.uid,o=this;if(r&&r[i]){var a=r[i];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,r){var i=a.reloadCallback;i&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,i)),e(t,r)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}},{key:"abortTile",value:function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()}},{key:"removeTile",value:function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()}}]),e}(),v=function(){function e(){d(this,e),this.loaded={}}return p(e,[{key:"loadTile",value:function(e,n){var r=e.uid,i=e.encoding,o=e.rawImageData,a=t.isImageBitmap(o)?this.getImageData(o):o,s=new t.DEMData(r,a,i);this.loaded=this.loaded||{},this.loaded[r]=s,n(null,s)}},{key:"getImageData",value:function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)}},{key:"removeTile",value:function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]}}]),e}(),y=function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)_(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)_(e.coordinates[r],n);return e};function _(t,e){if(0!==t.length){x(t[0],e);for(var n=1;n<t.length;n++)x(t[n],!e)}}function x(t,e){for(var n=0,r=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=n+s;r+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+r>=0!=!!e&&t.reverse()}var b=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,w=function(){function e(n){d(this,e),this._feature=n,this.extent=t.EXTENT,this.type=n.type,this.properties=n.tags,"id"in n&&!isNaN(n.id)&&(this.id=parseInt(n.id,10))}return p(e,[{key:"loadGeometry",value:function(){if(1===this._feature.type){var e,n=[],r=f(this._feature.geometry);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push([new t.pointGeometry(i[0],i[1])])}}catch(d){r.e(d)}finally{r.f()}return n}var o,a=[],s=f(this._feature.geometry);try{for(s.s();!(o=s.n()).done;){var l,u=o.value,c=[],h=f(u);try{for(h.s();!(l=h.n()).done;){var p=l.value;c.push(new t.pointGeometry(p[0],p[1]))}}catch(d){h.e(d)}finally{h.f()}a.push(c)}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"toGeoJSON",value:function(t,e,n){return b.call(this,t,e,n)}}]),e}(),S=function(){function e(n){d(this,e),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=n.length,this._features=n}return p(e,[{key:"feature",value:function(t){return new w(this._features[t])}}]),e}(),E={exports:{}},k=t.pointGeometry,C=t.vectorTile.VectorTileFeature,I=T;function T(t,e){this.options=e||{},this.features=t,this.length=t.length}function P(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}T.prototype.feature=function(t){return new P(this.features[t],this.options.extent)},P.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],r=[],i=0;i<n.length;i++)r.push(new k(n[i][0],n[i][1]));this.geometry.push(r)}return this.geometry},P.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[e,r,n,i]},P.prototype.toGeoJSON=C.prototype.toGeoJSON;var A=t.pbf,M=I;function L(t){var e=new A;return function(t,e){for(var n in t.layers)e.writeMessage(3,R,t.layers[n])}(t,e),e.finish()}function R(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,D,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,B,o[n])}function D(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,N,t),e.writeVarintField(3,n.type),e.writeMessage(4,F,n)}function N(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var l=n.properties[s],u=o[s];if(null!==l){void 0===u&&(r.push(s),o[s]=u=r.length-1),e.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,f=a[h];void 0===f&&(i.push(l),a[h]=f=i.length-1),e.writeVarint(f)}}}function z(t,e){return(e<<3)+(7&t)}function O(t){return t<<1^t>>31}function F(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var l=n[s],u=1;1===r&&(u=l.length),e.writeVarint(z(1,u));for(var c=3===r?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==r&&e.writeVarint(z(2,c-1));var f=l[h].x-i,p=l[h].y-o;e.writeVarint(O(f)),e.writeVarint(O(p)),i+=f,o+=p}3===r&&e.writeVarint(z(7,1))}}function B(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function j(t,e,n,r,i,o){if(!(i-r<=n)){var a=r+i>>1;U(t,e,a,r,i,o%2),j(t,e,n,r,a-1,o+1),j(t,e,n,a+1,i,o+1)}}function U(t,e,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);U(t,e,n,Math.max(r,Math.floor(n-s*u/a+c)),Math.min(i,Math.floor(n+(a-s)*u/a+c)),o)}var h=e[2*n+o],f=r,p=i;for(V(t,e,r,n),e[2*i+o]>h&&V(t,e,r,i);f<p;){for(V(t,e,f,p),f++,p--;e[2*f+o]<h;)f++;for(;e[2*p+o]>h;)p--}e[2*r+o]===h?V(t,e,r,p):V(t,e,++p,i),p<=n&&(r=p+1),n<=p&&(i=p-1)}}function V(t,e,n,r){Z(t,n,r),Z(e,2*n,2*r),Z(e,2*n+1,2*r+1)}function Z(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function q(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}E.exports=L,E.exports.fromVectorTileJs=L,E.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new M(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return L({layers:n})},E.exports.GeoJSONWrapper=M;var G,W=function(t){return t[0]},X=function(t){return t[1]},H=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Float64Array;d(this,t),this.nodeSize=i,this.points=e;for(var a=e.length<65536?Uint16Array:Uint32Array,s=this.ids=new a(e.length),l=this.coords=new o(2*e.length),u=0;u<e.length;u++)s[u]=u,l[2*u]=n(e[u]),l[2*u+1]=r(e[u]);j(s,l,i,0,s.length-1,0)}return p(t,[{key:"range",value:function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),f=u.pop(),p=u.pop();if(f-p<=a)for(var d=p;d<=f;d++)s=e[2*d],l=e[2*d+1],s>=n&&s<=i&&l>=r&&l<=o&&c.push(t[d]);else{var m=Math.floor((p+f)/2);s=e[2*m],l=e[2*m+1],s>=n&&s<=i&&l>=r&&l<=o&&c.push(t[m]);var g=(h+1)%2;(0===h?n<=s:r<=l)&&(u.push(p),u.push(m-1),u.push(g)),(0===h?i>=s:o>=l)&&(u.push(m+1),u.push(f),u.push(g))}}return c}(this.ids,this.coords,t,e,n,r,this.nodeSize)}},{key:"within",value:function(t,e,n){return function(t,e,n,r,i,o){for(var a=[0,t.length-1,0],s=[],l=i*i;a.length;){var u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var f=h;f<=c;f++)q(e[2*f],e[2*f+1],n,r)<=l&&s.push(t[f]);else{var p=Math.floor((h+c)/2),d=e[2*p],m=e[2*p+1];q(d,m,n,r)<=l&&s.push(t[p]);var g=(u+1)%2;(0===u?n-i<=d:r-i<=m)&&(a.push(h),a.push(p-1),a.push(g)),(0===u?n+i>=d:r+i>=m)&&(a.push(p+1),a.push(c),a.push(g))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)}}]),t}(),Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},$=Math.fround||(G=new Float32Array(1),function(t){return G[0]=+t,G[0]}),K=function(){function t(e){d(this,t),this.options=ot(Object.create(Y),e),this.trees=new Array(this.options.maxZoom+1)}return p(t,[{key:"load",value:function(t){var e=this.options,n=e.log,r=e.minZoom,i=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare ".concat(t.length," points");n&&console.time(a),this.points=t;for(var s=[],l=0;l<t.length;l++)t[l].geometry&&s.push(Q(t[l],l));this.trees[i+1]=new H(s,at,st,o,Float32Array),n&&console.timeEnd(a);for(var u=i;u>=r;u--){var c=+Date.now();s=this._cluster(s,u),this.trees[u]=new H(s,at,st,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",u,s.length,+Date.now()-c)}return n&&console.timeEnd("total time"),this}},{key:"getClusters",value:function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}var l,u=this.trees[this._limitZoom(e)],c=u.range(nt(n),rt(o),nt(i),rt(r)),h=[],p=f(c);try{for(p.s();!(l=p.n()).done;){var d=l.value,m=u.points[d];h.push(m.numPoints?tt(m):this.points[m.index])}}catch(g){p.e(g)}finally{p.f()}return h}},{key:"getChildren",value:function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);var a,s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=i.within(o.x,o.y,s),u=[],c=f(l);try{for(c.s();!(a=c.n()).done;){var h=a.value,p=i.points[h];p.parentId===t&&u.push(p.numPoints?tt(p):this.points[p.index])}}catch(d){c.e(d)}finally{c.f()}if(0===u.length)throw new Error(r);return u}},{key:"getLeaves",value:function(t,e,n){var r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r}},{key:"getTile",value:function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius/a,l=(n-s)/i,u=(n+1+s)/i,c={features:[]};return this._addTileFeatures(r.range((e-s)/i,l,(e+1+s)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-s/i,l,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,l,s/i,u),r.points,-1,n,i,c),c.features.length?c:null}},{key:"getClusterExpansionZoom",value:function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}},{key:"_appendLeaves",value:function(t,e,n,r,i){var o,a=this.getChildren(e),s=f(a);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=l.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(t,u.cluster_id,n,r,i):i<r?i++:t.push(l),t.length===n)break}}catch(c){s.e(c)}finally{s.f()}return i}},{key:"_addTileFeatures",value:function(t,e,n,r,i,o){var a,s=f(t);try{for(s.s();!(a=s.n()).done;){var l=e[a.value],u=l.numPoints,c=void 0,h=void 0,p=void 0;if(u)c=et(l),h=l.x,p=l.y;else{var d=this.points[l.index];c=d.properties,h=nt(d.geometry.coordinates[0]),p=rt(d.geometry.coordinates[1])}var m={type:1,geometry:[[Math.round(this.options.extent*(h*i-n)),Math.round(this.options.extent*(p*i-r))]],tags:c},g=void 0;u?g=l.id:this.options.generateId?g=l.index:this.points[l.index].id&&(g=this.points[l.index].id),void 0!==g&&(m.id=g),o.features.push(m)}}catch(v){s.e(v)}finally{s.f()}}},{key:"_limitZoom",value:function(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}},{key:"_cluster",value:function(t,e){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=r.minPoints,l=i/(o*Math.pow(2,e)),u=0;u<t.length;u++){var c=t[u];if(!(c.zoom<=e)){c.zoom=e;var h,p=this.trees[e+1],d=p.within(c.x,c.y,l),m=c.numPoints||1,g=m,v=f(d);try{for(v.s();!(h=v.n()).done;){var y=h.value,_=p.points[y];_.zoom>e&&(g+=_.numPoints||1)}}catch(R){v.e(R)}finally{v.f()}if(g>m&&g>=s){var x,b=c.x*m,w=c.y*m,S=a&&m>1?this._map(c,!0):null,E=(u<<5)+(e+1)+this.points.length,k=f(d);try{for(k.s();!(x=k.n()).done;){var C=x.value,I=p.points[C];if(!(I.zoom<=e)){I.zoom=e;var T=I.numPoints||1;b+=I.x*T,w+=I.y*T,I.parentId=E,a&&(S||(S=this._map(c,!0)),a(S,this._map(I)))}}}catch(R){k.e(R)}finally{k.f()}c.parentId=E,n.push(J(b/g,w/g,E,g,S))}else if(n.push(c),g>1){var P,A=f(d);try{for(A.s();!(P=A.n()).done;){var M=P.value,L=p.points[M];L.zoom<=e||(L.zoom=e,n.push(L))}}catch(R){A.e(R)}finally{A.f()}}}}return n}},{key:"_getOriginId",value:function(t){return t-this.points.length>>5}},{key:"_getOriginZoom",value:function(t){return(t-this.points.length)%32}},{key:"_map",value:function(t,e){if(t.numPoints)return e?ot({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?ot({},r):r}}]),t}();function J(t,e,n,r,i){return{x:$(t),y:$(e),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function Q(t,e){var n=h(t.geometry.coordinates,2),r=n[0],i=n[1];return{x:$(nt(r)),y:$(rt(i)),zoom:1/0,index:e,parentId:-1}}function tt(t){return{type:"Feature",id:t.id,properties:et(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),it(t.y)]}};var e}function et(t){var e=t.numPoints,n=e>=1e4?"".concat(Math.round(e/1e3),"k"):e>=1e3?Math.round(e/100)/10+"k":e;return ot(ot({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function nt(t){return t/360+.5}function rt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function it(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function ot(t,e){for(var n in e)t[n]=e[n];return t}function at(t){return t.x}function st(t){return t.y}function lt(t,e,n,r){for(var i,o=r,a=n-e>>1,s=n-e,l=t[e],u=t[e+1],c=t[n],h=t[n+1],f=e+3;f<n;f+=3){var p=ut(t[f],t[f+1],l,u,c,h);if(p>o)i=f,o=p;else if(p===o){var d=Math.abs(f-a);d<s&&(i=f,s=d)}}o>r&&(i-e>3&&lt(t,e,i,r),t[i+2]=o,n-i>3&&lt(t,i,n,r))}function ut(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var l=((t-n)*a+(e-r)*s)/(a*a+s*s);l>1?(n=i,r=o):l>0&&(n+=a*l,r+=s*l)}return(a=t-n)*a+(s=e-r)*s}function ct(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)ht(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)ht(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)ht(t,e[r][i])}(i),i}function ht(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function ft(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===o)pt(i,s);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)pt(i[u],s);else if("LineString"===o)dt(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(u=0;u<i.length;u++)dt(i[u],s=[],a,!1),t.push(ct(l,"LineString",s,e.properties));return}mt(i,s,a,!1)}else if("Polygon"===o)mt(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)ft(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];mt(i[u],c,a,!0),s.push(c)}}t.push(ct(l,o,s,e.properties))}}function pt(t,e){e.push(gt(t[0])),e.push(vt(t[1])),e.push(0)}function dt(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var l=gt(t[s][0]),u=vt(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=r?(i*u-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,lt(e,0,c,n),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function mt(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];dt(t[i],o,n,r),e.push(o)}}function gt(t){return t/360+.5}function vt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function yt(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,f=c.type,p=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(p>=n&&d<r)l.push(c);else if(!(d<n||p>=r)){var m=[];if("Point"===f||"MultiPoint"===f)_t(h,m,n,r,i);else if("LineString"===f)xt(h,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===f)wt(h,m,n,r,i,!1);else if("Polygon"===f)wt(h,m,n,r,i,!0);else if("MultiPolygon"===f)for(var g=0;g<h.length;g++){var v=[];wt(h[g],v,n,r,i,!0),v.length&&m.push(v)}if(m.length){if(s.lineMetrics&&"LineString"===f){for(g=0;g<m.length;g++)l.push(ct(c.id,f,m[g],c.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===m.length?(f="LineString",m=m[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===m.length?"Point":"MultiPoint"),l.push(ct(c.id,f,m,c.tags))}}}return l.length?l:null}function _t(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function xt(t,e,n,r,i,o,a){for(var s,l,u=bt(t),c=0===i?Et:kt,h=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],m=t[f+2],g=t[f+3],v=t[f+4],y=0===i?p:d,_=0===i?g:v,x=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-v,2))),y<n?_>n&&(l=c(u,p,d,g,v,n),a&&(u.start=h+s*l)):y>r?_<r&&(l=c(u,p,d,g,v,r),a&&(u.start=h+s*l)):St(u,p,d,m),_<n&&y>=n&&(l=c(u,p,d,g,v,n),x=!0),_>r&&y<=r&&(l=c(u,p,d,g,v,r),x=!0),!o&&x&&(a&&(u.end=h+s*l),e.push(u),u=bt(t)),a&&(h+=s)}var b=t.length-3;p=t[b],d=t[b+1],m=t[b+2],(y=0===i?p:d)>=n&&y<=r&&St(u,p,d,m),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&St(u,u[0],u[1],u[2]),u.length&&e.push(u)}function bt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function wt(t,e,n,r,i,o){for(var a=0;a<t.length;a++)xt(t[a],e,n,r,i,o,!1)}function St(t,e,n,r){t.push(e),t.push(n),t.push(r)}function Et(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function kt(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function Ct(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=It(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(It(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(It(o.geometry[s][u],e));i.push(l)}n.push(ct(o.id,a,i,o.tags))}return n}function It(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function Tt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(Pt(u[r],u[r+1],e,o,a,s));else for(r=0;r<u.length;r++){var h=[];for(i=0;i<u[r].length;i+=2)h.push(Pt(u[r][i],u[r][i+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function Pt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function At(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Mt(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Mt(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Lt(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Lt(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Lt(a,u[s],t,n,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(f.id=e.id),t.features.push(f)}}function Lt(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function Rt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)ft(n,t.features[r],e,r);else ft(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(t,e){var n=e.buffer/e.extent,r=t,i=yt(t,1,-1-n,n,0,-1,2,e),o=yt(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=yt(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=Ct(i,1).concat(r)),o&&(r=r.concat(Ct(o,-1)))),r}(r,e),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Dt(t,e,n){return 32*((1<<t)*n+e)+t}function Nt(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new S(r.features),o=E.exports(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}Rt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Rt.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],l=this.options,u=l.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=Dt(e,n,r),f=this.tiles[h];if(!f&&(u>1&&console.time("creation"),f=this.tiles[h]=At(t,e,n,r,l),this.tileCoords.push({z:e,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(f.source=t,i){if(e===l.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,0!==t.length){u>1&&console.time("clipping");var m,g,v,y,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,E=1+b;m=g=v=y=null,_=yt(t,c,n-b,n+S,0,f.minX,f.maxX,l),x=yt(t,c,n+w,n+E,0,f.minX,f.maxX,l),t=null,_&&(m=yt(_,c,r-b,r+S,1,f.minY,f.maxY,l),g=yt(_,c,r+w,r+E,1,f.minY,f.maxY,l),_=null),x&&(v=yt(x,c,r-b,r+S,1,f.minY,f.maxY,l),y=yt(x,c,r+w,r+E,1,f.minY,f.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*r),s.push(g||[],e+1,2*n,2*r+1),s.push(v||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},Rt.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=Dt(t,e=(e%a+a)%a,n);if(this.tiles[s])return Tt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[Dt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Tt(this.tiles[s],i):null):null};var zt=function(e){m(r,e);var n=g(r);function r(t,e,i,o){var a;return d(this,r),a=n.call(this,t,e,i,Nt),o&&(a.loadGeoJSON=o),a}return p(r,[{key:"loadData",value:function(e,n){var r,i=this;null===(r=this._pendingRequest)||void 0===r||r.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request);this._pendingCallback=n,this._pendingRequest=this.loadGeoJSON(e,(function(r,a){if(delete i._pendingCallback,delete i._pendingRequest,r||!a)return n(r);if("object"!=typeof a)return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));y(a,!0);try{if(e.filter){var s=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===s.result)throw new Error(s.value.map((function(t){return"".concat(t.key,": ").concat(t.message)})).join(", "));var l=a.features.filter((function(t){return s.value.evaluate({zoom:0},t)}));a={type:"FeatureCollection",features:l}}i._geoJSONIndex=e.cluster?new K(function(e){var n=e.superclusterOptions,r=e.clusterProperties;if(!r||!n)return n;for(var i={},o={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(r),u=0,c=l;u<c.length;u++){var p=c[u],d=h(r[p],2),m=d[0],g=d[1],v=t.createExpression(g),y=t.createExpression("string"==typeof m?[m,["accumulated"],["get",p]]:m);i[p]=v.value,o[p]=y.value}return n.map=function(t){s.properties=t;var e,n={},r=f(l);try{for(r.s();!(e=r.n()).done;){var o=e.value;n[o]=i[o].evaluate(a,s)}}catch(u){r.e(u)}finally{r.f()}return n},n.reduce=function(t,e){s.properties=e;var n,r=f(l);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.accumulated=t[i],t[i]=o[i].evaluate(a,s)}}catch(u){r.e(u)}finally{r.f()}},n}(e)).load(a.features):function(t,e){return new Rt(t,e)}(a,e.geojsonVtOptions)}catch(r){return n(r)}i.loaded={};var u={};if(o){var c=o.finish();c&&(u.resourceTiming={},u.resourceTiming[e.source]=JSON.parse(JSON.stringify(c)))}n(null,u)}))}},{key:"reloadTile",value:function(t,e){var n=this.loaded;return n&&n[t.uid]?a(s(r.prototype),"reloadTile",this).call(this,t,e):this.loadTile(t,e)}},{key:"loadGeoJSON",value:function(e,n){if(e.request)return t.getJSON(e.request,n);if("string"==typeof e.data)try{n(null,JSON.parse(e.data))}catch(t){n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")))}else n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));return{cancel:function(){}}}},{key:"removeSource",value:function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()}},{key:"getClusterExpansionZoom",value:function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}},{key:"getClusterChildren",value:function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}},{key:"getClusterLeaves",value:function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}]),r}(c),Ot=function(){function e(n){var r=this;d(this,e),this.self=n,this.actor=new t.Actor(n,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:c,geojson:zt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'.concat(t,'" already registered.'));r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}return p(e,[{key:"setReferrer",value:function(t,e){this.referrer=e}},{key:"setImages",value:function(t,e,n){for(var r in this.availableImages[t]=e,this.workerSources[t]){var i=this.workerSources[t][r];for(var o in i)i[o].availableImages=e}n()}},{key:"setLayers",value:function(t,e,n){this.getLayerIndex(t).replace(e),n()}},{key:"updateLayers",value:function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}},{key:"loadTile",value:function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)}},{key:"loadDEMTile",value:function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)}},{key:"reloadTile",value:function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)}},{key:"abortTile",value:function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}},{key:"removeTile",value:function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}},{key:"removeDEMTile",value:function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)}},{key:"removeSource",value:function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}}},{key:"loadWorkerSource",value:function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}},{key:"syncRTLPluginState",value:function(e,n,r){try{t.plugin.setState(n);var i=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=i){this.self.importScripts(i);var o=t.plugin.isParsed();r(o?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(i)),o)}}catch(t){r(t.toString())}}},{key:"getAvailableImages",value:function(t){var e=this.availableImages[t];return e||(e=[]),e}},{key:"getLayerIndex",value:function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e}},{key:"getWorkerSource",value:function(t,e,n){var r=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var i={send:function(e,n,i){r.actor.send(e,n,i,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](i,this.getLayerIndex(t),this.getAvailableImages(t))}return this.workerSources[t][e][n]}},{key:"getDEMWorkerSource",value:function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new v),this.demWorkerSources[t][e]}},{key:"enforceCacheSizeLimit",value:function(e,n){t.enforceCacheSizeLimit(n)}}]),e}();return t.isWorker()&&(self.worker=new Ot(self)),Ot})),y(["./shared"],(function(t){var e=n;function n(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===o[e=t&&t.failIfMajorPerformanceCaveat]&&(o[e]=function(t){var e,r=function(t){var e=document.createElement("canvas"),r=Object.create(n.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,e.getContext("webgl",r)||e.getContext("experimental-webgl",r)}(t);if(!r)return!1;try{e=r.createShader(r.VERTEX_SHADER)}catch(t){return!1}return!(!e||r.isContextLost())&&(r.shaderSource(e,"void main() {}"),r.compileShader(e),!0===r.getShaderParameter(e,r.COMPILE_STATUS))}(e)),o[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var o={};function u(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!u(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!u(t[r],e[r]))return!1;return!0}return t===e}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var c=function(){function e(){d(this,e)}return p(e,null,[{key:"testProp",value:function(t){if(!e.docStyle)return t[0];for(var n=0;n<t.length;n++)if(t[n]in e.docStyle)return t[n];return t[0]}},{key:"create",value:function(t,e,n){var r=window.document.createElement(t);return void 0!==e&&(r.className=e),n&&n.appendChild(r),r}},{key:"createNS",value:function(t,e){return window.document.createElementNS(t,e)}},{key:"disableDrag",value:function(){e.docStyle&&e.selectProp&&(e.userSelect=e.docStyle[e.selectProp],e.docStyle[e.selectProp]="none")}},{key:"enableDrag",value:function(){e.docStyle&&e.selectProp&&(e.docStyle[e.selectProp]=e.userSelect)}},{key:"setTransform",value:function(t,n){t.style[e.transformProp]=n}},{key:"addEventListener",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.addEventListener(e,n,"passive"in r?r:r.capture)}},{key:"removeEventListener",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.removeEventListener(e,n,"passive"in r?r:r.capture)}},{key:"suppressClickInternal",value:function(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",e.suppressClickInternal,!0)}},{key:"suppressClick",value:function(){window.addEventListener("click",e.suppressClickInternal,!0),window.setTimeout((function(){window.removeEventListener("click",e.suppressClickInternal,!0)}),0)}},{key:"mousePos",value:function(e,n){var r=e.getBoundingClientRect();return new t.pointGeometry(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)}},{key:"touchPos",value:function(e,n){for(var r=e.getBoundingClientRect(),i=[],o=0;o<n.length;o++)i.push(new t.pointGeometry(n[o].clientX-r.left-e.clientLeft,n[o].clientY-r.top-e.clientTop));return i}},{key:"mouseButton",value:function(t){return t.button}},{key:"remove",value:function(t){t.parentNode&&t.parentNode.removeChild(t)}}]),e}();c.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,c.selectProp=c.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),c.transformProp=c.testProp(["transform","WebkitTransform"]);var v=function(){function t(e){d(this,t),this._transformRequestFn=e}return p(t,[{key:"transformRequest",value:function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}},{key:"normalizeSpriteURL",value:function(t,e,n){var r=function(t){var e=t.match(y);if(!e)throw new Error('Unable to parse URL "'.concat(t,'"'));return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}(t);return r.path+="".concat(e).concat(n),function(t){var e=t.params.length?"?".concat(t.params.join("&")):"";return"".concat(t.protocol,"://").concat(t.authority).concat(t.path).concat(e)}(r)}},{key:"setTransformRequest",value:function(t){this._transformRequestFn=t}}]),t}(),y=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/,_=function(){function e(t,n,r,i){d(this,e),this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(n,i)}return p(e,[{key:"update",value:function(e,n,r){var i=e.width,o=e.height,a=!(this.size&&this.size[0]===i&&this.size[1]===o||r),s=this.context,l=s.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!n||!1!==n.premultiply)),a)this.size=[i,o],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,o,0,this.format,l.UNSIGNED_BYTE,e.data);else{var u=r||{x:0,y:0},c=u.x,h=u.y;e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texSubImage2D(l.TEXTURE_2D,0,c,h,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,c,h,i,o,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}},{key:"bind",value:function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}},{key:"isSizePowerOfTwo",value:function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}},{key:"destroy",value:function(){this.context.gl.deleteTexture(this.texture),this.texture=null}}]),e}();function x(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}var b=function(e){m(r,e);var n=g(r);function r(){var e;return d(this,r),(e=n.call(this)).images={},e.updatedImages={},e.callbackDispatchedThisFrame={},e.loaded=!1,e.requestors=[],e.patterns={},e.atlasImage=new t.RGBAImage({width:1,height:1}),e.dirty=!0,e}return p(r,[{key:"isLoaded",value:function(){return this.loaded}},{key:"setLoaded",value:function(t){if(this.loaded!==t&&(this.loaded=t,t)){var e,n=f(this.requestors);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.ids,o=r.callback;this._notify(i,o)}}catch(a){n.e(a)}finally{n.f()}this.requestors=[]}}},{key:"getImage",value:function(t){return this.images[t]}},{key:"addImage",value:function(t,e){if(this.images[t])throw new Error("Image id ".concat(t," already exist, use updateImage instead"));this._validate(t,e)&&(this.images[t]=e)}},{key:"_validate",value:function(e,n){var r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "content" value')))),r=!1),r}},{key:"_validateStretch",value:function(t,e){if(!t)return!0;var n,r=0,i=f(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o[0]<r||o[1]<o[0]||e<o[1])return!1;r=o[1]}}catch(a){i.e(a)}finally{i.f()}return!0}},{key:"_validateContent",value:function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}},{key:"updateImage",value:function(t,e){var n=this.images[t];if(n.data.width!==e.data.width||n.data.height!==e.data.height)throw new Error("size mismatch between old image (".concat(n.data.width,"x").concat(n.data.height,") and new image (").concat(e.data.width,"x").concat(e.data.height,")."));e.version=n.version+1,this.images[t]=e,this.updatedImages[t]=!0}},{key:"removeImage",value:function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}},{key:"listImages",value:function(){return Object.keys(this.images)}},{key:"getImages",value:function(t,e){var n=!0;if(!this.isLoaded()){var r,i=f(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.images[o]||(n=!1)}}catch(a){i.e(a)}finally{i.f()}}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}},{key:"_notify",value:function(e,n){var r,i={},o=f(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var s=this.images[a];s?i[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'.concat(a,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}}catch(l){o.e(l)}finally{o.f()}n(null,i)}},{key:"getPixelSize",value:function(){var t=this.atlasImage;return{width:t.width,height:t.height}}},{key:"getPattern",value:function(e){var n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(i,r);this.patterns[e]={bin:i,position:o}}return this._updatePatternAtlas(),this.patterns[e].position}},{key:"bind",value:function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}},{key:"_updatePatternAtlas",value:function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,h=this.images[s].data,f=h.width,p=h.height;t.RGBAImage.copy(h,a,{x:0,y:0},{x:u,y:c},{width:f,height:p}),t.RGBAImage.copy(h,a,{x:0,y:p-1},{x:u,y:c-1},{width:f,height:1}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:u,y:c+p},{width:f,height:1}),t.RGBAImage.copy(h,a,{x:f-1,y:0},{x:u-1,y:c},{width:1,height:p}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:u+f,y:c},{width:1,height:p})}this.dirty=!0}},{key:"beginFrame",value:function(){this.callbackDispatchedThisFrame={}}},{key:"dispatchRenderCallbacks",value:function(e){var n,r=f(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var o=this.images[i];o||t.warnOnce('Image with ID: "'.concat(i,'" was not found')),x(o)&&this.updateImage(i,o)}}}catch(a){r.e(a)}finally{r.f()}}}]),r}(t.Evented),w=1e20;function S(t,e,n,r,i,o,a,s,l){for(var u=e;u<e+r;u++)E(t,n*o+u,o,i,a,s,l);for(var c=n;c<n+i;c++)E(t,c*o+e,1,r,a,s,l)}function E(t,e,n,r,i,o,a){o[0]=0,a[0]=-w,a[1]=w,i[0]=t[e];for(var s=1,l=0,u=0;s<r;s++){i[s]=t[e+s*n];var c=s*s;do{var h=o[l];u=(i[s]-i[h]+c-h*h)/(s-h)/2}while(u<=a[l]&&--l>-1);o[++l]=s,a[l]=u,a[l+1]=w}for(var f=0,p=0;f<r;f++){for(;a[p+1]<f;)p++;var d=o[p],m=f-d;t[e+f*n]=i[d]+m*m}}var k=function(){function e(t,n){d(this,e),this.requestManager=t,this.localIdeographFontFamily=n,this.entries={}}return p(e,[{key:"setURL",value:function(t){this.url=t}},{key:"getGlyphs",value:function(n,r){var i=this,o=[];for(var a in n){var s,l=f(n[a]);try{for(l.s();!(s=l.n()).done;){var u=s.value;o.push({stack:a,id:u})}}catch(c){l.e(c)}finally{l.f()}}t.asyncAll(o,(function(t,n){var r=t.stack,o=t.id,a=i.entries[r];a||(a=i.entries[r]={glyphs:{},requests:{},ranges:{}});var s=a.glyphs[o];if(void 0===s){if(s=i._tinySDF(a,r,o))return a.glyphs[o]=s,void n(null,{stack:r,id:o,glyph:s});var l=Math.floor(o/256);if(256*l>65535)n(new Error("glyphs > 65535 not supported"));else if(a.ranges[l])n(null,{stack:r,id:o,glyph:s});else{var u=a.requests[l];u||(u=a.requests[l]=[],e.loadGlyphRange(r,l,i.url,i.requestManager,(function(t,e){if(e){for(var n in e)i._doesCharSupportLocalGlyph(+n)||(a.glyphs[+n]=e[+n]);a.ranges[l]=!0}var r,o=f(u);try{for(o.s();!(r=o.n()).done;)(0,r.value)(t,e)}catch(c){o.e(c)}finally{o.f()}delete a.requests[l]}))),u.push((function(t,e){t?n(t):e&&n(null,{stack:r,id:o,glyph:e[o]||null})}))}}else n(null,{stack:r,id:o,glyph:s})}),(function(t,e){if(t)r(t);else if(e){var n,i={},o=f(e);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.stack,l=a.id,u=a.glyph;(i[s]||(i[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}}catch(c){o.e(c)}finally{o.f()}r(null,i)}}))}},{key:"_doesCharSupportLocalGlyph",value:function(e){return!!this.localIdeographFontFamily&&(t.unicodeBlockLookup["CJK Unified Ideographs"](e)||t.unicodeBlockLookup["Hangul Syllables"](e)||t.unicodeBlockLookup.Hiragana(e)||t.unicodeBlockLookup.Katakana(e))}},{key:"_tinySDF",value:function(n,r,i){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(i)){var a=n.tinySDF;if(!a){var s="400";/bold/i.test(r)?s="900":/medium/i.test(r)?s="500":/light/i.test(r)&&(s="200"),a=n.tinySDF=new e.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:o,fontWeight:s})}var l=a.draw(String.fromCharCode(i));return{id:i,bitmap:new t.AlphaImage({width:l.width||30,height:l.height||30},l.data),metrics:{width:l.glyphWidth||24,height:l.glyphHeight||24,left:l.glyphLeft||0,top:l.glyphTop-27||-8,advance:l.glyphAdvance||24}}}}}]),e}();k.loadGlyphRange=function(e,n,r,i,o){var a=256*n,s=a+255,l=i.transformRequest(r.replace("{fontstack}",e).replace("{range}","".concat(a,"-").concat(s)),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,n){if(e)o(e);else if(n){var r,i={},a=f(t.parseGlyphPbf(n));try{for(a.s();!(r=a.n()).done;){var s=r.value;i[s.id]=s}}catch(l){a.e(l)}finally{a.f()}o(null,i)}}))},k.TinySDF=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.fontSize,r=void 0===n?24:n,i=e.buffer,o=void 0===i?3:i,a=e.radius,s=void 0===a?8:a,l=e.cutoff,u=void 0===l?.25:l,c=e.fontFamily,h=void 0===c?"sans-serif":c,f=e.fontWeight,p=void 0===f?"normal":f,m=e.fontStyle,g=void 0===m?"normal":m;d(this,t),this.buffer=o,this.cutoff=u,this.radius=s;var v=this.size=r+4*o,y=this._createCanvas(v),_=this.ctx=y.getContext("2d",{willReadFrequently:!0});_.font="".concat(g," ").concat(p," ").concat(r,"px ").concat(h),_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}return p(t,[{key:"_createCanvas",value:function(t){var e=document.createElement("canvas");return e.width=e.height=t,e}},{key:"draw",value:function(t){var e=this.ctx.measureText(t),n=e.width,r=e.actualBoundingBoxAscent,i=e.actualBoundingBoxDescent,o=e.actualBoundingBoxLeft,a=e.actualBoundingBoxRight,s=Math.ceil(r),l=Math.min(this.size-this.buffer,Math.ceil(a-o)),u=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=l+2*this.buffer,h=u+2*this.buffer,f=Math.max(c*h,0),p=new Uint8ClampedArray(f),d={data:p,width:c,height:h,glyphWidth:l,glyphHeight:u,glyphTop:s,glyphLeft:0,glyphAdvance:n};if(0===l||0===u)return d;var m=this.ctx,g=this.buffer,v=this.gridInner,y=this.gridOuter;m.clearRect(g,g,l,u),m.fillText(t,g,g+s);var _=m.getImageData(g,g,l,u);y.fill(w,0,f),v.fill(0,0,f);for(var x=0;x<u;x++)for(var b=0;b<l;b++){var E=_.data[4*(x*l+b)+3]/255;if(0!==E){var k=(x+g)*c+b+g;if(1===E)y[k]=0,v[k]=w;else{var C=.5-E;y[k]=C>0?C*C:0,v[k]=C<0?C*C:0}}}S(y,0,0,c,h,c,this.f,this.v,this.z),S(v,g,g,l,u,c,this.f,this.v,this.z);for(var I=0;I<f;I++){var T=Math.sqrt(y[I])-Math.sqrt(v[I]);p[I]=Math.round(255-255*(T/this.radius+this.cutoff))}return d}}]),t}();var C=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new(function(){function e(){d(this,e),this.specification=t.spec.light.position}return p(e,[{key:"possiblyEvaluate",value:function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))}},{key:"interpolate",value:function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}}}]),e}()),color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),I="-transition",T=function(e){m(r,e);var n=g(r);function r(e){var i;return d(this,r),(i=n.call(this))._transitionable=new t.Transitionable(C),i.setLight(e),i._transitioning=i._transitionable.untransitioned(),i}return p(r,[{key:"getLight",value:function(){return this._transitionable.serialize()}},{key:"setLight",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateLight,e,n))for(var r in e){var i=e[r];r.endsWith(I)?this._transitionable.setTransition(r.slice(0,-I.length),i):this._transitionable.setValue(r,i)}}},{key:"updateTransitions",value:function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(t){this.properties=this._transitioning.possiblyEvaluate(t)}},{key:"_validate",value:function(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}]),r}(t.Evented),P=function(){function e(t,n){d(this,e),this.width=t,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}return p(e,[{key:"getDash",value:function(t,e){var n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]}},{key:"getDashRanges",value:function(t,e,n){var r=[],i=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,a=!0;r.push({left:i,right:o,isDash:a,zeroLength:0===t[0]});for(var s=t[0],l=1;l<t.length;l++){a=!a;var u=t[l];i=s*n,o=(s+=u)*n,r.push({left:i,right:o,isDash:a,zeroLength:0===u})}return r}},{key:"addRoundDash",value:function(t,e,n){for(var r=e/2,i=-n;i<=n;i++)for(var o=this.width*(this.nextRow+n+i),a=0,s=t[a],l=0;l<this.width;l++){l/s.right>1&&(s=t[++a]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),h=Math.min(u,c),f=void 0,p=i/n*(r+1);if(s.isDash){var d=r-Math.abs(p);f=Math.sqrt(h*h+d*d)}else f=r-Math.sqrt(h*h+p*p);this.data[o+l]=Math.max(0,Math.min(255,f+128))}}},{key:"addRegularDash",value:function(t){for(var e=t.length-1;e>=0;--e){var n=t[e],r=t[e+1];n.zeroLength?t.splice(e,1):r&&r.isDash===n.isDash&&(r.left=n.left,t.splice(e,1))}var i=t[0],o=t[t.length-1];i.isDash===o.isDash&&(i.left=o.left-this.width,o.right=i.right+this.width);for(var a=this.width*this.nextRow,s=0,l=t[s],u=0;u<this.width;u++){u/l.right>1&&(l=t[++s]);var c=Math.abs(u-l.left),h=Math.abs(u-l.right),f=Math.min(c,h);this.data[a+u]=Math.max(0,Math.min(255,(l.isDash?f:-f)+128))}}},{key:"addDash",value:function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];if(0!==o){var s=this.width/o,l=this.getDashRanges(e,this.width,s);n?this.addRoundDash(l,s,r):this.addRegularDash(l)}var u={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,u}},{key:"bind",value:function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}]),e}(),A=function(){function e(n,r){d(this,e),this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=new e.Actor(i[o],r,this.id);a.name="Worker ".concat(o),this.actors.push(a)}if(!this.actors.length)throw new Error("No actors found")}return p(e,[{key:"broadcast",value:function(e,n,r){t.asyncAll(this.actors,(function(t,r){t.send(e,n,r)}),r=r||function(){})}},{key:"getActor",value:function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}},{key:"remove",value:function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)}}]),e}();function M(e,n,r){var i=function(n,i){if(n)return r(n);if(i){var o=t.pick(t.extend(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(o.vectorLayers=i.vector_layers,o.vectorLayerIds=o.vectorLayers.map((function(t){return t.id}))),r(null,o)}};return e.url?t.getJSON(n.transformRequest(e.url,t.ResourceType.Source),i):t.exported.frame((function(){return i(null,e)}))}A.Actor=t.Actor;var L,R=function(){function e(n,r,i){d(this,e),this.bounds=t.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=r||0,this.maxzoom=i||24}return p(e,[{key:"validateBounds",value:function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}},{key:"contains",value:function(e){var n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<o&&e.y>=i&&e.y<a}}]),e}(),D=function(e){m(r,e);var n=g(r);function r(e,o,a,s){var u;if(d(this,r),(u=n.call(this)).id=e,u.dispatcher=a,u.type="vector",u.minzoom=0,u.maxzoom=22,u.scheme="xyz",u.tileSize=512,u.reparseOverscaled=!0,u.isTileClipped=!0,u._loaded=!1,t.extend(i(u),t.pick(o,["url","scheme","tileSize","promoteId"])),u._options=t.extend({type:"vector"},o),u._collectResourceTiming=o.collectResourceTiming,512!==u.tileSize)throw new Error("vector tile sources must have a tileSize of 512");return u.setEventedParent(s),l(u)}return p(r,[{key:"load",value:function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=M(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,e.map.style.sourceCaches[e.id].clearTiles(),n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new R(r.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}},{key:"loaded",value:function(){return this._loaded}},{key:"hasTile",value:function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}},{key:"onAdd",value:function(t){this.map=t,this.load()}},{key:"setSourceProperty",value:function(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}},{key:"setTiles",value:function(t){var e=this;return this.setSourceProperty((function(){e._options.tiles=t})),this}},{key:"setUrl",value:function(t){var e=this;return this.setSourceProperty((function(){e.url=t,e._options.url=t})),this}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return t.extend({},this._options)}},{key:"loadTile",value:function(e,n){var r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",i,o.bind(this)))}},{key:"abortTile",value:function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}},{key:"unloadTile",value:function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}},{key:"hasTransition",value:function(){return!1}}]),r}(t.Evented),N=function(e){m(r,e);var n=g(r);function r(e,o,a,s){var l;return d(this,r),(l=n.call(this)).id=e,l.dispatcher=a,l.setEventedParent(s),l.type="raster",l.minzoom=0,l.maxzoom=22,l.roundZoom=!0,l.scheme="xyz",l.tileSize=512,l._loaded=!1,l._options=t.extend({type:"raster"},o),t.extend(i(l),t.pick(o,["url","scheme","tileSize"])),l}return p(r,[{key:"load",value:function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=M(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new R(r.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(t){this.map=t,this.load()}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return t.extend({},this._options)}},{key:"hasTile",value:function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}},{key:"loadTile",value:function(e,n){var r=this,i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,o,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&e.setExpiryData(a);var s=r.map.painter.context,l=s.gl;e.texture=r.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new _(s,o,l.RGBA,{useMipmap:!0}),e.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),s.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(r.dispatcher),n(null)}}))}},{key:"abortTile",value:function(t,e){t.request&&(t.request.cancel(),delete t.request),e()}},{key:"unloadTile",value:function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}},{key:"hasTransition",value:function(){return!1}}]),r}(t.Evented),z=function(e){m(r,e);var n=g(r);function r(e,i,o,a){var s;return d(this,r),(s=n.call(this,e,i,o,a)).type="raster-dem",s.maxzoom=22,s._options=t.extend({type:"raster-dem"},i),s.encoding=i.encoding||"mapbox",s}return p(r,[{key:"serialize",value:function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}},{key:"loadTile",value:function(e,n){var r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=t.isImageBitmap(o)&&(null==L&&(L="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),L)?o:t.exported.getImageData(o,1),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",s,i.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)}},{key:"_getNeighboringTiles",value:function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l}},{key:"unloadTile",value:function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}]),r}(N),O=function(e){m(r,e);var n=g(r);function r(e,i,o,a){var s;d(this,r),(s=n.call(this)).id=e,s.type="geojson",s.minzoom=0,s.maxzoom=18,s.tileSize=512,s.isTileClipped=!0,s.reparseOverscaled=!0,s._removed=!1,s._pendingLoads=0,s.actor=o.getActor(),s.setEventedParent(a),s._data=i.data,s._options=t.extend({},i),s._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(s.maxzoom=i.maxzoom),i.type&&(s.type=i.type),i.attribution&&(s.attribution=i.attribution),s.promoteId=i.promoteId;var l=t.EXTENT/s.tileSize;return s.workerOptions=t.extend({source:s.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*l,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*l,extent:t.EXTENT,maxZoom:s.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:s.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.EXTENT,radius:(i.clusterRadius||50)*l,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),s}return p(r,[{key:"load",value:function(){this._updateWorkerData("metadata")}},{key:"onAdd",value:function(t){this.map=t,this.load()}},{key:"setData",value:function(t){return this._data=t,this._updateWorkerData("content"),this}},{key:"getClusterExpansionZoom",value:function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}},{key:"getClusterChildren",value:function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}},{key:"getClusterLeaves",value:function(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this}},{key:"_updateWorkerData",value:function(e){var n=this,r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(t.exported.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this._pendingLoads++,this.fire(new t.Event("dataloading",{dataType:"source"})),this.actor.send("".concat(this.type,".loadData"),r,(function(r,i){if(n._pendingLoads--,n._removed||i&&i.abandoned)n.fire(new t.Event("dataabort",{dataType:"source",sourceDataType:e}));else{var o=null;if(i&&i.resourceTiming&&i.resourceTiming[n.id]&&(o=i.resourceTiming[n.id].slice(0)),r)n.fire(new t.ErrorEvent(r));else{var a={dataType:"source",sourceDataType:e};n._collectResourceTiming&&o&&o.length>0&&t.extend(a,{resourceTiming:o}),n.fire(new t.Event("data",a))}}}))}},{key:"loaded",value:function(){return 0===this._pendingLoads}},{key:"loadTile",value:function(t,e){var n=this,r=t.actor?"reloadTile":"loadTile";t.actor=this.actor;var i={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(r,i,(function(i,o){return delete t.request,t.unloadVectorData(),t.aborted?e(null):i?e(i):(t.loadVectorData(o,n.map.painter,"reloadTile"===r),e(null))}))}},{key:"abortTile",value:function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}},{key:"unloadTile",value:function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}},{key:"onRemove",value:function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}},{key:"serialize",value:function(){return t.extend({},this._options,{type:this.type,data:this._data})}},{key:"hasTransition",value:function(){return!1}}]),r}(t.Evented),F=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),B=function(e){m(r,e);var n=g(r);function r(t,e,i,o){var a;return d(this,r),(a=n.call(this)).id=t,a.dispatcher=i,a.coordinates=e.coordinates,a.type="image",a.minzoom=0,a.maxzoom=22,a.tileSize=512,a.tiles={},a._loaded=!1,a.setEventedParent(o),a.options=e,a}return p(r,[{key:"load",value:function(e,n){var r=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(i,o){r._loaded=!0,i?r.fire(new t.ErrorEvent(i)):o&&(r.image=o,e&&(r.coordinates=e),n&&n(),r._finishLoading())}))}},{key:"loaded",value:function(){return this._loaded}},{key:"updateImage",value:function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this}},{key:"_finishLoading",value:function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}},{key:"onAdd",value:function(t){this.map=t,this.load()}},{key:"setCoordinates",value:function(e){var n=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){var n,r=1/0,i=1/0,o=-1/0,a=-1/0,s=f(e);try{for(s.s();!(n=s.n()).done;){var l=n.value;r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y)}}catch(p){s.e(p)}finally{s.f()}var u=Math.max(o-r,a-i),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),h=Math.pow(2,c);return new t.CanonicalTileID(c,Math.floor((r+o)/2*h),Math.floor((i+a)/2*h))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}},{key:"prepare",value:function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}}},{key:"loadTile",value:function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}},{key:"serialize",value:function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return!1}}]),r}(t.Evented),j=function(e){m(r,e);var n=g(r);function r(t,e,i,o){var a;return d(this,r),(a=n.call(this,t,e,i,o)).roundZoom=!0,a.type="video",a.options=e,a}return p(r,[{key:"load",value:function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];var r,i=f(n.urls);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.urls.push(this.map._requestManager.transformRequest(o,t.ResourceType.Source).url)}}catch(a){i.e(a)}finally{i.f()}t.getVideo(this.urls,(function(n,r){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"play",value:function(){this.video&&this.video.play()}},{key:"seek",value:function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=e}}},{key:"getVideo",value:function(){return this.video}},{key:"onAdd",value:function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}},{key:"prepare",value:function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new _(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}}},{key:"serialize",value:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this.video&&!this.video.paused}}]),r}(B),U=function(e){m(r,e);var n=g(r);function r(e,i,o,a){var s;return d(this,r),s=n.call(this,e,i,o,a),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||s.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):s.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&s.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof HTMLCanvasElement||s.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):s.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "canvas"'))),s.options=i,s.animate=void 0===i.animate||i.animate,s}return p(r,[{key:"load",value:function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}},{key:"getCanvas",value:function(){return this.canvas}},{key:"onAdd",value:function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}},{key:"onRemove",value:function(){this.pause()}},{key:"prepare",value:function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}}},{key:"serialize",value:function(){return{type:"canvas",coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this._playing}},{key:"_hasInvalidDimensions",value:function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t++){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1}}]),r}(B),V={vector:D,raster:N,"raster-dem":z,geojson:O,video:j,image:B,canvas:U};function Z(e,n){var r=t.create();return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function q(t,e,n,r,i,o){var a=function(t,e,n){if(t){var r,i=f(t);try{for(i.s();!(r=i.n()).done;){var o=e[r.value];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}}catch(l){i.e(l)}finally{i.f()}}else for(var a in e){var s=e[a];if(s.source===n&&"fill-extrusion"===s.type)return!0}return!1}(i&&i.layers,e,t.id),s=o.maxPitchScaleFactor(),l=t.tilesIn(r,s,a);l.sort(G);var u,c=[],h=f(l);try{for(h.s();!(u=h.n()).done;){var p=u.value;c.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,n,t._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,i,o,s,Z(t.transform,p.tileID))})}}catch(g){h.e(g)}finally{h.f()}var d=function(t){var e,n={},r={},i=f(t);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=o.queryResults,s=o.wrappedTileID,l=r[s]=r[s]||{};for(var u in a){var c,h=a[u],p=l[u]=l[u]||{},d=n[u]=n[u]||[],m=f(h);try{for(m.s();!(c=m.n()).done;){var v=c.value;p[v.featureIndex]||(p[v.featureIndex]=!0,d.push(v))}}catch(g){m.e(g)}finally{m.f()}}}}catch(g){i.e(g)}finally{i.f()}return n}(c);for(var m in d)d[m].forEach((function(e){var n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return d}function G(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var W=function(){function e(n,r){d(this,e),this.tileID=n,this.uid=t.uniqueId(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}return p(e,[{key:"registerFadeDuration",value:function(e){var n=e+this.timeAdded;n<t.exported.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}},{key:"wasRequested",value:function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}},{key:"clearTextures",value:function(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.textures.forEach((function(e){return t.saveTileTexture(e)})),this.demTexture=null,this.textures=[],this.textureCoords={}}},{key:"loadVectorData",value:function(e,n,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var i in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;var r,i=f(t);try{var o=function(){var t=r.value,i=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==i.length){t.layers=i,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return i.filter((function(e){return e.id===t}))[0]})));var o,a=f(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s.id]=t}}catch(l){a.e(l)}finally{a.f()}}};for(i.s();!(r=i.n()).done;)o()}catch(a){i.e(a)}finally{i.f()}return n}(e.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var o=this.buckets[i];if(o instanceof t.SymbolBucket){if(this.hasSymbolBuckets=!0,!r)break;o.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var s=this.buckets[a];if(s instanceof t.SymbolBucket&&s.hasRTLText){this.hasRTLText=!0,t.lazyLoadRTLTextPlugin();break}}for(var l in this.queryPadding=0,this.buckets){var u=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(l).queryRadius(u))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray}},{key:"unloadVectorData",value:function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}},{key:"getBucket",value:function(t){return this.buckets[t.id]}},{key:"upload",value:function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}},{key:"prepare",value:function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}},{key:"queryRenderedFeatures",value:function(t,e,n,r,i,o,a,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:a,queryPadding:this.queryPadding*l},t,e,n):{}}},{key:"querySourceFeatures",value:function(e,n){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var i=r.loadVTLayers(),o=n?n.sourceLayer:"",a=i._geojsonTileLayer||i[o];if(a)for(var s=t.createFilter(n&&n.filter),l=this.tileID.canonical,u=l.z,c=l.x,h=l.y,f={z:u,x:c,y:h},p=0;p<a.length;p++){var d=a.feature(p);if(s.needGeometry){var m=t.toEvaluationFeature(d,!0);if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),m,this.tileID.canonical))continue}else if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),d))continue;var g=r.getId(d,o),v=new t.GeoJSONFeature(d,u,c,h,g);v.tile=f,e.push(v)}}}},{key:"hasData",value:function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}},{key:"patternsLoaded",value:function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}},{key:"setExpiryData",value:function(e){var n=this.expirationTime;if(e.cacheControl){var r=t.parseCacheControl(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var i=Date.now(),o=!1;if(this.expirationTime>i)o=!1;else if(n)if(this.expirationTime<n)o=!0;else{var a=this.expirationTime-n;a?this.expirationTime=i+Math.max(a,3e4):o=!0}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}},{key:"getExpiryTimeout",value:function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}},{key:"setFeatureState",value:function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(e.style.hasLayer(r)){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];if(a&&s&&0!==Object.keys(s).length){i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}}}},{key:"holdingForFade",value:function(){return void 0!==this.symbolFadeHoldUntil}},{key:"symbolFadeFinished",value:function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<t.exported.now()}},{key:"clearFadeHold",value:function(){this.symbolFadeHoldUntil=void 0}},{key:"setHoldDuration",value:function(e){this.symbolFadeHoldUntil=t.exported.now()+e}},{key:"setDependencies",value:function(t,e){var n,r={},i=f(e);try{for(i.s();!(n=i.n()).done;)r[n.value]=!0}catch(o){i.e(o)}finally{i.f()}this.dependencies[t]=r}},{key:"hasDependency",value:function(t,e){var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.dependencies[i];if(o){var a,s=f(e);try{for(s.s();!(a=s.n()).done;)if(o[a.value])return!0}catch(l){s.e(l)}finally{s.f()}}}}catch(l){r.e(l)}finally{r.f()}return!1}}]),e}(),X=function(){function t(e,n){d(this,t),this.max=e,this.onRemove=n,this.reset()}return p(t,[{key:"reset",value:function(){for(var t in this.data){var e,n=f(this.data[t]);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}}catch(i){n.e(i)}finally{n.f()}}return this.data={},this.order=[],this}},{key:"add",value:function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){r.remove(t,o)}),n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}},{key:"has",value:function(t){return t.wrapped().key in this.data}},{key:"getAndRemove",value:function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}},{key:"_getAndRemoveByKey",value:function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}},{key:"getByKey",value:function(t){var e=this.data[t];return e?e[0].value:null}},{key:"get",value:function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}},{key:"remove",value:function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this}},{key:"setMaxSize",value:function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}},{key:"filter",value:function(t){var e=[];for(var n in this.data){var r,i=f(this.data[n]);try{for(i.s();!(r=i.n()).done;){var o=r.value;t(o.value)||e.push(o)}}catch(u){i.e(u)}finally{i.f()}}for(var a=0,s=e;a<s.length;a++){var l=s[a];this.remove(l.value.tileID,l)}}}]),t}(),H=function(){function e(){d(this,e),this.state={},this.stateChanges={},this.deletedStates={}}return p(e,[{key:"updateState",value:function(e,n,r){var i=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.extend(this.stateChanges[e][i],r),null===this.deletedStates[e])for(var o in this.deletedStates[e]={},this.state[e])o!==i&&(this.deletedStates[e][o]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][i])for(var a in this.deletedStates[e][i]={},this.state[e][i])r[a]||(this.deletedStates[e][i][a]=null);else for(var s in r)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][s]&&delete this.deletedStates[e][i][s]}},{key:"removeFeatureState",value:function(t,e,n){if(null!==this.deletedStates[t]){var r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}}},{key:"getState",value:function(e,n){var r=String(n),i=t.extend({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var o=this.deletedStates[e][n];if(null===o)return{};for(var a in o)delete i[a]}return i}},{key:"initializeTileState",value:function(t,e){t.setFeatureState(this.state,e)}},{key:"coalesceChanges",value:function(e,n){var r={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var o={};for(var a in this.stateChanges[i])this.state[i][a]||(this.state[i][a]={}),t.extend(this.state[i][a],this.stateChanges[i][a]),o[a]=this.state[i][a];r[i]=o}for(var s in this.deletedStates){this.state[s]=this.state[s]||{};var l={};if(null===this.deletedStates[s])for(var u in this.state[s])l[u]={},this.state[s][u]={};else for(var c in this.deletedStates[s]){if(null===this.deletedStates[s][c])this.state[s][c]={};else for(var h=0,f=Object.keys(this.deletedStates[s][c]);h<f.length;h++){var p=f[h];delete this.state[s][c][p]}l[c]=this.state[s][c]}r[s]=r[s]||{},t.extend(r[s],l)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in e)e[d].setFeatureState(r,n)}}]),e}(),Y=function(e){m(r,e);var n=g(r);function r(e,o,a){var s;return d(this,r),(s=n.call(this)).id=e,s.dispatcher=a,s.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(s._sourceLoaded=!0),s._sourceLoaded&&!s._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(s.reload(),s.transform&&s.update(s.transform,s.terrain))})),s.on("dataloading",(function(){s._sourceErrored=!1})),s.on("error",(function(){s._sourceErrored=s._source.loaded()})),s._source=function(e,n,r,i){var o=new V[n.type](e,n,r,i);if(o.id!==e)throw new Error("Expected Source id to be ".concat(e," instead of ").concat(o.id));return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(e,o,a,i(s)),s._tiles={},s._cache=new X(0,s._unloadTile.bind(i(s))),s._timers={},s._cacheTimers={},s._maxTileCacheSize=null,s._loadedParentTiles={},s._coveredTiles={},s._state=new H,s}return p(r,[{key:"onAdd",value:function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}},{key:"onRemove",value:function(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}},{key:"loaded",value:function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}},{key:"getSource",value:function(){return this._source}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}}},{key:"_loadTile",value:function(t,e){return this._source.loadTile(t,e)}},{key:"_unloadTile",value:function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))}},{key:"_abortTile",value:function(e){this._source.abortTile&&this._source.abortTile(e,(function(){})),this._source.fire(new t.Event("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}},{key:"serialize",value:function(){return this._source.serialize()}},{key:"prepare",value:function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}},{key:"getIds",value:function(){return Object.values(this._tiles).map((function(t){return t.tileID})).sort($).map((function(t){return t.key}))}},{key:"getRenderableIds",value:function(e){var n=this,r=[];for(var i in this._tiles)this._isIdRenderable(i,e)&&r.push(this._tiles[i]);return e?r.sort((function(e,r){var i=e.tileID,o=r.tileID,a=new t.pointGeometry(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new t.pointGeometry(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(t){return t.tileID.key})):r.map((function(t){return t.tileID})).sort($).map((function(t){return t.key}))}},{key:"hasRenderableParent",value:function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}},{key:"_isIdRenderable",value:function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}},{key:"reload",value:function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}},{key:"_reloadTile",value:function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}},{key:"_tileLoaded",value:function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform,this.terrain));e.timeAdded=t.exported.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))}},{key:"_backfillDEM",value:function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}},{key:"getTile",value:function(t){return this.getTileByID(t.key)}},{key:"getTileByID",value:function(t){return this._tiles[t]}},{key:"_retainLoadedChildren",value:function(t,e,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){r[a.key]=a;break}}}}},{key:"findLoadedParent",value:function(t,e){if(t.key in this._loadedParentTiles){var n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(var r=t.overscaledZ-1;r>=e;r--){var i=t.scaledTo(r),o=this._getLoadedTile(i);if(o)return o}}},{key:"_getLoadedTile",value:function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}},{key:"updateCacheSize",value:function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*n*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)}},{key:"handleWrapJump",value:function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var n={};for(var r in this._tiles){var i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),n[i.tileID.key]=i}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}}},{key:"update",value:function(e,n){var i=this;if(this.transform=e,this.terrain=n,this._sourceLoaded&&!this._paused){var o;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?o=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(o=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(o=o.filter((function(t){return i._source.hasTile(t)})))):o=[];var a=e.coveringZoomLevel(this._source),s=Math.max(a-r.maxOverzooming,this._source.minzoom),l=Math.max(a+r.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){var u,c={},h=f(o);try{for(h.s();!(u=h.n()).done;){var p=u.value;if(p.canonical.z>this._source.minzoom){var d=p.scaledTo(p.canonical.z-1);c[d.key]=d;var m=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));c[m.key]=m}}}catch(Z){h.e(Z)}finally{h.f()}o=o.concat(Object.values(c))}var g=this._updateRetainedTiles(o,a);if(K(this._source.type)){for(var v={},y={},_=0,x=Object.keys(g);_<x.length;_++){var b=x[_],w=g[b],S=this._tiles[b];if(S&&!(S.fadeEndTime&&S.fadeEndTime<=t.exported.now())){var E=this.findLoadedParent(w,s);E&&(this._addTile(E.tileID),v[E.tileID.key]=E.tileID),y[b]=w}}for(var k in this._retainLoadedChildren(y,a,l,g),v)g[k]||(this._coveredTiles[k]=!0,g[k]=v[k]);if(n){var C,I={},T={},P=f(o);try{for(P.s();!(C=P.n()).done;){var A=C.value;this._tiles[A.key].hasData()?I[A.key]=A:T[A.key]=A}}catch(Z){P.e(Z)}finally{P.f()}for(var M in T){var L=T[M].children(this._source.maxzoom);this._tiles[L[0].key]&&this._tiles[L[1].key]&&this._tiles[L[2].key]&&this._tiles[L[3].key]&&(I[L[0].key]=g[L[0].key]=L[0],I[L[1].key]=g[L[1].key]=L[1],I[L[2].key]=g[L[2].key]=L[2],I[L[3].key]=g[L[3].key]=L[3],delete T[M])}for(var R in T){var D=this.findLoadedParent(T[R],this._source.minzoom);if(D)for(var N in I[D.tileID.key]=g[D.tileID.key]=D.tileID,I)I[N].isChildOf(D.tileID)&&delete I[N]}for(var z in this._tiles)I[z]||(this._coveredTiles[z]=!0)}}for(var O in g)this._tiles[O].clearFadeHold();var F,B=t.keysDifference(this._tiles,g),j=f(B);try{for(j.s();!(F=j.n()).done;){var U=F.value,V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}}catch(Z){j.e(Z)}finally{j.f()}this._updateLoadedParentTileCache()}}},{key:"releaseSymbolFadeTiles",value:function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}},{key:"_updateRetainedTiles",value:function(t,e){var n,i={},o={},a=Math.max(e-r.maxOverzooming,this._source.minzoom),s=Math.max(e+r.maxUnderzooming,this._source.minzoom),l={},u=f(t);try{for(u.s();!(n=u.n()).done;){var c=n.value,h=this._addTile(c);i[c.key]=c,h.hasData()||e<this._source.maxzoom&&(l[c.key]=c)}}catch(S){u.e(S)}finally{u.f()}this._retainLoadedChildren(l,e,s,i);var p,d=f(t);try{for(d.s();!(p=d.n()).done;){var m=p.value,g=this._tiles[m.key];if(!g.hasData()){if(e+1>this._source.maxzoom){var v=m.children(this._source.maxzoom)[0],y=this.getTile(v);if(y&&y.hasData()){i[v.key]=v;continue}}else{var _=m.children(this._source.maxzoom);if(i[_[0].key]&&i[_[1].key]&&i[_[2].key]&&i[_[3].key])continue}for(var x=g.wasRequested(),b=m.overscaledZ-1;b>=a;--b){var w=m.scaledTo(b);if(o[w.key])break;if(o[w.key]=!0,!(g=this.getTile(w))&&x&&(g=this._addTile(w)),g&&(i[w.key]=w,x=g.wasRequested(),g.hasData()))break}}}}catch(S){d.e(S)}finally{d.f()}return i}},{key:"_updateLoadedParentTileCache",value:function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],n=void 0,r=this._tiles[t].tileID;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);var i=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(i))break;r=i}for(var o=0,a=e;o<a.length;o++){var s=a[o];this._loadedParentTiles[s]=n}}}},{key:"_addTile",value:function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=n;return n||(n=new W(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}},{key:"_setTileReloadTimer",value:function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),r))}},{key:"_removeTile",value:function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}},{key:"clearTiles",value:function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()}},{key:"tilesIn",value:function(e,n,r){var i=this,o=[],a=this.transform;if(!a)return o;var s,l=r?a.getCameraQueryGeometry(e):e,u=e.map((function(t){return a.pointCoordinate(t,i.terrain)})),c=l.map((function(t){return a.pointCoordinate(t,i.terrain)})),h=this.getIds(),p=1/0,d=1/0,m=-1/0,g=-1/0,v=f(c);try{for(v.s();!(s=v.n()).done;){var y=s.value;p=Math.min(p,y.x),d=Math.min(d,y.y),m=Math.max(m,y.x),g=Math.max(g,y.y)}}catch(b){v.e(b)}finally{v.f()}for(var _=function(e){var r=i._tiles[h[e]];if(r.holdingForFade())return"continue";var s=r.tileID,l=Math.pow(2,a.zoom-r.tileID.overscaledZ),f=n*r.queryPadding*t.EXTENT/r.tileSize/l,v=[s.getTilePoint(new t.MercatorCoordinate(p,d)),s.getTilePoint(new t.MercatorCoordinate(m,g))];if(v[0].x-f<t.EXTENT&&v[0].y-f<t.EXTENT&&v[1].x+f>=0&&v[1].y+f>=0){var y=u.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));o.push({tile:r,tileID:s,queryGeometry:y,cameraQueryGeometry:_,scale:l})}},x=0;x<h.length;x++)_(x);return o}},{key:"getVisibleCoordinates",value:function(t){var e,n=this,r=this.getRenderableIds(t).map((function(t){return n._tiles[t].tileID})),i=f(r);try{for(i.s();!(e=i.n()).done;){var o=e.value;o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}}catch(a){i.e(a)}finally{i.f()}return r}},{key:"hasTransition",value:function(){if(this._source.hasTransition())return!0;if(K(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.exported.now())return!0}return!1}},{key:"setFeatureState",value:function(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}},{key:"removeFeatureState",value:function(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}},{key:"getFeatureState",value:function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}},{key:"setDependencies",value:function(t,e,n){var r=this._tiles[t];r&&r.setDependencies(e,n)}},{key:"reloadTilesForDependencies",value:function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))}}]),r}(t.Evented);function $(t,e){var n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function K(t){return"raster"===t||"image"===t||"video"===t}Y.maxOverzooming=10,Y.maxUnderzooming=3;var J,Q="mapboxgl_preloaded_worker_pool",tt=function(){function t(){d(this,t),this.active={}}return p(t,[{key:"acquire",value:function(e){if(!this.workers)for(this.workers=[];this.workers.length<t.workerCount;)this.workers.push(new Worker(Li.workerUrl));return this.active[e]=!0,this.workers.slice()}},{key:"release",value:function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)}},{key:"isPreloaded",value:function(){return!!this.active[Q]}},{key:"numActive",value:function(){return Object.keys(this.active).length}}]),t}(),et=Math.floor(t.exported.hardwareConcurrency/2);function nt(){return J||(J=new tt),J}function rt(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach((function(t){t in n&&(r[t]=n[t])})),r}function it(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=rt(t[r],e[t[r].ref]));return t}tt.workerCount=Math.max(Math.min(et,6),1);var ot={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function at(t,e,n){n.push({command:ot.addSource,args:[t,e[t]]})}function st(t,e,n){e.push({command:ot.removeSource,args:[t]}),n[t]=!0}function lt(t,e,n,r){st(t,n,r),at(t,e,n)}function ut(t,e,n){var r;for(r in t[n])if(Object.prototype.hasOwnProperty.call(t[n],r)&&"data"!==r&&!u(t[n][r],e[n][r]))return!1;for(r in e[n])if(Object.prototype.hasOwnProperty.call(e[n],r)&&"data"!==r&&!u(t[n][r],e[n][r]))return!1;return!0}function ct(t,e,n,r,i,o){var a;for(a in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,a)&&(u(t[a],e[a])||n.push({command:o,args:[r,a,e[a],i]}));for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&!Object.prototype.hasOwnProperty.call(t,a)&&(u(t[a],e[a])||n.push({command:o,args:[r,a,e[a],i]}))}function ht(t){return t.id}function ft(t,e){return t[e.id]=e,t}var pt=function(){function e(t,n){d(this,e),this.reset(t,n)}return p(e,[{key:"reset",value:function(t,e){this.points=t||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}},{key:"lerp",value:function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var n=1,r=this._distances[n],i=e*this.paddedLength+this.padding;r<i&&n<this._distances.length;)r=this._distances[++n];var o=n-1,a=this._distances[o],s=r-a,l=s>0?(i-a)/s:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}]),e}();function dt(t,e){var n=!0;return"always"===t||"never"!==t&&"never"!==e||(n=!1),n}var mt=function(){function t(e,n,r){d(this,t);var i=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(n/r);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}return p(t,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"insertCircle",value:function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)}},{key:"_insertBoxCell",value:function(t,e,n,r,i,o){this.boxCells[i].push(o)}},{key:"_insertCircleCell",value:function(t,e,n,r,i,o){this.circleCells[i].push(o)}},{key:"_query",value:function(t,e,n,r,i,o,a){if(n<0||t>this.width||r<0||e>this.height)return[];var s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return[{key:null,x1:t,y1:e,x2:n,y2:r}];for(var l=0;l<this.boxKeys.length;l++)s.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],h=this.circles[3*u+1],f=this.circles[3*u+2];s.push({key:this.circleKeys[u],x1:c-f,y1:h-f,x2:c+f,y2:h+f})}}else this._forEachCell(t,e,n,r,this._queryCell,s,{hitTest:i,overlapMode:o,seenUids:{box:{},circle:{}}},a);return s}},{key:"query",value:function(t,e,n,r){return this._query(t,e,n,r,!1,null)}},{key:"hitTest",value:function(t,e,n,r,i,o){return this._query(t,e,n,r,!0,i,o).length>0}},{key:"hitTestCircle",value:function(t,e,n,r,i){var o=t-n,a=t+n,s=e-n,l=e+n;if(a<0||o>this.width||l<0||s>this.height)return!1;var u=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,u,{hitTest:!0,overlapMode:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},i),u.length>0}},{key:"_queryCell",value:function(t,e,n,r,i,o,a,s){var l=a.seenUids,u=a.hitTest,c=a.overlapMode,h=this.boxCells[i];if(null!==h){var p,d=this.bboxes,m=f(h);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(!l.box[g]){l.box[g]=!0;var v=4*g,y=this.boxKeys[g];if(t<=d[v+2]&&e<=d[v+3]&&n>=d[v+0]&&r>=d[v+1]&&(!s||s(y))&&(!u||!dt(c,y.overlapMode))&&(o.push({key:y,x1:d[v],y1:d[v+1],x2:d[v+2],y2:d[v+3]}),u))return!0}}}catch(P){m.e(P)}finally{m.f()}}var _=this.circleCells[i];if(null!==_){var x,b=this.circles,w=f(_);try{for(w.s();!(x=w.n()).done;){var S=x.value;if(!l.circle[S]){l.circle[S]=!0;var E=3*S,k=this.circleKeys[S];if(this._circleAndRectCollide(b[E],b[E+1],b[E+2],t,e,n,r)&&(!s||s(k))&&(!u||!dt(c,k.overlapMode))){var C=b[E],I=b[E+1],T=b[E+2];if(o.push({key:k,x1:C-T,y1:I-T,x2:C+T,y2:I+T}),u)return!0}}}}catch(P){w.e(P)}finally{w.f()}}return!1}},{key:"_queryCellCircle",value:function(t,e,n,r,i,o,a,s){var l=a.circle,u=a.seenUids,c=a.overlapMode,h=this.boxCells[i];if(null!==h){var p,d=this.bboxes,m=f(h);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(!u.box[g]){u.box[g]=!0;var v=4*g,y=this.boxKeys[g];if(this._circleAndRectCollide(l.x,l.y,l.radius,d[v+0],d[v+1],d[v+2],d[v+3])&&(!s||s(y))&&!dt(c,y.overlapMode))return o.push(!0),!0}}}catch(C){m.e(C)}finally{m.f()}}var _=this.circleCells[i];if(null!==_){var x,b=this.circles,w=f(_);try{for(w.s();!(x=w.n()).done;){var S=x.value;if(!u.circle[S]){u.circle[S]=!0;var E=3*S,k=this.circleKeys[S];if(this._circlesCollide(b[E],b[E+1],b[E+2],l.x,l.y,l.radius)&&(!s||s(k))&&!dt(c,k.overlapMode))return o.push(!0),!0}}}catch(C){w.e(C)}finally{w.f()}}}},{key:"_forEachCell",value:function(t,e,n,r,i,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r),f=l;f<=c;f++)for(var p=u;p<=h;p++)if(i.call(this,t,e,n,r,this.xCellCount*p+f,o,a,s))return}},{key:"_convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"_convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}},{key:"_circlesCollide",value:function(t,e,n,r,i,o){var a=r-t,s=i-e,l=n+o;return l*l>a*a+s*s}},{key:"_circleAndRectCollide",value:function(t,e,n,r,i,o,a){var s=(o-r)/2,l=Math.abs(t-(r+s));if(l>s+n)return!1;var u=(a-i)/2,c=Math.abs(e-(i+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;var h=l-s,f=c-u;return h*h+f*f<=n*n}}]),t}();function gt(e,n,r,i,o){var a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):t.multiply(a,i.labelPlaneMatrix,e),a}function vt(e,n,r,i,o){if(n){var a=t.clone(e);return t.scale(a,a,[o,o,1]),r||t.rotateZ(a,a,-i.angle),a}return i.glCoordMatrix}function yt(e,n,r){var i;r?(i=[e.x,e.y,r(e.x,e.y),1],t.transformMat4(i,i,n)):Pt(i=[e.x,e.y,0,1],i,n);var o=i[3];return{point:new t.pointGeometry(i[0]/o,i[1]/o),signedDistanceFromCamera:o}}function _t(t,e){return.5+t/e*.5}function xt(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function bt(e,n,r,i,o,a,s,l,u,c){var h=i?e.textSizeData:e.iconSizeData,f=t.evaluateSizeForZoom(h,r.transform.zoom),p=[256/r.width*2+1,256/r.height*2+1],d=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;d.clear();for(var m=e.lineVertexArray,g=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height,y=!1,_=0;_<g.length;_++){var x=g.get(_);if(x.hidden||x.writingMode===t.WritingMode.vertical&&!y)Tt(x.numGlyphs,d);else{var b=void 0;if(y=!1,c?(b=[x.anchorX,x.anchorY,c(x.anchorX,x.anchorY),1],t.transformMat4(b,b,n)):Pt(b=[x.anchorX,x.anchorY,0,1],b,n),xt(b,p)){var w=_t(r.transform.cameraToCenterDistance,b[3]),S=t.evaluateSizeForFeature(h,f,x),E=s?S/w:S*w,k=new t.pointGeometry(x.anchorX,x.anchorY),C=yt(k,o,c).point,I={},T=Et(x,E,!1,l,n,o,a,e.glyphOffsetArray,m,d,C,k,I,v,u,c);y=T.useVertical,(T.notEnoughRoom||y||T.needsFlipping&&Et(x,E,!0,l,n,o,a,e.glyphOffsetArray,m,d,C,k,I,v,u,c).notEnoughRoom)&&Tt(x.numGlyphs,d)}else Tt(x.numGlyphs,d)}}i?e.text.dynamicLayoutVertexBuffer.updateData(d):e.icon.dynamicLayoutVertexBuffer.updateData(d)}function wt(t,e,n,r,i,o,a,s,l,u,c,h,f){var p=s.glyphStartIndex+s.numGlyphs,d=s.lineStartIndex,m=s.lineStartIndex+s.lineLength,g=e.getoffsetX(s.glyphStartIndex),v=e.getoffsetX(p-1),y=Ct(t*g,n,r,i,o,a,s.segment,d,m,l,u,c,h,f);if(!y)return null;var _=Ct(t*v,n,r,i,o,a,s.segment,d,m,l,u,c,h,f);return _?{first:y,last:_}:null}function St(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function Et(e,n,r,i,o,a,s,l,u,c,h,p,d,m,g,v){var y,_=n/24,x=e.lineOffsetX*_,b=e.lineOffsetY*_;if(e.numGlyphs>1){var w=e.glyphStartIndex+e.numGlyphs,S=e.lineStartIndex,E=e.lineStartIndex+e.lineLength,k=wt(_,l,x,b,r,h,p,e,u,a,d,g,v);if(!k)return{notEnoughRoom:!0};var C=yt(k.first.point,s,v).point,I=yt(k.last.point,s,v).point;if(i&&!r){var T=St(e.writingMode,C,I,m);if(T)return T}y=[k.first];for(var P=e.glyphStartIndex+1;P<w-1;P++)y.push(Ct(_*l.getoffsetX(P),x,b,r,h,p,e.segment,S,E,u,a,d,g,v));y.push(k.last)}else{if(i&&!r){var A=yt(p,o,v).point,M=e.lineStartIndex+e.segment+1,L=new t.pointGeometry(u.getx(M),u.gety(M)),R=yt(L,o,v),D=R.signedDistanceFromCamera>0?R.point:kt(p,L,A,1,o,v),N=St(e.writingMode,A,D,m);if(N)return N}var z=Ct(_*l.getoffsetX(e.glyphStartIndex),x,b,r,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,d,g,v);if(!z)return{notEnoughRoom:!0};y=[z]}var O,F=f(y);try{for(F.s();!(O=F.n()).done;){var B=O.value;t.addDynamicAttributes(c,B.point,B.angle)}}catch(j){F.e(j)}finally{F.f()}return{}}function kt(t,e,n,r,i,o){var a=yt(t.add(t.sub(e)._unit()),i,o).point,s=n.sub(a);return n.add(s._mult(r/s.mag()))}function Ct(e,n,r,i,o,a,s,l,u,c,h,f,p,d){var m=i?e-n:e+n,g=m>0?1:-1,v=0;i&&(g*=-1,v=Math.PI),g<0&&(v+=Math.PI);for(var y=g>0?l+s:l+s+1,_=o,x=o,b=0,w=0,S=Math.abs(m),E=[];b+w<=S;){if((y+=g)<l||y>=u)return null;if(x=_,E.push(_),void 0===(_=f[y])){var k=new t.pointGeometry(c.getx(y),c.gety(y)),C=yt(k,h,d);if(C.signedDistanceFromCamera>0)_=f[y]=C.point;else{var I=y-g;_=kt(0===b?a:new t.pointGeometry(c.getx(I),c.gety(I)),k,x,S-b+1,h,d)}}b+=w,w=x.dist(_)}var T=(S-b)/w,P=_.sub(x),A=P.mult(T)._add(x);A._add(P._unit()._perp()._mult(r*g));var M=v+Math.atan2(_.y-x.y,_.x-x.x);return E.push(A),{point:A,angle:p?M:0,path:E}}var It=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Tt(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(It,3*r)}}function Pt(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var At=100,Mt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new mt(t.width+200,t.height+200,25),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new mt(t.width+200,t.height+200,25);d(this,e),this.transform=t,this.grid=n,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+At,this.screenBottomBoundary=t.height+At,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}return p(e,[{key:"placeCollisionBox",value:function(t,e,n,r,i,o){var a=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY,o),s=n*a.perspectiveRatio,l=t.x1*s+a.point.x,u=t.y1*s+a.point.y,c=t.x2*s+a.point.x,h=t.y2*s+a.point.y;return!this.isInsideGrid(l,u,c,h)||"always"!==e&&this.grid.hitTest(l,u,c,h,e,i)||a.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,u,c,h],offscreen:this.isOffscreen(l,u,c,h)}}},{key:"placeCollisionCircles",value:function(e,n,r,i,o,a,s,l,u,c,h,p,d,m){var g=[],v=new t.pointGeometry(n.anchorX,n.anchorY),y=yt(v,a,m),_=_t(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),x=(c?o/_:o*_)/t.ONE_EM,b=yt(v,s,m).point,w=wt(x,i,n.lineOffsetX*x,n.lineOffsetY*x,!1,b,v,n,r,s,{},!1,m),S=!1,E=!1,k=!0;if(w){for(var C=.5*p*_+d,I=new t.pointGeometry(-100,-100),T=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),P=new pt,A=w.first,M=w.last,L=[],R=A.path.length-1;R>=1;R--)L.push(A.path[R]);for(var D=1;D<M.path.length;D++)L.push(M.path[D]);var N=2.5*C;if(l){var z=L.map((function(t){return yt(t,l,m)}));L=z.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:z.map((function(t){return t.point}))}var O=[];if(L.length>0){for(var F=L[0].clone(),B=L[0].clone(),j=1;j<L.length;j++)F.x=Math.min(F.x,L[j].x),F.y=Math.min(F.y,L[j].y),B.x=Math.max(B.x,L[j].x),B.y=Math.max(B.y,L[j].y);O=F.x>=I.x&&B.x<=T.x&&F.y>=I.y&&B.y<=T.y?[L]:B.x<I.x||F.x>T.x||B.y<I.y||F.y>T.y?[]:t.clipLine([L],I.x,I.y,T.x,T.y)}var U,V=f(O);try{for(V.s();!(U=V.n()).done;){var Z=U.value;P.reset(Z,.25*C);var q=0;q=P.length<=.5*C?1:Math.ceil(P.paddedLength/N)+1;for(var G=0;G<q;G++){var W=G/Math.max(q-1,1),X=P.lerp(W),H=X.x+At,Y=X.y+At;g.push(H,Y,C,0);var $=H-C,K=Y-C,J=H+C,Q=Y+C;if(k=k&&this.isOffscreen($,K,J,Q),E=E||this.isInsideGrid($,K,J,Q),"always"!==e&&this.grid.hitTestCircle(H,Y,C,e,h)&&(S=!0,!u))return{circles:[],offscreen:!1,collisionDetected:S}}}}catch(tt){V.e(tt)}finally{V.f()}}return{circles:!u&&S||!E||_<this.perspectiveRatioCutoff?[]:g,offscreen:k,collisionDetected:S}}},{key:"queryRenderedSymbols",value:function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var n,r=[],i=1/0,o=1/0,a=-1/0,s=-1/0,l=f(e);try{for(l.s();!(n=l.n()).done;){var u=n.value,c=new t.pointGeometry(u.x+At,u.y+At);i=Math.min(i,c.x),o=Math.min(o,c.y),a=Math.max(a,c.x),s=Math.max(s,c.y),r.push(c)}}catch(x){l.e(x)}finally{l.f()}var h,p=this.grid.query(i,o,a,s).concat(this.ignoredGrid.query(i,o,a,s)),d={},m={},g=f(p);try{for(g.s();!(h=g.n()).done;){var v=h.value,y=v.key;if(void 0===d[y.bucketInstanceId]&&(d[y.bucketInstanceId]={}),!d[y.bucketInstanceId][y.featureIndex]){var _=[new t.pointGeometry(v.x1,v.y1),new t.pointGeometry(v.x2,v.y1),new t.pointGeometry(v.x2,v.y2),new t.pointGeometry(v.x1,v.y2)];t.polygonIntersectsPolygon(r,_)&&(d[y.bucketInstanceId][y.featureIndex]=!0,void 0===m[y.bucketInstanceId]&&(m[y.bucketInstanceId]=[]),m[y.bucketInstanceId].push(y.featureIndex))}}}catch(x){g.e(x)}finally{g.f()}return m}},{key:"insertCollisionBox",value:function(t,e,n,r,i,o){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:o,overlapMode:e},t[0],t[1],t[2],t[3])}},{key:"insertCollisionCircles",value:function(t,e,n,r,i,o){for(var a=n?this.ignoredGrid:this.grid,s={bucketInstanceId:r,featureIndex:i,collisionGroupID:o,overlapMode:e},l=0;l<t.length;l+=4)a.insertCircle(s,t[l],t[l+1],t[l+2])}},{key:"projectAndGetPerspectiveRatio",value:function(e,n,r,i){var o;return i?(o=[n,r,i(n,r),1],t.transformMat4(o,o,e)):Pt(o=[n,r,0,1],o,e),{point:new t.pointGeometry((o[0]/o[3]+1)/2*this.transform.width+At,(-o[1]/o[3]+1)/2*this.transform.height+At),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}}},{key:"isOffscreen",value:function(t,e,n,r){return n<At||t>=this.screenRightBoundary||r<At||e>this.screenBottomBoundary}},{key:"isInsideGrid",value:function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}},{key:"getViewportMatrix",value:function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}]),e}();function Lt(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}var Rt=function(){function t(e,n,r,i){d(this,t),this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):i&&r?1:0,this.placed=r}return p(t,[{key:"isHidden",value:function(){return 0===this.opacity&&!this.placed}}]),t}(),Dt=function(){function t(e,n,r,i,o){d(this,t),this.text=new Rt(e?e.text:null,n,r,o),this.icon=new Rt(e?e.icon:null,n,i,o)}return p(t,[{key:"isHidden",value:function(){return this.text.isHidden()&&this.icon.isHidden()}}]),t}(),Nt=p((function t(e,n,r){d(this,t),this.text=e,this.icon=n,this.skipFade=r})),zt=p((function e(){d(this,e),this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]})),Ot=p((function t(e,n,r,i,o){d(this,t),this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=o})),Ft=function(){function t(e){d(this,t),this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}return p(t,[{key:"get",value:function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]}}]),t}();function Bt(e,n,r,i,o){var a=t.getAnchorAlignment(e),s=-(a.horizontalAlign-.5)*n,l=-(a.verticalAlign-.5)*r,u=t.evaluateVariableOffset(e,i);return new t.pointGeometry(s+u[0]*o,l+u[1]*o)}function jt(e,n,r,i,o,a){var s=e.x1,l=e.x2,u=e.y1,c=e.y2,h=e.anchorPointX,f=e.anchorPointY,p=new t.pointGeometry(n,r);return i&&p._rotate(o?a:-a),{x1:s+p.x,y1:u+p.y,x2:l+p.x,y2:c+p.y,anchorPointX:h,anchorPointY:f}}var Ut=function(){function e(t,n,r,i,o){d(this,e),this.transform=t.clone(),this.terrain=n,this.collisionIndex=new Mt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Ft(i),this.collisionCircleArrays={},this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={}}return p(e,[{key:"getBucketParts",value:function(e,n,r,i){var o=r.getBucket(n),a=r.latestFeatureIndex;if(o&&a&&n.id===o.layerIds[0]){var s=r.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),m=Lt(r,1,this.transform.zoom),g=gt(h,p,d,this.transform,m),v=null;if(p){var y=vt(h,p,d,this.transform,m);v=t.multiply([],this.transform.labelPlaneMatrix,y)}this.retainedQueryData[o.bucketInstanceId]=new Ot(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID);var _={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:g,labelToScreenMatrix:v,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i){var x,b=f(o.sortKeyRanges);try{for(b.s();!(x=b.n()).done;){var w=x.value,S=w.sortKey,E=w.symbolInstanceStart,k=w.symbolInstanceEnd;e.push({sortKey:S,symbolInstanceStart:E,symbolInstanceEnd:k,parameters:_})}}catch(C){b.e(C)}finally{b.f()}}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:_})}}},{key:"attemptAnchorPlacement",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m){var g=[h.textOffset0,h.textOffset1],v=Bt(t,n,r,g,i),y=this.collisionIndex.placeCollisionBox(jt(e,v.x,v.y,o,a,this.transform.angle),c,s,l,u.predicate,m);if((!d||0!==this.collisionIndex.placeCollisionBox(jt(d,v.x,v.y,o,a,this.transform.angle),c,s,l,u.predicate,m).box.length)&&y.box.length>0){var _;if(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(_=this.prevPlacement.variableOffsets[h.crossTileID].anchor),0===h.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[h.crossTileID]={textOffset:g,width:n,height:r,anchor:t,textBoxScale:i,prevAnchor:_},this.markUsedJustification(f,t,h,p),f.allowVerticalPlacement&&(this.markUsedOrientation(f,p,h),this.placedOrientations[h.crossTileID]=p),{shift:v,placedGlyphBoxes:y}}}},{key:"placeLayerBucketPart",value:function(e,n,r){var i=this,o=e.parameters,a=o.bucket,s=o.layout,l=o.posMatrix,u=o.textLabelPlaneMatrix,c=o.labelToScreenMatrix,h=o.textPixelRatio,p=o.holdingForFade,d=o.collisionBoxArray,m=o.partiallyEvaluatedTextSize,g=o.collisionGroup,v=s.get("text-optional"),y=s.get("icon-optional"),_=t.getOverlapMode(s,"text-overlap","text-allow-overlap"),x="always"===_,b=t.getOverlapMode(s,"icon-overlap","icon-allow-overlap"),w="always"===b,S="map"===s.get("text-rotation-alignment"),E="map"===s.get("text-pitch-alignment"),k="none"!==s.get("icon-text-fit"),C="viewport-y"===s.get("symbol-z-order"),I=x&&(w||!a.hasIconData()||y),T=w&&(x||!a.hasTextData()||v);!a.collisionArrays&&d&&a.deserializeCollisionBoxes(d);var P=function(e,o){if(!n[e.crossTileID])if(p)i.placements[e.crossTileID]=new Nt(!1,!1,!1);else{var d=!1,w=!1,C=!0,P=null,A={box:null,offscreen:null},M={box:null,offscreen:null},L=null,R=null,D=null,N=0,z=0,O=0;o.textFeatureIndex?N=o.textFeatureIndex:e.useRuntimeCollisionCircles&&(N=e.featureIndex),o.verticalTextFeatureIndex&&(z=o.verticalTextFeatureIndex);for(var F=i.retainedQueryData[a.bucketInstanceId].tileID,B=i.terrain?function(t,e){return i.terrain.getElevation(F,t,e)}:null,j=0,U=["textBox","verticalTextBox","iconBox","verticalIconBox"];j<U.length;j++){var V=U[j],Z=o[V];Z&&(Z.elevation=B?B(Z.anchorPointX,Z.anchorPointY):0)}var q=o.textBox;if(q){var G=function(n){var r=t.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&i.prevPlacement){var o=i.prevPlacement.placedOrientations[e.crossTileID];o&&(i.placedOrientations[e.crossTileID]=o,r=o,i.markUsedOrientation(a,r,e))}return r},W=function(n,r){if(a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&o.verticalTextBox){var i,s=f(a.writingModes);try{for(s.s();!(i=s.n()).done&&(i.value===t.WritingMode.vertical?(A=r(),M=A):A=n(),!(A&&A.box&&A.box.length)););}catch(l){s.e(l)}finally{s.f()}}else A=n()};if(s.get("text-variable-anchor")){var X=s.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[e.crossTileID]){var H=i.prevPlacement.variableOffsets[e.crossTileID];X.indexOf(H.anchor)>0&&(X=X.filter((function(t){return t!==H.anchor})),X.unshift(H.anchor))}var Y=function(t,n,r){for(var o=t.x2-t.x1,s=t.y2-t.y1,u=e.textBoxScale,c=k&&"never"===b?n:null,f={box:[],offscreen:!1},p="never"!==_?2*X.length:X.length,m=0;m<p;++m){var v=i.attemptAnchorPlacement(X[m%X.length],t,o,s,u,S,E,h,l,g,m>=X.length?_:"never",e,a,r,c,B);if(v&&(f=v.placedGlyphBoxes)&&f.box&&f.box.length){d=!0,P=v.shift;break}}return f};W((function(){return Y(q,o.iconBox,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&!(A&&A.box&&A.box.length)&&e.numVerticalGlyphVertices>0&&n?Y(n,o.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),A&&(d=A.box,C=A.offscreen);var $=G(A&&A.box);if(!d&&i.prevPlacement){var K=i.prevPlacement.variableOffsets[e.crossTileID];K&&(i.variableOffsets[e.crossTileID]=K,i.markUsedJustification(a,K.anchor,e,$))}}else{var J=function(t,n){var r=i.collisionIndex.placeCollisionBox(t,_,h,l,g.predicate,B);return r&&r.box&&r.box.length&&(i.markUsedOrientation(a,n,e),i.placedOrientations[e.crossTileID]=n),r};W((function(){return J(q,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?J(n,t.WritingMode.vertical):{box:null,offscreen:null}})),G(A&&A.box&&A.box.length)}}if(d=(L=A)&&L.box&&L.box.length>0,C=L&&L.offscreen,e.useRuntimeCollisionCircles){var Q=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),tt=t.evaluateSizeForFeature(a.textSizeData,m,Q),et=s.get("text-padding");(R=i.collisionIndex.placeCollisionCircles(_,Q,a.lineVertexArray,a.glyphOffsetArray,tt,l,u,c,r,E,g.predicate,e.collisionCircleDiameter,et,B)).circles.length&&R.collisionDetected&&!r&&t.warnOnce("Collisions detected, but collision boxes are not shown"),d=x||R.circles.length>0&&!R.collisionDetected,C=C&&R.offscreen}if(o.iconFeatureIndex&&(O=o.iconFeatureIndex),o.iconBox){var nt=function(t){var e=k&&P?jt(t,P.x,P.y,S,E,i.transform.angle):t;return i.collisionIndex.placeCollisionBox(e,b,h,l,g.predicate,B)};w=M&&M.box&&M.box.length&&o.verticalIconBox?(D=nt(o.verticalIconBox)).box.length>0:(D=nt(o.iconBox)).box.length>0,C=C&&D.offscreen}var rt=v||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,it=y||0===e.numIconVertices;if(rt||it?it?rt||(w=w&&d):d=w&&d:w=d=w&&d,d&&L&&L.box&&i.collisionIndex.insertCollisionBox(L.box,_,s.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&z?z:N,g.ID),w&&D&&i.collisionIndex.insertCollisionBox(D.box,b,s.get("icon-ignore-placement"),a.bucketInstanceId,O,g.ID),R&&(d&&i.collisionIndex.insertCollisionCircles(R.circles,_,s.get("text-ignore-placement"),a.bucketInstanceId,N,g.ID),r)){var ot=a.bucketInstanceId,at=i.collisionCircleArrays[ot];void 0===at&&(at=i.collisionCircleArrays[ot]=new zt);for(var st=0;st<R.circles.length;st+=4)at.circles.push(R.circles[st+0]),at.circles.push(R.circles[st+1]),at.circles.push(R.circles[st+2]),at.circles.push(R.collisionDetected?1:0)}if(0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===a.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");i.placements[e.crossTileID]=new Nt(d||I,w||T,C||a.justReloaded),n[e.crossTileID]=!0}};if(C){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");for(var A=a.getSortedSymbolIndexes(this.transform.angle),M=A.length-1;M>=0;--M){var L=A[M];P(a.symbolInstances.get(L),a.collisionArrays[L])}}else for(var R=e.symbolInstanceStart;R<e.symbolInstanceEnd;R++)P(a.symbolInstances.get(R),a.collisionArrays[R]);if(r&&a.bucketInstanceId in this.collisionCircleArrays){var D=this.collisionCircleArrays[a.bucketInstanceId];t.invert(D.invProjMatrix,l),D.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1}},{key:"markUsedJustification",value:function(e,n,r,i){var o;o=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];for(var a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];a<s.length;a++){var l=s[a];l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=o>=0&&l!==o?0:r.crossTileID)}}},{key:"markUsedOrientation",value:function(e,n,r){for(var i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];a<s.length;a++){var l=s[a];e.text.placedSymbolArray.get(l).placedOrientation=i}r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)}},{key:"commit",value:function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=i[s];u?(this.opacities[s]=new Dt(u,r,l.text,l.icon),n=n||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new Dt(null,r,l.text,l.icon,l.skipFade),n=n||l.text||l.icon)}for(var c in i){var h=i[c];if(!this.opacities[c]){var f=new Dt(h,r,!1,!1);f.isHidden()||(this.opacities[c]=f,n=n||h.text.placed||h.icon.placed)}}for(var p in o)this.variableOffsets[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.variableOffsets[p]=o[p]);for(var d in a)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=a[d]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}},{key:"updateLayerOpacities",value:function(t,e){var n,r={},i=f(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}}catch(s){i.e(s)}finally{i.f()}}},{key:"updateBucketOpacities",value:function(e,n,r){var i=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var o=e.layers[0].layout,a=new Dt(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),u=o.get("text-variable-anchor"),c="map"===o.get("text-rotation-alignment"),h="map"===o.get("text-pitch-alignment"),f="none"!==o.get("icon-text-fit"),p=new Dt(null,0,s&&(l||!e.hasIconData()||o.get("icon-optional")),l&&(s||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);for(var d=function(t,e,n){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)},m=function(r){var o=e.symbolInstances.get(r),s=o.numHorizontalGlyphVertices,l=o.numVerticalGlyphVertices,m=o.crossTileID,g=i.opacities[m];n[m]?g=a:g||(g=p,i.opacities[m]=g),n[m]=!0;var v=o.numIconVertices>0,y=i.placedOrientations[o.crossTileID],_=y===t.WritingMode.vertical,x=y===t.WritingMode.horizontal||y===t.WritingMode.horizontalOnly;if(s>0||l>0){var b=$t(g.text);d(e.text,s,_?Kt:b),d(e.text,l,x?Kt:b);var w=g.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||x?1:0);var S=i.variableOffsets[o.crossTileID];S&&i.markUsedJustification(e,S.anchor,o,y);var E=i.placedOrientations[o.crossTileID];E&&(i.markUsedJustification(e,"left",o,E),i.markUsedOrientation(e,E,o))}if(v){var k=$t(g.icon),C=!(f&&o.verticalPlacedIconSymbolIndex&&_);o.placedIconSymbolIndex>=0&&(d(e.icon,o.numIconVertices,C?k:Kt),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=g.icon.isHidden()),o.verticalPlacedIconSymbolIndex>=0&&(d(e.icon,o.numVerticalIconVertices,C?Kt:k),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var I=e.collisionArrays[r];if(I){var T=new t.pointGeometry(0,0);if(I.textBox||I.verticalTextBox){var P=!0;if(u){var A=i.variableOffsets[m];A?(T=Bt(A.anchor,A.width,A.height,A.textOffset,A.textBoxScale),c&&T._rotate(h?i.transform.angle:-i.transform.angle)):P=!1}I.textBox&&Vt(e.textCollisionBox.collisionVertexArray,g.text.placed,!P||_,T.x,T.y),I.verticalTextBox&&Vt(e.textCollisionBox.collisionVertexArray,g.text.placed,!P||x,T.x,T.y)}var M=Boolean(!x&&I.verticalIconBox);I.iconBox&&Vt(e.iconCollisionBox.collisionVertexArray,g.icon.placed,M,f?T.x:0,f?T.y:0),I.verticalIconBox&&Vt(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!M,f?T.x:0,f?T.y:0)}}},g=0;g<e.symbolInstances.length;g++)m(g);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));if(e.bucketInstanceId in this.collisionCircleArrays){var v=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=v.invProjMatrix,e.placementViewportMatrix=v.viewportMatrix,e.collisionCircleArray=v.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}},{key:"symbolFadeChange",value:function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}},{key:"zoomAdjustment",value:function(t){return Math.max(0,(this.transform.zoom-t)/1.5)}},{key:"hasTransitions",value:function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}},{key:"stillRecent",value:function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}},{key:"setStale",value:function(){this.stale=!0}}]),e}();function Vt(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}var Zt=Math.pow(2,25),qt=Math.pow(2,24),Gt=Math.pow(2,17),Wt=Math.pow(2,16),Xt=Math.pow(2,9),Ht=Math.pow(2,8),Yt=Math.pow(2,1);function $t(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Zt+e*qt+n*Gt+e*Wt+n*Xt+e*Ht+n*Yt+e}var Kt=0,Jt=function(){function t(e){d(this,t),this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}return p(t,[{key:"continuePlacement",value:function(t,e,n,r,i){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1}}]),t}(),Qt=function(){function e(t,n,r,i,o,a,s,l){d(this,e),this.placement=new Ut(t,n,a,s,l),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=o,this._done=!1}return p(e,[{key:"isDone",value:function(){return this._done}},{key:"continuePlacement",value:function(e,n,r){for(var i=this,o=t.exported.now(),a=function(){var e=t.exported.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Jt(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}},{key:"commit",value:function(t){return this.placement.commit(t),this.placement}}]),e}(),te=512/t.EXTENT/2,ee=function(){function e(t,n,r){d(this,e),this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var i=0;i<n.length;i++){var o=n.get(i),a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)})}}return p(e,[{key:"getScaledCoordinates",value:function(e,n){var r=te/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*r),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*r)}}},{key:"findMatches",value:function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a){var s,l=this.getScaledCoordinates(o,e),u=f(a);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(Math.abs(c.coord.x-l.x)<=r&&Math.abs(c.coord.y-l.y)<=r&&!n[c.crossTileID]){n[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}catch(h){u.e(h)}finally{u.f()}}}}}}]),e}(),ne=function(){function t(){d(this,t),this.maxCrossTileID=0}return p(t,[{key:"generate",value:function(){return++this.maxCrossTileID}}]),t}(),re=function(){function t(){d(this,t),this.indexes={},this.usedCrossTileIDs={},this.lng=0}return p(t,[{key:"handleWrapJump",value:function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=t}},{key:"addBucket",value:function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,i)}else{var u=a[t.scaledTo(Number(o)).key];u&&u.findMatches(e.symbolInstances,t,i)}}for(var c=0;c<e.symbolInstances.length;c++){var h=e.symbolInstances.get(c);h.crossTileID||(h.crossTileID=n.generate(),i[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ee(t,e.symbolInstances,e.bucketInstanceId),!0}},{key:"removeBucketCrossTileIDs",value:function(t,e){for(var n in e.indexedSymbolInstances){var r,i=f(e.indexedSymbolInstances[n]);try{for(i.s();!(r=i.n()).done;){var o=r.value;delete this.usedCrossTileIDs[t][o.crossTileID]}}catch(a){i.e(a)}finally{i.f()}}}},{key:"removeStaleBuckets",value:function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e}}]),t}(),ie=function(){function t(){d(this,t),this.layerIndexes={},this.crossTileIDs=new ne,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}return p(t,[{key:"addLayer",value:function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new re);var i=!1,o={};r.handleWrapJump(n);var a,s=f(e);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(l.tileID,u,this.crossTileIDs)&&(i=!0),o[u.bucketInstanceId]=!0)}}catch(c){s.e(c)}finally{s.f()}return r.removeStaleBuckets(o)&&(i=!0),i}},{key:"pruneUnusedLayers",value:function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]}}]),t}(),oe=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),ae=function(e){m(r,e);var n=g(r);function r(t){var e;return d(this,r),(e=n.call(this)).sourceCache=t,e._tiles={},e._renderableTilesKeys=[],e._sourceTileCache={},e.renderHistory=[],e.minzoom=0,e.maxzoom=22,e.tileSize=512,e.deltaZoom=1,e.renderHistorySize=t._cache.max,t.usedForTerrain=!0,t.tileSize=e.tileSize*Math.pow(2,e.deltaZoom),e}return p(r,[{key:"destruct",value:function(){for(var t in this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null,this._tiles){var e=this._tiles[t];e.textures.forEach((function(t){return t.destroy()})),e.textures=[]}}},{key:"update",value:function(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];var r,i=f(e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n}));try{for(i.s();!(r=i.n()).done;){var o=r.value;this._renderableTilesKeys.push(o.key),this._tiles[o.key]||(o.posMatrix=new Float64Array(16),t.ortho(o.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),this._tiles[o.key]=new W(o,this.tileSize))}}catch(a){i.e(a)}finally{i.f()}}},{key:"removeOutdated",value:function(t){var e=this,n={};this.renderHistory=this.renderHistory.filter((function(t,n){return e.renderHistory.indexOf(t)===n})).slice(0,this.renderHistorySize);var r,i=f(this._renderableTilesKeys);try{for(i.s();!(r=i.n()).done;)n[r.value]=!0}catch(l){i.e(l)}finally{i.f()}var o,a=f(this.renderHistory);try{for(a.s();!(o=a.n()).done;)n[o.value]=!0}catch(l){a.e(l)}finally{a.f()}for(var s in this._tiles)n[s]||(this._tiles[s].clearTextures(t),delete this._tiles[s])}},{key:"getRenderableTiles",value:function(){var t=this;return this._renderableTilesKeys.map((function(e){return t.getTileByID(e)}))}},{key:"getTileByID",value:function(t){return this._tiles[t]}},{key:"getTerrainCoords",value:function(e){var n,r={},i=f(this._renderableTilesKeys);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this._tiles[o].tileID;if(a.canonical.equals(e.canonical)){var s=e.clone();s.posMatrix=new Float64Array(16),t.ortho(s.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),r[o]=s}else if(a.canonical.isChildOf(e.canonical)){var l=e.clone();l.posMatrix=new Float64Array(16);var u=a.canonical.z-e.canonical.z,c=a.canonical.x-(a.canonical.x>>u<<u),h=a.canonical.y-(a.canonical.y>>u<<u),p=t.EXTENT>>u;t.ortho(l.posMatrix,0,p,0,p,0,1),t.translate(l.posMatrix,l.posMatrix,[-c*p,-h*p,0]),r[o]=l}else if(e.canonical.isChildOf(a.canonical)){var d=e.clone();d.posMatrix=new Float64Array(16);var m=e.canonical.z-a.canonical.z,g=e.canonical.x-(e.canonical.x>>m<<m),v=e.canonical.y-(e.canonical.y>>m<<m),y=t.EXTENT>>m;t.ortho(d.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),t.translate(d.posMatrix,d.posMatrix,[g*y,v*y,0]),t.scale(d.posMatrix,d.posMatrix,[1/Math.pow(2,m),1/Math.pow(2,m),0]),r[o]=d}}}catch(_){i.e(_)}finally{i.f()}return r}},{key:"getSourceTile",value:function(t,e){var n=this.sourceCache._source,r=t.overscaledZ-this.deltaZoom;if(r>n.maxzoom&&(r=n.maxzoom),r<n.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(r).key);var i=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!i||!i.dem)&&e)for(;r>=n.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(t.scaledTo(r--).key);return i}},{key:"tilesAfterTime",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return Object.values(this._tiles).filter((function(e){return e.timeLoaded>=t}))}}]),r}(t.Evented),se=function(){function e(t,n,r){d(this,e),this.style=t,this.sourceCache=new ae(n),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.elevationOffset="number"==typeof r.elevationOffset?r.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}return p(e,[{key:"getDEMElevation",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.EXTENT;if(!(n>=0&&n<i&&r>=0&&r<i))return this.elevationOffset;var o=0,a=this.getTerrainData(e);if(a.tile&&a.tile.dem){var s=t.transformMat4$1([],[n/i*t.EXTENT,r/i*t.EXTENT],a.u_terrain_matrix),l=[s[0]*a.tile.dem.dim,s[1]*a.tile.dem.dim],u=[Math.floor(l[0]),Math.floor(l[1])],c=a.tile.dem.get(u[0],u[1]),h=a.tile.dem.get(u[0],u[1]+1),f=a.tile.dem.get(u[0]+1,u[1]),p=a.tile.dem.get(u[0]+1,u[1]+1);o=t.number(t.number(c,h,l[0]-u[0]),t.number(f,p,l[0]-u[0]),l[1]-u[1])}return o}},{key:"rememberForRerender",value:function(t,e){for(var n in this.sourceCache._tiles){var r=this.sourceCache._tiles[n];(r.tileID.equals(e)||r.tileID.isChildOf(e))&&(t===this.sourceCache.sourceCache.id&&(r.timeLoaded=Date.now()),this._rerender[t]=this._rerender[t]||{},this._rerender[t][r.tileID.key]=!0)}}},{key:"needsRerender",value:function(t,e){return this._rerender[t]&&this._rerender[t][e.key]}},{key:"clearRerenderCache",value:function(){this._rerender={}}},{key:"getElevation",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.EXTENT;return(this.getDEMElevation(e,n,r,i)+this.elevationOffset)*this.exaggeration}},{key:"getTerrainData",value:function(e){if(!this._emptyDemTexture){var n=this.style.map.painter.context,r=new t.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _(n,r,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _(n,new t.RGBAImage({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.identity([])}var i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){var o=this.style.map.painter.context;i.demTexture=this.style.map.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new _(o,i.dem.getPixels(),o.gl.RGBA,{premultiply:!1}),i.demTexture.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}var a=i&&i+i.tileID.key+e.key;if(a&&!this._demMatrixCache[a]){var s=this.sourceCache.sourceCache._source.maxzoom,l=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=s?l=e.canonical.z-s:t.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));var u=e.canonical.x-(e.canonical.x>>l<<l),c=e.canonical.y-(e.canonical.y>>l<<l),h=t.fromScaling(new Float64Array(16),[1/(t.EXTENT<<l),1/(t.EXTENT<<l),0]);t.translate(h,h,[u*t.EXTENT,c*t.EXTENT,0]),this._demMatrixCache[e.key]={matrix:h,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:a?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}},{key:"getRTTFramebuffer",value:function(){var t=this.style.map.painter;if(!this._rttFramebuffer){var e=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=t.context.createFramebuffer(e,e,!0),this._rttFramebuffer.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,e,e))}return this._rttFramebuffer}},{key:"getFramebuffer",value:function(t){var e=this.style.map.painter,n=e.width/devicePixelRatio,r=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _(e.context,{width:n,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _(e.context,{width:n,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(n,r,!0),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,n,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}},{key:"getCoordsTexture",value:function(){var e=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;for(var n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4),r=0,i=0;r<this._coordsTextureSize;r++)for(var o=0;o<this._coordsTextureSize;o++,i+=4)n[i+0]=255&o,n[i+1]=255&r,n[i+2]=o>>8<<4|r>>8,n[i+3]=0;var a=new t.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),s=new _(e,a,e.gl.RGBA,{premultiply:!1});return s.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=s,s}},{key:"pointCoordinate",value:function(e){var n=new Uint8Array(4),r=this.style.map.painter,i=r.context,o=i.gl;i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),o.readPixels(e.x,r.height/devicePixelRatio-e.y-1,1,1,o.RGBA,o.UNSIGNED_BYTE,n),i.bindFramebuffer.set(null);var a=n[0]+(n[2]>>4<<8),s=n[1]+((15&n[2])<<8),l=this.coordsIndex[255-n[3]],u=l&&this.sourceCache.getTileByID(l);if(!u)return null;var c=this._coordsTextureSize,h=(1<<u.tileID.canonical.z)*c;return new t.MercatorCoordinate((u.tileID.canonical.x*c+a)/h,(u.tileID.canonical.y*c+s)/h,this.getElevation(u.tileID,a,s,c))}},{key:"getTerrainMesh",value:function(){if(this._mesh)return this._mesh;for(var e=this.style.map.painter.context,n=new t.PosArray,r=new t.TriangleIndexArray,i=this.meshSize,o=t.EXTENT/i,a=i*i,s=0;s<=i;s++)for(var l=0;l<=i;l++)n.emplaceBack(l*o,s*o);for(var u=0;u<a;u+=i+1)for(var c=0;c<i;c++)r.emplaceBack(c+u,i+c+u+1,i+c+u+2),r.emplaceBack(c+u,i+c+u+2,c+u+1);return this._mesh={indexBuffer:e.createIndexBuffer(r),vertexBuffer:e.createVertexBuffer(n,oe.members),segments:t.SegmentVector.simpleSegment(0,0,n.length,r.length)},this._mesh}},{key:"getMinMaxElevation",value:function(t){var e=this.getTerrainData(t).tile,n={minElevation:null,maxElevation:null};return e&&e.dem&&(n.minElevation=(e.dem.min+this.elevationOffset)*this.exaggeration,n.maxElevation=(e.dem.max+this.elevationOffset)*this.exaggeration),n}}]),e}(),le=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},ue=t.pick(ot,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ce=t.pick(ot,["setCenter","setZoom","setBearing","setPitch"]),he=function(){var e={},n=t.spec.$version;for(var r in t.spec.$root){var i=t.spec.$root[r];if(i.required){var o=null;null!=(o="version"===r?n:"array"===i.type?[]:{})&&(e[r]=o)}}return e}(),fe=function(e){m(r,e);var n=g(r);function r(e){var o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,r),(o=n.call(this)).map=e,o.dispatcher=new A(nt(),i(o)),o.imageManager=new b,o.imageManager.setEventedParent(i(o)),o.glyphManager=new k(e._requestManager,a.localIdeographFontFamily),o.lineAtlas=new P(256,512),o.crossTileSymbolIndex=new ie,o._layers={},o._serializedLayers={},o._order=[],o.sourceCaches={},o.zoomHistory=new t.ZoomHistory,o._loaded=!1,o._availableImages=[],o._resetUpdates(),o.dispatcher.broadcast("setReferrer",t.getReferrer());var s=i(o);return o._rtlTextPluginCallback=r.registerForPluginStateChange((function(e){s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var r in s.sourceCaches)s.sourceCaches[r].reload()}))})),o.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}})),o}return p(r,[{key:"loadURL",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"!=typeof r.validate||r.validate,o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,r){n._request=null,e?n.fire(new t.ErrorEvent(e)):r&&n._load(r,i)}))}},{key:"loadJSON",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame((function(){n._request=null,n._load(e,!1!==r.validate)}))}},{key:"loadEmpty",value:function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(he,!1)}},{key:"_load",value:function(e,n){if(!n||!le(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(r,e.sources[r],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var i=it(this.stylesheet.layers);this._order=i.map((function(t){return t.id})),this._layers={},this._serializedLayers={};var o,a=f(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;(s=t.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}}catch(l){a.e(l)}finally{a.f()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new T(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}}},{key:"_loadSprite",value:function(e){var n=this;this._spriteRequest=function(e,n,r,i){var o,a,s,l=r>1?"@2x":"",u=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,l,".json"),t.ResourceType.SpriteJSON),(function(t,e){u=null,s||(s=t,o=e,h())})),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,l,".png"),t.ResourceType.SpriteImage),(function(t,e){c=null,s||(s=t,a=e,h())}));function h(){if(s)i(s);else if(o&&a){var e=t.exported.getImageData(a),n={};for(var r in o){var l=o[r],u=l.width,c=l.height,h=l.x,f=l.y,p=l.sdf,d=l.pixelRatio,m=l.stretchX,g=l.stretchY,v=l.content,y=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,y,{x:h,y:f},{x:0,y:0},{width:u,height:c}),n[r]={data:y,pixelRatio:d,sdf:p,stretchX:m,stretchY:g,content:v}}i(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,this.map.getPixelRatio(),(function(e,r){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new t.Event("data",{dataType:"style"}))}))}},{key:"_validateLayer",value:function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'.concat(r,'" does not exist on source "').concat(i.id,'" as specified by style layer "').concat(e.id,'".'))))}}}},{key:"loaded",value:function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}},{key:"_serializeLayers",value:function(t){var e,n=[],r=f(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=this._layers[i];"custom"!==o.type&&n.push(o.serialize())}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"hasTransitions",value:function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}},{key:"_checkLoaded",value:function(){if(!this._loaded)throw new Error("Style is not done loading.")}},{key:"update",value:function(e){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var o in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var a=this._updatedSources[o];if("reload"===a)this._reloadSource(o);else{if("clear"!==a)throw new Error("Invalid action ".concat(a));this._clearSource(o)}}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}var l={};for(var u in this.sourceCaches){var c=this.sourceCaches[u];l[u]=c.used,c.used=!1}var h,p=f(this._order);try{for(p.s();!(h=p.n()).done;){var d=h.value,m=this._layers[d];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}}catch(y){p.e(y)}finally{p.f()}for(var g in l){var v=this.sourceCaches[g];l[g]!==v.used&&v.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}}},{key:"_updateTilesForChangedImages",value:function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}},{key:"_updateWorkerLayers",value:function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}},{key:"_resetUpdates",value:function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}},{key:"setTerrain",value:function(e){var n=this;if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),e){var r=this.sourceCaches[e.source];if(!r)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));this.terrain=new se(this,r,e),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=function(t){t.freeze?n.map.transform.freezeElevation=!0:(n.map.transform.freezeElevation=!1,n.map.transform.recalculateZoom(n.terrain))},this._terrainDataCallback=function(t){t.tile&&(t.sourceId===e.source?(n.map.transform.updateElevation(n.terrain),n.terrain.rememberForRerender(t.sourceId,t.tile.tileID)):"geojson"===t.source.type&&n.terrain.rememberForRerender(t.sourceId,t.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new t.Event("terrain",{terrain:e}))}},{key:"setState",value:function(e){var n=this;if(this._checkLoaded(),le(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=it(e.layers);var r=function(t,e){if(!t)return[{command:ot.setStyle,args:[e]}];var n=[];try{if(!u(t.version,e.version))return[{command:ot.setStyle,args:[e]}];u(t.center,e.center)||n.push({command:ot.setCenter,args:[e.center]}),u(t.zoom,e.zoom)||n.push({command:ot.setZoom,args:[e.zoom]}),u(t.bearing,e.bearing)||n.push({command:ot.setBearing,args:[e.bearing]}),u(t.pitch,e.pitch)||n.push({command:ot.setPitch,args:[e.pitch]}),u(t.sprite,e.sprite)||n.push({command:ot.setSprite,args:[e.sprite]}),u(t.glyphs,e.glyphs)||n.push({command:ot.setGlyphs,args:[e.glyphs]}),u(t.transition,e.transition)||n.push({command:ot.setTransition,args:[e.transition]}),u(t.light,e.light)||n.push({command:ot.setLight,args:[e.light]});var r={},i=[];!function(t,e,n,r){var i;for(i in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)||st(i,n,r));for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)?u(t[i],e[i])||("geojson"===t[i].type&&"geojson"===e[i].type&&ut(t,e,i)?n.push({command:ot.setGeoJSONSourceData,args:[i,e[i].data]}):lt(i,e,n,r)):at(i,e,n))}(t.sources,e.sources,i,r);var o=[];t.layers&&t.layers.forEach((function(t){r[t.source]?n.push({command:ot.removeLayer,args:[t.id]}):o.push(t)})),n=n.concat(i),function(t,e,n){e=e||[];var r,i,o,a,s,l,c,h=(t=t||[]).map(ht),f=e.map(ht),p=t.reduce(ft,{}),d=e.reduce(ft,{}),m=h.slice(),g=Object.create(null);for(r=0,i=0;r<h.length;r++)o=h[r],Object.prototype.hasOwnProperty.call(d,o)?i++:(n.push({command:ot.removeLayer,args:[o]}),m.splice(m.indexOf(o,i),1));for(r=0,i=0;r<f.length;r++)o=f[f.length-1-r],m[m.length-1-r]!==o&&(Object.prototype.hasOwnProperty.call(p,o)?(n.push({command:ot.removeLayer,args:[o]}),m.splice(m.lastIndexOf(o,m.length-i),1)):i++,l=m[m.length-r],n.push({command:ot.addLayer,args:[d[o],l]}),m.splice(m.length-r,0,o),g[o]=!0);for(r=0;r<f.length;r++)if(a=p[o=f[r]],s=d[o],!g[o]&&!u(a,s))if(u(a.source,s.source)&&u(a["source-layer"],s["source-layer"])&&u(a.type,s.type)){for(c in ct(a.layout,s.layout,n,o,null,ot.setLayoutProperty),ct(a.paint,s.paint,n,o,null,ot.setPaintProperty),u(a.filter,s.filter)||n.push({command:ot.setFilter,args:[o,s.filter]}),u(a.minzoom,s.minzoom)&&u(a.maxzoom,s.maxzoom)||n.push({command:ot.setLayerZoomRange,args:[o,s.minzoom,s.maxzoom]}),a)Object.prototype.hasOwnProperty.call(a,c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?ct(a[c],s[c],n,o,c.slice(6),ot.setPaintProperty):u(a[c],s[c])||n.push({command:ot.setLayerProperty,args:[o,c,s[c]]}));for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&!Object.prototype.hasOwnProperty.call(a,c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?ct(a[c],s[c],n,o,c.slice(6),ot.setPaintProperty):u(a[c],s[c])||n.push({command:ot.setLayerProperty,args:[o,c,s[c]]}))}else n.push({command:ot.removeLayer,args:[o]}),l=m[m.lastIndexOf(o)+1],n.push({command:ot.addLayer,args:[s,l]})}(o,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:ot.setStyle,args:[e]}]}return n}(this.serialize(),e).filter((function(t){return!(t.command in ce)}));if(0===r.length)return!1;var i=r.filter((function(t){return!(t.command in ue)}));if(i.length>0)throw new Error("Unimplemented: ".concat(i.map((function(t){return t.command})).join(", "),"."));return r.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0}},{key:"addImage",value:function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}},{key:"updateImage",value:function(t,e){this.imageManager.updateImage(t,e)}},{key:"getImage",value:function(t){return this.imageManager.getImage(t)}},{key:"removeImage",value:function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}},{key:"_afterImageUpdated",value:function(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}},{key:"listImages",value:function(){return this._checkLoaded(),this.imageManager.listImages()}},{key:"addSource",value:function(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error('Source "'.concat(e,'" already exists.'));if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources.".concat(e),n,null,i))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Y(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:r.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}}},{key:"removeSource",value:function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(n,'" is using it.'))));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}},{key:"setGeoJSONSourceData",value:function(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID=".concat(t));var n=this.sourceCaches[t].getSource();if("geojson"!==n.type)throw new Error("geojsonSource.type is ".concat(n.type,", which is !== 'geojson"));n.setData(e),this._changed=!0}},{key:"getSource",value:function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}},{key:"addLayer",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer "'.concat(i,'" already exists on this map.'))));else{var o;if("custom"===e.type){if(le(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers.".concat(i),e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize()}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Cannot add layer "'.concat(i,'" before non-existing layer "').concat(n,'".'))));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}}},{key:"moveLayer",value:function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(n,'".')))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))))}},{key:"removeLayer",value:function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error('Cannot remove non-existing layer "'.concat(e,'".'))))}},{key:"getLayer",value:function(t){return this._layers[t]}},{key:"hasLayer",value:function(t){return t in this._layers}},{key:"setLayerZoomRange",value:function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))))}},{key:"setFilter",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=this.getLayer(e);if(i){if(!u(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers.".concat(i.id,".filter"),n,null,r)||(i.filter=t.clone$1(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error('Cannot filter non-existing layer "'.concat(e,'".'))))}},{key:"getFilter",value:function(e){return t.clone$1(this.getLayer(e).filter)}},{key:"setLayoutProperty",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(e);o?u(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,i),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error('Cannot style non-existing layer "'.concat(e,'".'))))}},{key:"getLayoutProperty",value:function(e,n){var r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))))}},{key:"setPaintProperty",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(e);o?u(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,i)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error('Cannot style non-existing layer "'.concat(e,'".'))))}},{key:"getPaintProperty",value:function(t,e){return this.getLayer(t).getPaintProperty(e)}},{key:"setFeatureState",value:function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,o=this.sourceCaches[r];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '".concat(r,"' does not exist in the map's style."))))}},{key:"removeFeatureState",value:function(e,n){this._checkLoaded();var r=e.source,i=this.sourceCaches[r];if(void 0!==i){var o=i.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(a,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '".concat(r,"' does not exist in the map's style."))))}},{key:"getFeatureState",value:function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n];if(void 0!==i)return"vector"!==i.getSource().type||r?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,e.id)):void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"getTransition",value:function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}},{key:"serialize",value:function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))}},{key:"_updateLayer",value:function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0}},{key:"_flattenAndSortRenderedFeatures",value:function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},r={},i=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){r[a]=o;var s,l=f(t);try{for(l.s();!(s=l.n()).done;){var u=s.value[a];if(u){var c,h=f(u);try{for(h.s();!(c=h.n()).done;){var p=c.value;i.push(p)}}catch(k){h.e(k)}finally{h.f()}}}}catch(k){l.e(k)}finally{l.f()}}}i.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var d=[],m=this._order.length-1;m>=0;m--){var g=this._order[m];if(n(g))for(var v=i.length-1;v>=0;v--){var y=i[v].feature;if(r[y.layer.id]<m)break;d.push(y),i.pop()}else{var _,x=f(t);try{for(x.s();!(_=x.n()).done;){var b=_.value[g];if(b){var w,S=f(b);try{for(S.s();!(w=S.n()).done;){var E=w.value;d.push(E.feature)}}catch(k){S.e(k)}finally{S.f()}}}}catch(k){x.e(k)}finally{x.f()}}}return d}},{key:"queryRenderedFeatures",value:function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];var o,a=f(n.layers);try{for(a.s();!(o=a.n()).done;){var s=o.value,l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '".concat(s,"' does not exist in the map's style and cannot be queried for features.")))),[];i[l.source]=!0}}catch(h){a.e(h)}finally{a.f()}}var u=[];for(var c in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!i[c]||u.push(q(this.sourceCaches[c],this._layers,this._serializedLayers,e,n,r));return this.placement&&u.push(function(t,e,n,r,i,o,a){var s,l={},u=o.queryRenderedSymbols(r),c=[],p=f(Object.keys(u).map(Number));try{for(p.s();!(s=p.n()).done;){var d=s.value;c.push(a[d])}}catch(h){p.e(h)}finally{p.f()}c.sort(G);for(var m=function(){var n=v[g],r=n.featureIndex.lookupSymbolFeatures(u[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(var o in r){var a=l[o]=l[o]||[],s=r[o];s.sort((function(t,e){var r=n.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));var c,p=f(s);try{for(p.s();!(c=p.n()).done;){var d=c.value;a.push(d)}}catch(h){p.e(h)}finally{p.f()}}},g=0,v=c;g<v.length;g++)m();var y=function(e){l[e].forEach((function(r){var i=r.feature,o=n[t[e].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o}))};for(var _ in l)y(_);return l}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)}},{key:"querySourceFeatures",value:function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,e))}return r}(r,n):[]}},{key:"addSourceType",value:function(t,e,n){return r.getSourceType(t)?n(new Error('A source type called "'.concat(t,'" already exists.'))):(r.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}},{key:"getLight",value:function(){return this.light.getLight()}},{key:"setLight",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();var r=this.light.getLight(),i=!1;for(var o in e)if(!u(e[o],r[o])){i=!0;break}if(i){var a={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}}},{key:"_validate",value:function(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!o||!1!==o.validate)&&le(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.spec},i)))}},{key:"_remove",value:function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches){var r=this.sourceCaches[n];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}},{key:"_clearSource",value:function(t){this.sourceCaches[t].clearTiles()}},{key:"_reloadSource",value:function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}},{key:"_updateSources",value:function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t,this.terrain)}},{key:"_generateCollisionBoxes",value:function(){for(var t in this.sourceCaches)this._reloadSource(t)}},{key:"_updatePlacement",value:function(e,n,r,i){var o,a=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=!1,u=!1,c={},h=f(this._order);try{for(h.s();!(o=h.n()).done;){var p=o.value,d=this._layers[p];if("symbol"===d.type){c[d.source]||function(){var t=a.sourceCaches[d.source];c[d.source]=t.getRenderableIds(!0).map((function(e){return t.getTileByID(e)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}();var m=this.crossTileSymbolIndex.addLayer(d,c[d.source],e.center.lng);l=l||m}}}catch(x){h.e(x)}finally{h.f()}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((s=s||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Qt(e,this.terrain,this._order,s,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,c),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),u=!0),l&&this.pauseablePlacement.placement.setStale()),u||l){var g,v=f(this._order);try{for(v.s();!(g=v.n()).done;){var y=g.value,_=this._layers[y];"symbol"===_.type&&this.placement.updateLayerOpacities(_,c[_.source])}}catch(x){v.e(x)}finally{v.f()}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}},{key:"_releaseSymbolFadeTiles",value:function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}},{key:"getImages",value:function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)}},{key:"getGlyphs",value:function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}},{key:"getResource",value:function(e,n,r){return t.makeRequest(n,r)}}]),r}(t.Evented);fe.getSourceType=function(t){return V[t]},fe.setSourceType=function(t,e){V[t]=e},fe.registerForPluginStateChange=t.registerForPluginStateChange;var pe="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}",de={prelude:me("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:me("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:me("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:me("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:me("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:me("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:me("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:me("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:me("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:me("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:me("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:me("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:me("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:me("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:me("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:me("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:me("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:me("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:me("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:me("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:me("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:me("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:me("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:me("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:me("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:me("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:me("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",pe),terrainDepth:me("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",pe),terrainCoords:me("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",pe)};function me(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),i=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(i):i,s={};return{fragmentSource:t=t.replace(n,(function(t,e,n,r,i){return s[i]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n")})),vertexSource:e=e.replace(n,(function(t,e,n,r,i){var o="float"===r?"vec2":"vec4",a=i.match(/color/)?"color":o;return s[i]?"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(o," a_").concat(i,";\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(o," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n")})),staticAttributes:r,staticUniforms:a}}var ge=function(){function t(){d(this,t),this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}return p(t,[{key:"bind",value:function(t,e,n,r,i,o,a,s,l){this.context=t;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!u&&this.boundIndexBuffer===i&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s&&this.boundDynamicVertexBuffer3===l?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind()):this.freshBind(e,n,r,i,o,a,s,l)}},{key:"freshBind",value:function(t,e,n,r,i,o,a,s){var l,u=t.numAttributes,c=this.context,h=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),l=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a,this.boundDynamicVertexBuffer3=s;else{l=c.currentNumAttributes||0;for(var p=u;p<l;p++)h.disableVertexAttribArray(p)}e.enableAttributes(h,t);var d,m=f(n);try{for(m.s();!(d=m.n()).done;)d.value.enableAttributes(h,t)}catch(_){m.e(_)}finally{m.f()}o&&o.enableAttributes(h,t),a&&a.enableAttributes(h,t),s&&s.enableAttributes(h,t),e.bind(),e.setVertexAttribPointers(h,t,i);var g,v=f(n);try{for(v.s();!(g=v.n()).done;){var y=g.value;y.bind(),y.setVertexAttribPointers(h,t,i)}}catch(_){v.e(_)}finally{v.f()}o&&(o.bind(),o.setVertexAttribPointers(h,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(h,t,i)),s&&(s.bind(),s.setVertexAttribPointers(h,t,i)),c.currentNumAttributes=u}},{key:"destroy",value:function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}]),t}();function ve(t){for(var e=[],n=0;n<t.length;n++)if(null!==t[n]){var r=t[n].split(" ");e.push(r.pop())}return e}var ye=function(){function e(n,r,i,o,a,s,l){d(this,e);var u=n.gl;this.program=u.createProgram();var c,h=ve(i.staticAttributes),p=o?o.getBinderAttributes():[],m=h.concat(p),g=de.prelude.staticUniforms?ve(de.prelude.staticUniforms):[],v=i.staticUniforms?ve(i.staticUniforms):[],y=o?o.getBinderUniforms():[],_=g.concat(v).concat(y),x=[],b=f(_);try{for(b.s();!(c=b.n()).done;){var w=c.value;x.indexOf(w)<0&&x.push(w)}}catch(R){b.e(R)}finally{b.f()}var S=o?o.defines():[];s&&S.push("#define OVERDRAW_INSPECTOR;"),l&&S.push("#define TERRAIN3D;");var E=S.concat(de.prelude.fragmentSource,i.fragmentSource).join("\n"),k=S.concat(de.prelude.vertexSource,i.vertexSource).join("\n"),C=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(C,E),u.compileShader(C),u.attachShader(this.program,C);var I=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(I,k),u.compileShader(I),u.attachShader(this.program,I),this.attributes={};var T={};this.numAttributes=m.length;for(var P=0;P<this.numAttributes;P++)m[P]&&(u.bindAttribLocation(this.program,P,m[P]),this.attributes[m[P]]=P);u.linkProgram(this.program),u.deleteShader(I),u.deleteShader(C);for(var A=0;A<x.length;A++){var M=x[A];if(M&&!T[M]){var L=u.getUniformLocation(this.program,M);L&&(T[M]=L)}}this.fixedUniforms=a(n,T),this.terrainUniforms=function(e,n){return{u_depth:new t.Uniform1i(e,n.u_depth),u_terrain:new t.Uniform1i(e,n.u_terrain),u_terrain_dim:new t.Uniform1f(e,n.u_terrain_dim),u_terrain_matrix:new t.UniformMatrix4f(e,n.u_terrain_matrix),u_terrain_unpack:new t.Uniform4f(e,n.u_terrain_unpack),u_terrain_offset:new t.Uniform1f(e,n.u_terrain_offset),u_terrain_exaggeration:new t.Uniform1f(e,n.u_terrain_exaggeration)}}(n,T),this.binderUniforms=o?o.getUniforms(n,T):[]}}}return p(e,[{key:"draw",value:function(t,e,n,r,i,o,a,s,l,u,c,h,p,d,m,g,v,y){var _=t.gl;if(!this.failedToCreate){if(t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),s)for(var x in t.activeTexture.set(_.TEXTURE2),_.bindTexture(_.TEXTURE_2D,s.depthTexture),t.activeTexture.set(_.TEXTURE3),_.bindTexture(_.TEXTURE_2D,s.texture),this.terrainUniforms)this.terrainUniforms[x].set(s[x]);for(var b in this.fixedUniforms)this.fixedUniforms[b].set(a[b]);m&&m.setUniforms(t,this.binderUniforms,p,{zoom:d});var w=0;switch(e){case _.LINES:w=2;break;case _.TRIANGLES:w=3;break;case _.LINE_STRIP:w=1}var S,E=f(h.get());try{for(E.s();!(S=E.n()).done;){var k=S.value,C=k.vaos||(k.vaos={});(C[l]||(C[l]=new ge)).bind(t,this,u,m?m.getPaintVertexBuffers():[],c,k.vertexOffset,g,v,y),_.drawElements(e,k.primitiveLength*w,_.UNSIGNED_SHORT,k.primitiveOffset*w*2)}}catch(I){E.e(I)}finally{E.f()}}}}]),e}();function _e(t,e,n){var r=1/Lt(n,1,e.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,a=o*(n.tileID.canonical.x+n.tileID.wrap*i),s=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}var xe=function(e,n,r,i){var o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(l,-n.transform.angle),t.transformMat3(s,s,l);var u=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},be=function(e,n,r,i,o,a,s){return t.extend(xe(e,n,r,i),_e(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8})},we=function(t){return{u_matrix:t}},Se=function(e,n,r,i){return t.extend(we(e),_e(r,n,i))},Ee=function(t,e){return{u_matrix:t,u_world:e}},ke=function(e,n,r,i,o){return t.extend(Se(e,n,r,i),{u_world:o})},Ce=function(t,e,n,r){var i,o,a=t.transform;if("map"===r.paint.get("circle-pitch-alignment")){var s=Lt(n,1,a.zoom);i=!0,o=[s,s]}else i=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},Ie=function(t,e,n){var r=Lt(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},Te=function(t,e){return{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},Pe=function(t){return{u_matrix:t}},Ae=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:Lt(e,1,n),u_intensity:r}};function Me(e,n){var r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new t.MercatorCoordinate(0,i/r).toLngLat().lat,new t.MercatorCoordinate(0,(i+1)/r).toLngLat().lat]}var Le=function(t,e,n,r){var i=t.transform;return{u_matrix:Oe(t,e,n,r),u_ratio:1/Lt(e,1,i.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Re=function(e,n,r,i,o){return t.extend(Le(e,n,r,o),{u_image:0,u_image_height:i})},De=function(t,e,n,r,i){var o=t.transform,a=ze(e,o);return{u_matrix:Oe(t,e,n,i),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Lt(e,1,o.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Ne=function(e,n,r,i,o,a){var s=e.lineAtlas,l=ze(n,e.transform),u="round"===r.layout.get("line-cap"),c=s.getDash(i.from,u),h=s.getDash(i.to,u),f=c.width*o.fromScale,p=h.width*o.toScale;return t.extend(Le(e,n,r,a),{u_patternscale_a:[l/f,-c.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:s.width/(256*Math.min(f,p)*e.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:o.t})};function ze(t,e){return 1/Lt(t,1,e.tileZoom)}function Oe(t,e,n,r){return t.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Fe=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Be(i.paint.get("raster-hue-rotate"))};var o,a};function Be(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var je=function(t,e,n,r,i,o,a,s,l,u){var c=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},Ue=function(e,n,r,i,o,a,s,l,u,c,h){var f=o.transform;return t.extend(je(e,n,r,i,o,a,s,l,u,c),{u_gamma_scale:i?Math.cos(f._pitch)*f.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:+h})},Ve=function(e,n,r,i,o,a,s,l,u,c){return t.extend(Ue(e,n,r,i,o,a,s,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1})},Ze=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},qe=function(e,n,r,i,o,a){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),a=n.imageManager.getPixelSize(),s=a.width,l=a.height,u=Math.pow(2,r.tileID.overscaledZ),c=r.tileSize*Math.pow(2,n.transform.tileZoom)/u,h=c*(r.tileID.canonical.x+r.tileID.wrap*u),f=c*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,l],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/Lt(r,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,f>>16],u_pixel_coord_lower:[65535&h,65535&f]}}(i,a,r,o),{u_matrix:e,u_opacity:n})},Ge={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},collisionCircle:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}},debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}},terrain:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texture:new t.Uniform1i(e,n.u_texture)}},terrainDepth:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},terrainCoords:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texture:new t.Uniform1i(e,n.u_texture),u_terrain_coords_id:new t.Uniform1f(e,n.u_terrain_coords_id)}}},We=function(){function t(e,n,r){d(this,t),this.context=e;var i=e.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}return p(t,[{key:"bind",value:function(){this.context.bindElementBuffer.set(this.buffer)}},{key:"updateData",value:function(t){var e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),t}(),Xe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},He=function(){function t(e,n,r,i){d(this,t),this.length=n.length,this.attributes=r,this.itemSize=n.bytesPerElement,this.dynamicDraw=i,this.context=e;var o=e.gl;this.buffer=o.createBuffer(),e.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}return p(t,[{key:"bind",value:function(){this.context.bindVertexBuffer.set(this.buffer)}},{key:"updateData",value:function(t){if(t.length!==this.length)throw new Error("Length of new data is ".concat(t.length,", which doesn't match current length of ").concat(this.length));var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}},{key:"enableAttributes",value:function(t,e){for(var n=0;n<this.attributes.length;n++){var r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}}},{key:"setVertexAttribPointers",value:function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[Xe[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),t}(),Ye=function(){function t(e){d(this,t),this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}return p(t,[{key:"get",value:function(){return this.current}},{key:"set",value:function(t){}},{key:"getDefault",value:function(){return this.default}},{key:"setDefault",value:function(){this.set(this.default)}}]),t}(),$e=function(e){m(r,e);var n=g(r);function r(){return d(this,r),n.apply(this,arguments)}return p(r,[{key:"getDefault",value:function(){return t.Color.transparent}},{key:"set",value:function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}]),r}(Ye),Ke=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return 1}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}]),n}(Ye),Je=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return 0}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}]),n}(Ye),Qe=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return[!0,!0,!0,!0]}},{key:"set",value:function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}]),n}(Ye),tn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!0}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}]),n}(Ye),en=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return 255}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}]),n}(Ye),nn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return{func:this.gl.ALWAYS,ref:0,mask:255}}},{key:"set",value:function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}]),n}(Ye),rn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}},{key:"set",value:function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}]),n}(Ye),on=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}}]),n}(Ye),an=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return[0,1]}},{key:"set",value:function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}]),n}(Ye),sn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}}]),n}(Ye),ln=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return this.gl.LESS}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}]),n}(Ye),un=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}}]),n}(Ye),cn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){var t=this.gl;return[t.ONE,t.ZERO]}},{key:"set",value:function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}]),n}(Ye),hn=function(e){m(r,e);var n=g(r);function r(){return d(this,r),n.apply(this,arguments)}return p(r,[{key:"getDefault",value:function(){return t.Color.transparent}},{key:"set",value:function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}]),r}(Ye),fn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return this.gl.FUNC_ADD}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}]),n}(Ye),pn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}}]),n}(Ye),dn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return this.gl.BACK}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}]),n}(Ye),mn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return this.gl.CCW}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}]),n}(Ye),gn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}]),n}(Ye),vn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return this.gl.TEXTURE0}},{key:"set",value:function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}]),n}(Ye),yn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}},{key:"set",value:function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}]),n}(Ye),_n=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}}]),n}(Ye),xn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}}]),n}(Ye),bn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}}]),n}(Ye),wn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}}]),n}(Ye),Sn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}]),n}(Ye),En=function(t){m(n,t);var e=g(n);function n(t){var r;return d(this,n),(r=e.call(this,t)).vao=t.extVertexArrayObject,r}return p(n,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}]),n}(Ye),kn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return 4}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}}]),n}(Ye),Cn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}}]),n}(Ye),In=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}}]),n}(Ye),Tn=function(t){m(n,t);var e=g(n);function n(t,r){var i;return d(this,n),(i=e.call(this,t)).context=t,i.parent=r,i}return p(n,[{key:"getDefault",value:function(){return null}}]),n}(Ye),Pn=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"setDirty",value:function(){this.dirty=!0}},{key:"set",value:function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}}]),n}(Tn),An=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"set",value:function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}}]),n}(Tn),Mn=function(){function t(e,n,r,i){d(this,t),this.context=e,this.width=n,this.height=r;var o=e.gl,a=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new Pn(e,a),i&&(this.depthAttachment=new An(e,a)),o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}return p(t,[{key:"destroy",value:function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}t.deleteFramebuffer(this.framebuffer)}}]),t}(),Ln=p((function t(e,n,r){d(this,t),this.blendFunction=e,this.blendColor=n,this.mask=r}));Ln.Replace=[1,0],Ln.disabled=new Ln(Ln.Replace,t.Color.transparent,[!1,!1,!1,!1]),Ln.unblended=new Ln(Ln.Replace,t.Color.transparent,[!0,!0,!0,!0]),Ln.alphaBlended=new Ln([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Rn=function(){function t(e){d(this,t),this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new $e(this),this.clearDepth=new Ke(this),this.clearStencil=new Je(this),this.colorMask=new Qe(this),this.depthMask=new tn(this),this.stencilMask=new en(this),this.stencilFunc=new nn(this),this.stencilOp=new rn(this),this.stencilTest=new on(this),this.depthRange=new an(this),this.depthTest=new sn(this),this.depthFunc=new ln(this),this.blend=new un(this),this.blendFunc=new cn(this),this.blendColor=new hn(this),this.blendEquation=new fn(this),this.cullFace=new pn(this),this.cullFaceSide=new dn(this),this.frontFace=new mn(this),this.program=new gn(this),this.activeTexture=new vn(this),this.viewport=new yn(this),this.bindFramebuffer=new _n(this),this.bindRenderbuffer=new xn(this),this.bindTexture=new bn(this),this.bindVertexBuffer=new wn(this),this.bindElementBuffer=new Sn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new En(this),this.pixelStoreUnpack=new kn(this),this.pixelStoreUnpackPremultiplyAlpha=new Cn(this),this.pixelStoreUnpackFlipY=new In(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}return p(t,[{key:"setDefault",value:function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}},{key:"setDirty",value:function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}},{key:"createIndexBuffer",value:function(t,e){return new We(this,t,e)}},{key:"createVertexBuffer",value:function(t,e,n){return new He(this,t,e,n)}},{key:"createRenderbuffer",value:function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i}},{key:"createFramebuffer",value:function(t,e,n){return new Mn(this,t,e,n)}},{key:"clear",value:function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)}},{key:"setCullFace",value:function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}},{key:"setDepthMode",value:function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}},{key:"setStencilMode",value:function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}},{key:"setColorMode",value:function(t){u(t.blendFunction,Ln.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}},{key:"unbindVAO",value:function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}]),t}(),Dn=p((function t(e,n,r){d(this,t),this.func=e,this.mask=n,this.range=r}));Dn.ReadOnly=!1,Dn.ReadWrite=!0,Dn.disabled=new Dn(519,Dn.ReadOnly,[0,1]);var Nn=7680,zn=p((function t(e,n,r,i,o,a){d(this,t),this.test=e,this.ref=n,this.mask=r,this.fail=i,this.depthFail=o,this.pass=a}));zn.disabled=new zn({func:519,mask:0},0,0,Nn,Nn,Nn);var On,Fn=p((function t(e,n,r){d(this,t),this.enable=e,this.mode=n,this.frontFace=r}));function Bn(e,n,r,i,o,a,s){for(var l=e.context,u=l.gl,c=e.useProgram("collisionBox"),h=[],f=0,p=0,d=0;d<i.length;d++){var m=i[d],g=n.getTile(m),v=g.getBucket(r);if(v){var y=m.posMatrix;0===o[0]&&0===o[1]||(y=e.translatePosMatrix(m.posMatrix,g,o,a));var _=s?v.textCollisionBox:v.iconCollisionBox,x=v.collisionCircleArray;if(x.length>0){var b=t.create(),w=y;t.mul(b,v.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(b,b,v.placementViewportMatrix),h.push({circleArray:x,circleOffset:p,transform:w,invTransform:b,coord:m}),p=f+=x.length/4}_&&c.draw(l,u.LINES,Dn.disabled,zn.disabled,e.colorModeForRenderPass(),Fn.disabled,Ie(y,e.transform,g),e.style.terrain&&e.style.terrain.getTerrainData(m),r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(s&&h.length){var S=e.useProgram("collisionCircle"),E=new t.CollisionCircleLayoutArray;E.resize(4*f),E._trim();for(var k=0,C=0,I=h;C<I.length;C++)for(var T=I[C],P=0;P<T.circleArray.length/4;P++){var A=4*P,M=T.circleArray[A+0],L=T.circleArray[A+1],R=T.circleArray[A+2],D=T.circleArray[A+3];E.emplace(k++,M,L,R,D,0),E.emplace(k++,M,L,R,D,1),E.emplace(k++,M,L,R,D,2),E.emplace(k++,M,L,R,D,3)}(!On||On.length<2*f)&&(On=function(e){var n=2*e,r=new t.QuadTriangleArray;r.resize(n),r._trim();for(var i=0;i<n;i++){var o=6*i;r.uint16[o+0]=4*i+0,r.uint16[o+1]=4*i+1,r.uint16[o+2]=4*i+2,r.uint16[o+3]=4*i+2,r.uint16[o+4]=4*i+3,r.uint16[o+5]=4*i+0}return r}(f));for(var N,z=l.createIndexBuffer(On,!0),O=l.createVertexBuffer(E,t.collisionCircleLayout.members,!0),F=0,B=h;F<B.length;F++){var j=B[F],U={u_matrix:j.transform,u_inv_matrix:j.invTransform,u_camera_to_center_distance:(N=e.transform).cameraToCenterDistance,u_viewport_size:[N.width,N.height]};S.draw(l,u.TRIANGLES,Dn.disabled,zn.disabled,e.colorModeForRenderPass(),Fn.disabled,U,e.style.terrain&&e.style.terrain.getTerrainData(j.coord),r.id,O,z,t.SegmentVector.simpleSegment(0,2*j.circleOffset,j.circleArray.length,j.circleArray.length/2),null,e.transform.zoom,null,null,null)}O.destroy(),z.destroy()}}Fn.disabled=new Fn(!1,1029,2305),Fn.backCCW=new Fn(!0,1029,2305);var jn=t.identity(new Float32Array(16));function Un(e,n,r,i,o,a){var s=t.getAnchorAlignment(e),l=-(s.horizontalAlign-.5)*n,u=-(s.verticalAlign-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.pointGeometry((l/o+c[0])*a,(u/o+c[1])*a)}function Vn(e,n,r,i,o,a,s,l,u,c,h){var f=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,d=e.icon.dynamicLayoutVertexArray,m={};p.clear();for(var g=0;g<f.length;g++){var v=f.get(g),y=e.allowVerticalPlacement&&!v.placedOrientation,_=v.hidden||!v.crossTileID||y?null:i[v.crossTileID];if(_){var x=new t.pointGeometry(v.anchorX,v.anchorY),b=yt(x,r?s:a,h),w=_t(o.cameraToCenterDistance,b.signedDistanceFromCamera),S=t.evaluateSizeForFeature(e.textSizeData,u,v)*w/t.ONE_EM;r&&(S*=e.tilePixelRatio/l);for(var E=_.width,k=_.height,C=Un(_.anchor,E,k,_.textOffset,_.textBoxScale,S),I=r?yt(x.add(C),a,h).point:b.point.add(n?C.rotate(-o.angle):C),T=e.allowVerticalPlacement&&v.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,P=0;P<v.numGlyphs;P++)t.addDynamicAttributes(p,I,T);c&&v.associatedIconIndex>=0&&(m[v.associatedIconIndex]={shiftedAnchor:I,angle:T})}else Tt(v.numGlyphs,p)}if(c){d.clear();for(var A=e.icon.placedSymbolArray,M=0;M<A.length;M++){var L=A.get(M);if(L.hidden)Tt(L.numGlyphs,d);else{var R=m[M];if(R)for(var D=0;D<L.numGlyphs;D++)t.addDynamicAttributes(d,R.shiftedAnchor,R.angle);else Tt(L.numGlyphs,d)}}e.icon.dynamicLayoutVertexBuffer.updateData(d)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function Zn(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function qn(e,n,r,i,o,a,s,l,u,c,h,p){var d,m=e.context,g=m.gl,v=e.transform,y="map"===l,_="map"===u,x="viewport"!==l&&"point"!==r.layout.get("symbol-placement"),b=y&&!_&&!x,w=!r.layout.get("symbol-sort-key").isConstant(),S=!1,E=e.depthModeForSublayer(0,Dn.ReadOnly),k=r.layout.get("text-variable-anchor"),C=[],I=f(i);try{var T=function(){var i=d.value,l=n.getTile(i),u=l.getBucket(r);if(!u)return"continue";var h=o?u.text:u.icon;if(!h||!h.segments.get().length)return"continue";var p=h.programConfigurations.get(r.id),m=o||u.sdfIcons,E=o?u.textSizeData:u.iconSizeData,I=_||0!==v.pitch,T=e.useProgram(Zn(m,o,u),p),P=t.evaluateSizeForZoom(E,v.zoom),A=e.style.terrain&&e.style.terrain.getTerrainData(i),M=void 0,L=void 0,R=void 0,D=void 0,N=[0,0],z=null;if(o){if(L=l.glyphAtlasTexture,R=g.LINEAR,M=l.glyphAtlasTexture.size,u.iconsInText){N=l.imageAtlasTexture.size,z=l.imageAtlasTexture;var O="composite"===E.kind||"camera"===E.kind;D=I||e.options.rotating||e.options.zooming||O?g.LINEAR:g.NEAREST}}else{var F=1!==r.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;L=l.imageAtlasTexture,R=m||e.options.rotating||e.options.zooming||F||I?g.LINEAR:g.NEAREST,M=l.imageAtlasTexture.size}var B=Lt(l,1,e.transform.zoom),j=gt(i.posMatrix,_,y,e.transform,B),U=vt(i.posMatrix,_,y,e.transform,B),V=k&&u.hasTextData(),Z="none"!==r.layout.get("icon-text-fit")&&V&&u.hasIconData();if(x){var q=e.style.terrain?function(t,n){return e.style.terrain.getElevation(i,t,n)}:null,G="map"===r.layout.get("text-rotation-alignment");bt(u,i.posMatrix,e,o,j,U,_,c,G,q)}var W=e.translatePosMatrix(i.posMatrix,l,a,s),X=x||o&&k||Z?jn:j,H=e.translatePosMatrix(U,l,a,s,!0),Y=m&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),$={program:T,buffers:h,uniformValues:m?u.iconsInText?Ve(E.kind,P,b,_,e,W,X,H,M,N):Ue(E.kind,P,b,_,e,W,X,H,o,M,!0):je(E.kind,P,b,_,e,W,X,H,o,M),atlasTexture:L,atlasTextureIcon:z,atlasInterpolation:R,atlasInterpolationIcon:D,isSDF:m,hasHalo:Y};if(w&&u.canOverlap){S=!0;var K,J=h.segments.get(),Q=f(J);try{for(Q.s();!(K=Q.n()).done;){var tt=K.value;C.push({segments:new t.SegmentVector([tt]),sortKey:tt.sortKey,state:$,terrainData:A})}}catch(et){Q.e(et)}finally{Q.f()}}else C.push({segments:h.segments,sortKey:0,state:$,terrainData:A})};for(I.s();!(d=I.n()).done;)T()}catch(D){I.e(D)}finally{I.f()}S&&C.sort((function(t,e){return t.sortKey-e.sortKey}));for(var P=0,A=C;P<A.length;P++){var M=A[P],L=M.state;if(m.activeTexture.set(g.TEXTURE0),L.atlasTexture.bind(L.atlasInterpolation,g.CLAMP_TO_EDGE),L.atlasTextureIcon&&(m.activeTexture.set(g.TEXTURE1),L.atlasTextureIcon&&L.atlasTextureIcon.bind(L.atlasInterpolationIcon,g.CLAMP_TO_EDGE)),L.isSDF){var R=L.uniformValues;L.hasHalo&&(R.u_is_halo=1,Gn(L.buffers,M.segments,r,e,L.program,E,h,p,R,M.terrainData)),R.u_is_halo=0}Gn(L.buffers,M.segments,r,e,L.program,E,h,p,L.uniformValues,M.terrainData)}}function Gn(t,e,n,r,i,o,a,s,l,u){var c=r.context;i.draw(c,c.gl.TRIANGLES,o,a,s,Fn.disabled,l,u,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Wn(t,e,n,r,i,o,a){var s,l,u,c,h,p=t.context.gl,d=n.paint.get("fill-pattern"),m=d&&d.constantOr(1),g=n.getCrossfadeParameters();a?(l=m&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(l=m?"fillPattern":"fill",s=p.TRIANGLES);var v,y=f(r);try{for(y.s();!(v=y.n()).done;){var _=v.value,x=e.getTile(_);if(!m||x.patternsLoaded()){var b=x.getBucket(n);if(b){var w=b.programConfigurations.get(n.id),S=t.useProgram(l,w),E=t.style.terrain&&t.style.terrain.getTerrainData(_);m&&(t.context.activeTexture.set(p.TEXTURE0),x.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),w.updatePaintBuffers(g));var k=d.constantOr(null);if(k&&x.imageAtlas){var C=x.imageAtlas,I=C.patternPositions[k.to.toString()],T=C.patternPositions[k.from.toString()];I&&T&&w.setConstantPatternPositions(I,T)}var P=E?_:null,A=t.translatePosMatrix(P?P.posMatrix:_.posMatrix,x,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){c=b.indexBuffer2,h=b.segments2;var M=[p.drawingBufferWidth,p.drawingBufferHeight];u="fillOutlinePattern"===l&&m?ke(A,t,g,x,M):Ee(A,M)}else c=b.indexBuffer,h=b.segments,u=m?Se(A,t,g,x):we(A);S.draw(t.context,s,i,t.stencilModeForClipping(_),o,Fn.disabled,u,E,n.id,b.layoutVertexBuffer,c,h,n.paint,t.transform.zoom,w)}}}}catch(L){y.e(L)}finally{y.f()}}function Xn(t,e,n,r,i,o,a){var s,l=t.context,u=l.gl,c=n.paint.get("fill-extrusion-pattern"),h=c.constantOr(1),p=n.getCrossfadeParameters(),d=n.paint.get("fill-extrusion-opacity"),m=f(r);try{for(m.s();!(s=m.n()).done;){var g=s.value,v=e.getTile(g),y=v.getBucket(n);if(y){var _=t.style.terrain&&t.style.terrain.getTerrainData(g),x=y.programConfigurations.get(n.id),b=t.useProgram(h?"fillExtrusionPattern":"fillExtrusion",x);h&&(t.context.activeTexture.set(u.TEXTURE0),v.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),x.updatePaintBuffers(p));var w=c.constantOr(null);if(w&&v.imageAtlas){var S=v.imageAtlas,E=S.patternPositions[w.to.toString()],k=S.patternPositions[w.from.toString()];E&&k&&x.setConstantPatternPositions(E,k)}var C=t.translatePosMatrix(g.posMatrix,v,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),I=n.paint.get("fill-extrusion-vertical-gradient"),T=h?be(C,t,I,d,g,p,v):xe(C,t,I,d);b.draw(l,l.gl.TRIANGLES,i,o,a,Fn.backCCW,T,_,n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,t.transform.zoom,x,t.style.terrain&&y.centroidVertexBuffer)}}}catch(P){m.e(P)}finally{m.f()}}function Hn(t,e,n,r,i,o,a){var s=t.context,l=s.gl,u=n.fbo;if(u){var c=t.useProgram("hillshade"),h=t.style.terrain&&t.style.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get()),c.draw(s,l.TRIANGLES,i,o,a,Fn.disabled,function(t,e,n,r){var i=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),a=n.paint.get("hillshade-accent-color"),s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);var l=!t.options.moving;return{u_matrix:r?r.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Me(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}}(t,n,r,h?e:null),h,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function Yn(e,n,r,i,o,a){var s=e.context,l=s.gl,u=n.dem;if(u&&u.data){var c=u.dim,h=u.stride,f=u.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(h),n.demTexture){var p=n.demTexture;p.update(f,{premultiply:!1}),p.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else n.demTexture=new _(s,f,l.RGBA,{premultiply:!1}),n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var d=n.fbo;if(!d){var m=new _(s,{width:c,height:c,data:null},l.RGBA);m.bind(l.LINEAR,l.CLAMP_TO_EDGE),(d=n.fbo=s.createFramebuffer(c,c,!0)).colorAttachment.set(m.texture)}s.bindFramebuffer.set(d.framebuffer),s.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,i,o,a,Fn.disabled,function(e,n){var r=n.stride,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}}(n.tileID,u),null,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function $n(e,n,r,i,o,a){var s=i.paint.get("raster-fade-duration");if(!a&&s>0){var l=t.exported.now(),u=(l-e.timeAdded)/s,c=n?(l-n.timeAdded)/s:-1,h=r.getSource(),f=o.coveringZoomLevel({tileSize:h.tileSize,roundZoom:h.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-f)>Math.abs(e.tileID.overscaledZ-f),d=p&&e.refreshedUponExpiration?1:t.clamp(p?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var Kn=new t.Color(1,0,0,1),Jn=new t.Color(0,1,0,1),Qn=new t.Color(0,0,1,1),tr=new t.Color(1,0,1,1),er=new t.Color(0,1,1,1);function nr(t,e,n,r){ir(t,0,e+n/2,t.transform.width,n,r)}function rr(t,e,n,r){ir(t,e-n/2,0,n,t.transform.height,r)}function ir(t,e,n,r,i,o){var a=t.context,s=a.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*t.pixelRatio,n*t.pixelRatio,r*t.pixelRatio,i*t.pixelRatio),a.clear({color:o}),s.disable(s.SCISSOR_TEST)}function or(e,n,r){var i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),l=Dn.disabled,u=zn.disabled,c=e.colorModeForRenderPass(),h="$debug",f=e.style.terrain&&e.style.terrain.getTerrainData(r);i.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE);var p=n.getTileByID(r.key).latestRawTileData,d=Math.floor((p&&p.byteLength||0)/1024),m=n.getTile(r).tileSize,g=512/Math.min(m,512)*(r.overscaledZ/e.transform.zoom)*.5,v=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(v+=" => ".concat(r.overscaledZ)),function(t,e){t.initDebugOverlayCanvas();var n=t.debugOverlayCanvas,r=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,"".concat(v," ").concat(d,"kB")),s.draw(i,o.TRIANGLES,l,u,Ln.alphaBlended,Fn.disabled,Te(a,t.Color.transparent,g),null,h,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),s.draw(i,o.LINE_STRIP,l,u,c,Fn.disabled,Te(a,t.Color.red),f,h,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function ar(t,e,n){var r=t.context,i=r.gl,o=t.colorModeForRenderPass(),a=new Dn(i.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D),s=t.useProgram("terrain"),l=e.getTerrainMesh(),u=e.getTerrainData(n.tileID);r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height]),r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e.getRTTFramebuffer().colorAttachment.get());var c=t.transform.calculatePosMatrix(n.tileID.toUnwrapped());s.draw(r,i.TRIANGLES,a,zn.disabled,o,Fn.backCCW,{u_matrix:c,u_texture:0},u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}function sr(t,e,n,r){var i=t.context,o=n.tileSize*e.qualityFactor;n.textures[r]||(n.textures[r]=t.getTileTexture(o)||new _(i,{width:o,height:o,data:null},i.gl.RGBA),n.textures[r].bind(i.gl.LINEAR,i.gl.CLAMP_TO_EDGE),0===r&&e.sourceCache.renderHistory.unshift(n.tileID.key));var a=e.getRTTFramebuffer();a.colorAttachment.set(n.textures[r].texture),i.bindFramebuffer.set(a.framebuffer),i.viewport.set([0,0,o,o])}var lr=function(){function e(t){d(this,e),this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=t,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=t.style.terrain.sourceCache.getRenderableTiles(),this._init()}return p(e,[{key:"_init",value:function(){var t=this,e=this.painter.style,n=e.terrain;for(var r in e.sourceCaches){this._coordsDescendingInv[r]={};var i,o=e.sourceCaches[r].getVisibleCoordinates(),a=f(o);try{for(a.s();!(i=a.n()).done;){var s=i.value,l=n.sourceCache.getTerrainCoords(s);for(var u in l)this._coordsDescendingInv[r][u]||(this._coordsDescendingInv[r][u]=[]),this._coordsDescendingInv[r][u].push(l[u])}}catch(v){a.e(v)}finally{a.f()}}var c,h=f(e._order);try{for(h.s();!(c=h.n()).done;){var p=c.value,d=e._layers[p],m=d.source;if(this._renderToTexture[d.type]&&!this._coordsDescendingInvStr[m])for(var g in this._coordsDescendingInvStr[m]={},this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][g]=this._coordsDescendingInv[m][g].map((function(t){return t.key})).sort().join()}}catch(v){h.e(v)}finally{h.f()}return this._renderableTiles.forEach((function(e){for(var r in t._coordsDescendingInvStr){var i=t._coordsDescendingInvStr[r][e.tileID.key];i&&i!==e.textureCoords[r]&&e.clearTextures(t.painter),n.needsRerender(r,e.tileID)&&e.clearTextures(t.painter)}t._rerender[e.tileID.key]=!e.textures.length})),n.clearRerenderCache(),n.sourceCache.removeOutdated(this.painter),this}},{key:"renderLayer",value:function(e){var n=e.type,r=this.painter,i=r.style._order,o=r.currentLayer,a=o+1===i.length;if(this._renderToTexture[n]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(i[o]),!a))return!0;if(this._renderToTexture[this._prevType]||"hillshade"===n||this._renderToTexture[n]&&a){this._prevType=n;var s,l=this._stacks.length-1,u=this._stacks[l]||[],c=f(this._renderableTiles);try{for(c.s();!(s=c.n()).done;){var h=s.value;if(sr(r,r.style.terrain,h,l),this._rerender[h.tileID.key]){r.context.clear({color:t.Color.transparent});for(var p=0;p<u.length;p++){var d=r.style._layers[u[p]],m=d.source?this._coordsDescendingInv[d.source][h.tileID.key]:[h.tileID];r._renderTileClippingMasks(d,m),r.renderLayer(r,r.style.sourceCaches[d.source],d,m),d.source&&(h.textureCoords[d.source]=this._coordsDescendingInvStr[d.source][h.tileID.key])}}ar(r,r.style.terrain,h)}}catch(x){c.e(x)}finally{c.f()}if("hillshade"===n){this._stacks.push([i[o]]);var g,v=f(this._renderableTiles);try{for(v.s();!(g=v.n()).done;){var y=g.value,_=this._coordsDescendingInv[e.source][y.tileID.key];sr(r,r.style.terrain,y,this._stacks.length-1),r.context.clear({color:t.Color.transparent}),r._renderTileClippingMasks(e,_),r.renderLayer(r,r.style.sourceCaches[e.source],e,_),ar(r,r.style.terrain,y)}}catch(x){v.e(x)}finally{v.f()}return!0}return this._renderToTexture[n]}return!1}}]),e}(),ur={symbol:function(e,n,r,i,o){if("translucent"===e.renderPass){var a=zn.disabled,s=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,o,a,s){var l,u=n.transform,c="map"===o,h="map"===a,p=f(e);try{var d=function(){var e=l.value,o=i.getTile(e),a=o.getBucket(r);if(!a||!a.text||!a.text.segments.get().length)return"continue";var f=t.evaluateSizeForZoom(a.textSizeData,u.zoom),p=Lt(o,1,n.transform.zoom),d=gt(e.posMatrix,h,c,n.transform,p),m="none"!==r.layout.get("icon-text-fit")&&a.hasIconData();if(f){var g=Math.pow(2,u.zoom-o.tileID.overscaledZ);Vn(a,c,h,s,u,d,e.posMatrix,g,f,m,n.style.terrain?function(t,r){return n.style.terrain.getElevation(e,t,r)}:null)}};for(p.s();!(l=p.n()).done;)d()}catch(m){p.e(m)}finally{p.f()}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&qn(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,s),0!==r.paint.get("text-opacity").constantOr(1)&&qn(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Bn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Bn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var u=e.context,c=u.gl,h=e.depthModeForSublayer(0,Dn.ReadOnly),p=zn.disabled,d=e.colorModeForRenderPass(),m=[],g=0;g<i.length;g++){var v=i[g],y=n.getTile(v),_=y.getBucket(r);if(_){var x=_.programConfigurations.get(r.id),b=e.useProgram("circle",x),w=_.layoutVertexBuffer,S=_.indexBuffer,E=e.style.terrain&&e.style.terrain.getTerrainData(v),k={programConfiguration:x,program:b,layoutVertexBuffer:w,indexBuffer:S,uniformValues:Ce(e,v,y,r),terrainData:E};if(l){var C,I=_.segments.get(),T=f(I);try{for(T.s();!(C=T.n()).done;){var P=C.value;m.push({segments:new t.SegmentVector([P]),sortKey:P.sortKey,state:k})}}catch(j){T.e(j)}finally{T.f()}}else m.push({segments:_.segments,sortKey:0,state:k})}}l&&m.sort((function(t,e){return t.sortKey-e.sortKey}));for(var A=0,M=m;A<M.length;A++){var L=M[A],R=L.state,D=R.programConfiguration,N=R.program,z=R.layoutVertexBuffer,O=R.indexBuffer,F=R.uniformValues,B=R.terrainData;N.draw(u,c.TRIANGLES,h,p,d,Fn.disabled,F,B,r.id,z,O,L.segments,r.paint,e.transform.zoom,D)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=zn.disabled,l=new Ln([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,r){var i=t.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width/4,e.height/4,0,i.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,e,o,i)}}(o,e,r),o.clear({color:t.Color.transparent});for(var u=0;u<i.length;u++){var c=i[u];if(!n.hasRenderableParent(c)){var h=n.getTile(c),f=h.getBucket(r);if(f){var p=f.programConfigurations.get(r.id),d=e.useProgram("heatmap",p),m=e.transform.zoom;d.draw(o,a.TRIANGLES,Dn.disabled,s,l,Fn.disabled,Ae(c.posMatrix,h,m,r.paint.get("heatmap-intensity")),null,r.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,r.paint,e.transform.zoom,p)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new _(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Dn.disabled,zn.disabled,e.colorModeForRenderPass(),Fn.disabled,function(e,n,r,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(e,n),null,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s,l=e.depthModeForSublayer(0,Dn.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),h=r.paint.get("line-pattern"),p=h.constantOr(1),d=r.paint.get("line-gradient"),m=r.getCrossfadeParameters(),g=p?"linePattern":c?"lineSDF":d?"lineGradient":"line",v=e.context,y=v.gl,x=!0,b=f(i);try{for(b.s();!(s=b.n()).done;){var w=s.value,S=n.getTile(w);if(!p||S.patternsLoaded()){var E=S.getBucket(r);if(E){var k=E.programConfigurations.get(r.id),C=e.context.program.get(),I=e.useProgram(g,k),T=x||I.program!==C,P=e.style.terrain&&e.style.terrain.getTerrainData(w),A=h.constantOr(null);if(A&&S.imageAtlas){var M=S.imageAtlas,L=M.patternPositions[A.to.toString()],R=M.patternPositions[A.from.toString()];L&&R&&k.setConstantPatternPositions(L,R)}var D=P?w:null,N=p?De(e,S,r,m,D):c?Ne(e,S,r,c,m,D):d?Re(e,S,r,E.lineClipsArray.length,D):Le(e,S,r,D);if(p)v.activeTexture.set(y.TEXTURE0),S.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),k.updatePaintBuffers(m);else if(c&&(T||e.lineAtlas.dirty))v.activeTexture.set(y.TEXTURE0),e.lineAtlas.bind(v);else if(d){var z=E.gradients[r.id],O=z.texture;if(r.gradientVersion!==z.version){var F=256;if(r.stepInterpolant){var B=n.getSource().maxzoom,j=w.canonical.z===B?Math.ceil(1<<e.transform.maxZoom-w.canonical.z):1;F=t.clamp(t.nextPowerOfTwo(E.maxLineLength/t.EXTENT*1024*j),256,v.maxTextureSize)}z.gradient=t.renderColorRamp({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:F,image:z.gradient||void 0,clips:E.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new _(v,z.gradient,y.RGBA),z.version=r.gradientVersion,O=z.texture}v.activeTexture.set(y.TEXTURE0),O.bind(r.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}I.draw(v,y.TRIANGLES,l,e.stencilModeForClipping(w),u,Fn.disabled,N,P,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,e.transform.zoom,k,E.layoutVertexBuffer2),x=!1}}}}catch(U){b.e(U)}finally{b.f()}}}},fill:function(e,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){var c=e.depthModeForSublayer(1,"opaque"===e.renderPass?Dn.ReadWrite:Dn.ReadOnly);Wn(e,n,r,i,c,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){var h=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Dn.ReadOnly);Wn(e,n,r,i,h,s,!0)}}},"fill-extrusion":function(t,e,n,r){var i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===t.renderPass){var o=new Dn(t.context.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))Xn(t,e,n,r,o,zn.disabled,Ln.disabled),Xn(t,e,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();Xn(t,e,n,r,o,zn.disabled,a)}}},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var i,o=t.context,a=t.depthModeForSublayer(0,Dn.ReadOnly),s=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r],u=h(l,2),c=u[0],p=u[1],d=f(p);try{for(d.s();!(i=d.n()).done;){var m=i.value,g=e.getTile(m);void 0!==g.needsHillshadePrepare&&g.needsHillshadePrepare&&"offscreen"===t.renderPass?Yn(t,g,n,a,zn.disabled,s):"translucent"===t.renderPass&&Hn(t,m,g,n,a,c[m.overscaledZ],s)}}catch(v){d.e(v)}finally{d.f()}o.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&r.length){var i,o=t.context,a=o.gl,s=e.getSource(),l=t.useProgram("raster"),u=t.colorModeForRenderPass(),c=s instanceof B?[{},r]:t.stencilConfigForOverlap(r),p=h(c,2),d=p[0],m=p[1],g=m[m.length-1].overscaledZ,v=!t.options.moving,y=f(m);try{for(y.s();!(i=y.n()).done;){var _=i.value,x=t.depthModeForSublayer(_.overscaledZ-g,1===n.paint.get("raster-opacity")?Dn.ReadWrite:Dn.ReadOnly,a.LESS),b=e.getTile(_);b.registerFadeDuration(n.paint.get("raster-fade-duration"));var w=e.findLoadedParent(_,0),S=$n(b,w,e,n,t.transform,t.style.terrain),E=void 0,k=void 0,C="nearest"===n.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;o.activeTexture.set(a.TEXTURE0),b.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(a.TEXTURE1),w?(w.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),E=Math.pow(2,w.tileID.overscaledZ-b.tileID.overscaledZ),k=[b.tileID.canonical.x*E%1,b.tileID.canonical.y*E%1]):b.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);var I=t.style.terrain&&t.style.terrain.getTerrainData(_),T=I?_:null,P=T?T.posMatrix:t.transform.calculatePosMatrix(_.toUnwrapped(),v),A=Fe(P,k||[0,0],E||1,S,n);s instanceof B?l.draw(o,a.TRIANGLES,x,zn.disabled,u,Fn.disabled,A,I,n.id,s.boundsBuffer,t.quadTriangleIndexBuffer,s.boundsSegments):l.draw(o,a.TRIANGLES,x,d[_.overscaledZ],u,Fn.disabled,A,I,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}catch(M){y.e(M)}finally{y.f()}}},background:function(t,e,n,r){var i=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0!==o){var a=t.context,s=a.gl,l=t.transform,u=l.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var h=!c&&1===i.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===h){var p=zn.disabled,d=t.depthModeForSublayer(0,"opaque"===h?Dn.ReadWrite:Dn.ReadOnly),m=t.colorModeForRenderPass(),g=t.useProgram(c?"backgroundPattern":"background"),v=r||l.coveringTiles({tileSize:u,terrain:t.style.terrain});c&&(a.activeTexture.set(s.TEXTURE0),t.imageManager.bind(t.context));var y,_=n.getCrossfadeParameters(),x=f(v);try{for(x.s();!(y=x.n()).done;){var b=y.value,w=r?b.posMatrix:t.transform.calculatePosMatrix(b.toUnwrapped()),S=c?qe(w,o,t,c,{tileID:b,tileSize:u},_):Ze(w,o,i),E=t.style.terrain&&t.style.terrain.getTerrainData(b);g.draw(a,s.TRIANGLES,d,p,m,Fn.disabled,S,E,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}catch(k){x.e(k)}finally{x.f()}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)or(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),o.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(zn.disabled);var a="3d"===i.renderingMode?new Dn(t.context.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Dn.ReadOnly);r.setDepthMode(a),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},cr=function(){function e(n,r){d(this,e),this.context=new Rn(n),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.create(),renderTime:0},this.setup(),this.numSublayers=Y.maxUnderzooming+Y.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ie,this.gpuTimers={}}return p(e,[{key:"resize",value:function(t,e,n){if(this.width=t*n,this.height=e*n,this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style){var r,i=f(this.style._order);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.style._layers[o].resize()}}catch(a){i.e(a)}finally{i.f()}}}},{key:"setup",value:function(){var e=this.context,n=new t.PosArray;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,oe.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.PosArray;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,oe.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,F.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.PosArray;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,oe.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.LineStripIndexArray;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.TriangleIndexArray;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new _(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new zn({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}},{key:"clearStencil",value:function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Dn.disabled,this.stencilClearMode,Ln.disabled,Fn.disabled,Pe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}},{key:"_renderTileClippingMasks",value:function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,r=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(Ln.disabled),n.setDepthMode(Dn.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};var o,a=f(e);try{for(a.s();!(o=a.n()).done;){var s=o.value,l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,u=this.style.terrain&&this.style.terrain.getTerrainData(s);i.draw(n,r.TRIANGLES,Dn.disabled,new zn({func:r.ALWAYS,mask:0},l,255,r.KEEP,r.KEEP,r.REPLACE),Ln.disabled,Fn.disabled,Pe(s.posMatrix),u,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}catch(c){a.e(c)}finally{a.f()}}}},{key:"stencilModeFor3D",value:function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new zn({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}},{key:"stencilModeForClipping",value:function(t){var e=this.context.gl;return new zn({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}},{key:"stencilConfigForOverlap",value:function(t){var e=this.context.gl,n=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),i=n[n.length-1].overscaledZ,o=n[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+i]=new zn({func:e.GEQUAL,mask:255},s+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=o,[a,n]}return[r({},i,zn.disabled),n]}},{key:"colorModeForRenderPass",value:function(){var e=this.context.gl;if(this._showOverdrawInspector){var n=1/8;return new Ln([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ln.unblended:Ln.alphaBlended}},{key:"depthModeForSublayer",value:function(t,e,n){if(!this.opaquePassEnabledForLayer())return Dn.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Dn(n||this.context.gl.LEQUAL,e,[r,r])}},{key:"opaquePassEnabledForLayer",value:function(){return this.currentLayer<this.opaquePassCutoff}},{key:"render",value:function(e,n){var r=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();var i=this.style._order,o=this.style.sourceCaches,a=this.style.terrain&&new lr(this);for(var s in o){var l=o[s];l.used&&l.prepare(this.context)}var u={},c={},h={};for(var p in o){var d=o[p];u[p]=d.getVisibleCoordinates(),c[p]=u[p].slice().reverse(),h[p]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<i.length;m++)if(this.style._layers[i[m]].is3D()){this.opaquePassCutoff=m;break}if(a){this.opaquePassCutoff=0;var g=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!t.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||g.length)&&(t.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,n){var r=e.context,i=r.gl,o=Ln.unblended,a=new Dn(i.LEQUAL,Dn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.sourceCache.getRenderableTiles(),u=e.useProgram("terrainDepth");r.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.Color.transparent,depth:1});var c,h=f(l);try{for(h.s();!(c=h.n()).done;){var p=c.value,d=n.getTerrainData(p.tileID),m=e.transform.calculatePosMatrix(p.tileID.toUnwrapped());u.draw(r,i.TRIANGLES,a,zn.disabled,o,Fn.backCCW,{u_matrix:m},d,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}}catch(g){h.e(g)}finally{h.f()}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.terrain),function(e,n){var r=e.context,i=r.gl,o=Ln.unblended,a=new Dn(i.LEQUAL,Dn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.getCoordsTexture(),u=n.sourceCache.getRenderableTiles(),c=e.useProgram("terrainCoords");r.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.Color.transparent,depth:1}),n.coordsIndex=[];var h,p=f(u);try{for(p.s();!(h=p.n()).done;){var d=h.value,m=n.getTerrainData(d.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);var g=e.transform.calculatePosMatrix(d.tileID.toUnwrapped());c.draw(r,i.TRIANGLES,a,zn.disabled,o,Fn.backCCW,{u_matrix:g,u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0},m,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),n.coordsIndex.push(d.tileID.key)}}catch(v){p.e(v)}finally{p.f()}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.terrain))}this.renderPass="offscreen";var v,y,_,x=f(i);try{for(x.s();!(v=x.n()).done;){var b=v.value,w=this.style._layers[b];if(w.hasOffscreenPass()&&!w.isHidden(this.transform.zoom)){var S=c[w.source];("custom"===w.type||S.length)&&this.renderLayer(this,o[w.source],w,S)}}}catch(A){x.e(A)}finally{x.f()}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!a)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var E=this.style._layers[i[this.currentLayer]],k=o[E.source],C=u[E.source];this._renderTileClippingMasks(E,C),this.renderLayer(this,k,E,C)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var I=this.style._layers[i[this.currentLayer]],T=o[I.source];if(!a||!a.renderLayer(I)){var P=("symbol"===I.type?h:c)[I.source];this._renderTileClippingMasks(I,u[I.source]),this.renderLayer(this,T,I,P)}}this.options.showTileBoundaries&&(Object.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(r.transform.zoom)&&(t.source!==(_&&_.id)&&(_=r.style.sourceCaches[t.source]),(!y||y.getSource().maxzoom<_.getSource().maxzoom)&&(y=_))})),y&&ur.debug(this,y,y.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;nr(t,t.transform.height-(e.top||0),3,Kn),nr(t,e.bottom||0,3,Jn),rr(t,e.left||0,3,Qn),rr(t,t.transform.width-(e.right||0),3,tr);var n=t.transform.centerPoint;!function(t,e,n,r){ir(t,e-1,n-10,2,20,r),ir(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,er)}(this),this.context.setDefault()}},{key:"renderLayer",value:function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(r||[]).length)&&(this.id=n.id,this.gpuTimingStart(n),ur[n.type](t,e,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())}},{key:"gpuTimingStart",value:function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}}},{key:"gpuTimingEnd",value:function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}}},{key:"collectGpuTimers",value:function(){var t=this.gpuTimers;return this.gpuTimers={},t}},{key:"queryGpuTimers",value:function(t){var e={};for(var n in t){var r=t[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=o}return e}},{key:"translatePosMatrix",value:function(e,n,r,i,o){if(!r[0]&&!r[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);r=[r[0]*l-r[1]*s,r[0]*s+r[1]*l]}var u=[o?r[0]:Lt(n,r[0],this.transform.zoom),o?r[1]:Lt(n,r[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c}},{key:"saveTileTexture",value:function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}},{key:"getTileTexture",value:function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null}},{key:"isPatternMissing",value:function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}},{key:"useProgram",value:function(t,e){this.cache=this.cache||{};var n=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new ye(this.context,t,de[t],e,Ge[t],this._showOverdrawInspector,this.style.terrain)),this.cache[n]}},{key:"setCustomLayerDefaults",value:function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}},{key:"setBaseState",value:function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}},{key:"initDebugOverlayCanvas",value:function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}},{key:"destroy",value:function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}]),e}(),hr=function(){function e(t,n){d(this,e),this.points=t,this.planes=n}return p(e,null,[{key:"fromInvProjectionMatrix",value:function(n,r,i){var o=Math.pow(2,i),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(e){var i=1/(e=t.transformMat4([],e,n))[3]/r*o;return t.mul$1(e,e,[i,i,1/e[3],i])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var n=t.sub([],a[e[0]],a[e[1]]),r=t.sub([],a[e[2]],a[e[1]]),i=t.normalize([],t.cross([],n,r)),o=-t.dot(i,a[e[1]]);return i.concat(o)}));return new e(a,s)}}]),e}(),fr=function(){function e(n,r){d(this,e),this.min=n,this.max=r,this.center=t.scale$1([],t.add([],this.min,this.max),.5)}return p(e,[{key:"quadrant",value:function(n){for(var r=[n%2==0,n<2],i=t.clone$2(this.min),o=t.clone$2(this.max),a=0;a<r.length;a++)i[a]=r[a]?this.min[a]:this.center[a],o[a]=r[a]?this.center[a]:this.max[a];return o[2]=this.max[2],new e(i,o)}},{key:"distanceX",value:function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}},{key:"distanceY",value:function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}},{key:"intersects",value:function(e){for(var n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],r=!0,i=0;i<e.planes.length;i++){for(var o=e.planes[i],a=0,s=0;s<n.length;s++)t.dot$1(o,n[s])>=0&&a++;if(0===a)return 0;a!==n.length&&(r=!1)}if(r)return 2;for(var l=0;l<3;l++){for(var u=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.points.length;h++){var f=e.points[h][l]-this.min[l];u=Math.min(u,f),c=Math.max(c,f)}if(c<0||u>this.max[l]-this.min[l])return 0}return 1}}]),e}(),pr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(d(this,e),isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=n,this.left=r,this.right=i}return p(e,[{key:"interpolate",value:function(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this}},{key:"getCenter",value:function(e,n){var r=t.clamp((this.left+e-this.right)/2,0,e),i=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.pointGeometry(r,i)}},{key:"equals",value:function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}},{key:"clone",value:function(){return new e(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),e}(),dr=function(){function e(n,r,i,o,a){d(this,e),this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===a||!!a,this._minZoom=n||0,this._maxZoom=r||22,this._minPitch=null==i?0:i,this._maxPitch=null==o?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pr,this._posMatrixCache={},this._alignedPosMatrixCache={}}return p(e,[{key:"clone",value:function(){var t=new e(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t._elevation=this._elevation,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t}},{key:"minZoom",get:function(){return this._minZoom},set:function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}},{key:"minPitch",get:function(){return this._minPitch},set:function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new t.pointGeometry(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(e){var n,r=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=(n=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);t[0]=r*l+o*s,t[1]=i*l+a*s,t[2]=r*-s+o*l,t[3]=i*-s+a*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())}},{key:"center",get:function(){return this._center},set:function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}},{key:"elevation",get:function(){return this._elevation},set:function(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}},{key:"padding",get:function(){return this._edgeInsets.toJSON()},set:function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}},{key:"centerPoint",get:function(){return this._edgeInsets.getCenter(this.width,this.height)}},{key:"isPaddingEqual",value:function(t){return this._edgeInsets.equals(t)}},{key:"interpolatePadding",value:function(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}},{key:"coveringZoomLevel",value:function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}},{key:"getVisibleUnwrappedCoordinates",value:function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.pointGeometry(0,0)),i=this.pointCoordinate(new t.pointGeometry(this.width,0)),o=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),a=this.pointCoordinate(new t.pointGeometry(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),l=Math.floor(Math.max(r.x,i.x,o.x,a.x)),u=1,c=s-u;c<=l+u;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n}},{key:"coveringTiles",value:function(e){var n,r,i=this.coveringZoomLevel(e),o=i;if(void 0!==e.minzoom&&i<e.minzoom)return[];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);var a=this.pointCoordinate(this.getCameraPoint()),s=t.MercatorCoordinate.fromLngLat(this.center),l=Math.pow(2,i),u=[l*a.x,l*a.y,0],c=[l*s.x,l*s.y,0],h=hr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),f=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(f=i);var p=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,d=function(t){return{aabb:new fr([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},m=[],g=[],v=i,y=e.reparseOverscaled?o:i;if(this._renderWorldCopies)for(var _=1;_<=3;_++)m.push(d(-_)),m.push(d(_));for(m.push(d(0));m.length>0;){var x=m.pop(),b=x.x,w=x.y,S=x.fullyVisible;if(!S){var E=x.aabb.intersects(h);if(0===E)continue;S=2===E}var k=e.terrain?u:c,C=x.aabb.distanceX(k),I=x.aabb.distanceY(k),T=Math.max(Math.abs(C),Math.abs(I)),P=p+(1<<v-x.zoom)-2;if(x.zoom===v||T>P&&x.zoom>=f){var A=v-x.zoom,M=u[0]-.5-(b<<A),L=u[1]-.5-(w<<A);g.push({tileID:new t.OverscaledTileID(x.zoom===v?y:x.zoom,x.wrap,x.zoom,b,w),distanceSq:t.sqrLen([c[0]-.5-b,c[1]-.5-w]),tileDistanceToCamera:Math.sqrt(M*M+L*L)})}else for(var R=0;R<4;R++){var D=(b<<1)+R%2,N=(w<<1)+(R>>1),z=x.zoom+1,O=x.aabb.quadrant(R);if(e.terrain){var F=new t.OverscaledTileID(z,x.wrap,z,D,N),B=e.terrain.getMinMaxElevation(F),j=null!==(n=B.minElevation)&&void 0!==n?n:this.elevation,U=null!==(r=B.maxElevation)&&void 0!==r?r:this.elevation;O=new fr([O.min[0],O.min[1],j],[O.max[0],O.max[1],U])}m.push({aabb:O,zoom:z,x:D,y:N,wrap:x.wrap,fullyVisible:S})}}return g.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))}},{key:"resize",value:function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}},{key:"unmodified",get:function(){return this._unmodified}},{key:"zoomScale",value:function(t){return Math.pow(2,t)}},{key:"scaleZoom",value:function(t){return Math.log(t)/Math.LN2}},{key:"project",value:function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)}},{key:"unproject",value:function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}},{key:"point",get:function(){return this.project(this.center)}},{key:"updateElevation",value:function(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}},{key:"getElevation",value:function(e,n){var r=t.MercatorCoordinate.fromLngLat(e),i=(1<<this.tileZoom)*t.EXTENT,o=r.x*i,a=r.y*i,s=Math.floor(o/t.EXTENT),l=Math.floor(a/t.EXTENT),u=new t.OverscaledTileID(this.tileZoom,0,this.tileZoom,s,l);return n.getElevation(u,o%t.EXTENT,a%t.EXTENT,t.EXTENT)}},{key:"getCameraPosition",value:function(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}},{key:"recalculateZoom",value:function(e){var n=this.pointLocation(this.centerPoint,e),r=this.getElevation(n,e);if(this.elevation-r){var i=this.getCameraPosition(),o=t.MercatorCoordinate.fromLngLat(i.lngLat,i.altitude),a=t.MercatorCoordinate.fromLngLat(n,r),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.sqrt(s*s+l*l+u*u),h=this.scaleZoom(this.cameraToCenterDistance/c/this.tileSize);this._elevation=r,this._center=n,this.zoom=h}}},{key:"setLocationAtPoint",value:function(e,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"locationPoint",value:function(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,e),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}},{key:"pointLocation",value:function(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}},{key:"locationCoordinate",value:function(e){return t.MercatorCoordinate.fromLngLat(e)}},{key:"coordinateLocation",value:function(t){return t&&t.toLngLat()}},{key:"pointCoordinate",value:function(e,n){if(n){var r=n.pointCoordinate(e);if(null!=r)return r}var i=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(o,o,this.pixelMatrixInverse);var a=i[3],s=o[3],l=i[1]/a,u=o[1]/s,c=i[2]/a,h=o[2]/s,f=c===h?0:(0-c)/(h-c);return new t.MercatorCoordinate(t.number(i[0]/a,o[0]/s,f)/this.worldSize,t.number(l,u,f)/this.worldSize)}},{key:"coordinatePoint",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pixelMatrix,i=[e.x*this.worldSize,e.y*this.worldSize,n,1];return t.transformMat4(i,i,r),new t.pointGeometry(i[0]/i[3],i[1]/i[3])}},{key:"getBounds",value:function(){var e=Math.max(0,this.height/2-this.getHorizon());return(new t.LngLatBounds).extend(this.pointLocation(new t.pointGeometry(0,e))).extend(this.pointLocation(new t.pointGeometry(this.width,e))).extend(this.pointLocation(new t.pointGeometry(this.width,this.height))).extend(this.pointLocation(new t.pointGeometry(0,this.height)))}},{key:"getMaxBounds",value:function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}},{key:"getHorizon",value:function(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}},{key:"setMaxBounds",value:function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"calculatePosMatrix",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),i[r]=new Float32Array(l),i[r]}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"_constrain",value:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=t.mercatorYfromLat(h[1])*this.worldSize,e=(a=t.mercatorYfromLat(h[0])*this.worldSize)-o<u.y?u.y/(a-o):0}if(this.lngRange){var f=this.lngRange;s=t.wrap(t.mercatorXfromLng(f[0])*this.worldSize,0,this.worldSize),(l=t.wrap(t.mercatorXfromLng(f[1])*this.worldSize,0,this.worldSize))<s&&(l+=this.worldSize),n=l-s<u.x?u.x/(l-s):0}var p=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.pointGeometry(n?(l+s)/2:p.x,e?(a+o)/2:p.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var m=p.y,g=u.y/2;m-g<o&&(i=o+g),m+g>a&&(i=a-g)}if(this.lngRange){var v=(s+l)/2,y=t.wrap(p.x,v-this.worldSize/2,v+this.worldSize/2),_=u.x/2;y-_<s&&(r=s+_),y+_>l&&(r=l-_)}void 0===r&&void 0===i||(this.center=this.unproject(new t.pointGeometry(void 0!==r?r:p.x,void 0!==i?i:p.y)).wrap()),this._unmodified=c,this._constraining=!1}}},{key:"_calcMatrices",value:function(){if(this.height){var e=this.centerOffset,n=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;var i=t.identity(new Float64Array(16));t.scale(i,i,[this.width/2,-this.height/2,1]),t.translate(i,i,[1,-1,0]),this.labelPlaneMatrix=i,i=t.identity(new Float64Array(16)),t.scale(i,i,[1,-1,1]),t.translate(i,i,[-1,-1,0]),t.scale(i,i,[2/this.width,2/this.height,1]),this.glCoordMatrix=i,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);var o=Math.PI/2+this._pitch,a=this._fov*(.5+e.y/this.height),s=Math.sin(a)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-o-a,.01,Math.PI-.01)),l=this.getHorizon(),u=2*Math.atan(l/this.cameraToCenterDistance)*(.5+e.y/(2*l)),c=Math.sin(u)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-o-u,.01,Math.PI-.01)),h=Math.cos(Math.PI/2-this._pitch)*s+this.cameraToSeaLevelDistance,f=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToSeaLevelDistance,p=1.01*Math.min(h,f),d=this.height/50;i=new Float64Array(16),t.perspective(i,this._fov,this.width/this.height,d,p),i[8]=2*-e.x/this.width,i[9]=2*e.y/this.height,t.scale(i,i,[1,-1,1]),t.translate(i,i,[0,0,-this.cameraToCenterDistance]),t.rotateX(i,i,this._pitch),t.rotateZ(i,i,this.angle),t.translate(i,i,[-n,-r,0]),this.mercatorMatrix=t.scale([],i,[this.worldSize,this.worldSize,this.worldSize]),t.scale(i,i,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,i),t.translate(i,i,[0,0,-this.elevation]),this.projMatrix=i,this.invProjMatrix=t.invert([],i),this.pixelMatrix3D=t.multiply(new Float64Array(16),this.labelPlaneMatrix,i);var m=this.width%2/2,g=this.height%2/2,v=Math.cos(this.angle),y=Math.sin(this.angle),_=n-Math.round(n)+v*m+y*g,x=r-Math.round(r)+v*g+y*m,b=new Float64Array(i);if(t.translate(b,b,[_>.5?_-1:_,x>.5?x-1:x,0]),this.alignedProjMatrix=b,!(i=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={}}}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.pointGeometry(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}},{key:"getCameraQueryGeometry",value:function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];var r,i=n.x,o=n.y,a=n.x,s=n.y,l=f(e);try{for(l.s();!(r=l.n()).done;){var u=r.value;i=Math.min(i,u.x),o=Math.min(o,u.y),a=Math.max(a,u.x),s=Math.max(s,u.y)}}catch(c){l.e(c)}finally{l.f()}return[new t.pointGeometry(i,o),new t.pointGeometry(a,o),new t.pointGeometry(a,s),new t.pointGeometry(i,s),new t.pointGeometry(i,o)]}}]),e}(),mr=function(){function e(n){d(this,e),this._hashName=n&&encodeURIComponent(n),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){var n=!1,r=null,i=function e(){r=null,n&&(t(),r=setTimeout(e,300),n=!1)};return function(){return n=!0,r||i(),r}}(this._updateHashUnthrottled.bind(this))}return p(e,[{key:"addTo",value:function(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}},{key:"remove",value:function(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}},{key:"getHashString",value:function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch(),u="";if(u+=t?"/".concat(o,"/").concat(a,"/").concat(n):"".concat(n,"/").concat(a,"/").concat(o),(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/".concat(Math.round(l))),this._hashName){var c=this._hashName,h=!1,f=window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===c?(h=!0,"".concat(e,"=").concat(u)):t})).filter((function(t){return t}));return h||f.push("".concat(c,"=").concat(u)),"#".concat(f.join("&"))}return"#".concat(u)}},{key:"_getCurrentHash",value:function(){var t,e=this,n=window.location.hash.replace("#","");return this._hashName?(n.split("&").map((function(t){return t.split("=")})).forEach((function(n){n[0]===e._hashName&&(t=n)})),(t&&t[1]||"").split("/")):n.split("/")}},{key:"_onHashChange",value:function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}},{key:"_updateHashUnthrottled",value:function(){var t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}}}]),e}(),gr={linearity:.3,easing:t.bezier(0,0,.3,1)},vr=t.extend({deceleration:2500,maxSpeed:1400},gr),yr=t.extend({deceleration:20,maxSpeed:1400},gr),_r=t.extend({deceleration:1e3,maxSpeed:360},gr),xr=t.extend({deceleration:1e3,maxSpeed:90},gr),br=function(){function e(t){d(this,e),this._map=t,this.clear()}return p(e,[{key:"clear",value:function(){this._inertiaBuffer=[]}},{key:"record",value:function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}},{key:"_drainInertiaBuffer",value:function(){for(var e=this._inertiaBuffer,n=t.exported.now();e.length>0&&n-e[0].time>160;)e.shift()}},{key:"_onMoveEnd",value:function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){var n,r={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0},i=f(this._inertiaBuffer);try{for(i.s();!(n=i.n()).done;){var o=n.value.settings;r.zoom+=o.zoomDelta||0,r.bearing+=o.bearingDelta||0,r.pitch+=o.pitchDelta||0,o.panDelta&&r.pan._add(o.panDelta),o.around&&(r.around=o.around),o.pinchAround&&(r.pinchAround=o.pinchAround)}}catch(d){i.e(d)}finally{i.f()}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(r.pan.mag()){var l=Sr(r.pan.mag(),a,t.extend({},vr,e||{}));s.offset=r.pan.mult(l.amount/r.pan.mag()),s.center=this._map.transform.center,wr(s,l)}if(r.zoom){var u=Sr(r.zoom,a,yr);s.zoom=this._map.transform.zoom+u.amount,wr(s,u)}if(r.bearing){var c=Sr(r.bearing,a,_r);s.bearing=this._map.transform.bearing+t.clamp(c.amount,-179,179),wr(s,c)}if(r.pitch){var h=Sr(r.pitch,a,xr);s.pitch=this._map.transform.pitch+h.amount,wr(s,h)}if(s.zoom||s.bearing){var p=void 0===r.pinchAround?r.around:r.pinchAround;s.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),t.extend(s,{noMoveStart:!0})}}}]),e}();function wr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Sr(e,n,r){var i=r.maxSpeed,o=r.linearity,a=r.deceleration,s=t.clamp(e*o/(n/1e3),-i,i),l=Math.abs(s)/(a*o);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}var Er=function(e){m(r,e);var n=g(r);function r(e,i,o){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};d(this,r);var l=c.mousePos(i.getCanvasContainer(),o),u=i.unproject(l);return(a=n.call(this,e,t.extend({point:l,lngLat:u,originalEvent:o},s)))._defaultPrevented=!1,a.target=i,a}return p(r,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),r}(t.Event),kr=function(e){m(r,e);var n=g(r);function r(e,i,o){var a;d(this,r);var s="touchend"===e?o.changedTouches:o.touches,l=c.touchPos(i.getCanvasContainer(),s),u=l.map((function(t){return i.unproject(t)})),h=l.reduce((function(t,e,n,r){return t.add(e.div(r.length))}),new t.pointGeometry(0,0));return(a=n.call(this,e,{points:l,point:h,lngLats:u,lngLat:i.unproject(h),originalEvent:o}))._defaultPrevented=!1,a}return p(r,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),r}(t.Event),Cr=function(t){m(n,t);var e=g(n);function n(t,r,i){var o;return d(this,n),(o=e.call(this,t,{originalEvent:i}))._defaultPrevented=!1,o}return p(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(t.Event),Ir=function(){function t(e,n){d(this,t),this._map=e,this._clickTolerance=n.clickTolerance}return p(t,[{key:"reset",value:function(){delete this._mousedownPos}},{key:"wheel",value:function(t){return this._firePreventable(new Cr(t.type,this._map,t))}},{key:"mousedown",value:function(t,e){return this._mousedownPos=e,this._firePreventable(new Er(t.type,this._map,t))}},{key:"mouseup",value:function(t){this._map.fire(new Er(t.type,this._map,t))}},{key:"click",value:function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Er(t.type,this._map,t))}},{key:"dblclick",value:function(t){return this._firePreventable(new Er(t.type,this._map,t))}},{key:"mouseover",value:function(t){this._map.fire(new Er(t.type,this._map,t))}},{key:"mouseout",value:function(t){this._map.fire(new Er(t.type,this._map,t))}},{key:"touchstart",value:function(t){return this._firePreventable(new kr(t.type,this._map,t))}},{key:"touchmove",value:function(t){this._map.fire(new kr(t.type,this._map,t))}},{key:"touchend",value:function(t){this._map.fire(new kr(t.type,this._map,t))}},{key:"touchcancel",value:function(t){this._map.fire(new kr(t.type,this._map,t))}},{key:"_firePreventable",value:function(t){if(this._map.fire(t),t.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),t}(),Tr=function(){function t(e){d(this,t),this._map=e}return p(t,[{key:"reset",value:function(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}},{key:"mousemove",value:function(t){this._map.fire(new Er(t.type,this._map,t))}},{key:"mousedown",value:function(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}},{key:"mouseup",value:function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Er("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}},{key:"contextmenu",value:function(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Er(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),t}(),Pr=function(){function e(t,n){d(this,e),this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=n.clickTolerance||1}return p(e,[{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active}},{key:"enable",value:function(){this.isEnabled()||(this._enabled=!0)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"mousedown",value:function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(c.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}},{key:"mousemoveWindow",value:function(t,e){if(this._active){var n=e;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=n,this._box||(this._box=c.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(r.x,n.x),o=Math.max(r.x,n.x),a=Math.min(r.y,n.y),s=Math.max(r.y,n.y);c.setTransform(this._box,"translate(".concat(i,"px,").concat(a,"px)")),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}}}},{key:"mouseupWindow",value:function(e,n){var r=this;if(this._active&&0===e.button){var i=this._startPos,o=n;if(this.reset(),c.suppressClick(),i.x!==o.x||i.y!==o.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(i,o,r._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}}},{key:"keydown",value:function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}},{key:"reset",value:function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(c.remove(this._box),this._box=null),c.enableDrag(),delete this._startPos,delete this._lastPos}},{key:"_fireEvent",value:function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}]),e}();function Ar(t,e){if(t.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(t.length,", points ").concat(e.length));for(var n={},r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}var Mr=function(){function e(t){d(this,e),this.reset(),this.numTouches=t.numTouches}return p(e,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){var n,r=new t.pointGeometry(0,0),i=f(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r._add(o)}}catch(a){i.e(a)}finally{i.f()}return r.div(e.length)}(n),this.touches=Ar(r,n)))}},{key:"touchmove",value:function(t,e,n){if(!this.aborted&&this.centroid){var r=Ar(n,e);for(var i in this.touches){var o=this.touches[i],a=r[i];(!a||a.dist(o)>30)&&(this.aborted=!0)}}}},{key:"touchend",value:function(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var r=!this.aborted&&this.centroid;if(this.reset(),r)return r}}}]),e}(),Lr=function(){function t(e){d(this,t),this.singleTap=new Mr(e),this.numTaps=e.numTaps,this.reset()}return p(t,[{key:"reset",value:function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(t,e,n){this.singleTap.touchstart(t,e,n)}},{key:"touchmove",value:function(t,e,n){this.singleTap.touchmove(t,e,n)}},{key:"touchend",value:function(t,e,n){var r=this.singleTap.touchend(t,e,n);if(r){var i=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(r)<30;if(i&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}]),t}(),Rr=function(){function t(){d(this,t),this._zoomIn=new Lr({numTouches:1,numTaps:2}),this._zoomOut=new Lr({numTouches:2,numTaps:1}),this.reset()}return p(t,[{key:"reset",value:function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}},{key:"touchstart",value:function(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}},{key:"touchmove",value:function(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}},{key:"touchend",value:function(t,e,n){var r=this,i=this._zoomIn.touchend(t,e,n),o=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}}):o?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}):void 0}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}(),Dr={0:1,2:2},Nr=function(){function t(e){d(this,t),this.reset(),this._clickTolerance=e.clickTolerance||1}return p(t,[{key:"reset",value:function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}},{key:"_correctButton",value:function(t,e){return!1}},{key:"_move",value:function(t,e){return{}}},{key:"mousedown",value:function(t,e){if(!this._lastPoint){var n=c.mouseButton(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}}},{key:"mousemoveWindow",value:function(t,e){var n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){var n=Dr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}},{key:"mouseupWindow",value:function(t){this._lastPoint&&c.mouseButton(t)===this._eventButton&&(this._moved&&c.suppressClick(),this.reset())}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}(),zr=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"mousedown",value:function(t,e){a(s(n.prototype),"mousedown",this).call(this,t,e),this._lastPoint&&(this._active=!0)}},{key:"_correctButton",value:function(t,e){return 0===e&&!t.ctrlKey}},{key:"_move",value:function(t,e){return{around:e,panDelta:e.sub(t)}}}]),n}(Nr),Or=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_correctButton",value:function(t,e){return 0===e&&t.ctrlKey||2===e}},{key:"_move",value:function(t,e){var n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}},{key:"contextmenu",value:function(t){t.preventDefault()}}]),n}(Nr),Fr=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"_correctButton",value:function(t,e){return 0===e&&t.ctrlKey||2===e}},{key:"_move",value:function(t,e){var n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}},{key:"contextmenu",value:function(t){t.preventDefault()}}]),n}(Nr),Br=function(){function e(t,n){d(this,e),this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=n,this.reset()}return p(e,[{key:"reset",value:function(){var e=this;this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0),setTimeout((function(){e._cancelCooperativeMessage=!1}),200)}},{key:"touchstart",value:function(t,e,n){return this._calculateTransform(t,e,n)}},{key:"touchmove",value:function(t,e,n){if(this._map._cooperativeGestures&&(2===this._minTouches&&n.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,n.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)}},{key:"touchend",value:function(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"_calculateTransform",value:function(e,n,r){r.length>0&&(this._active=!0);var i=Ar(r,n),o=new t.pointGeometry(0,0),a=new t.pointGeometry(0,0),s=0;for(var l in i){var u=i[l],c=this._touches[l];c&&(o._add(u),a._add(u.sub(c)),s++,i[l]=u)}if(this._touches=i,!(s<this._minTouches)&&a.mag()){var h=a.div(s);return this._sum._add(h),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:h}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),jr=function(){function t(){d(this,t),this.reset()}return p(t,[{key:"reset",value:function(){this._active=!1,delete this._firstTwoTouches}},{key:"_start",value:function(t){}},{key:"_move",value:function(t,e,n){return{}}},{key:"touchstart",value:function(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}},{key:"touchmove",value:function(t,e,n){if(this._firstTwoTouches){t.preventDefault();var r=h(this._firstTwoTouches,2),i=r[0],o=r[1],a=Ur(n,e,i),s=Ur(n,e,o);if(a&&s){var l=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],l,t)}}}},{key:"touchend",value:function(t,e,n){if(this._firstTwoTouches){var r=h(this._firstTwoTouches,2),i=r[0],o=r[1],a=Ur(n,e,i),s=Ur(n,e,o);a&&s||(this._active&&c.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}();function Ur(t,e,n){for(var r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Vr(t,e){return Math.log(t/e)/Math.LN2}var Zr=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"reset",value:function(){a(s(n.prototype),"reset",this).call(this),delete this._distance,delete this._startDistance}},{key:"_start",value:function(t){this._startDistance=this._distance=t[0].dist(t[1])}},{key:"_move",value:function(t,e){var n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Vr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Vr(this._distance,n),pinchAround:e}}}]),n}(jr);function qr(t,e){return 180*t.angleWith(e)/Math.PI}var Gr=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"reset",value:function(){a(s(n.prototype),"reset",this).call(this),delete this._minDiameter,delete this._startVector,delete this._vector}},{key:"_start",value:function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}},{key:"_move",value:function(t,e){var n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qr(this._vector,n),pinchAround:e}}},{key:"_isBelowThreshold",value:function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,n=qr(t,this._startVector);return Math.abs(n)<e}}]),n}(jr);function Wr(t){return Math.abs(t.y)>Math.abs(t.x)}var Xr=function(t){m(n,t);var e=g(n);function n(t){var r;return d(this,n),(r=e.call(this))._map=t,r}return p(n,[{key:"reset",value:function(){a(s(n.prototype),"reset",this).call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints}},{key:"touchstart",value:function(t,e,r){a(s(n.prototype),"touchstart",this).call(this,t,e,r),this._currentTouchCount=r.length}},{key:"_start",value:function(t){this._lastPoints=t,Wr(t[0].sub(t[1]))&&(this._valid=!1)}},{key:"_move",value:function(t,e,n){if(!(this._map._cooperativeGestures&&this._currentTouchCount<3)){var r=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}):void 0}}},{key:"gestureBeginsVertically",value:function(t,e,n){if(void 0!==this._valid)return this._valid;var r=t.mag()>=2,i=e.mag()>=2;if(r||i){if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var o=t.y>0==e.y>0;return Wr(t)&&Wr(e)&&o}}}]),n}(jr),Hr={panStep:100,bearingStep:15,pitchStep:10},Yr=function(){function t(){d(this,t);var e=Hr;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}return p(t,[{key:"reset",value:function(){this._active=!1}},{key:"keydown",value:function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=0,r=0,i=0,o=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(r=0,i=0),{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:$r,zoom:n?Math.round(l)+n*(t.shiftKey?2:1):l,bearing:s.getBearing()+r*e._bearingStep,pitch:s.getPitch()+i*e._pitchStep,offset:[-o*e._panStep,-a*e._panStep],center:s.getCenter()},{originalEvent:t})}}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}},{key:"disableRotation",value:function(){this._rotationDisabled=!0}},{key:"enableRotation",value:function(){this._rotationDisabled=!1}}]),t}();function $r(t){return t*(2-t)}var Kr=4.000244140625,Jr=function(){function e(n,r){d(this,e),this._map=n,this._el=n.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}return p(e,[{key:"setZoomRate",value:function(t){this._defaultZoomRate=t}},{key:"setWheelZoomRate",value:function(t){this._wheelZoomRate=t}},{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active||void 0!==this._finishTimeout}},{key:"isZooming",value:function(){return!!this._zooming}},{key:"enable",value:function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"wheel",value:function(e){if(this.isEnabled()){if(this._map._cooperativeGestures){if(!this._map._metaPress)return;e.preventDefault()}var n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.exported.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%Kr==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}}},{key:"_onTimeout",value:function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}},{key:"_start",value:function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var n=c.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}}},{key:"renderFrame",value:function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>Kr?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:n.zoom,l=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&l&&u){var h=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),f=u(h);a=t.number(l,s,f),h<1?this._frameId||(this._frameId=!0):c=!0}else a=s,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:a-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}}},{key:"_smoothOutEasing",value:function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.exported.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}},{key:"reset",value:function(){this._active=!1}}]),e}(),Qr=function(){function t(e,n){d(this,t),this._clickZoom=e,this._tapZoom=n}return p(t,[{key:"enable",value:function(){this._clickZoom.enable(),this._tapZoom.enable()}},{key:"disable",value:function(){this._clickZoom.disable(),this._tapZoom.disable()}},{key:"isEnabled",value:function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}},{key:"isActive",value:function(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}]),t}(),ti=function(){function t(){d(this,t),this.reset()}return p(t,[{key:"reset",value:function(){this._active=!1}},{key:"dblclick",value:function(t,e){return t.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}(),ei=function(){function t(){d(this,t),this._tap=new Lr({numTouches:1,numTaps:1}),this.reset()}return p(t,[{key:"reset",value:function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}},{key:"touchstart",value:function(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}},{key:"touchmove",value:function(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var r=e[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(t,e,n)}},{key:"touchend",value:function(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}(),ni=function(){function t(e,n,r){d(this,t),this._el=e,this._mousePan=n,this._touchPan=r}return p(t,[{key:"enable",value:function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}},{key:"disable",value:function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}},{key:"isEnabled",value:function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}},{key:"isActive",value:function(){return this._mousePan.isActive()||this._touchPan.isActive()}}]),t}(),ri=function(){function t(e,n,r){d(this,t),this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=n,this._mousePitch=r}return p(t,[{key:"enable",value:function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}},{key:"disable",value:function(){this._mouseRotate.disable(),this._mousePitch.disable()}},{key:"isEnabled",value:function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}},{key:"isActive",value:function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}]),t}(),ii=function(){function t(e,n,r,i){d(this,t),this._el=e,this._touchZoom=n,this._touchRotate=r,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}return p(t,[{key:"enable",value:function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}},{key:"disable",value:function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this._rotationDisabled=!0,this._touchRotate.disable()}},{key:"enableRotation",value:function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}]),t}(),oi=function(t){return t.zoom||t.drag||t.pitch||t.rotate},ai=function(t){m(n,t);var e=g(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n)}(t.Event);function si(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var li=function(){function e(n,r){d(this,e),this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new br(n),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r),t.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];var o,a=f(this._listeners);try{for(a.s();!(o=a.n()).done;){var s=h(o.value,3),l=s[0],u=s[1],p=s[2];c.addEventListener(l,u,l===document?this.handleWindowEvent:this.handleEvent,p)}}catch(m){a.e(m)}finally{a.f()}}return p(e,[{key:"destroy",value:function(){var t,e=f(this._listeners);try{for(e.s();!(t=e.n()).done;){var n=h(t.value,3),r=n[0],i=n[1],o=n[2];c.removeEventListener(r,i,r===document?this.handleWindowEvent:this.handleEvent,o)}}catch(a){e.e(a)}finally{e.f()}}},{key:"_addDefaultHandlers",value:function(t){var e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Ir(e,t));var r=e.boxZoom=new Pr(e,t);this._add("boxZoom",r);var i=new Rr,o=new ti;e.doubleClickZoom=new Qr(o,i),this._add("tapZoom",i),this._add("clickZoom",o);var a=new ei;this._add("tapDragZoom",a);var s=e.touchPitch=new Xr(e);this._add("touchPitch",s);var l=new Or(t),u=new Fr(t);e.dragRotate=new ri(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new zr(t),h=new Br(t,e);e.dragPan=new ni(n,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);var f=new Gr,p=new Zr;e.touchZoomRotate=new ii(n,p,f,a),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var d=e.scrollZoom=new Jr(e,this);this._add("scrollZoom",d,["mousePan"]);var m=e.keyboard=new Yr;this._add("keyboard",m),this._add("blockableMapEvent",new Tr(e));for(var g=0,v=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<v.length;g++){var y=v[g];t.interactive&&t[y]&&e[y].enable(t[y])}}},{key:"_add",value:function(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}},{key:"stop",value:function(t){if(!this._updatingCamera){var e,n=f(this._handlers);try{for(n.s();!(e=n.n()).done;)e.value.handler.reset()}catch(r){n.e(r)}finally{n.f()}this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}},{key:"isActive",value:function(){var t,e=f(this._handlers);try{for(e.s();!(t=e.n()).done;)if(t.value.handler.isActive())return!0}catch(n){e.e(n)}finally{e.f()}return!1}},{key:"isZooming",value:function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this._eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(oi(this._eventsInProgress))||this.isZooming()}},{key:"_blockedByActive",value:function(t,e,n){for(var r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1}},{key:"handleWindowEvent",value:function(t){this.handleEvent(t,"".concat(t.type,"Window"))}},{key:"_getMapTouches",value:function(t){var e,n=[],r=f(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;this._el.contains(i.target)&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"handleEvent",value:function(t,e){if("blur"!==t.type){this._updatingCamera=!0;var n,r="renderFrame"===t.type?void 0:t,i={needsRenderFrame:!1},o={},a={},s=t.touches,l=s?this._getMapTouches(s):void 0,u=l?c.touchPos(this._el,l):c.mousePos(this._el,t),h=f(this._handlers);try{for(h.s();!(n=h.n()).done;){var p=n.value,d=p.handlerName,m=p.handler,g=p.allowed;if(m.isEnabled()){var v=void 0;this._blockedByActive(a,g,d)?m.reset():m[e||t.type]&&(v=m[e||t.type](t,u,l),this.mergeHandlerResult(i,o,v,d,r),v&&v.needsRenderFrame&&this._triggerRenderFrame()),(v||m.isActive())&&(a[d]=m)}}}catch(b){h.e(b)}finally{h.f()}var y={};for(var _ in this._previousActiveHandlers)a[_]||(y[_]=r);this._previousActiveHandlers=a,(Object.keys(y).length||si(i))&&(this._changes.push([i,o,y]),this._triggerRenderFrame()),(Object.keys(a).length||si(i))&&this._map._stop(!0),this._updatingCamera=!1;var x=i.cameraAnimation;x&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],x(this._map))}else this.stop(!0)}},{key:"mergeHandlerResult",value:function(e,n,r,i,o){if(r){t.extend(e,r);var a={handlerName:i,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(n.zoom=a),void 0!==r.panDelta&&(n.drag=a),void 0!==r.pitchDelta&&(n.pitch=a),void 0!==r.bearingDelta&&(n.rotate=a)}}},{key:"_applyChanges",value:function(){var e,n={},r={},i={},o=f(this._changes);try{for(o.s();!(e=o.n()).done;){var a=h(e.value,3),s=a[0],l=a[1],u=a[2];s.panDelta&&(n.panDelta=(n.panDelta||new t.pointGeometry(0,0))._add(s.panDelta)),s.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(n.around=s.around),void 0!==s.pinchAround&&(n.pinchAround=s.pinchAround),s.noInertia&&(n.noInertia=s.noInertia),t.extend(r,l),t.extend(i,u)}}catch(c){o.e(c)}finally{o.f()}this._updateMapTransform(n,r,i),this._changes=[]}},{key:"_updateMapTransform",value:function(e,n,r){var i=this._map,o=i.transform,a=i.style&&i.style.terrain;if(!(si(e)||a&&this._drag))return this._fireEvents(n,r,!0);var s=e.panDelta,l=e.zoomDelta,u=e.bearingDelta,c=e.pitchDelta,h=e.around,f=e.pinchAround;void 0!==f&&(h=f),i._stop(!0),h=h||i.transform.centerPoint;var p=o.pointLocation(s?h.sub(s):h);u&&(o.bearing+=u),c&&(o.pitch+=c),l&&(o.zoom+=l),a?n.drag&&!this._drag?(this._drag={center:o.centerPoint,lngLat:o.pointLocation(h),point:h,handlerName:n.drag.handlerName},i.fire(new t.Event("freezeElevation",{freeze:!0}))):this._drag&&r[this._drag.handlerName]?(i.fire(new t.Event("freezeElevation",{freeze:!1})),this._drag=null):n.drag&&this._drag&&(o.center=o.pointLocation(o.centerPoint.sub(s))):o.setLocationAtPoint(p,h),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,r,!0)}},{key:"_fireEvents",value:function(e,n,r){var i=this,o=oi(this._eventsInProgress),a=oi(e),s={};for(var l in e){var u=e[l].originalEvent;this._eventsInProgress[l]||(s["".concat(l,"start")]=u),this._eventsInProgress[l]=e[l]}for(var c in!o&&a&&this._fireEvent("movestart",a.originalEvent),s)this._fireEvent(c,s[c]);for(var h in a&&this._fireEvent("move",a.originalEvent),e){var f=e[h].originalEvent;this._fireEvent(h,f)}var p,d={};for(var m in this._eventsInProgress){var g=this._eventsInProgress[m],v=g.handlerName,y=g.originalEvent;this._handlersById[v].isActive()||(delete this._eventsInProgress[m],p=n[v]||y,d["".concat(m,"end")]=p)}for(var _ in d)this._fireEvent(_,d[_]);var x=oi(this._eventsInProgress);if(r&&(o||a)&&!x){this._updatingCamera=!0;var b=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),w=function(t){return 0!==t&&-i._bearingSnap<t&&t<i._bearingSnap};b?(w(b.bearing||this._map.getBearing())&&(b.bearing=0),this._map.easeTo(b,{originalEvent:p})):(this._map.fire(new t.Event("moveend",{originalEvent:p})),w(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}},{key:"_fireEvent",value:function(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}},{key:"_requestFrame",value:function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new ai("renderFrame",{timeStamp:e})),t._applyChanges()}))}},{key:"_triggerRenderFrame",value:function(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}]),e}(),ui={extend:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.extend.apply(t,[e].concat(r))},run:function(t){t()},logToElement:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"log",r=window.document.getElementById(n);r&&(e&&(r.innerHTML=""),r.innerHTML+="<br>".concat(t))}},ci=function(e){m(r,e);var n=g(r);function r(e,o){var a;return d(this,r),(a=n.call(this))._moving=!1,a._zooming=!1,a.transform=e,a._bearingSnap=o.bearingSnap,t.bindAll(["_renderFrameCallback"],i(a)),a}return p(r,[{key:"getCenter",value:function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}},{key:"setCenter",value:function(t,e){return this.jumpTo({center:t},e)}},{key:"panBy",value:function(e,n,r){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)}},{key:"panTo",value:function(e,n,r){return this.easeTo(t.extend({center:e},n),r)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"setZoom",value:function(t,e){return this.jumpTo({zoom:t},e),this}},{key:"zoomTo",value:function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)}},{key:"zoomIn",value:function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}},{key:"zoomOut",value:function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"setBearing",value:function(t,e){return this.jumpTo({bearing:t},e),this}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(t,e){return this.jumpTo({padding:t},e),this}},{key:"rotateTo",value:function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)}},{key:"resetNorth",value:function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}},{key:"resetNorthPitch",value:function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}},{key:"snapToNorth",value:function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setPitch",value:function(t,e){return this.jumpTo({pitch:t},e),this}},{key:"cameraForBounds",value:function(e,n){e=t.LngLatBounds.convert(e);var r=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,n)}},{key:"_cameraForBoxAndBearing",value:function(e,n,r,i){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var a=i.padding;i.padding={top:a,bottom:a,right:a,left:a}}i.padding=t.extend(o,i.padding);var s=this.transform,l=s.padding,u=s.project(t.LngLat.convert(e)),c=s.project(t.LngLat.convert(n)),h=u.rotate(-r*Math.PI/180),f=c.rotate(-r*Math.PI/180),p=new t.pointGeometry(Math.max(h.x,f.x),Math.max(h.y,f.y)),d=new t.pointGeometry(Math.min(h.x,f.x),Math.min(h.y,f.y)),m=p.sub(d),g=(s.width-(l.left+l.right+i.padding.left+i.padding.right))/m.x,v=(s.height-(l.top+l.bottom+i.padding.top+i.padding.bottom))/m.y;if(!(v<0||g<0)){var y=Math.min(s.scaleZoom(s.scale*Math.min(g,v)),i.maxZoom),_=t.pointGeometry.convert(i.offset),x=new t.pointGeometry((i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2).rotate(r*Math.PI/180),b=_.add(x).mult(s.scale/s.zoomScale(y));return{center:s.unproject(u.add(c).div(2).sub(b)),zoom:y,bearing:r}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}},{key:"fitBounds",value:function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}},{key:"fitScreenCoordinates",value:function(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(n)),r,i),i,o)}},{key:"_fitInternal",value:function(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}},{key:"jumpTo",value:function(e,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))}},{key:"calculateCameraOptionsFromTo",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.MercatorCoordinate.fromLngLat(e,n),a=t.MercatorCoordinate.fromLngLat(r,i),s=a.x-o.x,l=a.y-o.y,u=a.z-o.z,c=Math.hypot(s,l,u);if(0===c)throw new Error("Can't calculate camera options with same From and To");var h=Math.hypot(s,l),f=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI,d=180*Math.acos(h/c)/Math.PI;return d=u<0?90-d:90+d,{center:a.toLngLat(),zoom:f,pitch:d,bearing:p}}},{key:"easeTo",value:function(e,n){var r=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="zoom"in e?+e.zoom:o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,h="pitch"in e?+e.pitch:s,f="padding"in e?e.padding:i.padding,p=t.pointGeometry.convert(e.offset),d=i.centerPoint.add(p),m=i.pointLocation(d),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);var v,y,_=i.project(m),x=i.project(g).sub(_),b=i.zoomScale(u-o);e.around&&(v=t.LngLat.convert(e.around),y=i.locationPoint(v));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||u!==o,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||h!==s,this._padding=!i.isPaddingEqual(f),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,w),this._ease((function(e){if(r._zooming&&(i.zoom=t.number(o,u,e)),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,h,e)),r._padding&&(i.interpolatePadding(l,f,e),d=i.centerPoint.add(p)),v)i.setLocationAtPoint(v,y);else{var m=i.zoomScale(i.zoom-o),g=u>o?Math.min(2,b):Math.max(.5,b),w=Math.pow(g,1-e),S=i.unproject(_.add(x.mult(e*w)).mult(m));i.setLocationAtPoint(i.renderWorldCopies?S.wrap():S,d)}r._fireMoveEvents(n)}),(function(t){r._afterEase(n,t)}),e),this}},{key:"_prepareEase",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.fire(new t.Event("freezeElevation",{freeze:!0})),n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))}},{key:"_fireMoveEvents",value:function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}},{key:"_afterEase",value:function(e,n){if(!this._easeId||!n||this._easeId!==n){delete this._easeId,this.fire(new t.Event("freezeElevation",{freeze:!1}));var r=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}}},{key:"flyTo",value:function(e,n){var r=this;if(!e.essential&&t.exported.prefersReducedMotion){var i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,h="bearing"in e?this._normalizeBearing(e.bearing,s):s,f="pitch"in e?+e.pitch:l,p="padding"in e?e.padding:o.padding,d=o.zoomScale(c-a),m=t.pointGeometry.convert(e.offset),g=o.centerPoint.add(m),v=o.pointLocation(g),y=t.LngLat.convert(e.center||v);this._normalizeCenter(y);var _=o.project(v),x=o.project(y).sub(_),b=e.curve,w=Math.max(o.width,o.height),S=w/d,E=x.mag();if("minZoom"in e){var k=t.clamp(Math.min(e.minZoom,a,c),o.minZoom,o.maxZoom),C=w/o.zoomScale(k-a);b=Math.sqrt(C/E*2)}var I=b*b;function T(t){var e=(S*S-w*w+(t?-1:1)*I*I*E*E)/(2*(t?S:w)*I*E);return Math.log(Math.sqrt(e*e+1)-e)}function P(t){return(Math.exp(t)-Math.exp(-t))/2}function A(t){return(Math.exp(t)+Math.exp(-t))/2}var M=T(0),L=function(t){return A(M)/A(M+b*t)},R=function(t){return w*((A(M)*(P(e=M+b*t)/A(e))-P(M))/I)/E;var e},D=(T(1)-M)/b;if(Math.abs(E)<1e-6||!isFinite(D)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,n);var N=S<w?-1:1;D=Math.abs(Math.log(S/w))/b,R=function(){return 0},L=function(t){return Math.exp(N*b*t)}}return e.duration="duration"in e?+e.duration:1e3*D/("screenSpeed"in e?+e.screenSpeed/b:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==h,this._pitching=f!==l,this._padding=!o.isPaddingEqual(p),this._prepareEase(n,!1),this._ease((function(e){var i=e*D,d=1/L(i);o.zoom=1===e?c:a+o.scaleZoom(d),r._rotating&&(o.bearing=t.number(s,h,e)),r._pitching&&(o.pitch=t.number(l,f,e)),r._padding&&(o.interpolatePadding(u,p,e),g=o.centerPoint.add(m));var v=1===e?y:o.unproject(_.add(x.mult(R(i))).mult(d));o.setLocationAtPoint(o.renderWorldCopies?v.wrap():v,g),r._fireMoveEvents(n)}),(function(){return r._afterEase(n)}),e),this}},{key:"isEasing",value:function(){return!!this._easeFrameId}},{key:"stop",value:function(){return this._stop()}},{key:"_stop",value:function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,e)}if(!t){var r=this.handlers;r&&r.stop(!1)}return this}},{key:"_ease",value:function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}},{key:"_renderFrameCallback",value:function(){var e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}},{key:"_normalizeBearing",value:function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e}},{key:"_normalizeCenter",value:function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}}}]),r}(t.Evented),hi=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this.options=n,t.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}return p(e,[{key:"getDefaultPosition",value:function(){return"bottom-right"}},{key:"onAdd",value:function(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=c.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=c.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=c.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}},{key:"onRemove",value:function(){c.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}},{key:"_setElementTitle",value:function(t,e){var n=this._map._getUIString("AttributionControl.".concat(e));t.title=n,t.setAttribute("aria-label",n)}},{key:"_toggleAttribution",value:function(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}},{key:"_updateData",value:function(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()}},{key:"_updateAttributions",value:function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used||i.usedForTerrain){var o=i.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}(t=t.filter((function(t){return String(t).trim()}))).sort((function(t,e){return t.length-e.length})),t=t.filter((function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));var a=t.join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}}},{key:"_updateCompact",value:function(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}},{key:"_updateCompactMinimize",value:function(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}]),e}(),fi=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this.options=n,t.bindAll(["_updateCompact"],this)}return p(e,[{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"onAdd",value:function(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=c.create("div","maplibregl-ctrl mapboxgl-ctrl");var e=c.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}},{key:"onRemove",value:function(){c.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}},{key:"_updateCompact",value:function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact","mapboxgl-compact"):e.classList.remove("maplibregl-compact","mapboxgl-compact")}}}]),e}(),pi=function(){function t(){d(this,t),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return p(t,[{key:"add",value:function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}},{key:"remove",value:function(t){var e,n=this._currentlyRunning,r=n?this._queue.concat(n):this._queue,i=f(r);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o.id===t)return void(o.cancelled=!0)}}catch(a){i.e(a)}finally{i.f()}}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");var e=this._currentlyRunning=this._queue;this._queue=[];var n,r=f(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.cancelled&&(i.callback(t),this._cleared))break}}catch(o){r.e(o)}finally{r.f()}this._cleared=!1,this._currentlyRunning=!1}},{key:"clear",value:function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}]),t}(),di={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},mi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},gi={showCompass:!0,showZoom:!0,visualizePitch:!1},vi=function(){function e(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];d(this,e),this._clickTolerance=10,this.element=r,this.mouseRotate=new Or({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,i&&(this.mousePitch=new Fr({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener(r,"mousedown",this.mousedown),c.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),c.addEventListener(r,"touchmove",this.touchmove),c.addEventListener(r,"touchend",this.touchend),c.addEventListener(r,"touchcancel",this.reset)}return p(e,[{key:"down",value:function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),c.disableDrag()}},{key:"move",value:function(t,e){var n=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&n.setBearing(n.getBearing()+r.bearingDelta),this.mousePitch){var i=this.mousePitch.mousemoveWindow(t,e);i&&i.pitchDelta&&n.setPitch(n.getPitch()+i.pitchDelta)}}},{key:"off",value:function(){var t=this.element;c.removeEventListener(t,"mousedown",this.mousedown),c.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),c.removeEventListener(t,"touchmove",this.touchmove),c.removeEventListener(t,"touchend",this.touchend),c.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}},{key:"offTemp",value:function(){c.enableDrag(),c.removeEventListener(window,"mousemove",this.mousemove),c.removeEventListener(window,"mouseup",this.mouseup)}},{key:"mousedown",value:function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),c.mousePos(this.element,e)),c.addEventListener(window,"mousemove",this.mousemove),c.addEventListener(window,"mouseup",this.mouseup)}},{key:"mousemove",value:function(t){this.move(t,c.mousePos(this.element,t))}},{key:"mouseup",value:function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}},{key:"touchstart",value:function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=c.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))}},{key:"touchmove",value:function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=c.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))}},{key:"touchend",value:function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}},{key:"reset",value:function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}]),e}();function yi(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){var i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<a?e=i:r.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){var s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}var _i={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xi(t,e,n){var r=t.classList;for(var i in _i)r.remove("maplibregl-".concat(n,"-anchor-").concat(i),"mapboxgl-".concat(n,"-anchor-").concat(i));r.add("maplibregl-".concat(n,"-anchor-").concat(e),"mapboxgl-".concat(n,"-anchor-").concat(e))}var bi,wi=function(e){m(r,e);var n=g(r);function r(e,o){var a;if(d(this,r),a=n.call(this),(e instanceof HTMLElement||o)&&(e=t.extend({element:e},o)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],i(a)),a._anchor=e&&e.anchor||"center",a._color=e&&e.color||"#3FB1CE",a._scale=e&&e.scale||1,a._draggable=e&&e.draggable||!1,a._clickTolerance=e&&e.clickTolerance||0,a._isDragging=!1,a._state="inactive",a._rotation=e&&e.rotation||0,a._rotationAlignment=e&&e.rotationAlignment||"auto",a._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:a._rotationAlignment,e&&e.element)a._element=e.element,a._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{a._defaultMarker=!0,a._element=c.create("div"),a._element.setAttribute("aria-label","Map marker");var s=c.createNS("http://www.w3.org/2000/svg","svg"),u=41,h=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height","".concat(u,"px")),s.setAttributeNS(null,"width","".concat(h,"px")),s.setAttributeNS(null,"viewBox","0 0 ".concat(h," ").concat(u));var f=c.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");var p=c.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill-rule","nonzero");var m=c.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(3.0, 29.0)"),m.setAttributeNS(null,"fill","#000000");for(var g=0,v=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];g<v.length;g++){var y=v[g],_=c.createNS("http://www.w3.org/2000/svg","ellipse");_.setAttributeNS(null,"opacity","0.04"),_.setAttributeNS(null,"cx","10.5"),_.setAttributeNS(null,"cy","5.80029008"),_.setAttributeNS(null,"rx",y.rx),_.setAttributeNS(null,"ry",y.ry),m.appendChild(_)}var x=c.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill",a._color);var b=c.createNS("http://www.w3.org/2000/svg","path");b.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),x.appendChild(b);var w=c.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"opacity","0.25"),w.setAttributeNS(null,"fill","#000000");var S=c.createNS("http://www.w3.org/2000/svg","path");S.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),w.appendChild(S);var E=c.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(6.0, 7.0)"),E.setAttributeNS(null,"fill","#FFFFFF");var k=c.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(8.0, 8.0)");var C=c.createNS("http://www.w3.org/2000/svg","circle");C.setAttributeNS(null,"fill","#000000"),C.setAttributeNS(null,"opacity","0.25"),C.setAttributeNS(null,"cx","5.5"),C.setAttributeNS(null,"cy","5.5"),C.setAttributeNS(null,"r","5.4999962");var I=c.createNS("http://www.w3.org/2000/svg","circle");I.setAttributeNS(null,"fill","#FFFFFF"),I.setAttributeNS(null,"cx","5.5"),I.setAttributeNS(null,"cy","5.5"),I.setAttributeNS(null,"r","5.4999962"),k.appendChild(C),k.appendChild(I),p.appendChild(m),p.appendChild(x),p.appendChild(w),p.appendChild(E),p.appendChild(k),s.appendChild(p),s.setAttributeNS(null,"height",u*a._scale+"px"),s.setAttributeNS(null,"width",h*a._scale+"px"),a._element.appendChild(s),a._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}return a._element.classList.add("maplibregl-marker","mapboxgl-marker"),a._element.addEventListener("dragstart",(function(t){t.preventDefault()})),a._element.addEventListener("mousedown",(function(t){t.preventDefault()})),xi(a._element,a._anchor,"marker"),a._popup=null,l(a)}return p(r,[{key:"addTo",value:function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}},{key:"remove",value:function(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),c.remove(this._element),this._popup&&this._popup.remove(),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}},{key:"getElement",value:function(){return this._element}},{key:"setPopup",value:function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=38.1,n=13.5,r=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-n+r)],"bottom-right":[-r,-1*(e-n+r)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}},{key:"_onKeyPress",value:function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}},{key:"_onMapClick",value:function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}},{key:"getPopup",value:function(){return this._popup}},{key:"togglePopup",value:function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}},{key:"_update",value:function(t){var e=this;if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=yi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var n="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?n="rotateZ(".concat(this._rotation,"deg)"):"map"===this._rotationAlignment&&(n="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX(".concat(this._map.getPitch(),"deg)")),t&&"moveend"!==t.type||(this._pos=this._pos.round()),c.setTransform(this._element,"".concat(_i[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(r," ").concat(n)),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((function(){var t=e._map.unproject(e._pos),n=40075016.686*Math.abs(Math.cos(e._lngLat.lat*Math.PI/180))/Math.pow(2,e._map.transform.tileZoom+8);e._element.style.opacity=t.distanceTo(e._lngLat)>20*n?"0.2":"1.0",e._opacityTimeout=null}),100))}}},{key:"getOffset",value:function(){return this._offset}},{key:"setOffset",value:function(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}},{key:"_onMove",value:function(e){if(!this._isDragging){var n=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=n}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}},{key:"_onUp",value:function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}},{key:"_addDragHandler",value:function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}},{key:"setDraggable",value:function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}},{key:"isDraggable",value:function(){return this._draggable}},{key:"setRotation",value:function(t){return this._rotation=t||0,this._update(),this}},{key:"getRotation",value:function(){return this._rotation}},{key:"setRotationAlignment",value:function(t){return this._rotationAlignment=t||"auto",this._update(),this}},{key:"getRotationAlignment",value:function(){return this._rotationAlignment}},{key:"setPitchAlignment",value:function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}},{key:"getPitchAlignment",value:function(){return this._pitchAlignment}}]),r}(t.Evented),Si={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ei=0,ki=!1,Ci={maxWidth:100,unit:"metric"};function Ii(t,e,n){var r=n&&n.maxWidth||100,i=t._container.clientHeight/2,o=t.unproject([0,i]),a=t.unproject([r,i]),s=o.distanceTo(a);if(n&&"imperial"===n.unit){var l=3.2808*s;l>5280?Ti(e,r,l/5280,t._getUIString("ScaleControl.Miles")):Ti(e,r,l,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?Ti(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Ti(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):Ti(e,r,s,t._getUIString("ScaleControl.Meters"))}function Ti(t,e,n,r){var i=function(t){var e=Math.pow(10,"".concat(Math.floor(t)).length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n);t.style.width=e*(i/n)+"px",t.innerHTML="".concat(i,"&nbsp;").concat(r)}var Pi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ai=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mi(e){if(e){if("number"==typeof e){var n=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(n,n),"top-right":new t.pointGeometry(-n,n),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(n,-n),"bottom-right":new t.pointGeometry(-n,-n),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){var r=t.pointGeometry.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}return Mi(new t.pointGeometry(0,0))}var Li={supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:function(n){m(y,n);var u=g(y);function y(e){var n,r;if(d(this,y),t.PerformanceUtils.mark(t.PerformanceMarkers.create),null!=(e=t.extend({},mi,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if((n=u.call(this,new dr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}))._interactive=e.interactive,n._cooperativeGestures=e.cooperativeGestures,n._maxTileCacheSize=e.maxTileCacheSize,n._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,n._preserveDrawingBuffer=e.preserveDrawingBuffer,n._antialias=e.antialias,n._trackResize=e.trackResize,n._bearingSnap=e.bearingSnap,n._refreshExpiredTiles=e.refreshExpiredTiles,n._fadeDuration=e.fadeDuration,n._crossSourceCollisions=e.crossSourceCollisions,n._crossFadingFactor=1,n._collectResourceTiming=e.collectResourceTiming,n._renderTaskQueue=new pi,n._controls=[],n._mapId=t.uniqueId(),n._locale=t.extend({},di,e.locale),n._clickTolerance=e.clickTolerance,n._pixelRatio=null!==(r=e.pixelRatio)&&void 0!==r?r:devicePixelRatio,n._requestManager=new v(e.transformRequest),"string"==typeof e.container){if(n._container=document.getElementById(e.container),!n._container)throw new Error("Container '".concat(e.container,"' not found."))}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");n._container=e.container}if(e.maxBounds&&n.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],i(n)),n._setupContainer(),n._setupPainter(),void 0===n.painter)throw new Error("Failed to initialize WebGL.");return n.on("move",(function(){return n._update(!1)})),n.on("moveend",(function(){return n._update(!1)})),n.on("zoom",(function(){return n._update(!0)})),n.on("terrain",(function(){n.painter.terrainFacilitator.dirty=!0,n._update(!0)})),"undefined"!=typeof window&&(addEventListener("online",n._onWindowOnline,!1),addEventListener("resize",n._onWindowResize,!1),addEventListener("orientationchange",n._onWindowResize,!1)),n.handlers=new li(i(n),e),n._cooperativeGestures&&n._setupCooperativeGestures(),n._hash=e.hash&&new mr("string"==typeof e.hash&&e.hash||void 0).addTo(i(n)),n._hash&&n._hash._onHashChange()||(n.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(n.resize(),n.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),n.resize(),n._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&n.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&n.addControl(new hi({customAttribution:e.customAttribution})),e.maplibreLogo&&n.addControl(new fi,e.logoPosition),n.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),n.on("data",(function(e){n._update("style"===e.dataType),n.fire(new t.Event("".concat(e.dataType,"data"),e))})),n.on("dataloading",(function(e){n.fire(new t.Event("".concat(e.dataType,"dataloading"),e))})),n.on("dataabort",(function(e){n.fire(new t.Event("sourcedataabort",e))})),l(n)}return p(y,[{key:"_getMapId",value:function(){return this._mapId}},{key:"addControl",value:function(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this}},{key:"removeControl",value:function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}},{key:"hasControl",value:function(t){return this._controls.indexOf(t)>-1}},{key:"calculateCameraOptionsFromTo",value:function(t,e,n,r){return null==r&&this.style.terrain&&(r=this.transform.getElevation(n,this.style.terrain)),a(s(y.prototype),"calculateCameraOptionsFromTo",this).call(this,t,e,n,r)}},{key:"resize",value:function(e){var n=this._containerDimensions(),r=n[0],i=n[1];this._resizeCanvas(r,i,this.getPixelRatio()),this.transform.resize(r,i),this.painter.resize(r,i,this.getPixelRatio());var o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"setPixelRatio",value:function(t){var e=this._containerDimensions(),n=h(e,2),r=n[0],i=n[1];this._pixelRatio=t,this._resizeCanvas(r,i,t),this.painter.resize(r,i,t)}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}},{key:"setMinZoom",value:function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(t){return this.transform.renderWorldCopies=t,this._update()}},{key:"project",value:function(e){return this.transform.locationPoint(t.LngLat.convert(e),this.style&&this.style.terrain)}},{key:"unproject",value:function(e){return this.transform.pointLocation(t.pointGeometry.convert(e),this.style&&this.style.terrain)}},{key:"isMoving",value:function(){return this._moving||this.handlers.isMoving()}},{key:"isZooming",value:function(){return this._zooming||this.handlers.isZooming()}},{key:"isRotating",value:function(){return this._rotating||this.handlers.isRotating()}},{key:"_createDelegatedListener",value:function(t,e,n){var i=this;if("mouseenter"===t||"mouseover"===t){var o=!1,a=function(r){var a=i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[];a.length?o||(o=!0,n.call(i,new Er(t,i,r.originalEvent,{features:a}))):o=!1};return{layer:e,listener:n,delegates:{mousemove:a,mouseout:function(){o=!1}}}}if("mouseleave"===t||"mouseout"===t){var s=!1,l=function(r){(i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?s=!0:s&&(s=!1,n.call(i,new Er(t,i,r.originalEvent)))},u=function(e){s&&(s=!1,n.call(i,new Er(t,i,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:l,mouseout:u}}}var c=function(t){var r=i.getLayer(e)?i.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(i,t),delete t.features)};return{layer:e,listener:n,delegates:r({},t,c)}}},{key:"on",value:function(t,e,n){if(void 0===n)return a(s(y.prototype),"on",this).call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var i in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r),r.delegates)this.on(i,r.delegates[i]);return this}},{key:"once",value:function(t,e,n){if(void 0===n)return a(s(y.prototype),"once",this).call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var i in r.delegates)this.once(i,r.delegates[i]);return this}},{key:"off",value:function(t,e,n){var r=this;return void 0===n?a(s(y.prototype),"off",this).call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(i){for(var o=r._delegatedListeners[t],a=0;a<o.length;a++){var s=o[a];if(s.layer===e&&s.listener===n){for(var l in s.delegates)r.off(l,s.delegates[l]);return o.splice(a,1),r}}}(),this)}},{key:"queryRenderedFeatures",value:function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.pointGeometry||"number"==typeof e[0])r=[t.pointGeometry.convert(e)];else{var i=t.pointGeometry.convert(e[0]),o=t.pointGeometry.convert(e[1]);r=[i,new t.pointGeometry(o.x,i.y),o,new t.pointGeometry(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)}},{key:"querySourceFeatures",value:function(t,e){return this.style.querySourceFeatures(t,e)}},{key:"setStyle",value:function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))}},{key:"setTransformRequest",value:function(t){return this._requestManager.setTransformRequest(t),this}},{key:"_getUIString",value:function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '".concat(t,"'"));return e}},{key:"_updateStyle",value:function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new fe(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)}},{key:"_lazyInitEmptyStyle",value:function(){this.style||(this.style=new fe(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}},{key:"_diffStyle",value:function(e,n){var r=this;if("string"==typeof e){var i=this._requestManager.transformRequest(e,t.ResourceType.Style);t.getJSON(i,(function(e,i){e?r.fire(new t.ErrorEvent(e)):i&&r._updateDiff(i,n)}))}else"object"==typeof e&&this._updateDiff(e,n)}},{key:"_updateDiff",value:function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(o){t.warnOnce("Unable to perform style diff: ".concat(o.message||o.error||o,".  Rebuilding the style from scratch.")),this._updateStyle(e,n)}}},{key:"getStyle",value:function(){if(this.style)return this.style.serialize()}},{key:"isStyleLoaded",value:function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}},{key:"addSource",value:function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}},{key:"isSourceLoaded",value:function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '".concat(e,"'"))))}},{key:"setTerrain",value:function(t){return this.style.setTerrain(t),this}},{key:"getTerrain",value:function(){return this.style.terrain&&this.style.terrain.options}},{key:"areTilesLoaded",value:function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0}},{key:"addSourceType",value:function(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}},{key:"removeSource",value:function(t){return this.style.removeSource(t),this._update(!0)}},{key:"getSource",value:function(t){return this.style.getSource(t)}},{key:"addImage",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.pixelRatio,o=void 0===i?1:i,a=r.sdf,s=void 0!==a&&a,l=r.stretchX,u=r.stretchY,c=r.content;if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||t.isImageBitmap(n)){var h=t.exported.getImageData(n),f=h.width,p=h.height,d=h.data;this.style.addImage(e,{data:new t.RGBAImage({width:f,height:p},d),pixelRatio:o,stretchX:l,stretchY:u,content:c,sdf:s,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var m=n.width,g=n.height,v=n.data,y=n;this.style.addImage(e,{data:new t.RGBAImage({width:m,height:g},new Uint8Array(v)),pixelRatio:o,stretchX:l,stretchY:u,content:c,sdf:s,version:0,userImage:y}),y.onAdd&&y.onAdd(this,e)}}},{key:"updateImage",value:function(e,n){var r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=n instanceof HTMLImageElement||t.isImageBitmap(n)?t.exported.getImageData(n):n,o=i.width,a=i.height,s=i.data;if(void 0===o||void 0===a)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==r.data.width||a!==r.data.height)return this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var l=!(n instanceof HTMLImageElement||t.isImageBitmap(n));r.data.replace(s,l),this.style.updateImage(e,r)}},{key:"hasImage",value:function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}},{key:"removeImage",value:function(t){this.style.removeImage(t)}},{key:"loadImage",value:function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)}},{key:"listImages",value:function(){return this.style.listImages()}},{key:"addLayer",value:function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}},{key:"moveLayer",value:function(t,e){return this.style.moveLayer(t,e),this._update(!0)}},{key:"removeLayer",value:function(t){return this.style.removeLayer(t),this._update(!0)}},{key:"getLayer",value:function(t){return this.style.getLayer(t)}},{key:"setLayerZoomRange",value:function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}},{key:"setFilter",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(t,e,n),this._update(!0)}},{key:"getFilter",value:function(t){return this.style.getFilter(t)}},{key:"setPaintProperty",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(t,e,n,r),this._update(!0)}},{key:"getPaintProperty",value:function(t,e){return this.style.getPaintProperty(t,e)}},{key:"setLayoutProperty",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(t,e,n,r),this._update(!0)}},{key:"getLayoutProperty",value:function(t,e){return this.style.getLayoutProperty(t,e)}},{key:"setLight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}},{key:"getLight",value:function(){return this.style.getLight()}},{key:"setFeatureState",value:function(t,e){return this.style.setFeatureState(t,e),this._update()}},{key:"removeFeatureState",value:function(t,e){return this.style.removeFeatureState(t,e),this._update()}},{key:"getFeatureState",value:function(t){return this.style.getFeatureState(t)}},{key:"getContainer",value:function(){return this._container}},{key:"getCanvasContainer",value:function(){return this._canvasContainer}},{key:"getCanvas",value:function(){return this._canvas}},{key:"_containerDimensions",value:function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}},{key:"_setupContainer",value:function(){var t=this._container;t.classList.add("maplibregl-map","mapboxgl-map");var e=this._canvasContainer=c.create("div","maplibregl-canvas-container mapboxgl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=c.create("canvas","maplibregl-canvas mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1],this.getPixelRatio());var r=this._controlContainer=c.create("div","maplibregl-control-container mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){i[t]=c.create("div","maplibregl-ctrl-".concat(t," mapboxgl-ctrl-").concat(t),r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}},{key:"_setupCooperativeGestures",value:function(){var t=this,e=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=c.create("div","maplibregl-cooperative-gesture-screen",e);var n="Control",r="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(r="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",n="Meta"),this._cooperativeGesturesScreen.innerHTML='\n            <div class="maplibregl-desktop-message">'.concat(r,'</div>\n            <div class="maplibregl-mobile-message">').concat("boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map","</div>\n        "),document.addEventListener("keydown",(function(e){e.key===n&&(t._metaPress=!0)})),document.addEventListener("keyup",(function(e){e.key===n&&(t._metaPress=!1)})),this._canvasContainer.addEventListener("wheel",(function(e){t._onCooperativeGesture(e,t._metaPress,1)}),!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}},{key:"_resizeCanvas",value:function(t,e,n){this._canvas.width=n*t,this._canvas.height=n*e,this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(e,"px")}},{key:"_setupPainter",value:function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new cr(r,this.transform),t.exported$1.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}},{key:"_contextLost",value:function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}},{key:"_contextRestored",value:function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}},{key:"_onMapScroll",value:function(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}},{key:"_onCooperativeGesture",value:function(t,e,n){var r=this;return!e&&n<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((function(){r._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}},{key:"loaded",value:function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}},{key:"_update",value:function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}},{key:"_requestRenderFrame",value:function(t){return this._update(),this._renderTaskQueue.add(t)}},{key:"_cancelRenderFrame",value:function(t){this._renderTaskQueue.remove(t)}},{key:"_render",value:function(e){var n,r=this,i=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,n),i=t.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=t.exported.now();this.style.zoomHistory.update(s,l);var u=new t.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(a=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.load),this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var h=t.exported.now()-i;o.endQueryEXT(o.TIME_ELAPSED_EXT,n),setTimeout((function(){var e=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n),r.fire(new t.Event("gpu-timing-frame",{cpuTime:h,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var f=this.painter.collectGpuTimers();setTimeout((function(){var e=r.painter.queryGpuTimers(f);r.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.fullLoad)),this}}},{key:"redraw",value:function(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}},{key:"remove",value:function(){this._hash&&this._hash.remove();var e,n=f(this._controls);try{for(n.s();!(e=n.n()).done;)e.value.onRemove(this)}catch(i){n.e(i)}finally{n.f()}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),c.remove(this._canvasContainer),c.remove(this._controlContainer),this._cooperativeGestures&&c.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),t.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new t.Event("remove"))}},{key:"triggerRepaint",value:function(){var e=this;this.style&&!this._frame&&(this._frame=t.exported.frame((function(n){t.PerformanceUtils.frame(n),e._frame=null,e._render(n)})))}},{key:"_onWindowOnline",value:function(){this._update()}},{key:"_onWindowResize",value:function(t){this._trackResize&&this.resize({originalEvent:t})._update()}},{key:"showTileBoundaries",get:function(){return!!this._showTileBoundaries},set:function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}},{key:"showPadding",get:function(){return!!this._showPadding},set:function(t){this._showPadding!==t&&(this._showPadding=t,this._update())}},{key:"showCollisionBoxes",get:function(){return!!this._showCollisionBoxes},set:function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}},{key:"showOverdrawInspector",get:function(){return!!this._showOverdrawInspector},set:function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}},{key:"repaint",get:function(){return!!this._repaint},set:function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}},{key:"vertices",get:function(){return!!this._vertices},set:function(t){this._vertices=t,this._update()}},{key:"_setCacheLimits",value:function(e,n){t.setCacheLimits(e,n)}},{key:"version",get:function(){return"2.4.0"}}]),y}(ci),NavigationControl:function(){function e(n){var r=this;d(this,e),this.options=t.extend({},gi,n),this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",(function(t){return r._map.zoomIn({},{originalEvent:t})})),c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",(function(t){return r._map.zoomOut({},{originalEvent:t})})),c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",(function(t){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:t}):r._map.resetNorth({},{originalEvent:t})})),this._compassIcon=c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}return p(e,[{key:"_updateZoomButtons",value:function(){var t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}},{key:"_rotateCompassArrow",value:function(){var t=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._compassIcon.style.transform=t}},{key:"onAdd",value:function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vi(this._map,this._compass,this.options.visualizePitch)),this._container}},{key:"onRemove",value:function(){c.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}},{key:"_createButton",value:function(t,e){var n=c.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}},{key:"_setButtonTitle",value:function(t,e){var n=this._map._getUIString("NavigationControl.".concat(e));t.title=n,t.setAttribute("aria-label",n)}}]),e}(),GeolocateControl:function(e){m(r,e);var n=g(r);function r(e){var o;return d(this,r),(o=n.call(this)).options=t.extend({},Si,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],i(o)),o}return p(r,[{key:"onAdd",value:function(t){var e;return this._map=t,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0!==bi?e(bi):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){bi="denied"!==t.state,e(bi)})):(bi=!!window.navigator.geolocation,e(bi)),this._container}},{key:"onRemove",value:function(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),c.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ei=0,ki=!1}},{key:"_isOutOfMapMaxBounds",value:function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}},{key:"_setErrorState",value:function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}},{key:"_onSuccess",value:function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}},{key:"_updateCamera",value:function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),o=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})}},{key:"_updateMarker",value:function(e){if(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}},{key:"_updateCircleRadius",value:function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),r=e.distanceTo(n),i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width="".concat(i,"px"),this._circleElement.style.height="".concat(i,"px")}},{key:"_onZoom",value:function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}},{key:"_onError",value:function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&ki)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}},{key:"_finish",value:function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}},{key:"_setupUI",value:function(e){var n=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=c.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{var i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=c.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new wi(this._dotElement),this._circleElement=c.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==n._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),n.fire(new t.Event("trackuserlocationend")))}))}},{key:"trigger",value:function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ei--,ki=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ei>1?(e={maximumAge:6e5,timeout:0},ki=!0):(e=this.options.positionOptions,ki=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}},{key:"_clearWatch",value:function(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}}]),r}(t.Evented),AttributionControl:hi,LogoControl:fi,ScaleControl:function(){function e(n){d(this,e),this.options=t.extend({},Ci,n),t.bindAll(["_onMove","setUnit"],this)}return p(e,[{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_onMove",value:function(){Ii(this._map,this._container,this.options)}},{key:"onAdd",value:function(t){return this._map=t,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}},{key:"onRemove",value:function(){c.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},{key:"setUnit",value:function(t){this.options.unit=t,Ii(this._map,this._container,this.options)}}]),e}(),FullscreenControl:function(){function e(n){d(this,e),this._fullscreen=!1,n&&n.container&&(n.container instanceof HTMLElement?this._container=n.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}return p(e,[{key:"onAdd",value:function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=c.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}},{key:"onRemove",value:function(){c.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_checkFullscreenSupport",value:function(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}},{key:"_setupUI",value:function(){var t=this._fullscreenButton=c.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_updateTitle",value:function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}},{key:"_getTitle",value:function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}},{key:"_isFullscreen",value:function(){return this._fullscreen}},{key:"_changeIcon",value:function(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}},{key:"_onClickFullscreen",value:function(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}}]),e}(),TerrainControl:function(){function e(n){d(this,e),this.options=n,t.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}return p(e,[{key:"onAdd",value:function(t){return this._map=t,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=c.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),c.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}},{key:"onRemove",value:function(){c.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},{key:"_toggleTerrain",value:function(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}},{key:"_updateTerrainIcon",value:function(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}}]),e}(),Popup:function(e){m(r,e);var n=g(r);function r(e){var o;return d(this,r),(o=n.call(this)).options=t.extend(Object.create(Pi),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],i(o)),o}return p(r,[{key:"addTo",value:function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}},{key:"isOpen",value:function(){return!!this._map}},{key:"remove",value:function(){return this._content&&c.remove(this._content),this._container&&(c.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}},{key:"trackPointer",value:function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}},{key:"getElement",value:function(){return this._container}},{key:"setText",value:function(t){return this.setDOMContent(document.createTextNode(t))}},{key:"setHTML",value:function(t){var e,n=document.createDocumentFragment(),r=document.createElement("body");for(r.innerHTML=t;e=r.firstChild;)n.appendChild(e);return this.setDOMContent(n)}},{key:"getMaxWidth",value:function(){return this._container&&this._container.style.maxWidth}},{key:"setMaxWidth",value:function(t){return this.options.maxWidth=t,this._update(),this}},{key:"setDOMContent",value:function(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=c.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}},{key:"addClassName",value:function(t){this._container&&this._container.classList.add(t)}},{key:"removeClassName",value:function(t){this._container&&this._container.classList.remove(t)}},{key:"setOffset",value:function(t){return this.options.offset=t,this._update(),this}},{key:"toggleClassName",value:function(t){if(this._container)return this._container.classList.toggle(t)}},{key:"_createCloseButton",value:function(){this.options.closeButton&&(this._closeButton=c.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}},{key:"_onMouseUp",value:function(t){this._update(t.point)}},{key:"_onMouseMove",value:function(t){this._update(t.point)}},{key:"_onDrag",value:function(t){this._update(t.point)}},{key:"_update",value:function(t){var e=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=c.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=c.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return e._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=yi(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var n=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),r=this.options.anchor,i=Mi(this.options.offset);if(!r){var o,a=this._container.offsetWidth,s=this._container.offsetHeight;o=n.y+i.bottom.y<s?["top"]:n.y>this._map.transform.height-s?["bottom"]:[],n.x<a/2?o.push("left"):n.x>this._map.transform.width-a/2&&o.push("right"),r=0===o.length?"bottom":o.join("-")}var l=n.add(i[r]).round();c.setTransform(this._container,"".concat(_i[r]," translate(").concat(l.x,"px,").concat(l.y,"px)")),xi(this._container,r,"popup")}}},{key:"_focusFirstElement",value:function(){if(this.options.focusAfterOpen&&this._container){var t=this._container.querySelector(Ai);t&&t.focus()}}},{key:"_onClose",value:function(){this.remove()}}]),r}(t.Evented),Marker:wi,Style:fe,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,AJAXError:t.AJAXError,config:t.config,CanvasSource:U,GeoJSONSource:O,ImageSource:B,RasterDEMTileSource:z,RasterTileSource:N,VectorTileSource:D,VideoSource:j,prewarm:function(){nt().acquire(Q)},clearPrewarmedResources:function(){var t=J;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Q),J=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return tt.workerCount},set workerCount(t){tt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:"",addProtocol:function(e,n){t.config.REGISTERED_PROTOCOLS[e]=n},removeProtocol:function(e){delete t.config.REGISTERED_PROTOCOLS[e]}};return ui.extend(Li,{isSafari:t.isSafari,getPerformanceMetrics:t.PerformanceUtils.getPerformanceMetrics}),Li})),n}()},4307:function(t){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),n=i(a),"undefined"!==typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=i;else t=i}return r(["exports"],(function(t){var e=n;function n(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=r}function r(t,n,r,i){const o=new e(t,n,r,i);return function(t){return o.solve(t)}}n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,r=0;r<8;r++){var i=this.sampleCurveX(n)-t;if(Math.abs(i)<e)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n-=i/o}var a=0,s=1;for(n=t,r=0;r<20&&(i=this.sampleCurveX(n),!(Math.abs(i-t)<e));r++)t>i?a=n:s=n,n=.5*(s-a)+a;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};const i=r(.25,.1,.25,1);function o(t,e,n){return Math.min(n,Math.max(e,t))}function a(t,e,n){const r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function s(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let l=1;function u(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function c(t,e,n){const r={};for(const i in t)r[i]=e.call(n||this,t[i],i,t);return r}function h(t,e,n){const r={};for(const i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function f(t){return Array.isArray(t)?t.map(f):"object"==typeof t&&t?c(t,f):t}const p={};function d(t){p[t]||("undefined"!=typeof console&&console.warn(t),p[t]=!0)}function m(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function g(t){let e=0;for(let n,r,i=0,o=t.length,a=o-1;i<o;a=i++)n=t[i],r=t[a],e+=(r.x-n.x)*(n.y+r.y);return e}function v(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function y(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,n,r,i)=>{const o=r||i;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let _,x,b=null;function w(t){if(null==b){const e=t.navigator?t.navigator.userAgent:null;b=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return b}function S(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const E={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const n=window.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(_||(_=document.createElement("a")),_.href=t,_.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==x&&(x=matchMedia("(prefers-reduced-motion: reduce)")),x.matches)}};var k=C;function C(t,e){this.x=t,this.y=e}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(t){return t instanceof C?t:Array.isArray(t)?new C(t[0],t[1]):t};const I={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},T="mapbox-tiles";let P,A,M=500,L=50;function R(){"undefined"==typeof caches||P||(P=caches.open(T))}let D=1/0;const N={supported:!1,testSupport:function(t){!F&&O&&(B?j(t):z=t)}};let z,O,F=!1,B=!1;function j(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,O),t.isContextLost())return;N.supported=!0}catch(t){}t.deleteTexture(e),F=!0}"undefined"!=typeof document&&(O=document.createElement("img"),O.onload=function(){z&&j(z),z=null,B=!0},O.onerror=function(){F=!0,z=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const U={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(U);class V extends Error{constructor(t,e,n,r){super(`AJAXError: ${e} (${t}): ${n}`),this.status=t,this.statusText=e,this.url=n,this.body=r}}const Z=v()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href;function q(t,e){const n=new AbortController,r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Z(),signal:n.signal});let i=!1,o=!1;return"json"===t.type&&r.headers.set("Accept","application/json"),((n,a,s)=>{if(o)return;const l=Date.now();fetch(r).then((n=>n.ok?((n,a,s)=>{("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((t=>{o||(a&&s&&function(t,e,n){if(R(),!P)return;const r={status:e.status,statusText:e.statusText,headers:new Headers};e.headers.forEach(((t,e)=>r.headers.set(e,t)));const i=y(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===A)try{new Response(new ReadableStream),A=!0}catch(t){A=!1}A?e(t.body):t.blob().then(e)}(e,(e=>{const n=new Response(e,r);R(),P&&P.then((e=>e.put(function(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}(t.url),n))).catch((t=>d(t.message)))})))}(r,a,s),i=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((t=>{o||e(new Error(t.message))}))})(n,null,l):n.blob().then((r=>e(new V(n.status,n.statusText,t.url,r)))))).catch((t=>{20!==t.code&&e(new Error(t.message))}))})(),{cancel:()=>{o=!0,i||n.abort()}}}const G=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(v()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!v()){const n=t.url.substring(0,t.url.indexOf("://"));return(I.REGISTERED_PROTOCOLS[n]||q)(t,e)}}if(!(/^file:/.test(n=t.url)||/^file:/.test(Z())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return q(t,e);if(v()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){const n=new XMLHttpRequest;n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer");for(const r in t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=()=>{e(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else{const r=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});e(new V(n.status,n.statusText,t.url,r))}},n.send(t.body),{cancel:()=>n.abort()}}(t,e)},W=function(t,e){return G(s(t,{type:"arrayBuffer"}),e)};function X(t){const e=window.document.createElement("a");return e.href=t,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Y,$;Y=[],$=0;const K=function(t,e){if(N.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),$>=I.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Y.push(n),n}$++;let n=!1;const r=()=>{if(!n)for(n=!0,$--;Y.length&&$<I.MAX_PARALLEL_IMAGE_REQUESTS;){const t=Y.shift(),{requestParameters:e,callback:n,cancelled:r}=t;r||(t.cancel=K(e,n).cancel)}},i=W(t,((t,n,i,o)=>{r(),t?e(t):n&&function(t,e){"function"==typeof createImageBitmap?function(t,e){const n=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(n).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(t,e):function(t,e){const n=new Image;n.onload=()=>{e(null,n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((()=>{n.src=H}))},n.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?URL.createObjectURL(r):H}(t,e)}(n,((t,n)=>{null!=t?e(t):null!=n&&e(null,n,{cacheControl:i,expires:o})}))}));return{cancel:()=>{i.cancel(),r()}}};function J(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Q(t,e,n){if(n&&n[t]){const r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}class tt{constructor(t,e={}){s(this,e),this.type=t}}class et extends tt{constructor(t,e={}){super("error",s({error:t},e))}}class nt{on(t,e){return this._listeners=this._listeners||{},J(t,e,this._listeners),this}off(t,e){return Q(t,e,this._listeners),Q(t,e,this._oneTimeListeners),this}once(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},J(t,e,this._oneTimeListeners),this}fire(t,e){"string"==typeof t&&(t=new tt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const o of r)Q(n,o,this._oneTimeListeners),o.call(this,t);const i=this._eventedParent;i&&(s(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(t))}else t instanceof et&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var rt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class it{constructor(t,e,n,r){this.message=(t?`${t}: `:"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function ot(t){const e=t.value;return e?[new it(t.key,e,"constants have been deprecated as of v8")]:[]}function at(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}function st(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function lt(t){if(Array.isArray(t))return t.map(lt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=lt(t[n]);return e}return st(t)}class ut extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class ct{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[n,r]of e)this.bindings[n]=r}concat(t){return new ct(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ht={kind:"null"},ft={kind:"number"},pt={kind:"string"},dt={kind:"boolean"},mt={kind:"color"},gt={kind:"object"},vt={kind:"value"},yt={kind:"collator"},_t={kind:"formatted"},xt={kind:"padding"},bt={kind:"resolvedImage"};function wt(t,e){return{kind:"array",itemType:t,N:e}}function St(t){if("array"===t.kind){const e=St(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Et=[ht,ft,pt,dt,mt,_t,gt,wt(vt),xt,bt];function kt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!kt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Et)if(!kt(t,e))return null}return`Expected ${St(t)} but found ${St(e)} instead.`}function Ct(t,e){return e.some((e=>e.kind===t.kind))}function It(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}var Tt,Pt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function At(t){return(t=Math.round(t))<0?0:t>255?255:t}function Mt(t){return At("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Lt(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Rt(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Tt={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Pt)return Pt[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var r=n.indexOf("("),i=n.indexOf(")");if(-1!==r&&i+1===n.length){var o=n.substr(0,r),a=n.substr(r+1,i-(r+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=Lt(a.pop());case"rgb":return 3!==a.length?null:[Mt(a[0]),Mt(a[1]),Mt(a[2]),s];case"hsla":if(4!==a.length)return null;s=Lt(a.pop());case"hsl":if(3!==a.length)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=Lt(a[1]),c=Lt(a[2]),h=c<=.5?c*(u+1):c+u-c*u,f=2*c-h;return[At(255*Rt(f,h,l+1/3)),At(255*Rt(f,h,l)),At(255*Rt(f,h,l-1/3)),s];default:return null}}return null}}catch(t){}class Dt{constructor(t,e,n,r=1){this.r=t,this.g=e,this.b=n,this.a=r}static parse(t){if(!t)return;if(t instanceof Dt)return t;if("string"!=typeof t)return;const e=Tt(t);return e?new Dt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,r]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${r})`}toArray(){const{r:t,g:e,b:n,a:r}=this;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]}}Dt.black=new Dt(0,0,0,1),Dt.white=new Dt(1,1,1,1),Dt.transparent=new Dt(0,0,0,0),Dt.red=new Dt(1,0,0,1);class Nt{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class zt{constructor(t,e,n,r,i){this.text=t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=i}}class Ot{constructor(t){this.sections=t}static fromString(t){return new Ot([new zt(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof Ot?t:Ot.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class Ft{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ft)return t;if("number"==typeof t)return new Ft([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Ft(t)}}toString(){return JSON.stringify(this.values)}}class Bt{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Bt({name:t,available:!1}):null}}function jt(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[t,e,n,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ut(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Dt)return!0;if(t instanceof Nt)return!0;if(t instanceof Ot)return!0;if(t instanceof Ft)return!0;if(t instanceof Bt)return!0;if(Array.isArray(t)){for(const e of t)if(!Ut(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Ut(t[e]))return!1;return!0}return!1}function Vt(t){if(null===t)return ht;if("string"==typeof t)return pt;if("boolean"==typeof t)return dt;if("number"==typeof t)return ft;if(t instanceof Dt)return mt;if(t instanceof Nt)return yt;if(t instanceof Ot)return _t;if(t instanceof Ft)return xt;if(t instanceof Bt)return bt;if(Array.isArray(t)){const e=t.length;let n;for(const r of t){const t=Vt(r);if(n){if(n===t)continue;n=vt;break}n=t}return wt(n||vt,e)}return gt}function Zt(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Dt||t instanceof Ot||t instanceof Ft||t instanceof Bt?t.toString():JSON.stringify(t)}class qt{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ut(t[1]))return e.error("invalid value");const n=t[1];let r=Vt(n);const i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new qt(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Gt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Wt={string:pt,number:ft,boolean:dt,object:gt};class Xt{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,r=1;const i=t[0];if("array"===i){let i,o;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in Wt)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);i=Wt[n],r++}else i=vt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],r++}n=wt(i,o)}else{if(!Wt[i])throw new Error(`Types doesn't contain name = ${i}`);n=Wt[i]}const o=[];for(;r<t.length;r++){const n=e.parse(t[r],r,vt);if(!n)return null;o.push(n)}return new Xt(n,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!kt(this.type,Vt(n)))return n;if(e===this.args.length-1)throw new Gt(`Expected value to be of type ${St(this.type)}, but found ${St(Vt(n))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Ht={"to-boolean":dt,"to-color":mt,"to-number":ft,"to-string":pt};class Yt{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(!Ht[n])throw new Error(`Can't parse ${n} as it is not part of the known types`);if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const r=Ht[n],i=[];for(let o=1;o<t.length;o++){const n=e.parse(t[o],o,vt);if(!n)return null;i.push(n)}return new Yt(r,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const r of this.args){if(e=r.evaluate(t),n=null,e instanceof Dt)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:jt(e[0],e[1],e[2],e[3]),!n))return new Dt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Gt(n||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}if("padding"===this.type.kind){let e;for(const n of this.args){e=n.evaluate(t);const r=Ft.parse(e);if(r)return r}throw new Gt(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new Gt(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?Ot.fromString(Zt(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Bt.fromString(Zt(this.args[0].evaluate(t))):Zt(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const $t=["Unknown","Point","LineString","Polygon"];class Kt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?$t[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Dt.parse(t)),e}}class Jt{constructor(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const n=t[0],r=Jt.definitions[n];if(!r)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=o.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let s=null;for(const[l,u]of a){s=new be(e.registry,e.path,null,e.scope);const r=[];let o=!1;for(let e=1;e<t.length;e++){const n=t[e],i=Array.isArray(l)?l[e-1]:l.type,a=s.parse(n,1+r.length,i);if(!a){o=!0;break}r.push(a)}if(!o)if(Array.isArray(l)&&l.length!==r.length)s.error(`Expected ${l.length} arguments, but found ${r.length} instead.`);else{for(let t=0;t<r.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=r[t];s.concat(t+1).checkSubtype(e,n.type)}if(0===s.errors.length)return new Jt(n,i,u,r)}}if(1===a.length)e.errors.push(...s.errors);else{const n=(a.length?a:o).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(St).join(", ")})`:`(${St(e.type)}...)`;var e})).join(" | "),r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],1+r.length);if(!n)return null;r.push(St(n.type))}e.error(`Expected arguments of type ${n}, but found (${r.join(", ")}) instead.`)}return null}static register(t,e){Jt.definitions=e;for(const n in e)t[n]=Jt}}class Qt{constructor(t,e,n){this.type=yt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,dt);if(!r)return null;const i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,dt);if(!i)return null;let o=null;return n.locale&&(o=e.parse(n.locale,1,pt),!o)?null:new Qt(r,i,o)}evaluate(t){return new Nt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const te=8192;function ee(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ne(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function re(t,e){const n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(n*i*te),Math.round(r*i*te)]}function ie(t,e,n){const r=t[0]-e[0],i=t[1]-e[1],o=t[0]-n[0],a=t[1]-n[1];return r*a-o*i==0&&r*o<=0&&i*a<=0}function oe(t,e){let n=!1;for(let a=0,s=e.length;a<s;a++){const s=e[a];for(let e=0,a=s.length;e<a-1;e++){if(ie(t,s[e],s[e+1]))return!1;(i=s[e])[1]>(r=t)[1]!=(o=s[e+1])[1]>r[1]&&r[0]<(o[0]-i[0])*(r[1]-i[1])/(o[1]-i[1])+i[0]&&(n=!n)}}var r,i,o;return n}function ae(t,e){for(let n=0;n<e.length;n++)if(oe(t,e[n]))return!0;return!1}function se(t,e,n,r){const i=r[0]-n[0],o=r[1]-n[1],a=(t[0]-n[0])*o-i*(t[1]-n[1]),s=(e[0]-n[0])*o-i*(e[1]-n[1]);return a>0&&s<0||a<0&&s>0}function le(t,e,n){for(const u of n)for(let n=0;n<u.length-1;++n)if(0!=(s=[(a=u[n+1])[0]-(o=u[n])[0],a[1]-o[1]])[0]*(l=[(i=e)[0]-(r=t)[0],i[1]-r[1]])[1]-s[1]*l[0]&&se(r,i,o,a)&&se(o,a,r,i))return!0;var r,i,o,a,s,l;return!1}function ue(t,e){for(let n=0;n<t.length;++n)if(!oe(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(le(t[n],t[n+1],e))return!1;return!0}function ce(t,e){for(let n=0;n<e.length;n++)if(ue(t,e[n]))return!0;return!1}function he(t,e,n){const r=[];for(let i=0;i<t.length;i++){const o=[];for(let r=0;r<t[i].length;r++){const a=re(t[i][r],n);ee(e,a),o.push(a)}r.push(o)}return r}function fe(t,e,n){const r=[];for(let i=0;i<t.length;i++){const o=he(t[i],e,n);r.push(o)}return r}function pe(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){const e=.5*r;let i=t[0]-n[0]>e?-r:n[0]-t[0]>e?r:0;0===i&&(i=t[0]-n[2]>e?-r:n[2]-t[0]>e?r:0),t[0]+=i}ee(e,t)}function de(t,e,n,r){const i=Math.pow(2,r.z)*te,o=[r.x*te,r.y*te],a=[];for(const s of t)for(const t of s){const r=[t.x+o[0],t.y+o[1]];pe(r,e,n,i),a.push(r)}return a}function me(t,e,n,r){const i=Math.pow(2,r.z)*te,o=[r.x*te,r.y*te],a=[];for(const l of t){const t=[];for(const n of l){const r=[n.x+o[0],n.y+o[1]];ee(e,r),t.push(r)}a.push(t)}if(e[2]-e[0]<=i/2){(s=e)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const t of a)for(const r of t)pe(r,e,n,i)}var s;return a}class ge{constructor(t,e){this.type=dt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ut(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new ge(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new ge(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new ge(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=he(e.coordinates,r,i),a=de(t.geometry(),n,r,i);if(!ne(n,r))return!1;for(const t of a)if(!oe(t,o))return!1}if("MultiPolygon"===e.type){const o=fe(e.coordinates,r,i),a=de(t.geometry(),n,r,i);if(!ne(n,r))return!1;for(const t of a)if(!ae(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=he(e.coordinates,r,i),a=me(t.geometry(),n,r,i);if(!ne(n,r))return!1;for(const t of a)if(!ue(t,o))return!1}if("MultiPolygon"===e.type){const o=fe(e.coordinates,r,i),a=me(t.geometry(),n,r,i);if(!ne(n,r))return!1;for(const t of a)if(!ce(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ve(t){if(t instanceof Jt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof ge)return!1;let e=!0;return t.eachChild((t=>{e&&!ve(t)&&(e=!1)})),e}function ye(t){if(t instanceof Jt&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!ye(t)&&(e=!1)})),e}function _e(t,e){if(t instanceof Jt&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!_e(t,e)&&(n=!1)})),n}class xe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new xe(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class be{constructor(t,e=[],n,r=new ct,i=[]){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=r,this.errors=i,this.expectedType=n}parse(t,e,n,r,i={}){return e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)}_parse(t,e){function n(t,e,n){return"assert"===n?new Xt(e,[t]):"coerce"===n?new Yt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[r];if(i){let r=i.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,i=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind)if("padding"!==t.kind||"value"!==i.kind&&"number"!==i.kind&&"array"!==i.kind){if(this.checkSubtype(t,i))return null}else r=n(r,t,e.typeAnnotation||"coerce");else r=n(r,t,e.typeAnnotation||"coerce");else r=n(r,t,e.typeAnnotation||"assert")}if(!(r instanceof qt)&&"resolvedImage"!==r.type.kind&&we(r)){const e=new Kt;try{r=new qt(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new be(this.registry,r,e||null,i,this.errors)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new ut(n,t))}checkSubtype(t,e){const n=kt(t,e);return n&&this.error(n),n}}function we(t){if(t instanceof xe)return we(t.boundExpression);if(t instanceof Jt&&"error"===t.name)return!1;if(t instanceof Qt)return!1;if(t instanceof ge)return!1;const e=t instanceof Yt||t instanceof Xt;let n=!0;return t.eachChild((t=>{n=e?n&&we(t):n&&t instanceof qt})),!!n&&ve(t)&&_e(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Se(t,e){const n=t.length-1;let r,i,o=0,a=n,s=0;for(;o<=a;)if(s=Math.floor((o+a)/2),r=t[s],i=t[s+1],r<=e){if(s===n||e<i)return s;o=s+1}else{if(!(r>e))throw new Gt("Input is not a number.");a=s-1}return 0}class Ee{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[r,i]of n)this.labels.push(r),this.outputs.push(i)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,ft);if(!n)return null;const r=[];let i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(let o=1;o<t.length;o+=2){const n=1===o?-1/0:t[o],a=t[o+1],s=o,l=o+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(r.length&&r[r.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=e.parse(a,l,i);if(!u)return null;i=i||u.type,r.push([n,u])}return new Ee(i,n,r)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[Se(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ke(t,e,n){return t*(1-n)+e*n}var Ce=Object.freeze({__proto__:null,number:ke,color:function(t,e,n){return new Dt(ke(t.r,e.r,n),ke(t.g,e.g,n),ke(t.b,e.b,n),ke(t.a,e.a,n))},array:function(t,e,n){return t.map(((t,r)=>ke(t,e[r],n)))},padding:function(t,e,n){const r=t.values,i=e.values;return new Ft([ke(r[0],i[0],n),ke(r[1],i[1],n),ke(r[2],i[2],n),ke(r[3],i[3],n)])}});const Ie=.95047,Te=1.08883,Pe=4/29,Ae=6/29,Me=3*Ae*Ae,Le=Math.PI/180,Re=180/Math.PI;function De(t){return t>.008856451679035631?Math.pow(t,1/3):t/Me+Pe}function Ne(t){return t>Ae?t*t*t:Me*(t-Pe)}function ze(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Oe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Fe(t){const e=Oe(t.r),n=Oe(t.g),r=Oe(t.b),i=De((.4124564*e+.3575761*n+.1804375*r)/Ie),o=De((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-De((.0193339*e+.119192*n+.9503041*r)/Te)),alpha:t.a}}function Be(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*Ne(e),n=Ie*Ne(n),r=Te*Ne(r),new Dt(ze(3.2404542*n-1.5371385*e-.4985314*r),ze(-.969266*n+1.8760108*e+.041556*r),ze(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function je(t,e,n){const r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const Ue={forward:Fe,reverse:Be,interpolate:function(t,e,n){return{l:ke(t.l,e.l,n),a:ke(t.a,e.a,n),b:ke(t.b,e.b,n),alpha:ke(t.alpha,e.alpha,n)}}},Ve={forward:function(t){const{l:e,a:n,b:r}=Fe(t),i=Math.atan2(r,n)*Re;return{h:i<0?i+360:i,c:Math.sqrt(n*n+r*r),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Le,n=t.c;return Be({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:je(t.h,e.h,n),c:ke(t.c,e.c,n),l:ke(t.l,e.l,n),alpha:ke(t.alpha,e.alpha,n)}}};var Ze=Object.freeze({__proto__:null,lab:Ue,hcl:Ve});class qe{constructor(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(const[o,a]of i)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(t,n,r,i){let o=0;if("exponential"===t.name)o=Ge(n,t.base,r,i);else if("linear"===t.name)o=Ge(n,1,r,i);else if("cubic-bezier"===t.name){const a=t.controlPoints;o=new e(a[0],a[1],a[2],a[3]).solve(Ge(n,1,r,i))}return o}static parse(t,e){let[n,r,i,...o]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const t=r.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(i=e.parse(i,2,ft),!i)return null;const a=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=mt:e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let l=0;l<o.length;l+=2){const t=o[l],n=o[l+1],r=l+3,i=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(a.length&&a[a.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const u=e.parse(n,i,s);if(!u)return null;s=s||u.type,a.push([t,u])}return"number"===s.kind||"color"===s.kind||"padding"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new qe(s,n,r,i,a):e.error(`Type ${St(s)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);const o=Se(e,r),a=qe.interpolationFactor(this.interpolation,r,e[o],e[o+1]),s=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?Ce[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?Ve.reverse(Ve.interpolate(Ve.forward(s),Ve.forward(l),a)):Ue.reverse(Ue.interpolate(Ue.forward(s),Ue.forward(l),a))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Ge(t,e,n,r){const i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}class We{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const r=e.expectedType;r&&"value"!==r.kind&&(n=r);const i=[];for(const a of t.slice(1)){const t=e.parse(a,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,i.push(t)}if(!n)throw new Error("No output type");const o=r&&i.some((t=>kt(r,t.type)));return new We(o?vt:n,i)}evaluate(t){let e,n=null,r=0;for(const i of this.args)if(r++,n=i.evaluate(t),n&&n instanceof Bt&&!n.available&&(e||(e=n.name),n=null,r===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}class Xe{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let i=1;i<t.length-1;i+=2){const r=t[i];if("string"!=typeof r)return e.error(`Expected string, but found ${typeof r} instead.`,i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);const o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return r?new Xe(n,r):null}outputDefined(){return this.result.outputDefined()}}class He{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,ft),r=e.parse(t[2],2,wt(e.expectedType||vt));return n&&r?new He(r.type.itemType,n,r):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new Gt(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new Gt(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new Gt(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Ye{constructor(t,e){this.type=dt,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,vt),r=e.parse(t[2],2,vt);return n&&r?Ct(n.type,[dt,pt,ft,ht,vt])?new Ye(n,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${St(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!It(e,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${St(Vt(e))} instead.`);if(!It(n,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${St(Vt(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class $e{constructor(t,e,n){this.type=ft,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,vt),r=e.parse(t[2],2,vt);if(!n||!r)return null;if(!Ct(n.type,[dt,pt,ft,ht,vt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${St(n.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,ft);return i?new $e(n,r,i):null}return new $e(n,r)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!It(e,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${St(Vt(e))} instead.`);if(!It(n,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${St(Vt(n))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Ke{constructor(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const i={},o=[];for(let l=2;l<t.length-1;l+=2){let a=t[l];const s=t[l+1];Array.isArray(a)||(a=[a]);const u=e.concat(l);if(0===a.length)return u.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,Vt(t)))return null}else n=Vt(t);if(void 0!==i[String(t)])return u.error("Branch labels must be unique.");i[String(t)]=o.length}const c=e.parse(s,l,r);if(!c)return null;r=r||c.type,o.push(c)}const a=e.parse(t[1],1,vt);if(!a)return null;const s=e.parse(t[t.length-1],t.length-1,r);return s?"value"!==a.type.kind&&e.concat(1).checkSubtype(n,a.type)?null:new Ke(n,r,a,i,o,s):null}evaluate(t){const e=this.input.evaluate(t);return(Vt(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class Je{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const r=[];for(let o=1;o<t.length-1;o+=2){const i=e.parse(t[o],o,dt);if(!i)return null;const a=e.parse(t[o+1],o+1,n);if(!a)return null;r.push([i,a]),n=n||a.type}const i=e.parse(t[t.length-1],t.length-1,n);if(!i)return null;if(!n)throw new Error("Can't infer output type");return new Je(n,r,i)}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Qe{constructor(t,e,n,r){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,vt),r=e.parse(t[2],2,ft);if(!n||!r)return null;if(!Ct(n.type,[wt(vt),pt,vt]))return e.error(`Expected first argument to be of type array or string, but found ${St(n.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,ft);return i?new Qe(n.type,n,r,i):null}return new Qe(n.type,n,r)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!It(e,["string","array"]))throw new Gt(`Expected first argument to be of type array or string, but found ${St(Vt(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function tn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function en(t,e,n,r){return 0===r.compare(e,n)}function nn(t,e,n){const r="=="!==t&&"!="!==t;return class i{constructor(t,e,n){this.type=dt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let o=e.parse(t[1],1,vt);if(!o)return null;if(!tn(n,o.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${St(o.type)}'.`);let a=e.parse(t[2],2,vt);if(!a)return null;if(!tn(n,a.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${St(a.type)}'.`);if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error(`Cannot compare types '${St(o.type)}' and '${St(a.type)}'.`);r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new Xt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new Xt(o.type,[a])));let s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(s=e.parse(t[3],3,yt),!s)return null}return new i(o,a,s)}evaluate(i){const o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){const e=Vt(o),n=Vt(a);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new Gt(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const t=Vt(o),n=Vt(a);if("string"!==t.kind||"string"!==n.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const rn=nn("==",(function(t,e,n){return e===n}),en),on=nn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!en(0,e,n,r)})),an=nn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),sn=nn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),ln=nn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),un=nn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0}));class cn{constructor(t,e,n,r,i){this.type=pt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ft);if(!n)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let i=null;if(r.locale&&(i=e.parse(r.locale,1,pt),!i))return null;let o=null;if(r.currency&&(o=e.parse(r.currency,1,pt),!o))return null;let a=null;if(r["min-fraction-digits"]&&(a=e.parse(r["min-fraction-digits"],1,ft),!a))return null;let s=null;return r["max-fraction-digits"]&&(s=e.parse(r["max-fraction-digits"],1,ft),!s)?null:new cn(n,i,o,a,s)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class hn{constructor(t){this.type=_t,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const r=[];let i=!1;for(let o=1;o<=t.length-1;++o){const n=t[o];if(i&&"object"==typeof n&&!Array.isArray(n)){i=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,ft),!t))return null;let o=null;if(n["text-font"]&&(o=e.parse(n["text-font"],1,wt(pt)),!o))return null;let a=null;if(n["text-color"]&&(a=e.parse(n["text-color"],1,mt),!a))return null;const s=r[r.length-1];s.scale=t,s.font=o,s.textColor=a}else{const n=e.parse(t[o],1,vt);if(!n)return null;const a=n.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:n,scale:null,font:null,textColor:null})}}return new hn(r)}evaluate(t){return new Ot(this.sections.map((e=>{const n=e.content.evaluate(t);return Vt(n)===bt?new zt("",n,null,null,null):new zt(Zt(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class fn{constructor(t){this.type=bt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,pt);return n?new fn(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=Bt.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}}class pn{constructor(t){this.type=ft,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${St(n.type)} instead.`):new pn(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new Gt(`Expected value to be of type string or array, but found ${St(Vt(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const dn={"==":rn,"!=":on,">":sn,"<":an,">=":un,"<=":ln,array:Xt,at:He,boolean:Xt,case:Je,coalesce:We,collator:Qt,format:hn,image:fn,in:Ye,"index-of":$e,interpolate:qe,"interpolate-hcl":qe,"interpolate-lab":qe,length:pn,let:Xe,literal:qt,match:Ke,number:Xt,"number-format":cn,object:Xt,slice:Qe,step:Ee,string:Xt,"to-boolean":Yt,"to-color":Yt,"to-number":Yt,"to-string":Yt,var:xe,within:ge};function mn(t,[e,n,r,i]){e=e.evaluate(t),n=n.evaluate(t),r=r.evaluate(t);const o=i?i.evaluate(t):1,a=jt(e,n,r,o);if(a)throw new Gt(a);return new Dt(e/255*o,n/255*o,r/255*o,o)}function gn(t,e){return t in e}function vn(t,e){const n=e[t];return void 0===n?null:n}function yn(t){return{type:t}}function _n(t){return{result:"success",value:t}}function xn(t){return{result:"error",value:t}}function bn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function wn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Sn(t){return!!t.expression&&t.expression.interpolated}function En(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function kn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Cn(t){return t}function In(t,e){const n="color"===e.type,r=t.stops&&"object"==typeof t.stops[0][0],i=r||!(r||void 0!==t.property),o=t.type||(Sn(e)?"exponential":"interval");if(n||"padding"===e.type){const r=n?Dt.parse:Ft.parse;(t=at({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],r(t[1])]))),t.default=r(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==t.colorSpace&&!Ze[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let a,s,l;if("exponential"===o)a=Mn;else if("interval"===o)a=An;else if("categorical"===o){a=Pn,s=Object.create(null);for(const e of t.stops)s[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);a=Ln}if(r){const n={},r=[];for(let e=0;e<t.stops.length;e++){const i=t.stops[e],o=i[0].zoom;void 0===n[o]&&(n[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},r.push(o)),n[o].stops.push([i[0].value,i[1]])}const i=[];for(const t of r)i.push([n[t].zoom,In(n[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:qe.interpolationFactor.bind(void 0,o),zoomStops:i.map((t=>t[0])),evaluate:({zoom:n},r)=>Mn({stops:i,base:t.base},e,n).evaluate(n,r)}}if(i){const n="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:qe.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:n})=>a(t,e,n,s,l)}}return{kind:"source",evaluate(n,r){const i=r&&r.properties?r.properties[t.property]:void 0;return void 0===i?Tn(t.default,e.default):a(t,e,i,s,l)}}}function Tn(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Pn(t,e,n,r,i){return Tn(typeof n===i?r[n]:void 0,t.default,e.default)}function An(t,e,n){if("number"!==En(n))return Tn(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const i=Se(t.stops.map((t=>t[0])),n);return t.stops[i][1]}function Mn(t,e,n){const r=void 0!==t.base?t.base:1;if("number"!==En(n))return Tn(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const o=Se(t.stops.map((t=>t[0])),n),a=function(t,e,n,r){const i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1];let u=Ce[e.type]||Cn;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=Ze[t.colorSpace];u=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),a))}return"function"==typeof s.evaluate?{evaluate(...t){const e=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==n)return u(e,n,a)}}:u(s,l,a)}function Ln(t,e,n){switch(e.type){case"color":n=Dt.parse(n);break;case"formatted":n=Ot.fromString(n.toString());break;case"resolvedImage":n=Bt.fromString(n.toString());break;case"padding":n=Ft.parse(n);break;default:En(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0)}return Tn(n,t.default,e.default)}Jt.register(dn,{error:[{kind:"error"},[pt],(t,[e])=>{throw new Gt(e.evaluate(t))}],typeof:[pt,[vt],(t,[e])=>St(Vt(e.evaluate(t)))],"to-rgba":[wt(ft,4),[mt],(t,[e])=>e.evaluate(t).toArray()],rgb:[mt,[ft,ft,ft],mn],rgba:[mt,[ft,ft,ft,ft],mn],has:{type:dt,overloads:[[[pt],(t,[e])=>gn(e.evaluate(t),t.properties())],[[pt,gt],(t,[e,n])=>gn(e.evaluate(t),n.evaluate(t))]]},get:{type:vt,overloads:[[[pt],(t,[e])=>vn(e.evaluate(t),t.properties())],[[pt,gt],(t,[e,n])=>vn(e.evaluate(t),n.evaluate(t))]]},"feature-state":[vt,[pt],(t,[e])=>vn(e.evaluate(t),t.featureState||{})],properties:[gt,[],t=>t.properties()],"geometry-type":[pt,[],t=>t.geometryType()],id:[vt,[],t=>t.id()],zoom:[ft,[],t=>t.globals.zoom],"heatmap-density":[ft,[],t=>t.globals.heatmapDensity||0],"line-progress":[ft,[],t=>t.globals.lineProgress||0],accumulated:[vt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ft,yn(ft),(t,e)=>{let n=0;for(const r of e)n+=r.evaluate(t);return n}],"*":[ft,yn(ft),(t,e)=>{let n=1;for(const r of e)n*=r.evaluate(t);return n}],"-":{type:ft,overloads:[[[ft,ft],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[ft],(t,[e])=>-e.evaluate(t)]]},"/":[ft,[ft,ft],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[ft,[ft,ft],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[ft,[],()=>Math.LN2],pi:[ft,[],()=>Math.PI],e:[ft,[],()=>Math.E],"^":[ft,[ft,ft],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[ft,[ft],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[ft,[ft],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[ft,[ft],(t,[e])=>Math.log(e.evaluate(t))],log2:[ft,[ft],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[ft,[ft],(t,[e])=>Math.sin(e.evaluate(t))],cos:[ft,[ft],(t,[e])=>Math.cos(e.evaluate(t))],tan:[ft,[ft],(t,[e])=>Math.tan(e.evaluate(t))],asin:[ft,[ft],(t,[e])=>Math.asin(e.evaluate(t))],acos:[ft,[ft],(t,[e])=>Math.acos(e.evaluate(t))],atan:[ft,[ft],(t,[e])=>Math.atan(e.evaluate(t))],min:[ft,yn(ft),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[ft,yn(ft),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[ft,[ft],(t,[e])=>Math.abs(e.evaluate(t))],round:[ft,[ft],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[ft,[ft],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[ft,[ft],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[dt,[pt,vt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[dt,[vt],(t,[e])=>t.id()===e.value],"filter-type-==":[dt,[pt],(t,[e])=>t.geometryType()===e.value],"filter-<":[dt,[pt,vt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r<i}],"filter-id-<":[dt,[vt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n<r}],"filter->":[dt,[pt,vt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r>i}],"filter-id->":[dt,[vt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n>r}],"filter-<=":[dt,[pt,vt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r<=i}],"filter-id-<=":[dt,[vt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n<=r}],"filter->=":[dt,[pt,vt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r>=i}],"filter-id->=":[dt,[vt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n>=r}],"filter-has":[dt,[vt],(t,[e])=>e.value in t.properties()],"filter-has-id":[dt,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[dt,[wt(pt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[dt,[wt(vt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[dt,[pt,wt(vt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[dt,[pt,wt(vt)],(t,[e,n])=>function(t,e,n,r){for(;n<=r;){const i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:dt,overloads:[[[dt,dt],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[yn(dt),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:dt,overloads:[[[dt,dt],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[yn(dt),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[dt,[dt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[dt,[pt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[pt,[pt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[pt,[pt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[pt,yn(vt),(t,e)=>e.map((e=>Zt(e.evaluate(t)))).join("")],"resolved-locale":[pt,[yt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class Rn{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Kt,this._defaultValue=e?function(t){return"color"===t.type&&kn(t.default)?new Dt(0,0,0,0):"color"===t.type?Dt.parse(t.default)||null:"padding"===t.type?Ft.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,r,i,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new Gt(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Dn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in dn}function Nn(t,e){const n=new be(dn,[],e?function(t){const e={color:mt,string:pt,number:ft,enum:pt,boolean:dt,formatted:_t,padding:xt,resolvedImage:bt};return"array"===t.type?wt(e[t.value]||vt,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?_n(new Rn(r,e)):xn(n.errors)}class zn{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!ye(e.expression)}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}evaluate(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}}class On{constructor(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!ye(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}evaluate(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}interpolationFactor(t,e,n){return this.interpolationType?qe.interpolationFactor(this.interpolationType,t,e,n):0}}function Fn(t,e){const n=Nn(t,e);if("error"===n.result)return n;const r=n.value.expression,i=ve(r);if(!i&&!bn(e))return xn([new ut("","data expressions not supported")]);const o=_e(r,["zoom"]);if(!o&&!wn(e))return xn([new ut("","zoom expressions not supported")]);const a=jn(r);return a||o?a instanceof ut?xn([a]):a instanceof qe&&!Sn(e)?xn([new ut("",'"interpolate" expressions cannot be used with this property')]):_n(a?new On(i?"camera":"composite",n.value,a.labels,a instanceof qe?a.interpolation:void 0):new zn(i?"constant":"source",n.value)):xn([new ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Bn{constructor(t,e){this._parameters=t,this._specification=e,at(this,In(this._parameters,this._specification))}static deserialize(t){return new Bn(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function jn(t){let e=null;if(t instanceof Xe)e=jn(t.result);else if(t instanceof We){for(const n of t.args)if(e=jn(n),e)break}else(t instanceof Ee||t instanceof qe)&&t.input instanceof Jt&&"zoom"===t.input.name&&(e=t);return e instanceof ut||t.eachChild((t=>{const n=jn(t);n instanceof ut?e=n:!e&&n?e=new ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new ut("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Un(t){const e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec;let s=[];const l=En(n);if("object"!==l)return[new it(e,n,`object expected, ${l} found`)];for(const u in n){const t=u.split(".")[0],l=r[t]||r["*"];let c;if(i[t])c=i[t];else if(r[t])c=mr;else if(i["*"])c=i["*"];else{if(!r["*"]){s.push(new it(e,n[u],`unknown property "${u}"`));continue}c=mr}s=s.concat(c({key:(e?`${e}.`:e)+u,value:n[u],valueSpec:l,style:o,styleSpec:a,object:n,objectKey:u},n))}for(const u in r)i[u]||r[u].required&&void 0===r[u].default&&void 0===n[u]&&s.push(new it(e,n,`missing required property "${u}"`));return s}function Vn(t){const e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||mr;if("array"!==En(e))return[new it(o,e,`array expected, ${En(e)} found`)];if(n.length&&e.length!==n.length)return[new it(o,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new it(o,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===En(n.value)&&(s=n.value);let l=[];for(let u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:r,styleSpec:i,key:`${o}[${u}]`}));return l}function Zn(t){const e=t.key,n=t.value,r=t.valueSpec;let i=En(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new it(e,n,`number expected, ${i} found`)]:"minimum"in r&&n<r.minimum?[new it(e,n,`${n} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&n>r.maximum?[new it(e,n,`${n} is greater than the maximum value ${r.maximum}`)]:[]}function qn(t){const e=t.valueSpec,n=st(t.value.type);let r,i,o,a={};const s="categorical"!==n&&void 0===t.value.property,l=!s,u="array"===En(t.value.stops)&&"array"===En(t.value.stops[0])&&"object"===En(t.value.stops[0][0]),c=Un({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new it(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(Vn({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===En(r)&&0===r.length&&e.push(new it(t.key,r,"array must have at least one stop")),e},default:function(t){return mr({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&s&&c.push(new it(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||c.push(new it(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Sn(t.valueSpec)&&c.push(new it(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!bn(t.valueSpec)?c.push(new it(t.key,t.value,"property functions not supported")):s&&!wn(t.valueSpec)&&c.push(new it(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!u||void 0!==t.value.property||c.push(new it(t.key,t.value,'"property" property is required')),c;function h(t){let n=[];const r=t.value,s=t.key;if("array"!==En(r))return[new it(s,r,`array expected, ${En(r)} found`)];if(2!==r.length)return[new it(s,r,`array length 2 expected, length ${r.length} found`)];if(u){if("object"!==En(r[0]))return[new it(s,r,`object expected, ${En(r[0])} found`)];if(void 0===r[0].zoom)return[new it(s,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new it(s,r,"object stop key must have value")];if(o&&o>st(r[0].zoom))return[new it(s,r[0].zoom,"stop zoom values must appear in ascending order")];st(r[0].zoom)!==o&&(o=st(r[0].zoom),i=void 0,a={}),n=n.concat(Un({key:`${s}[0]`,value:r[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Zn,value:f}}))}else n=n.concat(f({key:`${s}[0]`,value:r[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},r));return Dn(lt(r[1]))?n.concat([new it(`${s}[1]`,r[1],"expressions are not allowed in function stops.")]):n.concat(mr({key:`${s}[1]`,value:r[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function f(t,o){const s=En(t.value),l=st(t.value),u=null!==t.value?t.value:o;if(r){if(s!==r)return[new it(t.key,u,`${s} stop domain type must match previous stop domain type ${r}`)]}else r=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new it(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==n){let r=`number expected, ${s} found`;return bn(e)&&void 0===n&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(t.key,u,r)]}return"categorical"!==n||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===s&&void 0!==i&&l<i?[new it(t.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===n&&l in a?[new it(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new it(t.key,u,`integer expected, found ${l}`)]}}function Gn(t){const e=("property"===t.expressionContext?Fn:Nn)(lt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new it(`${t.key}${e.key}`,t.value,e.message)));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new it(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!ye(n))return[new it(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!ye(n))return[new it(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!_e(n,["zoom","feature-state"]))return[new it(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!ve(n))return[new it(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wn(t){const e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(st(n))&&i.push(new it(e,n,`expected one of [${r.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(r.values).indexOf(st(n))&&i.push(new it(e,n,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(n)} found`)),i}function Xn(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Xn(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Hn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Yn(t){if(null==t)return{filter:()=>!0,needGeometry:!1};Xn(t)||(t=Jn(t));const e=Nn(t,Hn);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,n,r)=>e.value.evaluate(t,n,{},r),needGeometry:Kn(t)}}function $n(t,e){return t<e?-1:t>e?1:0}function Kn(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Kn(t[e]))return!0;return!1}function Jn(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Qn(t[1],t[2],"=="):"!="===e?nr(Qn(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Qn(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Jn))):"all"===e?["all"].concat(t.slice(1).map(Jn)):"none"===e?["all"].concat(t.slice(1).map(Jn).map(nr)):"in"===e?tr(t[1],t.slice(2)):"!in"===e?nr(tr(t[1],t.slice(2))):"has"===e?er(t[1]):"!has"===e?nr(er(t[1])):"within"!==e||t;var n}function Qn(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function tr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort($n)]]:["filter-in-small",t,["literal",e]]}}function er(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function nr(t){return["!",t]}function rr(t){return Xn(lt(t.value))?Gn(at({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ir(t)}function ir(t){const e=t.value,n=t.key;if("array"!==En(e))return[new it(n,e,`array expected, ${En(e)} found`)];const r=t.styleSpec;let i,o=[];if(e.length<1)return[new it(n,e,"filter array must have at least 1 element")];switch(o=o.concat(Wn({key:`${n}[0]`,value:e[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),st(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===st(e[1])&&o.push(new it(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&o.push(new it(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(i=En(e[1]),"string"!==i&&o.push(new it(`${n}[1]`,e[1],`string expected, ${i} found`)));for(let a=2;a<e.length;a++)i=En(e[a]),"$type"===st(e[1])?o=o.concat(Wn({key:`${n}[${a}]`,value:e[a],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new it(`${n}[${a}]`,e[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let r=1;r<e.length;r++)o=o.concat(ir({key:`${n}[${r}]`,value:e[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=En(e[1]),2!==e.length?o.push(new it(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==i&&o.push(new it(`${n}[1]`,e[1],`string expected, ${i} found`));break;case"within":i=En(e[1]),2!==e.length?o.push(new it(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==i&&o.push(new it(`${n}[1]`,e[1],`object expected, ${i} found`))}return o}function or(t,e){const n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[`${e}_${t.layerType}`];if(!s)return[];const l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return mr({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});const u=t.valueSpec||s[a];if(!u)return[new it(n,o,`unknown property "${a}"`)];let c;if("string"===En(o)&&bn(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new it(n,o,`"${a}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&h.push(new it(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&kn(lt(o))&&"identity"===st(o.type)&&h.push(new it(n,o,'"text-font" does not support identity functions'))),h.concat(mr({key:t.key,value:o,valueSpec:u,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function ar(t){return or(t,"paint")}function sr(t){return or(t,"layout")}function lr(t){let e=[];const n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new it(r,n,'either "type" or "ref" is required'));let a=st(n.type);const s=st(n.ref);if(n.id){const o=st(n.id);for(let a=0;a<t.arrayIndex;a++){const t=i.layers[a];st(t.id)===o&&e.push(new it(r,n.id,`duplicate layer id "${n.id}", previously used at line ${t.id.__line__}`))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in n&&e.push(new it(r,n[t],`"${t}" is prohibited for ref layers`))})),i.layers.forEach((e=>{st(e.id)===s&&(t=e)})),t?t.ref?e.push(new it(r,n.ref,"ref cannot reference another ref layer")):a=st(t.type):e.push(new it(r,n.ref,`ref layer "${s}" not found`))}else if("background"!==a)if(n.source){const t=i.sources&&i.sources[n.source],o=t&&st(t.type);t?"vector"===o&&"raster"===a?e.push(new it(r,n.source,`layer "${n.id}" requires a raster source`)):"raster"===o&&"raster"!==a?e.push(new it(r,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==o||n["source-layer"]?"raster-dem"===o&&"hillshade"!==a?e.push(new it(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!n.paint||!n.paint["line-gradient"]||"geojson"===o&&t.lineMetrics||e.push(new it(r,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new it(r,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new it(r,n.source,`source "${n.source}" not found`))}else e.push(new it(r,n,'missing required property "source"'));return e=e.concat(Un({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>mr({key:`${r}.type`,value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:rr,layout:t=>Un({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>sr(at({layerType:a},t))}}),paint:t=>Un({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>ar(at({layerType:a},t))}})}})),e}function ur(t){const e=t.value,n=t.key,r=En(e);return"string"!==r?[new it(n,e,`string expected, ${r} found`)]:[]}const cr={promoteId:function({key:t,value:e}){if("string"===En(e))return ur({key:t,value:e});{const n=[];for(const r in e)n.push(...ur({key:`${t}.${r}`,value:e[r]}));return n}}};function hr(t){const e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new it(n,e,'"type" is required')];const o=st(e.type);let a;switch(o){case"vector":case"raster":case"raster-dem":return a=Un({key:n,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:t.style,styleSpec:r,objectElementValidators:cr}),a;case"geojson":if(a=Un({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:cr}),e.cluster)for(const t in e.clusterProperties){const[r,i]=e.clusterProperties[t],o="string"==typeof r?[r,["accumulated"],["get",t]]:r;a.push(...Gn({key:`${n}.${t}.map`,value:i,expressionContext:"cluster-map"})),a.push(...Gn({key:`${n}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return a;case"video":return Un({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return Un({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new it(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wn({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function fr(t){const e=t.value,n=t.styleSpec,r=n.light,i=t.style;let o=[];const a=En(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new it("light",e,`object expected, ${a} found`)]),o;for(const s in e){const t=s.match(/^(.*)-transition$/);o=o.concat(t&&r[t[1]]&&r[t[1]].transition?mr({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n}):r[s]?mr({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n}):[new it(s,e[s],`unknown property "${s}"`)])}return o}function pr(t){const e=t.value,n=t.styleSpec,r=n.terrain,i=t.style;let o=[];const a=En(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new it("terrain",e,`object expected, ${a} found`)]),o;for(const s in e)o=o.concat(r[s]?mr({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n}):[new it(s,e[s],`unknown property "${s}"`)]);return o}const dr={"*":()=>[],array:Vn,boolean:function(t){const e=t.value,n=t.key,r=En(e);return"boolean"!==r?[new it(n,e,`boolean expected, ${r} found`)]:[]},number:Zn,color:function(t){const e=t.key,n=t.value,r=En(n);return"string"!==r?[new it(e,n,`color expected, ${r} found`)]:null===Tt(n)?[new it(e,n,`color expected, "${n}" found`)]:[]},constants:ot,enum:Wn,filter:rr,function:qn,layer:lr,object:Un,source:hr,light:fr,terrain:pr,string:ur,formatted:function(t){return 0===ur(t).length?[]:Gn(t)},resolvedImage:function(t){return 0===ur(t).length?[]:Gn(t)},padding:function(t){const e=t.key,n=t.value;if("array"===En(n)){if(n.length<1||n.length>4)return[new it(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const t={type:"number"};let r=[];for(let i=0;i<n.length;i++)r=r.concat(mr({key:`${e}[${i}]`,value:n[i],valueSpec:t}));return r}return Zn({key:e,value:n,valueSpec:{}})}};function mr(t){const e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&kn(st(e))?qn(t):n.expression&&Dn(lt(e))?Gn(t):n.type&&dr[n.type]?dr[n.type](t):Un(at({},t,{valueSpec:n.type?r[n.type]:n}))}function gr(t){const e=t.value,n=t.key,r=ur(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new it(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new it(n,e,'"glyphs" url must include a "{range}" token'))),r}function vr(t,e=rt){let n=[];return n=n.concat(mr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:gr,"*":()=>[]}})),t.constants&&(n=n.concat(ot({key:"constants",value:t.constants,style:t,styleSpec:e}))),yr(n)}function yr(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function _r(t){return function(...e){return yr(t.apply(this,e))}}vr.source=_r(hr),vr.light=_r(fr),vr.terrain=_r(pr),vr.layer=_r(lr),vr.filter=_r(rr),vr.paintProperty=_r(ar),vr.layoutProperty=_r(sr);const xr=vr,br=xr.light,wr=xr.paintProperty,Sr=xr.layoutProperty;function Er(t,e){let n=!1;if(e&&e.length)for(const r of e)t.fire(new et(new Error(r.message))),n=!0;return n}class kr{constructor(t,e,n){const r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(n=i[2]);for(let t=0;t<this.d*this.d;t++){const e=i[3+t],n=i[3+t+1];r.push(e===n?null:i.subarray(e,n))}const o=i[3+r.length+1];this.keys=i.subarray(i[3+r.length],o),this.bboxes=i.subarray(o),this.insert=this._insertReadonly}else{this.d=e+2*n;for(let t=0;t<this.d*this.d;t++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;const i=n/e*t;this.min=-i,this.max=t+i}insert(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,n,r,i,o){this.cells[i].push(o)}query(t,e,n,r,i){const o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);{const o=[];return this._forEachCell(t,e,n,r,this._queryCell,o,{},i),o}}_queryCell(t,e,n,r,i,o,a,s){const l=this.cells[i];if(null!==l){const i=this.keys,u=this.bboxes;for(let c=0;c<l.length;c++){const h=l[c];if(void 0===a[h]){const l=4*h;(s?s(u[l+0],u[l+1],u[l+2],u[l+3]):t<=u[l+2]&&e<=u[l+3]&&n>=u[l+0]&&r>=u[l+1])?(a[h]=!0,o.push(i[h])):a[h]=!1}}}}_forEachCell(t,e,n,r,i,o,a,s){const l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),h=this._convertToCellCoord(r);for(let f=l;f<=c;f++)for(let l=u;l<=h;l++){const u=this.d*l+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(l),this._convertFromCellCoord(f+1),this._convertFromCellCoord(l+1)))&&i.call(this,t,e,n,r,u,o,a,s))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let n=0;for(let o=0;o<this.cells.length;o++)n+=this.cells[o].length;const r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let i=e;for(let o=0;o<t.length;o++){const e=t[o];r[3+o]=i,r.set(e,i),i+=e.length}return r[3+t.length]=i,r.set(this.keys,i),i+=this.keys.length,r[3+t.length+1]=i,r.set(this.bboxes,i),i+=this.bboxes.length,r.buffer}static serialize(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}}static deserialize(t){return new kr(t.buffer)}}const Cr={};function Ir(t,e,n={}){if(Cr[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Cr[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}Ir("Object",Object),Ir("TransferableGridIndex",kr),Ir("Color",Dt),Ir("Error",Error),Ir("AJAXError",V),Ir("ResolvedImage",Bt),Ir("StylePropertyFunction",Bn),Ir("StyleExpression",Rn,{omit:["_evaluator"]}),Ir("ZoomDependentExpression",On),Ir("ZoomConstantExpression",zn),Ir("CompoundExpression",Jt,{omit:["_evaluate"]});for(const bc in dn)dn[bc]._classRegistryKey||Ir(`Expression_${bc}`,dn[bc]);function Tr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Pr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob)return t;if(Tr(t))return e&&e.push(t),t;if(S(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const r of t)n.push(Pr(r,e));return n}if("object"==typeof t){const n=t.constructor,r=n._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class");if(!Cr[r])throw new Error(`${r} is not registered.`);const i=n.serialize?n.serialize(t,e):{};if(n.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in t){if(!t.hasOwnProperty(n))continue;if(Cr[r].omit.indexOf(n)>=0)continue;const o=t[n];i[n]=Cr[r].shallow.indexOf(n)>=0?o:Pr(o,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}throw new Error("can't serialize object of type "+typeof t)}function Ar(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||Tr(t)||S(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Ar);if("object"==typeof t){const e=t.$name||"Object";if(!Cr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=Cr[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const r=Object.create(n.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const n=t[i];r[i]=Cr[e].shallow.indexOf(i)>=0?n:Ar(n)}return r}throw new Error("can't deserialize object of type "+typeof t)}class Mr{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const Lr={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Rr(t){for(const e of t)if(zr(e.charCodeAt(0)))return!0;return!1}function Dr(t){for(const e of t)if(!Nr(e.charCodeAt(0)))return!1;return!0}function Nr(t){return!(Lr.Arabic(t)||Lr["Arabic Supplement"](t)||Lr["Arabic Extended-A"](t)||Lr["Arabic Presentation Forms-A"](t)||Lr["Arabic Presentation Forms-B"](t))}function zr(t){return!(746!==t&&747!==t&&(t<4352||!(Lr["Bopomofo Extended"](t)||Lr.Bopomofo(t)||Lr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Lr["CJK Compatibility Ideographs"](t)||Lr["CJK Compatibility"](t)||Lr["CJK Radicals Supplement"](t)||Lr["CJK Strokes"](t)||!(!Lr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Lr["CJK Unified Ideographs Extension A"](t)||Lr["CJK Unified Ideographs"](t)||Lr["Enclosed CJK Letters and Months"](t)||Lr["Hangul Compatibility Jamo"](t)||Lr["Hangul Jamo Extended-A"](t)||Lr["Hangul Jamo Extended-B"](t)||Lr["Hangul Jamo"](t)||Lr["Hangul Syllables"](t)||Lr.Hiragana(t)||Lr["Ideographic Description Characters"](t)||Lr.Kanbun(t)||Lr["Kangxi Radicals"](t)||Lr["Katakana Phonetic Extensions"](t)||Lr.Katakana(t)&&12540!==t||!(!Lr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Lr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Lr["Unified Canadian Aboriginal Syllabics"](t)||Lr["Unified Canadian Aboriginal Syllabics Extended"](t)||Lr["Vertical Forms"](t)||Lr["Yijing Hexagram Symbols"](t)||Lr["Yi Syllables"](t)||Lr["Yi Radicals"](t))))}function Or(t){return!(zr(t)||function(t){return!!(Lr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Lr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Lr["Letterlike Symbols"](t)||Lr["Number Forms"](t)||Lr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Lr["Control Pictures"](t)&&9251!==t||Lr["Optical Character Recognition"](t)||Lr["Enclosed Alphanumerics"](t)||Lr["Geometric Shapes"](t)||Lr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Lr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Lr["CJK Symbols and Punctuation"](t)||Lr.Katakana(t)||Lr["Private Use Area"](t)||Lr["CJK Compatibility Forms"](t)||Lr["Small Form Variants"](t)||Lr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Fr(t){return t>=1424&&t<=2303||Lr["Arabic Presentation Forms-A"](t)||Lr["Arabic Presentation Forms-B"](t)}function Br(t,e){return!(!e&&Fr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Lr.Khmer(t))}function jr(t){for(const e of t)if(Fr(e.charCodeAt(0)))return!0;return!1}const Ur="deferred",Vr="loading",Zr="loaded";let qr=null,Gr="unavailable",Wr=null;const Xr=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Gr="error"),qr&&qr(t)};function Hr(){Yr.fire(new tt("pluginStateChange",{pluginStatus:Gr,pluginURL:Wr}))}const Yr=new nt,$r=function(){return Gr},Kr=function(){if(Gr!==Ur||!Wr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gr=Vr,Hr(),Wr&&W({url:Wr},(t=>{t?Xr(t):(Gr=Zr,Hr())}))},Jr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Gr===Zr||null!=Jr.applyArabicShaping,isLoading:()=>Gr===Vr,setState(t){if(!v())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Gr=t.pluginStatus,Wr=t.pluginURL},isParsed(){if(!v())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Jr.applyArabicShaping&&null!=Jr.processBidirectionalText&&null!=Jr.processStyledBidirectionalText},getPluginURL(){if(!v())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Wr}};class Qr{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mr,this.transition={})}isSupportedScript(t){return function(t,e){for(const n of t)if(!Br(n.charCodeAt(0),e))return!1;return!0}(t,Jr.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}class ti{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(kn(t))return new Bn(t,e);if(Dn(t)){const n=Fn(t,e);if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return n.value}{let n=t;return"color"===e.type&&"string"==typeof t?n=Dt.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)||(n=Ft.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class ei{constructor(t){this.property=t,this.value=new ti(t,void 0)}transitioned(t,e){return new ri(this.property,this.value,e,s({},t.transition,this.transition),t.now)}untransitioned(){return new ri(this.property,this.value,null,{},0)}}class ni{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return f(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ei(this._values[t].property)),this._values[t].value=new ti(this._values[t].property,null===e?void 0:f(e))}getTransition(t){return f(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ei(this._values[t].property)),this._values[t].transition=f(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const r=this.getTransition(e);void 0!==r&&(t[`${e}-transition`]=r)}return t}transitioned(t,e){const n=new ii(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(t,e._values[r]);return n}untransitioned(){const t=new ii(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class ri{constructor(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const r=t.now||0,i=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(t,e,n);{const a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),i,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(a))}}return i}}class ii{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const r=new si(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(t,e,n);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class oi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return f(this._values[t].value)}setValue(t,e){this._values[t]=new ti(this._values[t].property,null===e?void 0:f(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const r=new si(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(t,e,n);return r}}class ai{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)}}class si{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class li{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,n){const r=Ce[this.specification.type];return r?r(t,e,n):t}}class ui{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,r){return new ai(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new ai(this,{kind:"constant",value:void 0},t.parameters);const r=Ce[this.specification.type];return r?new ai(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,r,i,o){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i,o)}}class ci extends ui{possiblyEvaluate(t,e,n,r){if(void 0===t.value)return new ai(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},n,r),o="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(o,o,o,e);return new ai(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new ai(this,{kind:"constant",value:n},e)}return new ai(this,t.expression,e)}evaluate(t,e,n,r,i,o){if("source"===t.kind){const a=t.evaluate(e,n,r,i,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value}_calculate(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class hi{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,r){if(void 0!==t.value){if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},n,r);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new Qr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Qr(Math.floor(e.zoom),e)),t.expression.evaluate(new Qr(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class fi{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)}interpolate(){return!1}}class pi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const r=this.defaultPropertyValues[e]=new ti(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new ei(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}}Ir("DataDrivenProperty",ui),Ir("DataConstantProperty",li),Ir("CrossFadedDataDrivenProperty",ci),Ir("CrossFadedProperty",hi),Ir("ColorRampProperty",fi);const di="-transition";class mi extends nt{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new oi(e.layout)),e.paint)){this._transitionablePaint=new ni(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new si(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,n={}){null!=e&&this._validate(Sr,`layers.${this.id}.layout.${t}`,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(di)?this._transitionablePaint.getTransition(t.slice(0,-di.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,n={}){if(null!=e&&this._validate(wr,`layers.${this.id}.paint.${t}`,t,e,n))return!1;if(t.endsWith(di))return this._transitionablePaint.setTransition(t.slice(0,-di.length),e||void 0),!1;{const n=this._transitionablePaint._values[t],r="cross-faded-data-driven"===n.property.specification["property-type"],i=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const a=this._transitionablePaint._values[t].value;return a.isDataDriven()||i||r||this._handleOverridablePaintPropertyUpdate(t,o,a)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),h(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,n,r,i={}){return(!i||!1!==i.validate)&&Er(this,t.call(xr,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:rt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof ai&&bn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const gi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class vi{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class yi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function _i(t,e=1){let n=0,r=0;return{members:t.map((t=>{const i=gi[t.type].BYTES_PER_ELEMENT,o=n=xi(n,Math.max(e,i)),a=t.components||1;return r=Math.max(r,i),n+=i*a,{name:t.name,type:t.type,components:a,offset:o}})),size:xi(n,Math.max(r,e)),alignment:e}}function xi(t,e){return Math.ceil(t/e)*e}class bi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t}}bi.prototype.bytesPerElement=4,Ir("StructArrayLayout2i4",bi);class wi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t}}wi.prototype.bytesPerElement=8,Ir("StructArrayLayout4i8",wi);class Si extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}emplace(t,e,n,r,i,o,a){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t}}Si.prototype.bytesPerElement=12,Ir("StructArrayLayout2i4i12",Si);class Ei extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}emplace(t,e,n,r,i,o,a){const s=4*t,l=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[l+4]=r,this.uint8[l+5]=i,this.uint8[l+6]=o,this.uint8[l+7]=a,t}}Ei.prototype.bytesPerElement=8,Ir("StructArrayLayout2i4ub8",Ei);class ki extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t}}ki.prototype.bytesPerElement=8,Ir("StructArrayLayout2f8",ki);class Ci extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,a,s,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,r,i,o,a,s,l,u)}emplace(t,e,n,r,i,o,a,s,l,u,c){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=r,this.uint16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,t}}Ci.prototype.bytesPerElement=20,Ir("StructArrayLayout10ui20",Ci);class Ii extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,a,s,l,u,c,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,e,n,r,i,o,a,s,l,u,c,h)}emplace(t,e,n,r,i,o,a,s,l,u,c,h,f){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=r,this.int16[p+3]=i,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=u,this.int16[p+9]=c,this.int16[p+10]=h,this.int16[p+11]=f,t}}Ii.prototype.bytesPerElement=24,Ir("StructArrayLayout4i4ui4i24",Ii);class Ti extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t}}Ti.prototype.bytesPerElement=12,Ir("StructArrayLayout3f12",Ti);class Pi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Pi.prototype.bytesPerElement=4,Ir("StructArrayLayout1ul4",Pi);class Ai extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,a,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s,l)}emplace(t,e,n,r,i,o,a,s,l,u){const c=10*t,h=5*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.int16[c+4]=o,this.int16[c+5]=a,this.uint32[h+3]=s,this.uint16[c+8]=l,this.uint16[c+9]=u,t}}Ai.prototype.bytesPerElement=20,Ir("StructArrayLayout6i1ul2ui20",Ai);class Mi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)}emplace(t,e,n,r,i,o,a){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t}}Mi.prototype.bytesPerElement=12,Ir("StructArrayLayout2i2i2i12",Mi);class Li extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r,i)}emplace(t,e,n,r,i,o){const a=4*t,s=8*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=r,this.int16[s+6]=i,this.int16[s+7]=o,t}}Li.prototype.bytesPerElement=16,Ir("StructArrayLayout2f1f2i16",Li);class Ri extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=r,this.float32[a+2]=i,t}}Ri.prototype.bytesPerElement=12,Ir("StructArrayLayout2ub2f12",Ri);class Di extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t}}Di.prototype.bytesPerElement=6,Ir("StructArrayLayout3ui6",Di);class Ni extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g)}emplace(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v){const y=24*t,_=12*t,x=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=r,this.uint16[y+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[y+10]=l,this.uint16[y+11]=u,this.uint16[y+12]=c,this.float32[_+7]=h,this.float32[_+8]=f,this.uint8[x+36]=p,this.uint8[x+37]=d,this.uint8[x+38]=m,this.uint32[_+10]=g,this.int16[y+22]=v,t}}Ni.prototype.bytesPerElement=48,Ir("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ni);class zi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I){const T=this.length;return this.resize(T+1),this.emplace(T,t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I)}emplace(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I,T){const P=34*t,A=17*t;return this.int16[P+0]=e,this.int16[P+1]=n,this.int16[P+2]=r,this.int16[P+3]=i,this.int16[P+4]=o,this.int16[P+5]=a,this.int16[P+6]=s,this.int16[P+7]=l,this.uint16[P+8]=u,this.uint16[P+9]=c,this.uint16[P+10]=h,this.uint16[P+11]=f,this.uint16[P+12]=p,this.uint16[P+13]=d,this.uint16[P+14]=m,this.uint16[P+15]=g,this.uint16[P+16]=v,this.uint16[P+17]=y,this.uint16[P+18]=_,this.uint16[P+19]=x,this.uint16[P+20]=b,this.uint16[P+21]=w,this.uint16[P+22]=S,this.uint32[A+12]=E,this.float32[A+13]=k,this.float32[A+14]=C,this.float32[A+15]=I,this.float32[A+16]=T,t}}zi.prototype.bytesPerElement=68,Ir("StructArrayLayout8i15ui1ul4f68",zi);class Oi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Oi.prototype.bytesPerElement=4,Ir("StructArrayLayout1f4",Oi);class Fi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t}}Fi.prototype.bytesPerElement=6,Ir("StructArrayLayout3i6",Fi);class Bi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=4*t;return this.uint32[2*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=r,t}}Bi.prototype.bytesPerElement=8,Ir("StructArrayLayout1ul2ui8",Bi);class ji extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t}}ji.prototype.bytesPerElement=4,Ir("StructArrayLayout2ui4",ji);class Ui extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Ui.prototype.bytesPerElement=2,Ir("StructArrayLayout1ui2",Ui);class Vi extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t}}Vi.prototype.bytesPerElement=16,Ir("StructArrayLayout4f16",Vi);class Zi extends vi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new k(this.anchorPointX,this.anchorPointY)}}Zi.prototype.size=20;class qi extends Ai{get(t){return new Zi(this,t)}}Ir("CollisionBoxArray",qi);class Gi extends vi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Gi.prototype.size=48;class Wi extends Ni{get(t){return new Gi(this,t)}}Ir("PlacedSymbolArray",Wi);class Xi extends vi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Xi.prototype.size=68;class Hi extends zi{get(t){return new Xi(this,t)}}Ir("SymbolInstanceArray",Hi);class Yi extends Oi{getoffsetX(t){return this.float32[1*t+0]}}Ir("GlyphOffsetArray",Yi);class $i extends Fi{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ir("SymbolLineVertexArray",$i);class Ki extends vi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ki.prototype.size=8;class Ji extends Bi{get(t){return new Ki(this,t)}}Ir("FeatureIndexArray",Ji);class Qi extends bi{}class to extends bi{}class eo extends bi{}class no extends Si{}class ro extends Ei{}class io extends ki{}class oo extends Ci{}class ao extends Ii{}class so extends Ti{}class lo extends Pi{}class uo extends Mi{}class co extends Ri{}class ho extends Di{}class fo extends ji{}const po=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:mo}=po;class go{constructor(t=[]){this.segments=t}prepareSegment(t,e,n,r){let i=this.segments[this.segments.length-1];return t>go.MAX_VERTEX_ARRAY_LENGTH&&d(`Max vertices per segment is ${go.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!i||i.vertexLength+t>go.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,r){return new go([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}function vo(t,e){return 256*(t=o(Math.floor(t),0,255))+o(Math.floor(e),0,255)}go.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ir("SegmentVector",go);const yo=_i([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var _o={exports:{}},xo={exports:{}};xo.exports=function(t,e){var n,r,i,o,a,s,l,u;for(r=t.length-(n=3&t.length),i=e,a=3432918353,s=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};var bo={exports:{}};bo.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};var wo=xo.exports,So=bo.exports;_o.exports=wo,_o.exports.murmur3=wo,_o.exports.murmur2=So;class Eo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,r){this.ids.push(ko(t)),this.positions.push(e,n,r)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=ko(t);let n=0,r=this.ids.length-1;for(;n<r;){const t=n+r>>1;this.ids[t]>=e?r=t:n=t+1}const i=[];for(;this.ids[n]===e;)i.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return i}static serialize(t,e){const n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return Co(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}}static deserialize(t){const e=new Eo;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ko(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:_o.exports(String(t))}function Co(t,e,n,r){for(;n<r;){const i=t[n+r>>1];let o=n-1,a=r+1;for(;;){do{o++}while(t[o]<i);do{a--}while(t[a]>i);if(o>=a)break;Io(t,o,a),Io(e,3*o,3*a),Io(e,3*o+1,3*a+1),Io(e,3*o+2,3*a+2)}a-n<r-a?(Co(t,e,n,a),n=a+1):(Co(t,e,a+1,r),r=a)}}function Io(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}Ir("FeaturePositionMap",Eo);class To{constructor(t,e){this.gl=t.gl,this.location=e}}class Po extends To{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ao extends To{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Mo extends To{constructor(t,e){super(t,e),this.current=Dt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Lo=new Float32Array(16);function Ro(t){return[vo(255*t.r,255*t.g),vo(255*t.b,255*t.a)]}class Do{constructor(t,e,n){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new Mo(t,e):new Po(t,e)}}class No{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,n,r){const i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&t.set(i)}getBinding(t,e,n){return"u_pattern"===n.substr(0,9)?new Ao(t,e):new Po(t,e)}}class zo{constructor(t,e,n,r){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,n,r,i){const o=this.paintVertexArray.length,a=this.expression.evaluate(new Qr(0),e,{},r,[],i);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)}updatePaintArray(t,e,n,r){const i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(t,e,i)}_setPaintValue(t,e,n){if("color"===this.type){const r=Ro(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oo{constructor(t,e,n,r,i,o){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(t,e,n,r,i){const o=this.expression.evaluate(new Qr(this.zoom),e,{},r,[],i),a=this.expression.evaluate(new Qr(this.zoom+1),e,{},r,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)}updatePaintArray(t,e,n,r){const i=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(t,e,i,o)}_setPaintValue(t,e,n,r){if("color"===this.type){const i=Ro(n),o=Ro(r);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1],o[0],o[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=o(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(r)}getBinding(t,e,n){return new Po(t,e)}}class Fo{constructor(t,e,n,r,i,o){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=r,this.layerId=o,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(t,e,n){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)}_setPaintValues(t,e,n,r){if(!r||!n)return;const{min:i,mid:o,max:a}=n,s=r[i],l=r[o],u=r[a];if(s&&l&&u)for(let c=t;c<e;c++)this.zoomInPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,yo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,yo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Bo{constructor(t,e,n){this.binders={},this._buffers=[];const r=[];for(const i in t.paint._values){if(!n(i))continue;const o=t.paint.get(i);if(!(o instanceof ai&&bn(o.property.specification)))continue;const a=Uo(i,t.type),s=o.value,l=o.property.specification.type,u=o.property.useIntegerZoom,c=o.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===s.kind)this.binders[i]=h?new No(s.value,a):new Do(s.value,a,l),r.push(`/u_${i}`);else if("source"===s.kind||h){const n=Vo(i,l,"source");this.binders[i]=h?new Fo(s,l,u,e,n,t.id):new zo(s,a,l,n),r.push(`/a_${i}`)}else{const t=Vo(i,l,"composite");this.binders[i]=new Oo(s,a,l,u,e,t),r.push(`/z_${i}`)}}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof zo||e instanceof Oo?e.maxValue:0}populatePaintArrays(t,e,n,r,i){for(const o in this.binders){const a=this.binders[o];(a instanceof zo||a instanceof Oo||a instanceof Fo)&&a.populatePaintArray(t,e,n,r,i)}}setConstantPatternPositions(t,e){for(const n in this.binders){const r=this.binders[n];r instanceof No&&r.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,r,i){let o=!1;for(const a in t){const s=e.getPositions(a);for(const e of s){const s=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof zo||l instanceof Oo||l instanceof Fo)&&!0===l.expression.isStateDependent){const u=r.paint.get(n);l.expression=u.value,l.updatePaintArray(e.start,e.end,s,t[a],i),o=!0}}}}return o}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Do||n instanceof No)&&t.push(...n.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof zo||n instanceof Oo)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name);else if(n instanceof Fo)for(let e=0;e<yo.members.length;e++)t.push(yo.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Do||n instanceof No||n instanceof Oo)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Do||i instanceof No||i instanceof Oo)for(const o of i.uniformNames)if(e[o]){const a=i.getBinding(t,e[o],o);n.push({name:o,property:r,binding:a})}}return n}setUniforms(t,e,n,r){for(const{name:i,property:o,binding:a}of e)this.binders[o].setUniform(a,r,n.get(o),i)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof Fo){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof zo||n instanceof Oo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof zo||n instanceof Oo||n instanceof Fo)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof zo||e instanceof Oo||e instanceof Fo)&&e.destroy()}}}class jo{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new Bo(r,e,n);this.needsUpload=!1,this._featureMap=new Eo,this._bufferOffset=0}populatePaintArrays(t,e,n,r,i,o){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,r,i,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,r){for(const i of n)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(t,this._featureMap,e,i,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Uo(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function Vo(t,e,n){const r={color:{source:ki,composite:Vi},number:{source:Oi,composite:ki}},i=function(t){return{"line-pattern":{source:oo,composite:oo},"fill-pattern":{source:oo,composite:oo},"fill-extrusion-pattern":{source:oo,composite:oo}}[t]}(t);return i&&i[n]||r[e][n]}Ir("ConstantBinder",Do),Ir("CrossFadedConstantBinder",No),Ir("SourceExpressionBinder",zo),Ir("CrossFadedCompositeBinder",Fo),Ir("CompositeExpressionBinder",Oo),Ir("ProgramConfiguration",Bo,{omit:["_buffers"]}),Ir("ProgramConfigurationSet",jo);var Zo=8192;const qo=Math.pow(2,14)-1,Go=-qo-1;function Wo(t){const e=Zo/t.extent,n=t.loadGeometry();for(let r=0;r<n.length;r++){const t=n[r];for(let n=0;n<t.length;n++){const r=t[n],i=Math.round(r.x*e),a=Math.round(r.y*e);r.x=o(i,Go,qo),r.y=o(a,Go,qo),(i<r.x||i>r.x+1||a<r.y||a>r.y+1)&&d("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Xo(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Wo(t):[]}}function Ho(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}class Yo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new to,this.indexArray=new ho,this.segments=new go,this.programConfigurations=new jo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){const r=this.layers[0],i=[];let o=null,a=!1;"circle"===r.type&&(o=r.layout.get("circle-sort-key"),a=!o.isConstant());for(const{feature:s,id:l,index:u,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,e=Xo(s,t);if(!this.layers[0]._featureFilter.filter(new Qr(this.zoom),e,n))continue;const r=a?o.evaluate(e,{},n):void 0,h={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:t?e.geometry:Wo(s),patterns:{},sortKey:r};i.push(h)}a&&i.sort(((t,e)=>t.sortKey-e.sortKey));for(const s of i){const{geometry:r,index:i,sourceLayerIndex:o}=s,a=t[i].feature;this.addFeature(s,r,i,n),e.featureIndex.insert(a,r,i,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,r){for(const i of e)for(const e of i){const n=e.x,r=e.y;if(n<0||n>=Zo||r<0||r>=Zo)continue;const i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),o=i.vertexLength;Ho(this.layoutVertexArray,n,r,-1,-1),Ho(this.layoutVertexArray,n,r,1,-1),Ho(this.layoutVertexArray,n,r,1,1),Ho(this.layoutVertexArray,n,r,-1,1),this.indexArray.emplaceBack(o,o+1,o+2),this.indexArray.emplaceBack(o,o+3,o+2),i.vertexLength+=4,i.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r)}}function $o(t,e){for(let n=0;n<t.length;n++)if(oa(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(oa(t,e[n]))return!0;return!!ta(t,e)}function Ko(t,e,n){return!!oa(t,e)||!!na(e,t,n)}function Jo(t,e){if(1===t.length)return ia(e,t[0]);for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++)if(oa(t,r[e]))return!0}for(let n=0;n<t.length;n++)if(ia(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(ta(t,e[n]))return!0;return!1}function Qo(t,e,n){if(t.length>1){if(ta(t,e))return!0;for(let r=0;r<e.length;r++)if(na(e[r],t,n))return!0}for(let r=0;r<t.length;r++)if(na(t[r],e,n))return!0;return!1}function ta(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const r=t[n],i=t[n+1];for(let t=0;t<e.length-1;t++)if(ea(r,i,e[t],e[t+1]))return!0}return!1}function ea(t,e,n,r){return m(t,n,r)!==m(e,n,r)&&m(t,e,n)!==m(t,e,r)}function na(t,e,n){const r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(let i=1;i<e.length;i++)if(ra(t,e[i-1],e[i])<r)return!0;return!1}function ra(t,e,n){const r=e.distSqr(n);if(0===r)return t.distSqr(e);const i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(i<0?e:i>1?n:n.sub(e)._mult(i)._add(e))}function ia(t,e){let n,r,i,o=!1;for(let a=0;a<t.length;a++){n=t[a];for(let t=0,a=n.length-1;t<n.length;a=t++)r=n[t],i=n[a],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o)}return o}function oa(t,e){let n=!1;for(let r=0,i=t.length-1;r<t.length;i=r++){const o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function aa(t,e,n){const r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;const o=m(t,e,n[0]);return o!==m(t,e,n[1])||o!==m(t,e,n[2])||o!==m(t,e,n[3])}function sa(t,e,n){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function la(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ua(t,e,n,r,i){if(!e[0]&&!e[1])return t;const o=k.convert(e)._mult(i);"viewport"===n&&o._rotate(-r);const a=[];for(let s=0;s<t.length;s++)a.push(t[s].sub(o));return a}Ir("CircleBucket",Yo,{omit:["layers"]});const ca=new pi({"circle-sort-key":new ui(rt.layout_circle["circle-sort-key"])});var ha={paint:new pi({"circle-radius":new ui(rt.paint_circle["circle-radius"]),"circle-color":new ui(rt.paint_circle["circle-color"]),"circle-blur":new ui(rt.paint_circle["circle-blur"]),"circle-opacity":new ui(rt.paint_circle["circle-opacity"]),"circle-translate":new li(rt.paint_circle["circle-translate"]),"circle-translate-anchor":new li(rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new li(rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new li(rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ui(rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ui(rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ui(rt.paint_circle["circle-stroke-opacity"])}),layout:ca},fa=1e-6,pa="undefined"!=typeof Float32Array?Float32Array:Array;function da(){var t=new pa(9);return pa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ma(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ga(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*r+x*s+b*h+w*m,t[1]=_*i+x*l+b*f+w*g,t[2]=_*o+x*u+b*p+w*v,t[3]=_*a+x*c+b*d+w*y,t[4]=(_=n[4])*r+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,t[5]=_*i+x*l+b*f+w*g,t[6]=_*o+x*u+b*p+w*v,t[7]=_*a+x*c+b*d+w*y,t[8]=(_=n[8])*r+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,t[9]=_*i+x*l+b*f+w*g,t[10]=_*o+x*u+b*p+w*v,t[11]=_*a+x*c+b*d+w*y,t[12]=(_=n[12])*r+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,t[13]=_*i+x*l+b*f+w*g,t[14]=_*o+x*u+b*p+w*v,t[15]=_*a+x*c+b*d+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var va,ya=ga;function _a(){var t=new pa(3);return pa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xa(t,e,n){var r=new pa(3);return r[0]=t,r[1]=e,r[2]=n,r}function ba(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function wa(){var t=new pa(4);return pa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Sa(t,e){const n=ba([],[t.x,t.y,0,1],e);return new k(n[0]/n[3],n[1]/n[3])}_a(),va=new pa(4),pa!=Float32Array&&(va[0]=0,va[1]=0,va[2]=0,va[3]=0),_a(),xa(1,0,0),xa(0,1,0),wa(),wa(),da(),function(){var t;t=new pa(2),pa!=Float32Array&&(t[0]=0,t[1]=0)}();class Ea extends Yo{}Ir("HeatmapBucket",Ea,{omit:["layers"]});var ka={paint:new pi({"heatmap-radius":new ui(rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ui(rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new li(rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fi(rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new li(rt.paint_heatmap["heatmap-opacity"])})};function Ca(t,{width:e,height:n},r,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*n*r)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${e*n*r}`)}else i=new Uint8Array(e*n*r);return t.width=e,t.height=n,t.data=i,t}function Ia(t,{width:e,height:n},r){if(e===t.width&&n===t.height)return;const i=Ca({},{width:e,height:n},r);Ta(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},r),t.width=e,t.height=n,t.data=i.data}function Ta(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){const u=((n.y+l)*t.width+n.x)*o,c=((r.y+l)*e.width+r.x)*o;for(let t=0;t<i.width*o;t++)s[c+t]=a[u+t]}return e}class Pa{constructor(t,e){Ca(this,t,1,e)}resize(t){Ia(this,t,1)}clone(){return new Pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,i){Ta(t,e,n,r,i,1)}}class Aa{constructor(t,e){Ca(this,t,4,e)}resize(t){Ia(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Aa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,i){Ta(t,e,n,r,i,4)}}function Ma(t){const e={},n=t.resolution||256,r=t.clips?t.clips.length:1,i=t.image||new Aa({width:n,height:r});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const o=(n,r,o)=>{e[t.evaluationKey]=o;const a=t.expression.evaluate(e);i.data[n+r+0]=Math.floor(255*a.r/a.a),i.data[n+r+1]=Math.floor(255*a.g/a.a),i.data[n+r+2]=Math.floor(255*a.b/a.a),i.data[n+r+3]=Math.floor(255*a.a)};if(t.clips)for(let a=0,s=0;a<r;++a,s+=4*n)for(let e=0,r=0;e<n;e++,r+=4){const i=e/(n-1),{start:l,end:u}=t.clips[a];o(s,r,l*(1-i)+u*i)}else for(let a=0,s=0;a<n;a++,s+=4)o(0,s,a/(n-1));return i}Ir("AlphaImage",Pa),Ir("RGBAImage",Aa);var La={paint:new pi({"hillshade-illumination-direction":new li(rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new li(rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new li(rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new li(rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new li(rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new li(rt.paint_hillshade["hillshade-accent-color"])})};const Ra=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:Da}=Ra;var Na={exports:{}};function za(t,e,n){n=n||2;var r,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,f=Oa(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;if(c&&(f=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Oa(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(Ha(a));for(s.sort(qa),i=0;i<s.length;i++)n=Ga(s[i],n);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(l=t[d+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-i))?32767/u:0}return Ba(f,p,n,r,i,u,0),p}function Oa(t,e,n,r,i){var o,a;if(i===ss(t,e,n,r)>0)for(o=e;o<n;o+=r)a=is(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=is(o,t[o],t[o+1],a);return a&&Ja(a,a.next)&&(os(a),a=a.next),a}function Fa(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Ja(r,r.next)&&0!==Ka(r.prev,r,r.next))r=r.next;else{if(os(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ba(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=Xa(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,r,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Ua(t,r,i,o):ja(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),os(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?Ba(t=Va(Fa(t),e,n),e,n,r,i,o,2):2===a&&Za(t,e,n,r,i,o):Ba(Fa(t),e,n,r,i,o,1);break}}}function ja(t){var e=t.prev,n=t,r=t.next;if(Ka(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,l=n.y,u=r.y,c=i<o?i<a?i:a:o<a?o:a,h=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,p=s>l?s>u?s:u:l>u?l:u,d=r.next;d!==e;){if(d.x>=c&&d.x<=f&&d.y>=h&&d.y<=p&&Ya(i,s,o,l,a,u,d.x,d.y)&&Ka(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function Ua(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Ka(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,h=o.y,f=a.y,p=s<l?s<u?s:u:l<u?l:u,d=c<h?c<f?c:f:h<f?h:f,m=s>l?s>u?s:u:l>u?l:u,g=c>h?c>f?c:f:h>f?h:f,v=Xa(p,d,e,n,r),y=Xa(m,g,e,n,r),_=t.prevZ,x=t.nextZ;_&&_.z>=v&&x&&x.z<=y;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&Ya(s,c,l,h,u,f,_.x,_.y)&&Ka(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&Ya(s,c,l,h,u,f,x.x,x.y)&&Ka(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&Ya(s,c,l,h,u,f,_.x,_.y)&&Ka(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&Ya(s,c,l,h,u,f,x.x,x.y)&&Ka(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Va(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Ja(i,o)&&Qa(i,r,r.next,o)&&ns(i,o)&&ns(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),os(r),os(r.next),r=t=o),r=r.next}while(r!==t);return Fa(r)}function Za(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&$a(a,s)){var l=rs(a,s);return a=Fa(a,a.next),l=Fa(l,l.next),Ba(a,e,n,r,i,o,0),void Ba(l,e,n,r,i,o,0)}s=s.next}a=a.next}while(a!==t)}function qa(t,e){return t.x-e.x}function Ga(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,u=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&Ya(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),ns(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&Wa(n,r)))&&(n=r,f=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var r=rs(n,t);return Fa(r,r.next),Fa(n,n.next)}function Wa(t,e){return Ka(t.prev,t,e.prev)<0&&Ka(e.next,t,t.next)<0}function Xa(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ha(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Ya(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function $a(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Qa(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(ns(t,e)&&ns(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Ka(t.prev,t,e.prev)||Ka(t,e.prev,e))||Ja(t,e)&&Ka(t.prev,t,t.next)>0&&Ka(e.prev,e,e.next)>0)}function Ka(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ja(t,e){return t.x===e.x&&t.y===e.y}function Qa(t,e,n,r){var i=es(Ka(t,e,n)),o=es(Ka(t,e,r)),a=es(Ka(n,r,t)),s=es(Ka(n,r,e));return i!==o&&a!==s||!(0!==i||!ts(t,n,e))||!(0!==o||!ts(t,r,e))||!(0!==a||!ts(n,t,r))||!(0!==s||!ts(n,e,r))}function ts(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function es(t){return t>0?1:t<0?-1:0}function ns(t,e){return Ka(t.prev,t,t.next)<0?Ka(t,e,t.next)>=0&&Ka(t,t.prev,e)>=0:Ka(t,e,t.prev)<0||Ka(t,t.next,e)<0}function rs(t,e){var n=new as(t.i,t.x,t.y),r=new as(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function is(t,e,n,r){var i=new as(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function os(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function as(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ss(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function ls(t,e,n,r,i){us(t,e,n||0,r||t.length-1,i||hs)}function us(t,e,n,r,i){for(;r>n;){if(r-n>600){var o=r-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);us(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(r,Math.floor(e+(o-a)*l/o+u)),i)}var c=t[e],h=n,f=r;for(cs(t,n,e),i(t[r],c)>0&&cs(t,n,r);h<f;){for(cs(t,h,f),h++,f--;i(t[h],c)<0;)h++;for(;i(t[f],c)>0;)f--}0===i(t[n],c)?cs(t,n,f):cs(t,++f,r),f<=e&&(n=f+1),e<=f&&(r=f-1)}}function cs(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function hs(t,e){return t<e?-1:t>e?1:0}function fs(t,e){const n=t.length;if(n<=1)return[t];const r=[];let i,o;for(let a=0;a<n;a++){const e=g(t[a]);0!==e&&(t[a].area=Math.abs(e),void 0===o&&(o=e<0),o===e<0?(i&&r.push(i),i=[t[a]]):i.push(t[a]))}if(i&&r.push(i),e>1)for(let a=0;a<r.length;a++)r[a].length<=e||(ls(r[a],e,1,r[a].length-1,ps),r[a]=r[a].slice(0,e));return r}function ps(t,e){return e.area-t.area}function ds(t,e,n){const r=n.patternDependencies;let i=!1;for(const o of e){const e=o.paint.get(`${t}-pattern`);e.isConstant()||(i=!0);const n=e.constantOr(null);n&&(i=!0,r[n.to]=!0,r[n.from]=!0)}return i}function ms(t,e,n,r,i){const o=i.patternDependencies;for(const a of e){const e=a.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r-1},n,{},i.availableImages),s=e.evaluate({zoom:r},n,{},i.availableImages),l=e.evaluate({zoom:r+1},n,{},i.availableImages);t=t&&t.name?t.name:t,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,o[t]=!0,o[s]=!0,o[l]=!0,n.patterns[a.id]={min:t,mid:s,max:l}}}return n}Na.exports=za,Na.exports.default=za,za.deviation=function(t,e,n,r){var i=e&&e.length,o=Math.abs(ss(t,0,i?e[0]*n:t.length,n));if(i)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(ss(t,e[a]*n,a<s-1?e[a+1]*n:t.length,n));var l=0;for(a=0;a<r.length;a+=3){var u=r[a]*n,c=r[a+1]*n,h=r[a+2]*n;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},za.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&n.holes.push(r+=t[i-1].length)}return n};class gs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new eo,this.indexArray=new ho,this.indexArray2=new fo,this.programConfigurations=new jo(t.layers,t.zoom),this.segments=new go,this.segments2=new go,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=ds("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),i=!r.isConstant(),o=[];for(const{feature:a,id:s,index:l,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Xo(a,t);if(!this.layers[0]._featureFilter.filter(new Qr(this.zoom),c,n))continue;const h=i?r.evaluate(c,{},n,e.availableImages):void 0,f={id:s,properties:a.properties,type:a.type,sourceLayerIndex:u,index:l,geometry:t?c.geometry:Wo(a),patterns:{},sortKey:h};o.push(f)}i&&o.sort(((t,e)=>t.sortKey-e.sortKey));for(const a of o){const{geometry:r,index:i,sourceLayerIndex:o}=a;if(this.hasPattern){const t=ms("fill",this.layers,a,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(a,r,i,n,{});e.featureIndex.insert(t[i].feature,r,i,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Da),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,r,i){for(const o of fs(e,500)){let t=0;for(const s of o)t+=s.length;const e=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=e.vertexLength,r=[],i=[];for(const s of o){if(0===s.length)continue;s!==o[0]&&i.push(r.length/2);const t=this.segments2.prepareSegment(s.length,this.layoutVertexArray,this.indexArray2),e=t.vertexLength;this.layoutVertexArray.emplaceBack(s[0].x,s[0].y),this.indexArray2.emplaceBack(e+s.length-1,e),r.push(s[0].x),r.push(s[0].y);for(let n=1;n<s.length;n++)this.layoutVertexArray.emplaceBack(s[n].x,s[n].y),this.indexArray2.emplaceBack(e+n-1,e+n),r.push(s[n].x),r.push(s[n].y);t.vertexLength+=s.length,t.primitiveLength+=s.length}const a=Na.exports(r,i);for(let o=0;o<a.length;o+=3)this.indexArray.emplaceBack(n+a[o],n+a[o+1],n+a[o+2]);e.vertexLength+=t,e.primitiveLength+=a.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}}Ir("FillBucket",gs,{omit:["layers","patternFeatures"]});const vs=new pi({"fill-sort-key":new ui(rt.layout_fill["fill-sort-key"])});var ys={paint:new pi({"fill-antialias":new li(rt.paint_fill["fill-antialias"]),"fill-opacity":new ui(rt.paint_fill["fill-opacity"]),"fill-color":new ui(rt.paint_fill["fill-color"]),"fill-outline-color":new ui(rt.paint_fill["fill-outline-color"]),"fill-translate":new li(rt.paint_fill["fill-translate"]),"fill-translate-anchor":new li(rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ci(rt.paint_fill["fill-pattern"])}),layout:vs};const _s=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),xs=_i([{name:"a_centroid",components:2,type:"Int16"}],4),{members:bs}=_s;var ws={},Ss=k,Es=ks;function ks(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(Cs,this,e)}function Cs(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Is(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)r+=((n=t[a]).x-(e=t[i]).x)*(e.y+n.y);return r}ks.types=["Unknown","Point","LineString","Polygon"],ks.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,i=0,o=0,a=0,s=[];t.pos<n;){if(i<=0){var l=t.readVarint();r=7&l,i=l>>3}if(i--,1===r||2===r)o+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e.push(new Ss(o,a));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&s.push(e),s},ks.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,u]},ks.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=ks.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<l.length;r++)h[r]=l[r][0];c(l=h);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=Is(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)c(l[r][i])}1===l.length?l=l[0]:u="Multi"+u;var f={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(f.id=this.id),f};var Ts=Es,Ps=As;function As(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ms,this,e),this.length=this._features.length}function Ms(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}As.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Ts(this._pbf,e,this.extent,this._keys,this._values)};var Ls=Ps;function Rs(t,e,n){if(3===t){var r=new Ls(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}ws.VectorTile=function(t,e){this.layers=t.readFields(Rs,{},e)},ws.VectorTileFeature=Es,ws.VectorTileLayer=Ps;const Ds=ws.VectorTileFeature.types,Ns=Math.pow(2,13);function zs(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*Ns)+a,i*Ns*2,o*Ns*2,Math.round(s))}class Os{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new no,this.centroidVertexArray=new Qi,this.indexArray=new ho,this.programConfigurations=new jo(t.layers,t.zoom),this.segments=new go,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.features=[],this.hasPattern=ds("fill-extrusion",this.layers,e);for(const{feature:r,id:i,index:o,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,s=Xo(r,t);if(!this.layers[0]._featureFilter.filter(new Qr(this.zoom),s,n))continue;const l={id:i,sourceLayerIndex:a,index:o,geometry:t?s.geometry:Wo(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(ms("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,o,n,{}),e.featureIndex.insert(r,l.geometry,o,a,this.index,!0)}}addFeatures(t,e,n){for(const r of this.features){const{geometry:t}=r;this.addFeature(r,t,r.index,e,n)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bs),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,xs.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,n,r,i){const o={x:0,y:0,vertexCount:0};for(const a of fs(e,500)){let e=0;for(const t of a)e+=t.length;let n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of a){if(0===t.length)continue;if(Bs(t))continue;let e=0;for(let r=0;r<t.length;r++){const i=t[r];if(r>=1){const a=t[r-1];if(!Fs(i,a)){n.vertexLength+4>go.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=i.sub(a)._perp()._unit(),r=a.dist(i);e+r>32768&&(e=0),zs(this.layoutVertexArray,i.x,i.y,t.x,t.y,0,0,e),zs(this.layoutVertexArray,i.x,i.y,t.x,t.y,0,1,e),o.x+=2*i.x,o.y+=2*i.y,o.vertexCount+=2,e+=r,zs(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,0,e),zs(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,1,e),o.x+=2*a.x,o.y+=2*a.y,o.vertexCount+=2;const s=n.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+e>go.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==Ds[t.type])continue;const r=[],i=[],s=n.vertexLength;for(const t of a)if(0!==t.length){t!==a[0]&&i.push(r.length/2);for(let e=0;e<t.length;e++){const n=t[e];zs(this.layoutVertexArray,n.x,n.y,0,0,1,1,0),o.x+=n.x,o.y+=n.y,o.vertexCount+=1,r.push(n.x),r.push(n.y)}}const l=Na.exports(r,i);for(let t=0;t<l.length;t+=3)this.indexArray.emplaceBack(s+l[t],s+l[t+2],s+l[t+1]);n.primitiveLength+=l.length/3,n.vertexLength+=e}for(let a=0;a<o.vertexCount;a++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}}function Fs(t,e){return t.x===e.x&&(t.x<0||t.x>Zo)||t.y===e.y&&(t.y<0||t.y>Zo)}function Bs(t){return t.every((t=>t.x<0))||t.every((t=>t.x>Zo))||t.every((t=>t.y<0))||t.every((t=>t.y>Zo))}Ir("FillExtrusionBucket",Os,{omit:["layers","features"]});var js={paint:new pi({"fill-extrusion-opacity":new li(rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ui(rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new li(rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new li(rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ci(rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ui(rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ui(rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new li(rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Us(t,e){return t.x*e.x+t.y*e.y}function Vs(t,e){if(1===t.length){let n=0;const r=e[n++];let i;for(;!i||r.equals(i);)if(i=e[n++],!i)return 1/0;for(;n<e.length;n++){const o=e[n],a=t[0],s=i.sub(r),l=o.sub(r),u=a.sub(r),c=Us(s,s),h=Us(s,l),f=Us(l,l),p=Us(u,s),d=Us(u,l),m=c*f-h*h,g=(f*p-h*d)/m,v=(c*d-h*p)/m,y=r.z*(1-g-v)+i.z*g+o.z*v;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}const Zs=_i([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:qs}=Zs,Gs=_i([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ws}=Gs,Xs=ws.VectorTileFeature.types,Hs=Math.cos(Math.PI/180*37.5),Ys=Math.pow(2,14)/.5;class $s{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new ro,this.layoutVertexArray2=new io,this.indexArray=new ho,this.programConfigurations=new jo(t.layers,t.zoom),this.segments=new go,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=ds("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),i=!r.isConstant(),o=[];for(const{feature:a,id:s,index:l,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,e=Xo(a,t);if(!this.layers[0]._featureFilter.filter(new Qr(this.zoom),e,n))continue;const c=i?r.evaluate(e,{},n):void 0,h={id:s,properties:a.properties,type:a.type,sourceLayerIndex:u,index:l,geometry:t?e.geometry:Wo(a),patterns:{},sortKey:c};o.push(h)}i&&o.sort(((t,e)=>t.sortKey-e.sortKey));for(const a of o){const{geometry:r,index:i,sourceLayerIndex:o}=a;if(this.hasPattern){const t=ms("line",this.layers,a,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(a,r,i,n,{});e.featureIndex.insert(t[i].feature,r,i,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ws)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,r,i){const o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const c of e)this.addLine(c,t,a,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}addLine(t,e,n,r,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const a="Polygon"===Xs[e.type];let s=t.length;for(;s>=2&&t[s-1].equals(t[s-2]);)s--;let l=0;for(;l<s-1&&t[l].equals(t[l+1]);)l++;if(s<(a?3:2))return;"bevel"===n&&(i=1.05);const u=this.overscaling<=16?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let h,f,p,d,m;this.e1=this.e2=-1,a&&(h=t[s-2],m=t[l].sub(h)._unit()._perp());for(let g=l;g<s;g++){if(p=g===s-1?a?t[l+1]:void 0:t[g+1],p&&t[g].equals(p))continue;m&&(d=m),h&&(f=h),h=t[g],m=p?p.sub(h)._unit()._perp():d,d=d||m;let e=d.add(m);0===e.x&&0===e.y||e._unit();const v=d.x*m.x+d.y*m.y,y=e.x*m.x+e.y*m.y,_=0!==y?1/y:1/0,x=2*Math.sqrt(2-2*y),b=y<Hs&&f&&p,w=d.x*m.y-d.y*m.x>0;if(b&&g>l){const t=h.dist(f);if(t>2*u){const e=h.sub(h.sub(f)._mult(u/t)._round());this.updateDistance(f,e),this.addCurrentVertex(e,d,0,0,c),f=e}}const S=f&&p;let E=S?n:a?"butt":r;if(S&&"round"===E&&(_<o?E="miter":_<=2&&(E="fakeround")),"miter"===E&&_>i&&(E="bevel"),"bevel"===E&&(_>2&&(E="flipbevel"),_<i&&(E="miter")),f&&this.updateDistance(f,h),"miter"===E)e._mult(_),this.addCurrentVertex(h,e,0,0,c);else if("flipbevel"===E){if(_>100)e=m.mult(-1);else{const t=_*d.add(m).mag()/d.sub(m).mag();e._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,e,0,0,c),this.addCurrentVertex(h,e.mult(-1),0,0,c)}else if("bevel"===E||"fakeround"===E){const t=-Math.sqrt(_*_-1),e=w?t:0,n=w?0:t;if(f&&this.addCurrentVertex(h,d,e,n,c),"fakeround"===E){const t=Math.round(180*x/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*t*t+(.848013+v*(.215638*v-1.06021)))}const r=m.sub(d)._mult(n)._add(d)._unit()._mult(w?-1:1);this.addHalfVertex(h,r.x,r.y,!1,w,0,c)}}p&&this.addCurrentVertex(h,m,-e,-n,c)}else if("butt"===E)this.addCurrentVertex(h,e,0,0,c);else if("square"===E){const t=f?1:-1;this.addCurrentVertex(h,e,t,t,c)}else"round"===E&&(f&&(this.addCurrentVertex(h,d,0,0,c),this.addCurrentVertex(h,d,1,1,c,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,c,!0),this.addCurrentVertex(h,m,0,0,c)));if(b&&g<s-1){const t=h.dist(p);if(t>2*u){const e=h.add(p.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,m,0,0,c),h=e}}}}addCurrentVertex(t,e,n,r,i,o=!1){const a=e.y*r-e.x,s=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,i),this.addHalfVertex(t,a,s,o,!0,-r,i),this.distance>Ys/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,r,i,o))}addHalfVertex({x:t,y:e},n,r,i,o,a,s){const l=.5*(this.lineClips?this.scaledDistance*(Ys-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(i?1:0),(e<<1)+(o?1:0),Math.round(63*n)+128,Math.round(63*r)+128,1+(0===a?0:a<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),o?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}Ir("LineBucket",$s,{omit:["layers","patternFeatures"]});const Ks=new pi({"line-cap":new li(rt.layout_line["line-cap"]),"line-join":new ui(rt.layout_line["line-join"]),"line-miter-limit":new li(rt.layout_line["line-miter-limit"]),"line-round-limit":new li(rt.layout_line["line-round-limit"]),"line-sort-key":new ui(rt.layout_line["line-sort-key"])});var Js={paint:new pi({"line-opacity":new ui(rt.paint_line["line-opacity"]),"line-color":new ui(rt.paint_line["line-color"]),"line-translate":new li(rt.paint_line["line-translate"]),"line-translate-anchor":new li(rt.paint_line["line-translate-anchor"]),"line-width":new ui(rt.paint_line["line-width"]),"line-gap-width":new ui(rt.paint_line["line-gap-width"]),"line-offset":new ui(rt.paint_line["line-offset"]),"line-blur":new ui(rt.paint_line["line-blur"]),"line-dasharray":new hi(rt.paint_line["line-dasharray"]),"line-pattern":new ci(rt.paint_line["line-pattern"]),"line-gradient":new fi(rt.paint_line["line-gradient"])}),layout:Ks};const Qs=new class extends ui{possiblyEvaluate(t,e){return e=new Qr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,r){return e=s({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,r)}}(Js.paint.properties["line-width"].specification);function tl(t,e){return e>0?e+2*t:t}Qs.useIntegerZoom=!0;const el=_i([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nl=_i([{name:"a_projected_pos",components:3,type:"Float32"}],4);_i([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const rl=_i([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);_i([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const il=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ol=_i([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function al(t,e,n){return t.sections.forEach((t=>{t.text=function(t,e,n){const r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),Jr.applyArabicShaping&&(t=Jr.applyArabicShaping(t)),t}(t.text,e,n)})),t}_i([{name:"triangle",components:3,type:"Uint16"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_i([{type:"Float32",name:"offsetX"}]),_i([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const sl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var ll=24,ul=fl,cl=function(t,e,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},hl=function(t,e,n,r,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*m};function fl(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}fl.Varint=0,fl.Fixed64=1,fl.Bytes=2,fl.Fixed32=5;var pl,dl=4294967296,ml=1/dl,gl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function vl(t){return t.type===fl.Bytes?t.readVarint()+t.pos:t.pos+1}function yl(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function _l(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function xl(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function bl(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function wl(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Sl(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function El(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function kl(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Cl(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Il(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Tl(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Pl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Al(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ml(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Ll(t,e,n){1===t&&n.readMessage(Rl,e)}function Rl(t,e,n){if(3===t){const{id:t,bitmap:r,width:i,height:o,left:a,top:s,advance:l}=n.readMessage(Dl,{});e.push({id:t,bitmap:new Pa({width:i+6,height:o+6},r),metrics:{width:i,height:o,left:a,top:s,advance:l}})}}function Dl(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Nl(t){let e=0,n=0;for(const a of t)e+=a.w*a.h,n=Math.max(n,a.w);t.sort(((t,e)=>e.h-t.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let i=0,o=0;for(const a of t)for(let t=r.length-1;t>=0;t--){const e=r[t];if(!(a.w>e.w||a.h>e.h)){if(a.x=e.x,a.y=e.y,o=Math.max(o,a.y+a.h),i=Math.max(i,a.x+a.w),a.w===e.w&&a.h===e.h){const e=r.pop();t<r.length&&(r[t]=e)}else a.h===e.h?(e.x+=a.w,e.w-=a.w):a.w===e.w?(e.y+=a.h,e.h-=a.h):(r.push({x:e.x+a.w,y:e.y,w:e.w-a.w,h:a.h}),e.y+=a.h,e.h-=a.h);break}}return{w:i,h:o,fill:e/(i*o)||0}}fl.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Pl(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ml(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Pl(this.buf,this.pos)+Pl(this.buf,this.pos+4)*dl;return this.pos+=8,t},readSFixed64:function(){var t=Pl(this.buf,this.pos)+Ml(this.buf,this.pos+4)*dl;return this.pos+=8,t},readFloat:function(){var t=cl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=cl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return yl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return yl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return yl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return yl(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return yl(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return yl(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&gl?function(t,e,n){return gl.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(a=t[i+2],128==(192&(o=t[i+1]))&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=t[i+2],s=t[i+3],128==(192&(o=t[i+1]))&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==fl.Bytes)return t.push(this.readVarint(e));var n=vl(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==fl.Bytes)return t.push(this.readSVarint());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==fl.Bytes)return t.push(this.readBoolean());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==fl.Bytes)return t.push(this.readFloat());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==fl.Bytes)return t.push(this.readDouble());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==fl.Bytes)return t.push(this.readFixed32());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==fl.Bytes)return t.push(this.readSFixed32());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==fl.Bytes)return t.push(this.readFixed64());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==fl.Bytes)return t.push(this.readSFixed64());var e=vl(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===fl.Varint)for(;this.buf[this.pos++]>127;);else if(e===fl.Bytes)this.pos=this.readVarint()+this.pos;else if(e===fl.Fixed32)this.pos+=4;else{if(e!==fl.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Al(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Al(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Al(this.buf,-1&t,this.pos),Al(this.buf,Math.floor(t*ml),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Al(this.buf,-1&t,this.pos),Al(this.buf,Math.floor(t*ml),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&_l(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),hl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),hl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&_l(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,fl.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,xl,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,bl,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,El,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,wl,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Sl,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,kl,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Cl,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Il,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Tl,e)},writeBytesField:function(t,e){this.writeTag(t,fl.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,fl.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,fl.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,fl.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,fl.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,fl.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,fl.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,fl.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,fl.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,fl.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class zl{constructor(t,{pixelRatio:e,version:n,stretchX:r,stretchY:i,content:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=r,this.stretchY=i,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ol{constructor(t,e){const n={},r={};this.haveRenderCallbacks=[];const i=[];this.addImages(t,n,i),this.addImages(e,r,i);const{w:o,h:a}=Nl(i),s=new Aa({width:o||1,height:a||1});for(const l in t){const e=t[l],r=n[l].paddedRect;Aa.copy(e.data,s,{x:0,y:0},{x:r.x+1,y:r.y+1},e.data)}for(const l in e){const t=e[l],n=r[l].paddedRect,i=n.x+1,o=n.y+1,a=t.data.width,u=t.data.height;Aa.copy(t.data,s,{x:0,y:0},{x:i,y:o},t.data),Aa.copy(t.data,s,{x:0,y:u-1},{x:i,y:o-1},{width:a,height:1}),Aa.copy(t.data,s,{x:0,y:0},{x:i,y:o+u},{width:a,height:1}),Aa.copy(t.data,s,{x:a-1,y:0},{x:i-1,y:o},{width:1,height:u}),Aa.copy(t.data,s,{x:0,y:0},{x:i+a,y:o},{width:1,height:u})}this.image=s,this.iconPositions=n,this.patternPositions=r}addImages(t,e,n){for(const r in t){const i=t[r],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};n.push(o),e[r]=new zl(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,i]=t.tl;n.update(e.data,void 0,{x:r,y:i})}}Ir("ImagePosition",zl),Ir("ImageAtlas",Ol),t.WritingMode=void 0,(pl=t.WritingMode||(t.WritingMode={}))[pl.none=0]="none",pl[pl.horizontal=1]="horizontal",pl[pl.vertical=2]="vertical",pl[pl.horizontalOnly=3]="horizontalOnly";const Fl=-17;class Bl{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new Bl;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new Bl;return e.imageName=t,e}}class jl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new jl;for(let r=0;r<t.sections.length;r++){const i=t.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;e+=r&&Or(r)&&!sl[t[n+1]]||i&&Or(i)&&!sl[t[n-1]]||!sl[t[n]]?t[n]:sl[t[n]]}return e}(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&Vl[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&Vl[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new jl;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Bl.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let r=0;r<t.text.length;++r)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void d("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Bl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):d("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ul(e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g){const v=jl.fromFeature(e,o);let y;f===t.WritingMode.vertical&&v.verticalizePunctuation();const{processBidirectionalText:_,processStyledBidirectionalText:x}=Jr;if(_&&1===v.sections.length){y=[];const t=_(v.toString(),Yl(v,c,a,n,i,d,m));for(const e of t){const t=new jl;t.text=e,t.sections=v.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);y.push(t)}}else if(x){y=[];const t=x(v.text,v.sectionIndex,Yl(v,c,a,n,i,d,m));for(const e of t){const t=new jl;t.text=e[0],t.sectionIndex=e[1],t.sections=v.sections,y.push(t)}}else y=function(t,e){const n=[],r=t.text;let i=0;for(const o of e)n.push(t.substring(i,o)),i=o;return i<r.length&&n.push(t.substring(i,r.length)),n}(v,Yl(v,c,a,n,i,d,m));const b=[],w={positionedLines:b,text:v.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:f,iconsInText:!1,verticalizable:!1};return function(e,n,r,i,o,a,s,l,u,c,h,f){let p=0,d=Fl,m=0,g=0;const v="right"===l?1:"left"===l?0:.5;let y=0;for(const S of o){S.trim();const o=S.getMaxScale(),s=(o-1)*ll,l={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=l;const x=l.positionedGlyphs;let b=0;if(!S.length()){d+=a,++y;continue}for(let a=0;a<S.length();a++){const l=S.getSection(a),m=S.getSectionIndex(a),g=S.getCharCode(a);let v=0,y=null,w=null,E=null,k=ll;const C=!(u===t.WritingMode.horizontal||!h&&!zr(g)||h&&(Vl[g]||(_=g,Lr.Arabic(_)||Lr["Arabic Supplement"](_)||Lr["Arabic Extended-A"](_)||Lr["Arabic Presentation Forms-A"](_)||Lr["Arabic Presentation Forms-B"](_))));if(l.imageName){const t=i[l.imageName];if(!t)continue;E=l.imageName,e.iconsInText=e.iconsInText||!0,w=t.paddedRect;const n=t.displaySize;l.scale=l.scale*ll/f,y={width:n[0],height:n[1],left:1,top:-3,advance:C?n[1]:n[0]},v=s+(ll-n[1]*l.scale),k=y.advance;const r=C?n[0]*l.scale-ll*o:n[1]*l.scale-ll*o;r>0&&r>b&&(b=r)}else{const t=r[l.fontStack],e=t&&t[g];if(e&&e.rect)w=e.rect,y=e.metrics;else{const t=n[l.fontStack],e=t&&t[g];if(!e)continue;y=e.metrics}v=(o-l.scale)*ll}C?(e.verticalizable=!0,x.push({glyph:g,imageName:E,x:p,y:d+v,vertical:C,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:y,rect:w}),p+=k*l.scale+c):(x.push({glyph:g,imageName:E,x:p,y:d+v,vertical:C,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:y,rect:w}),p+=y.advance*l.scale+c)}0!==x.length&&(m=Math.max(p-c,m),Kl(x,0,x.length-1,v,b)),p=0;const w=a*o+b;l.lineOffset=Math.max(b,s),d+=w,g=Math.max(w,g),++y}var _;const x=d-Fl,{horizontalAlign:b,verticalAlign:w}=$l(s);(function(t,e,n,r,i,o,a,s,l){const u=(e-n)*i;let c=0;c=o!==a?-s*r-Fl:(-r*l+.5)*a;for(const h of t)for(const t of h.positionedGlyphs)t.x+=u,t.y+=c})(e.positionedLines,v,b,w,m,g,a,x,o.length),e.top+=-w*x,e.bottom=e.top+x,e.left+=-b*m,e.right=e.left+m}(w,n,r,i,y,s,l,u,f,c,p,g),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(b)&&w}const Vl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Zl={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ql(t,e,n,r,i,o){if(e.imageName){const t=r[e.imageName];return t?t.displaySize[0]*e.scale*ll/o+i:0}{const r=n[e.fontStack],o=r&&r[t];return o?o.metrics.advance*e.scale+i:0}}function Gl(t,e,n,r){const i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function Wl(t,e,n){let r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Xl(t,e,n,r,i,o){let a=null,s=Gl(e,n,i,o);for(const l of r){const t=Gl(e-l.x,n,i,o)+l.badness;t<=s&&(a=l,s=t)}return{index:t,x:e,priorBreak:a,badness:s}}function Hl(t){return t?Hl(t.priorBreak).concat(t.index):[]}function Yl(t,e,n,r,i,o,a){if("point"!==o)return[];if(!t)return[];const s=[],l=function(t,e,n,r,i,o){let a=0;for(let s=0;s<t.length();s++){const n=t.getSection(s);a+=ql(t.getCharCode(s),n,r,i,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,r,i,a),u=t.text.indexOf("\u200b")>=0;let c=0;for(let f=0;f<t.length();f++){const n=t.getSection(f),o=t.getCharCode(f);if(Vl[o]||(c+=ql(o,n,r,i,e,a)),f<t.length()-1){const e=!((h=o)<11904||!(Lr["Bopomofo Extended"](h)||Lr.Bopomofo(h)||Lr["CJK Compatibility Forms"](h)||Lr["CJK Compatibility Ideographs"](h)||Lr["CJK Compatibility"](h)||Lr["CJK Radicals Supplement"](h)||Lr["CJK Strokes"](h)||Lr["CJK Symbols and Punctuation"](h)||Lr["CJK Unified Ideographs Extension A"](h)||Lr["CJK Unified Ideographs"](h)||Lr["Enclosed CJK Letters and Months"](h)||Lr["Halfwidth and Fullwidth Forms"](h)||Lr.Hiragana(h)||Lr["Ideographic Description Characters"](h)||Lr["Kangxi Radicals"](h)||Lr["Katakana Phonetic Extensions"](h)||Lr.Katakana(h)||Lr["Vertical Forms"](h)||Lr["Yi Radicals"](h)||Lr["Yi Syllables"](h)));(Zl[o]||e||n.imageName)&&s.push(Xl(f+1,c,l,s,Wl(o,t.getCharCode(f+1),e&&u),!1))}}var h;return Hl(Xl(t.length(),c,l,s,0,!0))}function $l(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Kl(t,e,n,r,i){if(!r&&!i)return;const o=t[n],a=(t[n].x+o.metrics.advance*o.scale)*r;for(let s=e;s<=n;s++)t[s].x-=a,t[s].y+=i}function Jl(t,e,n){const{horizontalAlign:r,verticalAlign:i}=$l(n),o=e[0]-t.displaySize[0]*r,a=e[1]-t.displaySize[1]*i;return{image:t,top:a,bottom:a+t.displaySize[1],left:o,right:o+t.displaySize[0]}}function Ql(t,e,n,r,i,o){const a=t.image;let s;if(a.content){const t=a.content,e=a.pixelRatio||1;s=[t[0]/e,t[1]/e,a.displaySize[0]-t[2]/e,a.displaySize[1]-t[3]/e]}const l=e.left*o,u=e.right*o;let c,h,f,p;"width"===n||"both"===n?(p=i[0]+l-r[3],h=i[0]+u+r[1]):(p=i[0]+(l+u-a.displaySize[0])/2,h=p+a.displaySize[0]);const d=e.top*o,m=e.bottom*o;return"height"===n||"both"===n?(c=i[1]+d-r[0],f=i[1]+m+r[2]):(c=i[1]+(d+m-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:h,bottom:f,left:p,collisionPadding:s}}const tu=128;function eu(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Qr(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=n;let i=0;for(;i<e.length&&e[i]<=t;)i++;i=Math.max(0,i-1);let o=i;for(;o<e.length&&e[o]<t+1;)o++;o=Math.min(e.length-1,o);const a=e[i],s=e[o];return"composite"===n.kind?{kind:"composite",minZoom:a,maxZoom:s,interpolationType:r}:{kind:"camera",minZoom:a,maxZoom:s,minSize:n.evaluate(new Qr(a)),maxSize:n.evaluate(new Qr(s)),interpolationType:r}}}class nu extends k{constructor(t,e,n,r){super(t,e),this.angle=n,void 0!==r&&(this.segment=r)}clone(){return new nu(this.x,this.y,this.angle,this.segment)}}function ru(t,e,n,r,i){if(void 0===e.segment)return!0;let o=e,a=e.segment+1,s=0;for(;s>-n/2;){if(a--,a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;const l=[];let u=0;for(;s<n/2;){const e=t[a],n=t[a+1];if(!n)return!1;let o=t[a-1].angleTo(e)-e.angleTo(n);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:o}),u+=o;s-l[0].distance>r;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=e.dist(n)}return!0}function iu(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function ou(t,e,n){return t?.6*e*n:0}function au(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function su(t,e,n,r,i,o){const a=ou(n,i,o),s=au(n,r)*o;let l=0;const u=iu(t)/2;for(let c=0;c<t.length-1;c++){const n=t[c],r=t[c+1],i=n.dist(r);if(l+i>u){const o=(u-l)/i,h=ke(n.x,r.x,o),f=ke(n.y,r.y,o),p=new nu(h,f,r.angleTo(n),c);return p._round(),!a||ru(t,p,s,a,e)?p:void 0}l+=i}}function lu(t,e,n,r,i,o,a,s,l){const u=ou(r,o,a),c=au(r,i),h=c*a,f=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),uu(t,f?e/2*s%e:(c/2+2*o)*a*s%e,e,u,n,h,f,!1,l)}function uu(t,e,n,r,i,o,a,s,l){const u=o/2,c=iu(t);let h=0,f=e-n,p=[];for(let d=0;d<t.length-1;d++){const e=t[d],a=t[d+1],s=e.dist(a),m=a.angleTo(e);for(;f+n<h+s;){f+=n;const g=(f-h)/s,v=ke(e.x,a.x,g),y=ke(e.y,a.y,g);if(v>=0&&v<l&&y>=0&&y<l&&f-u>=0&&f+u<=c){const e=new nu(v,y,m,d);e._round(),r&&!ru(t,e,o,r,i)||p.push(e)}}h+=s}return s||p.length||a||(p=uu(t,h/2,n,r,i,o,a,!0,l)),p}function cu(t,e,n,r,i){const o=[];for(let a=0;a<t.length;a++){const s=t[a];let l;for(let t=0;t<s.length-1;t++){let a=s[t],u=s[t+1];a.x<e&&u.x<e||(a.x<e?a=new k(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x<e&&(u=new k(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y<n&&u.y<n||(a.y<n?a=new k(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round():u.y<n&&(u=new k(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round()),a.x>=r&&u.x>=r||(a.x>=r?a=new k(r,a.y+(r-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x>=r&&(u=new k(r,a.y+(r-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y>=i&&u.y>=i||(a.y>=i?a=new k(a.x+(i-a.y)/(u.y-a.y)*(u.x-a.x),i)._round():u.y>=i&&(u=new k(a.x+(i-a.y)/(u.y-a.y)*(u.x-a.x),i)._round()),l&&a.equals(l[l.length-1])||(l=[a],o.push(l)),l.push(u)))))}}return o}function hu(t,e,n,r){const i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2,l=o.paddedRect.h-2,u=t.right-t.left,c=t.bottom-t.top,h=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],p=(t,e)=>t+e[1]-e[0],d=h.reduce(p,0),m=f.reduce(p,0),g=s-d,v=l-m;let y=0,_=d,x=0,b=m,w=0,S=g,E=0,C=v;if(o.content&&r){const t=o.content;y=fu(h,0,t[0]),x=fu(f,0,t[1]),_=fu(h,t[0],t[2]),b=fu(f,t[1],t[3]),w=t[0]-y,E=t[1]-x,S=t[2]-t[0]-_,C=t[3]-t[1]-b}const I=(r,i,s,l)=>{const h=du(r.stretch-y,_,u,t.left),f=mu(r.fixed-w,S,r.stretch,d),p=du(i.stretch-x,b,c,t.top),g=mu(i.fixed-E,C,i.stretch,m),v=du(s.stretch-y,_,u,t.left),I=mu(s.fixed-w,S,s.stretch,d),T=du(l.stretch-x,b,c,t.top),P=mu(l.fixed-E,C,l.stretch,m),A=new k(h,p),M=new k(v,p),L=new k(v,T),R=new k(h,T),D=new k(f/a,g/a),N=new k(I/a,P/a),z=e*Math.PI/180;if(z){const t=Math.sin(z),e=Math.cos(z),n=[e,-t,t,e];A._matMult(n),M._matMult(n),R._matMult(n),L._matMult(n)}const O=r.stretch+r.fixed,F=i.stretch+i.fixed;return{tl:A,tr:M,bl:R,br:L,tex:{x:o.paddedRect.x+1+O,y:o.paddedRect.y+1+F,w:s.stretch+s.fixed-O,h:l.stretch+l.fixed-F},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:N,minFontScaleX:S/a/u,minFontScaleY:C/a/c,isSDF:n}};if(r&&(o.stretchX||o.stretchY)){const t=pu(h,g,d),e=pu(f,v,m);for(let n=0;n<t.length-1;n++){const r=t[n],o=t[n+1];for(let t=0;t<e.length-1;t++)i.push(I(r,e[t],o,e[t+1]))}}else i.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));return i}function fu(t,e,n){let r=0;for(const i of t)r+=Math.max(e,Math.min(n,i[1]))-Math.max(e,Math.min(n,i[0]));return r}function pu(t,e,n){const r=[{fixed:-1,stretch:0}];for(const[i,o]of t){const t=r[r.length-1];r.push({fixed:i-t.stretch,stretch:t.stretch}),r.push({fixed:i-t.stretch,stretch:t.stretch+(o-i)})}return r.push({fixed:e+1,stretch:n}),r}function du(t,e,n,r){return t/e*n+r}function mu(t,e,n,r){return t-e*n/r}Ir("Anchor",nu);class gu{constructor(t,e,n,r,i,o,a,s,l,u){if(this.boxStartIndex=t.length,l){let t=o.top,e=o.bottom;const n=o.collisionPadding;n&&(t-=n[1],e+=n[3]);let r=e-t;r>0&&(r=Math.max(10,r),this.circleDiameter=r)}else{let l=o.top*a-s[0],c=o.bottom*a+s[2],h=o.left*a-s[3],f=o.right*a+s[1];const p=o.collisionPadding;if(p&&(h-=p[0]*a,l-=p[1]*a,f+=p[2]*a,c+=p[3]*a),u){const t=new k(h,l),e=new k(f,l),n=new k(h,c),r=new k(f,c),i=u*Math.PI/180;t._rotate(i),e._rotate(i),n._rotate(i),r._rotate(i),h=Math.min(t.x,e.x,n.x,r.x),f=Math.max(t.x,e.x,n.x,r.x),l=Math.min(t.y,e.y,n.y,r.y),c=Math.max(t.y,e.y,n.y,r.y)}t.emplaceBack(e.x,e.y,h,l,f,c,n,r,i)}this.boxEndIndex=t.length}}class vu{constructor(t=[],e=yu){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let r=1+(t<<1),o=e[r];const a=r+1;if(a<this.length&&n(e[a],o)<0&&(r=a,o=e[a]),n(o,i)>=0)break;e[t]=o,t=r}e[t]=i}}function yu(t,e){return t<e?-1:t>e?1:0}function _u(t,e=1,n=!1){let r=1/0,i=1/0,o=-1/0,a=-1/0;const s=t[0];for(let p=0;p<s.length;p++){const t=s[p];(!p||t.x<r)&&(r=t.x),(!p||t.y<i)&&(i=t.y),(!p||t.x>o)&&(o=t.x),(!p||t.y>a)&&(a=t.y)}const l=Math.min(o-r,a-i);let u=l/2;const c=new vu([],xu);if(0===l)return new k(r,i);for(let p=r;p<o;p+=l)for(let e=i;e<a;e+=l)c.push(new bu(p+u,e+u,u,t));let h=function(t){let e=0,n=0,r=0;const i=t[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){const t=i[o],a=i[s],l=t.x*a.y-a.x*t.y;n+=(t.x+a.x)*l,r+=(t.y+a.y)*l,e+=3*l}return new bu(n/e,r/e,0,t)}(t),f=c.length;for(;c.length;){const r=c.pop();(r.d>h.d||!h.d)&&(h=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,f)),r.max-h.d<=e||(u=r.h/2,c.push(new bu(r.p.x-u,r.p.y-u,u,t)),c.push(new bu(r.p.x+u,r.p.y-u,u,t)),c.push(new bu(r.p.x-u,r.p.y+u,u,t)),c.push(new bu(r.p.x+u,r.p.y+u,u,t)),f+=4)}return n&&(console.log(`num probes: ${f}`),console.log(`best distance: ${h.d}`)),h.p}function xu(t,e){return e.max-t.max}function bu(t,e,n,r){this.p=new k(t,e),this.h=n,this.d=function(t,e){let n=!1,r=1/0;for(let i=0;i<e.length;i++){const o=e[i];for(let e=0,i=o.length,a=i-1;e<i;a=e++){const i=o[e],s=o[a];i.y>t.y!=s.y>t.y&&t.x<(s.x-i.x)*(t.y-i.y)/(s.y-i.y)+i.x&&(n=!n),r=Math.min(r,ra(t,i,s))}}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}const wu=Number.POSITIVE_INFINITY;function Su(t,e){return e[1]!==wu?function(t,e,n){let r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-n}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){let n=0,r=0;e<0&&(e=0);const i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function Eu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ku(e,n,r,i,o,a,s,l,u,c,h){let f=a.textMaxSize.evaluate(n,{});void 0===f&&(f=s);const p=e.layers[0].layout,m=p.get("icon-offset").evaluate(n,{},h),g=Tu(r.horizontal),v=s/24,y=e.tilePixelRatio*v,_=e.tilePixelRatio*f/24,x=e.tilePixelRatio*l,b=e.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*e.tilePixelRatio,S=function(t,e,n,r=1){const i=t.get("icon-padding").evaluate(e,{},n),o=i&&i.values;return[o[0]*r,o[1]*r,o[2]*r,o[3]*r]}(p,n,h,e.tilePixelRatio),E=p.get("text-max-angle")/180*Math.PI,k="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),C="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),I=p.get("symbol-placement"),T=b/2,P=p.get("icon-text-fit");let A;i&&"none"!==P&&(e.allowVerticalPlacement&&r.vertical&&(A=Ql(i,r.vertical,P,p.get("icon-text-fit-padding"),m,v)),g&&(i=Ql(i,g,P,p.get("icon-text-fit-padding"),m,v)));const M=(l,f)=>{f.x<0||f.x>=Zo||f.y<0||f.y>=Zo||function(e,n,r,i,o,a,s,l,u,c,h,f,p,m,g,v,y,_,x,b,w,S,E,k,C){const I=e.addToLineVertexArray(n,r);let T,P,A,M,L=0,R=0,D=0,N=0,z=-1,O=-1;const F={};let B=_o.exports(""),j=0,U=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[j,U]=l.layout.get("text-offset").evaluate(w,{},k).map((t=>t*ll)):(j=l.layout.get("text-radial-offset").evaluate(w,{},k)*ll,U=wu),e.allowVerticalPlacement&&i.vertical){const t=l.layout.get("text-rotate").evaluate(w,{},k)+90;A=new gu(u,n,c,h,f,i.vertical,p,m,g,t),s&&(M=new gu(u,n,c,h,f,s,y,_,g,t))}if(o){const r=l.layout.get("icon-rotate").evaluate(w,{}),i="none"!==l.layout.get("icon-text-fit"),a=hu(o,r,E,i),p=s?hu(s,r,E,i):void 0;P=new gu(u,n,c,h,f,o,y,_,!1,r),L=4*a.length;const m=e.iconSizeData;let g=null;"source"===m.kind?(g=[tu*l.layout.get("icon-size").evaluate(w,{})],g[0]>Cu&&d(`${e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===m.kind&&(g=[tu*S.compositeIconSizes[0].evaluate(w,{},k),tu*S.compositeIconSizes[1].evaluate(w,{},k)],(g[0]>Cu||g[1]>Cu)&&d(`${e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),e.addSymbols(e.icon,a,g,b,x,w,t.WritingMode.none,n,I.lineStartIndex,I.lineLength,-1,k),z=e.icon.placedSymbolArray.length-1,p&&(R=4*p.length,e.addSymbols(e.icon,p,g,b,x,w,t.WritingMode.vertical,n,I.lineStartIndex,I.lineLength,-1,k),O=e.icon.placedSymbolArray.length-1)}const V=Object.keys(i.horizontal);for(const d of V){const r=i.horizontal[d];if(!T){B=_o.exports(r.text);const t=l.layout.get("text-rotate").evaluate(w,{},k);T=new gu(u,n,c,h,f,r,p,m,g,t)}const o=1===r.positionedLines.length;if(D+=Iu(e,n,r,a,l,g,w,v,I,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,o?V:[d],F,z,S,k),o)break}i.vertical&&(N+=Iu(e,n,i.vertical,a,l,g,w,v,I,t.WritingMode.vertical,["vertical"],F,O,S,k));const Z=T?T.boxStartIndex:e.collisionBoxArray.length,q=T?T.boxEndIndex:e.collisionBoxArray.length,G=A?A.boxStartIndex:e.collisionBoxArray.length,W=A?A.boxEndIndex:e.collisionBoxArray.length,X=P?P.boxStartIndex:e.collisionBoxArray.length,H=P?P.boxEndIndex:e.collisionBoxArray.length,Y=M?M.boxStartIndex:e.collisionBoxArray.length,$=M?M.boxEndIndex:e.collisionBoxArray.length;let K=-1;const J=(t,e)=>t&&t.circleDiameter?Math.max(t.circleDiameter,e):e;K=J(T,K),K=J(A,K),K=J(P,K),K=J(M,K);const Q=K>-1?1:0;Q&&(K*=C/ll),e.glyphOffsetArray.length>=Ou.MAX_GLYPHS&&d("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,w.sortKey),e.symbolInstances.emplaceBack(n.x,n.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,z,O,B,Z,q,G,W,X,H,Y,$,c,D,N,L,R,Q,0,p,j,U,K)}(e,f,l,r,i,o,A,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,y,[w,w,w,w],k,u,x,S,C,m,n,a,c,h,s)};if("line"===I)for(const t of cu(n.geometry,0,0,Zo,Zo)){const n=lu(t,b,E,r.vertical||g,i,24,_,e.overscaling,Zo);for(const r of n){const n=g;n&&Pu(e,n.text,T,r)||M(t,r)}}else if("line-center"===I){for(const t of n.geometry)if(t.length>1){const e=su(t,E,r.vertical||g,i,24,_);e&&M(t,e)}}else if("Polygon"===n.type)for(const t of fs(n.geometry,0)){const e=_u(t,16);M(t[0],new nu(e.x,e.y,0))}else if("LineString"===n.type)for(const t of n.geometry)M(t,new nu(t[0].x,t[0].y,0));else if("Point"===n.type)for(const t of n.geometry)for(const e of t)M([e],new nu(e.x,e.y,0))}const Cu=32640;function Iu(t,e,n,r,i,o,a,s,l,u,c,h,f,p,m){const g=function(t,e,n,r,i,o,a,s){const l=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(const c of e.positionedLines)for(const t of c.positionedGlyphs){if(!t.rect)continue;const r=t.rect||{};let o=4,h=!0,f=1,p=0;const d=(i||s)&&t.vertical,m=t.metrics.advance*t.scale/2;if(s&&e.verticalizable){const e=(t.scale-1)*ll,n=(ll-t.metrics.width*t.scale)/2;p=c.lineOffset/2-(t.imageName?-n:e)}if(t.imageName){const e=a[t.imageName];h=e.sdf,f=e.pixelRatio,o=1/f}const g=i?[t.x+m,t.y]:[0,0];let v=i?[0,0]:[t.x+m+n[0],t.y+n[1]-p],y=[0,0];d&&(y=v,v=[0,0]);const _=(t.metrics.left-o)*t.scale-m+v[0],x=(-t.metrics.top-o)*t.scale+v[1],b=_+r.w*t.scale/f,w=x+r.h*t.scale/f,S=new k(_,x),E=new k(b,x),C=new k(_,w),I=new k(b,w);if(d){const e=new k(-m,m-Fl),n=-Math.PI/2,r=12-m,i=new k(22-r,-(t.imageName?r:0)),o=new k(...y);S._rotateAround(n,e)._add(i)._add(o),E._rotateAround(n,e)._add(i)._add(o),C._rotateAround(n,e)._add(i)._add(o),I._rotateAround(n,e)._add(i)._add(o)}if(l){const t=Math.sin(l),e=Math.cos(l),n=[e,-t,t,e];S._matMult(n),E._matMult(n),C._matMult(n),I._matMult(n)}const T=new k(0,0),P=new k(0,0);u.push({tl:S,tr:E,bl:C,br:I,tex:r,writingMode:e.writingMode,glyphOffset:g,sectionIndex:t.sectionIndex,isSDF:h,pixelOffsetTL:T,pixelOffsetBR:P,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,s,i,o,a,r,t.allowVerticalPlacement),v=t.textSizeData;let y=null;"source"===v.kind?(y=[tu*i.layout.get("text-size").evaluate(a,{})],y[0]>Cu&&d(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===v.kind&&(y=[tu*p.compositeTextSizes[0].evaluate(a,{},m),tu*p.compositeTextSizes[1].evaluate(a,{},m)],(y[0]>Cu||y[1]>Cu)&&d(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,g,y,s,o,a,u,e,l.lineStartIndex,l.lineLength,f,m);for(const d of c)h[d]=t.text.placedSymbolArray.length-1;return 4*g.length}function Tu(t){for(const e in t)return t[e];return null}function Pu(t,e,n,r){const i=t.compareText;if(e in i){const t=i[e];for(let e=t.length-1;e>=0;e--)if(r.dist(t[e])<n)return!0}else i[e]=[];return i[e].push(r),!1}const Au=ws.VectorTileFeature.types,Mu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Lu(t,e,n,r,i,o,a,s,l,u,c,h,f){const p=s?Math.min(Cu,Math.round(s[0])):0,d=s?Math.min(Cu,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,(p<<1)+(l?1:0),d,16*u,16*c,256*h,256*f)}function Ru(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function Du(t){for(const e of t.sections)if(jr(e.text))return!0;return!1}class Nu{constructor(t){this.layoutVertexArray=new ao,this.indexArray=new ho,this.programConfigurations=t,this.segments=new go,this.dynamicLayoutVertexArray=new so,this.opacityVertexArray=new lo,this.placedSymbolArray=new Wi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,el.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,nl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Mu,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ir("SymbolBuffers",Nu);class zu{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new go,this.collisionVertexArray=new co}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,rl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ir("CollisionBuffers",zu);class Ou{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ma([]),this.placementViewportMatrix=ma([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=eu(this.zoom,n["text-size"]),this.iconSizeData=eu(this.zoom,n["icon-size"]);const r=this.layers[0].layout,i=r.get("symbol-sort-key"),o=r.get("symbol-z-order");this.canOverlap="never"!==Vu(r,"text-overlap","text-allow-overlap")||"never"!==Vu(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==o&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((e=>t.WritingMode[e]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID}createArrays(){this.text=new Nu(new jo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Nu(new jo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new Yi,this.lineVertexArray=new $i,this.symbolInstances=new Hi}calculateGlyphDependencies(t,e,n,r,i){for(let o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||r)&&i){const n=sl[t.charAt(o)];n&&(e[n.charCodeAt(0)]=!0)}}populate(e,n,r){const i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=("constant"!==s.value.kind||s.value.value instanceof Ot&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),c="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;const f=n.iconDependencies,p=n.glyphDependencies,d=n.availableImages,m=new Qr(this.zoom);for(const{feature:g,id:v,index:y,sourceLayerIndex:_}of e){const e=i._featureFilter.needGeometry,n=Xo(g,e);if(!i._featureFilter.filter(m,n,r))continue;let s,l;if(e||(n.geometry=Wo(g)),u){const t=i.getValueAndResolveTokens("text-field",n,r,d),e=Ot.factory(t);Du(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===$r()||this.hasRTLText&&Jr.isParsed())&&(s=al(e,i,n))}if(c){const t=i.getValueAndResolveTokens("icon-image",n,r,d);l=t instanceof Bt?t:Bt.fromString(t)}if(!s&&!l)continue;const x=this.sortFeaturesByKey?h.evaluate(n,{},r):void 0;if(this.features.push({id:v,text:s,icon:l,index:y,sourceLayerIndex:_,geometry:n.geometry,properties:g.properties,type:Au[g.type],sortKey:x}),l&&(f[l.name]=!0),s){const e=a.evaluate(n,{},r).join(","),i="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.WritingMode.vertical)>=0;for(const t of s.sections)if(t.image)f[t.image.name]=!0;else{const n=Rr(s.toString()),r=t.fontStack||e,o=p[r]=p[r]||{};this.calculateGlyphDependencies(t.text,o,i,this.allowVerticalPlacement,n)}}}"line"===o.get("symbol-placement")&&(this.features=function(t){const e={},n={},r=[];let i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){const o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){const o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function l(t,e,n){const r=n?e[0][e[0].length-1]:e[0][0];return`${t}:${r.x}:${r.y}`}for(let u=0;u<t.length;u++){const c=t[u],h=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}const p=l(f,h),d=l(f,h,!0);if(p in n&&d in e&&n[p]!==e[d]){const t=s(p,d,h),i=a(p,d,r[t].geometry);delete e[p],delete n[d],n[l(f,r[i].geometry,!0)]=i,r[t].geometry=null}else p in n?a(p,d,h):d in e?s(p,d,h):(o(u),e[p]=i-1,n[d]=i-1)}return r.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]);const i={};for(let o=t.segment+1;o<e.length;o++)i[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:n},o<e.length-1&&(n+=e[o+1].dist(e[o]));for(let o=t.segment||0;o>=0;o--)i[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:r},o>0&&(r+=e[o-1].dist(e[o]));for(let t=0;t<e.length;t++){const e=i[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,n,r,i,o,a,s,l,u,c,h,f){const p=e.indexArray,d=e.layoutVertexArray,m=e.segments.prepareSegment(4*n.length,d,p,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,v=m.vertexLength,y=this.allowVerticalPlacement&&s===t.WritingMode.vertical?Math.PI/2:0,_=a.text&&a.text.sections;for(let t=0;t<n.length;t++){const{tl:i,tr:o,bl:s,br:u,tex:c,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:v,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:S}=n[t],E=m.vertexLength,k=b[1];Lu(d,l.x,l.y,i.x,k+i.y,c.x,c.y,r,w,h.x,h.y,v,x),Lu(d,l.x,l.y,o.x,k+o.y,c.x+c.w,c.y,r,w,g.x,h.y,v,x),Lu(d,l.x,l.y,s.x,k+s.y,c.x,c.y+c.h,r,w,h.x,g.y,v,x),Lu(d,l.x,l.y,u.x,k+u.y,c.x+c.w,c.y+c.h,r,w,g.x,g.y,v,x),Ru(e.dynamicLayoutVertexArray,l,y),p.emplaceBack(E,E+1,E+2),p.emplaceBack(E+1,E+2,E+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),t!==n.length-1&&S===n[t+1].sectionIndex||e.programConfigurations.populatePaintArrays(d.length,a,a.index,{},f,_&&_[S])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,v,u,c,l.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(t,e,n,r,i,o,a){const s=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=s.vertexLength,u=i.layoutVertexArray,c=i.collisionVertexArray,h=a.anchorX,f=a.anchorY;this._addCollisionDebugVertex(u,c,o,h,f,new k(t,e)),this._addCollisionDebugVertex(u,c,o,h,f,new k(n,e)),this._addCollisionDebugVertex(u,c,o,h,f,new k(n,r)),this._addCollisionDebugVertex(u,c,o,h,f,new k(t,r)),s.vertexLength+=4;const p=i.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),s.primitiveLength+=4}addDebugCollisionBoxes(t,e,n,r){for(let i=t;i<e;i++){const t=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,r?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zu(uo,il.members,fo),this.iconCollisionBox=new zu(uo,il.members,fo);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,n,r,i,o,a,s,l){const u={};for(let c=e;c<n;c++){const e=t.get(c);u.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.textFeatureIndex=e.featureIndex;break}for(let c=r;c<i;c++){const e=t.get(c);u.verticalTextBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.verticalTextFeatureIndex=e.featureIndex;break}for(let c=o;c<a;c++){const e=t.get(c);u.iconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.iconFeatureIndex=e.featureIndex;break}for(let c=s;c<l;c++){const e=t.get(c);u.verticalIconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.verticalIconFeatureIndex=e.featureIndex;break}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs;for(let i=n.vertexStartIndex;i<r;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),r=[],i=[],o=[];for(let a=0;a<this.symbolInstances.length;++a){o.push(a);const t=this.symbolInstances.get(a);r.push(0|Math.round(e*t.anchorX+n*t.anchorY)),i.push(t.featureIndex)}return o.sort(((t,e)=>r[t]-r[e]||i[e]-i[t])),o}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ir("SymbolBucket",Ou,{omit:["layers","collisionBoxArray","features","compareText"]}),Ou.MAX_GLYPHS=65535,Ou.addDynamicAttributes=Ru;const Fu=new pi({"symbol-placement":new li(rt.layout_symbol["symbol-placement"]),"symbol-spacing":new li(rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new li(rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ui(rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new li(rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new li(rt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new li(rt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new li(rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new li(rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new li(rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ui(rt.layout_symbol["icon-size"]),"icon-text-fit":new li(rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new li(rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ui(rt.layout_symbol["icon-image"]),"icon-rotate":new ui(rt.layout_symbol["icon-rotate"]),"icon-padding":new ui(rt.layout_symbol["icon-padding"]),"icon-keep-upright":new li(rt.layout_symbol["icon-keep-upright"]),"icon-offset":new ui(rt.layout_symbol["icon-offset"]),"icon-anchor":new ui(rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new li(rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new li(rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new li(rt.layout_symbol["text-rotation-alignment"]),"text-field":new ui(rt.layout_symbol["text-field"]),"text-font":new ui(rt.layout_symbol["text-font"]),"text-size":new ui(rt.layout_symbol["text-size"]),"text-max-width":new ui(rt.layout_symbol["text-max-width"]),"text-line-height":new li(rt.layout_symbol["text-line-height"]),"text-letter-spacing":new ui(rt.layout_symbol["text-letter-spacing"]),"text-justify":new ui(rt.layout_symbol["text-justify"]),"text-radial-offset":new ui(rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new li(rt.layout_symbol["text-variable-anchor"]),"text-anchor":new ui(rt.layout_symbol["text-anchor"]),"text-max-angle":new li(rt.layout_symbol["text-max-angle"]),"text-writing-mode":new li(rt.layout_symbol["text-writing-mode"]),"text-rotate":new ui(rt.layout_symbol["text-rotate"]),"text-padding":new li(rt.layout_symbol["text-padding"]),"text-keep-upright":new li(rt.layout_symbol["text-keep-upright"]),"text-transform":new ui(rt.layout_symbol["text-transform"]),"text-offset":new ui(rt.layout_symbol["text-offset"]),"text-allow-overlap":new li(rt.layout_symbol["text-allow-overlap"]),"text-overlap":new li(rt.layout_symbol["text-overlap"]),"text-ignore-placement":new li(rt.layout_symbol["text-ignore-placement"]),"text-optional":new li(rt.layout_symbol["text-optional"])});var Bu={paint:new pi({"icon-opacity":new ui(rt.paint_symbol["icon-opacity"]),"icon-color":new ui(rt.paint_symbol["icon-color"]),"icon-halo-color":new ui(rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ui(rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ui(rt.paint_symbol["icon-halo-blur"]),"icon-translate":new li(rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new li(rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ui(rt.paint_symbol["text-opacity"]),"text-color":new ui(rt.paint_symbol["text-color"],{runtimeType:mt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new ui(rt.paint_symbol["text-halo-color"]),"text-halo-width":new ui(rt.paint_symbol["text-halo-width"]),"text-halo-blur":new ui(rt.paint_symbol["text-halo-blur"]),"text-translate":new li(rt.paint_symbol["text-translate"]),"text-translate-anchor":new li(rt.paint_symbol["text-translate-anchor"])}),layout:Fu};class ju{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ht,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ir("FormatSectionOverride",ju,{omit:["defaultValue"]});class Uu extends mi{constructor(t){super(t,Bu)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const n of t)e.indexOf(n)<0&&e.push(n);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,r){const i=this.layout.get(t).evaluate(e,{},n,r),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||Dn(o.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,((e,n)=>n in t?String(t[n]):""))}(e.properties,i)}createBucket(t){return new Ou(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Bu.paint.overridableProperties){if(!Uu.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new ju(e),r=new Rn(n,e.property.specification);let i=null;i="constant"===e.value.kind||"source"===e.value.kind?new zn("source",r):new On("composite",r,e.value.zoomStops),this.paint._values[t]=new ai(e.property,i,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&Uu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),r=Bu.paint.properties[e];let i=!1;const o=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof Ot)o(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{i||(e instanceof qt&&Vt(e.value)===_t?o(e.value.sections):e instanceof hn?o(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return i}}function Vu(t,e,n){let r="never";const i=t.get(e);return i?r=i:t.get(n)&&(r="always"),r}var Zu={paint:new pi({"background-color":new li(rt.paint_background["background-color"]),"background-pattern":new hi(rt.paint_background["background-pattern"]),"background-opacity":new li(rt.paint_background["background-opacity"])})},qu={paint:new pi({"raster-opacity":new li(rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new li(rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new li(rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new li(rt.paint_raster["raster-brightness-max"]),"raster-saturation":new li(rt.paint_raster["raster-saturation"]),"raster-contrast":new li(rt.paint_raster["raster-contrast"]),"raster-resampling":new li(rt.paint_raster["raster-resampling"]),"raster-fade-duration":new li(rt.paint_raster["raster-fade-duration"])})};class Gu extends mi{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Wu={circle:class extends mi{constructor(t){super(t,ha)}createBucket(t){return new Yo(t)}queryRadius(t){const e=t;return sa("circle-radius",this,e)+sa("circle-stroke-width",this,e)+la(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,r,i,o,a,s){const l=ua(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(t,e){return t.map((t=>Sa(t,e)))}(l,s),f=c?u*a:u;for(const p of r)for(const t of p){const e=c?t:Sa(t,s);let n=f;const r=ba([],[t.x,t.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?n*=r[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(n*=o.cameraToCenterDistance/r[3]),Ko(h,e,n))return!0}return!1}},heatmap:class extends mi{constructor(t){super(t,ka),this._updateColorRamp()}createBucket(t){return new Ea(t)}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ma({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends mi{constructor(t){super(t,La)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends mi{constructor(t){super(t,ys)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new gs(t)}queryRadius(){return la(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,r,i,o,a){return Jo(ua(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)}isTileClipped(){return!0}},"fill-extrusion":class extends mi{constructor(t){super(t,js)}createBucket(t){return new Os(t)}queryRadius(){return la(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,n,r,i,o,a,s){const l=ua(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),u=this.paint.get("fill-extrusion-height").evaluate(e,n),c=this.paint.get("fill-extrusion-base").evaluate(e,n),h=function(t,e,n,r){const i=[];for(const o of t){const t=[o.x,o.y,0,1];ba(t,t,e),i.push(new k(t[0]/t[3],t[1]/t[3]))}return i}(l,s),f=function(t,e,n,r){const i=[],o=[],a=r[8]*e,s=r[9]*e,l=r[10]*e,u=r[11]*e,c=r[8]*n,h=r[9]*n,f=r[10]*n,p=r[11]*n;for(const d of t){const t=[],e=[];for(const n of d){const i=n.x,o=n.y,d=r[0]*i+r[4]*o+r[12],m=r[1]*i+r[5]*o+r[13],g=r[2]*i+r[6]*o+r[14],v=r[3]*i+r[7]*o+r[15],y=g+l,_=v+u,x=d+c,b=m+h,w=g+f,S=v+p,E=new k((d+a)/_,(m+s)/_);E.z=y/_,t.push(E);const C=new k(x/S,b/S);C.z=w/S,e.push(C)}i.push(t),o.push(e)}return[i,o]}(r,c,u,s);return function(t,e,n){let r=1/0;Jo(n,e)&&(r=Vs(n,e[0]));for(let i=0;i<e.length;i++){const o=e[i],a=t[i];for(let t=0;t<o.length-1;t++){const e=o[t],i=[e,o[t+1],a[t+1],a[t],e];$o(n,i)&&(r=Math.min(r,Vs(n,i)))}}return r!==1/0&&r}(f[0],f[1],h)}},line:class extends mi{constructor(t){super(t,Js),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ee,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Qs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new $s(t)}queryRadius(t){const e=t,n=tl(sa("line-width",this,e),sa("line-gap-width",this,e)),r=sa("line-offset",this,e);return n/2+Math.abs(r)+la(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,r,i,o,a){const s=ua(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),l=a/2*tl(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(r=function(t,e){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=[];for(let t=0;t<i.length;t++){const n=i[t-1],r=i[t],a=i[t+1],s=0===t?new k(0,0):r.sub(n)._unit()._perp(),l=t===i.length-1?new k(0,0):a.sub(r)._unit()._perp(),u=s._add(l)._unit(),c=u.x*l.x+u.y*l.y;0!==c&&u._mult(1/c),o.push(u._mult(e)._add(r))}n.push(o)}return n}(r,u*a)),function(t,e,n){for(let r=0;r<e.length;r++){const i=e[r];if(t.length>=3)for(let e=0;e<i.length;e++)if(oa(t,i[e]))return!0;if(Qo(t,i,n))return!0}return!1}(s,r,l)}isTileClipped(){return!0}},symbol:Uu,background:class extends mi{constructor(t){super(t,Zu)}},raster:class extends mi{constructor(t){super(t,qu)}}};class Xu{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const Hu=6371008.8;class Yu{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Yu(a(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,r=t.lat*e,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return Hu*Math.acos(Math.min(i,1))}toBounds(t=0){const e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new $u(new Yu(this.lng-n,this.lat-e),new Yu(this.lng+n,this.lat+e))}static convert(t){if(t instanceof Yu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Yu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Yu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class $u{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Yu?new Yu(t.lng,t.lat):Yu.convert(t),this}setSouthWest(t){return this._sw=t instanceof Yu?new Yu(t.lng,t.lat):Yu.convert(t),this}extend(t){const e=this._sw,n=this._ne;let r,i;if(t instanceof Yu)r=t,i=t;else{if(!(t instanceof $u))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend($u.convert(t)):this.extend(Yu.convert(t)):this;if(r=t._sw,i=t._ne,!r||!i)return this}return e||n?(e.lng=Math.min(r.lng,e.lng),e.lat=Math.min(r.lat,e.lat),n.lng=Math.max(i.lng,n.lng),n.lat=Math.max(i.lat,n.lat)):(this._sw=new Yu(r.lng,r.lat),this._ne=new Yu(i.lng,i.lat)),this}getCenter(){return new Yu((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Yu(this.getWest(),this.getNorth())}getSouthEast(){return new Yu(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=Yu.convert(t);let r=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}static convert(t){return t instanceof $u?t:t?new $u(t):t}}const Ku=2*Math.PI*Hu;function Ju(t){return Ku*Math.cos(t*Math.PI/180)}function Qu(t){return(180+t)/360}function tc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ec(t,e){return t/Ju(e)}function nc(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class rc{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=Yu.convert(t);return new rc(Qu(n.lng),tc(n.lat),ec(e,n.lat))}toLngLat(){return new Yu(360*this.x-180,nc(this.y))}toAltitude(){return this.z*Ju(nc(this.y))}meterInMercatorCoordinateUnits(){return 1/Ku*(t=nc(this.y),1/Math.cos(t*Math.PI/180));var t}}function ic(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class oc{constructor(t,e,n){if(t<0||t>25||n<0||n>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${n}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=n,this.key=lc(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,n){const r=(o=this.y,a=this.z,s=ic(256*(i=this.x),256*(o=Math.pow(2,a)-o-1),a),l=ic(256*(i+1),256*(o+1),a),s[0]+","+s[1]+","+l[0]+","+l[1]);var i,o,a,s,l;const u=function(t,e,n){let r,i="";for(let o=t;o>0;o--)r=1<<o-1,i+=(e&r?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,r)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new k((t.x*e-this.x)*Zo,(t.y*e-this.y)*Zo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ac{constructor(t,e){this.wrap=t,this.canonical=e,this.key=lc(t,e.z,e.z,e.x,e.y)}}class sc{constructor(t,e,n,r,i){if(t<n)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${n}`);this.overscaledZ=t,this.wrap=e,this.canonical=new oc(n,+r,+i),this.key=lc(e,t,n,r,i)}clone(){return new sc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new sc(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sc(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?lc(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):lc(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new sc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new sc(e,this.wrap,e,n,r),new sc(e,this.wrap,e,n+1,r),new sc(e,this.wrap,e,n,r+1),new sc(e,this.wrap,e,n+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new sc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new sc(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ac(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new rc(t.x-this.wrap,t.y))}}function lc(t,e,n,r,i){(t*=2)<0&&(t=-1*t-1);const o=1<<n;return(o*o*t+o*i+r).toString(36)+n.toString(36)+e.toString(36)}Ir("CanonicalTileID",oc),Ir("OverscaledTileID",sc,{omit:["posMatrix"]});class uc{constructor(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return void d(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(let i=0;i<r;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(r,i)]=this.data[this._idx(r-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,r)]=this.data[this._idx(i,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let i=0;i<r;i++)for(let t=0;t<r;t++){const e=this.get(i,t);e>this.max&&(this.max=e),e<this.min&&(this.min=e)}}get(t,e){const n=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,n){return(256*t*256+256*e+n)/10-1e4}_unpackTerrarium(t,e,n){return 256*t+e+n/256-32768}getPixels(){return new Aa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}const s=-e*this.dim,l=-n*this.dim;for(let u=o;u<a;u++)for(let e=r;e<i;e++)this.data[this._idx(e,u)]=t.data[this._idx(e+s,u+l)]}}Ir("DEMData",uc);class cc{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class hc{constructor(t,e,n,r,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}class fc{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new kr(Zo,16,0),this.grid3D=new kr(Zo,16,0),this.featureIndexArray=new Ji,this.promoteId=e}insert(t,e,n,r,i,o){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);const s=o?this.grid3D:this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const r=t[e];n[0]=Math.min(n[0],r.x),n[1]=Math.min(n[1],r.y),n[2]=Math.max(n[2],r.x),n[3]=Math.max(n[3],r.y)}n[0]<Zo&&n[1]<Zo&&n[2]>=0&&n[3]>=0&&s.insert(a,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ws.VectorTile(new ul(this.rawTileData)).layers,this.sourceLayerCoder=new cc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,n,r){this.loadVTLayers();const i=t.params||{},o=Zo/t.tileSize/t.scale,a=Yn(i.filter),s=t.queryGeometry,l=t.queryPadding*o,u=dc(s),c=this.grid.query(u.minX-l,u.minY-l,u.maxX+l,u.maxY+l),h=dc(t.cameraQueryGeometry),f=this.grid3D.query(h.minX-l,h.minY-l,h.maxX+l,h.maxY+l,((e,n,r,i)=>function(t,e,n,r,i){for(const a of t)if(e<=a.x&&n<=a.y&&r>=a.x&&i>=a.y)return!0;const o=[new k(e,n),new k(e,i),new k(r,i),new k(r,n)];if(t.length>2)for(const a of o)if(oa(t,a))return!0;for(let a=0;a<t.length-1;a++)if(aa(t[a],t[a+1],o))return!0;return!1}(t.cameraQueryGeometry,e-l,n-l,r+l,i+l)));for(const m of f)c.push(m);c.sort(mc);const p={};let d;for(let m=0;m<c.length;m++){const l=c[m];if(l===d)continue;d=l;const u=this.featureIndexArray.get(l);let h=null;this.loadMatchingFeature(p,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,a,i.layers,i.availableImages,e,n,r,((e,n,r)=>(h||(h=Wo(e)),n.queryIntersectsFeature(s,e,r,h,this.z,t.transform,o,t.pixelPosMatrix))))}return p}loadMatchingFeature(t,e,n,r,i,o,a,l,u,c,h){const f=this.bucketLayerIDs[e];if(o&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,f))return;const p=this.sourceLayerCoder.decode(n),d=this.vtLayers[p].feature(r);if(i.needGeometry){const t=Xo(d,!0);if(!i.filter(new Qr(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!i.filter(new Qr(this.tileID.overscaledZ),d))return;const m=this.getId(d,p);for(let g=0;g<f.length;g++){const e=f[g];if(o&&o.indexOf(e)<0)continue;const n=l[e];if(!n)continue;let i={};m&&c&&(i=c.getState(n.sourceLayer||"_geojsonTileLayer",m));const p=s({},u[e]);p.paint=pc(p.paint,n.paint,d,i,a),p.layout=pc(p.layout,n.layout,d,i,a);const v=!h||h(d,n,i);if(!v)continue;const y=new hc(d,this.z,this.x,this.y,m);y.layer=p;let _=t[e];void 0===_&&(_=t[e]=[]),_.push({featureIndex:r,feature:y,intersectionZ:v})}}lookupSymbolFeatures(t,e,n,r,i,o,a,s){const l={};this.loadVTLayers();const u=Yn(i);for(const c of t)this.loadMatchingFeature(l,n,r,c,u,o,a,s,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;return this.promoteId&&(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof n&&(n=Number(n))),n}}function pc(t,e,n,r,i){return c(t,((t,o)=>{const a=e instanceof si?e.get(o):null;return a&&a.evaluate?a.evaluate(n,r,i):a}))}function dc(t){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(const o of t)e=Math.min(e,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x),i=Math.max(i,o.y);return{minX:e,minY:n,maxX:r,maxY:i}}function mc(t,e){return e-t}var gc;Ir("FeatureIndex",fc,{omit:["rawTileData","sourceLayerCoder"]}),t.PerformanceMarkers=void 0,(gc=t.PerformanceMarkers||(t.PerformanceMarkers={})).create="create",gc.load="load",gc.fullLoad="fullLoad";let vc=null,yc=[];const _c=1e3/30,xc={mark(t){performance.mark(t)},frame(t){const e=t;null!=vc&&yc.push(e-vc),vc=e},clearMetrics(){vc=null,yc=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const e in t.PerformanceMarkers)performance.clearMarks(t.PerformanceMarkers[e])},getPerformanceMetrics(){performance.measure("loadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.load),performance.measure("fullLoadTime",t.PerformanceMarkers.create,t.PerformanceMarkers.fullLoad);const e=performance.getEntriesByName("loadTime")[0].duration,n=performance.getEntriesByName("fullLoadTime")[0].duration,r=yc.length,i=1/(yc.reduce(((t,e)=>t+e),0)/r/1e3),o=yc.filter((t=>t>_c)).reduce(((t,e)=>t+(e-_c)/_c),0);return{loadTime:e,fullLoadTime:n,fps:i,percentDroppedFrames:o/(r+o)*100}}};t.AJAXError=V,t.ARRAY_TYPE=pa,t.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},u(["receive","process"],this),this.invoker=new Xu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=v()?t:window}send(t,e,n,r,i=!1){const o=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[o]=n);const a=w(this.globalScope)?void 0:[];return this.target.postMessage({id:o,type:t,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:Pr(e,a)},a),{cancel:()=>{n&&delete this.callbacks[o],this.target.postMessage({id:o,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t()}else v()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)}process(){if(!this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(Ar(e.error)):n(null,Ar(e.data)))}else{let n=!1;const r=w(this.globalScope)?void 0:[],i=e.hasCallback?(e,i)=>{n=!0,delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?Pr(e):null,data:Pr(i,r)},r)}:t=>{n=!0};let o=null;const a=Ar(e.data);if(this.parent[e.type])o=this.parent[e.type](e.sourceMapId,a,i);else if(this.parent.getWorkerSource){const t=e.type.split(".");o=this.parent.getWorkerSource(e.sourceMapId,t[0],a.source)[t[1]](a,i)}else i(new Error(`Could not find function ${e.type}`));!n&&o&&o.cancel&&(this.cancelCallbacks[t]=o.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.AlphaImage=Pa,t.CanonicalTileID=oc,t.CollisionBoxArray=qi,t.CollisionCircleLayoutArray=class extends Li{},t.Color=Dt,t.DEMData=uc,t.DataConstantProperty=li,t.DictionaryCoder=cc,t.EXTENT=Zo,t.ErrorEvent=et,t.EvaluationParameters=Qr,t.Event=tt,t.Evented=nt,t.FeatureIndex=fc,t.FillBucket=gs,t.FillExtrusionBucket=Os,t.GeoJSONFeature=hc,t.ImageAtlas=Ol,t.ImagePosition=zl,t.LineBucket=$s,t.LineStripIndexArray=class extends Ui{},t.LngLat=Yu,t.LngLatBounds=$u,t.MercatorCoordinate=rc,t.ONE_EM=ll,t.OverscaledTileID=sc,t.PerformanceUtils=xc,t.PosArray=Qi,t.Properties=pi,t.QuadTriangleArray=class extends Di{},t.RGBAImage=Aa,t.RasterBoundsArray=class extends wi{},t.RequestPerformance=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}},t.ResourceType=U,t.SegmentVector=go,t.SymbolBucket=Ou,t.Transitionable=ni,t.TriangleIndexArray=ho,t.Uniform1f=Po,t.Uniform1i=class extends To{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.Uniform2f=class extends To{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.Uniform3f=class extends To{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.Uniform4f=Ao,t.UniformColor=Mo,t.UniformMatrix4f=class extends To{constructor(t,e){super(t,e),this.current=Lo}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=ac,t.ValidationError=it,t.ZoomHistory=Mr,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=Ru,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);let r=t.length;const i=new Array(t.length);let o=null;t.forEach(((t,a)=>{e(t,((t,e)=>{t&&(o=t),i[a]=e,0==--r&&n(o,i)}))}))},t.bezier=r,t.bindAll=u,t.cacheEntryPossiblyAdded=function(t){D++,D>L&&(t.getActor().send("enforceCacheSizeLimit",M),D=0)},t.clamp=o,t.clearTileCache=function(t){const e=caches.delete(T);t&&e.catch(t).then((()=>t()))},t.clipLine=cu,t.clone=function(t){var e=new pa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=f,t.clone$2=function(t){var e=new pa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=ol,t.config=I,t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.create=function(){var t=new pa(16);return pa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=da,t.createExpression=Nn,t.createFilter=Yn,t.createLayout=_i,t.createStyleLayer=function(t){return"custom"===t.type?new Gu(t):new Wu[t.type](t)},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=i*l-o*s,t[1]=o*a-r*l,t[2]=r*s-i*a,t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=i,t.emitValidationErrors=Er,t.enforceCacheSizeLimit=function(t){R(),P&&P.then((e=>{e.keys().then((n=>{for(let r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],p=t[11],d=t[12],m=t[13],g=t[14],v=t[15],y=e[0],_=e[1],x=e[2],b=e[3],w=e[4],S=e[5],E=e[6],k=e[7],C=e[8],I=e[9],T=e[10],P=e[11],A=e[12],M=e[13],L=e[14],R=e[15];return Math.abs(n-y)<=fa*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-_)<=fa*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-x)<=fa*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-b)<=fa*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=fa*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=fa*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-E)<=fa*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-k)<=fa*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(c-C)<=fa*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-I)<=fa*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(f-T)<=fa*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(p-P)<=fa*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-A)<=fa*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-M)<=fa*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-L)<=fa*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(v-R)<=fa*Math.max(1,Math.abs(v),Math.abs(R))},t.evaluateSizeForFeature=function(t,{uSize:e,uSizeT:n},{lowerSize:r,upperSize:i}){return"source"===t.kind?r/tu:"composite"===t.kind?ke(r/tu,i/tu,n):e},t.evaluateSizeForZoom=function(t,e){let n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:i,minZoom:a,maxZoom:s}=t,l=i?o(qe.interpolationFactor(i,e,a,s),0,1):0;"camera"===t.kind?r=ke(t.minSize,t.maxSize,l):n=l}return{uSizeT:n,uSize:r}},t.evaluateVariableOffset=Su,t.evented=Yr,t.exported=E,t.exported$1=N,t.extend=s,t.filterObject=h,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.getAnchorAlignment=$l,t.getAnchorJustification=Eu,t.getArrayBuffer=W,t.getImage=K,t.getJSON=function(t,e){return G(s(t,{type:"json"}),e)},t.getOverlapMode=Vu,t.getRTLTextPluginStatus=$r,t.getReferrer=Z,t.getVideo=function(t,e){const n=window.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let r=0;r<t.length;r++){const e=window.document.createElement("source");X(t[r])||(n.crossOrigin="Anonymous"),e.src=t[r],n.appendChild(e)}return{cancel:()=>{}}},t.identity=ma,t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],g=e[14],v=e[15],y=n*s-r*a,_=n*l-i*a,x=n*u-o*a,b=r*l-i*s,w=r*u-o*s,S=i*u-o*l,E=c*m-h*d,k=c*g-f*d,C=c*v-p*d,I=h*g-f*m,T=h*v-p*m,P=f*v-p*g,A=y*P-_*T+x*I+b*C-w*k+S*E;return A?(t[0]=(s*P-l*T+u*I)*(A=1/A),t[1]=(i*T-r*P-o*I)*A,t[2]=(m*S-g*w+v*b)*A,t[3]=(f*w-h*S-p*b)*A,t[4]=(l*C-a*P-u*k)*A,t[5]=(n*P-i*C+o*k)*A,t[6]=(g*x-d*S-v*_)*A,t[7]=(c*S-f*x+p*_)*A,t[8]=(a*T-s*C+u*E)*A,t[9]=(r*C-n*T-o*E)*A,t[10]=(d*w-m*x+v*y)*A,t[11]=(h*x-c*w-p*y)*A,t[12]=(s*k-a*I-l*E)*A,t[13]=(n*I-r*k+i*E)*A,t[14]=(m*_-d*b-g*y)*A,t[15]=(c*b-h*_+f*y)*A,t):null},t.isImageBitmap=S,t.isSafari=w,t.isWorker=v,t.keysDifference=function(t,e){const n=[];for(const r in t)r in e||n.push(r);return n},t.lazyLoadRTLTextPlugin=function(){Jr.isLoading()||Jr.isLoaded()||"deferred"!==$r()||Kr()},t.makeRequest=G,t.mapObject=c,t.mercatorXfromLng=Qu,t.mercatorYfromLat=tc,t.mercatorZfromAltitude=ec,t.mul=ya,t.mul$1=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.multiply=ga,t.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=ke,t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),l=1/(r-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(a+o)*u,t[15]=1,t},t.parseCacheControl=y,t.parseGlyphPbf=function(t){return new ul(t).readFields(Ll,[])},t.pbf=ul,t.performSymbolLayout=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=Zo/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;const n=e.bucket.layers[0].layout,r=e.bucket.layers[0]._unevaluatedLayout._values,i={layoutIconSize:r["icon-size"].possiblyEvaluate(new Qr(e.bucket.zoom+1),e.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new Qr(e.bucket.zoom+1),e.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new Qr(18))};if("composite"===e.bucket.textSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.textSizeData;i.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Qr(t),e.canonical),r["text-size"].possiblyEvaluate(new Qr(n),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.iconSizeData;i.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Qr(t),e.canonical),r["icon-size"].possiblyEvaluate(new Qr(n),e.canonical)]}const o=n.get("text-line-height")*ll,a="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),s=n.get("text-keep-upright"),l=n.get("text-size");for(const u of e.bucket.features){const r=n.get("text-font").evaluate(u,{},e.canonical).join(","),c=l.evaluate(u,{},e.canonical),h=i.layoutTextSize.evaluate(u,{},e.canonical),f=i.layoutIconSize.evaluate(u,{},e.canonical),p={horizontal:{},vertical:void 0},m=u.text;let g,v=[0,0];if(m){const i=m.toString(),l=n.get("text-letter-spacing").evaluate(u,{},e.canonical)*ll,f=Dr(i)?l:0,d=n.get("text-anchor").evaluate(u,{},e.canonical),g=n.get("text-variable-anchor");if(!g){const t=n.get("text-radial-offset").evaluate(u,{},e.canonical);v=t?Su(d,[t*ll,wu]):n.get("text-offset").evaluate(u,{},e.canonical).map((t=>t*ll))}let y=a?"center":n.get("text-justify").evaluate(u,{},e.canonical);const _=n.get("symbol-placement"),x="point"===_?n.get("text-max-width").evaluate(u,{},e.canonical)*ll:0,b=()=>{e.bucket.allowVerticalPlacement&&Rr(i)&&(p.vertical=Ul(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,x,o,d,"left",f,v,t.WritingMode.vertical,!0,_,h,c))};if(!a&&g){const n="auto"===y?g.map((t=>Eu(t))):[y];let i=!1;for(let a=0;a<n.length;a++){const s=n[a];if(!p.horizontal[s])if(i)p.horizontal[s]=p.horizontal[0];else{const n=Ul(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,x,o,"center",s,f,v,t.WritingMode.horizontal,!1,_,h,c);n&&(p.horizontal[s]=n,i=1===n.positionedLines.length)}}b()}else{"auto"===y&&(y=Eu(d));const n=Ul(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,x,o,d,y,f,v,t.WritingMode.horizontal,!1,_,h,c);n&&(p.horizontal[y]=n),b(),Rr(i)&&a&&s&&(p.vertical=Ul(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,x,o,d,y,f,v,t.WritingMode.vertical,!1,_,h,c))}}let y=!1;if(u.icon&&u.icon.name){const t=e.imageMap[u.icon.name];t&&(g=Jl(e.imagePositions[u.icon.name],n.get("icon-offset").evaluate(u,{},e.canonical),n.get("icon-anchor").evaluate(u,{},e.canonical)),y=!!t.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=y:e.bucket.sdfIcons!==y&&d("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}const _=Tu(p.horizontal)||p.vertical;e.bucket.iconsInText=!!_&&_.iconsInText,(_||g)&&ku(e.bucket,u,p,g,e.imageMap,i,h,f,v,y,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(o=1/(r-i)),t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){const n={};for(let r=0;r<e.length;r++){const i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=Jr,t.pointGeometry=k,t.polygonIntersectsPolygon=$o,t.potpack=Nl,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Ir,t.registerForPluginStateChange=function(t){return t({pluginStatus:Gr,pluginURL:Wr}),Yr.on("pluginStateChange",t),t},t.renderColorRamp=Ma,t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=a*i+c*r,t[6]=s*i+h*r,t[7]=l*i+f*r,t[8]=u*i-o*r,t[9]=c*i-a*r,t[10]=h*i-s*r,t[11]=f*i-l*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=a*i+c*r,t[2]=s*i+h*r,t[3]=l*i+f*r,t[4]=u*i-o*r,t[5]=c*i-a*r,t[6]=h*i-s*r,t[7]=f*i-l*r,t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){M=t,L=e},t.setRTLTextPlugin=function(t,e,n=!1){if(Gr===Ur||Gr===Vr||Gr===Zr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Wr=E.resolveURL(t),Gr=Ur,qr=e,Hr(),n||Kr()},t.spec=rt,t.sphericalToCartesian=function([t,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(n),y:t*Math.sin(e)*Math.sin(n),z:t*Math.cos(n)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.toEvaluationFeature=Xo,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.transformMat4=ba,t.transformMat4$1=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},t.translate=function(t,e,n){var r,i,o,a,s,l,u,c,h,f,p,d,m=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=r=e[0],t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=r*m+s*g+h*v+e[12],t[13]=i*m+l*g+f*v+e[13],t[14]=o*m+u*g+p*v+e[14],t[15]=a*m+c*g+d*v+e[15]),t},t.triggerPluginCompletionEvent=Xr,t.unicodeBlockLookup=Lr,t.uniqueId=function(){return l++},t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateLight=br,t.validateStyle=xr,t.vectorTile=ws,t.warnOnce=d,t.wrap=a})),r(["./shared"],(function(t){function e(t){const n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const r of t)n+=`${e(r)},`;return`${n}]`}const r=Object.keys(t).sort();let i="{";for(let o=0;o<r.length;o++)i+=`${JSON.stringify(r[o])}:${e(t[r[o]])},`;return`${i}}`}function n(n){let r="";for(const i of t.refProperties)r+=`/${e(n[i])}`;return r}class r{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,r){for(const n of e){this._layerConfigs[n.id]=n;const e=this._layers[n.id]=t.createStyleLayer(n);e._featureFilter=t.createFilter(e.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(const t of r)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const i=function(t,e){const r={};for(let o=0;o<t.length;o++){const i=e&&e[t[o].id]||n(t[o]);e&&(e[t[o].id]=i);let a=r[i];a||(a=r[i]=[]),a.push(t[o])}const i=[];for(const n in r)i.push(r[n]);return i}(Object.values(this._layerConfigs),this.keyCache);for(const t of i){const e=t.map((t=>this._layers[t.id])),n=e[0];if("none"===n.visibility)continue;const r=n.source||"";let i=this.familiesBySource[r];i||(i=this.familiesBySource[r]={});const o=n.sourceLayer||"_geojsonTileLayer";let a=i[o];a||(a=i[o]=[]),a.push(e)}}}class i{constructor(e){const n={},r=[];for(const t in e){const i=e[t],o=n[t]={};for(const t in i){const e=i[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n={x:0,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2};r.push(n),o[t]={rect:n,metrics:e.metrics}}}const{w:i,h:o}=t.potpack(r),a=new t.AlphaImage({width:i||1,height:o||1});for(const s in e){const r=e[s];for(const e in r){const i=r[+e];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const o=n[s][e].rect;t.AlphaImage.copy(i.bitmap,a,{x:0,y:0},{x:o.x+1,y:o.y+1},i.bitmap)}}this.image=a,this.positions=n}}t.register("GlyphAtlas",i);class o{constructor(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId}parse(e,n,r,o,s){this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;const l=new t.DictionaryCoder(Object.keys(e.layers).sort()),u=new t.FeatureIndex(this.tileID,this.promoteId);u.bucketLayerIDs=[];const c={},h={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},f=n.familiesBySource[this.source];for(const i in f){const n=e.layers[i];if(!n)continue;1===n.version&&t.warnOnce(`Vector tile source "${this.source}" layer "${i}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=l.encode(i),s=[];for(let t=0;t<n.length;t++){const e=n.feature(t),r=u.getId(e,i);s.push({feature:e,id:r,index:t,sourceLayerIndex:o})}for(const e of f[i]){const n=e[0];n.source!==this.source&&t.warnOnce(`layer.source = ${n.source} does not equal this.source = ${this.source}`),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(a(e,this.zoom,r),(c[n.id]=n.createBucket({index:u.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(s,h,this.tileID.canonical),u.bucketLayerIDs.push(e.map((t=>t.id))))}}let p,d,m,g;const v=t.mapObject(h.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(v).length?o.send("getGlyphs",{uid:this.uid,stacks:v},((t,e)=>{p||(p=t,d=e,x.call(this))})):d={};const y=Object.keys(h.iconDependencies);y.length?o.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},((t,e)=>{p||(p=t,m=e,x.call(this))})):m={};const _=Object.keys(h.patternDependencies);function x(){if(p)return s(p);if(d&&m&&g){const e=new i(d),n=new t.ImageAtlas(m,g);for(const i in c){const o=c[i];o instanceof t.SymbolBucket?(a(o.layers,this.zoom,r),t.performSymbolLayout({bucket:o,glyphMap:d,glyphPositions:e.positions,imageMap:m,imagePositions:n.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):o.hasPattern&&(o instanceof t.LineBucket||o instanceof t.FillBucket||o instanceof t.FillExtrusionBucket)&&(a(o.layers,this.zoom,r),o.addFeatures(h,this.tileID.canonical,n.patternPositions))}this.status="done",s(null,{buckets:Object.values(c).filter((t=>!t.isEmpty())),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?m:null,glyphPositions:this.returnDependencies?e.positions:null})}}_.length?o.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},((t,e)=>{p||(p=t,g=e,x.call(this))})):g={},x.call(this)}}function a(e,n,r){const i=new t.EvaluationParameters(n);for(const t of e)t.recalculate(i,r)}function s(e,n){const r=t.getArrayBuffer(e.request,((e,r,i,o)=>{e?n(e):r&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(r)),rawData:r,cacheControl:i,expires:o})}));return()=>{r.cancel(),n()}}class l{constructor(t,e,n,r){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||s,this.loading={},this.loaded={}}loadTile(e,n){const r=e.uid;this.loading||(this.loading={});const i=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),a=this.loading[r]=new o(e);a.abort=this.loadVectorData(e,((e,o)=>{if(delete this.loading[r],e||!o)return a.status="done",this.loaded[r]=a,n(e);const s=o.rawData,l={};o.expires&&(l.expires=o.expires),o.cacheControl&&(l.cacheControl=o.cacheControl);const u={};if(i){const t=i.finish();t&&(u.resourceTiming=JSON.parse(JSON.stringify(t)))}a.vectorTile=o.vectorTile,a.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(e||!r)return n(e);n(null,t.extend({rawTileData:s.slice(0)},r,l,u))})),this.loaded=this.loaded||{},this.loaded[r]=a}))}reloadTile(t,e){const n=this.loaded,r=t.uid,i=this;if(n&&n[r]){const o=n[r];o.showCollisionBoxes=t.showCollisionBoxes;const a=(t,n)=>{const r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,this.availableImages,i.actor,r)),e(t,n)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}}abortTile(t,e){const n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()}removeTile(t,e){const n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()}}class u{constructor(){this.loaded={}}loadTile(e,n){const{uid:r,encoding:i,rawImageData:o}=e,a=t.isImageBitmap(o)?this.getImageData(o):o,s=new t.DEMData(r,a,i);this.loaded=this.loaded||{},this.loaded[r]=s,n(null,s)}getImageData(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)}removeTile(t){const e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]}}var c=function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)h(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)h(e.coordinates[r],n);return e};function h(t,e){if(0!==t.length){f(t[0],e);for(var n=1;n<t.length;n++)f(t[n],!e)}}function f(t,e){for(var n=0,r=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=n+s;r+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+r>=0!=!!e&&t.reverse()}const p=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class d{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.pointGeometry(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const r=[];for(const e of n)r.push(new t.pointGeometry(e[0],e[1]));e.push(r)}return e}}toGeoJSON(t,e,n){return p.call(this,t,e,n)}}class m{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(t){return new d(this._features[t])}}var g={exports:{}},v=t.pointGeometry,y=t.vectorTile.VectorTileFeature,_=x;function x(t,e){this.options=e||{},this.features=t,this.length=t.length}function b(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}x.prototype.feature=function(t){return new b(this.features[t],this.options.extent)},b.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],r=[],i=0;i<n.length;i++)r.push(new v(n[i][0],n[i][1]));this.geometry.push(r)}return this.geometry},b.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[e,r,n,i]},b.prototype.toGeoJSON=y.prototype.toGeoJSON;var w=t.pbf,S=_;function E(t){var e=new w;return function(t,e){for(var n in t.layers)e.writeMessage(3,k,t.layers[n])}(t,e),e.finish()}function k(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,C,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,M,o[n])}function C(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,I,t),e.writeVarintField(3,n.type),e.writeMessage(4,A,n)}function I(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var l=n.properties[s],u=o[s];if(null!==l){void 0===u&&(r.push(s),o[s]=u=r.length-1),e.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,f=a[h];void 0===f&&(i.push(l),a[h]=f=i.length-1),e.writeVarint(f)}}}function T(t,e){return(e<<3)+(7&t)}function P(t){return t<<1^t>>31}function A(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var l=n[s],u=1;1===r&&(u=l.length),e.writeVarint(T(1,u));for(var c=3===r?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==r&&e.writeVarint(T(2,c-1));var f=l[h].x-i,p=l[h].y-o;e.writeVarint(P(f)),e.writeVarint(P(p)),i+=f,o+=p}3===r&&e.writeVarint(T(7,1))}}function M(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function L(t,e,n,r,i,o){if(i-r<=n)return;const a=r+i>>1;R(t,e,a,r,i,o%2),L(t,e,n,r,a-1,o+1),L(t,e,n,a+1,i,o+1)}function R(t,e,n,r,i,o){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);R(t,e,n,Math.max(r,Math.floor(n-s*u/a+c)),Math.min(i,Math.floor(n+(a-s)*u/a+c)),o)}const a=e[2*n+o];let s=r,l=i;for(D(t,e,r,n),e[2*i+o]>a&&D(t,e,r,i);s<l;){for(D(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*r+o]===a?D(t,e,r,l):(l++,D(t,e,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}}function D(t,e,n,r){N(t,n,r),N(e,2*n,2*r),N(e,2*n+1,2*r+1)}function N(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function z(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}g.exports=E,g.exports.fromVectorTileJs=E,g.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new S(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return E({layers:n})},g.exports.GeoJSONWrapper=S;const O=t=>t[0],F=t=>t[1];class B{constructor(t,e=O,n=F,r=64,i=Float64Array){this.nodeSize=r,this.points=t;const o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new i(2*t.length);for(let l=0;l<t.length;l++)a[l]=l,s[2*l]=e(t[l]),s[2*l+1]=n(t[l]);L(a,s,r,0,a.length-1,0)}range(t,e,n,r){return function(t,e,n,r,i,o,a){const s=[0,t.length-1,0],l=[];let u,c;for(;s.length;){const h=s.pop(),f=s.pop(),p=s.pop();if(f-p<=a){for(let a=p;a<=f;a++)u=e[2*a],c=e[2*a+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[a]);continue}const d=Math.floor((p+f)/2);u=e[2*d],c=e[2*d+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[d]);const m=(h+1)%2;(0===h?n<=u:r<=c)&&(s.push(p),s.push(d-1),s.push(m)),(0===h?i>=u:o>=c)&&(s.push(d+1),s.push(f),s.push(m))}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)}within(t,e,n){return function(t,e,n,r,i,o){const a=[0,t.length-1,0],s=[],l=i*i;for(;a.length;){const u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o){for(let i=h;i<=c;i++)z(e[2*i],e[2*i+1],n,r)<=l&&s.push(t[i]);continue}const f=Math.floor((h+c)/2),p=e[2*f],d=e[2*f+1];z(p,d,n,r)<=l&&s.push(t[f]);const m=(u+1)%2;(0===u?n-i<=p:r-i<=d)&&(a.push(h),a.push(f-1),a.push(m)),(0===u?n+i>=p:r+i>=d)&&(a.push(f+1),a.push(c),a.push(m))}return s}(this.ids,this.coords,t,e,n,this.nodeSize)}}const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},U=Math.fround||(V=new Float32Array(1),t=>(V[0]=+t,V[0]));var V;class Z{constructor(t){this.options=K(Object.create(j),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:r,nodeSize:i}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let a=[];for(let s=0;s<t.length;s++)t[s].geometry&&a.push(G(t[s],s));this.trees[r+1]=new B(a,J,Q,i,Float32Array),e&&console.timeEnd(o);for(let s=r;s>=n;s--){const t=+Date.now();a=this._cluster(a,s),this.trees[s]=new B(a,J,Q,i,Float32Array),e&&console.log("z%d: %d clusters in %dms",s,a.length,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let i=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){const t=this.getClusters([n,r,180,o],e),a=this.getClusters([-180,r,i,o],e);return t.concat(a)}const a=this.trees[this._limitZoom(e)],s=a.range(H(n),Y(o),H(i),Y(r)),l=[];for(const u of s){const t=a.points[u];l.push(t.numPoints?W(t):this.points[t.index])}return l}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.points[e];if(!o)throw new Error(r);const a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),l=[];for(const u of s){const e=i.points[u];e.parentId===t&&l.push(e.numPoints?W(e):this.points[e.index])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,n){const r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r}getTile(t,e,n){const r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:o,radius:a}=this.options,s=a/o,l=(n-s)/i,u=(n+1+s)/i,c={features:[]};return this._addTileFeatures(r.range((e-s)/i,l,(e+1+s)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-s/i,l,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,l,s/i,u),r.points,-1,n,i,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,r,i){const o=this.getChildren(e);for(const a of o){const e=a.properties;if(e&&e.cluster?i+e.point_count<=r?i+=e.point_count:i=this._appendLeaves(t,e.cluster_id,n,r,i):i<r?i++:t.push(a),t.length===n)break}return i}_addTileFeatures(t,e,n,r,i,o){for(const a of t){const t=e[a],s=t.numPoints;let l,u,c;if(s)l=X(t),u=t.x,c=t.y;else{const e=this.points[t.index];l=e.properties,u=H(e.geometry.coordinates[0]),c=Y(e.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(u*i-n)),Math.round(this.options.extent*(c*i-r))]],tags:l};let f;s?f=t.id:this.options.generateId?f=t.index:this.points[t.index].id&&(f=this.points[t.index].id),void 0!==f&&(h.id=f),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:r,extent:i,reduce:o,minPoints:a}=this.options,s=r/(i*Math.pow(2,e));for(let l=0;l<t.length;l++){const r=t[l];if(r.zoom<=e)continue;r.zoom=e;const i=this.trees[e+1],u=i.within(r.x,r.y,s),c=r.numPoints||1;let h=c;for(const t of u){const n=i.points[t];n.zoom>e&&(h+=n.numPoints||1)}if(h>c&&h>=a){let t=r.x*c,a=r.y*c,s=o&&c>1?this._map(r,!0):null;const f=(l<<5)+(e+1)+this.points.length;for(const n of u){const l=i.points[n];if(l.zoom<=e)continue;l.zoom=e;const u=l.numPoints||1;t+=l.x*u,a+=l.y*u,l.parentId=f,o&&(s||(s=this._map(r,!0)),o(s,this._map(l)))}r.parentId=f,n.push(q(t/h,a/h,f,h,s))}else if(n.push(r),h>1)for(const t of u){const r=i.points[t];r.zoom<=e||(r.zoom=e,n.push(r))}}return n}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?K({},t.properties):t.properties;const n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?K({},r):r}}function q(t,e,n,r,i){return{x:U(t),y:U(e),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function G(t,e){const[n,r]=t.geometry.coordinates;return{x:U(H(n)),y:U(Y(r)),zoom:1/0,index:e,parentId:-1}}function W(t){return{type:"Feature",id:t.id,properties:X(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),$(t.y)]}};var e}function X(t){const e=t.numPoints,n=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?Math.round(e/100)/10+"k":e;return K(K({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function H(t){return t/360+.5}function Y(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function $(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function K(t,e){for(const n in e)t[n]=e[n];return t}function J(t){return t.x}function Q(t){return t.y}function tt(t,e,n,r){for(var i,o=r,a=n-e>>1,s=n-e,l=t[e],u=t[e+1],c=t[n],h=t[n+1],f=e+3;f<n;f+=3){var p=et(t[f],t[f+1],l,u,c,h);if(p>o)i=f,o=p;else if(p===o){var d=Math.abs(f-a);d<s&&(i=f,s=d)}}o>r&&(i-e>3&&tt(t,e,i,r),t[i+2]=o,n-i>3&&tt(t,i,n,r))}function et(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var l=((t-n)*a+(e-r)*s)/(a*a+s*s);l>1?(n=i,r=o):l>0&&(n+=a*l,r+=s*l)}return(a=t-n)*a+(s=e-r)*s}function nt(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)rt(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)rt(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)rt(t,e[r][i])}(i),i}function rt(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function it(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===o)ot(i,s);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)ot(i[u],s);else if("LineString"===o)at(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(u=0;u<i.length;u++)at(i[u],s=[],a,!1),t.push(nt(l,"LineString",s,e.properties));return}st(i,s,a,!1)}else if("Polygon"===o)st(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)it(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];st(i[u],c,a,!0),s.push(c)}}t.push(nt(l,o,s,e.properties))}}function ot(t,e){e.push(lt(t[0])),e.push(ut(t[1])),e.push(0)}function at(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var l=lt(t[s][0]),u=ut(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=r?(i*u-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,tt(e,0,c,n),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function st(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];at(t[i],o,n,r),e.push(o)}}function lt(t){return t/360+.5}function ut(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function ct(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,f=c.type,p=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(p>=n&&d<r)l.push(c);else if(!(d<n||p>=r)){var m=[];if("Point"===f||"MultiPoint"===f)ht(h,m,n,r,i);else if("LineString"===f)ft(h,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===f)dt(h,m,n,r,i,!1);else if("Polygon"===f)dt(h,m,n,r,i,!0);else if("MultiPolygon"===f)for(var g=0;g<h.length;g++){var v=[];dt(h[g],v,n,r,i,!0),v.length&&m.push(v)}if(m.length){if(s.lineMetrics&&"LineString"===f){for(g=0;g<m.length;g++)l.push(nt(c.id,f,m[g],c.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===m.length?(f="LineString",m=m[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===m.length?"Point":"MultiPoint"),l.push(nt(c.id,f,m,c.tags))}}}return l.length?l:null}function ht(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function ft(t,e,n,r,i,o,a){for(var s,l,u=pt(t),c=0===i?gt:vt,h=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],m=t[f+2],g=t[f+3],v=t[f+4],y=0===i?p:d,_=0===i?g:v,x=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-v,2))),y<n?_>n&&(l=c(u,p,d,g,v,n),a&&(u.start=h+s*l)):y>r?_<r&&(l=c(u,p,d,g,v,r),a&&(u.start=h+s*l)):mt(u,p,d,m),_<n&&y>=n&&(l=c(u,p,d,g,v,n),x=!0),_>r&&y<=r&&(l=c(u,p,d,g,v,r),x=!0),!o&&x&&(a&&(u.end=h+s*l),e.push(u),u=pt(t)),a&&(h+=s)}var b=t.length-3;p=t[b],d=t[b+1],m=t[b+2],(y=0===i?p:d)>=n&&y<=r&&mt(u,p,d,m),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&mt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function pt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function dt(t,e,n,r,i,o){for(var a=0;a<t.length;a++)ft(t[a],e,n,r,i,o,!1)}function mt(t,e,n,r){t.push(e),t.push(n),t.push(r)}function gt(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function vt(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function yt(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=_t(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(_t(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(_t(o.geometry[s][u],e));i.push(l)}n.push(nt(o.id,a,i,o.tags))}return n}function _t(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function xt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(bt(u[r],u[r+1],e,o,a,s));else for(r=0;r<u.length;r++){var h=[];for(i=0;i<u[r].length;i+=2)h.push(bt(u[r][i],u[r][i+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function bt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function wt(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,St(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function St(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Et(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Et(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Et(a,u[s],t,n,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(f.id=e.id),t.features.push(f)}}function Et(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function kt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)it(n,t.features[r],e,r);else it(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(t,e){var n=e.buffer/e.extent,r=t,i=ct(t,1,-1-n,n,0,-1,2,e),o=ct(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=ct(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=yt(i,1).concat(r)),o&&(r=r.concat(yt(o,-1)))),r}(r,e),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ct(t,e,n){return 32*((1<<t)*n+e)+t}function It(t,e){const n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);const i=new m(r.features);let o=g.exports(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}kt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},kt.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],l=this.options,u=l.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=Ct(e,n,r),f=this.tiles[h];if(!f&&(u>1&&console.time("creation"),f=this.tiles[h]=wt(t,e,n,r,l),this.tileCoords.push({z:e,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(f.source=t,i){if(e===l.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,0!==t.length){u>1&&console.time("clipping");var m,g,v,y,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,E=1+b;m=g=v=y=null,_=ct(t,c,n-b,n+S,0,f.minX,f.maxX,l),x=ct(t,c,n+w,n+E,0,f.minX,f.maxX,l),t=null,_&&(m=ct(_,c,r-b,r+S,1,f.minY,f.maxY,l),g=ct(_,c,r+w,r+E,1,f.minY,f.maxY,l),_=null),x&&(v=ct(x,c,r-b,r+S,1,f.minY,f.maxY,l),y=ct(x,c,r+w,r+E,1,f.minY,f.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*r),s.push(g||[],e+1,2*n,2*r+1),s.push(v||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},kt.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=Ct(t,e=(e%a+a)%a,n);if(this.tiles[s])return xt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[Ct(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?xt(this.tiles[s],i):null):null};class Tt extends l{constructor(t,e,n,r){super(t,e,n,It),r&&(this.loadGeoJSON=r)}loadData(e,n){var r;null===(r=this._pendingRequest)||void 0===r||r.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const i=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request);this._pendingCallback=n,this._pendingRequest=this.loadGeoJSON(e,((r,o)=>{if(delete this._pendingCallback,delete this._pendingRequest,r||!o)return n(r);if("object"!=typeof o)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{c(o,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));const r=o.features.filter((t=>n.value.evaluate({zoom:0},t)));o={type:"FeatureCollection",features:r}}this._geoJSONIndex=e.cluster?new Z(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const r={},i={},o={accumulated:null,zoom:0},a={properties:null},s=Object.keys(n);for(const l of s){const[e,o]=n[l],a=t.createExpression(o),s=t.createExpression("string"==typeof e?[e,["accumulated"],["get",l]]:e);r[l]=a.value,i[l]=s.value}return e.map=t=>{a.properties=t;const e={};for(const n of s)e[n]=r[n].evaluate(o,a);return e},e.reduce=(t,e)=>{a.properties=e;for(const n of s)o.accumulated=t[n],t[n]=i[n].evaluate(o,a)},e}(e)).load(o.features):function(t,e){return new kt(t,e)}(o,e.geojsonVtOptions)}catch(r){return n(r)}this.loaded={};const a={};if(i){const t=i.finish();t&&(a.resourceTiming={},a.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}n(null,a)}}))}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)return t.getJSON(e.request,n);if("string"==typeof e.data)try{n(null,JSON.parse(e.data))}catch(t){n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}else n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class Pt{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:Tt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}setReferrer(t,e){this.referrer=e}setImages(t,e,n){this.availableImages[t]=e;for(const r in this.workerSources[t]){const n=this.workerSources[t][r];for(const t in n)n[t].availableImages=e}n()}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)}loadDEMTile(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)}reloadTile(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeDEMTile(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,r){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();r(n?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),n)}}catch(t){r(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e}getWorkerSource(t,e,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){const r={send:(e,n,r)=>{this.actor.send(e,n,r,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](r,this.getLayerIndex(t),this.getAvailableImages(t))}return this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new u),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}}return t.isWorker()&&(self.worker=new Pt(self)),Pt})),r(["./shared"],(function(t){var e=n;function n(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===r[e=t&&t.failIfMajorPerformanceCaveat]&&(r[e]=function(t){var e,r=function(t){var e=document.createElement("canvas"),r=Object.create(n.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,e.getContext("webgl",r)||e.getContext("experimental-webgl",r)}(t);if(!r)return!1;try{e=r.createShader(r.VERTEX_SHADER)}catch(t){return!1}return!(!e||r.isContextLost())&&(r.shaderSource(e,"void main() {}"),r.compileShader(e),!0===r.getShaderParameter(e,r.COMPILE_STATUS))}(e)),r[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var r={};function i(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!i(t[n],e[n]))return!1;return!0}return t===e}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class o{static testProp(t){if(!o.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in o.docStyle)return t[e];return t[0]}static create(t,e,n){const r=window.document.createElement(t);return void 0!==e&&(r.className=e),n&&n.appendChild(r),r}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none")}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect)}static setTransform(t,e){t.style[o.transformProp]=e}static addEventListener(t,e,n,r={}){t.addEventListener(e,n,"passive"in r?r:r.capture)}static removeEventListener(t,e,n,r={}){t.removeEventListener(e,n,"passive"in r?r:r.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",o.suppressClickInternal,!0)}),0)}static mousePos(e,n){const r=e.getBoundingClientRect();return new t.pointGeometry(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)}static touchPos(e,n){const r=e.getBoundingClientRect(),i=[];for(let o=0;o<n.length;o++)i.push(new t.pointGeometry(n[o].clientX-r.left-e.clientLeft,n[o].clientY-r.top-e.clientTop));return i}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}o.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,o.selectProp=o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o.transformProp=o.testProp(["transform","WebkitTransform"]);class a{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeSpriteURL(t,e,n){const r=function(t){const e=t.match(s);if(!e)throw new Error(`Unable to parse URL "${t}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}(t);return r.path+=`${e}${n}`,function(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}(r)}setTransformRequest(t){this._transformRequestFn=t}}const s=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class l{constructor(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)}update(e,n,r){const{width:i,height:o}=e,a=!(this.size&&this.size[0]===i&&this.size[1]===o||r),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(n&&n.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!n||!1!==n.premultiply)),a)this.size=[i,o],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,o,0,this.format,l.UNSIGNED_BYTE,e.data);else{const{x:n,y:a}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texSubImage2D(l.TEXTURE_2D,0,n,a,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,n,a,i,o,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(t,e,n){const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function u(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class c extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),r=!1),r}_validateStretch(t,e){if(!t)return!0;let n=0;for(const r of t){if(r[0]<n||r[1]<r[0]||e<r[1])return!1;n=r[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){const n=this.images[t];if(n.data.width!==e.data.width||n.data.height!==e.data.height)throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=n.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const r of t)this.images[r]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const r={};for(const i of e){this.images[i]||this.fire(new t.Event("styleimagemissing",{id:i}));const e=this.images[i];e?r[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,r)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{const n={w:r.data.width+2,h:r.data.height+2,x:0,y:0},i=new t.ImagePosition(n,r);this.patterns[e]={bin:n,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:r}=t.potpack(e),i=this.atlasImage;i.resize({width:n||1,height:r||1});for(const o in this.patterns){const{bin:e}=this.patterns[o],n=e.x+1,r=e.y+1,a=this.images[o].data,s=a.width,l=a.height;t.RGBAImage.copy(a,i,{x:0,y:0},{x:n,y:r},{width:s,height:l}),t.RGBAImage.copy(a,i,{x:0,y:l-1},{x:n,y:r-1},{width:s,height:1}),t.RGBAImage.copy(a,i,{x:0,y:0},{x:n,y:r+l},{width:s,height:1}),t.RGBAImage.copy(a,i,{x:s-1,y:0},{x:n-1,y:r},{width:1,height:l}),t.RGBAImage.copy(a,i,{x:0,y:0},{x:n+s,y:r},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const e=this.images[n];e||t.warnOnce(`Image with ID: "${n}" was not found`),u(e)&&this.updateImage(n,e)}}}const h=1e20;function f(t,e,n,r,i,o,a,s,l){for(let u=e;u<e+r;u++)p(t,n*o+u,o,i,a,s,l);for(let u=n;u<n+i;u++)p(t,u*o+e,1,r,a,s,l)}function p(t,e,n,r,i,o,a){o[0]=0,a[0]=-h,a[1]=h,i[0]=t[e];for(let s=1,l=0,u=0;s<r;s++){i[s]=t[e+s*n];const r=s*s;do{const t=o[l];u=(i[s]-i[t]+r-t*t)/(s-t)/2}while(u<=a[l]&&--l>-1);l++,o[l]=s,a[l]=u,a[l+1]=h}for(let s=0,l=0;s<r;s++){for(;a[l+1]<s;)l++;const r=o[l],u=s-r;t[e+s*n]=i[r]+u*u}}class d{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(e,n){const r=[];for(const t in e)for(const n of e[t])r.push({stack:t,id:n});t.asyncAll(r,(({stack:t,id:e},n)=>{let r=this.entries[t];r||(r=this.entries[t]={glyphs:{},requests:{},ranges:{}});let i=r.glyphs[e];if(void 0!==i)return void n(null,{stack:t,id:e,glyph:i});if(i=this._tinySDF(r,t,e),i)return r.glyphs[e]=i,void n(null,{stack:t,id:e,glyph:i});const o=Math.floor(e/256);if(256*o>65535)return void n(new Error("glyphs > 65535 not supported"));if(r.ranges[o])return void n(null,{stack:t,id:e,glyph:i});let a=r.requests[o];a||(a=r.requests[o]=[],d.loadGlyphRange(t,o,this.url,this.requestManager,((t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(r.glyphs[+t]=e[+t]);r.ranges[o]=!0}for(const n of a)n(t,e);delete r.requests[o]}))),a.push(((r,i)=>{r?n(r):i&&n(null,{stack:t,id:e,glyph:i[e]||null})}))}),((t,e)=>{if(t)n(t);else if(e){const t={};for(const{stack:n,id:r,glyph:i}of e)(t[n]||(t[n]={}))[r]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics};n(null,t)}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(t.unicodeBlockLookup["CJK Unified Ideographs"](e)||t.unicodeBlockLookup["Hangul Syllables"](e)||t.unicodeBlockLookup.Hiragana(e)||t.unicodeBlockLookup.Katakana(e))}_tinySDF(e,n,r){const i=this.localIdeographFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(r))return;let o=e.tinySDF;if(!o){let t="400";/bold/i.test(n)?t="900":/medium/i.test(n)?t="500":/light/i.test(n)&&(t="200"),o=e.tinySDF=new d.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:i,fontWeight:t})}const a=o.draw(String.fromCharCode(r));return{id:r,bitmap:new t.AlphaImage({width:a.width||30,height:a.height||30},a.data),metrics:{width:a.glyphWidth||24,height:a.glyphHeight||24,left:a.glyphLeft||0,top:a.glyphTop-27||-8,advance:a.glyphAdvance||24}}}}d.loadGlyphRange=function(e,n,r,i,o){const a=256*n,s=a+255,l=i.transformRequest(r.replace("{fontstack}",e).replace("{range}",`${a}-${s}`),t.ResourceType.Glyphs);t.getArrayBuffer(l,((e,n)=>{if(e)o(e);else if(n){const e={};for(const r of t.parseGlyphPbf(n))e[r.id]=r;o(null,e)}}))},d.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=n;const s=this.size=t+4*e,l=this._createCanvas(s),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${t}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(t),a=Math.ceil(n),s=Math.min(this.size-this.buffer,Math.ceil(o-i)),l=Math.min(this.size-this.buffer,a+Math.ceil(r)),u=s+2*this.buffer,c=l+2*this.buffer,p=Math.max(u*c,0),d=new Uint8ClampedArray(p),m={data:d,width:u,height:c,glyphWidth:s,glyphHeight:l,glyphTop:a,glyphLeft:0,glyphAdvance:e};if(0===s||0===l)return m;const{ctx:g,buffer:v,gridInner:y,gridOuter:_}=this;g.clearRect(v,v,s,l),g.fillText(t,v,v+a);const x=g.getImageData(v,v,s,l);_.fill(h,0,p),y.fill(0,0,p);for(let f=0;f<l;f++)for(let t=0;t<s;t++){const e=x.data[4*(f*s+t)+3]/255;if(0===e)continue;const n=(f+v)*u+t+v;if(1===e)_[n]=0,y[n]=h;else{const t=.5-e;_[n]=t>0?t*t:0,y[n]=t<0?t*t:0}}f(_,0,0,u,c,u,this.f,this.v,this.z),f(y,v,v,s,l,u,this.f,this.v,this.z);for(let h=0;h<p;h++){const t=Math.sqrt(_[h])-Math.sqrt(y[h]);d[h]=Math.round(255-255*(t/this.radius+this.cutoff))}return m}};const m=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))}interpolate(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),g="-transition";class v extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(m),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(t.validateLight,e,n))for(const t in e){const n=e[t];t.endsWith(g)?this._transitionable.setTransition(t.slice(0,-g.length),n):this._transitionable.setValue(t,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class y{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]}getDashRanges(t,e,n){const r=[];let i=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,a=!0;r.push({left:i,right:o,isDash:a,zeroLength:0===t[0]});let s=t[0];for(let l=1;l<t.length;l++){a=!a;const e=t[l];i=s*n,s+=e,o=s*n,r.push({left:i,right:o,isDash:a,zeroLength:0===e})}return r}addRoundDash(t,e,n){const r=e/2;for(let i=-n;i<=n;i++){const e=this.width*(this.nextRow+n+i);let o=0,a=t[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=t[++o]);const l=Math.abs(s-a.left),u=Math.abs(s-a.right),c=Math.min(l,u);let h;const f=i/n*(r+1);if(a.isDash){const t=r-Math.abs(f);h=Math.sqrt(c*c+t*t)}else h=r-Math.sqrt(c*c+f*f);this.data[e+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let a=t.length-1;a>=0;--a){const e=t[a],n=t[a+1];e.zeroLength?t.splice(a,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(a,1))}const e=t[0],n=t[t.length-1];e.isDash===n.isDash&&(e.left=n.left-this.width,n.right=e.right+this.width);const r=this.width*this.nextRow;let i=0,o=t[i];for(let a=0;a<this.width;a++){a/o.right>1&&(o=t[++i]);const e=Math.abs(a-o.left),n=Math.abs(a-o.right),s=Math.min(e,n);this.data[r+a]=Math.max(0,Math.min(255,(o.isDash?s:-s)+128))}}addDash(e,n){const r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;let o=0;for(let t=0;t<e.length;t++)o+=e[t];if(0!==o){const t=this.width/o,i=this.getDashRanges(e,this.width,t);n?this.addRoundDash(i,t,r):this.addRegularDash(i)}const a={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,a}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}class _{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const r=this.workerPool.acquire(this.id);for(let t=0;t<r.length;t++){const e=new _.Actor(r[t],n,this.id);e.name=`Worker ${t}`,this.actors.push(e)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n,r){t.asyncAll(this.actors,((t,r)=>{t.send(e,n,r)}),r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}function x(e,n,r){const i=function(n,i){if(n)return r(n);if(i){const n=t.pick(t.extend(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(n.vectorLayers=i.vector_layers,n.vectorLayerIds=n.vectorLayers.map((t=>t.id))),r(null,n)}};return e.url?t.getJSON(n.transformRequest(e.url,t.ResourceType.Source),i):t.exported.frame((()=>i(null,e)))}_.Actor=t.Actor;class b{constructor(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<o&&e.y>=i&&e.y<a}}class w extends t.Evented{constructor(e,n,r,i){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=x(this._options,this.map._requestManager,((e,n)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new b(n.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e,n){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",i,o.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class S extends t.Evented{constructor(e,n,r,i){super(),this.id=e,this.dispatcher=r,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=x(this._options,this.map._requestManager,((e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new b(n.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),((r,i,o)=>{if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(o);const r=this.map.painter.context,a=r.gl;e.texture=this.map.painter.getTileTexture(i.width),e.texture?e.texture.update(i,{useMipmap:!0}):(e.texture=new l(r,i,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),n(null)}}))}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}let E;class k extends S{constructor(e,n,r,i){super(e,n,r,i),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(e,n){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;const n=t.isImageBitmap(o)&&(null==E&&(E="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),E)?o:t.exported.getImageData(o,1),r={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:n,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",r,i.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)}_getNeighboringTiles(e){const n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class C extends t.Evented{constructor(e,n,r,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(i),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const o=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(n.clusterRadius||50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData("content"),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this}_updateWorkerData(e){const n=t.extend({},this.workerOptions),r=this._data;"string"==typeof r?(n.request=this.map._requestManager.transformRequest(t.exported.resolveURL(r),t.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(r),this._pendingLoads++,this.fire(new t.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,n,((n,r)=>{if(this._pendingLoads--,this._removed||r&&r.abandoned)return void this.fire(new t.Event("dataabort",{dataType:"source",sourceDataType:e}));let i=null;if(r&&r.resourceTiming&&r.resourceTiming[this.id]&&(i=r.resourceTiming[this.id].slice(0)),n)return void this.fire(new t.ErrorEvent(n));const o={dataType:"source",sourceDataType:e};this._collectResourceTiming&&i&&i.length>0&&t.extend(o,{resourceTiming:i}),this.fire(new t.Event("data",o))}))}loaded(){return 0===this._pendingLoads}loadTile(t,e){const n=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const r={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(n,r,((r,i)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):r?e(r):(t.loadVectorData(i,this.map.painter,"reloadTile"===n),e(null)))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var I=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class T extends t.Evented{constructor(t,e,n,r){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e}load(e,n){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),((r,i)=>{this._loaded=!0,r?this.fire(new t.ErrorEvent(r)):i&&(this.image=i,e&&(this.coordinates=e),n&&n(),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(e){this.coordinates=e;const n=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){let n=1/0,r=1/0,i=-1/0,o=-1/0;for(const t of e)n=Math.min(n,t.x),r=Math.min(r,t.y),i=Math.max(i,t.x),o=Math.max(o,t.y);const a=Math.max(i-n,o-r),s=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),l=Math.pow(2,s);return new t.CanonicalTileID(s,Math.floor((n+i)/2*l),Math.floor((r+o)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const r=n.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class P extends T{constructor(t,e,n,r){super(t,e,n,r),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,((e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new l(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class A extends T{constructor(e,n,r,i){super(e,n,r,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,r=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l(n,this.canvas,r.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const M={vector:w,raster:S,"raster-dem":k,geojson:C,video:P,image:T,canvas:A};function L(e,n){const r=t.create();return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function R(t,e,n,r,i,o){const a=function(t,e,n){if(t)for(const r of t){const t=e[r];if(t&&t.source===n&&"fill-extrusion"===t.type)return!0}else for(const r in e){const t=e[r];if(t.source===n&&"fill-extrusion"===t.type)return!0}return!1}(i&&i.layers,e,t.id),s=o.maxPitchScaleFactor(),l=t.tilesIn(r,s,a);l.sort(D);const u=[];for(const h of l)u.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(e,n,t._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,i,o,s,L(t.transform,h.tileID))});const c=function(t){const e={},n={};for(const r of t){const t=r.queryResults,i=r.wrappedTileID,o=n[i]=n[i]||{};for(const n in t){const r=t[n],i=o[n]=o[n]||{},a=e[n]=e[n]||[];for(const t of r)i[t.featureIndex]||(i[t.featureIndex]=!0,a.push(t))}}return e}(u);for(const h in c)c[h].forEach((e=>{const n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return c}function D(t,e){const n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}class N{constructor(e,n){this.tileID=e,this.uid=t.uniqueId(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<t.exported.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.textures.forEach((e=>t.saveTileTexture(e))),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(e,n,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const r of t){const t=r.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)n[e.id]=r}}return n}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.SymbolBucket){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.SymbolBucket&&n.hasRTLText){this.hasRTLText=!0,t.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const t in this.buckets){const e=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(t).queryRadius(e))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const n in this.buckets){const e=this.buckets[n];e.uploadPending()&&e.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,r,i,o,a,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:a,queryPadding:this.queryPadding*l},t,e,n):{}}querySourceFeatures(e,n){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const i=r.loadVTLayers(),o=n?n.sourceLayer:"",a=i._geojsonTileLayer||i[o];if(!a)return;const s=t.createFilter(n&&n.filter),{z:l,x:u,y:c}=this.tileID.canonical,h={z:l,x:u,y:c};for(let f=0;f<a.length;f++){const n=a.feature(f);if(s.needGeometry){const e=t.toEvaluationFeature(n,!0);if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),n))continue;const i=r.getId(n,o),p=new t.GeoJSONFeature(n,l,u,c,i);p.tile=h,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const n=t.parseCacheControl(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const t=Date.now();let e=!1;if(this.expirationTime>t)e=!1;else if(n)if(this.expirationTime<n)e=!0;else{const r=this.expirationTime-n;r?this.expirationTime=t+Math.max(r,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];if(!a||!s||0===Object.keys(s).length)continue;i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<t.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=t.exported.now()+e}setDependencies(t,e){const n={};for(const r of e)n[r]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}}class z{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const i={value:e,timeout:void 0};if(void 0!==n&&(i.timeout=setTimeout((()=>{this.remove(t,i)}),n)),this.data[r].push(i),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const r of this.data[n])t(r.value)||e.push(r);for(const n of e)this.remove(n.value.tileID,n)}}class O{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,r){const i=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.extend(this.stateChanges[e][i],r),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])r[t]||(this.deletedStates[e][i][t]=null)}else for(const t in r)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(e,n){const r=String(n),i=t.extend({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][n];if(null===t)return{};for(const e in t)delete i[e]}return i}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(e,n){const r={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const e={};for(const n in this.stateChanges[i])this.state[i][n]||(this.state[i][n]={}),t.extend(this.state[i][n],this.stateChanges[i][n]),e[n]=this.state[i][n];r[i]=e}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const e={};if(null===this.deletedStates[i])for(const t in this.state[i])e[t]={},this.state[i][t]={};else for(const t in this.deletedStates[i]){if(null===this.deletedStates[i][t])this.state[i][t]={};else for(const e of Object.keys(this.deletedStates[i][t]))delete this.state[i][t][e];e[t]=this.state[i][t]}r[i]=r[i]||{},t.extend(r[i],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const t in e)e[t].setFeatureState(r,n)}}class F extends t.Evented{constructor(e,n,r){super(),this.id=e,this.dispatcher=r,this.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=function(e,n,r,i){const o=new M[n.type](e,n,r,i);if(o.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${o.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(e,n,r,this),this._tiles={},this._cache=new z(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new O}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,e){return this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(e){this._source.abortTile&&this._source.abortTile(e,(()=>{})),this._source.fire(new t.Event("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(B).map((t=>t.key))}getRenderableIds(e){const n=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&n.push(this._tiles[t]);return e?n.sort(((e,n)=>{const r=e.tileID,i=n.tileID,o=new t.pointGeometry(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),a=new t.pointGeometry(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-i.overscaledZ||a.y-o.y||a.x-o.x})).map((t=>t.tileID.key)):n.map((t=>t.tileID)).sort(B).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform,this.terrain));e.timeAdded=t.exported.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const i=e[r];if(t.neighboringTiles&&t.neighboringTiles[i]){const e=this.getTileByID(i);n(t,e),n(e,t)}}function n(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,r){for(const i in this._tiles){let o=this._tiles[i];if(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)continue;let a=o.tileID;for(;o&&o.tileID.overscaledZ>e+1;){const t=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[t.key],o&&o.hasData()&&(a=t)}let s=a;for(;s.overscaledZ>e;)if(s=s.scaledTo(s.overscaledZ-1),t[s.key]){r[a.key]=a;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),r=this._getLoadedTile(e);if(r)return r}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*n*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}}update(e,n){if(this.transform=e,this.terrain=n,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(r=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(r=r.filter((t=>this._source.hasTile(t))))):r=[];const i=e.coveringZoomLevel(this._source),o=Math.max(i-F.maxOverzooming,this._source.minzoom),a=Math.max(i+F.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of r)if(e.canonical.z>this._source.minzoom){const n=e.scaledTo(e.canonical.z-1);t[n.key]=n;const r=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[r.key]=r}r=r.concat(Object.values(t))}const s=this._updateRetainedTiles(r,i);if(j(this._source.type)){const e={},l={},u=Object.keys(s);for(const n of u){const r=s[n],i=this._tiles[n];if(!i||i.fadeEndTime&&i.fadeEndTime<=t.exported.now())continue;const a=this.findLoadedParent(r,o);a&&(this._addTile(a.tileID),e[a.tileID.key]=a.tileID),l[n]=r}this._retainLoadedChildren(l,i,a,s);for(const t in e)s[t]||(this._coveredTiles[t]=!0,s[t]=e[t]);if(n){const t={},e={};for(const n of r)this._tiles[n.key].hasData()?t[n.key]=n:e[n.key]=n;for(const n in e){const r=e[n].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(t[r[0].key]=s[r[0].key]=r[0],t[r[1].key]=s[r[1].key]=r[1],t[r[2].key]=s[r[2].key]=r[2],t[r[3].key]=s[r[3].key]=r[3],delete e[n])}for(const n in e){const r=this.findLoadedParent(e[n],this._source.minzoom);if(r){t[r.tileID.key]=s[r.tileID.key]=r.tileID;for(const e in t)t[e].isChildOf(r.tileID)&&delete t[e]}}for(const n in this._tiles)t[n]||(this._coveredTiles[n]=!0)}}for(const t in s)this._tiles[t].clearFadeHold();const l=t.keysDifference(this._tiles,s);for(const t of l){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){const n={},r={},i=Math.max(e-F.maxOverzooming,this._source.minzoom),o=Math.max(e+F.maxUnderzooming,this._source.minzoom),a={};for(const s of t){const t=this._addTile(s);n[s.key]=s,t.hasData()||e<this._source.maxzoom&&(a[s.key]=s)}this._retainLoadedChildren(a,e,o,n);for(const s of t){let t=this._tiles[s.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=s.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){n[t.key]=t;continue}}else{const t=s.children(this._source.maxzoom);if(n[t[0].key]&&n[t[1].key]&&n[t[2].key]&&n[t[3].key])continue}let o=t.wasRequested();for(let e=s.overscaledZ-1;e>=i;--e){const i=s.scaledTo(e);if(r[i.key])break;if(r[i.key]=!0,t=this.getTile(i),!t&&o&&(t=this._addTile(i)),t&&(n[i.key]=i,o=t.wasRequested(),t.hasData()))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;r=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const r=n;return n||(n=new N(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(e,n,r){const i=[],o=this.transform;if(!o)return i;const a=r?o.getCameraQueryGeometry(e):e,s=e.map((t=>o.pointCoordinate(t,this.terrain))),l=a.map((t=>o.pointCoordinate(t,this.terrain))),u=this.getIds();let c=1/0,h=1/0,f=-1/0,p=-1/0;for(const t of l)c=Math.min(c,t.x),h=Math.min(h,t.y),f=Math.max(f,t.x),p=Math.max(p,t.y);for(let d=0;d<u.length;d++){const e=this._tiles[u[d]];if(e.holdingForFade())continue;const r=e.tileID,a=Math.pow(2,o.zoom-e.tileID.overscaledZ),m=n*e.queryPadding*t.EXTENT/e.tileSize/a,g=[r.getTilePoint(new t.MercatorCoordinate(c,h)),r.getTilePoint(new t.MercatorCoordinate(f,p))];if(g[0].x-m<t.EXTENT&&g[0].y-m<t.EXTENT&&g[1].x+m>=0&&g[1].y+m>=0){const t=s.map((t=>r.getTilePoint(t))),n=l.map((t=>r.getTilePoint(t)));i.push({tile:e,tileID:r,queryGeometry:t,cameraQueryGeometry:n,scale:a})}}return i}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const n of e)n.posMatrix=this.transform.calculatePosMatrix(n.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(j(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.exported.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const r=this._tiles[t];r&&r.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((n=>!n.hasDependency(t,e)))}}function B(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function j(t){return"raster"===t||"image"===t||"video"===t}F.maxOverzooming=10,F.maxUnderzooming=3;const U="mapboxgl_preloaded_worker_pool";class V{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<V.workerCount;)this.workers.push(new Worker(bi.workerUrl));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[U]}numActive(){return Object.keys(this.active).length}}const Z=Math.floor(t.exported.hardwareConcurrency/2);let q;function G(){return q||(q=new V),q}function W(e,n){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return t.refProperties.forEach((t=>{t in n&&(r[t]=n[t])})),r}function X(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=W(t[n],e[t[n].ref]));return t}V.workerCount=Math.max(Math.min(Z,6),1);const H={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Y(t,e,n){n.push({command:H.addSource,args:[t,e[t]]})}function $(t,e,n){e.push({command:H.removeSource,args:[t]}),n[t]=!0}function K(t,e,n,r){$(t,n,r),Y(t,e,n)}function J(t,e,n){let r;for(r in t[n])if(Object.prototype.hasOwnProperty.call(t[n],r)&&"data"!==r&&!i(t[n][r],e[n][r]))return!1;for(r in e[n])if(Object.prototype.hasOwnProperty.call(e[n],r)&&"data"!==r&&!i(t[n][r],e[n][r]))return!1;return!0}function Q(t,e,n,r,o,a){let s;for(s in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,s)&&(i(t[s],e[s])||n.push({command:a,args:[r,s,e[s],o]}));for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&!Object.prototype.hasOwnProperty.call(t,s)&&(i(t[s],e[s])||n.push({command:a,args:[r,s,e[s],o]}))}function tt(t){return t.id}function et(t,e){return t[e.id]=e,t}class nt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,r=this._distances[n];const i=e*this.paddedLength+this.padding;for(;r<i&&n<this._distances.length;)r=this._distances[++n];const o=n-1,a=this._distances[o],s=r-a,l=s>0?(i-a)/s:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}function rt(t,e){let n=!0;return"always"===t||"never"!==t&&"never"!==e||(n=!1),n}class it{constructor(t,e,n){const r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}insertCircle(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)}_insertBoxCell(t,e,n,r,i,o){this.boxCells[i].push(o)}_insertCircleCell(t,e,n,r,i,o){this.circleCells[i].push(o)}_query(t,e,n,r,i,o,a){if(n<0||t>this.width||r<0||e>this.height)return[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return[{key:null,x1:t,y1:e,x2:n,y2:r}];for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],r=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-r,y1:n-r,x2:e+r,y2:n+r})}}else this._forEachCell(t,e,n,r,this._queryCell,s,{hitTest:i,overlapMode:o,seenUids:{box:{},circle:{}}},a);return s}query(t,e,n,r){return this._query(t,e,n,r,!1,null)}hitTest(t,e,n,r,i,o){return this._query(t,e,n,r,!0,i,o).length>0}hitTestCircle(t,e,n,r,i){const o=t-n,a=t+n,s=e-n,l=e+n;if(a<0||o>this.width||l<0||s>this.height)return!1;const u=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,u,{hitTest:!0,overlapMode:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},i),u.length>0}_queryCell(t,e,n,r,i,o,a,s){const{seenUids:l,hitTest:u,overlapMode:c}=a,h=this.boxCells[i];if(null!==h){const i=this.bboxes;for(const a of h)if(!l.box[a]){l.box[a]=!0;const h=4*a,f=this.boxKeys[a];if(t<=i[h+2]&&e<=i[h+3]&&n>=i[h+0]&&r>=i[h+1]&&(!s||s(f))&&(!u||!rt(c,f.overlapMode))&&(o.push({key:f,x1:i[h],y1:i[h+1],x2:i[h+2],y2:i[h+3]}),u))return!0}}const f=this.circleCells[i];if(null!==f){const i=this.circles;for(const a of f)if(!l.circle[a]){l.circle[a]=!0;const h=3*a,f=this.circleKeys[a];if(this._circleAndRectCollide(i[h],i[h+1],i[h+2],t,e,n,r)&&(!s||s(f))&&(!u||!rt(c,f.overlapMode))){const t=i[h],e=i[h+1],n=i[h+2];if(o.push({key:f,x1:t-n,y1:e-n,x2:t+n,y2:e+n}),u)return!0}}}return!1}_queryCellCircle(t,e,n,r,i,o,a,s){const{circle:l,seenUids:u,overlapMode:c}=a,h=this.boxCells[i];if(null!==h){const t=this.bboxes;for(const e of h)if(!u.box[e]){u.box[e]=!0;const n=4*e,r=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!s||s(r))&&!rt(c,r.overlapMode))return o.push(!0),!0}}const f=this.circleCells[i];if(null!==f){const t=this.circles;for(const e of f)if(!u.circle[e]){u.circle[e]=!0;const n=3*e,r=this.circleKeys[e];if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!s||s(r))&&!rt(c,r.overlapMode))return o.push(!0),!0}}}_forEachCell(t,e,n,r,i,o,a,s){const l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r);for(let f=l;f<=c;f++)for(let l=u;l<=h;l++)if(i.call(this,t,e,n,r,this.xCellCount*l+f,o,a,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,r,i,o){const a=r-t,s=i-e,l=n+o;return l*l>a*a+s*s}_circleAndRectCollide(t,e,n,r,i,o,a){const s=(o-r)/2,l=Math.abs(t-(r+s));if(l>s+n)return!1;const u=(a-i)/2,c=Math.abs(e-(i+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;const h=l-s,f=c-u;return h*h+f*f<=n*n}}function ot(e,n,r,i,o){const a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):t.multiply(a,i.labelPlaneMatrix,e),a}function at(e,n,r,i,o){if(n){const n=t.clone(e);return t.scale(n,n,[o,o,1]),r||t.rotateZ(n,n,-i.angle),n}return i.glCoordMatrix}function st(e,n,r){let i;r?(i=[e.x,e.y,r(e.x,e.y),1],t.transformMat4(i,i,n)):(i=[e.x,e.y,0,1],yt(i,i,n));const o=i[3];return{point:new t.pointGeometry(i[0]/o,i[1]/o),signedDistanceFromCamera:o}}function lt(t,e){return.5+t/e*.5}function ut(t,e){const n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function ct(e,n,r,i,o,a,s,l,u,c){const h=i?e.textSizeData:e.iconSizeData,f=t.evaluateSizeForZoom(h,r.transform.zoom),p=[256/r.width*2+1,256/r.height*2+1],d=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;d.clear();const m=e.lineVertexArray,g=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height;let y=!1;for(let _=0;_<g.length;_++){const i=g.get(_);if(i.hidden||i.writingMode===t.WritingMode.vertical&&!y){vt(i.numGlyphs,d);continue}let x;if(y=!1,c?(x=[i.anchorX,i.anchorY,c(i.anchorX,i.anchorY),1],t.transformMat4(x,x,n)):(x=[i.anchorX,i.anchorY,0,1],yt(x,x,n)),!ut(x,p)){vt(i.numGlyphs,d);continue}const b=lt(r.transform.cameraToCenterDistance,x[3]),w=t.evaluateSizeForFeature(h,f,i),S=s?w/b:w*b,E=new t.pointGeometry(i.anchorX,i.anchorY),k=st(E,o,c).point,C={},I=pt(i,S,!1,l,n,o,a,e.glyphOffsetArray,m,d,k,E,C,v,u,c);y=I.useVertical,(I.notEnoughRoom||y||I.needsFlipping&&pt(i,S,!0,l,n,o,a,e.glyphOffsetArray,m,d,k,E,C,v,u,c).notEnoughRoom)&&vt(i.numGlyphs,d)}i?e.text.dynamicLayoutVertexBuffer.updateData(d):e.icon.dynamicLayoutVertexBuffer.updateData(d)}function ht(t,e,n,r,i,o,a,s,l,u,c,h,f){const p=s.glyphStartIndex+s.numGlyphs,d=s.lineStartIndex,m=s.lineStartIndex+s.lineLength,g=e.getoffsetX(s.glyphStartIndex),v=e.getoffsetX(p-1),y=mt(t*g,n,r,i,o,a,s.segment,d,m,l,u,c,h,f);if(!y)return null;const _=mt(t*v,n,r,i,o,a,s.segment,d,m,l,u,c,h,f);return _?{first:y,last:_}:null}function ft(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function pt(e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g){const v=n/24,y=e.lineOffsetX*v,_=e.lineOffsetY*v;let x;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,n=e.lineStartIndex,o=e.lineStartIndex+e.lineLength,c=ht(v,l,y,_,r,h,f,e,u,a,p,m,g);if(!c)return{notEnoughRoom:!0};const b=st(c.first.point,s,g).point,w=st(c.last.point,s,g).point;if(i&&!r){const t=ft(e.writingMode,b,w,d);if(t)return t}x=[c.first];for(let i=e.glyphStartIndex+1;i<t-1;i++)x.push(mt(v*l.getoffsetX(i),y,_,r,h,f,e.segment,n,o,u,a,p,m,g));x.push(c.last)}else{if(i&&!r){const n=st(f,o,g).point,r=e.lineStartIndex+e.segment+1,i=new t.pointGeometry(u.getx(r),u.gety(r)),a=st(i,o,g),s=a.signedDistanceFromCamera>0?a.point:dt(f,i,n,1,o,g),l=ft(e.writingMode,n,s,d);if(l)return l}const n=mt(v*l.getoffsetX(e.glyphStartIndex),y,_,r,h,f,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,p,m,g);if(!n)return{notEnoughRoom:!0};x=[n]}for(const b of x)t.addDynamicAttributes(c,b.point,b.angle);return{}}function dt(t,e,n,r,i,o){const a=st(t.add(t.sub(e)._unit()),i,o).point,s=n.sub(a);return n.add(s._mult(r/s.mag()))}function mt(e,n,r,i,o,a,s,l,u,c,h,f,p,d){const m=i?e-n:e+n;let g=m>0?1:-1,v=0;i&&(g*=-1,v=Math.PI),g<0&&(v+=Math.PI);let y=g>0?l+s:l+s+1,_=o,x=o,b=0,w=0;const S=Math.abs(m),E=[];for(;b+w<=S;){if(y+=g,y<l||y>=u)return null;if(x=_,E.push(_),_=f[y],void 0===_){const e=new t.pointGeometry(c.getx(y),c.gety(y)),n=st(e,h,d);if(n.signedDistanceFromCamera>0)_=f[y]=n.point;else{const n=y-g;_=dt(0===b?a:new t.pointGeometry(c.getx(n),c.gety(n)),e,x,S-b+1,h,d)}}b+=w,w=x.dist(_)}const k=(S-b)/w,C=_.sub(x),I=C.mult(k)._add(x);I._add(C._unit()._perp()._mult(r*g));const T=v+Math.atan2(_.y-x.y,_.x-x.x);return E.push(I),{point:I,angle:p?T:0,path:E}}const gt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vt(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(gt,3*t)}}function yt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}const _t=100;class xt{constructor(t,e=new it(t.width+200,t.height+200,25),n=new it(t.width+200,t.height+200,25)){this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+_t,this.screenBottomBoundary=t.height+_t,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,n,r,i,o){const a=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY,o),s=n*a.perspectiveRatio,l=t.x1*s+a.point.x,u=t.y1*s+a.point.y,c=t.x2*s+a.point.x,h=t.y2*s+a.point.y;return!this.isInsideGrid(l,u,c,h)||"always"!==e&&this.grid.hitTest(l,u,c,h,e,i)||a.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,u,c,h],offscreen:this.isOffscreen(l,u,c,h)}}placeCollisionCircles(e,n,r,i,o,a,s,l,u,c,h,f,p,d){const m=[],g=new t.pointGeometry(n.anchorX,n.anchorY),v=st(g,a,d),y=lt(this.transform.cameraToCenterDistance,v.signedDistanceFromCamera),_=(c?o/y:o*y)/t.ONE_EM,x=st(g,s,d).point,b=ht(_,i,n.lineOffsetX*_,n.lineOffsetY*_,!1,x,g,n,r,s,{},!1,d);let w=!1,S=!1,E=!0;if(b){const n=.5*f*y+p,r=new t.pointGeometry(-100,-100),i=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),o=new nt,a=b.first,s=b.last;let c=[];for(let t=a.path.length-1;t>=1;t--)c.push(a.path[t]);for(let t=1;t<s.path.length;t++)c.push(s.path[t]);const g=2.5*n;if(l){const t=c.map((t=>st(t,l,d)));c=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let v=[];if(c.length>0){const e=c[0].clone(),n=c[0].clone();for(let t=1;t<c.length;t++)e.x=Math.min(e.x,c[t].x),e.y=Math.min(e.y,c[t].y),n.x=Math.max(n.x,c[t].x),n.y=Math.max(n.y,c[t].y);v=e.x>=r.x&&n.x<=i.x&&e.y>=r.y&&n.y<=i.y?[c]:n.x<r.x||e.x>i.x||n.y<r.y||e.y>i.y?[]:t.clipLine([c],r.x,r.y,i.x,i.y)}for(const t of v){o.reset(t,.25*n);let r=0;r=o.length<=.5*n?1:Math.ceil(o.paddedLength/g)+1;for(let t=0;t<r;t++){const i=t/Math.max(r-1,1),a=o.lerp(i),s=a.x+_t,l=a.y+_t;m.push(s,l,n,0);const c=s-n,f=l-n,p=s+n,d=l+n;if(E=E&&this.isOffscreen(c,f,p,d),S=S||this.isInsideGrid(c,f,p,d),"always"!==e&&this.grid.hitTestCircle(s,l,n,e,h)&&(w=!0,!u))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!u&&w||!S||y<this.perspectiveRatioCutoff?[]:m,offscreen:E,collisionDetected:w}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let r=1/0,i=1/0,o=-1/0,a=-1/0;for(const c of e){const e=new t.pointGeometry(c.x+_t,c.y+_t);r=Math.min(r,e.x),i=Math.min(i,e.y),o=Math.max(o,e.x),a=Math.max(a,e.y),n.push(e)}const s=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a)),l={},u={};for(const c of s){const e=c.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const r=[new t.pointGeometry(c.x1,c.y1),new t.pointGeometry(c.x2,c.y1),new t.pointGeometry(c.x2,c.y2),new t.pointGeometry(c.x1,c.y2)];t.polygonIntersectsPolygon(n,r)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===u[e.bucketInstanceId]&&(u[e.bucketInstanceId]=[]),u[e.bucketInstanceId].push(e.featureIndex))}return u}insertCollisionBox(t,e,n,r,i,o){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:o,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,r,i,o){const a=n?this.ignoredGrid:this.grid,s={bucketInstanceId:r,featureIndex:i,collisionGroupID:o,overlapMode:e};for(let l=0;l<t.length;l+=4)a.insertCircle(s,t[l],t[l+1],t[l+2])}projectAndGetPerspectiveRatio(e,n,r,i){let o;return i?(o=[n,r,i(n,r),1],t.transformMat4(o,o,e)):(o=[n,r,0,1],yt(o,o,e)),{point:new t.pointGeometry((o[0]/o[3]+1)/2*this.transform.width+_t,(-o[1]/o[3]+1)/2*this.transform.height+_t),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}}isOffscreen(t,e,n,r){return n<_t||t>=this.screenRightBoundary||r<_t||e>this.screenBottomBoundary}isInsideGrid(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}function bt(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}class wt{constructor(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class St{constructor(t,e,n,r,i){this.text=new wt(t?t.text:null,e,n,i),this.icon=new wt(t?t.icon:null,e,r,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Et{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class kt{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Ct{constructor(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}}class It{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Tt(e,n,r,i,o){const{horizontalAlign:a,verticalAlign:s}=t.getAnchorAlignment(e),l=-(a-.5)*n,u=-(s-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.pointGeometry(l+c[0]*o,u+c[1]*o)}function Pt(e,n,r,i,o,a){const{x1:s,x2:l,y1:u,y2:c,anchorPointX:h,anchorPointY:f}=e,p=new t.pointGeometry(n,r);return i&&p._rotate(o?a:-a),{x1:s+p.x,y1:u+p.y,x2:l+p.x,y2:c+p.y,anchorPointX:h,anchorPointY:f}}class At{constructor(t,e,n,r,i){this.transform=t.clone(),this.terrain=e,this.collisionIndex=new xt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new It(r),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,r,i){const o=r.getBucket(n),a=r.latestFeatureIndex;if(!o||!a||n.id!==o.layerIds[0])return;const s=r.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),f="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),d=bt(r,1,this.transform.zoom),m=ot(h,f,p,this.transform,d);let g=null;if(f){const e=at(h,f,p,this.transform,d);g=t.multiply([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[o.bucketInstanceId]=new Ct(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID);const v={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(const t of o.sortKeyRanges){const{sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i}=t;e.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:v})}attemptAnchorPlacement(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m){const g=[h.textOffset0,h.textOffset1],v=Tt(t,n,r,g,i),y=this.collisionIndex.placeCollisionBox(Pt(e,v.x,v.y,o,a,this.transform.angle),c,s,l,u.predicate,m);if((!d||0!==this.collisionIndex.placeCollisionBox(Pt(d,v.x,v.y,o,a,this.transform.angle),c,s,l,u.predicate,m).box.length)&&y.box.length>0){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(e=this.prevPlacement.variableOffsets[h.crossTileID].anchor),0===h.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[h.crossTileID]={textOffset:g,width:n,height:r,anchor:t,textBoxScale:i,prevAnchor:e},this.markUsedJustification(f,t,h,p),f.allowVerticalPlacement&&(this.markUsedOrientation(f,p,h),this.placedOrientations[h.crossTileID]=p),{shift:v,placedGlyphBoxes:y}}}placeLayerBucketPart(e,n,r){const{bucket:i,layout:o,posMatrix:a,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:u,holdingForFade:c,collisionBoxArray:h,partiallyEvaluatedTextSize:f,collisionGroup:p}=e.parameters,d=o.get("text-optional"),m=o.get("icon-optional"),g=t.getOverlapMode(o,"text-overlap","text-allow-overlap"),v="always"===g,y=t.getOverlapMode(o,"icon-overlap","icon-allow-overlap"),_="always"===y,x="map"===o.get("text-rotation-alignment"),b="map"===o.get("text-pitch-alignment"),w="none"!==o.get("icon-text-fit"),S="viewport-y"===o.get("symbol-z-order"),E=v&&(_||!i.hasIconData()||m),k=_&&(v||!i.hasTextData()||d);!i.collisionArrays&&h&&i.deserializeCollisionBoxes(h);const C=(e,h)=>{if(n[e.crossTileID])return;if(c)return void(this.placements[e.crossTileID]=new Et(!1,!1,!1));let _=!1,S=!1,C=!0,I=null,T={box:null,offscreen:null},P={box:null,offscreen:null},A=null,M=null,L=null,R=0,D=0,N=0;h.textFeatureIndex?R=h.textFeatureIndex:e.useRuntimeCollisionCircles&&(R=e.featureIndex),h.verticalTextFeatureIndex&&(D=h.verticalTextFeatureIndex);const z=this.retainedQueryData[i.bucketInstanceId].tileID,O=this.terrain?(t,e)=>this.terrain.getElevation(z,t,e):null;for(const t of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const e=h[t];e&&(e.elevation=O?O(e.anchorPointX,e.anchorPointY):0)}const F=h.textBox;if(F){const n=n=>{let r=t.WritingMode.horizontal;if(i.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,r=t,this.markUsedOrientation(i,r,e))}return r},r=(n,r)=>{if(i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&h.verticalTextBox){for(const e of i.writingModes)if(e===t.WritingMode.vertical?(T=r(),P=T):T=n(),T&&T.box&&T.box.length)break}else T=n()};if(o.get("text-variable-anchor")){let s=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];s.indexOf(t.anchor)>0&&(s=s.filter((e=>e!==t.anchor)),s.unshift(t.anchor))}const l=(t,n,r)=>{const o=t.x2-t.x1,l=t.y2-t.y1,c=e.textBoxScale,h=w&&"never"===y?n:null;let f={box:[],offscreen:!1};const d="never"!==g?2*s.length:s.length;for(let m=0;m<d;++m){const n=this.attemptAnchorPlacement(s[m%s.length],t,o,l,c,x,b,u,a,p,m>=s.length?g:"never",e,i,r,h,O);if(n&&(f=n.placedGlyphBoxes,f&&f.box&&f.box.length)){_=!0,I=n.shift;break}}return f};r((()=>l(F,h.iconBox,t.WritingMode.horizontal)),(()=>{const n=h.verticalTextBox;return i.allowVerticalPlacement&&!(T&&T.box&&T.box.length)&&e.numVerticalGlyphVertices>0&&n?l(n,h.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),T&&(_=T.box,C=T.offscreen);const c=n(T&&T.box);if(!_&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(i,t.anchor,e,c))}}else{const o=(t,n)=>{const r=this.collisionIndex.placeCollisionBox(t,g,u,a,p.predicate,O);return r&&r.box&&r.box.length&&(this.markUsedOrientation(i,n,e),this.placedOrientations[e.crossTileID]=n),r};r((()=>o(F,t.WritingMode.horizontal)),(()=>{const n=h.verticalTextBox;return i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?o(n,t.WritingMode.vertical):{box:null,offscreen:null}})),n(T&&T.box&&T.box.length)}}if(A=T,_=A&&A.box&&A.box.length>0,C=A&&A.offscreen,e.useRuntimeCollisionCircles){const n=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),u=t.evaluateSizeForFeature(i.textSizeData,f,n),c=o.get("text-padding");M=this.collisionIndex.placeCollisionCircles(g,n,i.lineVertexArray,i.glyphOffsetArray,u,a,s,l,r,b,p.predicate,e.collisionCircleDiameter,c,O),M.circles.length&&M.collisionDetected&&!r&&t.warnOnce("Collisions detected, but collision boxes are not shown"),_=v||M.circles.length>0&&!M.collisionDetected,C=C&&M.offscreen}if(h.iconFeatureIndex&&(N=h.iconFeatureIndex),h.iconBox){const t=t=>{const e=w&&I?Pt(t,I.x,I.y,x,b,this.transform.angle):t;return this.collisionIndex.placeCollisionBox(e,y,u,a,p.predicate,O)};P&&P.box&&P.box.length&&h.verticalIconBox?(L=t(h.verticalIconBox),S=L.box.length>0):(L=t(h.iconBox),S=L.box.length>0),C=C&&L.offscreen}const B=d||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,j=m||0===e.numIconVertices;if(B||j?j?B||(S=S&&_):_=S&&_:S=_=S&&_,_&&A&&A.box&&this.collisionIndex.insertCollisionBox(A.box,g,o.get("text-ignore-placement"),i.bucketInstanceId,P&&P.box&&D?D:R,p.ID),S&&L&&this.collisionIndex.insertCollisionBox(L.box,y,o.get("icon-ignore-placement"),i.bucketInstanceId,N,p.ID),M&&(_&&this.collisionIndex.insertCollisionCircles(M.circles,g,o.get("text-ignore-placement"),i.bucketInstanceId,R,p.ID),r)){const t=i.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new kt);for(let n=0;n<M.circles.length;n+=4)e.circles.push(M.circles[n+0]),e.circles.push(M.circles[n+1]),e.circles.push(M.circles[n+2]),e.circles.push(M.collisionDetected?1:0)}if(0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Et(_||E,S||k,C||i.justReloaded),n[e.crossTileID]=!0};if(S){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=i.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];C(i.symbolInstances.get(n),i.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)C(i.symbolInstances.get(t),i.collisionArrays[t]);if(r&&i.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[i.bucketInstanceId];t.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}i.justReloaded=!1}markUsedJustification(e,n,r,i){let o;o=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];const a=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const t of a)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=o>=0&&t!==o?0:r.crossTileID)}markUsedOrientation(e,n,r){const i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const t of a)e.text.placedSymbolArray.get(t).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(const s in this.placements){const t=this.placements[s],e=i[s];e?(this.opacities[s]=new St(e,r,t.text,t.icon),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[s]=new St(null,r,t.text,t.icon,t.skipFade),n=n||t.text||t.icon)}for(const s in i){const t=i[s];if(!this.opacities[s]){const e=new St(t,r,!1,!1);e.isHidden()||(this.opacities[s]=e,n=n||t.text.placed||t.icon.placed)}}for(const s in o)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=o[s]);for(const s in a)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=a[s]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,r.collisionBoxArray)}}updateBucketOpacities(e,n,r){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const i=e.layers[0].layout,o=new St(null,0,!1,!1,!0),a=i.get("text-allow-overlap"),s=i.get("icon-allow-overlap"),l=i.get("text-variable-anchor"),u="map"===i.get("text-rotation-alignment"),c="map"===i.get("text-pitch-alignment"),h="none"!==i.get("icon-text-fit"),f=new St(null,0,a&&(s||!e.hasIconData()||i.get("icon-optional")),s&&(a||!e.hasTextData()||i.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);const p=(t,e,n)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)};for(let d=0;d<e.symbolInstances.length;d++){const r=e.symbolInstances.get(d),{numHorizontalGlyphVertices:i,numVerticalGlyphVertices:a,crossTileID:s}=r;let m=this.opacities[s];n[s]?m=o:m||(m=f,this.opacities[s]=m),n[s]=!0;const g=r.numIconVertices>0,v=this.placedOrientations[r.crossTileID],y=v===t.WritingMode.vertical,_=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(i>0||a>0){const t=Bt(m.text);p(e.text,i,y?jt:t),p(e.text,a,_?jt:t);const n=m.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=n||y?1:0)})),r.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=n||_?1:0);const o=this.variableOffsets[r.crossTileID];o&&this.markUsedJustification(e,o.anchor,r,v);const s=this.placedOrientations[r.crossTileID];s&&(this.markUsedJustification(e,"left",r,s),this.markUsedOrientation(e,s,r))}if(g){const t=Bt(m.icon),n=!(h&&r.verticalPlacedIconSymbolIndex&&y);r.placedIconSymbolIndex>=0&&(p(e.icon,r.numIconVertices,n?t:jt),e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=m.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(p(e.icon,r.numVerticalIconVertices,n?jt:t),e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[d];if(n){let r=new t.pointGeometry(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(l){const e=this.variableOffsets[s];e?(r=Tt(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),u&&r._rotate(c?this.transform.angle:-this.transform.angle)):t=!1}n.textBox&&Mt(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||y,r.x,r.y),n.verticalTextBox&&Mt(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||_,r.x,r.y)}const i=Boolean(!_&&n.verticalIconBox);n.iconBox&&Mt(e.iconCollisionBox.collisionVertexArray,m.icon.placed,i,h?r.x:0,h?r.y:0),n.verticalIconBox&&Mt(e.iconCollisionBox.collisionVertexArray,m.icon.placed,!i,h?r.x:0,h?r.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function Mt(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}const Lt=Math.pow(2,25),Rt=Math.pow(2,24),Dt=Math.pow(2,17),Nt=Math.pow(2,16),zt=Math.pow(2,9),Ot=Math.pow(2,8),Ft=Math.pow(2,1);function Bt(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Lt+e*Rt+n*Dt+e*Nt+n*zt+e*Ot+n*Ft+e}const jt=0;class Ut{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,r,i){const o=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(o,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1}}class Vt{constructor(t,e,n,r,i,o,a,s){this.placement=new At(t,e,o,a,s),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,n,r){const i=t.exported.now(),o=()=>{const e=t.exported.now()-i;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=i)&&(!t.maxzoom||t.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new Ut(t)),this._inProgressLayer.continuePlacement(r[t.source],this.placement,this._showCollisionBoxes,t,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Zt=512/t.EXTENT/2;class qt{constructor(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(let r=0;r<e.length;r++){const n=e.get(r),i=n.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}getScaledCoordinates(e,n){const r=Zt/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*r),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*r)}}findMatches(t,e,n){const r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let i=0;i<t.length;i++){const o=t.get(i);if(o.crossTileID)continue;const a=this.indexedSymbolInstances[o.key];if(!a)continue;const s=this.getScaledCoordinates(o,e);for(const t of a)if(Math.abs(t.coord.x-s.x)<=r&&Math.abs(t.coord.y-s.y)<=r&&!n[t.crossTileID]){n[t.crossTileID]=!0,o.crossTileID=t.crossTileID;break}}}}class Gt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],r={};for(const n in t){const i=t[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),r[i.tileID.key]=i}this.indexes[n]=r}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let i=0;i<e.symbolInstances.length;i++)e.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const r=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in n){const o=n[i];o.tileID.isChildOf(t)&&o.findMatches(e.symbolInstances,t,r)}else{const o=n[t.scaledTo(Number(i)).key];o&&o.findMatches(e.symbolInstances,t,r)}}for(let i=0;i<e.symbolInstances.length;i++){const t=e.symbolInstances.get(i);t.crossTileID||(t.crossTileID=n.generate(),r[t.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new qt(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n in e.indexedSymbolInstances)for(const r of e.indexedSymbolInstances[n])delete this.usedCrossTileIDs[t][r.crossTileID]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const r=this.indexes[n];for(const i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e}}class Xt{constructor(){this.layerIndexes={},this.crossTileIDs=new Gt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Wt);let i=!1;const o={};r.handleWrapJump(n);for(const a of e){const e=a.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(a.tileID,e,this.crossTileIDs)&&(i=!0),o[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}var Ht=t.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Yt extends t.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=t._cache.max,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const t in this._tiles){const e=this._tiles[t];e.textures.forEach((t=>t.destroy())),e.textures=[]}}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];for(const r of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n}))this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),t.ortho(r.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),this._tiles[r.key]=new N(r,this.tileSize))}removeOutdated(t){const e={};this.renderHistory=this.renderHistory.filter(((t,e)=>this.renderHistory.indexOf(t)===e)).slice(0,this.renderHistorySize);for(const n of this._renderableTilesKeys)e[n]=!0;for(const n of this.renderHistory)e[n]=!0;for(const n in this._tiles)e[n]||(this._tiles[n].clearTextures(t),delete this._tiles[n])}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(e){const n={};for(const r of this._renderableTilesKeys){const i=this._tiles[r].tileID;if(i.canonical.equals(e.canonical)){const i=e.clone();i.posMatrix=new Float64Array(16),t.ortho(i.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),n[r]=i}else if(i.canonical.isChildOf(e.canonical)){const o=e.clone();o.posMatrix=new Float64Array(16);const a=i.canonical.z-e.canonical.z,s=i.canonical.x-(i.canonical.x>>a<<a),l=i.canonical.y-(i.canonical.y>>a<<a),u=t.EXTENT>>a;t.ortho(o.posMatrix,0,u,0,u,0,1),t.translate(o.posMatrix,o.posMatrix,[-s*u,-l*u,0]),n[r]=o}else if(e.canonical.isChildOf(i.canonical)){const o=e.clone();o.posMatrix=new Float64Array(16);const a=e.canonical.z-i.canonical.z,s=e.canonical.x-(e.canonical.x>>a<<a),l=e.canonical.y-(e.canonical.y>>a<<a),u=t.EXTENT>>a;t.ortho(o.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),t.translate(o.posMatrix,o.posMatrix,[s*u,l*u,0]),t.scale(o.posMatrix,o.posMatrix,[1/2**a,1/2**a,0]),n[r]=o}}return n}getSourceTile(t,e){const n=this.sourceCache._source;let r=t.overscaledZ-this.deltaZoom;if(r>n.maxzoom&&(r=n.maxzoom),r<n.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(r).key);let i=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!i||!i.dem)&&e)for(;r>=n.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(t.scaledTo(r--).key);return i}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeLoaded>=t))}}class $t{constructor(t,e,n){this.style=t,this.sourceCache=new Yt(e),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.elevationOffset="number"==typeof n.elevationOffset?n.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(e,n,r,i=t.EXTENT){if(!(n>=0&&n<i&&r>=0&&r<i))return this.elevationOffset;let o=0;const a=this.getTerrainData(e);if(a.tile&&a.tile.dem){const e=t.transformMat4$1([],[n/i*t.EXTENT,r/i*t.EXTENT],a.u_terrain_matrix),s=[e[0]*a.tile.dem.dim,e[1]*a.tile.dem.dim],l=[Math.floor(s[0]),Math.floor(s[1])],u=a.tile.dem.get(l[0],l[1]),c=a.tile.dem.get(l[0],l[1]+1),h=a.tile.dem.get(l[0]+1,l[1]),f=a.tile.dem.get(l[0]+1,l[1]+1);o=t.number(t.number(u,c,s[0]-l[0]),t.number(h,f,s[0]-l[0]),s[1]-l[1])}return o}rememberForRerender(t,e){for(const n in this.sourceCache._tiles){const r=this.sourceCache._tiles[n];(r.tileID.equals(e)||r.tileID.isChildOf(e))&&(t===this.sourceCache.sourceCache.id&&(r.timeLoaded=Date.now()),this._rerender[t]=this._rerender[t]||{},this._rerender[t][r.tileID.key]=!0)}}needsRerender(t,e){return this._rerender[t]&&this._rerender[t][e.key]}clearRerenderCache(){this._rerender={}}getElevation(e,n,r,i=t.EXTENT){return(this.getDEMElevation(e,n,r,i)+this.elevationOffset)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.style.map.painter.context,n=new t.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l(e,n,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l(e,new t.RGBAImage({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.identity([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const t=this.style.map.painter.context;n.demTexture=this.style.map.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new l(t,n.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),n.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const r=n&&n+n.tileID.key+e.key;if(r&&!this._demMatrixCache[r]){const r=this.sourceCache.sourceCache._source.maxzoom;let i=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=r?i=e.canonical.z-r:t.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const o=e.canonical.x-(e.canonical.x>>i<<i),a=e.canonical.y-(e.canonical.y>>i<<i),s=t.fromScaling(new Float64Array(16),[1/(t.EXTENT<<i),1/(t.EXTENT<<i),0]);t.translate(s,s,[o*t.EXTENT,a*t.EXTENT,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getRTTFramebuffer(){const t=this.style.map.painter;if(!this._rttFramebuffer){const e=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=t.context.createFramebuffer(e,e,!0),this._rttFramebuffer.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,e,e))}return this._rttFramebuffer}getFramebuffer(t){const e=this.style.map.painter,n=e.width/devicePixelRatio,r=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l(e.context,{width:n,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l(e.context,{width:n,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(n,r,!0),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,n,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,o=0;t<this._coordsTextureSize;t++)for(let e=0;e<this._coordsTextureSize;e++,o+=4)n[o+0]=255&e,n[o+1]=255&t,n[o+2]=e>>8<<4|t>>8,n[o+3]=0;const r=new t.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),i=new l(e,r,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){const n=new Uint8Array(4),r=this.style.map.painter,i=r.context,o=i.gl;i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),o.readPixels(e.x,r.height/devicePixelRatio-e.y-1,1,1,o.RGBA,o.UNSIGNED_BYTE,n),i.bindFramebuffer.set(null);const a=n[0]+(n[2]>>4<<8),s=n[1]+((15&n[2])<<8),l=this.coordsIndex[255-n[3]],u=l&&this.sourceCache.getTileByID(l);if(!u)return null;const c=this._coordsTextureSize,h=(1<<u.tileID.canonical.z)*c;return new t.MercatorCoordinate((u.tileID.canonical.x*c+a)/h,(u.tileID.canonical.y*c+s)/h,this.getElevation(u.tileID,a,s,c))}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.style.map.painter.context,n=new t.PosArray,r=new t.TriangleIndexArray,i=this.meshSize,o=t.EXTENT/i,a=i*i;for(let t=0;t<=i;t++)for(let e=0;e<=i;e++)n.emplaceBack(e*o,t*o);for(let t=0;t<a;t+=i+1)for(let e=0;e<i;e++)r.emplaceBack(e+t,i+e+t+1,i+e+t+2),r.emplaceBack(e+t,i+e+t+2,e+t+1);return this._mesh={indexBuffer:e.createIndexBuffer(r),vertexBuffer:e.createVertexBuffer(n,Ht.members),segments:t.SegmentVector.simpleSegment(0,0,n.length,r.length)},this._mesh}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,n={minElevation:null,maxElevation:null};return e&&e.dem&&(n.minElevation=(e.dem.min+this.elevationOffset)*this.exaggeration,n.maxElevation=(e.dem.max+this.elevationOffset)*this.exaggeration),n}}const Kt=(e,n)=>t.emitValidationErrors(e,n&&n.filter((t=>"source.canvas"!==t.identifier))),Jt=t.pick(H,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Qt=t.pick(H,["setCenter","setZoom","setBearing","setPitch"]),te=function(){const e={},n=t.spec.$version;for(const r in t.spec.$root){const i=t.spec.$root[r];if(i.required){let t=null;t="version"===r?n:"array"===i.type?[]:{},null!=t&&(e[r]=t)}}return e}();class ee extends t.Evented{constructor(e,n={}){super(),this.map=e,this.dispatcher=new _(G(),this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new d(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new y(256,512),this.crossTileSymbolIndex=new Xt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const r=this;this._rtlTextPluginCallback=ee.registerForPluginStateChange((e=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every((t=>t)))for(const t in r.sourceCaches)r.sourceCaches[t].reload()}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const n=e.getSource();if(n&&n.vectorLayerIds)for(const r in this._layers){const t=this._layers[r];t.source===n.id&&this._validateLayer(t)}}))}loadURL(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const r="boolean"!=typeof n.validate||n.validate,i=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(i,((e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,r)}))}loadJSON(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame((()=>{this._request=null,this._load(e,!1!==n.validate)}))}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(te,!1)}_load(e,n){if(n&&Kt(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e;for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);const r=X(this.stylesheet.layers);this._order=r.map((t=>t.id)),this._layers={},this._serializedLayers={};for(let i of r)i=t.createStyleLayer(i),i.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=i,this._serializedLayers[i.id]=i.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new v(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(e){this._spriteRequest=function(e,n,r,i){let o,a,s;const l=r>1?"@2x":"";let u=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,l,".json"),t.ResourceType.SpriteJSON),((t,e)=>{u=null,s||(s=t,o=e,h())})),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,l,".png"),t.ResourceType.SpriteImage),((t,e)=>{c=null,s||(s=t,a=e,h())}));function h(){if(s)i(s);else if(o&&a){const e=t.exported.getImageData(a),n={};for(const r in o){const{width:i,height:a,x:s,y:l,sdf:u,pixelRatio:c,stretchX:h,stretchY:f,content:p}=o[r],d=new t.RGBAImage({width:i,height:a});t.RGBAImage.copy(e,d,{x:s,y:l},{x:0,y:0},{width:i,height:a}),n[r]={data:d,pixelRatio:c,sdf:u,stretchX:h,stretchY:f,content:p}}i(null,n)}}return{cancel(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,this.map.getPixelRatio(),((e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const r=e.sourceLayer;if(!r)return;const i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${r}" does not exist on source "${i.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages();for(const r in this._updatedPaintProps)this._layers[r].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}const r={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];r[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(const i in r){const e=this.sourceCaches[i];r[i]!==e.used&&e.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:i}))}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(e){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),e){const t=this.sourceCaches[e.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);this.terrain=new $t(this,t,e),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=t=>{t.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=t=>{t.tile&&(t.sourceId===e.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(t.sourceId,t.tile.tileID)):"geojson"===t.source.type&&this.terrain.rememberForRerender(t.sourceId,t.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new t.Event("terrain",{terrain:e}))}setState(e){if(this._checkLoaded(),Kt(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=X(e.layers);const n=function(t,e){if(!t)return[{command:H.setStyle,args:[e]}];let n=[];try{if(!i(t.version,e.version))return[{command:H.setStyle,args:[e]}];i(t.center,e.center)||n.push({command:H.setCenter,args:[e.center]}),i(t.zoom,e.zoom)||n.push({command:H.setZoom,args:[e.zoom]}),i(t.bearing,e.bearing)||n.push({command:H.setBearing,args:[e.bearing]}),i(t.pitch,e.pitch)||n.push({command:H.setPitch,args:[e.pitch]}),i(t.sprite,e.sprite)||n.push({command:H.setSprite,args:[e.sprite]}),i(t.glyphs,e.glyphs)||n.push({command:H.setGlyphs,args:[e.glyphs]}),i(t.transition,e.transition)||n.push({command:H.setTransition,args:[e.transition]}),i(t.light,e.light)||n.push({command:H.setLight,args:[e.light]});const r={},o=[];!function(t,e,n,r){let o;for(o in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,o)&&(Object.prototype.hasOwnProperty.call(e,o)||$(o,n,r));for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(Object.prototype.hasOwnProperty.call(t,o)?i(t[o],e[o])||("geojson"===t[o].type&&"geojson"===e[o].type&&J(t,e,o)?n.push({command:H.setGeoJSONSourceData,args:[o,e[o].data]}):K(o,e,n,r)):Y(o,e,n))}(t.sources,e.sources,o,r);const a=[];t.layers&&t.layers.forEach((t=>{r[t.source]?n.push({command:H.removeLayer,args:[t.id]}):a.push(t)})),n=n.concat(o),function(t,e,n){e=e||[];const r=(t=t||[]).map(tt),o=e.map(tt),a=t.reduce(et,{}),s=e.reduce(et,{}),l=r.slice(),u=Object.create(null);let c,h,f,p,d,m,g;for(c=0,h=0;c<r.length;c++)f=r[c],Object.prototype.hasOwnProperty.call(s,f)?h++:(n.push({command:H.removeLayer,args:[f]}),l.splice(l.indexOf(f,h),1));for(c=0,h=0;c<o.length;c++)f=o[o.length-1-c],l[l.length-1-c]!==f&&(Object.prototype.hasOwnProperty.call(a,f)?(n.push({command:H.removeLayer,args:[f]}),l.splice(l.lastIndexOf(f,l.length-h),1)):h++,m=l[l.length-c],n.push({command:H.addLayer,args:[s[f],m]}),l.splice(l.length-c,0,f),u[f]=!0);for(c=0;c<o.length;c++)if(f=o[c],p=a[f],d=s[f],!u[f]&&!i(p,d))if(i(p.source,d.source)&&i(p["source-layer"],d["source-layer"])&&i(p.type,d.type)){for(g in Q(p.layout,d.layout,n,f,null,H.setLayoutProperty),Q(p.paint,d.paint,n,f,null,H.setPaintProperty),i(p.filter,d.filter)||n.push({command:H.setFilter,args:[f,d.filter]}),i(p.minzoom,d.minzoom)&&i(p.maxzoom,d.maxzoom)||n.push({command:H.setLayerZoomRange,args:[f,d.minzoom,d.maxzoom]}),p)Object.prototype.hasOwnProperty.call(p,g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Q(p[g],d[g],n,f,g.slice(6),H.setPaintProperty):i(p[g],d[g])||n.push({command:H.setLayerProperty,args:[f,g,d[g]]}));for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&!Object.prototype.hasOwnProperty.call(p,g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Q(p[g],d[g],n,f,g.slice(6),H.setPaintProperty):i(p[g],d[g])||n.push({command:H.setLayerProperty,args:[f,g,d[g]]}))}else n.push({command:H.removeLayer,args:[f]}),m=l[l.lastIndexOf(f)+1],n.push({command:H.addLayer,args:[d,m]})}(a,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:H.setStyle,args:[e]}]}return n}(this.serialize(),e).filter((t=>!(t.command in Qt)));if(0===n.length)return!1;const r=n.filter((t=>!(t.command in Jt)));if(r.length>0)throw new Error(`Unimplemented: ${r.map((t=>t.command)).join(", ")}.`);return n.forEach((t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args)})),this.stylesheet=e,!0}addImage(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,r={}){if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,`sources.${e}`,n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const i=this.sourceCaches[e]=new F(e,n,this.dispatcher);i.style=this,i.setEventedParent(this,(()=>({isSourceLoaded:this.loaded(),source:i.serialize(),sourceId:e}))),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const n=this.sourceCaches[t].getSource();if("geojson"!==n.type)throw new Error(`geojsonSource.type is ${n.type}, which is !== 'geojson`);n.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(e,n,r={}){this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.ErrorEvent(new Error(`Layer "${i}" already exists on this map.`)));let o;if("custom"===e.type){if(Kt(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,`layers.${i}`,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize()}const a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error(`Cannot add layer "${i}" before non-existing layer "${n}".`)));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){const t=this._removedLayers[i];delete this._removedLayers[i],t.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const r=this._order.indexOf(e);this._order.splice(r,1);const i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(e,n,r){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,r={}){this._checkLoaded();const o=this.getLayer(e);if(o){if(!i(o.filter,n))return null==n?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(t.validateStyle.filter,`layers.${o.id}.filter`,n,null,r)||(o.filter=t.clone$1(n),this._updateLayer(o)))}else this.fire(new t.ErrorEvent(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.clone$1(this.getLayer(e).filter)}setLayoutProperty(e,n,r,o={}){this._checkLoaded();const a=this.getLayer(e);a?i(a.getLayoutProperty(n),r)||(a.setLayoutProperty(n,r,o),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,r,o={}){this._checkLoaded();const a=this.getLayer(e);a?i(a.getPaintProperty(n),r)||(a.setPaintProperty(n,r,o)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const r=e.source,i=e.sourceLayer,o=this.sourceCaches[r];if(void 0===o)return void this.fire(new t.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)));const a=o.getSource().type;"geojson"===a&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const r=e.source,i=this.sourceCaches[r];if(void 0===i)return void this.fire(new t.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)));const o=i.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(a,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,r=e.sourceLayer,i=this.sourceCaches[n];if(void 0!==i)return"vector"!==i.getSource().type||r?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,e.id)):void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(t=>t.serialize())),layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},r=[];for(let o=this._order.length-1;o>=0;o--){const i=this._order[o];if(e(i)){n[i]=o;for(const e of t){const t=e[i];if(t)for(const e of t)r.push(e)}}}r.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const i=[];for(let o=this._order.length-1;o>=0;o--){const a=this._order[o];if(e(a))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(n[e.layer.id]<o)break;i.push(e),r.pop()}else for(const e of t){const t=e[a];if(t)for(const e of t)i.push(e.feature)}}return i}queryRenderedFeatures(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);const i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[n.source]=!0}}const o=[];n.availableImages=this._availableImages;for(const t in this.sourceCaches)n.layers&&!i[t]||o.push(R(this.sourceCaches[t],this._layers,this._serializedLayers,e,n,r));return this.placement&&o.push(function(t,e,n,r,i,o,a){const s={},l=o.queryRenderedSymbols(r),u=[];for(const c of Object.keys(l).map(Number))u.push(a[c]);u.sort(D);for(const c of u){const n=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(const t in n){const e=s[t]=s[t]||[],r=n[t];r.sort(((t,e)=>{const n=c.featureSortOrder;if(n){const r=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex}));for(const t of r)e.push(t)}}for(const c in s)s[c].forEach((e=>{const r=e.feature,i=n[t[c].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i}));return s}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);const r=this.sourceCaches[e];return r?function(t,e){const n=t.getRenderableIds().map((e=>t.getTileByID(e))),r=[],i={};for(let o=0;o<n.length;o++){const t=n[o],a=t.tileID.canonical.key;i[a]||(i[a]=!0,t.querySourceFeatures(r,e))}return r}(r,n):[]}addSourceType(t,e,n){return ee.getSourceType(t)?n(new Error(`A source type called "${t}" already exists.`)):(ee.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const r=this.light.getLight();let o=!1;for(const t in e)if(!i(e[t],r[t])){o=!0;break}if(!o)return;const a={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}_validate(e,n,r,i,o={}){return(!o||!1!==o.validate)&&Kt(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.spec},i)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(e,n,r,i,o=!1){let a=!1,s=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this.sourceCaches[n.source];l[n.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng);a=a||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Vt(e,this.terrain,this._order,o,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,r){return t.makeRequest(n,r)}}ee.getSourceType=function(t){return M[t]},ee.setSourceType=function(t,e){M[t]=e},ee.registerForPluginStateChange=t.registerForPluginStateChange;var ne="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const re={prelude:ie("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:ie("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ie("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ie("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:ie("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ie("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:ie("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ie("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ie("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ie("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ie("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:ie("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:ie("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:ie("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:ie("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:ie("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:ie("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ie("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ie("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:ie("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:ie("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:ie("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:ie("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ie("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:ie("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:ie("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:ie("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ne),terrainDepth:ie("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ne),terrainCoords:ie("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ne)};function ie(t,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),i=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(i):i,s={};return{fragmentSource:t=t.replace(n,((t,e,n,r,i)=>(s[i]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nvarying ${n} ${r} ${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = u_${i};\n#endif\n`))),vertexSource:e=e.replace(n,((t,e,n,r,i)=>{const o="float"===r?"vec2":"vec4",a=i.match(/color/)?"color":o;return s[i]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${n} ${o} a_${i};\nvarying ${n} ${r} ${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${a}(a_${i}, u_${i}_t);\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${n} ${o} a_${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = a_${i};\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = unpack_mix_${a}(a_${i}, u_${i}_t);\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`})),staticAttributes:r,staticUniforms:a}}class oe{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,r,i,o,a,s,l){this.context=t;let u=this.boundPaintVertexBuffers.length!==r.length;for(let c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!u&&this.boundIndexBuffer===i&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s&&this.boundDynamicVertexBuffer3===l?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind()):this.freshBind(e,n,r,i,o,a,s,l)}freshBind(t,e,n,r,i,o,a,s){let l;const u=t.numAttributes,c=this.context,h=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),l=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a,this.boundDynamicVertexBuffer3=s;else{l=c.currentNumAttributes||0;for(let t=u;t<l;t++)h.disableVertexAttribArray(t)}e.enableAttributes(h,t);for(const f of n)f.enableAttributes(h,t);o&&o.enableAttributes(h,t),a&&a.enableAttributes(h,t),s&&s.enableAttributes(h,t),e.bind(),e.setVertexAttribPointers(h,t,i);for(const f of n)f.bind(),f.setVertexAttribPointers(h,t,i);o&&(o.bind(),o.setVertexAttribPointers(h,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(h,t,i)),s&&(s.bind(),s.setVertexAttribPointers(h,t,i)),c.currentNumAttributes=u}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ae(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const r=t[n].split(" ");e.push(r.pop())}return e}class se{constructor(e,n,r,i,o,a,s){const l=e.gl;this.program=l.createProgram();const u=ae(r.staticAttributes),c=i?i.getBinderAttributes():[],h=u.concat(c),f=re.prelude.staticUniforms?ae(re.prelude.staticUniforms):[],p=r.staticUniforms?ae(r.staticUniforms):[],d=i?i.getBinderUniforms():[],m=f.concat(p).concat(d),g=[];for(const t of m)g.indexOf(t)<0&&g.push(t);const v=i?i.defines():[];a&&v.push("#define OVERDRAW_INSPECTOR;"),s&&v.push("#define TERRAIN3D;");const y=v.concat(re.prelude.fragmentSource,r.fragmentSource).join("\n"),_=v.concat(re.prelude.vertexSource,r.vertexSource).join("\n"),x=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost())return void(this.failedToCreate=!0);l.shaderSource(x,y),l.compileShader(x),l.attachShader(this.program,x);const b=l.createShader(l.VERTEX_SHADER);if(l.isContextLost())return void(this.failedToCreate=!0);l.shaderSource(b,_),l.compileShader(b),l.attachShader(this.program,b),this.attributes={};const w={};this.numAttributes=h.length;for(let t=0;t<this.numAttributes;t++)h[t]&&(l.bindAttribLocation(this.program,t,h[t]),this.attributes[h[t]]=t);l.linkProgram(this.program),l.deleteShader(b),l.deleteShader(x);for(let t=0;t<g.length;t++){const e=g[t];if(e&&!w[e]){const t=l.getUniformLocation(this.program,e);t&&(w[e]=t)}}this.fixedUniforms=o(e,w),this.terrainUniforms=((e,n)=>({u_depth:new t.Uniform1i(e,n.u_depth),u_terrain:new t.Uniform1i(e,n.u_terrain),u_terrain_dim:new t.Uniform1f(e,n.u_terrain_dim),u_terrain_matrix:new t.UniformMatrix4f(e,n.u_terrain_matrix),u_terrain_unpack:new t.Uniform4f(e,n.u_terrain_unpack),u_terrain_offset:new t.Uniform1f(e,n.u_terrain_offset),u_terrain_exaggeration:new t.Uniform1f(e,n.u_terrain_exaggeration)}))(e,w),this.binderUniforms=i?i.getUniforms(e,w):[]}draw(t,e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v){const y=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),s){t.activeTexture.set(y.TEXTURE2),y.bindTexture(y.TEXTURE_2D,s.depthTexture),t.activeTexture.set(y.TEXTURE3),y.bindTexture(y.TEXTURE_2D,s.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(s[t])}for(const x in this.fixedUniforms)this.fixedUniforms[x].set(a[x]);d&&d.setUniforms(t,this.binderUniforms,f,{zoom:p});let _=0;switch(e){case y.LINES:_=2;break;case y.TRIANGLES:_=3;break;case y.LINE_STRIP:_=1}for(const x of h.get()){const n=x.vaos||(x.vaos={});(n[l]||(n[l]=new oe)).bind(t,this,u,d?d.getPaintVertexBuffers():[],c,x.vertexOffset,m,g,v),y.drawElements(e,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2)}}}function le(t,e,n){const r=1/bt(n,1,e.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,a=o*(n.tileID.canonical.x+n.tileID.wrap*i),s=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}const ue=(e,n,r,i)=>{const o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(l,-n.transform.angle),t.transformMat3(s,s,l);const u=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},ce=(e,n,r,i,o,a,s)=>t.extend(ue(e,n,r,i),le(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8}),he=t=>({u_matrix:t}),fe=(e,n,r,i)=>t.extend(he(e),le(r,n,i)),pe=(t,e)=>({u_matrix:t,u_world:e}),de=(e,n,r,i,o)=>t.extend(fe(e,n,r,i),{u_world:o}),me=(t,e,n,r)=>{const i=t.transform;let o,a;if("map"===r.paint.get("circle-pitch-alignment")){const t=bt(n,1,i.zoom);o=!0,a=[t,t]}else o=!1,a=i.pixelsToGLUnits;return{u_camera_to_center_distance:i.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:a}},ge=(t,e,n)=>{const r=bt(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},ve=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),ye=t=>({u_matrix:t}),_e=(t,e,n,r)=>({u_matrix:t,u_extrude_scale:bt(e,1,n),u_intensity:r});function xe(e,n){const r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new t.MercatorCoordinate(0,i/r).toLngLat().lat,new t.MercatorCoordinate(0,(i+1)/r).toLngLat().lat]}const be=(t,e,n,r)=>{const i=t.transform;return{u_matrix:Ce(t,e,n,r),u_ratio:1/bt(e,1,i.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},we=(e,n,r,i,o)=>t.extend(be(e,n,r,o),{u_image:0,u_image_height:i}),Se=(t,e,n,r,i)=>{const o=t.transform,a=ke(e,o);return{u_matrix:Ce(t,e,n,i),u_texsize:e.imageAtlasTexture.size,u_ratio:1/bt(e,1,o.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Ee=(e,n,r,i,o,a)=>{const s=e.lineAtlas,l=ke(n,e.transform),u="round"===r.layout.get("line-cap"),c=s.getDash(i.from,u),h=s.getDash(i.to,u),f=c.width*o.fromScale,p=h.width*o.toScale;return t.extend(be(e,n,r,a),{u_patternscale_a:[l/f,-c.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:s.width/(256*Math.min(f,p)*e.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:o.t})};function ke(t,e){return 1/bt(t,1,e.tileZoom)}function Ce(t,e,n,r){return t.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Ie=(t,e,n,r,i)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Te(i.paint.get("raster-hue-rotate"))};var o,a};function Te(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Pe=(t,e,n,r,i,o,a,s,l,u)=>{const c=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},Ae=(e,n,r,i,o,a,s,l,u,c,h)=>{const f=o.transform;return t.extend(Pe(e,n,r,i,o,a,s,l,u,c),{u_gamma_scale:i?Math.cos(f._pitch)*f.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:+h})},Me=(e,n,r,i,o,a,s,l,u,c)=>t.extend(Ae(e,n,r,i,o,a,s,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1}),Le=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),Re=(e,n,r,i,o,a)=>t.extend(function(t,e,n,r){const i=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),{width:a,height:s}=n.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,n.transform.tileZoom)/l,c=u*(r.tileID.canonical.x+r.tileID.wrap*l),h=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[a,s],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/bt(r,1,n.transform.tileZoom),u_pixel_coord_upper:[c>>16,h>>16],u_pixel_coord_lower:[65535&c,65535&h]}}(i,a,r,o),{u_matrix:e,u_opacity:n}),De={fillExtrusion:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}),collisionCircle:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}),lineGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}),linePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),lineSDF:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}),raster:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),background:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}),terrain:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texture:new t.Uniform1i(e,n.u_texture)}),terrainDepth:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),terrainCoords:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texture:new t.Uniform1i(e,n.u_texture),u_terrain_coords_id:new t.Uniform1f(e,n.u_terrain_coords_id)})};class Ne{constructor(t,e,n){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ze={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Oe{constructor(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,n){for(let r=0;r<this.attributes.length;r++){const i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[ze[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Fe{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Be extends Fe{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class je extends Fe{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Ue extends Fe{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ve extends Fe{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ze extends Fe{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class qe extends Fe{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ge extends Fe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class We extends Fe{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Xe extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class He extends Fe{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ye extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class $e extends Fe{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ke extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class Je extends Fe{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Qe extends Fe{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class tn extends Fe{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class en extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class nn extends Fe{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class rn extends Fe{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class on extends Fe{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class an extends Fe{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class sn extends Fe{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ln extends Fe{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class un extends Fe{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class cn extends Fe{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class hn extends Fe{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class fn extends Fe{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class pn extends Fe{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class dn extends Fe{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class mn extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class gn extends Fe{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class vn extends Fe{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class yn extends vn{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class _n extends vn{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class xn{constructor(t,e,n,r){this.context=t,this.width=e,this.height=n;const i=t.gl,o=this.framebuffer=i.createFramebuffer();if(this.colorAttachment=new yn(t,o),r&&(this.depthAttachment=new _n(t,o)),i.checkFramebufferStatus(i.FRAMEBUFFER)!==i.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class bn{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}bn.Replace=[1,0],bn.disabled=new bn(bn.Replace,t.Color.transparent,[!1,!1,!1,!1]),bn.unblended=new bn(bn.Replace,t.Color.transparent,[!0,!0,!0,!0]),bn.alphaBlended=new bn([1,771],t.Color.transparent,[!0,!0,!0,!0]);class wn{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Be(this),this.clearDepth=new je(this),this.clearStencil=new Ue(this),this.colorMask=new Ve(this),this.depthMask=new Ze(this),this.stencilMask=new qe(this),this.stencilFunc=new Ge(this),this.stencilOp=new We(this),this.stencilTest=new Xe(this),this.depthRange=new He(this),this.depthTest=new Ye(this),this.depthFunc=new $e(this),this.blend=new Ke(this),this.blendFunc=new Je(this),this.blendColor=new Qe(this),this.blendEquation=new tn(this),this.cullFace=new en(this),this.cullFaceSide=new nn(this),this.frontFace=new rn(this),this.program=new on(this),this.activeTexture=new an(this),this.viewport=new sn(this),this.bindFramebuffer=new ln(this),this.bindRenderbuffer=new un(this),this.bindTexture=new cn(this),this.bindVertexBuffer=new hn(this),this.bindElementBuffer=new fn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new pn(this),this.pixelStoreUnpack=new dn(this),this.pixelStoreUnpackPremultiplyAlpha=new mn(this),this.pixelStoreUnpackFlipY=new gn(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new Ne(this,t,e)}createVertexBuffer(t,e,n){return new Oe(this,t,e,n)}createRenderbuffer(t,e,n){const r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i}createFramebuffer(t,e,n){return new xn(this,t,e,n)}clear({color:t,depth:e}){const n=this.gl;let r=0;t&&(r|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),n.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){i(t.blendFunction,bn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Sn{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}Sn.ReadOnly=!1,Sn.ReadWrite=!0,Sn.disabled=new Sn(519,Sn.ReadOnly,[0,1]);const En=7680;class kn{constructor(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o}}kn.disabled=new kn({func:519,mask:0},0,0,En,En,En);class Cn{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}let In;function Tn(e,n,r,i,o,a,s){const l=e.context,u=l.gl,c=e.useProgram("collisionBox"),h=[];let f=0,p=0;for(let x=0;x<i.length;x++){const d=i[x],m=n.getTile(d),g=m.getBucket(r);if(!g)continue;let v=d.posMatrix;0===o[0]&&0===o[1]||(v=e.translatePosMatrix(d.posMatrix,m,o,a));const y=s?g.textCollisionBox:g.iconCollisionBox,_=g.collisionCircleArray;if(_.length>0){const n=t.create(),r=v;t.mul(n,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(n,n,g.placementViewportMatrix),h.push({circleArray:_,circleOffset:p,transform:r,invTransform:n,coord:d}),f+=_.length/4,p=f}y&&c.draw(l,u.LINES,Sn.disabled,kn.disabled,e.colorModeForRenderPass(),Cn.disabled,ge(v,e.transform,m),e.style.terrain&&e.style.terrain.getTerrainData(d),r.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,e.transform.zoom,null,null,y.collisionVertexBuffer)}if(!s||!h.length)return;const d=e.useProgram("collisionCircle"),m=new t.CollisionCircleLayoutArray;m.resize(4*f),m._trim();let g=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,r=t.circleArray[n+0],i=t.circleArray[n+1],o=t.circleArray[n+2],a=t.circleArray[n+3];m.emplace(g++,r,i,o,a,0),m.emplace(g++,r,i,o,a,1),m.emplace(g++,r,i,o,a,2),m.emplace(g++,r,i,o,a,3)}(!In||In.length<2*f)&&(In=function(e){const n=2*e,r=new t.QuadTriangleArray;r.resize(n),r._trim();for(let t=0;t<n;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(f));const v=l.createIndexBuffer(In,!0),y=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const x of h){const n={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(_=e.transform).cameraToCenterDistance,u_viewport_size:[_.width,_.height]};d.draw(l,u.TRIANGLES,Sn.disabled,kn.disabled,e.colorModeForRenderPass(),Cn.disabled,n,e.style.terrain&&e.style.terrain.getTerrainData(x.coord),r.id,y,v,t.SegmentVector.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,e.transform.zoom,null,null,null)}var _;y.destroy(),v.destroy()}Cn.disabled=new Cn(!1,1029,2305),Cn.backCCW=new Cn(!0,1029,2305);const Pn=t.identity(new Float32Array(16));function An(e,n,r,i,o,a){const{horizontalAlign:s,verticalAlign:l}=t.getAnchorAlignment(e),u=-(s-.5)*n,c=-(l-.5)*r,h=t.evaluateVariableOffset(e,i);return new t.pointGeometry((u/o+h[0])*a,(c/o+h[1])*a)}function Mn(e,n,r,i,o,a,s,l,u,c,h){const f=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,d=e.icon.dynamicLayoutVertexArray,m={};p.clear();for(let g=0;g<f.length;g++){const d=f.get(g),v=e.allowVerticalPlacement&&!d.placedOrientation,y=d.hidden||!d.crossTileID||v?null:i[d.crossTileID];if(y){const i=new t.pointGeometry(d.anchorX,d.anchorY),f=st(i,r?s:a,h),g=lt(o.cameraToCenterDistance,f.signedDistanceFromCamera);let v=t.evaluateSizeForFeature(e.textSizeData,u,d)*g/t.ONE_EM;r&&(v*=e.tilePixelRatio/l);const{width:_,height:x,anchor:b,textOffset:w,textBoxScale:S}=y,E=An(b,_,x,w,S,v),k=r?st(i.add(E),a,h).point:f.point.add(n?E.rotate(-o.angle):E),C=e.allowVerticalPlacement&&d.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<d.numGlyphs;e++)t.addDynamicAttributes(p,k,C);c&&d.associatedIconIndex>=0&&(m[d.associatedIconIndex]={shiftedAnchor:k,angle:C})}else vt(d.numGlyphs,p)}if(c){d.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const r=n.get(e);if(r.hidden)vt(r.numGlyphs,d);else{const n=m[e];if(n)for(let e=0;e<r.numGlyphs;e++)t.addDynamicAttributes(d,n.shiftedAnchor,n.angle);else vt(r.numGlyphs,d)}}e.icon.dynamicLayoutVertexBuffer.updateData(d)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function Ln(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Rn(e,n,r,i,o,a,s,l,u,c,h,f){const p=e.context,d=p.gl,m=e.transform,g="map"===l,v="map"===u,y="viewport"!==l&&"point"!==r.layout.get("symbol-placement"),_=g&&!v&&!y,x=!r.layout.get("symbol-sort-key").isConstant();let b=!1;const w=e.depthModeForSublayer(0,Sn.ReadOnly),S=r.layout.get("text-variable-anchor"),E=[];for(const k of i){const i=n.getTile(k),l=i.getBucket(r);if(!l)continue;const u=o?l.text:l.icon;if(!u||!u.segments.get().length)continue;const h=u.programConfigurations.get(r.id),f=o||l.sdfIcons,p=o?l.textSizeData:l.iconSizeData,w=v||0!==m.pitch,C=e.useProgram(Ln(f,o,l),h),I=t.evaluateSizeForZoom(p,m.zoom),T=e.style.terrain&&e.style.terrain.getTerrainData(k);let P,A,M,L,R=[0,0],D=null;if(o){if(A=i.glyphAtlasTexture,M=d.LINEAR,P=i.glyphAtlasTexture.size,l.iconsInText){R=i.imageAtlasTexture.size,D=i.imageAtlasTexture;const t="composite"===p.kind||"camera"===p.kind;L=w||e.options.rotating||e.options.zooming||t?d.LINEAR:d.NEAREST}}else{const t=1!==r.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;A=i.imageAtlasTexture,M=f||e.options.rotating||e.options.zooming||t||w?d.LINEAR:d.NEAREST,P=i.imageAtlasTexture.size}const N=bt(i,1,e.transform.zoom),z=ot(k.posMatrix,v,g,e.transform,N),O=at(k.posMatrix,v,g,e.transform,N),F=S&&l.hasTextData(),B="none"!==r.layout.get("icon-text-fit")&&F&&l.hasIconData();if(y){const t=e.style.terrain?(t,n)=>e.style.terrain.getElevation(k,t,n):null,n="map"===r.layout.get("text-rotation-alignment");ct(l,k.posMatrix,e,o,z,O,v,c,n,t)}const j=e.translatePosMatrix(k.posMatrix,i,a,s),U=y||o&&S||B?Pn:z,V=e.translatePosMatrix(O,i,a,s,!0),Z=f&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let q;q=f?l.iconsInText?Me(p.kind,I,_,v,e,j,U,V,P,R):Ae(p.kind,I,_,v,e,j,U,V,o,P,!0):Pe(p.kind,I,_,v,e,j,U,V,o,P);const G={program:C,buffers:u,uniformValues:q,atlasTexture:A,atlasTextureIcon:D,atlasInterpolation:M,atlasInterpolationIcon:L,isSDF:f,hasHalo:Z};if(x&&l.canOverlap){b=!0;const e=u.segments.get();for(const n of e)E.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:G,terrainData:T})}else E.push({segments:u.segments,sortKey:0,state:G,terrainData:T})}b&&E.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of E){const n=t.state;if(p.activeTexture.set(d.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,d.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(d.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),n.isSDF){const i=n.uniformValues;n.hasHalo&&(i.u_is_halo=1,Dn(n.buffers,t.segments,r,e,n.program,w,h,f,i,t.terrainData)),i.u_is_halo=0}Dn(n.buffers,t.segments,r,e,n.program,w,h,f,n.uniformValues,t.terrainData)}}function Dn(t,e,n,r,i,o,a,s,l,u){const c=r.context;i.draw(c,c.gl.TRIANGLES,o,a,s,Cn.disabled,l,u,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Nn(t,e,n,r,i,o,a){const s=t.context.gl,l=n.paint.get("fill-pattern"),u=l&&l.constantOr(1),c=n.getCrossfadeParameters();let h,f,p,d,m;a?(f=u&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=s.LINES):(f=u?"fillPattern":"fill",h=s.TRIANGLES);for(const g of r){const r=e.getTile(g);if(u&&!r.patternsLoaded())continue;const v=r.getBucket(n);if(!v)continue;const y=v.programConfigurations.get(n.id),_=t.useProgram(f,y),x=t.style.terrain&&t.style.terrain.getTerrainData(g);u&&(t.context.activeTexture.set(s.TEXTURE0),r.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),y.updatePaintBuffers(c));const b=l.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],n=t.patternPositions[b.from.toString()];e&&n&&y.setConstantPatternPositions(e,n)}const w=x?g:null,S=t.translatePosMatrix(w?w.posMatrix:g.posMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){d=v.indexBuffer2,m=v.segments2;const e=[s.drawingBufferWidth,s.drawingBufferHeight];p="fillOutlinePattern"===f&&u?de(S,t,c,r,e):pe(S,e)}else d=v.indexBuffer,m=v.segments,p=u?fe(S,t,c,r):he(S);_.draw(t.context,h,i,t.stencilModeForClipping(g),o,Cn.disabled,p,x,n.id,v.layoutVertexBuffer,d,m,n.paint,t.transform.zoom,y)}}function zn(t,e,n,r,i,o,a){const s=t.context,l=s.gl,u=n.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),h=n.getCrossfadeParameters(),f=n.paint.get("fill-extrusion-opacity");for(const p of r){const r=e.getTile(p),d=r.getBucket(n);if(!d)continue;const m=t.style.terrain&&t.style.terrain.getTerrainData(p),g=d.programConfigurations.get(n.id),v=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",g);c&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),g.updatePaintBuffers(h));const y=u.constantOr(null);if(y&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[y.to.toString()],n=t.patternPositions[y.from.toString()];e&&n&&g.setConstantPatternPositions(e,n)}const _=t.translatePosMatrix(p.posMatrix,r,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),x=n.paint.get("fill-extrusion-vertical-gradient"),b=c?ce(_,t,x,f,p,h,r):ue(_,t,x,f);v.draw(s,s.gl.TRIANGLES,i,o,a,Cn.backCCW,b,m,n.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,n.paint,t.transform.zoom,g,t.style.terrain&&d.centroidVertexBuffer)}}function On(t,e,n,r,i,o,a){const s=t.context,l=s.gl,u=n.fbo;if(!u)return;const c=t.useProgram("hillshade"),h=t.style.terrain&&t.style.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get()),c.draw(s,l.TRIANGLES,i,o,a,Cn.disabled,((t,e,n,r)=>{const i=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),a=n.paint.get("hillshade-accent-color");let s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);const l=!t.options.moving;return{u_matrix:r?r.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:xe(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}})(t,n,r,h?e:null),h,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function Fn(e,n,r,i,o,a){const s=e.context,u=s.gl,c=n.dem;if(c&&c.data){const h=c.dim,f=c.stride,p=c.getPixels();if(s.activeTexture.set(u.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(f),n.demTexture){const t=n.demTexture;t.update(p,{premultiply:!1}),t.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else n.demTexture=new l(s,p,u.RGBA,{premultiply:!1}),n.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);s.activeTexture.set(u.TEXTURE0);let d=n.fbo;if(!d){const t=new l(s,{width:h,height:h,data:null},u.RGBA);t.bind(u.LINEAR,u.CLAMP_TO_EDGE),d=n.fbo=s.createFramebuffer(h,h,!0),d.colorAttachment.set(t.texture)}s.bindFramebuffer.set(d.framebuffer),s.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(s,u.TRIANGLES,i,o,a,Cn.disabled,((e,n)=>{const r=n.stride,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}})(n.tileID,c),null,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Bn(e,n,r,i,o,a){const s=i.paint.get("raster-fade-duration");if(!a&&s>0){const i=t.exported.now(),a=(i-e.timeAdded)/s,l=n?(i-n.timeAdded)/s:-1,u=r.getSource(),c=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-c)>Math.abs(e.tileID.overscaledZ-c),f=h&&e.refreshedUponExpiration?1:t.clamp(h?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}const jn=new t.Color(1,0,0,1),Un=new t.Color(0,1,0,1),Vn=new t.Color(0,0,1,1),Zn=new t.Color(1,0,1,1),qn=new t.Color(0,1,1,1);function Gn(t,e,n,r){Xn(t,0,e+n/2,t.transform.width,n,r)}function Wn(t,e,n,r){Xn(t,e-n/2,0,n,t.transform.height,r)}function Xn(t,e,n,r,i,o){const a=t.context,s=a.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*t.pixelRatio,n*t.pixelRatio,r*t.pixelRatio,i*t.pixelRatio),a.clear({color:o}),s.disable(s.SCISSOR_TEST)}function Hn(e,n,r){const i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),l=Sn.disabled,u=kn.disabled,c=e.colorModeForRenderPass(),h="$debug",f=e.style.terrain&&e.style.terrain.getTerrainData(r);i.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE);const p=n.getTileByID(r.key).latestRawTileData,d=Math.floor((p&&p.byteLength||0)/1024),m=n.getTile(r).tileSize,g=512/Math.min(m,512)*(r.overscaledZ/e.transform.zoom)*.5;let v=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(v+=` => ${r.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,r=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,`${v} ${d}kB`),s.draw(i,o.TRIANGLES,l,u,bn.alphaBlended,Cn.disabled,ve(a,t.Color.transparent,g),null,h,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),s.draw(i,o.LINE_STRIP,l,u,c,Cn.disabled,ve(a,t.Color.red),f,h,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function Yn(t,e,n){const r=t.context,i=r.gl,o=t.colorModeForRenderPass(),a=new Sn(i.LEQUAL,Sn.ReadWrite,t.depthRangeFor3D),s=t.useProgram("terrain"),l=e.getTerrainMesh(),u=e.getTerrainData(n.tileID);r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height]),r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e.getRTTFramebuffer().colorAttachment.get());const c=t.transform.calculatePosMatrix(n.tileID.toUnwrapped());s.draw(r,i.TRIANGLES,a,kn.disabled,o,Cn.backCCW,{u_matrix:c,u_texture:0},u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}function $n(t,e,n,r){const i=t.context,o=n.tileSize*e.qualityFactor;n.textures[r]||(n.textures[r]=t.getTileTexture(o)||new l(i,{width:o,height:o,data:null},i.gl.RGBA),n.textures[r].bind(i.gl.LINEAR,i.gl.CLAMP_TO_EDGE),0===r&&e.sourceCache.renderHistory.unshift(n.tileID.key));const a=e.getRTTFramebuffer();a.colorAttachment.set(n.textures[r].texture),i.bindFramebuffer.set(a.framebuffer),i.viewport.set([0,0,o,o])}class Kn{constructor(t){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=t,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=t.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const t=this.painter.style,e=t.terrain;for(const n in t.sourceCaches){this._coordsDescendingInv[n]={};const r=t.sourceCaches[n].getVisibleCoordinates();for(const t of r){const r=e.sourceCache.getTerrainCoords(t);for(const t in r)this._coordsDescendingInv[n][t]||(this._coordsDescendingInv[n][t]=[]),this._coordsDescendingInv[n][t].push(r[t])}}for(const n of t._order){const e=t._layers[n],r=e.source;if(this._renderToTexture[e.type]&&!this._coordsDescendingInvStr[r]){this._coordsDescendingInvStr[r]={};for(const t in this._coordsDescendingInv[r])this._coordsDescendingInvStr[r][t]=this._coordsDescendingInv[r][t].map((t=>t.key)).sort().join()}}return this._renderableTiles.forEach((t=>{for(const n in this._coordsDescendingInvStr){const r=this._coordsDescendingInvStr[n][t.tileID.key];r&&r!==t.textureCoords[n]&&t.clearTextures(this.painter),e.needsRerender(n,t.tileID)&&t.clearTextures(this.painter)}this._rerender[t.tileID.key]=!t.textures.length})),e.clearRerenderCache(),e.sourceCache.removeOutdated(this.painter),this}renderLayer(e){const n=e.type,r=this.painter,i=r.style._order,o=r.currentLayer,a=o+1===i.length;if(this._renderToTexture[n]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(i[o]),!a))return!0;if(this._renderToTexture[this._prevType]||"hillshade"===n||this._renderToTexture[n]&&a){this._prevType=n;const a=this._stacks.length-1,s=this._stacks[a]||[];for(const e of this._renderableTiles){if($n(r,r.style.terrain,e,a),this._rerender[e.tileID.key]){r.context.clear({color:t.Color.transparent});for(let t=0;t<s.length;t++){const n=r.style._layers[s[t]],i=n.source?this._coordsDescendingInv[n.source][e.tileID.key]:[e.tileID];r._renderTileClippingMasks(n,i),r.renderLayer(r,r.style.sourceCaches[n.source],n,i),n.source&&(e.textureCoords[n.source]=this._coordsDescendingInvStr[n.source][e.tileID.key])}}Yn(r,r.style.terrain,e)}if("hillshade"===n){this._stacks.push([i[o]]);for(const n of this._renderableTiles){const i=this._coordsDescendingInv[e.source][n.tileID.key];$n(r,r.style.terrain,n,this._stacks.length-1),r.context.clear({color:t.Color.transparent}),r._renderTileClippingMasks(e,i),r.renderLayer(r,r.style.sourceCaches[e.source],e,i),Yn(r,r.style.terrain,n)}return!0}return this._renderToTexture[n]}return!1}}const Jn={symbol:function(e,n,r,i,o){if("translucent"!==e.renderPass)return;const a=kn.disabled,s=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,o,a,s){const l=n.transform,u="map"===o,c="map"===a;for(const h of e){const e=i.getTile(h),o=e.getBucket(r);if(!o||!o.text||!o.text.segments.get().length)continue;const a=t.evaluateSizeForZoom(o.textSizeData,l.zoom),f=bt(e,1,n.transform.zoom),p=ot(h.posMatrix,c,u,n.transform,f),d="none"!==r.layout.get("icon-text-fit")&&o.hasIconData();if(a){const t=Math.pow(2,l.zoom-e.tileID.overscaledZ);Mn(o,u,c,s,l,p,h.posMatrix,t,a,d,n.style.terrain?(t,e)=>n.style.terrain.getElevation(h,t,e):null)}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&Rn(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,s),0!==r.paint.get("text-opacity").constantOr(1)&&Rn(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Tn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Tn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,r,i){if("translucent"!==e.renderPass)return;const o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(0===o.constantOr(1)&&(0===a.constantOr(1)||0===s.constantOr(1)))return;const u=e.context,c=u.gl,h=e.depthModeForSublayer(0,Sn.ReadOnly),f=kn.disabled,p=e.colorModeForRenderPass(),d=[];for(let m=0;m<i.length;m++){const o=i[m],a=n.getTile(o),s=a.getBucket(r);if(!s)continue;const u=s.programConfigurations.get(r.id),c=e.useProgram("circle",u),h=s.layoutVertexBuffer,f=s.indexBuffer,p=e.style.terrain&&e.style.terrain.getTerrainData(o),g={programConfiguration:u,program:c,layoutVertexBuffer:h,indexBuffer:f,uniformValues:me(e,o,a,r),terrainData:p};if(l){const e=s.segments.get();for(const n of e)d.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:g})}else d.push({segments:s.segments,sortKey:0,state:g})}l&&d.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of d){const{programConfiguration:n,program:i,layoutVertexBuffer:o,indexBuffer:a,uniformValues:s,terrainData:l}=t.state;i.draw(u,c.TRIANGLES,h,f,p,Cn.disabled,s,l,r.id,o,a,t.segments,r.paint,e.transform.zoom,n)}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const o=e.context,a=o.gl,s=kn.disabled,l=new bn([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{const o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,r){const i=t.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width/4,e.height/4,0,i.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,e,o,i)}}(o,e,r),o.clear({color:t.Color.transparent});for(let t=0;t<i.length;t++){const u=i[t];if(n.hasRenderableParent(u))continue;const c=n.getTile(u),h=c.getBucket(r);if(!h)continue;const f=h.programConfigurations.get(r.id),p=e.useProgram("heatmap",f),{zoom:d}=e.transform;p.draw(o,a.TRIANGLES,Sn.disabled,s,l,Cn.disabled,_e(u.posMatrix,c,d,r.paint.get("heatmap-intensity")),null,r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,r.paint,e.transform.zoom,f)}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const r=e.context,i=r.gl,o=n.heatmapFbo;if(!o)return;r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);let a=n.colorRampTexture;a||(a=n.colorRampTexture=new l(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Sn.disabled,kn.disabled,e.colorModeForRenderPass(),Cn.disabled,((e,n,r,i)=>{const o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);const a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(e,n),null,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,r))},line:function(e,n,r,i){if("translucent"!==e.renderPass)return;const o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0===o.constantOr(1)||0===a.constantOr(1))return;const s=e.depthModeForSublayer(0,Sn.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),h=r.paint.get("line-pattern"),f=h.constantOr(1),p=r.paint.get("line-gradient"),d=r.getCrossfadeParameters(),m=f?"linePattern":c?"lineSDF":p?"lineGradient":"line",g=e.context,v=g.gl;let y=!0;for(const _ of i){const i=n.getTile(_);if(f&&!i.patternsLoaded())continue;const o=i.getBucket(r);if(!o)continue;const a=o.programConfigurations.get(r.id),x=e.context.program.get(),b=e.useProgram(m,a),w=y||b.program!==x,S=e.style.terrain&&e.style.terrain.getTerrainData(_),E=h.constantOr(null);if(E&&i.imageAtlas){const t=i.imageAtlas,e=t.patternPositions[E.to.toString()],n=t.patternPositions[E.from.toString()];e&&n&&a.setConstantPatternPositions(e,n)}const k=S?_:null,C=f?Se(e,i,r,d,k):c?Ee(e,i,r,c,d,k):p?we(e,i,r,o.lineClipsArray.length,k):be(e,i,r,k);if(f)g.activeTexture.set(v.TEXTURE0),i.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),a.updatePaintBuffers(d);else if(c&&(w||e.lineAtlas.dirty))g.activeTexture.set(v.TEXTURE0),e.lineAtlas.bind(g);else if(p){const i=o.gradients[r.id];let a=i.texture;if(r.gradientVersion!==i.version){let s=256;if(r.stepInterpolant){const r=n.getSource().maxzoom,i=_.canonical.z===r?Math.ceil(1<<e.transform.maxZoom-_.canonical.z):1;s=t.clamp(t.nextPowerOfTwo(o.maxLineLength/t.EXTENT*1024*i),256,g.maxTextureSize)}i.gradient=t.renderColorRamp({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:i.gradient||void 0,clips:o.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new l(g,i.gradient,v.RGBA),i.version=r.gradientVersion,a=i.texture}g.activeTexture.set(v.TEXTURE0),a.bind(r.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}b.draw(g,v.TRIANGLES,s,e.stencilModeForClipping(_),u,Cn.disabled,C,S,r.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,r.paint,e.transform.zoom,a,o.layoutVertexBuffer2),y=!1}},fill:function(e,n,r,i){const o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0===a.constantOr(1))return;const s=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const t=e.depthModeForSublayer(1,"opaque"===e.renderPass?Sn.ReadWrite:Sn.ReadOnly);Nn(e,n,r,i,t,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const t=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Sn.ReadOnly);Nn(e,n,r,i,t,s,!0)}},"fill-extrusion":function(t,e,n,r){const i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===t.renderPass){const o=new Sn(t.context.gl.LEQUAL,Sn.ReadWrite,t.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))zn(t,e,n,r,o,kn.disabled,bn.disabled),zn(t,e,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const i=t.colorModeForRenderPass();zn(t,e,n,r,o,kn.disabled,i)}}},hillshade:function(t,e,n,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const i=t.context,o=t.depthModeForSublayer(0,Sn.ReadOnly),a=t.colorModeForRenderPass(),[s,l]="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r];for(const u of l){const r=e.getTile(u);void 0!==r.needsHillshadePrepare&&r.needsHillshadePrepare&&"offscreen"===t.renderPass?Fn(t,r,n,o,kn.disabled,a):"translucent"===t.renderPass&&On(t,u,r,n,o,s[u.overscaledZ],a)}i.viewport.set([0,0,t.width,t.height])},raster:function(t,e,n,r){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!r.length)return;const i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),[u,c]=a instanceof T?[{},r]:t.stencilConfigForOverlap(r),h=c[c.length-1].overscaledZ,f=!t.options.moving;for(const p of c){const r=t.depthModeForSublayer(p.overscaledZ-h,1===n.paint.get("raster-opacity")?Sn.ReadWrite:Sn.ReadOnly,o.LESS),c=e.getTile(p);c.registerFadeDuration(n.paint.get("raster-fade-duration"));const d=e.findLoadedParent(p,0),m=Bn(c,d,e,n,t.transform,t.style.terrain);let g,v;const y="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),c.texture.bind(y,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),d?(d.texture.bind(y,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),g=Math.pow(2,d.tileID.overscaledZ-c.tileID.overscaledZ),v=[c.tileID.canonical.x*g%1,c.tileID.canonical.y*g%1]):c.texture.bind(y,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);const _=t.style.terrain&&t.style.terrain.getTerrainData(p),x=_?p:null,b=x?x.posMatrix:t.transform.calculatePosMatrix(p.toUnwrapped(),f),w=Ie(b,v||[0,0],g||1,m,n);a instanceof T?s.draw(i,o.TRIANGLES,r,kn.disabled,l,Cn.disabled,w,_,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):s.draw(i,o.TRIANGLES,r,u[p.overscaledZ],l,Cn.disabled,w,_,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n,r){const i=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0===o)return;const a=t.context,s=a.gl,l=t.transform,u=l.tileSize,c=n.paint.get("background-pattern");if(t.isPatternMissing(c))return;const h=!c&&1===i.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==h)return;const f=kn.disabled,p=t.depthModeForSublayer(0,"opaque"===h?Sn.ReadWrite:Sn.ReadOnly),d=t.colorModeForRenderPass(),m=t.useProgram(c?"backgroundPattern":"background"),g=r||l.coveringTiles({tileSize:u,terrain:t.style.terrain});c&&(a.activeTexture.set(s.TEXTURE0),t.imageManager.bind(t.context));const v=n.getCrossfadeParameters();for(const y of g){const e=r?y.posMatrix:t.transform.calculatePosMatrix(y.toUnwrapped()),l=c?Re(e,o,t,c,{tileID:y,tileSize:u},v):Le(e,o,i),h=t.style.terrain&&t.style.terrain.getTerrainData(y);m.draw(a,s.TRIANGLES,p,f,d,Cn.disabled,l,h,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}},debug:function(t,e,n){for(let r=0;r<n.length;r++)Hn(t,e,n[r])},custom:function(t,e,n){const r=t.context,i=n.implementation;if("offscreen"===t.renderPass){const e=i.prerender;e&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),e.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(kn.disabled);const e="3d"===i.renderingMode?new Sn(t.context.gl.LEQUAL,Sn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Sn.ReadOnly);r.setDepthMode(e),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}};class Qn{constructor(e,n){this.context=new wn(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.create(),renderTime:0},this.setup(),this.numSublayers=F.maxUnderzooming+F.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xt,this.gpuTimers={}}resize(t,e,n){if(this.width=t*n,this.height=e*n,this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const r of this.style._order)this.style._layers[r].resize()}setup(){const e=this.context,n=new t.PosArray;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,Ht.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const r=new t.PosArray;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,Ht.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const i=new t.RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,I.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.PosArray;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Ht.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const a=new t.LineStripIndexArray;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);const s=new t.TriangleIndexArray;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new l(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);const u=this.context.gl;this.stencilClearMode=new kn({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Sn.disabled,this.stencilClearMode,bn.disabled,Cn.disabled,ye(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const n=this.context,r=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(bn.disabled),n.setDepthMode(Sn.disabled);const i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const o of e){const t=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,e=this.style.terrain&&this.style.terrain.getTerrainData(o);i.draw(n,r.TRIANGLES,Sn.disabled,new kn({func:r.ALWAYS,mask:0},t,255,r.KEEP,r.KEEP,r.REPLACE),bn.disabled,Cn.disabled,ye(o.posMatrix),e,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new kn({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new kn({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,n=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=n[n.length-1].overscaledZ,i=n[0].overscaledZ-r+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const t={};for(let n=0;n<i;n++)t[n+r]=new kn({func:e.GEQUAL,mask:255},n+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=i,[t,n]}return[{[r]:kn.disabled},n]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new bn([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?bn.unblended:bn.alphaBlended}depthModeForSublayer(t,e,n){if(!this.opaquePassEnabledForLayer())return Sn.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Sn(n||this.context.gl.LEQUAL,e,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const r=this.style._order,i=this.style.sourceCaches,o=this.style.terrain&&new Kn(this);for(const t in i){const e=i[t];e.used&&e.prepare(this.context)}const a={},s={},l={};for(const t in i){const e=i[t];a[t]=e.getVisibleCoordinates(),s[t]=a[t].slice().reverse(),l[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}if(o){this.opaquePassCutoff=0;const e=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!t.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||e.length)&&(t.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,n){const r=e.context,i=r.gl,o=bn.unblended,a=new Sn(i.LEQUAL,Sn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.sourceCache.getRenderableTiles(),u=e.useProgram("terrainDepth");r.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.Color.transparent,depth:1});for(const t of l){const l=n.getTerrainData(t.tileID),c=e.transform.calculatePosMatrix(t.tileID.toUnwrapped());u.draw(r,i.TRIANGLES,a,kn.disabled,o,Cn.backCCW,{u_matrix:c},l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.terrain),function(e,n){const r=e.context,i=r.gl,o=bn.unblended,a=new Sn(i.LEQUAL,Sn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.getCoordsTexture(),u=n.sourceCache.getRenderableTiles(),c=e.useProgram("terrainCoords");r.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.Color.transparent,depth:1}),n.coordsIndex=[];for(const t of u){const u=n.getTerrainData(t.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);const h=e.transform.calculatePosMatrix(t.tileID.toUnwrapped());c.draw(r,i.TRIANGLES,a,kn.disabled,o,Cn.backCCW,{u_matrix:h,u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0},u,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),n.coordsIndex.push(t.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const t of r){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const n=s[e.source];("custom"===e.type||n.length)&&this.renderLayer(this,i[e.source],e,n)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!o)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[r[this.currentLayer]],e=i[t.source],n=a[t.source];this._renderTileClippingMasks(t,n),this.renderLayer(this,e,t,n)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=this.style._layers[r[this.currentLayer]],e=i[t.source];if(o&&o.renderLayer(t))continue;const n=("symbol"===t.type?l:s)[t.source];this._renderTileClippingMasks(t,a[t.source]),this.renderLayer(this,e,t,n)}if(this.options.showTileBoundaries){let t,e;Object.values(this.style._layers).forEach((n=>{n.source&&!n.isHidden(this.transform.zoom)&&(n.source!==(e&&e.id)&&(e=this.style.sourceCaches[n.source]),(!t||t.getSource().maxzoom<e.getSource().maxzoom)&&(t=e))})),t&&Jn.debug(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;Gn(t,t.transform.height-(e.top||0),3,jn),Gn(t,e.bottom||0,3,Un),Wn(t,e.left||0,3,Vn),Wn(t,t.transform.width-(e.right||0),3,Zn);const n=t.transform.centerPoint;!function(t,e,n,r){Xn(t,e-1,n-10,2,20,r),Xn(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,qn)}(this),this.context.setDefault()}renderLayer(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(r||[]).length)&&(this.id=n.id,this.gpuTimingStart(n),Jn[n.type](t,e,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const n in t){const r=t[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=o}return e}translatePosMatrix(e,n,r,i,o){if(!r[0]&&!r[1])return e;const a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);r=[r[0]*e-r[1]*t,r[0]*t+r[1]*e]}const s=[o?r[0]:bt(n,r[0],this.transform.zoom),o?r[1]:bt(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,s),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}useProgram(t,e){this.cache=this.cache||{};const n=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new se(this.context,t,re[t],e,De[t],this._showOverdrawInspector,this.style.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class tr{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,n,r){const i=Math.pow(2,r),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((r=>{const o=1/(r=t.transformMat4([],r,e))[3]/n*i;return t.mul$1(r,r,[o,o,1/r[3],o])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const n=t.sub([],o[e[0]],o[e[1]]),r=t.sub([],o[e[2]],o[e[1]]),i=t.normalize([],t.cross([],n,r)),a=-t.dot(i,o[e[1]]);return i.concat(a)}));return new tr(o,a)}}class er{constructor(e,n){this.min=e,this.max=n,this.center=t.scale$1([],t.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],r=t.clone$2(this.min),i=t.clone$2(this.max);for(let t=0;t<n.length;t++)r[t]=n[t]?this.min[t]:this.center[t],i[t]=n[t]?this.center[t]:this.max[t];return i[2]=this.max[2],new er(r,i)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let i=0;i<e.planes.length;i++){const o=e.planes[i];let a=0;for(let e=0;e<n.length;e++)t.dot$1(o,n[e])>=0&&a++;if(0===a)return 0;a!==n.length&&(r=!1)}if(r)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e.points.length;i++){const o=e.points[i][t]-this.min[t];n=Math.min(n,o),r=Math.max(r,o)}if(r<0||n>this.max[t]-this.min[t])return 0}return 1}}class nr{constructor(t=0,e=0,n=0,r=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=r}interpolate(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this}getCenter(e,n){const r=t.clamp((this.left+e-this.right)/2,0,e),i=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.pointGeometry(r,i)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new nr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class rr{constructor(e,n,r,i,o){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===o||!!o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new nr,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new rr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t._elevation=this._elevation,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.wrap(e,-180,180)*Math.PI/180;var r;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(r=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r),function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);t[0]=r*l+o*s,t[1]=i*l+a*s,t[2]=r*-s+o*l,t[3]=i*-s+a*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){const r=this.pointCoordinate(new t.pointGeometry(0,0)),i=this.pointCoordinate(new t.pointGeometry(this.width,0)),o=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),a=this.pointCoordinate(new t.pointGeometry(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),l=Math.floor(Math.max(r.x,i.x,o.x,a.x)),u=1;for(let c=s-u;c<=l+u;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e))}return n}coveringTiles(e){var n,r;let i=this.coveringZoomLevel(e);const o=i;if(void 0!==e.minzoom&&i<e.minzoom)return[];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);const a=this.pointCoordinate(this.getCameraPoint()),s=t.MercatorCoordinate.fromLngLat(this.center),l=Math.pow(2,i),u=[l*a.x,l*a.y,0],c=[l*s.x,l*s.y,0],h=tr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i);let f=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(f=i);const p=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,d=t=>({aabb:new er([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),m=[],g=[],v=i,y=e.reparseOverscaled?o:i;if(this._renderWorldCopies)for(let t=1;t<=3;t++)m.push(d(-t)),m.push(d(t));for(m.push(d(0));m.length>0;){const i=m.pop(),o=i.x,a=i.y;let s=i.fullyVisible;if(!s){const t=i.aabb.intersects(h);if(0===t)continue;s=2===t}const l=e.terrain?u:c,d=i.aabb.distanceX(l),_=i.aabb.distanceY(l),x=Math.max(Math.abs(d),Math.abs(_)),b=p+(1<<v-i.zoom)-2;if(i.zoom===v||x>b&&i.zoom>=f){const e=v-i.zoom,n=u[0]-.5-(o<<e),r=u[1]-.5-(a<<e);g.push({tileID:new t.OverscaledTileID(i.zoom===v?y:i.zoom,i.wrap,i.zoom,o,a),distanceSq:t.sqrLen([c[0]-.5-o,c[1]-.5-a]),tileDistanceToCamera:Math.sqrt(n*n+r*r)})}else for(let u=0;u<4;u++){const l=(o<<1)+u%2,c=(a<<1)+(u>>1),h=i.zoom+1;let f=i.aabb.quadrant(u);if(e.terrain){const o=new t.OverscaledTileID(h,i.wrap,h,l,c),a=e.terrain.getMinMaxElevation(o),s=null!==(n=a.minElevation)&&void 0!==n?n:this.elevation,u=null!==(r=a.maxElevation)&&void 0!==r?r:this.elevation;f=new er([f.min[0],f.min[1],s],[f.max[0],f.max[1],u])}m.push({aabb:f,zoom:h,x:l,y:c,wrap:i.wrap,fullyVisible:s})}}return g.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(e,n){const r=t.MercatorCoordinate.fromLngLat(e),i=(1<<this.tileZoom)*t.EXTENT,o=r.x*i,a=r.y*i,s=Math.floor(o/t.EXTENT),l=Math.floor(a/t.EXTENT),u=new t.OverscaledTileID(this.tileZoom,0,this.tileZoom,s,l);return n.getElevation(u,o%t.EXTENT,a%t.EXTENT,t.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const n=this.pointLocation(this.centerPoint,e),r=this.getElevation(n,e);if(!(this.elevation-r))return;const i=this.getCameraPosition(),o=t.MercatorCoordinate.fromLngLat(i.lngLat,i.altitude),a=t.MercatorCoordinate.fromLngLat(n,r),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.sqrt(s*s+l*l+u*u),h=this.scaleZoom(this.cameraToCenterDistance/c/this.tileSize);this._elevation=r,this._center=n,this.zoom=h}setLocationAtPoint(e,n){const r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,e),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(e,n){if(n){const t=n.pointCoordinate(e);if(null!=t)return t}const r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);const o=r[3],a=i[3],s=r[1]/o,l=i[1]/a,u=r[2]/o,c=i[2]/a,h=u===c?0:(0-u)/(c-u);return new t.MercatorCoordinate(t.number(r[0]/o,i[0]/a,h)/this.worldSize,t.number(s,l,h)/this.worldSize)}coordinatePoint(e,n=0,r=this.pixelMatrix){const i=[e.x*this.worldSize,e.y*this.worldSize,n,1];return t.transformMat4(i,i,r),new t.pointGeometry(i[0]/i[3],i[1]/i[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return(new t.LngLatBounds).extend(this.pointLocation(new t.pointGeometry(0,e))).extend(this.pointLocation(new t.pointGeometry(this.width,e))).extend(this.pointLocation(new t.pointGeometry(this.width,this.height))).extend(this.pointLocation(new t.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(e,n=!1){const r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];const o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),i[r]=new Float32Array(l),i[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,n,r,i,o=-90,a=90,s=-180,l=180;const u=this.size,c=this._unmodified;if(this.latRange){const n=this.latRange;o=t.mercatorYfromLat(n[1])*this.worldSize,a=t.mercatorYfromLat(n[0])*this.worldSize,e=a-o<u.y?u.y/(a-o):0}if(this.lngRange){const e=this.lngRange;s=t.wrap(t.mercatorXfromLng(e[0])*this.worldSize,0,this.worldSize),l=t.wrap(t.mercatorXfromLng(e[1])*this.worldSize,0,this.worldSize),l<s&&(l+=this.worldSize),n=l-s<u.x?u.x/(l-s):0}const h=this.point,f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.pointGeometry(n?(l+s)/2:h.x,e?(a+o)/2:h.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){const t=h.y,e=u.y/2;t-e<o&&(i=o+e),t+e>a&&(i=a-e)}if(this.lngRange){const e=(s+l)/2,n=t.wrap(h.x,e-this.worldSize/2,e+this.worldSize/2),i=u.x/2;n-i<s&&(r=s+i),n+i>l&&(r=l-i)}void 0===r&&void 0===i||(this.center=this.unproject(new t.pointGeometry(void 0!==r?r:h.x,void 0!==i?i:h.y)).wrap()),this._unmodified=c,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let i=t.identity(new Float64Array(16));t.scale(i,i,[this.width/2,-this.height/2,1]),t.translate(i,i,[1,-1,0]),this.labelPlaneMatrix=i,i=t.identity(new Float64Array(16)),t.scale(i,i,[1,-1,1]),t.translate(i,i,[-1,-1,0]),t.scale(i,i,[2/this.width,2/this.height,1]),this.glCoordMatrix=i,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const o=Math.PI/2+this._pitch,a=this._fov*(.5+e.y/this.height),s=Math.sin(a)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-o-a,.01,Math.PI-.01)),l=this.getHorizon(),u=2*Math.atan(l/this.cameraToCenterDistance)*(.5+e.y/(2*l)),c=Math.sin(u)*this.cameraToSeaLevelDistance/Math.sin(t.clamp(Math.PI-o-u,.01,Math.PI-.01)),h=Math.cos(Math.PI/2-this._pitch)*s+this.cameraToSeaLevelDistance,f=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToSeaLevelDistance,p=1.01*Math.min(h,f),d=this.height/50;i=new Float64Array(16),t.perspective(i,this._fov,this.width/this.height,d,p),i[8]=2*-e.x/this.width,i[9]=2*e.y/this.height,t.scale(i,i,[1,-1,1]),t.translate(i,i,[0,0,-this.cameraToCenterDistance]),t.rotateX(i,i,this._pitch),t.rotateZ(i,i,this.angle),t.translate(i,i,[-n,-r,0]),this.mercatorMatrix=t.scale([],i,[this.worldSize,this.worldSize,this.worldSize]),t.scale(i,i,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,i),t.translate(i,i,[0,0,-this.elevation]),this.projMatrix=i,this.invProjMatrix=t.invert([],i),this.pixelMatrix3D=t.multiply(new Float64Array(16),this.labelPlaneMatrix,i);const m=this.width%2/2,g=this.height%2/2,v=Math.cos(this.angle),y=Math.sin(this.angle),_=n-Math.round(n)+v*m+y*g,x=r-Math.round(r)+v*g+y*m,b=new Float64Array(i);if(t.translate(b,b,[_>.5?_-1:_,x>.5?x-1:x,0]),this.alignedProjMatrix=b,i=t.invert(new Float64Array(16),this.pixelMatrix),!i)throw new Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new t.pointGeometry(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}getCameraQueryGeometry(e){const n=this.getCameraPoint();if(1===e.length)return[e[0],n];{let r=n.x,i=n.y,o=n.x,a=n.y;for(const t of e)r=Math.min(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.x),a=Math.max(a,t.y);return[new t.pointGeometry(r,i),new t.pointGeometry(o,i),new t.pointGeometry(o,a),new t.pointGeometry(r,a),new t.pointGeometry(r,i)]}}}class ir{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){let n=!1,r=null;const i=()=>{r=null,n&&(t(),r=setTimeout(i,300),n=!1)};return()=>(n=!0,r||i(),r)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch();let u="";if(u+=t?`/${o}/${a}/${n}`:`${n}/${a}/${o}`,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+=`/${Math.round(l)}`),this._hashName){const t=this._hashName;let e=!1;const n=window.location.hash.slice(1).split("&").map((n=>{const r=n.split("=")[0];return r===t?(e=!0,`${r}=${u}`):n})).filter((t=>t));return e||n.push(`${t}=${u}`),`#${n.join("&")}`}return`#${u}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}}}const or={linearity:.3,easing:t.bezier(0,0,.3,1)},ar=t.extend({deceleration:2500,maxSpeed:1400},or),sr=t.extend({deceleration:20,maxSpeed:1400},or),lr=t.extend({deceleration:1e3,maxSpeed:360},or),ur=t.extend({deceleration:1e3,maxSpeed:90},or);class cr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(n.pan.mag()){const o=fr(n.pan.mag(),r,t.extend({},ar,e||{}));i.offset=n.pan.mult(o.amount/n.pan.mag()),i.center=this._map.transform.center,hr(i,o)}if(n.zoom){const t=fr(n.zoom,r,sr);i.zoom=this._map.transform.zoom+t.amount,hr(i,t)}if(n.bearing){const e=fr(n.bearing,r,lr);i.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),hr(i,e)}if(n.pitch){const t=fr(n.pitch,r,ur);i.pitch=this._map.transform.pitch+t.amount,hr(i,t)}if(i.zoom||i.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;i.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.extend(i,{noMoveStart:!0})}}function hr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function fr(e,n,r){const{maxSpeed:i,linearity:o,deceleration:a}=r,s=t.clamp(e*o/(n/1e3),-i,i),l=Math.abs(s)/(a*o);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}class pr extends t.Event{constructor(e,n,r,i={}){const a=o.mousePos(n.getCanvasContainer(),r),s=n.unproject(a);super(e,t.extend({point:a,lngLat:s,originalEvent:r},i)),this._defaultPrevented=!1,this.target=n}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class dr extends t.Event{constructor(e,n,r){const i="touchend"===e?r.changedTouches:r.touches,a=o.touchPos(n.getCanvasContainer(),i),s=a.map((t=>n.unproject(t))),l=a.reduce(((t,e,n,r)=>t.add(e.div(r.length))),new t.pointGeometry(0,0));super(e,{points:a,point:l,lngLats:s,lngLat:n.unproject(l),originalEvent:r}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class mr extends t.Event{constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class gr{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new mr(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new pr(t.type,this._map,t))}mouseup(t){this._map.fire(new pr(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new pr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new pr(t.type,this._map,t))}mouseover(t){this._map.fire(new pr(t.type,this._map,t))}mouseout(t){this._map.fire(new pr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new dr(t.type,this._map,t))}touchmove(t){this._map.fire(new dr(t.type,this._map,t))}touchend(t){this._map.fire(new dr(t.type,this._map,t))}touchcancel(t){this._map.fire(new dr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new pr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new pr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yr{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const i=Math.min(r.x,n.x),a=Math.max(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.y,n.y);o.setTransform(this._box,`translate(${i}px,${s}px)`),this._box.style.width=a-i+"px",this._box.style.height=l-s+"px"}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const r=this._startPos,i=n;if(this.reset(),o.suppressClick(),r.x!==i.x||r.y!==i.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function _r(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const n={};for(let r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}class xr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){const n=new t.pointGeometry(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=_r(r,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const r=_r(n,e);for(const i in this.touches){const t=this.touches[i],e=r[i];(!e||e.dist(t)>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class br{constructor(t){this.singleTap=new xr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const r=this.singleTap.touchend(t,e,n);if(r){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(r)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class wr{constructor(){this._zoomIn=new br({numTouches:1,numTaps:2}),this._zoomOut=new br({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const r=this._zoomIn.touchend(t,e,n),i=this._zoomOut.touchend(t,e,n);return r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(r)},{originalEvent:t})}):i?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(i)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sr={0:1,2:2};class Er{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=o.mouseButton(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){const n=Sr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&o.mouseButton(t)===this._eventButton&&(this._moved&&o.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kr extends Er{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class Cr extends Er{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class Ir extends Er{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class Tr{constructor(t,e){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._map._cooperativeGestures&&(2===this._minTouches&&n.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,n.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,r){r.length>0&&(this._active=!0);const i=_r(r,n),o=new t.pointGeometry(0,0),a=new t.pointGeometry(0,0);let s=0;for(const t in i){const e=i[t],n=this._touches[t];n&&(o._add(e),a._add(e.sub(n)),s++,i[t]=e)}if(this._touches=i,s<this._minTouches||!a.mag())return;const l=a.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pr{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[r,i]=this._firstTwoTouches,o=Ar(n,e,r),a=Ar(n,e,i);if(!o||!a)return;const s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[r,i]=this._firstTwoTouches,a=Ar(n,e,r),s=Ar(n,e,i);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ar(t,e,n){for(let r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Mr(t,e){return Math.log(t/e)/Math.LN2}class Lr extends Pr{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Mr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Mr(this._distance,n),pinchAround:e}}}function Rr(t,e){return 180*t.angleWith(e)/Math.PI}class Dr extends Pr{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Rr(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=Rr(t,this._startVector);return Math.abs(n)<e}}function Nr(t){return Math.abs(t.y)>Math.abs(t.x)}class zr extends Pr{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,n){super.touchstart(t,e,n),this._currentTouchCount=n.length}_start(t){this._lastPoints=t,Nr(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const r=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,i=e.mag()>=2;if(!r&&!i)return;if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const o=t.y>0==e.y>0;return Nr(t)&&Nr(e)&&o}}const Or={panStep:100,bearingStep:15,pitchStep:10};class Fr{constructor(){const t=Or;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,r=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:a=>{const s=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:Br,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+n*this._bearingStep,pitch:a.getPitch()+r*this._pitchStep,offset:[-i*this._panStep,-o*this._panStep],center:a.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Br(t){return t*(2-t)}const jr=4.000244140625;class Ur{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;e.preventDefault()}let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=t.exported.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%jr==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=o.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>jr?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==n&&(n=1/n);const r="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(r*n))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:e.zoom,r=this._startZoom,i=this._easing;let o,a=!1;if("wheel"===this._type&&r&&i){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),s=i(e);o=t.number(r,n,s),e<1?this._frameId||(this._frameId=!0):a=!0}else o=n,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,r=(t.exported.now()-e.start)/e.duration,i=e.easing(r+.01)-e.easing(r),o=.27/Math.sqrt(i*i+1e-4)*.01,a=Math.sqrt(.0729-o*o);n=t.bezier(o,a,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}reset(){this._active=!1}}class Vr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Zr{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qr{constructor(){this._tap=new br({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const r=e[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gr{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Wr{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Xr{constructor(t,e,n,r){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hr=t=>t.zoom||t.drag||t.pitch||t.rotate;class Yr extends t.Event{}function $r(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Kr{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cr(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,i,a]of this._listeners)o.addEventListener(t,i,t===document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[t,e,n]of this._listeners)o.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new gr(e,t));const r=e.boxZoom=new yr(e,t);this._add("boxZoom",r);const i=new wr,o=new Zr;e.doubleClickZoom=new Vr(o,i),this._add("tapZoom",i),this._add("clickZoom",o);const a=new qr;this._add("tapDragZoom",a);const s=e.touchPitch=new zr(e);this._add("touchPitch",s);const l=new Cr(t),u=new Ir(t);e.dragRotate=new Wr(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const c=new kr(t),h=new Tr(t,e);e.dragPan=new Gr(n,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);const f=new Dr,p=new Lr;e.touchZoomRotate=new Xr(n,p,f,a),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);const d=e.scrollZoom=new Ur(e,this);this._add("scrollZoom",d,["mousePan"]);const m=e.keyboard=new Fr;this._add("keyboard",m),this._add("blockableMapEvent",new vr(e));for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[g]&&e[g].enable(t[g])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Hr(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},i={},a={},s=t.touches,l=s?this._getMapTouches(s):void 0,u=l?o.touchPos(this._el,l):o.mousePos(this._el,t);for(const{handlerName:o,handler:f,allowed:p}of this._handlers){if(!f.isEnabled())continue;let s;this._blockedByActive(a,p,o)?f.reset():f[e||t.type]&&(s=f[e||t.type](t,u,l),this.mergeHandlerResult(r,i,s,o,n),s&&s.needsRenderFrame&&this._triggerRenderFrame()),(s||f.isActive())&&(a[o]=f)}const c={};for(const o in this._previousActiveHandlers)a[o]||(c[o]=n);this._previousActiveHandlers=a,(Object.keys(c).length||$r(r))&&(this._changes.push([r,i,c]),this._triggerRenderFrame()),(Object.keys(a).length||$r(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(e,n,r,i,o){if(!r)return;t.extend(e,r);const a={handlerName:i,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(n.zoom=a),void 0!==r.panDelta&&(n.drag=a),void 0!==r.pitchDelta&&(n.pitch=a),void 0!==r.bearingDelta&&(n.rotate=a)}_applyChanges(){const e={},n={},r={};for(const[i,o,a]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.extend(n,o),t.extend(r,a);this._updateMapTransform(e,n,r),this._changes=[]}_updateMapTransform(e,n,r){const i=this._map,o=i.transform,a=i.style&&i.style.terrain;if(!($r(e)||a&&this._drag))return this._fireEvents(n,r,!0);let{panDelta:s,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:h,pinchAround:f}=e;void 0!==f&&(h=f),i._stop(!0),h=h||i.transform.centerPoint;const p=o.pointLocation(s?h.sub(s):h);u&&(o.bearing+=u),c&&(o.pitch+=c),l&&(o.zoom+=l),a?n.drag&&!this._drag?(this._drag={center:o.centerPoint,lngLat:o.pointLocation(h),point:h,handlerName:n.drag.handlerName},i.fire(new t.Event("freezeElevation",{freeze:!0}))):this._drag&&r[this._drag.handlerName]?(i.fire(new t.Event("freezeElevation",{freeze:!1})),this._drag=null):n.drag&&this._drag&&(o.center=o.pointLocation(o.centerPoint.sub(s))):o.setLocationAtPoint(p,h),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,r,!0)}_fireEvents(e,n,r){const i=Hr(this._eventsInProgress),o=Hr(e),a={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(a[`${t}start`]=n),this._eventsInProgress[t]=e[t]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in a)this._fireEvent(t,a[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const s={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||r,s[`${t}end`]=l)}for(const t in s)this._fireEvent(t,s[t]);const u=Hr(this._eventsInProgress);if(r&&(i||o)&&!u){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Yr("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Jr={extend:(e,...n)=>t.extend(e,...n),run(t){t()},logToElement(t,e=!1,n="log"){const r=window.document.getElementById(n);r&&(e&&(r.innerHTML=""),r.innerHTML+=`<br>${t}`)}};class Qr extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,r){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)}panTo(e,n,r){return this.easeTo(t.extend({center:e},n),r)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const r=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,n)}_cameraForBoxAndBearing(e,n,r,i){const o={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const t=i.padding;i.padding={top:t,bottom:t,right:t,left:t}}i.padding=t.extend(o,i.padding);const a=this.transform,s=a.padding,l=a.project(t.LngLat.convert(e)),u=a.project(t.LngLat.convert(n)),c=l.rotate(-r*Math.PI/180),h=u.rotate(-r*Math.PI/180),f=new t.pointGeometry(Math.max(c.x,h.x),Math.max(c.y,h.y)),p=new t.pointGeometry(Math.min(c.x,h.x),Math.min(c.y,h.y)),d=f.sub(p),m=(a.width-(s.left+s.right+i.padding.left+i.padding.right))/d.x,g=(a.height-(s.top+s.bottom+i.padding.top+i.padding.bottom))/d.y;if(g<0||m<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const v=Math.min(a.scaleZoom(a.scale*Math.min(m,g)),i.maxZoom),y=t.pointGeometry.convert(i.offset),_=new t.pointGeometry((i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2).rotate(r*Math.PI/180),x=y.add(_).mult(a.scale/a.zoomScale(v));return{center:a.unproject(l.add(u).div(2).sub(x)),zoom:v,bearing:r}}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}fitScreenCoordinates(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(n)),r,i),i,o)}_fitInternal(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}jumpTo(e,n){this.stop();const r=this.transform;let i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))}calculateCameraOptionsFromTo(e,n,r,i=0){const o=t.MercatorCoordinate.fromLngLat(e,n),a=t.MercatorCoordinate.fromLngLat(r,i),s=a.x-o.x,l=a.y-o.y,u=a.z-o.z,c=Math.hypot(s,l,u);if(0===c)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),f=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let d=180*Math.acos(h/c)/Math.PI;return d=u<0?90-d:90+d,{center:a.toLngLat(),zoom:f,pitch:d,bearing:p}}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const r=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?+e.zoom:i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:a,h="padding"in e?e.padding:r.padding,f=t.pointGeometry.convert(e.offset);let p=r.centerPoint.add(f);const d=r.pointLocation(p),m=t.LngLat.convert(e.center||d);this._normalizeCenter(m);const g=r.project(d),v=r.project(m).sub(g),y=r.zoomScale(l-i);let _,x;e.around&&(_=t.LngLat.convert(e.around),x=r.locationPoint(_));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==i,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==a,this._padding=!r.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,b),this._ease((e=>{if(this._zooming&&(r.zoom=t.number(i,l,e)),this._rotating&&(r.bearing=t.number(o,u,e)),this._pitching&&(r.pitch=t.number(a,c,e)),this._padding&&(r.interpolatePadding(s,h,e),p=r.centerPoint.add(f)),_)r.setLocationAtPoint(_,x);else{const t=r.zoomScale(r.zoom-i),n=l>i?Math.min(2,y):Math.max(.5,y),o=Math.pow(n,1-e),a=r.unproject(g.add(v.mult(e*o)).mult(t));r.setLocationAtPoint(r.renderWorldCopies?a.wrap():a,p)}this._fireMoveEvents(n)}),(t=>{this._afterEase(n,t)}),e),this}_prepareEase(e,n,r={}){this._moving=!0,this.fire(new t.Event("freezeElevation",{freeze:!0})),n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId,this.fire(new t.Event("freezeElevation",{freeze:!1}));const r=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(!e.essential&&t.exported.prefersReducedMotion){const r=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const r=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,r.minZoom,r.maxZoom):i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:a,h="padding"in e?e.padding:r.padding,f=r.zoomScale(l-i),p=t.pointGeometry.convert(e.offset);let d=r.centerPoint.add(p);const m=r.pointLocation(d),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);const v=r.project(m),y=r.project(g).sub(v);let _=e.curve;const x=Math.max(r.width,r.height),b=x/f,w=y.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,i,l),r.minZoom,r.maxZoom),o=x/r.zoomScale(n-i);_=Math.sqrt(o/w*2)}const S=_*_;function E(t){const e=(b*b-x*x+(t?-1:1)*S*S*w*w)/(2*(t?b:x)*S*w);return Math.log(Math.sqrt(e*e+1)-e)}function k(t){return(Math.exp(t)-Math.exp(-t))/2}function C(t){return(Math.exp(t)+Math.exp(-t))/2}const I=E(0);let T=function(t){return C(I)/C(I+_*t)},P=function(t){return x*((C(I)*(k(e=I+_*t)/C(e))-k(I))/S)/w;var e},A=(E(1)-I)/_;if(Math.abs(w)<1e-6||!isFinite(A)){if(Math.abs(x-b)<1e-6)return this.easeTo(e,n);const t=b<x?-1:1;A=Math.abs(Math.log(b/x))/_,P=function(){return 0},T=function(e){return Math.exp(t*_*e)}}return e.duration="duration"in e?+e.duration:1e3*A/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==a,this._padding=!r.isPaddingEqual(h),this._prepareEase(n,!1),this._ease((e=>{const f=e*A,m=1/T(f);r.zoom=1===e?l:i+r.scaleZoom(m),this._rotating&&(r.bearing=t.number(o,u,e)),this._pitching&&(r.pitch=t.number(a,c,e)),this._padding&&(r.interpolatePadding(s,h,e),d=r.centerPoint.add(p));const _=1===e?g:r.unproject(v.add(y.mult(P(f))).mult(m));r.setLocationAtPoint(r.renderWorldCopies?_.wrap():_,d),this._fireMoveEvents(n)}),(()=>this._afterEase(n)),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}}class ti{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=o.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString(`AttributionControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const r in e){const n=e[r];if(n.used||n.usedForTerrain){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,n)=>{for(let r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ei{constructor(e={}){this.options=e,t.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=o.create("div","maplibregl-ctrl mapboxgl-ctrl");const e=o.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact","mapboxgl-compact"):e.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class ni{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const r of n)if(r.id===t)return void(r.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ri={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},ii={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},oi={showCompass:!0,showZoom:!0,visualizePitch:!1};class ai{constructor(e,n,r=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new Cr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,r&&(this.mousePitch=new Ir({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchmove",this.touchmove),o.addEventListener(n,"touchend",this.touchend),o.addEventListener(n,"touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),o.disableDrag()}move(t,e){const n=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&n.setBearing(n.getBearing()+r.bearingDelta),this.mousePitch){const r=this.mousePitch.mousemoveWindow(t,e);r&&r.pitchDelta&&n.setPitch(n.getPitch()+r.pitchDelta)}}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(t,"touchmove",this.touchmove),o.removeEventListener(t,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(window,"mousemove",this.mousemove),o.removeEventListener(window,"mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(window,"mousemove",this.mousemove),o.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.move(t,o.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function si(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){const i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<a?e=i:r.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){const t=r.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=r.width&&t.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const li={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ui(t,e,n){const r=t.classList;for(const i in li)r.remove(`maplibregl-${n}-anchor-${i}`,`mapboxgl-${n}-anchor-${i}`);r.add(`maplibregl-${n}-anchor-${e}`,`mapboxgl-${n}-anchor-${e}`)}class ci extends t.Evented{constructor(e,n){if(super(),(e instanceof HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");const n=o.createNS("http://www.w3.org/2000/svg","svg"),r=41,i=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${r}px`),n.setAttributeNS(null,"width",`${i}px`),n.setAttributeNS(null,"viewBox",`0 0 ${i} ${r}`);const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of u){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const c=o.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const f=o.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");const p=o.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(p);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(6.0, 7.0)"),d.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const v=o.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(v),s.appendChild(l),s.appendChild(c),s.appendChild(f),s.appendChild(d),s.appendChild(m),n.appendChild(s),n.setAttributeNS(null,"height",r*this._scale+"px"),n.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(n),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),ui(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,r=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-n+r)],"bottom-right":[-r,-1*(e-n+r)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),o.setTransform(this._element,`${li[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${e}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const t=this._map.unproject(this._pos),e=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=t.distanceTo(this._lngLat)>20*e?"0.2":"1.0",this._opacityTimeout=null}),100))}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const hi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fi,pi=0,di=!1;const mi={maxWidth:100,unit:"metric"};function gi(t,e,n){const r=n&&n.maxWidth||100,i=t._container.clientHeight/2,o=t.unproject([0,i]),a=t.unproject([r,i]),s=o.distanceTo(a);if(n&&"imperial"===n.unit){const n=3.2808*s;n>5280?vi(e,r,n/5280,t._getUIString("ScaleControl.Miles")):vi(e,r,n,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?vi(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?vi(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):vi(e,r,s,t._getUIString("ScaleControl.Meters"))}function vi(t,e,n,r){const i=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n);t.style.width=e*(i/n)+"px",t.innerHTML=`${i}&nbsp;${r}`}const yi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_i=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xi(e){if(e){if("number"==typeof e){const n=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(n,n),"top-right":new t.pointGeometry(-n,n),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(n,-n),"bottom-right":new t.pointGeometry(-n,-n),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const n=t.pointGeometry.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}return xi(new t.pointGeometry(0,0))}const bi={supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Qr{constructor(e){var n;if(t.PerformanceUtils.mark(t.PerformanceMarkers.create),null!=(e=t.extend({},ii,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new rr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._interactive=e.interactive,this._cooperativeGestures=e.cooperativeGestures,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new ni,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},ri,e.locale),this._clickTolerance=e.clickTolerance,this._pixelRatio=null!==(n=e.pixelRatio)&&void 0!==n?n:devicePixelRatio,this._requestManager=new a(e.transformRequest),"string"==typeof e.container){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),"undefined"!=typeof window&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Kr(this,e),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=e.hash&&new ir("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new ti({customAttribution:e.customAttribution})),e.maplibreLogo&&this.addControl(new ei,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.Event(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.Event(`${e.dataType}dataloading`,e))})),this.on("dataabort",(e=>{this.fire(new t.Event("sourcedataabort",e))}))}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,n,r){return null==r&&this.style.terrain&&(r=this.transform.getElevation(n,this.style.terrain)),super.calculateCameraOptionsFromTo(t,e,n,r)}resize(e){const n=this._containerDimensions(),r=n[0],i=n[1];this._resizeCanvas(r,i,this.getPixelRatio()),this.transform.resize(r,i),this.painter.resize(r,i,this.getPixelRatio());const o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){const[e,n]=this._containerDimensions();this._pixelRatio=t,this._resizeCanvas(e,n,t),this.painter.resize(e,n,t)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(e){return this.transform.locationPoint(t.LngLat.convert(e),this.style&&this.style.terrain)}unproject(e){return this.transform.pointLocation(t.pointGeometry.convert(e),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let r=!1;const i=i=>{const o=this.getLayer(e)?this.queryRenderedFeatures(i.point,{layers:[e]}):[];o.length?r||(r=!0,n.call(this,new pr(t,this,i.originalEvent,{features:o}))):r=!1};return{layer:e,listener:n,delegates:{mousemove:i,mouseout:()=>{r=!1}}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const i=i=>{(this.getLayer(e)?this.queryRenderedFeatures(i.point,{layers:[e]}):[]).length?r=!0:r&&(r=!1,n.call(this,new pr(t,this,i.originalEvent)))},o=e=>{r&&(r=!1,n.call(this,new pr(t,this,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:i,mouseout:o}}}{const r=t=>{const r=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(this,t),delete t.features)};return{layer:e,listener:n,delegates:{[t]:r}}}}on(t,e,n){if(void 0===n)return super.on(t,e);const r=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const i in r.delegates)this.on(i,r.delegates[i]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);const r=this._createDelegatedListener(t,e,n);for(const i in r.delegates)this.once(i,r.delegates[i]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(r=>{const i=this._delegatedListeners[t];for(let t=0;t<i.length;t++){const r=i[t];if(r.layer===e&&r.listener===n){for(const t in r.delegates)this.off(t,r.delegates[t]);return i.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,n){if(!this.style)return[];let r;if(void 0!==n||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.pointGeometry||"number"==typeof e[0])r=[t.pointGeometry.convert(e)];else{const n=t.pointGeometry.convert(e[0]),i=t.pointGeometry.convert(e[1]);r=[n,new t.pointGeometry(i.x,n.y),i,new t.pointGeometry(n.x,i.y),n]}return this.style.queryRenderedFeatures(r,n,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new ee(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ee(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const r=this._requestManager.transformRequest(e,t.ResourceType.Style);t.getJSON(r,((e,r)=>{e?this.fire(new t.ErrorEvent(e)):r&&this._updateDiff(r,n)}))}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)))}setTerrain(t){return this.style.setTerrain(t),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n,{pixelRatio:r=1,sdf:i=!1,stretchX:o,stretchY:a,content:s}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||t.isImageBitmap(n)){const{width:l,height:u,data:c}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:i,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:u,data:c}=n,h=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},new Uint8Array(c)),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:i,version:0,userImage:h}),h.onAdd&&h.onAdd(this,e)}}}updateImage(e,n){const r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=n instanceof HTMLImageElement||t.isImageBitmap(n)?t.exported.getImageData(n):n,{width:o,height:a,data:s}=i;if(void 0===o||void 0===a)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==r.data.width||a!==r.data.height)return this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const l=!(n instanceof HTMLImageElement||t.isImageBitmap(n));r.data.replace(s,l),this.style.updateImage(e,r)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,r={}){return this.style.setPaintProperty(t,e,n,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,r={}){return this.style.setLayoutProperty(t,e,n,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map","mapboxgl-map");const e=this._canvasContainer=o.create("div","maplibregl-canvas-container mapboxgl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=o.create("canvas","maplibregl-canvas mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const n=this._containerDimensions();this._resizeCanvas(n[0],n[1],this.getPixelRatio());const r=this._controlContainer=o.create("div","maplibregl-control-container mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{i[t]=o.create("div",`maplibregl-ctrl-${t} mapboxgl-ctrl-${t}`,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const t=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=o.create("div","maplibregl-cooperative-gesture-screen",t);let e="Control",n="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(n="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",e="Meta"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${n}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,document.addEventListener("keydown",(t=>{t.key===e&&(this._metaPress=!0)})),document.addEventListener("keyup",(t=>{t.key===e&&(this._metaPress=!1)})),this._canvasContainer.addEventListener("wheel",(t=>{this._onCooperativeGesture(t,this._metaPress,1)}),!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(t,e,n){this._canvas.width=n*t,this._canvas.height=n*e,this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new Qn(r,this.transform),t.exported$1.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(t,e,n){return!e&&n<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(e){let n,r=0;const i=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,n),r=t.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=t.exported.now();this.style.zoomHistory.update(e,n);const r=new t.EvaluationParameters(e,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=r.crossFadingFactor();1===i&&i===this._crossFadingFactor||(o=!0,this._crossFadingFactor=i),this.style.update(r)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.load),this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-r;i.endQueryEXT(i.TIME_ELAPSED_EXT,n),setTimeout((()=>{const r=i.getQueryObjectEXT(n,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:r}))}),50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))}),50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty;return a||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),o.remove(this._canvasContainer),o.remove(this._controlContainer),this._cooperativeGestures&&o.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),t.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=t.exported.frame((e=>{t.PerformanceUtils.frame(e),this._frame=null,this._render(e)})))}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return"2.4.0"}},NavigationControl:class{constructor(e){this.options=t.extend({},oi,e),this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ai(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=o.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){const n=this._map._getUIString(`NavigationControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},hi,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(t){var e;return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0!==fi?e(fi):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((t=>{fi="denied"!==t.state,e(fi)})):(fi=!!window.navigator.geolocation,e(fi)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,pi=0,di=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),o=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),r=e.distanceTo(n),i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&di)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=o.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new ci(this._dotElement),this._circleElement=o.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ci({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))}))}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":pi--,di=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),pi++,pi>1?(t={maximumAge:6e5,timeout:0},di=!0):(t=this.options.positionOptions,di=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ti,LogoControl:ei,ScaleControl:class{constructor(e){this.options=t.extend({},mi,e),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){gi(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,gi(this._map,this._container,this.options)}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=o.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(e){this.options=e,t.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=o.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),o.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(yi),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),n=document.createElement("body");let r;for(n.innerHTML=t;r=n.firstChild,r;)e.appendChild(r);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_update(t){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=o.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((t=>this._container.classList.add(t))),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let n=this.options.anchor;const r=xi(this.options.offset);if(!n){const t=this._container.offsetWidth,i=this._container.offsetHeight;let o;o=e.y+r.bottom.y<i?["top"]:e.y>this._map.transform.height-i?["bottom"]:[],e.x<t/2?o.push("left"):e.x>this._map.transform.width-t/2&&o.push("right"),n=0===o.length?"bottom":o.join("-")}const i=e.add(r[n]).round();o.setTransform(this._container,`${li[n]} translate(${i.x}px,${i.y}px)`),ui(this._container,n,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(_i);t&&t.focus()}_onClose(){this.remove()}},Marker:ci,Style:ee,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,AJAXError:t.AJAXError,config:t.config,CanvasSource:A,GeoJSONSource:C,ImageSource:T,RasterDEMTileSource:k,RasterTileSource:S,VectorTileSource:w,VideoSource:P,prewarm:function(){G().acquire(U)},clearPrewarmedResources:function(){const t=q;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(U),q=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return V.workerCount},set workerCount(t){V.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",addProtocol(e,n){t.config.REGISTERED_PROTOCOLS[e]=n},removeProtocol(e){delete t.config.REGISTERED_PROTOCOLS[e]}};return Jr.extend(bi,{isSafari:t.isSafari,getPerformanceMetrics:t.PerformanceUtils.getPerformanceMetrics}),bi})),n}()},907:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Z:function(){return r}})},7326:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,{Z:function(){return r}})},5671:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return r}})},3144:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:function(){return i}})},7762:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(181);function i(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,r.Z)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}},9388:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(1120),i=n(8814),o=n(2963);function a(t){var e=(0,i.Z)();return function(){var n,i=(0,r.Z)(t);if(e){var a=(0,r.Z)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}},4942:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return r}})},7462:function(t,e,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}n.d(e,{Z:function(){return r}})},1120:function(t,e,n){"use strict";function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}n.d(e,{Z:function(){return r}})},136:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(9611);function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&(0,r.Z)(t,e)}},8814:function(t,e,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}n.d(e,{Z:function(){return r}})},2963:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(1002),i=n(7326);function o(t,e){if(e&&("object"===(0,r.Z)(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(t)}},4165:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(1002);function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(A){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),s=new I(r||[]);return o(a,"_invoke",{value:S(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=h;var p={};function d(){}function m(){}function g(){}var v={};c(v,s,(function(){return this}));var y=Object.getPrototypeOf,_=y&&y(y(T([])));_&&_!==e&&n.call(_,s)&&(v=_);var x=g.prototype=d.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(o,a,s,l){var u=f(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==(0,r.Z)(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,s,l)}),(function(t){i("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return i("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return a=a?a.then(r,r):r()}})}function S(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=f(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=f(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,p;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=c(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new w(h(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),c(x,u,"Generator"),c(x,s,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}},9611:function(t,e,n){"use strict";function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}n.d(e,{Z:function(){return r}})},885:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(181);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||(0,r.Z)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2982:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(907);var i=n(181);function o(t){return function(t){if(Array.isArray(t))return(0,r.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,i.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1002:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:function(){return r}})},181:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(907);function i(t,e){if(t){if("string"===typeof t)return(0,r.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(t,e):void 0}}},2793:function(t,e,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}n.d(e,{Z:function(){return r}})},1048:function(t,e,n){"use strict";function r(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}n.d(e,{Z:function(){return r}})},4695:function(t,e,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}n.d(e,{Z:function(){return r}})},916:function(t,e,n){"use strict";function r(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}n.d(e,{Z:function(){return r}})},1860:function(t,e,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}n.d(e,{Z:function(){return r}})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&i&&r;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((function(t){a[t]=function(){return r[t]}}));return a.default=function(){return r},n.d(o,a),o}}(),n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,r){return n.f[r](t,e),e}),[]))},n.u=function(t){return"static/js/"+t+"."+{498:"fc3f7d5d",610:"ddc764bc",703:"d79aeea6",787:"0213f48d"}[t]+".chunk.js"},n.miniCssF=function(t){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t={},e="PowerplantsGIS:";n.l=function(r,i,o,a){if(t[r])t[r].push(i);else{var s,l;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==e+o){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+o),s.src=r),t[r]=[i];var f=function(e,n){s.onerror=s.onload=null,clearTimeout(p);var i=t[r];if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(t){return t(n)})),e)return e(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="./",function(){var t={179:0};n.f.j=function(e,r){var i=n.o(t,e)?t[e]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((function(n,r){i=t[e]=[n,r]}));r.push(i[2]=o);var a=n.p+n.u(e),s=new Error;n.l(a,(function(r){if(n.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+e,e)}};var e=function(e,r){var i,o,a=r[0],s=r[1],l=r[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(e&&e(r);u<a.length;u++)o=a[u],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=self.webpackChunkPowerplantsGIS=self.webpackChunkPowerplantsGIS||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}(),function(){"use strict";var t=n(2791),e=n.t(t,2),r=n(4164);function i(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var o,a=n(2982),s=n(4942),l=n(885),u=n(4307),c={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},h=new Uint8Array(16);function f(){if(!o&&!(o="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(h)}for(var p=[],d=0;d<256;++d)p.push((d+256).toString(16).slice(1));function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(p[t[e+0]]+p[t[e+1]]+p[t[e+2]]+p[t[e+3]]+"-"+p[t[e+4]]+p[t[e+5]]+"-"+p[t[e+6]]+p[t[e+7]]+"-"+p[t[e+8]]+p[t[e+9]]+"-"+p[t[e+10]]+p[t[e+11]]+p[t[e+12]]+p[t[e+13]]+p[t[e+14]]+p[t[e+15]]).toLowerCase()}var g=function(t,e,n){if(c.randomUUID&&!e&&!t)return c.randomUUID();var r=(t=t||{}).random||(t.rng||f)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return m(r)},v=n(2007),y=n.n(v),_=n(596),x=n(1002),b=Uint8Array,w=Uint16Array,S=Uint32Array,E=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),k=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),C=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),I=function(t,e){for(var n=new w(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];var i=new S(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},T=I(E,2),P=T[0],A=T[1];P[28]=258,A[258]=28;for(var M=I(k,0),L=M[0],R=M[1],D=new w(32768),N=0;N<32768;++N){var z=(43690&N)>>>1|(21845&N)<<1;z=(61680&(z=(52428&z)>>>2|(13107&z)<<2))>>>4|(3855&z)<<4,D[N]=((65280&z)>>>8|(255&z)<<8)>>>1}var O=function(t,e,n){for(var r=t.length,i=0,o=new w(e);i<r;++i)++o[t[i]-1];var a,s=new w(e);for(i=0;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;if(n){a=new w(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],c=e-t[i],h=s[t[i]-1]++<<c,f=h|(1<<c)-1;h<=f;++h)a[D[h]>>>l]=u}else for(a=new w(r),i=0;i<r;++i)a[i]=D[s[t[i]-1]++]>>>15-t[i];return a},F=new b(288);for(N=0;N<144;++N)F[N]=8;for(N=144;N<256;++N)F[N]=9;for(N=256;N<280;++N)F[N]=7;for(N=280;N<288;++N)F[N]=8;var B=new b(32);for(N=0;N<32;++N)B[N]=5;var j=O(F,9,0),U=O(F,9,1),V=O(B,5,0),Z=O(B,5,1),q=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},G=function(t,e,n){var r=e/8>>0;return(t[r]|t[r+1]<<8)>>>(7&e)&n},W=function(t,e){var n=e/8>>0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>>(7&e)},X=function(t){return(t/8>>0)+(7&t&&1)},H=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var r=new(t instanceof w?w:t instanceof S?S:b)(n-e);return r.set(t.subarray(e,n)),r},Y=function(t,e,n){var r=t.length,i=!e||n,o=!n||n.i;n||(n={}),e||(e=new b(3*r));var a=function(t){var n=e.length;if(t>n){var r=new b(Math.max(2*n,t));r.set(e),e=r}},s=n.f||0,l=n.p||0,u=n.b||0,c=n.l,h=n.d,f=n.m,p=n.n,d=8*r;do{if(!c){n.f=s=G(t,l,1);var m=G(t,l+1,3);if(l+=3,!m){var g=t[(R=X(l)+4)-4]|t[R-3]<<8,v=R+g;if(v>r){if(o)throw"unexpected EOF";break}i&&a(u+g),e.set(t.subarray(R,v),u),n.b=u+=g,n.p=l=8*v;continue}if(1==m)c=U,h=Z,f=9,p=5;else{if(2!=m)throw"invalid block type";var y=G(t,l,31)+257,_=G(t,l+10,15)+4,x=y+G(t,l+5,31)+1;l+=14;for(var w=new b(x),S=new b(19),I=0;I<_;++I)S[C[I]]=G(t,l+3*I,7);l+=3*_;var T=q(S),A=(1<<T)-1;if(!o&&l+x*(T+7)>d)break;var M=O(S,T,1);for(I=0;I<x;){var R,D=M[G(t,l,A)];if(l+=15&D,(R=D>>>4)<16)w[I++]=R;else{var N=0,z=0;for(16==R?(z=3+G(t,l,3),l+=2,N=w[I-1]):17==R?(z=3+G(t,l,7),l+=3):18==R&&(z=11+G(t,l,127),l+=7);z--;)w[I++]=N}}var F=w.subarray(0,y),B=w.subarray(y);f=q(F),p=q(B),c=O(F,f,1),h=O(B,p,1)}if(l>d)throw"unexpected EOF"}i&&a(u+131072);for(var j=(1<<f)-1,V=(1<<p)-1,Y=f+p+18;o||l+Y<d;){var $=(N=c[W(t,l)&j])>>>4;if((l+=15&N)>d)throw"unexpected EOF";if(!N)throw"invalid length/literal";if($<256)e[u++]=$;else{if(256==$){c=null;break}var K=$-254;if($>264){var J=E[I=$-257];K=G(t,l,(1<<J)-1)+P[I],l+=J}var Q=h[W(t,l)&V],tt=Q>>>4;if(!Q)throw"invalid distance";l+=15&Q;B=L[tt];if(tt>3){J=k[tt];B+=W(t,l)&(1<<J)-1,l+=J}if(l>d)throw"unexpected EOF";i&&a(u+131072);for(var et=u+K;u<et;u+=4)e[u]=e[u-B],e[u+1]=e[u+1-B],e[u+2]=e[u+2-B],e[u+3]=e[u+3-B];u=et}}n.l=c,n.p=l,n.b=u,c&&(s=1,n.m=f,n.d=h,n.n=p)}while(!s);return u==e.length?e:H(e,0,u)},$=function(t,e,n){n<<=7&e;var r=e/8>>0;t[r]|=n,t[r+1]|=n>>>8},K=function(t,e,n){n<<=7&e;var r=e/8>>0;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16},J=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,o=n.slice();if(!i)return[new b(0),0];if(1==i){var a=new b(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(t,e){return t.f-e.f})),n.push({s:-1,f:25001});var s=n[0],l=n[1],u=0,c=1,h=2;for(n[0]={s:-1,f:s.f+l.f,l:s,r:l};c!=i-1;)s=n[n[u].f<n[h].f?u++:h++],l=n[u!=c&&n[u].f<n[h].f?u++:h++],n[c++]={s:-1,f:s.f+l.f,l:s,r:l};var f=o[0].s;for(r=1;r<i;++r)o[r].s>f&&(f=o[r].s);var p=new w(f+1),d=Q(n[c-1],p,0);if(d>e){r=0;var m=0,g=d-e,v=1<<g;for(o.sort((function(t,e){return p[e.s]-p[t.s]||t.f-e.f}));r<i;++r){var y=o[r].s;if(!(p[y]>e))break;m+=v-(1<<d-p[y]),p[y]=e}for(m>>>=g;m>0;){var _=o[r].s;p[_]<e?m-=1<<e-p[_]++-1:++r}for(;r>=0&&m;--r){var x=o[r].s;p[x]==e&&(--p[x],++m)}d=e}return[new b(p),d]},Q=function t(e,n,r){return-1==e.s?Math.max(t(e.l,n,r+1),t(e.r,n,r+1)):n[e.s]=r},tt=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new w(++e),r=0,i=t[0],o=1,a=function(t){n[r++]=t},s=1;s<=e;++s)if(t[s]==i&&s!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=t[s]}return[n.subarray(0,r),e]},et=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},nt=function(t,e,n){var r=n.length,i=X(e+2);t[i]=255&r,t[i+1]=r>>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var o=0;o<r;++o)t[i+o+4]=n[o];return 8*(i+4+r)},rt=function(t,e,n,r,i,o,a,s,l,u,c){$(e,c++,n),++i[256];for(var h=J(i,15),f=h[0],p=h[1],d=J(o,15),m=d[0],g=d[1],v=tt(f),y=v[0],_=v[1],x=tt(m),b=x[0],S=x[1],I=new w(19),T=0;T<y.length;++T)I[31&y[T]]++;for(T=0;T<b.length;++T)I[31&b[T]]++;for(var P=J(I,7),A=P[0],M=P[1],L=19;L>4&&!A[C[L-1]];--L);var R,D,N,z,U=u+5<<3,Z=et(i,F)+et(o,B)+a,q=et(i,f)+et(o,m)+a+14+3*L+et(I,A)+(2*I[16]+3*I[17]+7*I[18]);if(U<=Z&&U<=q)return nt(e,c,t.subarray(l,l+u));if($(e,c,1+(q<Z)),c+=2,q<Z){R=O(f,p,0),D=f,N=O(m,g,0),z=m;var G=O(A,M,0);$(e,c,_-257),$(e,c+5,S-1),$(e,c+10,L-4),c+=14;for(T=0;T<L;++T)$(e,c+3*T,A[C[T]]);c+=3*L;for(var W=[y,b],X=0;X<2;++X){var H=W[X];for(T=0;T<H.length;++T){var Y=31&H[T];$(e,c,G[Y]),c+=A[Y],Y>15&&($(e,c,H[T]>>>5&127),c+=H[T]>>>12)}}}else R=j,D=F,N=V,z=B;for(T=0;T<s;++T)if(r[T]>255){Y=r[T]>>>18&31;K(e,c,R[Y+257]),c+=D[Y+257],Y>7&&($(e,c,r[T]>>>23&31),c+=E[Y]);var Q=31&r[T];K(e,c,N[Q]),c+=z[Q],Q>3&&(K(e,c,r[T]>>>5&8191),c+=k[Q])}else K(e,c,R[r[T]]),c+=D[r[T]];return K(e,c,R[256]),c+D[256]},it=new S([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ot=new b(0),at=function(t,e,n,r,i,o){var a=t.length,s=new b(r+a+5*(1+Math.floor(a/7e3))+i),l=s.subarray(r,s.length-i),u=0;if(!e||a<8)for(var c=0;c<=a;c+=65535){var h=c+65535;h<a?u=nt(l,u,t.subarray(c,h)):(l[c]=o,u=nt(l,u,t.subarray(c,a)))}else{for(var f=it[e-1],p=f>>>13,d=8191&f,m=(1<<n)-1,g=new w(32768),v=new w(m+1),y=Math.ceil(n/3),_=2*y,x=function(e){return(t[e]^t[e+1]<<y^t[e+2]<<_)&m},C=new S(25e3),I=new w(288),T=new w(32),P=0,M=0,L=(c=0,0),D=0,N=0;c<a;++c){var z=x(c),O=32767&c,F=v[z];if(g[O]=F,v[z]=O,D<=c){var B=a-c;if((P>7e3||L>24576)&&B>423){u=rt(t,l,0,C,I,T,M,L,N,c-N,u),L=P=M=0,N=c;for(var j=0;j<286;++j)I[j]=0;for(j=0;j<30;++j)T[j]=0}var U=2,V=0,Z=d,q=O-F&32767;if(B>2&&z==x(c-q))for(var G=Math.min(p,B)-1,W=Math.min(32767,c),Y=Math.min(258,B);q<=W&&--Z&&O!=F;){if(t[c+U]==t[c+U-q]){for(var $=0;$<Y&&t[c+$]==t[c+$-q];++$);if($>U){if(U=$,V=q,$>G)break;var K=Math.min(q,$-2),J=0;for(j=0;j<K;++j){var Q=c-q+j+32768&32767,tt=Q-g[Q]+32768&32767;tt>J&&(J=tt,F=Q)}}}q+=(O=F)-(F=g[O])+32768&32767}if(V){C[L++]=268435456|A[U]<<18|R[V];var et=31&A[U],at=31&R[V];M+=E[et]+k[at],++I[257+et],++T[at],D=c+U,++P}else C[L++]=t[c],++I[t[c]]}}u=rt(t,l,o,C,I,T,M,L,N,c-N,u),o||(u=nt(l,u,ot))}return H(s,0,r+X(u)+i)},st=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,o=n.length,a=0;a!=o;){for(var s=Math.min(a+5552,o);a<s;++a)i+=r+=n[a];r%=65521,i%=65521}t=r,e=i},d:function(){return(t>>>8<<16|(255&e)<<8|e>>>8)+2*((255&t)<<23)}}},lt=function(t,e,n,r,i){return at(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,r,!i)},ut=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},ct=function(t,e){var n=e.level,r=0==n?0:n<6?1:9==n?3:2;t[0]=120,t[1]=r<<6|(r?32-2*r:1)},ht=function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"};function ft(t,e){void 0===e&&(e={});var n=st();n.p(t);var r=lt(t,e,2,4);return ct(r,e),ut(r,r.length-4,n.d()),r}function pt(t,e){return Y((ht(t),t.subarray(2,-4)),e)}var dt=function(){return"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:this}();function mt(){dt.console&&"function"==typeof dt.console.log&&dt.console.log.apply(dt.console,arguments)}var gt={log:mt,warn:function(t){dt.console&&("function"==typeof dt.console.warn?dt.console.warn.apply(dt.console,arguments):mt.call(null,arguments))},error:function(t){dt.console&&("function"==typeof dt.console.error?dt.console.error.apply(dt.console,arguments):mt(t))}};function vt(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){wt(r.response,e,n)},r.onerror=function(){gt.error("could not download file")},r.send()}function yt(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return e.status>=200&&e.status<=299}function _t(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(Tk){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var xt,bt,wt=dt.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,x.Z)(window))||window!==dt?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=dt.URL||dt.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener","string"==typeof t?(i.href=t,i.origin!==location.origin?yt(i.href)?vt(t,e,n):_t(i,i.target="_blank"):_t(i)):(i.href=r.createObjectURL(t),setTimeout((function(){r.revokeObjectURL(i.href)}),4e4),setTimeout((function(){_t(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download","string"==typeof t)if(yt(t))vt(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout((function(){_t(r)}))}else navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!==(0,x.Z)(e)&&(gt.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return vt(t,e,n);var i="application/octet-stream"===t.type,o=/constructor/i.test(dt.HTMLElement)||dt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&o)&&"object"===("undefined"==typeof FileReader?"undefined":(0,x.Z)(FileReader))){var s=new FileReader;s.onloadend=function(){var t=s.result;t=a?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},s.readAsDataURL(t)}else{var l=dt.URL||dt.webkitURL,u=l.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout((function(){l.revokeObjectURL(u)}),4e4)}});function St(t){var e;t=t||"",this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,o=n[r].process,a=i.exec(t);a&&(e=o(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n}}function Et(t,e){var n=t[0],r=t[1],i=t[2],o=t[3];n=Ct(n,r,i,o,e[0],7,-680876936),o=Ct(o,n,r,i,e[1],12,-389564586),i=Ct(i,o,n,r,e[2],17,606105819),r=Ct(r,i,o,n,e[3],22,-1044525330),n=Ct(n,r,i,o,e[4],7,-176418897),o=Ct(o,n,r,i,e[5],12,1200080426),i=Ct(i,o,n,r,e[6],17,-1473231341),r=Ct(r,i,o,n,e[7],22,-45705983),n=Ct(n,r,i,o,e[8],7,1770035416),o=Ct(o,n,r,i,e[9],12,-1958414417),i=Ct(i,o,n,r,e[10],17,-42063),r=Ct(r,i,o,n,e[11],22,-1990404162),n=Ct(n,r,i,o,e[12],7,1804603682),o=Ct(o,n,r,i,e[13],12,-40341101),i=Ct(i,o,n,r,e[14],17,-1502002290),n=It(n,r=Ct(r,i,o,n,e[15],22,1236535329),i,o,e[1],5,-165796510),o=It(o,n,r,i,e[6],9,-1069501632),i=It(i,o,n,r,e[11],14,643717713),r=It(r,i,o,n,e[0],20,-373897302),n=It(n,r,i,o,e[5],5,-701558691),o=It(o,n,r,i,e[10],9,38016083),i=It(i,o,n,r,e[15],14,-660478335),r=It(r,i,o,n,e[4],20,-405537848),n=It(n,r,i,o,e[9],5,568446438),o=It(o,n,r,i,e[14],9,-1019803690),i=It(i,o,n,r,e[3],14,-187363961),r=It(r,i,o,n,e[8],20,1163531501),n=It(n,r,i,o,e[13],5,-1444681467),o=It(o,n,r,i,e[2],9,-51403784),i=It(i,o,n,r,e[7],14,1735328473),n=Tt(n,r=It(r,i,o,n,e[12],20,-1926607734),i,o,e[5],4,-378558),o=Tt(o,n,r,i,e[8],11,-2022574463),i=Tt(i,o,n,r,e[11],16,1839030562),r=Tt(r,i,o,n,e[14],23,-35309556),n=Tt(n,r,i,o,e[1],4,-1530992060),o=Tt(o,n,r,i,e[4],11,1272893353),i=Tt(i,o,n,r,e[7],16,-155497632),r=Tt(r,i,o,n,e[10],23,-1094730640),n=Tt(n,r,i,o,e[13],4,681279174),o=Tt(o,n,r,i,e[0],11,-358537222),i=Tt(i,o,n,r,e[3],16,-722521979),r=Tt(r,i,o,n,e[6],23,76029189),n=Tt(n,r,i,o,e[9],4,-640364487),o=Tt(o,n,r,i,e[12],11,-421815835),i=Tt(i,o,n,r,e[15],16,530742520),n=Pt(n,r=Tt(r,i,o,n,e[2],23,-995338651),i,o,e[0],6,-198630844),o=Pt(o,n,r,i,e[7],10,1126891415),i=Pt(i,o,n,r,e[14],15,-1416354905),r=Pt(r,i,o,n,e[5],21,-57434055),n=Pt(n,r,i,o,e[12],6,1700485571),o=Pt(o,n,r,i,e[3],10,-1894986606),i=Pt(i,o,n,r,e[10],15,-1051523),r=Pt(r,i,o,n,e[1],21,-2054922799),n=Pt(n,r,i,o,e[8],6,1873313359),o=Pt(o,n,r,i,e[15],10,-30611744),i=Pt(i,o,n,r,e[6],15,-1560198380),r=Pt(r,i,o,n,e[13],21,1309151649),n=Pt(n,r,i,o,e[4],6,-145523070),o=Pt(o,n,r,i,e[11],10,-1120210379),i=Pt(i,o,n,r,e[2],15,718787259),r=Pt(r,i,o,n,e[9],21,-343485551),t[0]=Ot(n,t[0]),t[1]=Ot(r,t[1]),t[2]=Ot(i,t[2]),t[3]=Ot(o,t[3])}function kt(t,e,n,r,i,o){return e=Ot(Ot(e,t),Ot(r,o)),Ot(e<<i|e>>>32-i,n)}function Ct(t,e,n,r,i,o,a){return kt(e&n|~e&r,t,e,i,o,a)}function It(t,e,n,r,i,o,a){return kt(e&r|n&~r,t,e,i,o,a)}function Tt(t,e,n,r,i,o,a){return kt(e^n^r,t,e,i,o,a)}function Pt(t,e,n,r,i,o,a){return kt(n^(e|~r),t,e,i,o,a)}function At(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Et(r,Mt(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(Et(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,Et(r,i),r}function Mt(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}xt=dt.atob.bind(dt),bt=dt.btoa.bind(dt);var Lt="0123456789abcdef".split("");function Rt(t){for(var e="",n=0;n<4;n++)e+=Lt[t>>8*n+4&15]+Lt[t>>8*n&15];return e}function Dt(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Nt(t){return At(t).map(Dt).join("")}var zt="5d41402abc4b2a76b9719d911017c592"!=function(t){for(var e=0;e<t.length;e++)t[e]=Rt(t[e]);return t.join("")}(At("hello"));function Ot(t,e){if(zt){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}function Ft(t,e){var n,r,i,o;if(t!==n){for(var a=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),s=[],l=0;l<256;l++)s[l]=l;var u=0;for(l=0;l<256;l++){var c=s[l];u=(u+c+a.charCodeAt(l))%256,s[l]=s[u],s[u]=c}n=t,r=s}else s=r;var h=e.length,f=0,p=0,d="";for(l=0;l<h;l++)p=(p+(c=s[f=(f+1)%256]))%256,s[f]=s[p],s[p]=c,a=s[(s[f]+s[p])%256],d+=String.fromCharCode(e.charCodeAt(l)^a);return d}var Bt={print:4,modify:8,copy:16,"annot-forms":32};function jt(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach((function(t){if(void 0!==Bt.perm)throw new Error("Invalid permission: "+t);i+=Bt[t]})),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var o=(e+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,a),this.P=-(1+(255^i)),this.encryptionKey=Nt(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Ft(this.encryptionKey,this.padding)}function Ut(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||35===i||37===i||40===i||41===i||47===i||60===i||62===i||91===i||93===i||123===i||125===i||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function Vt(t){if("object"!==(0,x.Z)(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,r){if(r=r||!1,"string"!=typeof t||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[n,!!r],i},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],0===Object.keys(e[n]).length&&delete e[n],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[n]){var a=e[n][o];try{a[0].apply(t,r)}catch(n){dt.console&&gt.error("jsPDF PubSub Error",n.message,n)}a[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zt(t){if(!(this instanceof Zt))return new Zt(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function qt(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Gt(t,e,n,r,i){if(!(this instanceof Gt))return new Gt(t,e,n,r,i);this.type="axial"===t?2:3,this.coords=e,this.colors=n,qt.call(this,r,i)}function Wt(t,e,n,r,i){if(!(this instanceof Wt))return new Wt(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,qt.call(this,r,i)}function Xt(t){var e,n="string"==typeof arguments[0]?arguments[0]:"p",r=arguments[1],i=arguments[2],o=arguments[3],a=[],s=1,l=16,u="S",c=null;"object"===(0,x.Z)(t=t||{})&&(n=t.orientation,r=t.unit||r,i=t.format||i,o=t.compress||t.compressPdf||o,null!==(c=t.encryption||null)&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),s="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(e=t.precision),void 0!==t.floatPrecision&&(l=t.floatPrecision),u=t.defaultPathOperation||"S"),a=t.filters||(!0===o?["FlateEncode"]:a),r=r||"mm",n=(""+(n||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,f={},p={internal:{},__private__:{}};p.__private__.PubSub=Vt;var d="1.3",m=p.__private__.getPdfVersion=function(){return d};p.__private__.setPdfVersion=function(t){d=t};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return g};var v=p.__private__.getPageFormat=function(t){return g[t]};i=i||"a4";var y={COMPAT:"compat",ADVANCED:"advanced"},_=y.COMPAT;function b(){this.saveGraphicsState(),Q(new Ft(mt,0,0,-mt,0,jn()*mt).toString()+" cm"),this.setFontSize(this.getFontSize()/mt),u="n",_=y.ADVANCED}function w(){this.restoreGraphicsState(),u="S",_=y.COMPAT}var S=p.__private__.combineFontStyleAndFontWeight=function(t,e){if("bold"==t&&"normal"==e||"bold"==t&&400==e||"normal"==t&&"italic"==e||"bold"==t&&"italic"==e)throw new Error("Invalid Combination of fontweight and fontstyle");return e&&(t=400==e||"normal"===e?"italic"===t?"italic":"normal":700!=e&&"bold"!==e||"normal"!==t?(700==e?"bold":e)+""+t:"bold"),t};p.advancedAPI=function(t){var e=_===y.COMPAT;return e&&b.call(this),"function"!=typeof t||(t(this),e&&w.call(this)),this},p.compatAPI=function(t){var e=_===y.ADVANCED;return e&&w.call(this),"function"!=typeof t||(t(this),e&&b.call(this)),this},p.isAdvancedAPI=function(){return _===y.ADVANCED};var E,k=function(t){if(_!==y.ADVANCED)throw new Error(t+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=p.roundToPrecision=p.__private__.roundToPrecision=function(t,n){var r=e||n;if(isNaN(t)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return t.toFixed(r).replace(/0+$/,"")};E=p.hpf=p.__private__.hpf="number"==typeof l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return C(t,l)}:"smart"===l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return C(t,t>-1&&t<1?16:5)}:function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return C(t,16)};var I=p.f2=p.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return C(t,2)},T=p.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return C(t,3)},P=p.scale=p.__private__.scale=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.scale");return _===y.COMPAT?t*mt:_===y.ADVANCED?t:void 0},A=function(t){return _===y.COMPAT?jn()-t:_===y.ADVANCED?t:void 0},M=function(t){return P(A(t))};p.__private__.setPrecision=p.setPrecision=function(t){"number"==typeof parseInt(t,10)&&(e=parseInt(t,10))};var L,R="00000000000000000000000000000000",D=p.__private__.getFileId=function(){return R},N=p.__private__.setFileId=function(t){return R=void 0!==t&&/^[a-fA-F0-9]{32}$/.test(t)?t.toUpperCase():R.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==c&&(Xe=new jt(c.userPermissions,c.userPassword,c.ownerPassword,R)),R};p.setFileId=function(t){return N(t),this},p.getFileId=function(){return D()};var z=p.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),n=e<0?"+":"-",r=Math.floor(Math.abs(e/60)),i=Math.abs(e%60),o=[n,U(r),"'",U(i),"'"].join("");return["D:",t.getFullYear(),U(t.getMonth()+1),U(t.getDate()),U(t.getHours()),U(t.getMinutes()),U(t.getSeconds()),o].join("")},O=p.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),n=parseInt(t.substr(6,2),10)-1,r=parseInt(t.substr(8,2),10),i=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),a=parseInt(t.substr(14,2),10);return new Date(e,n,r,i,o,a,0)},F=p.__private__.setCreationDate=function(t){var e;if(void 0===t&&(t=new Date),t instanceof Date)e=z(t);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return L=e},B=p.__private__.getCreationDate=function(t){var e=L;return"jsDate"===t&&(e=O(L)),e};p.setCreationDate=function(t){return F(t),this},p.getCreationDate=function(t){return B(t)};var j,U=p.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},V=p.__private__.padd2Hex=function(t){return("00"+(t=t.toString())).substr(t.length)},Z=0,q=[],G=[],W=0,X=[],H=[],Y=!1,$=G,K=function(){Z=0,W=0,G=[],q=[],X=[],Qt=$t(),te=$t()};p.__private__.setCustomOutputDestination=function(t){Y=!0,$=t};var J=function(t){Y||($=t)};p.__private__.resetCustomOutputDestination=function(){Y=!1,$=G};var Q=p.__private__.out=function(t){return t=t.toString(),W+=t.length+1,$.push(t),$},tt=p.__private__.write=function(t){return Q(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},et=p.__private__.getArrayBuffer=function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n);e--;)r[e]=t.charCodeAt(e);return n},nt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return nt};var rt=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(t){return rt=_===y.ADVANCED?t/mt:t,this};var it,ot=p.__private__.getFontSize=p.getFontSize=function(){return _===y.COMPAT?rt:rt*mt},at=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(t){return at=t,this},p.__private__.getR2L=p.getR2L=function(){return at};var st,lt=p.__private__.setZoomMode=function(t){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(t))it=t;else if(isNaN(t)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');it=t}else it=parseInt(t,10)};p.__private__.getZoomMode=function(){return it};var ut,ct=p.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');st=t};p.__private__.getPageMode=function(){return st};var ht=p.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');ut=t};p.__private__.getLayoutMode=function(){return ut},p.__private__.setDisplayMode=p.setDisplayMode=function(t,e,n){return lt(t),ht(e),ct(n),this};var ft={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(t){if(-1===Object.keys(ft).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ft[t]},p.__private__.getDocumentProperties=function(){return ft},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(t){for(var e in ft)ft.hasOwnProperty(e)&&t[e]&&(ft[e]=t[e]);return this},p.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(ft).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ft[t]=e};var pt,mt,vt,yt,_t,xt={},Et={},kt=[],Ct={},It={},Tt={},Pt={},At=null,Mt=0,Lt=[],Rt=new Vt(p),Dt=t.hotfixes||[],Nt={},zt={},Ot=[],Ft=function t(e,n,r,i,o,a){if(!(this instanceof t))return new t(e,n,r,i,o,a);isNaN(e)&&(e=1),isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(i)&&(i=1),isNaN(o)&&(o=0),isNaN(a)&&(a=0),this._matrix=[e,n,r,i,o,a]};Object.defineProperty(Ft.prototype,"sx",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(Ft.prototype,"shy",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(Ft.prototype,"shx",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(Ft.prototype,"sy",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(Ft.prototype,"tx",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(Ft.prototype,"ty",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(Ft.prototype,"a",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(Ft.prototype,"b",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(Ft.prototype,"c",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(Ft.prototype,"d",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(Ft.prototype,"e",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(Ft.prototype,"f",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(Ft.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ft.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ft.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ft.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Ft.prototype.join=function(t){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(t)},Ft.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,n=t.sx*this.shy+t.shy*this.sy,r=t.shx*this.sx+t.sy*this.shx,i=t.shx*this.shy+t.sy*this.sy,o=t.tx*this.sx+t.ty*this.shx+this.tx,a=t.tx*this.shy+t.ty*this.sy+this.ty;return new Ft(e,n,r,i,o,a)},Ft.prototype.decompose=function(){var t=this.sx,e=this.shy,n=this.shx,r=this.sy,i=this.tx,o=this.ty,a=Math.sqrt(t*t+e*e),s=(t/=a)*n+(e/=a)*r;n-=t*s,r-=e*s;var l=Math.sqrt(n*n+r*r);return s/=l,t*(r/=l)<e*(n/=l)&&(t=-t,e=-e,s=-s,a=-a),{scale:new Ft(a,0,0,l,0,0),translate:new Ft(1,0,0,1,i,o),rotate:new Ft(t,e,-e,t,0,0),skew:new Ft(1,0,s,1,0,0)}},Ft.prototype.toString=function(t){return this.join(" ")},Ft.prototype.inversed=function(){var t=this.sx,e=this.shy,n=this.shx,r=this.sy,i=this.tx,o=this.ty,a=1/(t*r-e*n),s=r*a,l=-e*a,u=-n*a,c=t*a;return new Ft(s,l,u,c,-s*i-u*o,-l*i-c*o)},Ft.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,n=t.x*this.shy+t.y*this.sy+this.ty;return new Ln(e,n)},Ft.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),n=this.applyToPoint(new Ln(t.x+t.w,t.y+t.h));return new Rn(e.x,e.y,n.x-e.x,n.y-e.y)},Ft.prototype.clone=function(){var t=this.sx,e=this.shy,n=this.shx,r=this.sy,i=this.tx,o=this.ty;return new Ft(t,e,n,r,i,o)},p.Matrix=Ft;var Bt=p.matrixMult=function(t,e){return e.multiply(t)},qt=new Ft(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=qt;var Ht=function(t,e){if(!It[t]){var n=(e instanceof Gt?"Sh":"P")+(Object.keys(Ct).length+1).toString(10);e.id=n,It[t]=n,Ct[n]=e,Rt.publish("addPattern",e)}};p.ShadingPattern=Gt,p.TilingPattern=Wt,p.addShadingPattern=function(t,e){return k("addShadingPattern()"),Ht(t,e),this},p.beginTilingPattern=function(t){k("beginTilingPattern()"),Nn(t.boundingBox[0],t.boundingBox[1],t.boundingBox[2]-t.boundingBox[0],t.boundingBox[3]-t.boundingBox[1],t.matrix)},p.endTilingPattern=function(t,e){k("endTilingPattern()"),e.stream=H[j].join("\n"),Ht(t,e),Rt.publish("endTilingPattern",e),Ot.pop().restore()};var Yt=p.__private__.newObject=function(){var t=$t();return Kt(t,!0),t},$t=p.__private__.newObjectDeferred=function(){return Z++,q[Z]=function(){return W},Z},Kt=function(t,e){return e="boolean"==typeof e&&e,q[t]=W,e&&Q(t+" 0 obj"),t},Jt=p.__private__.newAdditionalObject=function(){var t={objId:$t(),content:""};return X.push(t),t},Qt=$t(),te=$t(),ee=p.__private__.decodeColorString=function(t){var e=t.split(" ");if(2!==e.length||"g"!==e[1]&&"G"!==e[1])5!==e.length||"k"!==e[4]&&"K"!==e[4]||(e=[(1-e[0])*(1-e[3]),(1-e[1])*(1-e[3]),(1-e[2])*(1-e[3]),"r"]);else{var n=parseFloat(e[0]);e=[n,n,n,"r"]}for(var r="#",i=0;i<3;i++)r+=("0"+Math.floor(255*parseFloat(e[i])).toString(16)).slice(-2);return r},ne=p.__private__.encodeColorString=function(t){var e;"string"==typeof t&&(t={ch1:t});var n=t.ch1,r=t.ch2,i=t.ch3,o=t.ch4,a="draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var s=new St(n);if(s.ok)n=s.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var l=parseInt(n.substr(1),16);n=l>>16&255,r=l>>8&255,i=255&l}if(void 0===r||void 0===o&&n===r&&r===i)if("string"==typeof n)e=n+" "+a[0];else if(2===t.precision)e=I(n/255)+" "+a[0];else e=T(n/255)+" "+a[0];else if(void 0===o||"object"===(0,x.Z)(o)){if(o&&!isNaN(o.a)&&0===o.a)return["1.","1.","1.",a[1]].join(" ");if("string"==typeof n)e=[n,r,i,a[1]].join(" ");else if(2===t.precision)e=[I(n/255),I(r/255),I(i/255),a[1]].join(" ");else e=[T(n/255),T(r/255),T(i/255),a[1]].join(" ")}else if("string"==typeof n)e=[n,r,i,o,a[2]].join(" ");else if(2===t.precision)e=[I(n),I(r),I(i),I(o),a[2]].join(" ");else e=[T(n),T(r),T(i),T(o),a[2]].join(" ");return e},re=p.__private__.getFilters=function(){return a},ie=p.__private__.putStream=function(t){var e=(t=t||{}).data||"",n=t.filters||re(),r=t.alreadyAppliedFilters||[],i=t.addLength1||!1,o=e.length,a=t.objectId,s=function(t){return t};if(null!==c&&void 0===a)throw new Error("ObjectId must be passed to putStream for file encryption");null!==c&&(s=Xe.encryptor(a,0));var l={};!0===n&&(n=["FlateEncode"]);var u=t.additionalKeyValues||[],h=(l=void 0!==Xt.API.processDataByFilters?Xt.API.processDataByFilters(e,n):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==l.data.length&&(u.push({key:"Length",value:l.data.length}),!0===i&&u.push({key:"Length1",value:o})),0!=h.length)if(h.split("/").length-1==1)u.push({key:"Filter",value:h});else{u.push({key:"Filter",value:"["+h+"]"});for(var f=0;f<u.length;f+=1)if("DecodeParms"===u[f].key){for(var p=[],d=0;d<l.reverseChain.split("/").length-1;d+=1)p.push("null");p.push(u[f].value),u[f].value="["+p.join(" ")+"]"}}Q("<<");for(var m=0;m<u.length;m++)Q("/"+u[m].key+" "+u[m].value);Q(">>"),0!==l.data.length&&(Q("stream"),Q(s(l.data)),Q("endstream"))},oe=p.__private__.putPage=function(t){var e=t.number,n=t.data,r=t.objId,i=t.contentsObjId;Kt(r,!0),Q("<</Type /Page"),Q("/Parent "+t.rootDictionaryObjId+" 0 R"),Q("/Resources "+t.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(E(t.mediaBox.bottomLeftX))+" "+parseFloat(E(t.mediaBox.bottomLeftY))+" "+E(t.mediaBox.topRightX)+" "+E(t.mediaBox.topRightY)+"]"),null!==t.cropBox&&Q("/CropBox ["+E(t.cropBox.bottomLeftX)+" "+E(t.cropBox.bottomLeftY)+" "+E(t.cropBox.topRightX)+" "+E(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&Q("/BleedBox ["+E(t.bleedBox.bottomLeftX)+" "+E(t.bleedBox.bottomLeftY)+" "+E(t.bleedBox.topRightX)+" "+E(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&Q("/TrimBox ["+E(t.trimBox.bottomLeftX)+" "+E(t.trimBox.bottomLeftY)+" "+E(t.trimBox.topRightX)+" "+E(t.trimBox.topRightY)+"]"),null!==t.artBox&&Q("/ArtBox ["+E(t.artBox.bottomLeftX)+" "+E(t.artBox.bottomLeftY)+" "+E(t.artBox.topRightX)+" "+E(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&Q("/UserUnit "+t.userUnit),Rt.publish("putPage",{objId:r,pageContext:Lt[e],pageNumber:e,page:n}),Q("/Contents "+i+" 0 R"),Q(">>"),Q("endobj");var o=n.join("\n");return _===y.ADVANCED&&(o+="\nQ"),Kt(i,!0),ie({data:o,filters:re(),objectId:i}),Q("endobj"),r},ae=p.__private__.putPages=function(){var t,e,n=[];for(t=1;t<=Mt;t++)Lt[t].objId=$t(),Lt[t].contentsObjId=$t();for(t=1;t<=Mt;t++)n.push(oe({number:t,data:H[t],objId:Lt[t].objId,contentsObjId:Lt[t].contentsObjId,mediaBox:Lt[t].mediaBox,cropBox:Lt[t].cropBox,bleedBox:Lt[t].bleedBox,trimBox:Lt[t].trimBox,artBox:Lt[t].artBox,userUnit:Lt[t].userUnit,rootDictionaryObjId:Qt,resourceDictionaryObjId:te}));Kt(Qt,!0),Q("<</Type /Pages");var r="/Kids [";for(e=0;e<Mt;e++)r+=n[e]+" 0 R ";Q(r+"]"),Q("/Count "+Mt),Q(">>"),Q("endobj"),Rt.publish("postPutPages")},se=function(t){Rt.publish("putFont",{font:t,out:Q,newObject:Yt,putStream:ie}),!0!==t.isAlreadyPutted&&(t.objectNumber=Yt(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+Ut(t.postScriptName)),Q("/Subtype /Type1"),"string"==typeof t.encoding&&Q("/Encoding /"+t.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},le=function(){for(var t in xt)xt.hasOwnProperty(t)&&(!1===h||!0===h&&f.hasOwnProperty(t))&&se(xt[t])},ue=function(t){t.objectNumber=Yt();var e=[];e.push({key:"Type",value:"/XObject"}),e.push({key:"Subtype",value:"/Form"}),e.push({key:"BBox",value:"["+[E(t.x),E(t.y),E(t.x+t.width),E(t.y+t.height)].join(" ")+"]"}),e.push({key:"Matrix",value:"["+t.matrix.toString()+"]"});var n=t.pages[1].join("\n");ie({data:n,additionalKeyValues:e,objectId:t.objectNumber}),Q("endobj")},ce=function(){for(var t in Nt)Nt.hasOwnProperty(t)&&ue(Nt[t])},he=function(t,e){var n,r=[],i=1/(e-1);for(n=0;n<1;n+=i)r.push(n);if(r.push(1),0!=t[0].offset){var o={offset:0,color:t[0].color};t.unshift(o)}if(1!=t[t.length-1].offset){var a={offset:1,color:t[t.length-1].color};t.push(a)}for(var s="",l=0,u=0;u<r.length;u++){for(n=r[u];n>t[l+1].offset;)l++;var c=t[l].offset,h=(n-c)/(t[l+1].offset-c),f=t[l].color,p=t[l+1].color;s+=V(Math.round((1-h)*f[0]+h*p[0]).toString(16))+V(Math.round((1-h)*f[1]+h*p[1]).toString(16))+V(Math.round((1-h)*f[2]+h*p[2]).toString(16))}return s.trim()},fe=function(t,e){e||(e=21);var n=Yt(),r=he(t.colors,e),i=[];i.push({key:"FunctionType",value:"0"}),i.push({key:"Domain",value:"[0.0 1.0]"}),i.push({key:"Size",value:"["+e+"]"}),i.push({key:"BitsPerSample",value:"8"}),i.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),i.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ie({data:r,additionalKeyValues:i,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),Q("endobj"),t.objectNumber=Yt(),Q("<< /ShadingType "+t.type),Q("/ColorSpace /DeviceRGB");var o="/Coords ["+E(parseFloat(t.coords[0]))+" "+E(parseFloat(t.coords[1]))+" ";2===t.type?o+=E(parseFloat(t.coords[2]))+" "+E(parseFloat(t.coords[3])):o+=E(parseFloat(t.coords[2]))+" "+E(parseFloat(t.coords[3]))+" "+E(parseFloat(t.coords[4]))+" "+E(parseFloat(t.coords[5])),Q(o+="]"),t.matrix&&Q("/Matrix ["+t.matrix.toString()+"]"),Q("/Function "+n+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},pe=function(t,e){var n=$t(),r=Yt();e.push({resourcesOid:n,objectOid:r}),t.objectNumber=r;var i=[];i.push({key:"Type",value:"/Pattern"}),i.push({key:"PatternType",value:"1"}),i.push({key:"PaintType",value:"1"}),i.push({key:"TilingType",value:"1"}),i.push({key:"BBox",value:"["+t.boundingBox.map(E).join(" ")+"]"}),i.push({key:"XStep",value:E(t.xStep)}),i.push({key:"YStep",value:E(t.yStep)}),i.push({key:"Resources",value:n+" 0 R"}),t.matrix&&i.push({key:"Matrix",value:"["+t.matrix.toString()+"]"}),ie({data:t.stream,additionalKeyValues:i,objectId:t.objectNumber}),Q("endobj")},de=function(t){var e;for(e in Ct)Ct.hasOwnProperty(e)&&(Ct[e]instanceof Gt?fe(Ct[e]):Ct[e]instanceof Wt&&pe(Ct[e],t))},me=function(t){for(var e in t.objectNumber=Yt(),Q("<<"),t)switch(e){case"opacity":Q("/ca "+I(t[e]));break;case"stroke-opacity":Q("/CA "+I(t[e]))}Q(">>"),Q("endobj")},ge=function(){var t;for(t in Tt)Tt.hasOwnProperty(t)&&me(Tt[t])},ve=function(){for(var t in Q("/XObject <<"),Nt)Nt.hasOwnProperty(t)&&Nt[t].objectNumber>=0&&Q("/"+t+" "+Nt[t].objectNumber+" 0 R");Rt.publish("putXobjectDict"),Q(">>")},ye=function(){Xe.oid=Yt(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Xe.v),Q("/R "+Xe.r),Q("/U <"+Xe.toHexString(Xe.U)+">"),Q("/O <"+Xe.toHexString(Xe.O)+">"),Q("/P "+Xe.P),Q(">>"),Q("endobj")},_e=function(){for(var t in Q("/Font <<"),xt)xt.hasOwnProperty(t)&&(!1===h||!0===h&&f.hasOwnProperty(t))&&Q("/"+t+" "+xt[t].objectNumber+" 0 R");Q(">>")},xe=function(){if(Object.keys(Ct).length>0){for(var t in Q("/Shading <<"),Ct)Ct.hasOwnProperty(t)&&Ct[t]instanceof Gt&&Ct[t].objectNumber>=0&&Q("/"+t+" "+Ct[t].objectNumber+" 0 R");Rt.publish("putShadingPatternDict"),Q(">>")}},be=function(t){if(Object.keys(Ct).length>0){for(var e in Q("/Pattern <<"),Ct)Ct.hasOwnProperty(e)&&Ct[e]instanceof p.TilingPattern&&Ct[e].objectNumber>=0&&Ct[e].objectNumber<t&&Q("/"+e+" "+Ct[e].objectNumber+" 0 R");Rt.publish("putTilingPatternDict"),Q(">>")}},we=function(){if(Object.keys(Tt).length>0){var t;for(t in Q("/ExtGState <<"),Tt)Tt.hasOwnProperty(t)&&Tt[t].objectNumber>=0&&Q("/"+t+" "+Tt[t].objectNumber+" 0 R");Rt.publish("putGStateDict"),Q(">>")}},Se=function(t){Kt(t.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),_e(),xe(),be(t.objectOid),we(),ve(),Q(">>"),Q("endobj")},Ee=function(){var t=[];le(),ge(),ce(),de(t),Rt.publish("putResources"),t.forEach(Se),Se({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Rt.publish("postPutResources")},ke=function(){Rt.publish("putAdditionalObjects");for(var t=0;t<X.length;t++){var e=X[t];Kt(e.objId,!0),Q(e.content),Q("endobj")}Rt.publish("postPutAdditionalObjects")},Ce=function(t){Et[t.fontName]=Et[t.fontName]||{},Et[t.fontName][t.fontStyle]=t.id},Ie=function(t,e,n,r,i){var o={id:"F"+(Object.keys(xt).length+1).toString(10),postScriptName:t,fontName:e,fontStyle:n,encoding:r,isStandardFont:i||!1,metadata:{}};return Rt.publish("addFont",{font:o,instance:this}),xt[o.id]=o,Ce(o),o.id},Te=function(t){for(var e=0,n=nt.length;e<n;e++){var r=Ie.call(this,t[e][0],t[e][1],t[e][2],nt[e][3],!0);!1===h&&(f[r]=!0);var i=t[e][0].split("-");Ce({id:r,fontName:i[0],fontStyle:i[1]||""})}Rt.publish("addFonts",{fonts:xt,dictionary:Et})},Pe=function(t){return t.foo=function(){try{return t.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var n="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!dt.console)throw new Error(n);dt.console.error(n,t),dt.alert&&alert(n)}},t.foo.bar=t,t.foo},Ae=function(t,e){var n,r,i,o,a,s,l,u,c;if(i=(e=e||{}).sourceEncoding||"Unicode",a=e.outputEncoding,(e.autoencode||a)&&xt[pt].metadata&&xt[pt].metadata[i]&&xt[pt].metadata[i].encoding&&(o=xt[pt].metadata[i].encoding,!a&&xt[pt].encoding&&(a=xt[pt].encoding),!a&&o.codePages&&(a=o.codePages[0]),"string"==typeof a&&(a=o[a]),a)){for(l=!1,s=[],n=0,r=t.length;n<r;n++)(u=a[t.charCodeAt(n)])?s.push(String.fromCharCode(u)):s.push(t[n]),s[n].charCodeAt(0)>>8&&(l=!0);t=s.join("")}for(n=t.length;void 0===l&&0!==n;)t.charCodeAt(n-1)>>8&&(l=!0),n--;if(!l)return t;for(s=e.noBOM?[]:[254,255],n=0,r=t.length;n<r;n++){if((c=(u=t.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");s.push(c),s.push(u-(c<<8))}return String.fromCharCode.apply(void 0,s)},Me=p.__private__.pdfEscape=p.pdfEscape=function(t,e){return Ae(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Le=p.__private__.beginPage=function(t){H[++Mt]=[],Lt[Mt]={objId:0,contentsObjId:0,userUnit:Number(s),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t[0]),topRightY:Number(t[1])}},Ne(Mt),J(H[j])},Re=function(t,e){var r,o,a;switch(n=e||n,"string"==typeof t&&(r=v(t.toLowerCase()),Array.isArray(r)&&(o=r[0],a=r[1])),Array.isArray(t)&&(o=t[0]*mt,a=t[1]*mt),isNaN(o)&&(o=i[0],a=i[1]),(o>14400||a>14400)&&(gt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),o=Math.min(14400,o),a=Math.min(14400,a)),i=[o,a],n.substr(0,1)){case"l":a>o&&(i=[a,o]);break;case"p":o>a&&(i=[a,o])}Le(i),mn(pn),Q(Sn),0!==Pn&&Q(Pn+" J"),0!==An&&Q(An+" j"),Rt.publish("addPage",{pageNumber:Mt})},De=function(t){t>0&&t<=Mt&&(H.splice(t,1),Lt.splice(t,1),Mt--,j>Mt&&(j=Mt),this.setPage(j))},Ne=function(t){t>0&&t<=Mt&&(j=t)},ze=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return H.length-1},Oe=function(t,e,n){var r,i=void 0;return n=n||{},t=void 0!==t?t:xt[pt].fontName,e=void 0!==e?e:xt[pt].fontStyle,r=t.toLowerCase(),void 0!==Et[r]&&void 0!==Et[r][e]?i=Et[r][e]:void 0!==Et[t]&&void 0!==Et[t][e]?i=Et[t][e]:!1===n.disableWarning&&gt.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),i||n.noFallback||null==(i=Et.times[e])&&(i=Et.times.normal),i},Fe=p.__private__.putInfo=function(){var t=Yt(),e=function(t){return t};for(var n in null!==c&&(e=Xe.encryptor(t,0)),Q("<<"),Q("/Producer ("+Me(e("jsPDF "+Xt.version))+")"),ft)ft.hasOwnProperty(n)&&ft[n]&&Q("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+Me(e(ft[n]))+")");Q("/CreationDate ("+Me(e(L))+")"),Q(">>"),Q("endobj")},Be=p.__private__.putCatalog=function(t){var e=(t=t||{}).rootDictionaryObjId||Qt;switch(Yt(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+e+" 0 R"),it||(it="fullwidth"),it){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+it;"%"===n.substr(n.length-1)&&(it=parseInt(it)/100),"number"==typeof it&&Q("/OpenAction [3 0 R /XYZ null null "+I(it)+"]")}switch(ut||(ut="continuous"),ut){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}st&&Q("/PageMode /"+st),Rt.publish("putCatalog"),Q(">>"),Q("endobj")},je=p.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(Z+1)),Q("/Root "+Z+" 0 R"),Q("/Info "+(Z-1)+" 0 R"),null!==c&&Q("/Encrypt "+Xe.oid+" 0 R"),Q("/ID [ <"+R+"> <"+R+"> ]"),Q(">>")},Ue=p.__private__.putHeader=function(){Q("%PDF-"+d),Q("%\xba\xdf\xac\xe0")},Ve=p.__private__.putXRef=function(){var t="0000000000";Q("xref"),Q("0 "+(Z+1)),Q("0000000000 65535 f ");for(var e=1;e<=Z;e++)"function"==typeof q[e]?Q((t+q[e]()).slice(-10)+" 00000 n "):void 0!==q[e]?Q((t+q[e]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},Ze=p.__private__.buildDocument=function(){K(),J(G),Rt.publish("buildDocument"),Ue(),ae(),ke(),Ee(),null!==c&&ye(),Fe(),Be();var t=W;return Ve(),je(),Q("startxref"),Q(""+t),Q("%%EOF"),J(H[j]),G.join("\n")},qe=p.__private__.getBlob=function(t){return new Blob([et(t)],{type:"application/pdf"})},Ge=p.output=p.__private__.output=Pe((function(t,e){switch("string"==typeof(e=e||{})?e={filename:e}:e.filename=e.filename||"generated.pdf",t){case void 0:return Ze();case"save":p.save(e.filename);break;case"arraybuffer":return et(Ze());case"blob":return qe(Ze());case"bloburi":case"bloburl":if(void 0!==dt.URL&&"function"==typeof dt.URL.createObjectURL)return dt.URL&&dt.URL.createObjectURL(qe(Ze()))||void 0;gt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",r=Ze();try{n=bt(r)}catch(t){n=bt(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+e.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(dt)){var i="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",o=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';e.pdfObjectUrl&&(i=e.pdfObjectUrl,o="");var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+i+'"'+o+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e)+");<\/script></body></html>",s=dt.open();return null!==s&&s.document.write(a),s}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(dt)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e.filename+'" width="500px" height="400px" /></body></html>',u=dt.open();if(null!==u){u.document.write(l);var c=this;u.document.documentElement.querySelector("#pdfViewer").onload=function(){u.document.title=e.filename,u.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(c.output("bloburl"))}}return u}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(dt))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e)+'"></iframe></body></html>',f=dt.open();if(null!==f&&(f.document.write(h),f.document.title=e.filename),f||"undefined"==typeof safari)return f;break;case"datauri":case"dataurl":return dt.document.location.href=this.output("datauristring",e);default:return null}})),We=function(t){return!0===Array.isArray(Dt)&&Dt.indexOf(t)>-1};switch(r){case"pt":mt=1;break;case"mm":mt=72/25.4;break;case"cm":mt=72/2.54;break;case"in":mt=72;break;case"px":mt=1==We("px_scaling")?.75:96/72;break;case"pc":case"em":mt=12;break;case"ex":mt=6;break;default:if("number"!=typeof r)throw new Error("Invalid unit: "+r);mt=r}var Xe=null;F(),N();var He=function(t){return null!==c?Xe.encryptor(t,0):function(t){return t}},Ye=p.__private__.getPageInfo=p.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Lt[t].objId,pageNumber:t,pageContext:Lt[t]}},$e=p.__private__.getPageInfoByObjId=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e in Lt)if(Lt[e].objId===t)break;return Ye(e)},Ke=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Lt[j].objId,pageNumber:j,pageContext:Lt[j]}};p.addPage=function(){return Re.apply(this,arguments),this},p.setPage=function(){return Ne.apply(this,arguments),J.call(this,H[j]),this},p.insertPage=function(t){return this.addPage(),this.movePage(j,t),this},p.movePage=function(t,e){var n,r;if(t>e){n=H[t],r=Lt[t];for(var i=t;i>e;i--)H[i]=H[i-1],Lt[i]=Lt[i-1];H[e]=n,Lt[e]=r,this.setPage(e)}else if(t<e){n=H[t],r=Lt[t];for(var o=t;o<e;o++)H[o]=H[o+1],Lt[o]=Lt[o+1];H[e]=n,Lt[e]=r,this.setPage(e)}return this},p.deletePage=function(){return De.apply(this,arguments),this},p.__private__.text=p.text=function(t,e,n,r,i){var o,a,s,l,u,c,h,p,d,m=(r=r||{}).scope||this;if("number"==typeof t&&"number"==typeof e&&("string"==typeof n||Array.isArray(n))){var g=n;n=e,e=t,t=g}if(arguments[3]instanceof Ft==0?(s=arguments[4],l=arguments[5],"object"===(0,x.Z)(h=arguments[3])&&null!==h||("string"==typeof s&&(l=s,s=null),"string"==typeof h&&(l=h,h=null),"number"==typeof h&&(s=h,h=null),r={flags:h,angle:s,align:l})):(k("The transform parameter of text() with a Matrix value"),d=i),isNaN(e)||isNaN(n)||null==t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return m;var v="",b=!1,w="number"==typeof r.lineHeightFactor?r.lineHeightFactor:fn,S=m.internal.scaleFactor;function C(t){return t=t.split("\t").join(Array(r.TabLen||9).join(" ")),Me(t,h)}function I(t){for(var e,n=t.concat(),r=[],i=n.length;i--;)"string"==typeof(e=n.shift())?r.push(e):Array.isArray(t)&&(1===e.length||void 0===e[1]&&void 0===e[2])?r.push(e[0]):r.push([e[0],e[1],e[2]]);return r}function T(t,e){var n;if("string"==typeof t)n=e(t)[0];else if(Array.isArray(t)){for(var r,i,o=t.concat(),a=[],s=o.length;s--;)"string"==typeof(r=o.shift())?a.push(e(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(i=e(r[0],r[1],r[2]),a.push([i[0],i[1],i[2]]));n=a}return n}var A=!1,M=!0;if("string"==typeof t)A=!0;else if(Array.isArray(t)){var L=t.concat();a=[];for(var R,D=L.length;D--;)("string"!=typeof(R=L.shift())||Array.isArray(R)&&"string"!=typeof R[0])&&(M=!1);A=M}if(!1===A)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var N=rt/m.internal.scaleFactor,z=N*(w-1);switch(r.baseline){case"bottom":n-=z;break;case"top":n+=N-z;break;case"hanging":n+=N-2*z;break;case"middle":n+=N/2-z}if((c=r.maxWidth||0)>0&&("string"==typeof t?t=m.splitTextToSize(t,c):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce((function(t,e){return t.concat(m.splitTextToSize(e,c))}),[]))),o={text:t,x:e,y:n,options:r,mutex:{pdfEscape:Me,activeFontKey:pt,fonts:xt,activeFontSize:rt}},Rt.publish("preProcessText",o),t=o.text,s=(r=o.options).angle,d instanceof Ft==0&&s&&"number"==typeof s){s*=Math.PI/180,0===r.rotationDirection&&(s=-s),_===y.ADVANCED&&(s=-s);var O=Math.cos(s),F=Math.sin(s);d=new Ft(O,F,-F,O,0,0)}else s&&s instanceof Ft&&(d=s);_!==y.ADVANCED||d||(d=qt),void 0!==(u=r.charSpace||In)&&(v+=E(P(u))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(p=r.horizontalScale)&&(v+=E(100*p)+" Tz\n"),r.lang;var B=-1,j=void 0!==r.renderingMode?r.renderingMode:r.stroke,U=m.internal.getCurrentPageInfo().pageContext;switch(j){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var V=void 0!==U.usedRenderingMode?U.usedRenderingMode:-1;-1!==B?v+=B+" Tr\n":-1!==V&&(v+="0 Tr\n"),-1!==B&&(U.usedRenderingMode=B),l=r.align||"left";var Z,q=rt*w,G=m.internal.pageSize.getWidth(),W=xt[pt];u=r.charSpace||In,c=r.maxWidth||0,h=Object.assign({autoencode:!0,noBOM:!0},r.flags);var X=[];if("[object Array]"===Object.prototype.toString.call(t)){var H;a=I(t),"left"!==l&&(Z=a.map((function(t){return m.getStringUnitWidth(t,{font:W,charSpace:u,fontSize:rt,doKerning:!1})*rt/S})));var Y,$=0;if("right"===l){e-=Z[0],t=[],D=a.length;for(var K=0;K<D;K++)0===K?(Y=_n(e),H=xn(n)):(Y=P($-Z[K]),H=-q),t.push([a[K],Y,H]),$=Z[K]}else if("center"===l){e-=Z[0]/2,t=[],D=a.length;for(var J=0;J<D;J++)0===J?(Y=_n(e),H=xn(n)):(Y=P(($-Z[J])/2),H=-q),t.push([a[J],Y,H]),$=Z[J]}else if("left"===l){t=[],D=a.length;for(var tt=0;tt<D;tt++)t.push(a[tt])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');t=[],D=a.length,c=0!==c?c:G;for(var et=0;et<D;et++)H=0===et?xn(n):-q,Y=0===et?_n(e):0,et<D-1?X.push(E(P((c-Z[et])/(a[et].split(" ").length-1)))):X.push(0),t.push([a[et],Y,H])}}var nt="boolean"==typeof r.R2L?r.R2L:at;!0===nt&&(t=T(t,(function(t,e,n){return[t.split("").reverse().join(""),e,n]}))),o={text:t,x:e,y:n,options:r,mutex:{pdfEscape:Me,activeFontKey:pt,fonts:xt,activeFontSize:rt}},Rt.publish("postProcessText",o),t=o.text,b=o.mutex.isHex||!1;var it=xt[pt].encoding;"WinAnsiEncoding"!==it&&"StandardEncoding"!==it||(t=T(t,(function(t,e,n){return[C(t),e,n]}))),a=I(t),t=[];for(var ot,st,lt,ut=0,ct=1,ht=Array.isArray(a[0])?ct:ut,ft="",dt=function(t,e,n){var i="";return n instanceof Ft?(n="number"==typeof r.angle?Bt(n,new Ft(1,0,0,1,t,e)):Bt(new Ft(1,0,0,1,t,e),n),_===y.ADVANCED&&(n=Bt(new Ft(1,0,0,-1,0,0),n)),i=n.join(" ")+" Tm\n"):i=E(t)+" "+E(e)+" Td\n",i},mt=0;mt<a.length;mt++){switch(ft="",ht){case ct:lt=(b?"<":"(")+a[mt][0]+(b?">":")"),ot=parseFloat(a[mt][1]),st=parseFloat(a[mt][2]);break;case ut:lt=(b?"<":"(")+a[mt]+(b?">":")"),ot=_n(e),st=xn(n)}void 0!==X&&void 0!==X[mt]&&(ft=X[mt]+" Tw\n"),0===mt?t.push(ft+dt(ot,st,d)+lt):ht===ut?t.push(ft+lt):ht===ct&&t.push(ft+dt(ot,st,d)+lt)}t=ht===ut?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";var gt="BT\n/";return gt+=pt+" "+rt+" Tf\n",gt+=E(rt*w)+" TL\n",gt+=kn+"\n",gt+=v,gt+=t,Q(gt+="ET"),f[pt]=!0,m};var Je=p.__private__.clip=p.clip=function(t){return Q("evenodd"===t?"W*":"W"),this};p.clipEvenOdd=function(){return Je("evenodd")},p.__private__.discardPath=p.discardPath=function(){return Q("n"),this};var Qe=p.__private__.isValidStyle=function(t){var e=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(t)&&(e=!0),e};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(t){return Qe(t)&&(u=t),this};var tn=p.__private__.getStyle=p.getStyle=function(t){var e=u;switch(t){case"D":case"S":e="S";break;case"F":e="f";break;case"FD":case"DF":e="B";break;case"f":case"f*":case"B":case"B*":e=t}return e},en=p.close=function(){return Q("h"),this};p.stroke=function(){return Q("S"),this},p.fill=function(t){return nn("f",t),this},p.fillEvenOdd=function(t){return nn("f*",t),this},p.fillStroke=function(t){return nn("B",t),this},p.fillStrokeEvenOdd=function(t){return nn("B*",t),this};var nn=function(t,e){"object"===(0,x.Z)(e)?an(e,t):Q(t)},rn=function(t){null===t||_===y.ADVANCED&&void 0===t||(t=tn(t),Q(t))};function on(t,e,n,r,i){var o=new Wt(e||this.boundingBox,n||this.xStep,r||this.yStep,this.gState,i||this.matrix);o.stream=this.stream;var a=t+"$$"+this.cloneIndex+++"$$";return Ht(a,o),o}var an=function(t,e){var n=It[t.key],r=Ct[n];if(r instanceof Gt)Q("q"),Q(sn(e)),r.gState&&p.setGState(r.gState),Q(t.matrix.toString()+" cm"),Q("/"+n+" sh"),Q("Q");else if(r instanceof Wt){var i=new Ft(1,0,0,-1,0,jn());t.matrix&&(i=i.multiply(t.matrix||qt),n=on.call(r,t.key,t.boundingBox,t.xStep,t.yStep,i).id),Q("q"),Q("/Pattern cs"),Q("/"+n+" scn"),r.gState&&p.setGState(r.gState),Q(e),Q("Q")}},sn=function(t){switch(t){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ln=p.moveTo=function(t,e){return Q(E(P(t))+" "+E(M(e))+" m"),this},un=p.lineTo=function(t,e){return Q(E(P(t))+" "+E(M(e))+" l"),this},cn=p.curveTo=function(t,e,n,r,i,o){return Q([E(P(t)),E(M(e)),E(P(n)),E(M(r)),E(P(i)),E(M(o)),"c"].join(" ")),this};p.__private__.line=p.line=function(t,e,n,r,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||!Qe(i))throw new Error("Invalid arguments passed to jsPDF.line");return _===y.COMPAT?this.lines([[n-t,r-e]],t,e,[1,1],i||"S"):this.lines([[n-t,r-e]],t,e,[1,1]).stroke()},p.__private__.lines=p.lines=function(t,e,n,r,i,o){var a,s,l,u,c,h,f,p,d,m,g,v;if("number"==typeof t&&(v=n,n=e,e=t,t=v),r=r||[1,1],o=o||!1,isNaN(e)||isNaN(n)||!Array.isArray(t)||!Array.isArray(r)||!Qe(i)||"boolean"!=typeof o)throw new Error("Invalid arguments passed to jsPDF.lines");for(ln(e,n),a=r[0],s=r[1],u=t.length,m=e,g=n,l=0;l<u;l++)2===(c=t[l]).length?(m=c[0]*a+m,g=c[1]*s+g,un(m,g)):(h=c[0]*a+m,f=c[1]*s+g,p=c[2]*a+m,d=c[3]*s+g,m=c[4]*a+m,g=c[5]*s+g,cn(h,f,p,d,m,g));return o&&en(),rn(i),this},p.path=function(t){for(var e=0;e<t.length;e++){var n=t[e],r=n.c;switch(n.op){case"m":ln(r[0],r[1]);break;case"l":un(r[0],r[1]);break;case"c":cn.apply(this,r);break;case"h":en()}}return this},p.__private__.rect=p.rect=function(t,e,n,r,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||!Qe(i))throw new Error("Invalid arguments passed to jsPDF.rect");return _===y.COMPAT&&(r=-r),Q([E(P(t)),E(M(e)),E(P(n)),E(P(r)),"re"].join(" ")),rn(i),this},p.__private__.triangle=p.triangle=function(t,e,n,r,i,o,a){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(o)||!Qe(a))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-t,r-e],[i-n,o-r],[t-i,e-o]],t,e,[1,1],a,!0),this},p.__private__.roundedRect=p.roundedRect=function(t,e,n,r,i,o,a){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(o)||!Qe(a))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var s=4/3*(Math.SQRT2-1);return i=Math.min(i,.5*n),o=Math.min(o,.5*r),this.lines([[n-2*i,0],[i*s,0,i,o-o*s,i,o],[0,r-2*o],[0,o*s,-i*s,o,-i,o],[2*i-n,0],[-i*s,0,-i,-o*s,-i,-o],[0,2*o-r],[0,-o*s,i*s,-o,i,-o]],t+i,e,[1,1],a,!0),this},p.__private__.ellipse=p.ellipse=function(t,e,n,r,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||!Qe(i))throw new Error("Invalid arguments passed to jsPDF.ellipse");var o=4/3*(Math.SQRT2-1)*n,a=4/3*(Math.SQRT2-1)*r;return ln(t+n,e),cn(t+n,e-a,t+o,e-r,t,e-r),cn(t-o,e-r,t-n,e-a,t-n,e),cn(t-n,e+a,t-o,e+r,t,e+r),cn(t+o,e+r,t+n,e+a,t+n,e),rn(i),this},p.__private__.circle=p.circle=function(t,e,n,r){if(isNaN(t)||isNaN(e)||isNaN(n)||!Qe(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,n,n,r)},p.setFont=function(t,e,n){return n&&(e=S(e,n)),pt=Oe(t,e,{disableWarning:!1}),this};var hn=p.__private__.getFont=p.getFont=function(){return xt[Oe.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var t,e,n={};for(t in Et)if(Et.hasOwnProperty(t))for(e in n[t]=[],Et[t])Et[t].hasOwnProperty(e)&&n[t].push(e);return n},p.addFont=function(t,e,n,r,i){var o=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==o.indexOf(arguments[3])?i=arguments[3]:arguments[3]&&-1==o.indexOf(arguments[3])&&(n=S(n,r)),i=i||"Identity-H",Ie.call(this,t,e,n,i)};var fn,pn=t.lineWidth||.200025,dn=p.__private__.getLineWidth=p.getLineWidth=function(){return pn},mn=p.__private__.setLineWidth=p.setLineWidth=function(t){return pn=t,Q(E(P(t))+" w"),this};p.__private__.setLineDash=Xt.API.setLineDash=Xt.API.setLineDashPattern=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map((function(t){return E(P(t))})).join(" "),e=E(P(e)),Q("["+t+"] "+e+" d"),this};var gn=p.__private__.getLineHeight=p.getLineHeight=function(){return rt*fn};p.__private__.getLineHeight=p.getLineHeight=function(){return rt*fn};var vn=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(t){return"number"==typeof(t=t||1.15)&&(fn=t),this},yn=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return fn};vn(t.lineHeight);var _n=p.__private__.getHorizontalCoordinate=function(t){return P(t)},xn=p.__private__.getVerticalCoordinate=function(t){return _===y.ADVANCED?t:Lt[j].mediaBox.topRightY-Lt[j].mediaBox.bottomLeftY-P(t)},bn=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(t){return E(_n(t))},wn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(t){return E(xn(t))},Sn=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return ee(Sn)},p.__private__.setStrokeColor=p.setDrawColor=function(t,e,n,r){return Sn=ne({ch1:t,ch2:e,ch3:n,ch4:r,pdfColorType:"draw",precision:2}),Q(Sn),this};var En=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return ee(En)},p.__private__.setFillColor=p.setFillColor=function(t,e,n,r){return En=ne({ch1:t,ch2:e,ch3:n,ch4:r,pdfColorType:"fill",precision:2}),Q(En),this};var kn=t.textColor||"0 g",Cn=p.__private__.getTextColor=p.getTextColor=function(){return ee(kn)};p.__private__.setTextColor=p.setTextColor=function(t,e,n,r){return kn=ne({ch1:t,ch2:e,ch3:n,ch4:r,pdfColorType:"text",precision:3}),this};var In=t.charSpace,Tn=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(In||0)};p.__private__.setCharSpace=p.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return In=t,this};var Pn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(t){var e=p.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pn=e,Q(e+" J"),this};var An=0;p.__private__.setLineJoin=p.setLineJoin=function(t){var e=p.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return An=e,Q(e+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(E(P(t))+" M"),this},p.GState=Zt,p.setGState=function(t){(t="string"==typeof t?Tt[Pt[t]]:Mn(null,t)).equals(At)||(Q("/"+t.id+" gs"),At=t)};var Mn=function(t,e){if(!t||!Pt[t]){var n=!1;for(var r in Tt)if(Tt.hasOwnProperty(r)&&Tt[r].equals(e)){n=!0;break}if(n)e=Tt[r];else{var i="GS"+(Object.keys(Tt).length+1).toString(10);Tt[i]=e,e.id=i}return t&&(Pt[t]=e.id),Rt.publish("addGState",e),e}};p.addGState=function(t,e){return Mn(t,e),this},p.saveGraphicsState=function(){return Q("q"),kt.push({key:pt,size:rt,color:kn}),this},p.restoreGraphicsState=function(){Q("Q");var t=kt.pop();return pt=t.key,rt=t.size,kn=t.color,At=null,this},p.setCurrentTransformationMatrix=function(t){return Q(t.toString()+" cm"),this},p.comment=function(t){return Q("#"+t),this};var Ln=function(t,e){var n=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var r=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var i="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return i},set:function(t){i=t.toString()}}),this},Rn=function(t,e,n,r){Ln.call(this,t,e),this.type="rect";var i=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}});var o=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return o},set:function(t){isNaN(t)||(o=parseFloat(t))}}),this},Dn=function(){this.page=Mt,this.currentPage=j,this.pages=H.slice(0),this.pagesContext=Lt.slice(0),this.x=vt,this.y=yt,this.matrix=_t,this.width=Fn(j),this.height=jn(j),this.outputDestination=$,this.id="",this.objectNumber=-1};Dn.prototype.restore=function(){Mt=this.page,j=this.currentPage,Lt=this.pagesContext,H=this.pages,vt=this.x,yt=this.y,_t=this.matrix,Bn(j,this.width),Un(j,this.height),$=this.outputDestination};var Nn=function(t,e,n,r,i){Ot.push(new Dn),Mt=j=0,H=[],vt=t,yt=e,_t=i,Le([n,r])},zn=function(t){if(zt[t])Ot.pop().restore();else{var e=new Dn,n="Xo"+(Object.keys(Nt).length+1).toString(10);e.id=n,zt[t]=n,Nt[n]=e,Rt.publish("addFormObject",e),Ot.pop().restore()}};for(var On in p.beginFormObject=function(t,e,n,r,i){return Nn(t,e,n,r,i),this},p.endFormObject=function(t){return zn(t),this},p.doFormObject=function(t,e){var n=Nt[zt[t]];return Q("q"),Q(e.toString()+" cm"),Q("/"+n.id+" Do"),Q("Q"),this},p.getFormObject=function(t){var e=Nt[zt[t]];return{x:e.x,y:e.y,width:e.width,height:e.height,matrix:e.matrix}},p.save=function(t,e){return t=t||"generated.pdf",(e=e||{}).returnPromise=e.returnPromise||!1,!1===e.returnPromise?(wt(qe(Ze()),t),"function"==typeof wt.unload&&dt.setTimeout&&setTimeout(wt.unload,911),this):new Promise((function(e,n){try{var r=wt(qe(Ze()),t);"function"==typeof wt.unload&&dt.setTimeout&&setTimeout(wt.unload,911),e(r)}catch(t){n(t.message)}}))},Xt.API)Xt.API.hasOwnProperty(On)&&("events"===On&&Xt.API.events.length?function(t,e){var n,r,i;for(i=e.length-1;-1!==i;i--)n=e[i][0],r=e[i][1],t.subscribe.apply(t,[n].concat("function"==typeof r?[r]:r))}(Rt,Xt.API.events):p[On]=Xt.API[On]);var Fn=p.getPageWidth=function(t){return(Lt[t=t||j].mediaBox.topRightX-Lt[t].mediaBox.bottomLeftX)/mt},Bn=p.setPageWidth=function(t,e){Lt[t].mediaBox.topRightX=e*mt+Lt[t].mediaBox.bottomLeftX},jn=p.getPageHeight=function(t){return(Lt[t=t||j].mediaBox.topRightY-Lt[t].mediaBox.bottomLeftY)/mt},Un=p.setPageHeight=function(t,e){Lt[t].mediaBox.topRightY=e*mt+Lt[t].mediaBox.bottomLeftY};return p.internal={pdfEscape:Me,getStyle:tn,getFont:hn,getFontSize:ot,getCharSpace:Tn,getTextColor:Cn,getLineHeight:gn,getLineHeightFactor:yn,getLineWidth:dn,write:tt,getHorizontalCoordinate:_n,getVerticalCoordinate:xn,getCoordinateString:bn,getVerticalCoordinateString:wn,collections:{},newObject:Yt,newAdditionalObject:Jt,newObjectDeferred:$t,newObjectDeferredBegin:Kt,getFilters:re,putStream:ie,events:Rt,scaleFactor:mt,pageSize:{getWidth:function(){return Fn(j)},setWidth:function(t){Bn(j,t)},getHeight:function(){return jn(j)},setHeight:function(t){Un(j,t)}},encryptionOptions:c,encryption:Xe,getEncryptor:He,output:Ge,getNumberOfPages:ze,pages:H,out:Q,f2:I,f3:T,getPageInfo:Ye,getPageInfoByObjId:$e,getCurrentPageInfo:Ke,getPDFVersion:m,Point:Ln,Rectangle:Rn,Matrix:Ft,hasHotfix:We},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Fn(j)},set:function(t){Bn(j,t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return jn(j)},set:function(t){Un(j,t)},enumerable:!0,configurable:!0}),Te.call(p,nt),pt="F1",Re(i,n),Rt.publish("initialized"),p}jt.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},jt.prototype.toHexString=function(t){return t.split("").map((function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)})).join("")},jt.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},jt.prototype.processOwnerPassword=function(t,e){return Ft(Nt(e).substr(0,5),t)},jt.prototype.encryptor=function(t,e){var n=Nt(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(t){return Ft(n,t)}},Zt.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||(0,x.Z)(t)!==(0,x.Z)(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e))return!1;if(this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return 0===r},Xt.API={events:[]},Xt.version="2.5.1";var Ht=Xt.API,Yt=1,$t=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kt=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Jt=function(t){return t.toFixed(2)},Qt=function(t){return t.toFixed(5)};Ht.__acroform__={};var te=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},ee=function(t){return t*Yt},ne=function(t){var e=new _e,n=Re.internal.getHeight(t)||0,r=Re.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Jt(r)),Number(Jt(n))],e},re=Ht.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},ie=Ht.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},oe=Ht.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<e)?0:1},ae=Ht.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return oe(t,e-1)},se=Ht.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return re(t,e-1)},le=Ht.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return ie(t,e-1)},ue=Ht.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],o=t[1],a=t[2],s=t[3],l={};return l.lowerLeft_X=n(i)||0,l.lowerLeft_Y=r(o+s)||0,l.upperRight_X=n(i+a)||0,l.upperRight_Y=r(o)||0,[Number(Jt(l.lowerLeft_X)),Number(Jt(l.lowerLeft_Y)),Number(Jt(l.upperRight_X)),Number(Jt(l.upperRight_Y))]},ce=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=he(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Jt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=ne(t);return o.scope=t.scope,o.stream=e.join("\n"),o}},he=function(t,e){var n=0===t.fontSize?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=")"==(e="("==e.substr(0,1)?e.substr(1):e).substr(e.length-1)?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map((function(t){return t.split("\n")})):i.map((function(t){return[t]}));var o=n,a=Re.internal.getHeight(t)||0;a=a<0?-a:a;var s=Re.internal.getWidth(t)||0;s=s<0?-s:s;var l=function(e,n,r){if(e+1<i.length){var o=n+" "+i[e+1][0];return fe(o,t,r).width<=s-4}return!1};o++;t:for(;o>0;){e="",o--;var u,c,h=fe("3",t,o).height,f=t.multiline?a-o:(a-h)/2,p=f+=2,d=0,m=0,g=0;if(o<=0){e="(...) Tj\n",e+="% Width of Text: "+fe(e,t,o=12).width+", FieldWidth:"+s+"\n";break}for(var v="",y=0,_=0;_<i.length;_++)if(i.hasOwnProperty(_)){var x=!1;if(1!==i[_].length&&g!==i[_].length-1){if((h+2)*(y+2)+2>a)continue t;v+=i[_][g],x=!0,m=_,_--}else{v=" "==(v+=i[_][g]+" ").substr(v.length-1)?v.substr(0,v.length-1):v;var b=parseInt(_),w=l(b,v,o),S=_>=i.length-1;if(w&&!S){v+=" ",g=0;continue}if(w||S){if(S)m=b;else if(t.multiline&&(h+2)*(y+2)+2>a)continue t}else{if(!t.multiline)continue t;if((h+2)*(y+2)+2>a)continue t;m=b}}for(var E="",k=d;k<=m;k++){var C=i[k];if(t.multiline){if(k===m){E+=C[g]+" ",g=(g+1)%C.length;continue}if(k===d){E+=C[C.length-1]+" ";continue}}E+=C[0]+" "}switch(E=" "==E.substr(E.length-1)?E.substr(0,E.length-1):E,c=fe(E,t,o).width,t.textAlign){case"right":u=s-c-2;break;case"center":u=(s-c)/2;break;default:u=2}e+=Jt(u)+" "+Jt(p)+" Td\n",e+="("+$t(E)+") Tj\n",e+=-Jt(u)+" 0 Td\n",p=-(o+2),c=0,d=x?m:m+1,y++,v=""}break}return r.text=e,r.fontSize=o,r},fe=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},pe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},de=function(t,e){var n={type:"reference",object:t};void 0===e.internal.getPageInfo(t.page).pageContext.annotations.find((function(t){return t.type===n.type&&t.object===n.object}))&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},me=function(t,e){if(e.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(be.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(pe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Yt=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new xe,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){!function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}(t)})),t.internal.events.subscribe("buildDocument",(function(){!function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r.objId=void 0,r.hasAnnotation&&de(r,t)}}(t)})),t.internal.events.subscribe("putCatalog",(function(){!function(t){if(void 0===t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)})),t.internal.events.subscribe("postPutPages",(function(e){!function(t,e){var n=!t;for(var r in t||(e.internal.newObjectDeferredBegin(e.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),e.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),t=t||e.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(t.hasOwnProperty(r)){var i=t[r],o=[],a=i.Rect;if(i.Rect&&(i.Rect=ue(i.Rect,e)),e.internal.newObjectDeferredBegin(i.objId,!0),i.DA=Re.createDefaultAppearanceStream(i),"object"===(0,x.Z)(i)&&"function"==typeof i.getKeyValueListForStream&&(o=i.getKeyValueListForStream()),i.Rect=a,i.hasAppearanceStream&&!i.appearanceStreamContent){var s=ce(i);o.push({key:"AP",value:"<</N "+s+">>"}),e.internal.acroformPlugin.xForms.push(s)}if(i.appearanceStreamContent){var l="";for(var u in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(u)){var c=i.appearanceStreamContent[u];if(l+="/"+u+" ",l+="<<",Object.keys(c).length>=1||Array.isArray(c)){for(var r in c)if(c.hasOwnProperty(r)){var h=c[r];"function"==typeof h&&(h=h.call(e,i)),l+="/"+r+" "+h+" ",e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h)}}else"function"==typeof(h=c)&&(h=h.call(e,i)),l+="/"+r+" "+h,e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h);l+=">>"}o.push({key:"AP",value:"<<\n"+l+">>"})}e.internal.putStream({additionalKeyValues:o,objectId:i.objId}),e.internal.out("endobj")}n&&function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=n,i=t[n];e.internal.newObjectDeferredBegin(i.objId,!0),"object"===(0,x.Z)(i)&&"function"==typeof i.putStream&&i.putStream(),delete t[r]}}(e.internal.acroformPlugin.xForms,e)}(e,t)})),t.internal.acroformPlugin.isInitialized=!0}},ge=Ht.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(t){return t};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(0!==o&&(i+=" "),(0,x.Z)(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":"/"!==t[o].substr(0,1)?(void 0!==e&&n&&(r=n.internal.getEncryptor(e)),i+="("+$t(r(t[o].toString()))+")"):i+=t[o].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ve=function(t,e,n){var r=function(t){return t};return void 0!==e&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+$t(r(t))+")"},ye=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ye.prototype.toString=function(){return this.objId+" 0 R"},ye.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ye.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter((function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"scope"!=t&&"objId"!=t&&"_"!=t.substring(0,1)}));for(var n in e)if(!1===Object.getOwnPropertyDescriptor(this,e[n]).configurable){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:ge(i,this.objId,this.scope)}):i instanceof ye?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):"function"!=typeof i&&t.push({key:r,value:i}))}return t};var _e=function(){ye.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};te(_e,ye);var xe=function(){ye.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+$t(e(t))+")"}},set:function(e){t=e}})};te(xe,ye);var be=function t(){ye.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(e,3))},set:function(t){!0===Boolean(t)?this.F=se(e,3):this.F=le(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');n=t}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(t){r=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(t){r[0]=t}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(t){r[1]=t}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(t){r[2]=t}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(t){r[3]=t}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Pe)return;o="FieldObject"+t.FieldNum++}var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+$t(e(o))+")"},set:function(t){o=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(t){o=t}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(t){a=t}});var s="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){s=t}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===u?50/Yt:u},set:function(t){u=t}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(t){c=t}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Pe||this instanceof Me))return ve(h,this.objId,this.scope)},set:function(t){t=t.toString(),h=t}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Ce==0?ve(f,this.objId,this.scope):f},set:function(t){t=t.toString(),f=this instanceof Ce==0?"("===t.substr(0,1)?Kt(t.substr(1,t.length-2)):Kt(t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ce==1?Kt(f.substr(1,f.length-1)):f},set:function(t){t=t.toString(),f=this instanceof Ce==1?"/"+t:t}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(t){this.V=t}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Ce==0?ve(p,this.objId,this.scope):p},set:function(t){t=t.toString(),p=this instanceof Ce==0?"("===t.substr(0,1)?Kt(t.substr(1,t.length-2)):Kt(t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ce==1?Kt(p.substr(1,p.length-1)):p},set:function(t){t=t.toString(),p=this instanceof Ce==1?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var d,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(t){t=Boolean(t),m=t}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(d)return d},set:function(t){d=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,1):this.Ff=le(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,2):this.Ff=le(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,3):this.Ff=le(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');g=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t;switch(g){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};te(be,ye);var we=function(){be.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ge(e,this.objId,this.scope)},set:function(t){var n,r;r=[],"string"==typeof(n=t)&&(r=function(t,e,n){n||(n=1);for(var r,i=[];r=e.exec(t);)i.push(r[n]);return i}(n,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,18):this.Ff=le(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=se(this.Ff,19):this.Ff=le(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=se(this.Ff,20),e.sort()):this.Ff=le(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,22):this.Ff=le(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,23):this.Ff=le(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,27):this.Ff=le(this.Ff,27)}}),this.hasAppearanceStream=!1};te(we,be);var Se=function(){we.call(this),this.fontName="helvetica",this.combo=!1};te(Se,we);var Ee=function(){Se.call(this),this.combo=!0};te(Ee,Se);var ke=function(){Ee.call(this),this.edit=!0};te(ke,Ee);var Ce=function(){be.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,15):this.Ff=le(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,16):this.Ff=le(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,17):this.Ff=le(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,26):this.Ff=le(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(e).length){var n,r=[];for(n in r.push("<<"),e)r.push("/"+n+" ("+$t(t(e[n]))+")");return r.push(">>"),r.join("\n")}},set:function(t){"object"===(0,x.Z)(t)&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){"string"==typeof t&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};te(Ce,be);var Ie=function(){Ce.call(this),this.pushButton=!0};te(Ie,Ce);var Te=function(){Ce.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=void 0!==e?e:[]}})};te(Te,Ce);var Pe=function(){var t,e;be.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};this.scope&&(t=this.scope.internal.getEncryptor(this.objId));var e,n=[];for(e in n.push("<<"),r)n.push("/"+e+" ("+$t(t(r[e]))+")");return n.push(">>"),n.join("\n")},set:function(t){"object"===(0,x.Z)(t)&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){"string"==typeof t&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Re.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};te(Pe,be),Te.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},Te.prototype.createOption=function(t){var e=new Pe;return e.Parent=this,e.optionName=t,this.Kids.push(e),De.call(this.scope,e),e};var Ae=function(){Ce.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Re.CheckBox.createAppearanceStream()};te(Ae,Ce);var Me=function(){be.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,13):this.Ff=le(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,21):this.Ff=le(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,23):this.Ff=le(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,24):this.Ff=le(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,25):this.Ff=le(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,26):this.Ff=le(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};te(Me,be);var Le=function(){Me.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(ae(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=se(this.Ff,14):this.Ff=le(this.Ff,14)}}),this.password=!0};te(Le,Me);var Re={CheckBox:{createAppearanceStream:function(){return{N:{On:Re.CheckBox.YesNormal},D:{On:Re.CheckBox.YesPushDown,Off:Re.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=he(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+Jt(Re.internal.getWidth(t))+" "+Jt(Re.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+Jt(o.fontSize)+" Tf "+i),n.push("BT"),n.push(o.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join("\n"),e},YesNormal:function(t){var e=ne(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],o=Re.internal.getHeight(t),a=Re.internal.getWidth(t),s=he(t,t.caption);return i.push("1 g"),i.push("0 0 "+Jt(a)+" "+Jt(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Jt(a-1)+" "+Jt(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+Jt(s.fontSize)+" Tf "+r),i.push(s.text),i.push("ET"),i.push("Q"),e.stream=i.join("\n"),e},OffPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Jt(Re.internal.getWidth(t))+" "+Jt(Re.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Re.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Re.RadioButton.Circle.YesNormal,e.D[t]=Re.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ne(t);e.scope=t.scope;var n=[],r=Re.internal.getWidth(t)<=Re.internal.getHeight(t)?Re.internal.getWidth(t)/4:Re.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Re.internal.Bezier_C,o=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Qt(Re.internal.getWidth(t)/2)+" "+Qt(Re.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e},YesPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=[],r=Re.internal.getWidth(t)<=Re.internal.getHeight(t)?Re.internal.getWidth(t)/4:Re.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*Re.internal.Bezier_C).toFixed(5)),a=Number((r*Re.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Qt(Re.internal.getWidth(t)/2)+" "+Qt(Re.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),n.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),n.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),n.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Qt(Re.internal.getWidth(t)/2)+" "+Qt(Re.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=[],r=Re.internal.getWidth(t)<=Re.internal.getHeight(t)?Re.internal.getWidth(t)/4:Re.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*Re.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Qt(Re.internal.getWidth(t)/2)+" "+Qt(Re.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),n.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),n.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),n.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Re.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Re.RadioButton.Cross.YesNormal,e.D[t]=Re.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ne(t);e.scope=t.scope;var n=[],r=Re.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+Jt(Re.internal.getWidth(t)-2)+" "+Jt(Re.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Jt(r.x1.x)+" "+Jt(r.x1.y)+" m"),n.push(Jt(r.x2.x)+" "+Jt(r.x2.y)+" l"),n.push(Jt(r.x4.x)+" "+Jt(r.x4.y)+" m"),n.push(Jt(r.x3.x)+" "+Jt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},YesPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=Re.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+Jt(Re.internal.getWidth(t))+" "+Jt(Re.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Jt(Re.internal.getWidth(t)-2)+" "+Jt(Re.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Jt(n.x1.x)+" "+Jt(n.x1.y)+" m"),r.push(Jt(n.x2.x)+" "+Jt(n.x2.y)+" l"),r.push(Jt(n.x4.x)+" "+Jt(n.x4.y)+" m"),r.push(Jt(n.x3.x)+" "+Jt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=ne(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Jt(Re.internal.getWidth(t))+" "+Jt(Re.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Re.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Re.internal.getWidth(t),n=Re.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Re.internal.getWidth=function(t){var e=0;return"object"===(0,x.Z)(t)&&(e=ee(t.Rect[2])),e},Re.internal.getHeight=function(t){var e=0;return"object"===(0,x.Z)(t)&&(e=ee(t.Rect[3])),e};var De=Ht.addField=function(t){if(me(this,t),!(t instanceof be))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ht.AcroFormChoiceField=we,Ht.AcroFormListBox=Se,Ht.AcroFormComboBox=Ee,Ht.AcroFormEditBox=ke,Ht.AcroFormButton=Ce,Ht.AcroFormPushButton=Ie,Ht.AcroFormRadioButton=Te,Ht.AcroFormCheckBox=Ae,Ht.AcroFormTextField=Me,Ht.AcroFormPasswordField=Le,Ht.AcroFormAppearance=Re,Ht.AcroForm={ChoiceField:we,ListBox:Se,ComboBox:Ee,EditBox:ke,Button:Ce,PushButton:Ie,RadioButton:Te,CheckBox:Ae,TextField:Me,PasswordField:Le,Appearance:Re},Xt.AcroForm={ChoiceField:we,ListBox:Se,ComboBox:Ee,EditBox:ke,Button:Ce,PushButton:Ie,RadioButton:Te,CheckBox:Ae,TextField:Me,PasswordField:Le,Appearance:Re};Xt.AcroForm;function Ne(t){return t.reduce((function(t,e,n){return t[e]=n,t}),{})}!function(t){t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(t,r){var i,o,a,s,l,u=e;if("RGBA"===(r=r||e)||void 0!==t.data&&t.data instanceof Uint8ClampedArray&&"height"in t&&"width"in t)return"RGBA";if(S(t))for(l in n)for(a=n[l],i=0;i<a.length;i+=1){for(s=!0,o=0;o<a[i].length;o+=1)if(void 0!==a[i][o]&&a[i][o]!==t[o]){s=!1;break}if(!0===s){u=l;break}}else for(l in n)for(a=n[l],i=0;i<a.length;i+=1){for(s=!0,o=0;o<a[i].length;o+=1)if(void 0!==a[i][o]&&a[i][o]!==t.charCodeAt(o)){s=!1;break}if(!0===s){u=l;break}}return u===e&&r!==e&&(u=r),u},i=function t(e){for(var n=this.internal.write,r=this.internal.putStream,i=(0,this.internal.getFilters)();-1!==i.indexOf("FlateEncode");)i.splice(i.indexOf("FlateEncode"),1);e.objectId=this.internal.newObject();var o=[];if(o.push({key:"Type",value:"/XObject"}),o.push({key:"Subtype",value:"/Image"}),o.push({key:"Width",value:e.width}),o.push({key:"Height",value:e.height}),e.colorSpace===g.INDEXED?o.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.palette.length/3-1)+" "+("sMask"in e&&void 0!==e.sMask?e.objectId+2:e.objectId+1)+" 0 R]"}):(o.push({key:"ColorSpace",value:"/"+e.colorSpace}),e.colorSpace===g.DEVICE_CMYK&&o.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),o.push({key:"BitsPerComponent",value:e.bitsPerComponent}),"decodeParameters"in e&&void 0!==e.decodeParameters&&o.push({key:"DecodeParms",value:"<<"+e.decodeParameters+">>"}),"transparency"in e&&Array.isArray(e.transparency)){for(var a="",s=0,l=e.transparency.length;s<l;s++)a+=e.transparency[s]+" "+e.transparency[s]+" ";o.push({key:"Mask",value:"["+a+"]"})}void 0!==e.sMask&&o.push({key:"SMask",value:e.objectId+1+" 0 R"});var u=void 0!==e.filter?["/"+e.filter]:void 0;if(r({data:e.data,additionalKeyValues:o,alreadyAppliedFilters:u,objectId:e.objectId}),n("endobj"),"sMask"in e&&void 0!==e.sMask){var c="/Predictor "+e.predictor+" /Colors 1 /BitsPerComponent "+e.bitsPerComponent+" /Columns "+e.width,h={width:e.width,height:e.height,colorSpace:"DeviceGray",bitsPerComponent:e.bitsPerComponent,decodeParameters:c,data:e.sMask};"filter"in e&&(h.filter=e.filter),t.call(this,h)}if(e.colorSpace===g.INDEXED){var f=this.internal.newObject();r({data:k(new Uint8Array(e.palette)),objectId:f}),n("endobj")}},o=function(){var t=this.internal.collections.addImage_images;for(var e in t)i.call(this,t[e])},a=function(){var t,e=this.internal.collections.addImage_images,n=this.internal.write;for(var r in e)n("/I"+(t=e[r]).index,t.objectId,"0","R")},s=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var t=this.internal.collections.addImage_images;return s.call(this),t},u=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(e){return"function"==typeof t["process"+e.toUpperCase()]},h=function(t){return"object"===(0,x.Z)(t)&&1===t.nodeType},f=function(e,n){if("IMG"===e.nodeName&&e.hasAttribute("src")){var r=""+e.getAttribute("src");if(0===r.indexOf("data:image/"))return xt(unescape(r).split("base64,").pop());var i=t.loadFile(r,!0);if(void 0!==i)return i}if("CANVAS"===e.nodeName){if(0===e.width||0===e.height)throw new Error("Given canvas must have data. Canvas width: "+e.width+", height: "+e.height);var o;switch(n){case"PNG":o="image/png";break;case"WEBP":o="image/webp";break;default:o="image/jpeg"}return xt(e.toDataURL(o,1).split("base64,").pop())}},p=function(t){var e=this.internal.collections.addImage_images;if(e)for(var n in e)if(t===e[n].alias)return e[n]},d=function(t,e,n){return t||e||(t=-96,e=-96),t<0&&(t=-1*n.width*72/t/this.internal.scaleFactor),e<0&&(e=-1*n.height*72/e/this.internal.scaleFactor),0===t&&(t=e*n.width/n.height),0===e&&(e=t*n.height/n.width),[t,e]},m=function(t,e,n,r,i,o){var a=d.call(this,n,r,i),s=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,c=l.call(this);if(n=a[0],r=a[1],c[i.index]=i,o){o*=Math.PI/180;var h=Math.cos(o),f=Math.sin(o),p=function(t){return t.toFixed(4)},m=[p(h),p(f),p(-1*f),p(h),0,0,"cm"]}this.internal.write("q"),o?(this.internal.write([1,"0","0",1,s(t),u(e+r),"cm"].join(" ")),this.internal.write(m.join(" ")),this.internal.write([s(n),"0","0",s(r),"0","0","cm"].join(" "))):this.internal.write([s(n),"0","0",s(r),s(t),u(e+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+i.index+" Do"),this.internal.write("Q")},g=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=t.__addimage__.sHashCode=function(t){var e,n,r=0;if("string"==typeof t)for(n=t.length,e=0;e<n;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;else if(S(t))for(n=t.byteLength/2,e=0;e<n;e++)r=(r<<5)-r+t[e],r|=0;return r},_=t.__addimage__.validateStringAsBase64=function(t){(t=t||"").toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+/]+$/.test(t.substr(0,t.length-2))&&(e=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(t.substr(-2))&&(e=!1),e},b=t.__addimage__.extractImageFromDataUrl=function(t){var e=(t=t||"").split("base64,"),n=null;if(2===e.length){var r=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(e[0]);Array.isArray(r)&&(n={mimeType:r[1],charset:r[2],data:e[1]})}return n},w=t.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};t.__addimage__.isArrayBuffer=function(t){return w()&&t instanceof ArrayBuffer};var S=t.__addimage__.isArrayBufferView=function(t){return w()&&"undefined"!=typeof Uint32Array&&(t instanceof Int8Array||t instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)},E=t.__addimage__.binaryStringToUint8Array=function(t){for(var e=t.length,n=new Uint8Array(e),r=0;r<e;r++)n[r]=t.charCodeAt(r);return n},k=t.__addimage__.arrayBufferToBinaryString=function(t){for(var e="",n=S(t)?t:new Uint8Array(t),r=0;r<n.length;r+=8192)e+=String.fromCharCode.apply(null,n.subarray(r,r+8192));return e};t.addImage=function(){var t,n,r,i,o,a,l,u,c;if("number"==typeof arguments[1]?(n=e,r=arguments[1],i=arguments[2],o=arguments[3],a=arguments[4],l=arguments[5],u=arguments[6],c=arguments[7]):(n=arguments[1],r=arguments[2],i=arguments[3],o=arguments[4],a=arguments[5],l=arguments[6],u=arguments[7],c=arguments[8]),"object"===(0,x.Z)(t=arguments[0])&&!h(t)&&"imageData"in t){var f=t;t=f.imageData,n=f.format||n||e,r=f.x||r||0,i=f.y||i||0,o=f.w||f.width||o,a=f.h||f.height||a,l=f.alias||l,u=f.compression||u,c=f.rotation||f.angle||c}var p=this.internal.getFilters();if(void 0===u&&-1!==p.indexOf("FlateEncode")&&(u="SLOW"),isNaN(r)||isNaN(i))throw new Error("Invalid coordinates passed to jsPDF.addImage");s.call(this);var d=C.call(this,t,n,l,u);return m.call(this,r,i,o,a,d,c),this};var C=function(n,i,o,a){var s,l,d;if("string"==typeof n&&r(n)===e){n=unescape(n);var m=I(n,!1);(""!==m||void 0!==(m=t.loadFile(n,!0)))&&(n=m)}if(h(n)&&(n=f(n,i)),i=r(n,i),!c(i))throw new Error("addImage does not support files of type '"+i+"', please ensure that a plugin for '"+i+"' support is added.");if((null==(d=o)||0===d.length)&&(o=function(t){return"string"==typeof t||S(t)?y(t):S(t.data)?y(t.data):null}(n)),(s=p.call(this,o))||(w()&&(n instanceof Uint8Array||"RGBA"===i||(l=n,n=E(n))),s=this["process"+i.toUpperCase()](n,u.call(this),o,function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in t.image_compression?e:v.NONE}(a),l)),!s)throw new Error("An unknown error occurred whilst processing the image.");return s},I=t.__addimage__.convertBase64ToBinaryString=function(t,e){var n;e="boolean"!=typeof e||e;var r,i="";if("string"==typeof t){r=null!==(n=b(t))?n.data:t;try{i=xt(r)}catch(t){if(e)throw _(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+t.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return i};t.getImageProperties=function(n){var i,o,a="";if(h(n)&&(n=f(n)),"string"==typeof n&&r(n)===e&&(""===(a=I(n,!1))&&(a=t.loadFile(n)||""),n=a),o=r(n),!c(o))throw new Error("addImage does not support files of type '"+o+"', please ensure that a plugin for '"+o+"' support is added.");if(!w()||n instanceof Uint8Array||(n=E(n)),!(i=this["process"+o.toUpperCase()](n)))throw new Error("An unknown error occurred whilst processing the image");return i.fileType=o,i}}(Xt.API),function(t){var e=function(t){if(void 0!==t&&""!=t)return!0};Xt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(t){for(var n,r,i,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,u=!1,c=0;c<l.length&&!u;c++)switch((n=l[c]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(0!=u){this.internal.write("/Annots [");for(var h=0;h<l.length;h++){n=l[h];var f=this.internal.pdfEscape,p=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var d=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(d.objId),v=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+o(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+f(g(n.contents))+")",i+=" /Popup "+m.objId+" 0 R",i+=" /P "+s.objId+" 0 R",i+=" /T ("+f(g(v))+") >>",d.content=i;var y=d.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+o(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(i+=" /Open true"),i+=" >>",m.content=i,this.internal.write(d.objId,"0 R",m.objId,"0 R");break;case"freetext":r="/Rect ["+o(n.bounds.x)+" "+a(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var _=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+f(p(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var x=this.annotations._nameMap[n.options.name];n.options.pageNumber=x.page,n.options.top=x.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+f(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var b=a(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+b+" "+n.options.zoom+"]"}""!=i&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},t.link=function(t,e,n,r,i){var o=this.internal.getCurrentPageInfo(),a=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:a(t),y:s(e),w:a(t+n),h:s(e+r)},options:i,type:"link"})},t.textWithLink=function(t,e,n,r){var i,o,a=this.getTextWidth(t),s=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){o=r.maxWidth;var l=this.splitTextToSize(t,o).length;i=Math.ceil(s*l)}else o=a,i=s;return this.text(t,e,n,r),n+=.2*s,"center"===r.align&&(e-=a/2),"right"===r.align&&(e-=a),this.link(e,n-s,o,i,r),a},t.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor}}(Xt.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==e[t.charCodeAt(0)]},a=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},s=t.__arabicParser__.isArabicEndLetter=function(t){return a(t)&&o(t)&&e[t.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(t){return a(t)&&i.indexOf(t.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){return a(t)&&o(t)&&e[t.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(t){return a(t)&&o(t)&&e[t.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(t){return a(t)&&o(t)&&e[t.charCodeAt(0)].length>=3};var c=t.__arabicParser__.arabicLetterHasMedialForm=function(t){return a(t)&&o(t)&&4==e[t.charCodeAt(0)].length},h=t.__arabicParser__.resolveLigatures=function(t){var e=0,r=n,i="",o=0;for(e=0;e<t.length;e+=1)void 0!==r[t.charCodeAt(e)]?(o++,"number"==typeof(r=r[t.charCodeAt(e)])&&(i+=String.fromCharCode(r),r=n,o=0),e===t.length-1&&(r=n,i+=t.charAt(e-(o-1)),e-=o-1,o=0)):(r=n,i+=t.charAt(e-o),e-=o,o=0);return i};t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==r[t.charCodeAt(0)]};var f=t.__arabicParser__.getCorrectForm=function(t,e,n){return a(t)?!1===o(t)?-1:!u(t)||!a(e)&&!a(n)||!a(n)&&s(e)||s(t)&&!a(e)||s(t)&&l(e)||s(t)&&s(e)?0:c(t)&&a(e)&&!s(e)&&a(n)&&u(n)?3:s(t)||!a(n)?1:2:-1},p=function(t){var n=0,r=0,i=0,o="",s="",l="",u=(t=t||"").split("\\s+"),c=[];for(n=0;n<u.length;n+=1){for(c.push(""),r=0;r<u[n].length;r+=1)o=u[n][r],s=u[n][r-1],l=u[n][r+1],a(o)?(i=f(o,s,l),c[n]+=-1!==i?String.fromCharCode(e[o.charCodeAt(0)][i]):o):c[n]+=o;c[n]=h(c[n])}return c.join(" ")},d=t.__arabicParser__.processArabic=t.processArabic=function(){var t,e="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(e)){var r=0;for(n=[],r=0;r<e.length;r+=1)Array.isArray(e[r])?n.push([p(e[r][0]),e[r][1],e[r][2]]):n.push([p(e[r])]);t=n}else t=p(e);return"string"==typeof arguments[0]?t:(arguments[0].text=t,arguments[0])};t.events.push(["preProcessText",d])}(Xt.API),Xt.API.autoPrint=function(t){var e;if("javascript"===((t=t||{}).variant=t.variant||"non-conform",t.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}));return this},function(t){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(e){t=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(t){e=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(t){n=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(t){r=t}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,e){var n;if("2d"!==(t=t||"2d"))return null;for(n in e)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=e[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Xt.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var t=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var e=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(t){n=t}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(t){r=t}});var i=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return i},set:function(t){i=t}});var o=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return o},set:function(t){o=t}});var a=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return a},set:function(t){a=t}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(t){return r.call(this),this.internal.__cell__.headerFunction="function"==typeof t?t:void 0,this},t.getTextDimensions=function(t,e){r.call(this);var n=(e=e||{}).fontSize||this.getFontSize(),i=e.font||this.getFont(),o=e.scaleFactor||this.internal.scaleFactor,a=0,s=0,l=0,u=this;if(!Array.isArray(t)&&"string"!=typeof t){if("number"!=typeof t)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");t=String(t)}var c=e.maxWidth;c>0?"string"==typeof t?t=this.splitTextToSize(t,c):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce((function(t,e){return t.concat(u.splitTextToSize(e,c))}),[])):t=Array.isArray(t)?t:[t];for(var h=0;h<t.length;h++)a<(l=this.getStringUnitWidth(t[h],{font:i})*n)&&(a=l);return 0!==a&&(s=t.length),{w:a/=o,h:Math.max((s*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/o,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var t=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(t.left,t.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var t;t=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var i=this.internal.__cell__.lastCell,a=this.internal.__cell__.padding,s=this.internal.__cell__.margins||e,l=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return void 0!==i.lineNumber&&(i.lineNumber===t.lineNumber?(t.x=(i.x||0)+(i.width||0),t.y=i.y||0):i.y+i.height+t.height+s.bottom>this.getPageHeight()?(this.cellAddPage(),t.y=s.top,u&&l&&(this.printHeaderRow(t.lineNumber,!0),t.y+=l[0].height)):t.y=i.y+i.height||t.y),void 0!==t.text[0]&&(this.rect(t.x,t.y,t.width,t.height,!0===n?"FD":void 0),"right"===t.align?this.text(t.text,t.x+t.width-a,t.y+a,{align:"right",baseline:"top"}):"center"===t.align?this.text(t.text,t.x+t.width/2,t.y+a,{align:"center",baseline:"top",maxWidth:t.width-a-a}):this.text(t.text,t.x+a,t.y+a,{align:"left",baseline:"top",maxWidth:t.width-a-a})),this.internal.__cell__.lastCell=t,this};t.table=function(t,n,l,u,c){if(r.call(this),!l)throw new Error("No data for PDF table.");var h,f,p,d,m=[],g=[],v=[],y={},_={},b=[],w=[],S=(c=c||{}).autoSize||!1,E=!1!==c.printHeaders,k=c.css&&void 0!==c.css["font-size"]?16*c.css["font-size"]:c.fontSize||12,C=c.margins||Object.assign({width:this.getPageWidth()},e),I="number"==typeof c.padding?c.padding:3,T=c.headerBackgroundColor||"#c8c8c8",P=c.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=k,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=P,this.setFontSize(k),null==u)g=m=Object.keys(l[0]),v=m.map((function(){return"left"}));else if(Array.isArray(u)&&"object"===(0,x.Z)(u[0]))for(m=u.map((function(t){return t.name})),g=u.map((function(t){return t.prompt||t.name||""})),v=u.map((function(t){return t.align||"left"})),h=0;h<u.length;h+=1)_[u[h].name]=u[h].width*(19.049976/25.4);else Array.isArray(u)&&"string"==typeof u[0]&&(g=m=u,v=m.map((function(){return"left"})));if(S||Array.isArray(u)&&"string"==typeof u[0])for(h=0;h<m.length;h+=1){for(y[d=m[h]]=l.map((function(t){return t[d]})),this.setFont(void 0,"bold"),b.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),f=y[d],this.setFont(void 0,"normal"),p=0;p<f.length;p+=1)b.push(this.getTextDimensions(f[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[d]=Math.max.apply(null,b)+I+I,b=[]}if(E){var A={};for(h=0;h<m.length;h+=1)A[m[h]]={},A[m[h]].text=g[h],A[m[h]].align=v[h];var M=s.call(this,A,_);w=m.map((function(e){return new o(t,n,_[e],M,A[e].text,void 0,A[e].align)})),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var L=u.reduce((function(t,e){return t[e.name]=e.align,t}),{});for(h=0;h<l.length;h+=1){"rowStart"in c&&c.rowStart instanceof Function&&c.rowStart({row:h,data:l[h]},this);var R=s.call(this,l[h],_);for(p=0;p<m.length;p+=1){var D=l[h][m[p]];"cellStart"in c&&c.cellStart instanceof Function&&c.cellStart({row:h,col:p,data:D},this),a.call(this,new o(t,n,_[m[p]],R,D,h+2,L[m[p]]))}}return this.internal.__cell__.table_x=t,this.internal.__cell__.table_y=n,this};var s=function(t,e){var n=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,i=this.internal.scaleFactor;return Object.keys(t).map((function(r){var i=t[r];return this.splitTextToSize(i.hasOwnProperty("text")?i.text:i,e[r]-n-n)}),this).map((function(t){return this.getLineHeightFactor()*t.length*r/i+n+n}),this).reduce((function(t,e){return Math.max(t,e)}),0)};t.setTableHeaderRow=function(t){r.call(this),this.internal.__cell__.tableHeaderRow=t},t.printHeaderRow=function(t,e){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var i;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var s=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(s[0],s[1],s[2],s[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){i=this.internal.__cell__.tableHeaderRow[u].clone(),e&&(i.y=this.internal.__cell__.margins.top||0,l.push(i)),i.lineNumber=t;var c=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,i),this.setTextColor(c)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),n=!1}}(Xt.API);var ze={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Oe=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Fe=Ne(Oe),Be=[100,200,300,400,500,600,700,800,900],je=Ne(Be);function Ue(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(t){return ze[t=t||"normal"]?t:"normal"}(t.style),r=function(t){return t?"number"==typeof t?t>=100&&t<=900&&t%100==0?t:400:/^\d00$/.test(t)?parseInt(t):"bold"===t?700:400:400}(t.weight),i=function(t){return"number"==typeof Fe[t=t||"normal"]?t:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function Ve(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var Ze={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},qe={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ge(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function We(t){return t.trimLeft()}function Xe(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function He(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===e?null:[e[0],t.substring(e[0].length)]}var Ye,$e,Ke,Je=["times"];!function(t){var e,n,r,i,o,a,s,l,u,c=function(t){return t=t||{},this.isStrokeTransparent=t.isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new l,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new a,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new a,this.lineDashOffset=t.lineDashOffset||0,this.lineDash=t.lineDash||[],this.margin=t.margin||[0,0,0,0],this.prevPageLastElemOffset=t.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,a=this.internal.Point,s=this.internal.Rectangle,l=this.internal.Matrix,u=new c}]);var h=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e=t;Object.defineProperty(this,"pdf",{get:function(){return e}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(t){n=Boolean(t)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(t){r=Boolean(t)}});var i=0;Object.defineProperty(this,"posX",{get:function(){return i},set:function(t){isNaN(t)||(i=t)}});var o=0;Object.defineProperty(this,"posY",{get:function(){return o},set:function(t){isNaN(t)||(o=t)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(t){var e;"number"==typeof t?e=[t,t,t,t]:((e=new Array(4))[0]=t[0],e[1]=t.length>=2?t[1]:e[0],e[2]=t.length>=3?t[2]:e[0],e[3]=t.length>=4?t[3]:e[1]),u.margin=e}});var a=!1;Object.defineProperty(this,"autoPaging",{get:function(){return a},set:function(t){a=t}});var s=0;Object.defineProperty(this,"lastBreak",{get:function(){return s},set:function(t){s=t}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(t){l=t}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(t){t instanceof c&&(u=t)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(t){u.path=t}});var h=[];Object.defineProperty(this,"ctxStack",{get:function(){return h},set:function(t){h=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){var e;e=f(t),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){var e=f(t);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}});var p=null;function d(t,e){if(null===p){var n=function(t){var e=[];return Object.keys(t).forEach((function(n){t[n].forEach((function(t){var r=null;switch(t){case"bold":r={family:n,weight:"bold"};break;case"italic":r={family:n,style:"italic"};break;case"bolditalic":r={family:n,weight:"bold",style:"italic"};break;case"":case"normal":r={family:n}}null!==r&&(r.ref={name:n,style:t},e.push(r))}))})),e}(t.getFontList());p=function(t){for(var e={},n=0;n<t.length;++n){var r=Ue(t[n]),i=r.family,o=r.stretch,a=r.style,s=r.weight;e[i]=e[i]||{},e[i][o]=e[i][o]||{},e[i][o][a]=e[i][o][a]||{},e[i][o][a][s]=r}return e}(n.concat(e))}return p}var m=null;Object.defineProperty(this,"fontFaces",{get:function(){return m},set:function(t){p=null,m=t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){var e;if(this.ctx.font=t,null!==(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(t))){var n=e[1],r=(e[2],e[3]),i=e[4],o=(e[5],e[6]),a=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(i)[2];i="px"===a?Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor):"em"===a?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(i);var s=function(t){var e,n,r=[],i=t.trim();if(""===i)return Je;if(i in qe)return[qe[i]];for(;""!==i;){switch(n=null,e=(i=We(i)).charAt(0)){case'"':case"'":n=Xe(i.substring(1),e);break;default:n=He(i)}if(null===n)return Je;if(r.push(n[0]),""!==(i=We(n[1]))&&","!==i.charAt(0))return Je;i=i.replace(/^,/,"")}return r}(o);if(this.fontFaces){var l=function(t,e,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},Ze,n.genericFontFamilies||{}),o=null,a=null,s=0;s<e.length;++s)if(i[(o=Ue(e[s])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){a=t[o.family];break}if(!(a=a||t[r]))throw new Error("Could not find a font-family for the rule '"+Ge(o)+"' and default family '"+r+"'.");if(a=function(t,e){if(e[t])return e[t];var n=Fe[t],r=n<=Fe.normal?-1:1,i=Ve(e,Oe,n,r);if(!i)throw new Error("Could not find a matching font-stretch value for "+t);return i}(o.stretch,a),a=function(t,e){if(e[t])return e[t];for(var n=ze[t],r=0;r<n.length;++r)if(e[n[r]])return e[n[r]];throw new Error("Could not find a matching font-style for "+t)}(o.style,a),!(a=function(t,e){if(e[t])return e[t];if(400===t&&e[500])return e[500];if(500===t&&e[400])return e[400];var n=je[t],r=Ve(e,Be,n,t<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+t);return r}(o.weight,a)))throw new Error("Failed to resolve a font for the rule '"+Ge(o)+"'.");return a}(d(this.pdf,this.fontFaces),s.map((function(t){return{family:t,stretch:"normal",weight:r,style:n}})));this.pdf.setFont(l.ref.name,l.ref.style)}else{var u="";("bold"===r||parseInt(r,10)>=700||"bold"===n)&&(u="bold"),"italic"===n&&(u+="italic"),0===u.length&&(u="normal");for(var c="",h={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},f=0;f<s.length;f++){if(void 0!==this.pdf.internal.getFont(s[f],u,{noFallback:!0,disableWarning:!0})){c=s[f];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(s[f],"bold",{noFallback:!0,disableWarning:!0}))c=s[f],u="bold";else if(void 0!==this.pdf.internal.getFont(s[f],"normal",{noFallback:!0,disableWarning:!0})){c=s[f],u="normal";break}}if(""===c)for(var p=0;p<s.length;p++)if(h[s[p]]){c=h[s[p]];break}c=""===c?"Times":c,this.pdf.setFont(c,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(t){this.ctx.lineDashOffset=t,F.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(t){this.ctx.lineDash=t,F.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};h.prototype.setLineDash=function(t){this.lineDash=t},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){b.call(this,"fill",!1)},h.prototype.stroke=function(){b.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw gt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new a(t,e)},h.prototype.closePath=function(){var t=new a(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===(0,x.Z)(this.path[e+1])&&"number"==typeof this.path[e+1].x){t=new a(this.path[e+1].x,this.path[e+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(t.x,t.y)},h.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw gt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new a(n.x,n.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},h.prototype.quadraticCurveTo=function(t,e,n,r){if(isNaN(n)||isNaN(r)||isNaN(t)||isNaN(e))throw gt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var i=this.ctx.transform.applyToPoint(new a(n,r)),o=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"qct",x1:o.x,y1:o.y,x:i.x,y:i.y}),this.ctx.lastPoint=new a(i.x,i.y)},h.prototype.bezierCurveTo=function(t,e,n,r,i,o){if(isNaN(i)||isNaN(o)||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r))throw gt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var s=this.ctx.transform.applyToPoint(new a(i,o)),l=this.ctx.transform.applyToPoint(new a(t,e)),u=this.ctx.transform.applyToPoint(new a(n,r));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:u.x,y2:u.y,x:s.x,y:s.y}),this.ctx.lastPoint=new a(s.x,s.y)},h.prototype.arc=function(t,e,n,r,i,o){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i))throw gt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(o=Boolean(o),!this.ctx.transform.isIdentity){var s=this.ctx.transform.applyToPoint(new a(t,e));t=s.x,e=s.y;var l=this.ctx.transform.applyToPoint(new a(0,n)),u=this.ctx.transform.applyToPoint(new a(0,0));n=Math.sqrt(Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2))}Math.abs(i-r)>=2*Math.PI&&(r=0,i=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:n,startAngle:r,endAngle:i,counterclockwise:o})},h.prototype.arcTo=function(t,e,n,r,i){throw new Error("arcTo not implemented.")},h.prototype.rect=function(t,e,n,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r))throw gt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+r),this.lineTo(t,e+r),this.lineTo(t,e),this.lineTo(t+n,e),this.lineTo(t,e)},h.prototype.fillRect=function(t,e,n,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r))throw gt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var i={};"butt"!==this.lineCap&&(i.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(i.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,n,r),this.fill(),i.hasOwnProperty("lineCap")&&(this.lineCap=i.lineCap),i.hasOwnProperty("lineJoin")&&(this.lineJoin=i.lineJoin)}},h.prototype.strokeRect=function(t,e,n,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r))throw gt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");d.call(this)||(this.beginPath(),this.rect(t,e,n,r),this.stroke())},h.prototype.clearRect=function(t,e,n,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r))throw gt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,n,r))},h.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),t){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},h.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(t){var e,n,r,i;if(!0===t.isCanvasGradient&&(t=t.getColor()),!t)return{r:0,g:0,b:0,a:0,style:t};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t))e=0,n=0,r=0,i=0;else{var o=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t);if(null!==o)e=parseInt(o[1]),n=parseInt(o[2]),r=parseInt(o[3]),i=1;else if(null!==(o=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(t)))e=parseInt(o[1]),n=parseInt(o[2]),r=parseInt(o[3]),i=parseFloat(o[4]);else{if(i=1,"string"==typeof t&&"#"!==t.charAt(0)){var a=new St(t);t=a.ok?a.toHex():"#000000"}4===t.length?(e=t.substring(1,2),e+=e,n=t.substring(2,3),n+=n,r=t.substring(3,4),r+=r):(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7)),e=parseInt(e,16),n=parseInt(n,16),r=parseInt(r,16)}}return{r:e,g:n,b:r,a:i,style:t}},p=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},d=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};h.prototype.fillText=function(t,e,n,r){if(isNaN(e)||isNaN(n)||"string"!=typeof t)throw gt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!p.call(this)){var i=N(this.ctx.transform.rotation),o=this.ctx.transform.scaleX;P.call(this,{text:t,x:e,y:n,scale:o,angle:i,align:this.textAlign,maxWidth:r})}},h.prototype.strokeText=function(t,e,n,r){if(isNaN(e)||isNaN(n)||"string"!=typeof t)throw gt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!d.call(this)){r=isNaN(r)?void 0:r;var i=N(this.ctx.transform.rotation),o=this.ctx.transform.scaleX;P.call(this,{text:t,x:e,y:n,scale:o,renderingMode:"stroke",angle:i,align:this.textAlign,maxWidth:r})}},h.prototype.measureText=function(t){if("string"!=typeof t)throw gt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,n=this.pdf.internal.scaleFactor,r=e.internal.getFontSize(),i=e.getStringUnitWidth(t)*r/e.internal.scaleFactor,o=function(t){var e=(t=t||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this};return new o({width:i*=Math.round(96*n/72*1e4)/1e4})},h.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw gt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new l(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},h.prototype.rotate=function(t){if(isNaN(t))throw gt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new l(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},h.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw gt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new l(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(n)},h.prototype.transform=function(t,e,n,r,i,o){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(o))throw gt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var a=new l(t,e,n,r,i,o);this.ctx.transform=this.ctx.transform.multiply(a)},h.prototype.setTransform=function(t,e,n,r,i,o){t=isNaN(t)?1:t,e=isNaN(e)?0:e,n=isNaN(n)?0:n,r=isNaN(r)?1:r,i=isNaN(i)?0:i,o=isNaN(o)?0:o,this.ctx.transform=new l(t,e,n,r,i,o)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(t,e,n,r,i,o,a,u,c){var h=this.pdf.getImageProperties(t),f=1,p=1,d=1,v=1;void 0!==r&&void 0!==u&&(d=u/r,v=c/i,f=h.width/r*u/r,p=h.height/i*c/i),void 0===o&&(o=e,a=n,e=0,n=0),void 0!==r&&void 0===u&&(u=r,c=i),void 0===r&&void 0===u&&(u=h.width,c=h.height);for(var x,b=this.ctx.transform.decompose(),S=N(b.rotate.shx),E=new l,k=(E=(E=(E=E.multiply(b.translate)).multiply(b.skew)).multiply(b.scale)).applyToRectangle(new s(o-e*d,a-n*v,r*f,i*p)),C=g.call(this,k),I=[],T=0;T<C.length;T+=1)-1===I.indexOf(C[T])&&I.push(C[T]);if(_(I),this.autoPaging)for(var P=I[0],A=I[I.length-1],M=P;M<A+1;M++){this.pdf.setPage(M);var L=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],R=1===M?this.posY+this.margin[0]:this.margin[0],D=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],z=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],O=1===M?0:D+(M-2)*z;if(0!==this.ctx.clip_path.length){var F=this.path;x=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(x,this.posX+this.margin[3],-O+R+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=F}var B=JSON.parse(JSON.stringify(k));B=y([B],this.posX+this.margin[3],-O+R+this.ctx.prevPageLastElemOffset)[0];var j=(M>P||M<A)&&m.call(this);j&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],L,z,null).clip().discardPath()),this.pdf.addImage(t,"JPEG",B.x,B.y,B.w,B.h,null,null,S),j&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(t,"JPEG",k.x,k.y,k.w,k.h,null,null,S)};var g=function(t,e,n){var r=[];e=e||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var i=this.posY+this.ctx.prevPageLastElemOffset;switch(t.type){default:case"mt":case"lt":r.push(Math.floor((t.y+i)/n)+1);break;case"arc":r.push(Math.floor((t.y+i-t.radius)/n)+1),r.push(Math.floor((t.y+i+t.radius)/n)+1);break;case"qct":var o=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);r.push(Math.floor((o.y+i)/n)+1),r.push(Math.floor((o.y+o.h+i)/n)+1);break;case"bct":var a=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);r.push(Math.floor((a.y+i)/n)+1),r.push(Math.floor((a.y+a.h+i)/n)+1);break;case"rect":r.push(Math.floor((t.y+i)/n)+1),r.push(Math.floor((t.y+t.h+i)/n)+1)}for(var s=0;s<r.length;s+=1)for(;this.pdf.internal.getNumberOfPages()<r[s];)v.call(this);return r},v=function(){var t=this.fillStyle,e=this.strokeStyle,n=this.font,r=this.lineCap,i=this.lineWidth,o=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=n,this.lineCap=r,this.lineWidth=i,this.lineJoin=o},y=function(t,e,n){for(var r=0;r<t.length;r++)switch(t[r].type){case"bct":t[r].x2+=e,t[r].y2+=n;case"qct":t[r].x1+=e,t[r].y1+=n;default:t[r].x+=e,t[r].y+=n}return t},_=function(t){return t.sort((function(t,e){return t-e}))},b=function(t,e){for(var n,r,i=this.fillStyle,o=this.strokeStyle,a=this.lineCap,s=this.lineWidth,l=Math.abs(s*this.ctx.transform.scaleX),u=this.lineJoin,c=JSON.parse(JSON.stringify(this.path)),h=JSON.parse(JSON.stringify(this.path)),f=[],p=0;p<h.length;p++)if(void 0!==h[p].x)for(var d=g.call(this,h[p]),x=0;x<d.length;x+=1)-1===f.indexOf(d[x])&&f.push(d[x]);for(var b=0;b<f.length;b++)for(;this.pdf.internal.getNumberOfPages()<f[b];)v.call(this);if(_(f),this.autoPaging)for(var S=f[0],E=f[f.length-1],k=S;k<E+1;k++){this.pdf.setPage(k),this.fillStyle=i,this.strokeStyle=o,this.lineCap=a,this.lineWidth=l,this.lineJoin=u;var C=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],I=1===k?this.posY+this.margin[0]:this.margin[0],T=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],P=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],A=1===k?0:T+(k-2)*P;if(0!==this.ctx.clip_path.length){var M=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(n,this.posX+this.margin[3],-A+I+this.ctx.prevPageLastElemOffset),w.call(this,t,!0),this.path=M}if(r=JSON.parse(JSON.stringify(c)),this.path=y(r,this.posX+this.margin[3],-A+I+this.ctx.prevPageLastElemOffset),!1===e||0===k){var L=(k>S||k<E)&&m.call(this);L&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],C,P,null).clip().discardPath()),w.call(this,t,e),L&&this.pdf.restoreGraphicsState()}this.lineWidth=s}else this.lineWidth=l,w.call(this,t,e),this.lineWidth=s;this.path=c},w=function(t,e){if(("stroke"!==t||e||!d.call(this))&&("stroke"===t||e||!p.call(this))){for(var n,r,i=[],o=this.path,a=0;a<o.length;a++){var s=o[a];switch(s.type){case"begin":i.push({begin:!0});break;case"close":i.push({close:!0});break;case"mt":i.push({start:s,deltas:[],abs:[]});break;case"lt":var l=i.length;if(o[a-1]&&!isNaN(o[a-1].x)&&(n=[s.x-o[a-1].x,s.y-o[a-1].y],l>0))for(;l>=0;l--)if(!0!==i[l-1].close&&!0!==i[l-1].begin){i[l-1].deltas.push(n),i[l-1].abs.push(s);break}break;case"bct":n=[s.x1-o[a-1].x,s.y1-o[a-1].y,s.x2-o[a-1].x,s.y2-o[a-1].y,s.x-o[a-1].x,s.y-o[a-1].y],i[i.length-1].deltas.push(n);break;case"qct":var u=o[a-1].x+2/3*(s.x1-o[a-1].x),c=o[a-1].y+2/3*(s.y1-o[a-1].y),h=s.x+2/3*(s.x1-s.x),f=s.y+2/3*(s.y1-s.y),m=s.x,g=s.y;n=[u-o[a-1].x,c-o[a-1].y,h-o[a-1].x,f-o[a-1].y,m-o[a-1].x,g-o[a-1].y],i[i.length-1].deltas.push(n);break;case"arc":i.push({deltas:[],abs:[],arc:!0}),Array.isArray(i[i.length-1].abs)&&i[i.length-1].abs.push(s)}}r=e?null:"stroke"===t?"stroke":"fill";for(var v=!1,y=0;y<i.length;y++)if(i[y].arc)for(var _=i[y].abs,x=0;x<_.length;x++){var b=_[x];"arc"===b.type?k.call(this,b.x,b.y,b.radius,b.startAngle,b.endAngle,b.counterclockwise,void 0,e,!v):A.call(this,b.x,b.y),v=!0}else if(!0===i[y].close)this.pdf.internal.out("h"),v=!1;else if(!0!==i[y].begin){var w=i[y].start.x,S=i[y].start.y;M.call(this,i[y].deltas,w,S),v=!0}r&&C.call(this,r),e&&I.call(this)}},S=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-n;case"top":return t+e-n;case"hanging":return t+e-2*n;case"middle":return t+e/2-n;default:return t}},E=function(t){return t+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var t=function(){};return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(t,e,n,r,i,o,a,s,l){for(var u=R.call(this,n,r,i,o),c=0;c<u.length;c++){var h=u[c];0===c&&(l?T.call(this,h.x1+t,h.y1+e):A.call(this,h.x1+t,h.y1+e)),L.call(this,t,e,h.x2,h.y2,h.x3,h.y3,h.x4,h.y4)}s?I.call(this):C.call(this,a)},C=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(t,e){this.pdf.internal.out(n(t)+" "+r(e)+" m")},P=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;default:e="left"}var n=this.pdf.getTextDimensions(t.text),r=S.call(this,t.y),i=E.call(this,r)-n.h,o=this.ctx.transform.applyToPoint(new a(t.x,r)),u=this.ctx.transform.decompose(),c=new l;c=(c=(c=c.multiply(u.translate)).multiply(u.skew)).multiply(u.scale);for(var h,f,p,d=this.ctx.transform.applyToRectangle(new s(t.x,r,n.w,n.h)),v=c.applyToRectangle(new s(t.x,i,n.w,n.h)),x=g.call(this,v),b=[],k=0;k<x.length;k+=1)-1===b.indexOf(x[k])&&b.push(x[k]);if(_(b),this.autoPaging)for(var C=b[0],I=b[b.length-1],T=C;T<I+1;T++){this.pdf.setPage(T);var P=1===T?this.posY+this.margin[0]:this.margin[0],A=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],M=this.pdf.internal.pageSize.height-this.margin[2],L=M-this.margin[0],R=this.pdf.internal.pageSize.width-this.margin[1],D=R-this.margin[3],N=1===T?0:A+(T-2)*L;if(0!==this.ctx.clip_path.length){var z=this.path;h=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(h,this.posX+this.margin[3],-1*N+P),w.call(this,"fill",!0),this.path=z}var O=y([JSON.parse(JSON.stringify(v))],this.posX+this.margin[3],-N+P+this.ctx.prevPageLastElemOffset)[0];t.scale>=.01&&(f=this.pdf.internal.getFontSize(),this.pdf.setFontSize(f*t.scale),p=this.lineWidth,this.lineWidth=p*t.scale);var F="text"!==this.autoPaging;if(F||O.y+O.h<=M){if(F||O.y>=P&&O.x<=R){var B=F?t.text:this.pdf.splitTextToSize(t.text,t.maxWidth||R-O.x)[0],j=y([JSON.parse(JSON.stringify(d))],this.posX+this.margin[3],-N+P+this.ctx.prevPageLastElemOffset)[0],U=F&&(T>C||T<I)&&m.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,L,null).clip().discardPath()),this.pdf.text(B,j.x,j.y,{angle:t.angle,align:e,renderingMode:t.renderingMode}),U&&this.pdf.restoreGraphicsState()}}else O.y<M&&(this.ctx.prevPageLastElemOffset+=M-O.y);t.scale>=.01&&(this.pdf.setFontSize(f),this.lineWidth=p)}else t.scale>=.01&&(f=this.pdf.internal.getFontSize(),this.pdf.setFontSize(f*t.scale),p=this.lineWidth,this.lineWidth=p*t.scale),this.pdf.text(t.text,o.x+this.posX,o.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&(this.pdf.setFontSize(f),this.lineWidth=p)},A=function(t,e,i,o){i=i||0,o=o||0,this.pdf.internal.out(n(t+i)+" "+r(e+o)+" l")},M=function(t,e,n){return this.pdf.lines(t,e,n,null,null)},L=function(t,n,r,a,s,l,u,c){this.pdf.internal.out([e(i(r+t)),e(o(a+n)),e(i(s+t)),e(o(l+n)),e(i(u+t)),e(o(c+n)),"c"].join(" "))},R=function(t,e,n,r){for(var i=2*Math.PI,o=Math.PI/2;e>n;)e-=i;var a=Math.abs(n-e);a<i&&r&&(a=i-a);for(var s=[],l=r?-1:1,u=e;a>1e-5;){var c=u+l*Math.min(a,o);s.push(D.call(this,t,u,c)),a-=Math.abs(c-u),u=c}return s},D=function(t,e,n){var r=(n-e)/2,i=t*Math.cos(r),o=t*Math.sin(r),a=i,s=-o,l=a*a+s*s,u=l+a*i+s*o,c=4/3*(Math.sqrt(2*l*u)-u)/(a*o-s*i),h=a-c*s,f=s+c*a,p=h,d=-f,m=r+e,g=Math.cos(m),v=Math.sin(m);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:h*g-f*v,y2:h*v+f*g,x3:p*g-d*v,y3:p*v+d*g,x4:t*Math.cos(n),y4:t*Math.sin(n)}},N=function(t){return 180*t/Math.PI},z=function(t,e,n,r,i,o){var a=t+.5*(n-t),l=e+.5*(r-e),u=i+.5*(n-i),c=o+.5*(r-o),h=Math.min(t,i,a,u),f=Math.max(t,i,a,u),p=Math.min(e,o,l,c),d=Math.max(e,o,l,c);return new s(h,p,f-h,d-p)},O=function(t,e,n,r,i,o,a,l){var u,c,h,f,p,d,m,g,v,y,_,x,b,w,S=n-t,E=r-e,k=i-n,C=o-r,I=a-i,T=l-o;for(c=0;c<41;c++)v=(m=(h=t+(u=c/40)*S)+u*((p=n+u*k)-h))+u*(p+u*(i+u*I-p)-m),y=(g=(f=e+u*E)+u*((d=r+u*C)-f))+u*(d+u*(o+u*T-d)-g),0==c?(_=v,x=y,b=v,w=y):(_=Math.min(_,v),x=Math.min(x,y),b=Math.max(b,v),w=Math.max(w,y));return new s(Math.round(_),Math.round(x),Math.round(b-_),Math.round(w-x))},F=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var t,e,n=(t=this.ctx.lineDash,e=this.ctx.lineDashOffset,JSON.stringify({lineDash:t,lineDashOffset:e}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(Xt.API),function(t){var e=function(t){var e,n,r,i,o,a,s,l,u,c;for(/[^\x00-\xFF]/.test(t),n=[],r=0,i=(t+=e="\0\0\0\0".slice(t.length%4||4)).length;i>r;r+=4)0!==(o=(t.charCodeAt(r)<<24)+(t.charCodeAt(r+1)<<16)+(t.charCodeAt(r+2)<<8)+t.charCodeAt(r+3))?(a=(o=((o=((o=((o=(o-(c=o%85))/85)-(u=o%85))/85)-(l=o%85))/85)-(s=o%85))/85)%85,n.push(a+33,s+33,l+33,u+33,c+33)):n.push(122);return function(t,e){for(var n=e;n>0;n--)t.pop()}(n,e.length),String.fromCharCode.apply(String,n)+"~>"},n=function(t){var e,n,r,i,o,a=String,s="length",l=255,u="charCodeAt",c="slice",h="replace";for(t[c](-2),t=t[c](0,-2)[h](/\s/g,"")[h]("z","!!!!!"),r=[],i=0,o=(t+=e="uuuuu"[c](t[s]%5||5))[s];o>i;i+=5)n=52200625*(t[u](i)-33)+614125*(t[u](i+1)-33)+7225*(t[u](i+2)-33)+85*(t[u](i+3)-33)+(t[u](i+4)-33),r.push(l&n>>24,l&n>>16,l&n>>8,l&n);return function(t,e){for(var n=e;n>0;n--)t.pop()}(r,e[s]),a.fromCharCode.apply(a,r)},r=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(t=t.replace(/\s/g,"")).indexOf(">")&&(t=t.substr(0,t.indexOf(">"))),t.length%2&&(t+="0"),!1===e.test(t))return"";for(var n="",r=0;r<t.length;r+=2)n+=String.fromCharCode("0x"+(t[r]+t[r+1]));return n},i=function(t){for(var e=new Uint8Array(t.length),n=t.length;n--;)e[n]=t.charCodeAt(n);return(e=ft(e)).reduce((function(t,e){return t+String.fromCharCode(e)}),"")};t.processDataByFilters=function(t,o){var a=0,s=t||"",l=[];for("string"==typeof(o=o||[])&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":s=n(s),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":s=e(s),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":s=r(s),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":s=s.split("").map((function(t){return("0"+t.charCodeAt().toString(16)).slice(-2)})).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":s=i(s),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:s,reverseChain:l.reverse().join(" ")}}}(Xt.API),function(t){t.loadFile=function(t,e,n){return function(t,e,n){e=!1!==e,n="function"==typeof n?n:function(){};var r=void 0;try{r=function(t,e,n){var r=new XMLHttpRequest,i=0,o=function(t){var e=t.length,n=[],r=String.fromCharCode;for(i=0;i<e;i+=1)n.push(r(255&t.charCodeAt(i)));return n.join("")};if(r.open("GET",t,!e),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(r.onload=function(){200===r.status?n(o(this.responseText)):n(void 0)}),r.send(null),e&&200===r.status)return o(r.responseText)}(t,e,n)}catch(t){}return r}(t,e,n)},t.loadImageFile=t.loadFile}(Xt.API),function(t){function e(){return(dt.html2canvas?Promise.resolve(dt.html2canvas):n.e(498).then(n.t.bind(n,5498,23))).catch((function(t){return Promise.reject(new Error("Could not load html2canvas: "+t))})).then((function(t){return t.default?t.default:t}))}function r(){return(dt.DOMPurify?Promise.resolve(dt.DOMPurify):n.e(703).then(n.t.bind(n,8703,23))).catch((function(t){return Promise.reject(new Error("Could not load dompurify: "+t))})).then((function(t){return t.default?t.default:t}))}var i=function(t){var e=(0,x.Z)(t);return"undefined"===e?"undefined":"string"===e||t instanceof String?"string":"number"===e||t instanceof Number?"number":"function"===e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===e?"object":"unknown"},o=function(t,e){var n=document.createElement(t);for(var r in e.className&&(n.className=e.className),e.innerHTML&&e.dompurify&&(n.innerHTML=e.dompurify.sanitize(e.innerHTML)),e.style)n.style[r]=e.style[r];return n},a=function t(e){var n=Object.assign(t.convert(Promise.resolve()),JSON.parse(JSON.stringify(t.template))),r=t.convert(Promise.resolve(),n);return(r=r.setProgress(1,t,1,[t])).set(e)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(t,e){return t.__proto__=e||a.prototype,t},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(t,e){return this.then((function(){switch(e=e||function(t){switch(i(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(t)){case"string":return this.then(r).then((function(e){return this.set({src:o("div",{innerHTML:t,dompurify:e})})}));case"element":return this.set({src:t});case"canvas":return this.set({canvas:t});case"img":return this.set({img:t});default:return this.error("Unknown source type.")}}))},a.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var t={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e=function t(e,n){for(var r=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),i=e.firstChild;i;i=i.nextSibling)!0!==n&&1===i.nodeType&&"SCRIPT"===i.nodeName||r.appendChild(t(i,n));return 1===e.nodeType&&("CANVAS"===e.nodeName?(r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(r.value=e.value),r.addEventListener("load",(function(){r.scrollTop=e.scrollTop,r.scrollLeft=e.scrollLeft}),!0)),r}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},a.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then((function(t){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,t(this.prop.container,e)})).then((function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)}))},a.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then((function(t){var e=this.opt.jsPDF,n=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,i=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete i.onrendered,e.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.margin=this.opt.margin,e.context2d.fontFaces=n,n)for(var o=0;o<n.length;++o){var a=n[o],s=a.src.find((function(t){return"truetype"===t.format}));s&&e.addFont(s.url,a.ref.name,a.ref.style)}return i.windowHeight=i.windowHeight||0,i.windowHeight=0==i.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):i.windowHeight,e.context2d.save(!0),t(this.prop.container,i)})).then((function(t){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)}))},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t}))},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},a.prototype.output=function(t,e,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},a.prototype.outputPdf=function(t,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(t,e)}))},a.prototype.outputImg=function(t){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}}))},a.prototype.save=function(t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t?{filename:t}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},a.prototype.set=function(t){if("object"!==i(t))return this;var e=Object.keys(t||{}).map((function(e){if(e in a.template.prop)return function(){this.prop[e]=t[e]};switch(e){case"margin":return this.setMargin.bind(this,t.margin);case"jsPDF":return function(){return this.opt.jsPDF=t.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t.pageSize);default:return function(){this.opt[e]=t[e]}}}),this);return this.then((function(){return this.thenList(e)}))},a.prototype.get=function(t,e){return this.then((function(){var n=t in a.template.prop?this.prop[t]:this.opt[t];return e?e(n):n}))},a.prototype.setMargin=function(t){return this.then((function(){switch(i(t)){case"number":t=[t,t,t,t];case"array":if(2===t.length&&(t=[t[0],t[1],t[0],t[1]]),4===t.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t})).then(this.setPageSize)},a.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then((function(){(t=t||Xt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t}))},a.prototype.setProgress=function(t,e,n,r){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=n&&(this.progress.n=n),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(t,e,n,r){return this.setProgress(t?this.progress.val+t:null,e||null,n?this.progress.n+n:null,r?this.progress.stack.concat(r):null)},a.prototype.then=function(t,e){var n=this;return this.thenCore(t,e,(function(t,e){return n.updateProgress(null,null,1,[t]),Promise.prototype.then.call(this,(function(e){return n.updateProgress(null,t),e})).then(t,e).then((function(t){return n.updateProgress(1),t}))}))},a.prototype.thenCore=function(t,e,n){n=n||Promise.prototype.then,t&&(t=t.bind(this)),e&&(e=e.bind(this));var r=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:a.convert(Object.assign({},this),Promise.prototype),i=n.call(r,t,e);return a.convert(i,this.__proto__)},a.prototype.thenExternal=function(t,e){return Promise.prototype.then.call(this,t,e)},a.prototype.thenList=function(t){var e=this;return t.forEach((function(t){e=e.thenCore(t)})),e},a.prototype.catch=function(t){t&&(t=t.bind(this));var e=Promise.prototype.catch.call(this,t);return a.convert(e,this)},a.prototype.catchExternal=function(t){return Promise.prototype.catch.call(this,t)},a.prototype.error=function(t){return this.then((function(){throw new Error(t)}))},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Xt.getPageSize=function(t,e,n){if("object"===(0,x.Z)(t)){var r=t;t=r.orientation,e=r.unit||e,n=r.format||n}e=e||"mm",n=n||"a4",t=(""+(t||"P")).toLowerCase();var i,o=(""+n).toLowerCase(),a={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":i=1;break;case"mm":i=72/25.4;break;case"cm":i=72/2.54;break;case"in":i=72;break;case"px":i=.75;break;case"pc":case"em":i=12;break;case"ex":i=6;break;default:throw"Invalid unit: "+e}var s,l=0,u=0;if(a.hasOwnProperty(o))l=a[o][1]/i,u=a[o][0]/i;else try{l=n[1],u=n[0]}catch(tk){throw new Error("Invalid format: "+n)}if("p"===t||"portrait"===t)t="p",u>l&&(s=u,u=l,l=s);else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;t="l",l>u&&(s=u,u=l,l=s)}return{width:u,height:l,unit:e,k:i,orientation:t}},t.html=function(t,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this,e.fontFaces=e.fontFaces?e.fontFaces.map(Ue):null;var n=new a(e);return e.worker?n:n.from(t).doCallback()}}(Xt.API),Xt.API.addJS=function(t){return Ke=t,this.internal.events.subscribe("postPutResources",(function(){Ye=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ye+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),$e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ke+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==Ye&&void 0!==$e&&this.internal.out("/Names <</JavaScript "+Ye+" 0 R>>")})),this},function(t){var e;t.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),i=0;i<r.length;i++){var o=r[i],a=n.exec(o);if(null!=a){var s=a[1];t.internal.newObjectDeferredBegin(s,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,u=[];for(i=0;i<l;i++){var c=t.internal.newObject();u.push(c);var h=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<u.length;i++)t.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(t,e,n){var r={title:e,options:n,children:[]};return null==t&&(t=this.root),t.children.push(r),r},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(e){e.id=t.internal.newObjectDeferred();for(var n=0;n<e.children.length;n++)this.genIds_r(e.children[n])},t.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),t.children.length>0&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},t.outline.renderItems=function(e){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<e.children.length;r++){var i=e.children[r];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(e)),r>0&&this.line("/Prev "+this.makeRef(e.children[r-1])),r<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[r+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var a=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var s=0;s<e.children.length;s++)this.renderItems(e.children[s])},t.outline.line=function(t){this.ctx.val+=t+"\r\n"},t.outline.makeRef=function(t){return t.id+" 0 R"},t.outline.makeString=function(e){return"("+t.internal.pdfEscape(e)+")"},t.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},t.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},t.outline.count_r=function(t,e){for(var n=0;n<e.children.length;n++)t.count++,this.count_r(t,e.children[n]);return t.count}}])}(Xt.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(t,n,r,i,o,a){var s,l=this.decode.DCT_DECODE,u=null;if("string"==typeof t||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(s=function(t){for(var n,r=256*t.charCodeAt(4)+t.charCodeAt(5),i=t.length,o={width:0,height:0,numcomponents:1},a=4;a<i;a+=2){if(a+=r,-1!==e.indexOf(t.charCodeAt(a+1))){n=256*t.charCodeAt(a+5)+t.charCodeAt(a+6),o={width:256*t.charCodeAt(a+7)+t.charCodeAt(a+8),height:n,numcomponents:t.charCodeAt(a+9)};break}r=256*t.charCodeAt(a+2)+t.charCodeAt(a+3)}return o}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}u={data:t,width:s.width,height:s.height,colorSpace:a,bitsPerComponent:8,filter:l,index:n,alias:r}}return u}}(Xt.API);var Qe,tn,en,nn,rn,on=function(){var t,e,n;function r(t){var e,n,r,i,o,a,s,l,u,c,h,f,p,d;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},a=null;;){switch(e=this.readUInt32(),u=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":a&&this.animation.frames.push(a),this.pos+=4,a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},o=this.readUInt16(),i=this.readUInt16()||100,a.delay=1e3*o/i,a.disposeOp=this.data[this.pos++],a.blendOp=this.data[this.pos++],a.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,e-=4),t=(null!=a?a.data:void 0)||this.imgData,f=0;0<=e?f<e:f>e;0<=e?++f:--f)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(r=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>r)throw new Error("More transparent colors than palette size");if((c=r-this.transparency.indexed.length)>0)for(p=0;0<=c?p<c:p>c;0<=c?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":s=(h=this.read(e)).indexOf(0),l=String.fromCharCode.apply(String,h.slice(0,s)),this.text[l]=String.fromCharCode.apply(String,h.slice(s+1));break;case"IEND":return a&&this.animation.frames.push(a),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(d=this.colorType)||6===d,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)n.push(this.data[this.pos++]);return n},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(t){var e=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*e),r=0,i=this;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);function o(o,a,s,l){var u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I,T,P,A=Math.ceil((i.width-o)/s),M=Math.ceil((i.height-a)/l),L=i.width==A&&i.height==M;for(w=e*A,x=L?n:new Uint8Array(w*M),d=t.length,b=0,c=0;b<M&&r<d;){switch(t[r++]){case 0:for(f=k=0;k<w;f=k+=1)x[c++]=t[r++];break;case 1:for(f=C=0;C<w;f=C+=1)u=t[r++],p=f<e?0:x[c-e],x[c++]=(u+p)%256;break;case 2:for(f=I=0;I<w;f=I+=1)u=t[r++],h=(f-f%e)/e,S=b&&x[(b-1)*w+h*e+f%e],x[c++]=(S+u)%256;break;case 3:for(f=T=0;T<w;f=T+=1)u=t[r++],h=(f-f%e)/e,p=f<e?0:x[c-e],S=b&&x[(b-1)*w+h*e+f%e],x[c++]=(u+Math.floor((p+S)/2))%256;break;case 4:for(f=P=0;P<w;f=P+=1)u=t[r++],h=(f-f%e)/e,p=f<e?0:x[c-e],0===b?S=E=0:(S=x[(b-1)*w+h*e+f%e],E=h&&x[(b-1)*w+(h-1)*e+f%e]),m=p+S-E,g=Math.abs(m-p),y=Math.abs(m-S),_=Math.abs(m-E),v=g<=y&&g<=_?p:y<=_?S:E,x[c++]=(u+v)%256;break;default:throw new Error("Invalid filter algorithm: "+t[r-1])}if(!L){var R=((a+b*l)*i.width+o)*e,D=b*w;for(f=0;f<A;f+=1){for(var N=0;N<e;N+=1)n[R++]=x[D++];R+=(s-1)*e}}b++}}return t=pt(t),1==i.interlaceMethod?(o(0,0,8,8),o(4,0,8,8),o(0,4,4,8),o(2,0,4,4),o(0,2,2,4),o(1,0,2,2),o(0,1,1,2)):o(0,0,1,1),n},r.prototype.decodePalette=function(){var t,e,n,r,i,o,a,s,l;for(n=this.palette,o=this.transparency.indexed||[],i=new Uint8Array((o.length||0)+n.length),r=0,t=0,e=a=0,s=n.length;a<s;e=a+=3)i[r++]=n[e],i[r++]=n[e+1],i[r++]=n[e+2],i[r++]=null!=(l=o[t++])?l:255;return i},r.prototype.copyToImageData=function(t,e){var n,r,i,o,a,s,l,u,c,h,f;if(r=this.colors,c=null,n=this.hasAlphaChannel,this.palette.length&&(c=null!=(f=this._decodedPalette)?f:this._decodedPalette=this.decodePalette(),r=4,n=!0),u=(i=t.data||t).length,a=c||e,o=s=0,1===r)for(;o<u;)l=c?4*e[o/4]:s,h=a[l++],i[o++]=h,i[o++]=h,i[o++]=h,i[o++]=n?a[l++]:255,s=l;else for(;o<u;)l=c?4*e[o/4]:s,i[o++]=a[l++],i[o++]=a[l++],i[o++]=a[l++],i[o++]=n?a[l++]:255,s=l},r.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t};var i=function(){if("[object Window]"===Object.prototype.toString.call(dt)){try{e=dt.document.createElement("canvas"),n=e.getContext("2d")}catch(t){return!1}return!0}return!1};return i(),t=function(t){var r;if(!0===i())return n.width=t.width,n.height=t.height,n.clearRect(0,0,t.width,t.height),n.putImageData(t,0,0),(r=new Image).src=e.toDataURL(),r;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(e){var n,r,i,o,a,s,l,u;if(this.animation){for(u=[],r=a=0,s=(l=this.animation.frames).length;a<s;r=++a)n=l[r],i=e.createImageData(n.width,n.height),o=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(i,o),n.imageData=i,u.push(n.image=t(i));return u}},r.prototype.renderFrame=function(t,e){var n,r,i;return n=(r=this.animation.frames)[e],i=r[e-1],0===e&&t.clearRect(0,0,this.width,this.height),1===(null!=i?i.disposeOp:void 0)?t.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(null!=i?i.disposeOp:void 0)&&t.putImageData(i.imageData,i.xOffset,i.yOffset),0===n.blendOp&&t.clearRect(n.xOffset,n.yOffset,n.width,n.height),t.drawImage(n.image,n.xOffset,n.yOffset)},r.prototype.animate=function(t){var e,n,r,i,o,a,s=this;return n=0,a=this.animation,i=a.numFrames,r=a.frames,o=a.numPlays,(e=function(){var a,l;if(a=n++%i,l=r[a],s.renderFrame(t,a),i>1&&n/i<o)return s.animation._timeout=setTimeout(e,l.delay)})()},r.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},r.prototype.render=function(t){var e,n;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(n=e.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),e.putImageData(n,0,0))},r}();function an(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,a=1<<1+(7&i);t[e++],t[e++];var s=null,l=null;o&&(s=e,l=a,e+=3*a);var u=!0,c=[],h=0,f=null,p=0,d=null;for(this.width=n,this.height=r;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,d=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(0===I)break;e+=I}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var m=t[e++];h=t[e++]|t[e++]<<8,f=t[e++],0==(1&m)&&(f=null),p=m>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(0===I)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,x=t[e++],b=x>>6&1,w=1<<1+(7&x),S=s,E=l,k=!1;x>>7&&(k=!0,S=e,E=w,e+=3*w);var C=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(0===I)break;e+=I}c.push({x:g,y:v,width:y,height:_,has_local_palette:k,palette_offset:S,palette_size:E,data_offset:C,data_length:e-C,transparent_index:f,interlaced:!!b,delay:h,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return d},this.frameInfo=function(t){if(t<0||t>=c.length)throw new Error("Frame index out of range.");return c[t]},this.decodeAndBlitFrameBGRA=function(e,r){var i=this.frameInfo(e),o=i.width*i.height,a=new Uint8Array(o);sn(t,i.data_offset,a,o);var s=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var u=i.width,c=n-u,h=u,f=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),d=f,m=4*c;!0===i.interlaced&&(m+=4*n*7);for(var g=8,v=0,y=a.length;v<y;++v){var _=a[v];if(0===h&&(h=u,(d+=m)>=p&&(m=4*c+4*n*(g-1),d=f+(u+c)*(g<<1),g>>=1)),_===l)d+=4;else{var x=t[s+3*_],b=t[s+3*_+1],w=t[s+3*_+2];r[d++]=w,r[d++]=b,r[d++]=x,r[d++]=255}--h}},this.decodeAndBlitFrameRGBA=function(e,r){var i=this.frameInfo(e),o=i.width*i.height,a=new Uint8Array(o);sn(t,i.data_offset,a,o);var s=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var u=i.width,c=n-u,h=u,f=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),d=f,m=4*c;!0===i.interlaced&&(m+=4*n*7);for(var g=8,v=0,y=a.length;v<y;++v){var _=a[v];if(0===h&&(h=u,(d+=m)>=p&&(m=4*c+4*n*(g-1),d=f+(u+c)*(g<<1),g>>=1)),_===l)d+=4;else{var x=t[s+3*_],b=t[s+3*_+1],w=t[s+3*_+2];r[d++]=x,r[d++]=b,r[d++]=w,r[d++]=255}--h}}}function sn(t,e,n,r){for(var i=t[e++],o=1<<i,a=o+1,s=a+1,l=i+1,u=(1<<l)-1,c=0,h=0,f=0,p=t[e++],d=new Int32Array(4096),m=null;;){for(;c<16&&0!==p;)h|=t[e++]<<c,c+=8,1===p?p=t[e++]:--p;if(c<l)break;var g=h&u;if(h>>=l,c-=l,g!==o){if(g===a)break;for(var v=g<s?g:m,y=0,_=v;_>o;)_=d[_]>>8,++y;var x=_;if(f+y+(v!==g?1:0)>r)return void gt.log("Warning, gif stream longer than expected.");n[f++]=x;var b=f+=y;for(v!==g&&(n[f++]=x),_=v;y--;)_=d[_],n[--b]=255&_,_>>=8;null!==m&&s<4096&&(d[s++]=m<<8|x,s>=u+1&&l<12&&(++l,u=u<<1|1)),m=g}else s=a+1,u=(1<<(l=i+1))-1,m=null}return f!==r&&gt.log("Warning, gif stream shorter than expected."),n}function ln(t){var e,n,r,i,o,a=Math.floor,s=new Array(64),l=new Array(64),u=new Array(64),c=new Array(64),h=new Array(65535),f=new Array(65535),p=new Array(64),d=new Array(64),m=[],g=0,v=7,y=new Array(64),_=new Array(64),x=new Array(64),b=new Array(256),w=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],M=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(t,e){for(var n=0,r=0,i=new Array,o=1;o<=16;o++){for(var a=1;a<=t[o];a++)i[e[r]]=[],i[e[r]][0]=n,i[e[r]][1]=o,r++,n++;n*=2}return i}function R(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(g|=1<<v),n--,--v<0&&(255==g?(D(255),D(0)):D(g),v=7,g=0)}function D(t){m.push(t)}function N(t){D(t>>8&255),D(255&t)}function z(t,e,n,r,i){for(var o,a=i[0],s=i[240],l=function(t,e){var n,r,i,o,a,s,l,u,c,h,f=0;for(c=0;c<8;++c){n=t[f],r=t[f+1],i=t[f+2],o=t[f+3],a=t[f+4],s=t[f+5],l=t[f+6];var d=n+(u=t[f+7]),m=n-u,g=r+l,v=r-l,y=i+s,_=i-s,x=o+a,b=o-a,w=d+x,S=d-x,E=g+y,k=g-y;t[f]=w+E,t[f+4]=w-E;var C=.707106781*(k+S);t[f+2]=S+C,t[f+6]=S-C;var I=.382683433*((w=b+_)-(k=v+m)),T=.5411961*w+I,P=1.306562965*k+I,A=.707106781*(E=_+v),M=m+A,L=m-A;t[f+5]=L+T,t[f+3]=L-T,t[f+1]=M+P,t[f+7]=M-P,f+=8}for(f=0,c=0;c<8;++c){n=t[f],r=t[f+8],i=t[f+16],o=t[f+24],a=t[f+32],s=t[f+40],l=t[f+48];var R=n+(u=t[f+56]),D=n-u,N=r+l,z=r-l,O=i+s,F=i-s,B=o+a,j=o-a,U=R+B,V=R-B,Z=N+O,q=N-O;t[f]=U+Z,t[f+32]=U-Z;var G=.707106781*(q+V);t[f+16]=V+G,t[f+48]=V-G;var W=.382683433*((U=j+F)-(q=z+D)),X=.5411961*U+W,H=1.306562965*q+W,Y=.707106781*(Z=F+z),$=D+Y,K=D-Y;t[f+40]=K+X,t[f+24]=K-X,t[f+8]=$+H,t[f+56]=$-H,f++}for(c=0;c<64;++c)h=t[c]*e[c],p[c]=h>0?h+.5|0:h-.5|0;return p}(t,e),u=0;u<64;++u)d[S[u]]=l[u];var c=d[0]-n;n=d[0],0==c?R(r[0]):(R(r[f[o=32767+c]]),R(h[o]));for(var m=63;m>0&&0==d[m];)m--;if(0==m)return R(a),n;for(var g,v=1;v<=m;){for(var y=v;0==d[v]&&v<=m;)++v;var _=v-y;if(_>=16){g=_>>4;for(var x=1;x<=g;++x)R(s);_&=15}o=32767+d[v],R(i[(_<<4)+f[o]]),R(h[o]),v++}return 63!=m&&R(a),n}function O(t){t=Math.min(Math.max(t,1),100),o!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=a((e[n]*t+50)/100);r=Math.min(Math.max(r,1),255),s[S[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var h=a((i[o]*t+50)/100);h=Math.min(Math.max(h,1),255),l[S[o]]=h}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,d=0;d<8;d++)for(var m=0;m<8;m++)u[p]=1/(s[S[p]]*f[d]*f[m]*8),c[p]=1/(l[S[p]]*f[d]*f[m]*8),p++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),o=t)}this.encode=function(t,o){o&&O(o),m=new Array,g=0,v=7,N(65496),N(65504),N(16),D(74),D(70),D(73),D(70),D(0),D(1),D(1),D(0),N(1),N(1),D(0),D(0),function(){N(65499),N(132),D(0);for(var t=0;t<64;t++)D(s[t]);D(1);for(var e=0;e<64;e++)D(l[e])}(),function(t,e){N(65472),N(17),D(8),N(e),N(t),D(3),D(1),D(17),D(0),D(2),D(17),D(1),D(3),D(17),D(1)}(t.width,t.height),function(){N(65476),N(418),D(0);for(var t=0;t<16;t++)D(E[t+1]);for(var e=0;e<=11;e++)D(k[e]);D(16);for(var n=0;n<16;n++)D(C[n+1]);for(var r=0;r<=161;r++)D(I[r]);D(1);for(var i=0;i<16;i++)D(T[i+1]);for(var o=0;o<=11;o++)D(P[o]);D(17);for(var a=0;a<16;a++)D(A[a+1]);for(var s=0;s<=161;s++)D(M[s])}(),N(65498),N(12),D(3),D(1),D(0),D(2),D(17),D(3),D(17),D(0),D(63),D(0);var a=0,h=0,f=0;g=0,v=7,this.encode.displayName="_encode_";for(var p,d,b,S,L,F,B,j,U,V=t.data,Z=t.width,q=t.height,G=4*Z,W=0;W<q;){for(p=0;p<G;){for(L=G*W+p,B=-1,j=0,U=0;U<64;U++)F=L+(j=U>>3)*G+(B=4*(7&U)),W+j>=q&&(F-=G*(W+1+j-q)),p+B>=G&&(F-=p+B-G+4),d=V[F++],b=V[F++],S=V[F++],y[U]=(w[d]+w[b+256>>0]+w[S+512>>0]>>16)-128,_[U]=(w[d+768>>0]+w[b+1024>>0]+w[S+1280>>0]>>16)-128,x[U]=(w[d+1280>>0]+w[b+1536>>0]+w[S+1792>>0]>>16)-128;a=z(y,u,a,e,r),h=z(_,c,h,n,i),f=z(x,c,f,n,i),p+=32}W+=8}if(v>=0){var X=[];X[1]=v+1,X[0]=(1<<v+1)-1,R(X)}return N(65497),new Uint8Array(m)},t=t||50,function(){for(var t=String.fromCharCode,e=0;e<256;e++)b[e]=t(e)}(),e=L(E,k),n=L(T,P),r=L(C,I),i=L(A,M),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var r=t;r<e;r++)f[32767+r]=n,h[32767+r]=[],h[32767+r][1]=n,h[32767+r][0]=r;for(var i=-(e-1);i<=-t;i++)f[32767+i]=n,h[32767+i]=[],h[32767+i][1]=n,h[32767+i][0]=e-1+i;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)w[t]=19595*t,w[t+256>>0]=38470*t,w[t+512>>0]=7471*t+32768,w[t+768>>0]=-11059*t,w[t+1024>>0]=-21709*t,w[t+1280>>0]=32768*t+8421375,w[t+1536>>0]=-27439*t,w[t+1792>>0]=-5329*t}(),O(t)}function un(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function cn(t){function e(t){if(!t)throw Error("assert :P")}function n(t,e,n){for(var r=0;4>r;r++)if(t[e+r]!=n.charCodeAt(r))return!0;return!1}function r(t,e,n,r,i){for(var o=0;o<i;o++)t[e+o]=n[r+o]}function i(t,e,n,r){for(var i=0;i<r;i++)t[e+i]=n}function o(t){return new Int32Array(t)}function a(t,e){for(var n=[],r=0;r<t;r++)n.push(new e);return n}function s(t,e){var n=[];return function t(n,r,i){for(var o=i[r],a=0;a<o&&(n.push(i.length>r+1?[]:new e),!(i.length<r+1));a++)t(n[a],r+1,i)}(n,0,t),n}var l=function(){var t=this;function l(t,e){for(var n=1<<e-1>>>0;t&n;)n>>>=1;return n?(t&n-1)+n:t}function u(t,n,r,i,o){e(!(i%r));do{t[n+(i-=r)]=o}while(0<i)}function c(t,n,r,i,a){if(e(2328>=a),512>=a)var s=o(512);else if(null==(s=o(a)))return 0;return function(t,n,r,i,a,s){var c,f,p=n,d=1<<r,m=o(16),g=o(16);for(e(0!=a),e(null!=i),e(null!=t),e(0<r),f=0;f<a;++f){if(15<i[f])return 0;++m[i[f]]}if(m[0]==a)return 0;for(g[1]=0,c=1;15>c;++c){if(m[c]>1<<c)return 0;g[c+1]=g[c]+m[c]}for(f=0;f<a;++f)c=i[f],0<i[f]&&(s[g[c]++]=f);if(1==g[15])return(i=new h).g=0,i.value=s[0],u(t,p,1,d,i),d;var v,y=-1,_=d-1,x=0,b=1,w=1,S=1<<r;for(f=0,c=1,a=2;c<=r;++c,a<<=1){if(b+=w<<=1,0>(w-=m[c]))return 0;for(;0<m[c];--m[c])(i=new h).g=c,i.value=s[f++],u(t,p+x,a,S,i),x=l(x,c)}for(c=r+1,a=2;15>=c;++c,a<<=1){if(b+=w<<=1,0>(w-=m[c]))return 0;for(;0<m[c];--m[c]){if(i=new h,(x&_)!=y){for(p+=S,v=1<<(y=c)-r;15>y&&!(0>=(v-=m[y]));)++y,v<<=1;d+=S=1<<(v=y-r),t[n+(y=x&_)].g=v+r,t[n+y].value=p-n-y}i.g=c-r,i.value=s[f++],u(t,p+(x>>r),a,S,i),x=l(x,c)}}return b!=2*g[15]-1?0:d}(t,n,r,i,a,s)}function h(){this.value=this.g=0}function f(){this.value=this.g=0}function p(){this.G=a(5,h),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Bn,f)}function d(t,n,r,i){e(null!=t),e(null!=n),e(2147483648>i),t.Ca=254,t.I=0,t.b=-8,t.Ka=0,t.oa=n,t.pa=r,t.Jd=n,t.Yc=r+i,t.Zc=4<=i?r+i-4+1:r,C(t)}function m(t,e){for(var n=0;0<e--;)n|=T(t,128)<<e;return n}function g(t,e){var n=m(t,e);return I(t)?-n:n}function v(t,n,r,i){var o,a=0;for(e(null!=t),e(null!=n),e(4294967288>i),t.Sb=i,t.Ra=0,t.u=0,t.h=0,4<i&&(i=4),o=0;o<i;++o)a+=n[r+o]<<8*o;t.Ra=a,t.bb=i,t.oa=n,t.pa=r}function y(t){for(;8<=t.u&&t.bb<t.Sb;)t.Ra>>>=8,t.Ra+=t.oa[t.pa+t.bb]<<Vn-8>>>0,++t.bb,t.u-=8;S(t)&&(t.h=1,t.u=0)}function _(t,n){if(e(0<=n),!t.h&&n<=Un){var r=w(t)&jn[n];return t.u+=n,y(t),r}return t.h=1,t.u=0}function x(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function b(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function w(t){return t.Ra>>>(t.u&Vn-1)>>>0}function S(t){return e(t.bb<=t.Sb),t.h||t.bb==t.Sb&&t.u>Vn}function E(t,e){t.u=e,t.h=S(t)}function k(t){t.u>=Zn&&(e(t.u>=Zn),y(t))}function C(t){e(null!=t&&null!=t.oa),t.pa<t.Zc?(t.I=(t.oa[t.pa++]|t.I<<8)>>>0,t.b+=8):(e(null!=t&&null!=t.oa),t.pa<t.Yc?(t.b+=8,t.I=t.oa[t.pa++]|t.I<<8):t.Ka?t.b=0:(t.I<<=8,t.b+=8,t.Ka=1))}function I(t){return m(t,1)}function T(t,e){var n=t.Ca;0>t.b&&C(t);var r=t.b,i=n*e>>>8,o=(t.I>>>r>i)+0;for(o?(n-=i,t.I-=i+1<<r>>>0):n=i+1,r=n,i=0;256<=r;)i+=8,r>>=8;return r=7^i+qn[r],t.b-=r,t.Ca=(n<<r)-1,o}function P(t,e,n){t[e+0]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=n>>0&255}function A(t,e){return t[e+0]<<0|t[e+1]<<8}function M(t,e){return A(t,e)|t[e+2]<<16}function L(t,e){return A(t,e)|A(t,e+2)<<16}function R(t,n){var r=1<<n;return e(null!=t),e(0<n),t.X=o(r),null==t.X?0:(t.Mb=32-n,t.Xa=n,1)}function D(t,n){e(null!=t),e(null!=n),e(t.Xa==n.Xa),r(n.X,0,t.X,0,1<<n.Xa)}function N(){this.X=[],this.Xa=this.Mb=0}function z(t,n,r,i){e(null!=r),e(null!=i);var o=r[0],a=i[0];return 0==o&&(o=(t*a+n/2)/n),0==a&&(a=(n*o+t/2)/t),0>=o||0>=a?0:(r[0]=o,i[0]=a,1)}function O(t,e){return t+(1<<e)-1>>>e}function F(t,e){return((4278255360&t)+(4278255360&e)>>>0&4278255360)+((16711935&t)+(16711935&e)>>>0&16711935)>>>0}function B(e,n){t[n]=function(n,r,i,o,a,s,l){var u;for(u=0;u<a;++u){var c=t[e](s[l+u-1],i,o+u);s[l+u]=F(n[r+u],c)}}}function j(){this.ud=this.hd=this.jd=0}function U(t,e){return((4278124286&(t^e))>>>1)+(t&e)>>>0}function V(t){return 0<=t&&256>t?t:0>t?0:255<t?255:void 0}function Z(t,e){return V(t+(t-e+.5>>1))}function q(t,e,n){return Math.abs(e-n)-Math.abs(t-n)}function G(t,e,n,r,i,o,a){for(r=o[a-1],n=0;n<i;++n)o[a+n]=r=F(t[e+n],r)}function W(t,e,n,r,i){var o;for(o=0;o<n;++o){var a=t[e+o],s=a>>8&255,l=16711935&(l=(l=16711935&a)+((s<<16)+s));r[i+o]=(4278255360&a)+l>>>0}}function X(t,e){e.jd=t>>0&255,e.hd=t>>8&255,e.ud=t>>16&255}function H(t,e,n,r,i,o){var a;for(a=0;a<r;++a){var s=e[n+a],l=s>>>8,u=s,c=255&(c=(c=s>>>16)+((t.jd<<24>>24)*(l<<24>>24)>>>5));u=255&(u=(u+=(t.hd<<24>>24)*(l<<24>>24)>>>5)+((t.ud<<24>>24)*(c<<24>>24)>>>5)),i[o+a]=(4278255360&s)+(c<<16)+u}}function Y(e,n,r,i,o){t[n]=function(t,e,n,r,a,s,l,u,c){for(r=l;r<u;++r)for(l=0;l<c;++l)a[s++]=o(n[i(t[e++])])},t[e]=function(e,n,a,s,l,u,c){var h=8>>e.b,f=e.Ea,p=e.K[0],d=e.w;if(8>h)for(e=(1<<e.b)-1,d=(1<<h)-1;n<a;++n){var m,g=0;for(m=0;m<f;++m)m&e||(g=i(s[l++])),u[c++]=o(p[g&d]),g>>=h}else t["VP8LMapColor"+r](s,l,p,d,u,c,n,a,f)}}function $(t,e,n,r,i){for(n=e+n;e<n;){var o=t[e++];r[i++]=o>>16&255,r[i++]=o>>8&255,r[i++]=o>>0&255}}function K(t,e,n,r,i){for(n=e+n;e<n;){var o=t[e++];r[i++]=o>>16&255,r[i++]=o>>8&255,r[i++]=o>>0&255,r[i++]=o>>24&255}}function J(t,e,n,r,i){for(n=e+n;e<n;){var o=(a=t[e++])>>16&240|a>>12&15,a=a>>0&240|a>>28&15;r[i++]=o,r[i++]=a}}function Q(t,e,n,r,i){for(n=e+n;e<n;){var o=(a=t[e++])>>16&248|a>>13&7,a=a>>5&224|a>>3&31;r[i++]=o,r[i++]=a}}function tt(t,e,n,r,i){for(n=e+n;e<n;){var o=t[e++];r[i++]=o>>0&255,r[i++]=o>>8&255,r[i++]=o>>16&255}}function et(t,e,n,i,o,a){if(0==a)for(n=e+n;e<n;)P(i,((a=t[e++])[0]>>24|a[1]>>8&65280|a[2]<<8&16711680|a[3]<<24)>>>0),o+=32;else r(i,o,t,e,n)}function nt(e,n){t[n][0]=t[e+"0"],t[n][1]=t[e+"1"],t[n][2]=t[e+"2"],t[n][3]=t[e+"3"],t[n][4]=t[e+"4"],t[n][5]=t[e+"5"],t[n][6]=t[e+"6"],t[n][7]=t[e+"7"],t[n][8]=t[e+"8"],t[n][9]=t[e+"9"],t[n][10]=t[e+"10"],t[n][11]=t[e+"11"],t[n][12]=t[e+"12"],t[n][13]=t[e+"13"],t[n][14]=t[e+"0"],t[n][15]=t[e+"0"]}function rt(t){return t==Zr||t==qr||t==Gr||t==Wr}function it(){this.eb=[],this.size=this.A=this.fb=0}function ot(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function at(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new it,this.f.kb=new ot,this.sd=null}function st(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ut(t){return alert("todo:WebPSamplerProcessPlane"),t.T}function ct(t,e){var n=t.T,i=e.ba.f.RGBA,o=i.eb,a=i.fb+t.ka*i.A,s=vi[e.ba.S],l=t.y,u=t.O,c=t.f,h=t.N,f=t.ea,p=t.W,d=e.cc,m=e.dc,g=e.Mc,v=e.Nc,y=t.ka,_=t.ka+t.T,x=t.U,b=x+1>>1;for(0==y?s(l,u,null,null,c,h,f,p,c,h,f,p,o,a,null,null,x):(s(e.ec,e.fc,l,u,d,m,g,v,c,h,f,p,o,a-i.A,o,a,x),++n);y+2<_;y+=2)d=c,m=h,g=f,v=p,h+=t.Rc,p+=t.Rc,a+=2*i.A,s(l,(u+=2*t.fa)-t.fa,l,u,d,m,g,v,c,h,f,p,o,a-i.A,o,a,x);return u+=t.fa,t.j+_<t.o?(r(e.ec,e.fc,l,u,x),r(e.cc,e.dc,c,h,b),r(e.Mc,e.Nc,f,p,b),n--):1&_||s(l,u,null,null,c,h,f,p,c,h,f,p,o,a+i.A,null,null,x),n}function ht(t,n,r){var i=t.F,o=[t.J];if(null!=i){var a=t.U,s=n.ba.S,l=s==jr||s==Gr;n=n.ba.f.RGBA;var u=[0],c=t.ka;u[0]=t.T,t.Kb&&(0==c?--u[0]:(--c,o[0]-=t.width),t.j+t.ka+t.T==t.o&&(u[0]=t.o-t.j-c));var h=n.eb;c=n.fb+c*n.A,t=kr(i,o[0],t.width,a,u,h,c+(l?0:3),n.A),e(r==u),t&&rt(s)&&Sr(h,c,l,a,u,n.A)}return 0}function ft(t){var e=t.ma,n=e.ba.S,r=11>n,i=n==Or||n==Br||n==jr||n==Ur||12==n||rt(n);if(e.memory=null,e.Ib=null,e.Jb=null,e.Nd=null,!zn(e.Oa,t,i?11:12))return 0;if(i&&rt(n)&&_n(),t.da)alert("todo:use_scaling");else{if(r){if(e.Ib=ut,t.Kb){if(n=t.U+1>>1,e.memory=o(t.U+2*n),null==e.memory)return 0;e.ec=e.memory,e.fc=0,e.cc=e.ec,e.dc=e.fc+t.U,e.Mc=e.cc,e.Nc=e.dc+n,e.Ib=ct,_n()}}else alert("todo:EmitYUV");i&&(e.Jb=ht,r&&vn())}if(r&&!Mi){for(t=0;256>t;++t)Li[t]=89858*(t-128)+Ci>>ki,Ni[t]=-22014*(t-128)+Ci,Di[t]=-45773*(t-128),Ri[t]=113618*(t-128)+Ci>>ki;for(t=Ii;t<Ti;++t)e=76283*(t-16)+Ci>>ki,zi[t-Ii]=Gt(e,255),Oi[t-Ii]=Gt(e+8>>4,15);Mi=1}return 1}function pt(t){var n=t.ma,r=t.U,i=t.T;return e(!(1&t.ka)),0>=r||0>=i?0:(r=n.Ib(t,n),null!=n.Jb&&n.Jb(t,n,r),n.Dc+=r,1)}function dt(t){t.ma.memory=null}function mt(t,e,n,r){return 47!=_(t,8)?0:(e[0]=_(t,14)+1,n[0]=_(t,14)+1,r[0]=_(t,1),0!=_(t,3)?0:!t.h)}function gt(t,e){if(4>t)return t+1;var n=t-2>>1;return(2+(1&t)<<n)+_(e,n)+1}function vt(t,e){return 120<e?e-120:1<=(n=((n=Jr[e-1])>>4)*t+(8-(15&n)))?n:1;var n}function yt(t,e,n){var r=w(n),i=t[e+=255&r].g-8;return 0<i&&(E(n,n.u+8),r=w(n),e+=t[e].value,e+=r&(1<<i)-1),E(n,n.u+t[e].g),t[e].value}function _t(t,n,r){return r.g+=t.g,r.value+=t.value<<n>>>0,e(8>=r.g),t.g}function xt(t,n,r){var i=t.xc;return e((n=0==i?0:t.vc[t.md*(r>>i)+(n>>i)])<t.Wb),t.Ya[n]}function bt(t,n,i,o){var a=t.ab,s=t.c*n,l=t.C;n=l+n;var u=i,c=o;for(o=t.Ta,i=t.Ua;0<a--;){var h=t.gc[a],f=l,p=n,d=u,m=c,g=(c=o,u=i,h.Ea);switch(e(f<p),e(p<=h.nc),h.hc){case 2:Xn(d,m,(p-f)*g,c,u);break;case 0:var v=f,y=p,_=c,x=u,b=(C=h).Ea;0==v&&(Gn(d,m,null,null,1,_,x),G(d,m+1,0,0,b-1,_,x+1),m+=b,x+=b,++v);for(var w=1<<C.b,S=w-1,E=O(b,C.b),k=C.K,C=C.w+(v>>C.b)*E;v<y;){var I=k,T=C,P=1;for(Wn(d,m,_,x-b,1,_,x);P<b;){var A=(P&~S)+w;A>b&&(A=b),(0,Jn[I[T++]>>8&15])(d,m+ +P,_,x+P-b,A-P,_,x+P),P=A}m+=b,x+=b,++v&S||(C+=E)}p!=h.nc&&r(c,u-g,c,u+(p-f-1)*g,g);break;case 1:for(g=d,y=m,b=(d=h.Ea)-(x=d&~(_=(m=1<<h.b)-1)),v=O(d,h.b),w=h.K,h=h.w+(f>>h.b)*v;f<p;){for(S=w,E=h,k=new j,C=y+x,I=y+d;y<C;)X(S[E++],k),Qn(k,g,y,m,c,u),y+=m,u+=m;y<I&&(X(S[E++],k),Qn(k,g,y,b,c,u),y+=b,u+=b),++f&_||(h+=v)}break;case 3:if(d==c&&m==u&&0<h.b){for(y=c,d=g=u+(p-f)*g-(x=(p-f)*O(h.Ea,h.b)),m=c,_=u,v=[],x=(b=x)-1;0<=x;--x)v[x]=m[_+x];for(x=b-1;0<=x;--x)y[d+x]=v[x];Hn(h,f,p,c,g,c,u)}else Hn(h,f,p,d,m,c,u)}u=o,c=i}c!=i&&r(o,i,u,c,s)}function wt(t,n){var r=t.V,i=t.Ba+t.c*t.C,o=n-t.C;if(e(n<=t.l.o),e(16>=o),0<o){var a=t.l,s=t.Ta,l=t.Ua,u=a.width;if(bt(t,o,r,i),o=l=[l],e((r=t.C)<(i=n)),e(a.v<a.va),i>a.o&&(i=a.o),r<a.j){var c=a.j-r;r=a.j,o[0]+=c*u}if(r>=i?r=0:(o[0]+=4*a.v,a.ka=r-a.j,a.U=a.va-a.v,a.T=i-r,r=1),r){if(l=l[0],11>(r=t.ca).S){var h=r.f.RGBA,f=(i=r.S,o=a.U,a=a.T,c=h.eb,h.A),p=a;for(h=h.fb+t.Ma*h.A;0<p--;){var d=s,m=l,g=o,v=c,y=h;switch(i){case zr:tr(d,m,g,v,y);break;case Or:er(d,m,g,v,y);break;case Zr:er(d,m,g,v,y),Sr(v,y,0,g,1,0);break;case Fr:ir(d,m,g,v,y);break;case Br:et(d,m,g,v,y,1);break;case qr:et(d,m,g,v,y,1),Sr(v,y,0,g,1,0);break;case jr:et(d,m,g,v,y,0);break;case Gr:et(d,m,g,v,y,0),Sr(v,y,1,g,1,0);break;case Ur:nr(d,m,g,v,y);break;case Wr:nr(d,m,g,v,y),Er(v,y,g,1,0);break;case Vr:rr(d,m,g,v,y);break;default:e(0)}l+=u,h+=f}t.Ma+=a}else alert("todo:EmitRescaledRowsYUVA");e(t.Ma<=r.height)}}t.C=n,e(t.C<=t.i)}function St(t){var e;if(0<t.ua)return 0;for(e=0;e<t.Wb;++e){var n=t.Ya[e].G,r=t.Ya[e].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function Et(t,n,r,i,o,a){if(0!=t.Z){var s=t.qd,l=t.rd;for(e(null!=gi[t.Z]);n<r;++n)gi[t.Z](s,l,i,o,i,o,a),s=i,l=o,o+=a;t.qd=s,t.rd=l}}function kt(t,n){var r=t.l.ma,i=0==r.Z||1==r.Z?t.l.j:t.C;if(i=t.C<i?i:t.C,e(n<=t.l.o),n>i){var o=t.l.width,a=r.ca,s=r.tb+o*i,l=t.V,u=t.Ba+t.c*i,c=t.gc;e(1==t.ab),e(3==c[0].hc),$n(c[0],i,n,l,u,a,s),Et(r,i,n,a,s,o)}t.C=t.Ma=n}function Ct(t,n,r,i,o,a,s){var l=t.$/i,u=t.$%i,c=t.m,h=t.s,f=r+t.$,p=f;o=r+i*o;var d=r+i*a,m=280+h.ua,g=t.Pb?l:16777216,v=0<h.ua?h.Wa:null,y=h.wc,_=f<d?xt(h,u,l):null;e(t.C<a),e(d<=o);var x=!1;t:for(;;){for(;x||f<d;){var b=0;if(l>=g){var C=f-r;e((g=t).Pb),g.wd=g.m,g.xd=C,0<g.s.ua&&D(g.s.Wa,g.s.vb),g=l+ti}if(u&y||(_=xt(h,u,l)),e(null!=_),_.Qb&&(n[f]=_.qb,x=!0),!x)if(k(c),_.jc){b=c,C=n;var I=f,T=_.pd[w(b)&Bn-1];e(_.jc),256>T.g?(E(b,b.u+T.g),C[I]=T.value,b=0):(E(b,b.u+T.g-256),e(256<=T.value),b=T.value),0==b&&(x=!0)}else b=yt(_.G[0],_.H[0],c);if(c.h)break;if(x||256>b){if(!x)if(_.nd)n[f]=(_.qb|b<<8)>>>0;else{if(k(c),x=yt(_.G[1],_.H[1],c),k(c),C=yt(_.G[2],_.H[2],c),I=yt(_.G[3],_.H[3],c),c.h)break;n[f]=(I<<24|x<<16|b<<8|C)>>>0}if(x=!1,++f,++u>=i&&(u=0,++l,null!=s&&l<=a&&!(l%16)&&s(t,l),null!=v))for(;p<f;)b=n[p++],v.X[(506832829*b&4294967295)>>>v.Mb]=b}else if(280>b){if(b=gt(b-256,c),C=yt(_.G[4],_.H[4],c),k(c),C=vt(i,C=gt(C,c)),c.h)break;if(f-r<C||o-f<b)break t;for(I=0;I<b;++I)n[f+I]=n[f+I-C];for(f+=b,u+=b;u>=i;)u-=i,++l,null!=s&&l<=a&&!(l%16)&&s(t,l);if(e(f<=o),u&y&&(_=xt(h,u,l)),null!=v)for(;p<f;)b=n[p++],v.X[(506832829*b&4294967295)>>>v.Mb]=b}else{if(!(b<m))break t;for(x=b-280,e(null!=v);p<f;)b=n[p++],v.X[(506832829*b&4294967295)>>>v.Mb]=b;b=f,e(!(x>>>(C=v).Xa)),n[b]=C.X[x],x=!0}x||e(c.h==S(c))}if(t.Pb&&c.h&&f<o)e(t.m.h),t.a=5,t.m=t.wd,t.$=t.xd,0<t.s.ua&&D(t.s.vb,t.s.Wa);else{if(c.h)break t;null!=s&&s(t,l>a?a:l),t.a=0,t.$=f-r}return 1}return t.a=3,0}function It(t){e(null!=t),t.vc=null,t.yc=null,t.Ya=null;var n=t.Wa;null!=n&&(n.X=null),t.vb=null,e(null!=t)}function Tt(){var e=new sn;return null==e?null:(e.a=0,e.xb=mi,nt("Predictor","VP8LPredictors"),nt("Predictor","VP8LPredictors_C"),nt("PredictorAdd","VP8LPredictorsAdd"),nt("PredictorAdd","VP8LPredictorsAdd_C"),Xn=W,Qn=H,tr=$,er=K,nr=J,rr=Q,ir=tt,t.VP8LMapColor32b=Yn,t.VP8LMapColor8b=Kn,e)}function Pt(t,n,r,s,l){var u=1,f=[t],d=[n],m=s.m,g=s.s,v=null,y=0;t:for(;;){if(r)for(;u&&_(m,1);){var x=f,b=d,S=s,C=1,I=S.m,T=S.gc[S.ab],P=_(I,2);if(S.Oc&1<<P)u=0;else{switch(S.Oc|=1<<P,T.hc=P,T.Ea=x[0],T.nc=b[0],T.K=[null],++S.ab,e(4>=S.ab),P){case 0:case 1:T.b=_(I,3)+2,C=Pt(O(T.Ea,T.b),O(T.nc,T.b),0,S,T.K),T.K=T.K[0];break;case 3:var A,M=_(I,8)+1,L=16<M?0:4<M?1:2<M?2:3;if(x[0]=O(T.Ea,L),T.b=L,A=C=Pt(M,1,0,S,T.K)){var D,N=M,z=T,B=1<<(8>>z.b),j=o(B);if(null==j)A=0;else{var U=z.K[0],V=z.w;for(j[0]=z.K[0][0],D=1;D<1*N;++D)j[D]=F(U[V+D],j[D-1]);for(;D<4*B;++D)j[D]=0;z.K[0]=null,z.K[0]=j,A=1}}C=A;break;case 2:break;default:e(0)}u=C}}if(f=f[0],d=d[0],u&&_(m,1)&&!(u=1<=(y=_(m,4))&&11>=y)){s.a=3;break t}var Z;if(Z=u)e:{var q,G,W,X=s,H=f,Y=d,$=y,K=r,J=X.m,Q=X.s,tt=[null],et=1,nt=0,rt=Qr[$];n:for(;;){if(K&&_(J,1)){var it=_(J,3)+2,ot=O(H,it),at=O(Y,it),st=ot*at;if(!Pt(ot,at,0,X,tt))break n;for(tt=tt[0],Q.xc=it,q=0;q<st;++q){var lt=tt[q]>>8&65535;tt[q]=lt,lt>=et&&(et=lt+1)}}if(J.h)break n;for(G=0;5>G;++G){var ut=Yr[G];!G&&0<$&&(ut+=1<<$),nt<ut&&(nt=ut)}var ct=a(et*rt,h),ht=et,ft=a(ht,p);if(null==ft)var pt=null;else e(65536>=ht),pt=ft;var dt=o(nt);if(null==pt||null==dt||null==ct){X.a=1;break n}var mt=ct;for(q=W=0;q<et;++q){var gt=pt[q],vt=gt.G,yt=gt.H,xt=0,bt=1,wt=0;for(G=0;5>G;++G){ut=Yr[G],vt[G]=mt,yt[G]=W,!G&&0<$&&(ut+=1<<$);r:{var St,Et=ut,kt=X,Tt=dt,At=mt,Mt=W,Lt=0,Rt=kt.m,Dt=_(Rt,1);if(i(Tt,0,0,Et),Dt){var Nt=_(Rt,1)+1,zt=_(Rt,1),Ot=_(Rt,0==zt?1:8);Tt[Ot]=1,2==Nt&&(Tt[Ot=_(Rt,8)]=1);var Ft=1}else{var Bt=o(19),jt=_(Rt,4)+4;if(19<jt){kt.a=3;var Ut=0;break r}for(St=0;St<jt;++St)Bt[Kr[St]]=_(Rt,3);var Vt=void 0,Zt=void 0,qt=kt,Gt=Bt,Wt=Et,Xt=Tt,Ht=0,Yt=qt.m,$t=8,Kt=a(128,h);i:for(;c(Kt,0,7,Gt,19);){if(_(Yt,1)){var Jt=2+2*_(Yt,3);if((Vt=2+_(Yt,Jt))>Wt)break i}else Vt=Wt;for(Zt=0;Zt<Wt&&Vt--;){k(Yt);var Qt=Kt[0+(127&w(Yt))];E(Yt,Yt.u+Qt.g);var te=Qt.value;if(16>te)Xt[Zt++]=te,0!=te&&($t=te);else{var ee=16==te,ne=te-16,re=Hr[ne],ie=_(Yt,Xr[ne])+re;if(Zt+ie>Wt)break i;for(var oe=ee?$t:0;0<ie--;)Xt[Zt++]=oe}}Ht=1;break i}Ht||(qt.a=3),Ft=Ht}(Ft=Ft&&!Rt.h)&&(Lt=c(At,Mt,8,Tt,Et)),Ft&&0!=Lt?Ut=Lt:(kt.a=3,Ut=0)}if(0==Ut)break n;if(bt&&1==$r[G]&&(bt=0==mt[W].g),xt+=mt[W].g,W+=Ut,3>=G){var ae,se=dt[0];for(ae=1;ae<ut;++ae)dt[ae]>se&&(se=dt[ae]);wt+=se}}if(gt.nd=bt,gt.Qb=0,bt&&(gt.qb=(vt[3][yt[3]+0].value<<24|vt[1][yt[1]+0].value<<16|vt[2][yt[2]+0].value)>>>0,0==xt&&256>vt[0][yt[0]+0].value&&(gt.Qb=1,gt.qb+=vt[0][yt[0]+0].value<<8)),gt.jc=!gt.Qb&&6>wt,gt.jc){var le,ue=gt;for(le=0;le<Bn;++le){var ce=le,he=ue.pd[ce],fe=ue.G[0][ue.H[0]+ce];256<=fe.value?(he.g=fe.g+256,he.value=fe.value):(he.g=0,he.value=0,ce>>=_t(fe,8,he),ce>>=_t(ue.G[1][ue.H[1]+ce],16,he),ce>>=_t(ue.G[2][ue.H[2]+ce],0,he),_t(ue.G[3][ue.H[3]+ce],24,he))}}}Q.vc=tt,Q.Wb=et,Q.Ya=pt,Q.yc=ct,Z=1;break e}Z=0}if(!(u=Z)){s.a=3;break t}if(0<y){if(g.ua=1<<y,!R(g.Wa,y)){s.a=1,u=0;break t}}else g.ua=0;var pe=s,de=f,me=d,ge=pe.s,ve=ge.xc;if(pe.c=de,pe.i=me,ge.md=O(de,ve),ge.wc=0==ve?-1:(1<<ve)-1,r){s.xb=di;break t}if(null==(v=o(f*d))){s.a=1,u=0;break t}u=(u=Ct(s,v,0,f,d,d,null))&&!m.h;break t}return u?(null!=l?l[0]=v:(e(null==v),e(r)),s.$=0,r||It(g)):It(g),u}function At(t,n){var r=t.c*t.i,i=r+n+16*n;return e(t.c<=n),t.V=o(i),null==t.V?(t.Ta=null,t.Ua=0,t.a=1,0):(t.Ta=t.V,t.Ua=t.Ba+r+n,1)}function Mt(t,n){var r=t.C,i=n-r,o=t.V,a=t.Ba+t.c*r;for(e(n<=t.l.o);0<i;){var s=16<i?16:i,l=t.l.ma,u=t.l.width,c=u*s,h=l.ca,f=l.tb+u*r,p=t.Ta,d=t.Ua;bt(t,s,o,a),Cr(p,d,h,f,c),Et(l,r,r+s,h,f,u),i-=s,o+=s*t.c,r+=s}e(r==n),t.C=t.Ma=n}function Lt(){this.ub=this.yd=this.td=this.Rb=0}function Rt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Nt(){this.Yb=function(){var t=[];return function t(e,n,r){for(var i=r[n],o=0;o<i&&(e.push(r.length>n+1?[]:0),!(r.length<n+1));o++)t(e[o],n+1,r)}(t,0,[3,11]),t}()}function zt(){this.jb=o(3),this.Wc=s([4,8],Nt),this.Xc=s([4,17],Nt)}function Ot(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Ft(){this.ld=this.La=this.dd=this.tc=0}function Bt(){this.Na=this.la=0}function jt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ut(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Vt(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ft),this.Y=0,this.ya=Array(new Ut),this.aa=0,this.l=new Wt}function Zt(){this.y=o(16),this.f=o(8),this.ea=o(8)}function qt(){this.cb=this.a=0,this.sc="",this.m=new x,this.Od=new Lt,this.Kc=new Rt,this.ed=new Ot,this.Qa=new Dt,this.Ic=this.$c=this.Aa=0,this.D=new Vt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,x),this.ia=0,this.pb=a(4,jt),this.Pa=new zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Zt),this.Hd=0,this.rb=Array(new Bt),this.sb=0,this.wa=Array(new Ft),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ut),this.L=this.aa=0,this.gd=s([4,2],Ft),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Gt(t,e){return 0>t?0:t>e?e:t}function Wt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xt(){var t=new qt;return null!=t&&(t.a=0,t.sc="OK",t.cb=0,t.Xb=0,ri||(ri=Kt)),t}function Ht(t,e,n){return 0==t.a&&(t.a=e,t.sc=n,t.cb=0),0}function Yt(t,e,n){return 3<=n&&157==t[e+0]&&1==t[e+1]&&42==t[e+2]}function $t(t,n){if(null==t)return 0;if(t.a=0,t.sc="OK",null==n)return Ht(t,2,"null VP8Io passed to VP8GetHeaders()");var r=n.data,o=n.w,a=n.ha;if(4>a)return Ht(t,7,"Truncated header.");var s=r[o+0]|r[o+1]<<8|r[o+2]<<16,l=t.Od;if(l.Rb=!(1&s),l.td=s>>1&7,l.yd=s>>4&1,l.ub=s>>5,3<l.td)return Ht(t,3,"Incorrect keyframe parameters.");if(!l.yd)return Ht(t,4,"Frame not displayable.");o+=3,a-=3;var u=t.Kc;if(l.Rb){if(7>a)return Ht(t,7,"cannot parse picture header");if(!Yt(r,o,a))return Ht(t,3,"Bad code word");u.c=16383&(r[o+4]<<8|r[o+3]),u.Td=r[o+4]>>6,u.i=16383&(r[o+6]<<8|r[o+5]),u.Ud=r[o+6]>>6,o+=7,a-=7,t.za=u.c+15>>4,t.Ub=u.i+15>>4,n.width=u.c,n.height=u.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,i((s=t.Pa).jb,0,255,s.jb.length),e(null!=(s=t.Qa)),s.Cb=0,s.Bb=0,s.Fb=1,i(s.Zb,0,0,s.Zb.length),i(s.Lb,0,0,s.Lb)}if(l.ub>a)return Ht(t,7,"bad partition length");d(s=t.m,r,o,l.ub),o+=l.ub,a-=l.ub,l.Rb&&(u.Ld=I(s),u.Kd=I(s)),u=t.Qa;var c,h=t.Pa;if(e(null!=s),e(null!=u),u.Cb=I(s),u.Cb){if(u.Bb=I(s),I(s)){for(u.Fb=I(s),c=0;4>c;++c)u.Zb[c]=I(s)?g(s,7):0;for(c=0;4>c;++c)u.Lb[c]=I(s)?g(s,6):0}if(u.Bb)for(c=0;3>c;++c)h.jb[c]=I(s)?m(s,8):255}else u.Bb=0;if(s.Ka)return Ht(t,3,"cannot parse segment header");if((u=t.ed).zd=I(s),u.Tb=m(s,6),u.wb=m(s,3),u.Pc=I(s),u.Pc&&I(s)){for(h=0;4>h;++h)I(s)&&(u.vd[h]=g(s,6));for(h=0;4>h;++h)I(s)&&(u.od[h]=g(s,6))}if(t.L=0==u.Tb?0:u.zd?1:2,s.Ka)return Ht(t,3,"cannot parse filter header");var f=a;if(a=c=o,o=c+f,u=f,t.Xb=(1<<m(t.m,2))-1,f<3*(h=t.Xb))r=7;else{for(c+=3*h,u-=3*h,f=0;f<h;++f){var p=r[a+0]|r[a+1]<<8|r[a+2]<<16;p>u&&(p=u),d(t.Jc[+f],r,c,p),c+=p,u-=p,a+=3}d(t.Jc[+h],r,c,u),r=c<o?0:5}if(0!=r)return Ht(t,r,"cannot parse partitions");for(r=m(c=t.m,7),a=I(c)?g(c,4):0,o=I(c)?g(c,4):0,u=I(c)?g(c,4):0,h=I(c)?g(c,4):0,c=I(c)?g(c,4):0,f=t.Qa,p=0;4>p;++p){if(f.Cb){var v=f.Zb[p];f.Fb||(v+=r)}else{if(0<p){t.pb[p]=t.pb[0];continue}v=r}var y=t.pb[p];y.Sc[0]=ei[Gt(v+a,127)],y.Sc[1]=ni[Gt(v+0,127)],y.Eb[0]=2*ei[Gt(v+o,127)],y.Eb[1]=101581*ni[Gt(v+u,127)]>>16,8>y.Eb[1]&&(y.Eb[1]=8),y.Qc[0]=ei[Gt(v+h,117)],y.Qc[1]=ni[Gt(v+c,127)],y.lc=v+c}if(!l.Rb)return Ht(t,4,"Not a key frame.");for(I(s),l=t.Pa,r=0;4>r;++r){for(a=0;8>a;++a)for(o=0;3>o;++o)for(u=0;11>u;++u)h=T(s,ui[r][a][o][u])?m(s,8):si[r][a][o][u],l.Wc[r][a].Yb[o][u]=h;for(a=0;17>a;++a)l.Xc[r][a]=l.Wc[r][ci[a]]}return t.kc=I(s),t.kc&&(t.Bd=m(s,8)),t.cb=1}function Kt(t,e,n,r,i,o,a){var s=e[i].Yb[n];for(n=0;16>i;++i){if(!T(t,s[n+0]))return i;for(;!T(t,s[n+1]);)if(s=e[++i].Yb[0],n=0,16==i)return 16;var l=e[i+1].Yb;if(T(t,s[n+2])){var u=t,c=0;if(T(u,(f=s)[(h=n)+3]))if(T(u,f[h+6])){for(s=0,h=2*(c=T(u,f[h+8]))+(f=T(u,f[h+9+c])),c=0,f=ii[h];f[s];++s)c+=c+T(u,f[s]);c+=3+(8<<h)}else T(u,f[h+7])?(c=7+2*T(u,165),c+=T(u,145)):c=5+T(u,159);else c=T(u,f[h+4])?3+T(u,f[h+5]):2;s=l[2]}else c=1,s=l[1];l=a+oi[i],0>(u=t).b&&C(u);var h,f=u.b,p=(h=u.Ca>>1)-(u.I>>f)>>31;--u.b,u.Ca+=p,u.Ca|=1,u.I-=(h+1&p)<<f,o[l]=((c^p)-p)*r[(0<i)+0]}return 16}function Jt(t){var e=t.rb[t.sb-1];e.la=0,e.Na=0,i(t.zc,0,0,t.zc.length),t.ja=0}function Qt(t,n){if(null==t)return 0;if(null==n)return Ht(t,2,"NULL VP8Io parameter in VP8Decode().");if(!t.cb&&!$t(t,n))return 0;if(e(t.cb),null==n.ac||n.ac(n)){n.ob&&(t.L=0);var s=Bi[t.L];if(2==t.L?(t.yb=0,t.zb=0):(t.yb=n.v-s>>4,t.zb=n.j-s>>4,0>t.yb&&(t.yb=0),0>t.zb&&(t.zb=0)),t.Va=n.o+15+s>>4,t.Hb=n.va+15+s>>4,t.Hb>t.za&&(t.Hb=t.za),t.Va>t.Ub&&(t.Va=t.Ub),0<t.L){var l=t.ed;for(s=0;4>s;++s){var u;if(t.Qa.Cb){var c=t.Qa.Lb[s];t.Qa.Fb||(c+=l.Tb)}else c=l.Tb;for(u=0;1>=u;++u){var h=t.gd[s][u],f=c;if(l.Pc&&(f+=l.vd[0],u&&(f+=l.od[0])),0<(f=0>f?0:63<f?63:f)){var p=f;0<l.wb&&(p=4<l.wb?p>>2:p>>1)>9-l.wb&&(p=9-l.wb),1>p&&(p=1),h.dd=p,h.tc=2*f+p,h.ld=40<=f?2:15<=f?1:0}else h.tc=0;h.La=u}}}s=0}else Ht(t,6,"Frame setup failed"),s=t.a;if(s=0==s){if(s){t.$c=0,0<t.Aa||(t.Ic=Ui);t:{s=t.Ic,l=4*(p=t.za);var d=32*p,m=p+1,g=0<t.L?p*(0<t.Aa?2:1):0,v=(2==t.Aa?2:1)*p;if((h=l+832+(u=3*(16*s+Bi[t.L])/2*d)+(c=null!=t.Fa&&0<t.Fa.length?t.Kc.c*t.Kc.i:0))!=h)s=0;else{if(h>t.Vb){if(t.Vb=0,t.Ec=o(h),t.Fc=0,null==t.Ec){s=Ht(t,1,"no memory during frame initialization.");break t}t.Vb=h}h=t.Ec,f=t.Fc,t.Ac=h,t.Bc=f,f+=l,t.Gd=a(d,Zt),t.Hd=0,t.rb=a(m+1,Bt),t.sb=1,t.wa=g?a(g,Ft):null,t.Y=0,t.D.Nb=0,t.D.wa=t.wa,t.D.Y=t.Y,0<t.Aa&&(t.D.Y+=p),e(!0),t.oc=h,t.pc=f,f+=832,t.ya=a(v,Ut),t.aa=0,t.D.ya=t.ya,t.D.aa=t.aa,2==t.Aa&&(t.D.aa+=p),t.R=16*p,t.B=8*p,p=(d=Bi[t.L])*t.R,d=d/2*t.B,t.sa=h,t.ta=f+p,t.qa=t.sa,t.ra=t.ta+16*s*t.R+d,t.Ha=t.qa,t.Ia=t.ra+8*s*t.B+d,t.$c=0,f+=u,t.mb=c?h:null,t.nb=c?f:null,e(f+c<=t.Fc+t.Vb),Jt(t),i(t.Ac,t.Bc,0,l),s=1}}if(s){if(n.ka=0,n.y=t.sa,n.O=t.ta,n.f=t.qa,n.N=t.ra,n.ea=t.Ha,n.Vd=t.Ia,n.fa=t.R,n.Rc=t.B,n.F=null,n.J=0,!Mr){for(s=-255;255>=s;++s)Ir[255+s]=0>s?-s:s;for(s=-1020;1020>=s;++s)Tr[1020+s]=-128>s?-128:127<s?127:s;for(s=-112;112>=s;++s)Pr[112+s]=-16>s?-16:15<s?15:s;for(s=-255;510>=s;++s)Ar[255+s]=0>s?0:255<s?255:s;Mr=1}or=ue,ar=oe,lr=ae,ur=se,cr=le,sr=ie,hr=He,fr=Ye,pr=Je,dr=Qe,mr=$e,gr=Ke,vr=tn,yr=en,_r=Ve,xr=Ze,br=qe,wr=Ge,fi[0]=Ee,fi[1]=he,fi[2]=we,fi[3]=Se,fi[4]=ke,fi[5]=Ie,fi[6]=Ce,fi[7]=Te,fi[8]=Ae,fi[9]=Pe,hi[0]=ve,hi[1]=pe,hi[2]=de,hi[3]=me,hi[4]=ye,hi[5]=_e,hi[6]=xe,pi[0]=De,pi[1]=fe,pi[2]=Me,pi[3]=Le,pi[4]=ze,pi[5]=Ne,pi[6]=Oe,s=1}else s=0}s&&(s=function(t,n){for(t.M=0;t.M<t.Va;++t.M){var a,s=t.Jc[t.M&t.Xb],l=t.m,u=t;for(a=0;a<u.za;++a){var c=l,h=u,f=h.Ac,p=h.Bc+4*a,d=h.zc,m=h.ya[h.aa+a];if(h.Qa.Bb?m.$b=T(c,h.Pa.jb[0])?2+T(c,h.Pa.jb[2]):T(c,h.Pa.jb[1]):m.$b=0,h.kc&&(m.Ad=T(c,h.Bd)),m.Za=!T(c,145)+0,m.Za){var g=m.Ob,v=0;for(h=0;4>h;++h){var y,_=d[0+h];for(y=0;4>y;++y){_=li[f[p+y]][_];for(var x=ai[T(c,_[0])];0<x;)x=ai[2*x+T(c,_[x])];_=-x,f[p+y]=_}r(g,v,f,p,4),v+=4,d[0+h]=_}}else _=T(c,156)?T(c,128)?1:3:T(c,163)?2:0,m.Ob[0]=_,i(f,p,_,4),i(d,0,_,4);m.Dd=T(c,142)?T(c,114)?T(c,183)?1:3:2:0}if(u.m.Ka)return Ht(t,7,"Premature end-of-partition0 encountered.");for(;t.ja<t.za;++t.ja){if(u=s,c=(l=t).rb[l.sb-1],f=l.rb[l.sb+l.ja],a=l.ya[l.aa+l.ja],p=l.kc?a.Ad:0)c.la=f.la=0,a.Za||(c.Na=f.Na=0),a.Hc=0,a.Gc=0,a.ia=0;else{var b,w;if(c=f,f=u,p=l.Pa.Xc,d=l.ya[l.aa+l.ja],m=l.pb[d.$b],h=d.ad,g=0,v=l.rb[l.sb-1],_=y=0,i(h,g,0,384),d.Za)var S=0,E=p[3];else{x=o(16);var k=c.Na+v.Na;if(k=ri(f,p[1],k,m.Eb,0,x,0),c.Na=v.Na=(0<k)+0,1<k)or(x,0,h,g);else{var C=x[0]+3>>3;for(x=0;256>x;x+=16)h[g+x]=C}S=1,E=p[0]}var I=15&c.la,P=15&v.la;for(x=0;4>x;++x){var A=1&P;for(C=w=0;4>C;++C)I=I>>1|(A=(k=ri(f,E,k=A+(1&I),m.Sc,S,h,g))>S)<<7,w=w<<2|(3<k?3:1<k?2:0!=h[g+0]),g+=16;I>>=4,P=P>>1|A<<7,y=(y<<8|w)>>>0}for(E=I,S=P>>4,b=0;4>b;b+=2){for(w=0,I=c.la>>4+b,P=v.la>>4+b,x=0;2>x;++x){for(A=1&P,C=0;2>C;++C)k=A+(1&I),I=I>>1|(A=0<(k=ri(f,p[2],k,m.Qc,0,h,g)))<<3,w=w<<2|(3<k?3:1<k?2:0!=h[g+0]),g+=16;I>>=2,P=P>>1|A<<5}_|=w<<4*b,E|=I<<4<<b,S|=(240&P)<<b}c.la=E,v.la=S,d.Hc=y,d.Gc=_,d.ia=43690&_?0:m.ia,p=!(y|_)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[a.$b][a.Za],l.wa[l.Y+l.ja].La|=!p),u.Ka)return Ht(t,7,"Premature end-of-file encountered.")}if(Jt(t),l=n,u=1,a=(s=t).D,c=0<s.L&&s.M>=s.zb&&s.M<=s.Va,0==s.Aa)t:{if(a.M=s.M,a.uc=c,Dn(s,a),u=1,a=(w=s.D).Nb,c=(_=Bi[s.L])*s.R,f=_/2*s.B,x=16*a*s.R,C=8*a*s.B,p=s.sa,d=s.ta-c+x,m=s.qa,h=s.ra-f+C,g=s.Ha,v=s.Ia-f+C,P=0==(I=w.M),y=I>=s.Va-1,2==s.Aa&&Dn(s,w),w.uc)for(A=(k=s).D.M,e(k.D.uc),w=k.yb;w<k.Hb;++w){S=w,E=A;var M=(L=(U=k).D).Nb;b=U.R;var L=L.wa[L.Y+S],R=U.sa,D=U.ta+16*M*b+16*S,N=L.dd,z=L.tc;if(0!=z)if(e(3<=z),1==U.L)0<S&&xr(R,D,b,z+4),L.La&&wr(R,D,b,z),0<E&&_r(R,D,b,z+4),L.La&&br(R,D,b,z);else{var O=U.B,F=U.qa,B=U.ra+8*M*O+8*S,j=U.Ha,U=U.Ia+8*M*O+8*S;M=L.ld,0<S&&(fr(R,D,b,z+4,N,M),dr(F,B,j,U,O,z+4,N,M)),L.La&&(gr(R,D,b,z,N,M),yr(F,B,j,U,O,z,N,M)),0<E&&(hr(R,D,b,z+4,N,M),pr(F,B,j,U,O,z+4,N,M)),L.La&&(mr(R,D,b,z,N,M),vr(F,B,j,U,O,z,N,M))}}if(s.ia&&alert("todo:DitherRow"),null!=l.put){if(w=16*I,I=16*(I+1),P?(l.y=s.sa,l.O=s.ta+x,l.f=s.qa,l.N=s.ra+C,l.ea=s.Ha,l.W=s.Ia+C):(w-=_,l.y=p,l.O=d,l.f=m,l.N=h,l.ea=g,l.W=v),y||(I-=_),I>l.o&&(I=l.o),l.F=null,l.J=null,null!=s.Fa&&0<s.Fa.length&&w<I&&(l.J=fn(s,l,w,I-w),l.F=s.mb,null==l.F&&0==l.F.length)){u=Ht(s,3,"Could not decode alpha data.");break t}w<l.j&&(_=l.j-w,w=l.j,e(!(1&_)),l.O+=s.R*_,l.N+=s.B*(_>>1),l.W+=s.B*(_>>1),null!=l.F&&(l.J+=l.width*_)),w<I&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=w-l.j,l.U=l.va-l.v,l.T=I-w,u=l.put(l))}a+1!=s.Ic||y||(r(s.sa,s.ta-c,p,d+16*s.R,c),r(s.qa,s.ra-f,m,h+8*s.B,f),r(s.Ha,s.Ia-f,g,v+8*s.B,f))}if(!u)return Ht(t,6,"Output aborted.")}return 1}(t,n)),null!=n.bc&&n.bc(n),s&=1}return s?(t.cb=0,s):0}function te(t,e,n,r,i){i=t[e+n+32*r]+(i>>3),t[e+n+32*r]=-256&i?0>i?0:255:i}function ee(t,e,n,r,i,o){te(t,e,0,n,r+i),te(t,e,1,n,r+o),te(t,e,2,n,r-o),te(t,e,3,n,r-i)}function ne(t){return(20091*t>>16)+t}function re(t,e,n,r){var i,a=0,s=o(16);for(i=0;4>i;++i){var l=t[e+0]+t[e+8],u=t[e+0]-t[e+8],c=(35468*t[e+4]>>16)-ne(t[e+12]),h=ne(t[e+4])+(35468*t[e+12]>>16);s[a+0]=l+h,s[a+1]=u+c,s[a+2]=u-c,s[a+3]=l-h,a+=4,e++}for(i=a=0;4>i;++i)l=(t=s[a+0]+4)+s[a+8],u=t-s[a+8],c=(35468*s[a+4]>>16)-ne(s[a+12]),te(n,r,0,0,l+(h=ne(s[a+4])+(35468*s[a+12]>>16))),te(n,r,1,0,u+c),te(n,r,2,0,u-c),te(n,r,3,0,l-h),a++,r+=32}function ie(t,e,n,r){var i=t[e+0]+4,o=35468*t[e+4]>>16,a=ne(t[e+4]),s=35468*t[e+1]>>16;ee(n,r,0,i+a,t=ne(t[e+1]),s),ee(n,r,1,i+o,t,s),ee(n,r,2,i-o,t,s),ee(n,r,3,i-a,t,s)}function oe(t,e,n,r,i){re(t,e,n,r),i&&re(t,e+16,n,r+4)}function ae(t,e,n,r){ar(t,e+0,n,r,1),ar(t,e+32,n,r+128,1)}function se(t,e,n,r){var i;for(t=t[e+0]+4,i=0;4>i;++i)for(e=0;4>e;++e)te(n,r,e,i,t)}function le(t,e,n,r){t[e+0]&&ur(t,e+0,n,r),t[e+16]&&ur(t,e+16,n,r+4),t[e+32]&&ur(t,e+32,n,r+128),t[e+48]&&ur(t,e+48,n,r+128+4)}function ue(t,e,n,r){var i,a=o(16);for(i=0;4>i;++i){var s=t[e+0+i]+t[e+12+i],l=t[e+4+i]+t[e+8+i],u=t[e+4+i]-t[e+8+i],c=t[e+0+i]-t[e+12+i];a[0+i]=s+l,a[8+i]=s-l,a[4+i]=c+u,a[12+i]=c-u}for(i=0;4>i;++i)s=(t=a[0+4*i]+3)+a[3+4*i],l=a[1+4*i]+a[2+4*i],u=a[1+4*i]-a[2+4*i],c=t-a[3+4*i],n[r+0]=s+l>>3,n[r+16]=c+u>>3,n[r+32]=s-l>>3,n[r+48]=c-u>>3,r+=64}function ce(t,e,n){var r,i=e-32,o=Dr,a=255-t[i-1];for(r=0;r<n;++r){var s,l=o,u=a+t[e-1];for(s=0;s<n;++s)t[e+s]=l[u+t[i+s]];e+=32}}function he(t,e){ce(t,e,4)}function fe(t,e){ce(t,e,8)}function pe(t,e){ce(t,e,16)}function de(t,e){var n;for(n=0;16>n;++n)r(t,e+32*n,t,e-32,16)}function me(t,e){var n;for(n=16;0<n;--n)i(t,e,t[e-1],16),e+=32}function ge(t,e,n){var r;for(r=0;16>r;++r)i(e,n+32*r,t,16)}function ve(t,e){var n,r=16;for(n=0;16>n;++n)r+=t[e-1+32*n]+t[e+n-32];ge(r>>5,t,e)}function ye(t,e){var n,r=8;for(n=0;16>n;++n)r+=t[e-1+32*n];ge(r>>4,t,e)}function _e(t,e){var n,r=8;for(n=0;16>n;++n)r+=t[e+n-32];ge(r>>4,t,e)}function xe(t,e){ge(128,t,e)}function be(t,e,n){return t+2*e+n+2>>2}function we(t,e){var n,i=e-32;for(i=new Uint8Array([be(t[i-1],t[i+0],t[i+1]),be(t[i+0],t[i+1],t[i+2]),be(t[i+1],t[i+2],t[i+3]),be(t[i+2],t[i+3],t[i+4])]),n=0;4>n;++n)r(t,e+32*n,i,0,i.length)}function Se(t,e){var n=t[e-1],r=t[e-1+32],i=t[e-1+64],o=t[e-1+96];P(t,e+0,16843009*be(t[e-1-32],n,r)),P(t,e+32,16843009*be(n,r,i)),P(t,e+64,16843009*be(r,i,o)),P(t,e+96,16843009*be(i,o,o))}function Ee(t,e){var n,r=4;for(n=0;4>n;++n)r+=t[e+n-32]+t[e-1+32*n];for(r>>=3,n=0;4>n;++n)i(t,e+32*n,r,4)}function ke(t,e){var n=t[e-1+0],r=t[e-1+32],i=t[e-1+64],o=t[e-1-32],a=t[e+0-32],s=t[e+1-32],l=t[e+2-32],u=t[e+3-32];t[e+0+96]=be(r,i,t[e-1+96]),t[e+1+96]=t[e+0+64]=be(n,r,i),t[e+2+96]=t[e+1+64]=t[e+0+32]=be(o,n,r),t[e+3+96]=t[e+2+64]=t[e+1+32]=t[e+0+0]=be(a,o,n),t[e+3+64]=t[e+2+32]=t[e+1+0]=be(s,a,o),t[e+3+32]=t[e+2+0]=be(l,s,a),t[e+3+0]=be(u,l,s)}function Ce(t,e){var n=t[e+1-32],r=t[e+2-32],i=t[e+3-32],o=t[e+4-32],a=t[e+5-32],s=t[e+6-32],l=t[e+7-32];t[e+0+0]=be(t[e+0-32],n,r),t[e+1+0]=t[e+0+32]=be(n,r,i),t[e+2+0]=t[e+1+32]=t[e+0+64]=be(r,i,o),t[e+3+0]=t[e+2+32]=t[e+1+64]=t[e+0+96]=be(i,o,a),t[e+3+32]=t[e+2+64]=t[e+1+96]=be(o,a,s),t[e+3+64]=t[e+2+96]=be(a,s,l),t[e+3+96]=be(s,l,l)}function Ie(t,e){var n=t[e-1+0],r=t[e-1+32],i=t[e-1+64],o=t[e-1-32],a=t[e+0-32],s=t[e+1-32],l=t[e+2-32],u=t[e+3-32];t[e+0+0]=t[e+1+64]=o+a+1>>1,t[e+1+0]=t[e+2+64]=a+s+1>>1,t[e+2+0]=t[e+3+64]=s+l+1>>1,t[e+3+0]=l+u+1>>1,t[e+0+96]=be(i,r,n),t[e+0+64]=be(r,n,o),t[e+0+32]=t[e+1+96]=be(n,o,a),t[e+1+32]=t[e+2+96]=be(o,a,s),t[e+2+32]=t[e+3+96]=be(a,s,l),t[e+3+32]=be(s,l,u)}function Te(t,e){var n=t[e+0-32],r=t[e+1-32],i=t[e+2-32],o=t[e+3-32],a=t[e+4-32],s=t[e+5-32],l=t[e+6-32],u=t[e+7-32];t[e+0+0]=n+r+1>>1,t[e+1+0]=t[e+0+64]=r+i+1>>1,t[e+2+0]=t[e+1+64]=i+o+1>>1,t[e+3+0]=t[e+2+64]=o+a+1>>1,t[e+0+32]=be(n,r,i),t[e+1+32]=t[e+0+96]=be(r,i,o),t[e+2+32]=t[e+1+96]=be(i,o,a),t[e+3+32]=t[e+2+96]=be(o,a,s),t[e+3+64]=be(a,s,l),t[e+3+96]=be(s,l,u)}function Pe(t,e){var n=t[e-1+0],r=t[e-1+32],i=t[e-1+64],o=t[e-1+96];t[e+0+0]=n+r+1>>1,t[e+2+0]=t[e+0+32]=r+i+1>>1,t[e+2+32]=t[e+0+64]=i+o+1>>1,t[e+1+0]=be(n,r,i),t[e+3+0]=t[e+1+32]=be(r,i,o),t[e+3+32]=t[e+1+64]=be(i,o,o),t[e+3+64]=t[e+2+64]=t[e+0+96]=t[e+1+96]=t[e+2+96]=t[e+3+96]=o}function Ae(t,e){var n=t[e-1+0],r=t[e-1+32],i=t[e-1+64],o=t[e-1+96],a=t[e-1-32],s=t[e+0-32],l=t[e+1-32],u=t[e+2-32];t[e+0+0]=t[e+2+32]=n+a+1>>1,t[e+0+32]=t[e+2+64]=r+n+1>>1,t[e+0+64]=t[e+2+96]=i+r+1>>1,t[e+0+96]=o+i+1>>1,t[e+3+0]=be(s,l,u),t[e+2+0]=be(a,s,l),t[e+1+0]=t[e+3+32]=be(n,a,s),t[e+1+32]=t[e+3+64]=be(r,n,a),t[e+1+64]=t[e+3+96]=be(i,r,n),t[e+1+96]=be(o,i,r)}function Me(t,e){var n;for(n=0;8>n;++n)r(t,e+32*n,t,e-32,8)}function Le(t,e){var n;for(n=0;8>n;++n)i(t,e,t[e-1],8),e+=32}function Re(t,e,n){var r;for(r=0;8>r;++r)i(e,n+32*r,t,8)}function De(t,e){var n,r=8;for(n=0;8>n;++n)r+=t[e+n-32]+t[e-1+32*n];Re(r>>4,t,e)}function Ne(t,e){var n,r=4;for(n=0;8>n;++n)r+=t[e+n-32];Re(r>>3,t,e)}function ze(t,e){var n,r=4;for(n=0;8>n;++n)r+=t[e-1+32*n];Re(r>>3,t,e)}function Oe(t,e){Re(128,t,e)}function Fe(t,e,n){var r=t[e-n],i=t[e+0],o=3*(i-r)+Lr[1020+t[e-2*n]-t[e+n]],a=Rr[112+(o+4>>3)];t[e-n]=Dr[255+r+Rr[112+(o+3>>3)]],t[e+0]=Dr[255+i-a]}function Be(t,e,n,r){var i=t[e+0],o=t[e+n];return Nr[255+t[e-2*n]-t[e-n]]>r||Nr[255+o-i]>r}function je(t,e,n,r){return 4*Nr[255+t[e-n]-t[e+0]]+Nr[255+t[e-2*n]-t[e+n]]<=r}function Ue(t,e,n,r,i){var o=t[e-3*n],a=t[e-2*n],s=t[e-n],l=t[e+0],u=t[e+n],c=t[e+2*n],h=t[e+3*n];return 4*Nr[255+s-l]+Nr[255+a-u]>r?0:Nr[255+t[e-4*n]-o]<=i&&Nr[255+o-a]<=i&&Nr[255+a-s]<=i&&Nr[255+h-c]<=i&&Nr[255+c-u]<=i&&Nr[255+u-l]<=i}function Ve(t,e,n,r){var i=2*r+1;for(r=0;16>r;++r)je(t,e+r,n,i)&&Fe(t,e+r,n)}function Ze(t,e,n,r){var i=2*r+1;for(r=0;16>r;++r)je(t,e+r*n,1,i)&&Fe(t,e+r*n,1)}function qe(t,e,n,r){var i;for(i=3;0<i;--i)Ve(t,e+=4*n,n,r)}function Ge(t,e,n,r){var i;for(i=3;0<i;--i)Ze(t,e+=4,n,r)}function We(t,e,n,r,i,o,a,s){for(o=2*o+1;0<i--;){if(Ue(t,e,n,o,a))if(Be(t,e,n,s))Fe(t,e,n);else{var l=t,u=e,c=n,h=l[u-2*c],f=l[u-c],p=l[u+0],d=l[u+c],m=l[u+2*c],g=27*(y=Lr[1020+3*(p-f)+Lr[1020+h-d]])+63>>7,v=18*y+63>>7,y=9*y+63>>7;l[u-3*c]=Dr[255+l[u-3*c]+y],l[u-2*c]=Dr[255+h+v],l[u-c]=Dr[255+f+g],l[u+0]=Dr[255+p-g],l[u+c]=Dr[255+d-v],l[u+2*c]=Dr[255+m-y]}e+=r}}function Xe(t,e,n,r,i,o,a,s){for(o=2*o+1;0<i--;){if(Ue(t,e,n,o,a))if(Be(t,e,n,s))Fe(t,e,n);else{var l=t,u=e,c=n,h=l[u-c],f=l[u+0],p=l[u+c],d=Rr[112+(4+(m=3*(f-h))>>3)],m=Rr[112+(m+3>>3)],g=d+1>>1;l[u-2*c]=Dr[255+l[u-2*c]+g],l[u-c]=Dr[255+h+m],l[u+0]=Dr[255+f-d],l[u+c]=Dr[255+p-g]}e+=r}}function He(t,e,n,r,i,o){We(t,e,n,1,16,r,i,o)}function Ye(t,e,n,r,i,o){We(t,e,1,n,16,r,i,o)}function $e(t,e,n,r,i,o){var a;for(a=3;0<a;--a)Xe(t,e+=4*n,n,1,16,r,i,o)}function Ke(t,e,n,r,i,o){var a;for(a=3;0<a;--a)Xe(t,e+=4,1,n,16,r,i,o)}function Je(t,e,n,r,i,o,a,s){We(t,e,i,1,8,o,a,s),We(n,r,i,1,8,o,a,s)}function Qe(t,e,n,r,i,o,a,s){We(t,e,1,i,8,o,a,s),We(n,r,1,i,8,o,a,s)}function tn(t,e,n,r,i,o,a,s){Xe(t,e+4*i,i,1,8,o,a,s),Xe(n,r+4*i,i,1,8,o,a,s)}function en(t,e,n,r,i,o,a,s){Xe(t,e+4,1,i,8,o,a,s),Xe(n,r+4,1,i,8,o,a,s)}function nn(){this.ba=new at,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function on(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function an(){this.ua=0,this.Wa=new N,this.vb=new N,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new h}function sn(){this.xb=this.a=0,this.l=new Wt,this.ca=new at,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new b,this.Pb=0,this.wd=new b,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new an,this.ab=0,this.gc=a(4,on),this.Oc=0}function ln(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Wt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function un(t,e,n,r,i,o,a){for(t=null==t?0:t[e+0],e=0;e<a;++e)i[o+e]=t+n[r+e]&255,t=i[o+e]}function cn(t,e,n,r,i,o,a){var s;if(null==t)un(null,null,n,r,i,o,a);else for(s=0;s<a;++s)i[o+s]=t[e+s]+n[r+s]&255}function hn(t,e,n,r,i,o,a){if(null==t)un(null,null,n,r,i,o,a);else{var s,l=t[e+0],u=l,c=l;for(s=0;s<a;++s)u=c+(l=t[e+s])-u,c=n[r+s]+(-256&u?0>u?0:255:u)&255,u=l,i[o+s]=c}}function fn(t,n,i,a){var s=n.width,l=n.o;if(e(null!=t&&null!=n),0>i||0>=a||i+a>l)return null;if(!t.Cc){if(null==t.ga){var u;if(t.ga=new ln,(u=null==t.ga)||(u=n.width*n.o,e(0==t.Gb.length),t.Gb=o(u),t.Uc=0,null==t.Gb?u=0:(t.mb=t.Gb,t.nb=t.Uc,t.rc=null,u=1),u=!u),!u){u=t.ga;var c=t.Fa,h=t.P,f=t.qc,p=t.mb,d=t.nb,m=h+1,g=f-1,y=u.l;if(e(null!=c&&null!=p&&null!=n),gi[0]=null,gi[1]=un,gi[2]=cn,gi[3]=hn,u.ca=p,u.tb=d,u.c=n.width,u.i=n.height,e(0<u.c&&0<u.i),1>=f)n=0;else if(u.$a=c[h+0]>>0&3,u.Z=c[h+0]>>2&3,u.Lc=c[h+0]>>4&3,h=c[h+0]>>6&3,0>u.$a||1<u.$a||4<=u.Z||1<u.Lc||h)n=0;else if(y.put=pt,y.ac=ft,y.bc=dt,y.ma=u,y.width=n.width,y.height=n.height,y.Da=n.Da,y.v=n.v,y.va=n.va,y.j=n.j,y.o=n.o,u.$a)t:{e(1==u.$a),n=Tt();e:for(;;){if(null==n){n=0;break t}if(e(null!=u),u.mc=n,n.c=u.c,n.i=u.i,n.l=u.l,n.l.ma=u,n.l.width=u.c,n.l.height=u.i,n.a=0,v(n.m,c,m,g),!Pt(u.c,u.i,1,n,null))break e;if(1==n.ab&&3==n.gc[0].hc&&St(n.s)?(u.ic=1,c=n.c*n.i,n.Ta=null,n.Ua=0,n.V=o(c),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(u.ic=0,n=At(n,u.c)),!n)break e;n=1;break t}u.mc=null,n=0}else n=g>=u.c*u.i;u=!n}if(u)return null;1!=t.ga.Lc?t.Ga=0:a=l-i}e(null!=t.ga),e(i+a<=l);t:{if(n=(c=t.ga).c,l=c.l.o,0==c.$a){if(m=t.rc,g=t.Vc,y=t.Fa,h=t.P+1+i*n,f=t.mb,p=t.nb+i*n,e(h<=t.P+t.qc),0!=c.Z)for(e(null!=gi[c.Z]),u=0;u<a;++u)gi[c.Z](m,g,y,h,f,p,n),m=f,g=p,p+=n,h+=n;else for(u=0;u<a;++u)r(f,p,y,h,n),m=f,g=p,p+=n,h+=n;t.rc=m,t.Vc=g}else{if(e(null!=c.mc),n=i+a,e(null!=(u=c.mc)),e(n<=u.i),u.C>=n)n=1;else if(c.ic||vn(),c.ic){c=u.V,m=u.Ba,g=u.c;var _=u.i,x=(y=1,h=u.$/g,f=u.$%g,p=u.m,d=u.s,u.$),b=g*_,w=g*n,E=d.wc,C=x<w?xt(d,f,h):null;e(x<=b),e(n<=_),e(St(d));e:for(;;){for(;!p.h&&x<w;){if(f&E||(C=xt(d,f,h)),e(null!=C),k(p),256>(_=yt(C.G[0],C.H[0],p)))c[m+x]=_,++x,++f>=g&&(f=0,++h<=n&&!(h%16)&&kt(u,h));else{if(!(280>_)){y=0;break e}_=gt(_-256,p);var I,T=yt(C.G[4],C.H[4],p);if(k(p),!(x>=(T=vt(g,T=gt(T,p)))&&b-x>=_)){y=0;break e}for(I=0;I<_;++I)c[m+x+I]=c[m+x+I-T];for(x+=_,f+=_;f>=g;)f-=g,++h<=n&&!(h%16)&&kt(u,h);x<w&&f&E&&(C=xt(d,f,h))}e(p.h==S(p))}kt(u,h>n?n:h);break e}!y||p.h&&x<b?(y=0,u.a=p.h?5:3):u.$=x,n=y}else n=Ct(u,u.V,u.Ba,u.c,u.i,n,Mt);if(!n){a=0;break t}}i+a>=l&&(t.Cc=1),a=1}if(!a)return null;if(t.Cc&&(null!=(a=t.ga)&&(a.mc=null),t.ga=null,0<t.Ga))return alert("todo:WebPDequantizeLevels"),null}return t.nb+i*s}function pn(t,e,n,r,i,o){for(;0<i--;){var a,s=t,l=e+(n?1:0),u=t,c=e+(n?0:3);for(a=0;a<r;++a){var h=u[c+4*a];255!=h&&(h*=32897,s[l+4*a+0]=s[l+4*a+0]*h>>23,s[l+4*a+1]=s[l+4*a+1]*h>>23,s[l+4*a+2]=s[l+4*a+2]*h>>23)}e+=o}}function dn(t,e,n,r,i){for(;0<r--;){var o;for(o=0;o<n;++o){var a=t[e+2*o+0],s=15&(u=t[e+2*o+1]),l=4369*s,u=(240&u|u>>4)*l>>16;t[e+2*o+0]=(240&a|a>>4)*l>>16&240|(15&a|a<<4)*l>>16>>4&15,t[e+2*o+1]=240&u|s}e+=i}}function mn(t,e,n,r,i,o,a,s){var l,u,c=255;for(u=0;u<i;++u){for(l=0;l<r;++l){var h=t[e+l];o[a+4*l]=h,c&=h}e+=n,a+=s}return 255!=c}function gn(t,e,n,r,i){var o;for(o=0;o<i;++o)n[r+o]=t[e+o]>>8}function vn(){Sr=pn,Er=dn,kr=mn,Cr=gn}function yn(n,r,i){t[n]=function(t,n,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_){var x,b=_-1>>1,w=s[l+0]|u[c+0]<<16,S=h[f+0]|p[d+0]<<16;e(null!=t);var E=3*w+S+131074>>2;for(r(t[n+0],255&E,E>>16,m,g),null!=o&&(E=3*S+w+131074>>2,r(o[a+0],255&E,E>>16,v,y)),x=1;x<=b;++x){var k=s[l+x]|u[c+x]<<16,C=h[f+x]|p[d+x]<<16,I=w+k+S+C+524296,T=I+2*(k+S)>>3;E=T+w>>1,w=(I=I+2*(w+C)>>3)+k>>1,r(t[n+2*x-1],255&E,E>>16,m,g+(2*x-1)*i),r(t[n+2*x-0],255&w,w>>16,m,g+(2*x-0)*i),null!=o&&(E=I+S>>1,w=T+C>>1,r(o[a+2*x-1],255&E,E>>16,v,y+(2*x-1)*i),r(o[a+2*x+0],255&w,w>>16,v,y+(2*x+0)*i)),w=k,S=C}1&_||(E=3*w+S+131074>>2,r(t[n+_-1],255&E,E>>16,m,g+(_-1)*i),null!=o&&(E=3*S+w+131074>>2,r(o[a+_-1],255&E,E>>16,v,y+(_-1)*i)))}}function _n(){vi[zr]=yi,vi[Or]=xi,vi[Fr]=_i,vi[Br]=bi,vi[jr]=wi,vi[Ur]=Si,vi[Vr]=Ei,vi[Zr]=xi,vi[qr]=bi,vi[Gr]=wi,vi[Wr]=Si}function xn(t){return t&~Ai?0>t?0:255:t>>Pi}function bn(t,e){return xn((19077*t>>8)+(26149*e>>8)-14234)}function wn(t,e,n){return xn((19077*t>>8)-(6419*e>>8)-(13320*n>>8)+8708)}function Sn(t,e){return xn((19077*t>>8)+(33050*e>>8)-17685)}function En(t,e,n,r,i){r[i+0]=bn(t,n),r[i+1]=wn(t,e,n),r[i+2]=Sn(t,e)}function kn(t,e,n,r,i){r[i+0]=Sn(t,e),r[i+1]=wn(t,e,n),r[i+2]=bn(t,n)}function Cn(t,e,n,r,i){var o=wn(t,e,n);e=o<<3&224|Sn(t,e)>>3,r[i+0]=248&bn(t,n)|o>>5,r[i+1]=e}function In(t,e,n,r,i){var o=240&Sn(t,e)|15;r[i+0]=240&bn(t,n)|wn(t,e,n)>>4,r[i+1]=o}function Tn(t,e,n,r,i){r[i+0]=255,En(t,e,n,r,i+1)}function Pn(t,e,n,r,i){kn(t,e,n,r,i),r[i+3]=255}function An(t,e,n,r,i){En(t,e,n,r,i),r[i+3]=255}function Gt(t,e){return 0>t?0:t>e?e:t}function Mn(e,n,r){t[e]=function(t,e,i,o,a,s,l,u,c){for(var h=u+(-2&c)*r;u!=h;)n(t[e+0],i[o+0],a[s+0],l,u),n(t[e+1],i[o+0],a[s+0],l,u+r),e+=2,++o,++s,u+=2*r;1&c&&n(t[e+0],i[o+0],a[s+0],l,u)}}function Ln(t,e,n){return 0==n?0==t?0==e?6:5:0==e?4:0:n}function Rn(t,e,n,r,i){switch(t>>>30){case 3:ar(e,n,r,i,0);break;case 2:sr(e,n,r,i);break;case 1:ur(e,n,r,i)}}function Dn(t,e){var n,o,a=e.M,s=e.Nb,l=t.oc,u=t.pc+40,c=t.oc,h=t.pc+584,f=t.oc,p=t.pc+600;for(n=0;16>n;++n)l[u+32*n-1]=129;for(n=0;8>n;++n)c[h+32*n-1]=129,f[p+32*n-1]=129;for(0<a?l[u-1-32]=c[h-1-32]=f[p-1-32]=129:(i(l,u-32-1,127,21),i(c,h-32-1,127,9),i(f,p-32-1,127,9)),o=0;o<t.za;++o){var d=e.ya[e.aa+o];if(0<o){for(n=-1;16>n;++n)r(l,u+32*n-4,l,u+32*n+12,4);for(n=-1;8>n;++n)r(c,h+32*n-4,c,h+32*n+4,4),r(f,p+32*n-4,f,p+32*n+4,4)}var m=t.Gd,g=t.Hd+o,v=d.ad,y=d.Hc;if(0<a&&(r(l,u-32,m[g].y,0,16),r(c,h-32,m[g].f,0,8),r(f,p-32,m[g].ea,0,8)),d.Za){var _=l,x=u-32+16;for(0<a&&(o>=t.za-1?i(_,x,m[g].y[15],4):r(_,x,m[g+1].y,0,4)),n=0;4>n;n++)_[x+128+n]=_[x+256+n]=_[x+384+n]=_[x+0+n];for(n=0;16>n;++n,y<<=2)_=l,x=u+Fi[n],fi[d.Ob[n]](_,x),Rn(y,v,16*+n,_,x)}else if(_=Ln(o,a,d.Ob[0]),hi[_](l,u),0!=y)for(n=0;16>n;++n,y<<=2)Rn(y,v,16*+n,l,u+Fi[n]);for(n=d.Gc,_=Ln(o,a,d.Dd),pi[_](c,h),pi[_](f,p),y=v,_=c,x=h,255&(d=n>>0)&&(170&d?lr(y,256,_,x):cr(y,256,_,x)),d=f,y=p,255&(n>>=8)&&(170&n?lr(v,320,d,y):cr(v,320,d,y)),a<t.Ub-1&&(r(m[g].y,0,l,u+480,16),r(m[g].f,0,c,h+224,8),r(m[g].ea,0,f,p+224,8)),n=8*s*t.B,m=t.sa,g=t.ta+16*o+16*s*t.R,v=t.qa,d=t.ra+8*o+n,y=t.Ha,_=t.Ia+8*o+n,n=0;16>n;++n)r(m,g+n*t.R,l,u+32*n,16);for(n=0;8>n;++n)r(v,d+n*t.B,c,h+32*n,8),r(y,_+n*t.B,f,p+32*n,8)}}function Nn(t,r,i,o,a,s,l,u,c){var h=[0],f=[0],p=0,d=null!=c?c.kd:0,m=null!=c?c:new rn;if(null==t||12>i)return 7;m.data=t,m.w=r,m.ha=i,r=[r],i=[i],m.gb=[m.gb];t:{var g=r,y=i,_=m.gb;if(e(null!=t),e(null!=y),e(null!=_),_[0]=0,12<=y[0]&&!n(t,g[0],"RIFF")){if(n(t,g[0]+8,"WEBP")){_=3;break t}var x=L(t,g[0]+4);if(12>x||4294967286<x){_=3;break t}if(d&&x>y[0]-8){_=7;break t}_[0]=x,g[0]+=12,y[0]-=12}_=0}if(0!=_)return _;for(x=0<m.gb[0],i=i[0];;){t:{var w=t;y=r,_=i;var S=h,E=f,k=g=[0];if((T=p=[p])[0]=0,8>_[0])_=7;else{if(!n(w,y[0],"VP8X")){if(10!=L(w,y[0]+4)){_=3;break t}if(18>_[0]){_=7;break t}var C=L(w,y[0]+8),I=1+M(w,y[0]+12);if(2147483648<=I*(w=1+M(w,y[0]+15))){_=3;break t}null!=k&&(k[0]=C),null!=S&&(S[0]=I),null!=E&&(E[0]=w),y[0]+=18,_[0]-=18,T[0]=1}_=0}}if(p=p[0],g=g[0],0!=_)return _;if(y=!!(2&g),!x&&p)return 3;if(null!=s&&(s[0]=!!(16&g)),null!=l&&(l[0]=y),null!=u&&(u[0]=0),l=h[0],g=f[0],p&&y&&null==c){_=0;break}if(4>i){_=7;break}if(x&&p||!x&&!p&&!n(t,r[0],"ALPH")){i=[i],m.na=[m.na],m.P=[m.P],m.Sa=[m.Sa];t:{C=t,_=r,x=i;var T=m.gb;S=m.na,E=m.P,k=m.Sa,I=22,e(null!=C),e(null!=x),w=_[0];var P=x[0];for(e(null!=S),e(null!=k),S[0]=null,E[0]=null,k[0]=0;;){if(_[0]=w,x[0]=P,8>P){_=7;break t}var A=L(C,w+4);if(4294967286<A){_=3;break t}var R=8+A+1&-2;if(I+=R,0<T&&I>T){_=3;break t}if(!n(C,w,"VP8 ")||!n(C,w,"VP8L")){_=0;break t}if(P[0]<R){_=7;break t}n(C,w,"ALPH")||(S[0]=C,E[0]=w+8,k[0]=A),w+=R,P-=R}}if(i=i[0],m.na=m.na[0],m.P=m.P[0],m.Sa=m.Sa[0],0!=_)break}i=[i],m.Ja=[m.Ja],m.xa=[m.xa];t:if(T=t,_=r,x=i,S=m.gb[0],E=m.Ja,k=m.xa,C=_[0],w=!n(T,C,"VP8 "),I=!n(T,C,"VP8L"),e(null!=T),e(null!=x),e(null!=E),e(null!=k),8>x[0])_=7;else{if(w||I){if(T=L(T,C+4),12<=S&&T>S-12){_=3;break t}if(d&&T>x[0]-8){_=7;break t}E[0]=T,_[0]+=8,x[0]-=8,k[0]=I}else k[0]=5<=x[0]&&47==T[C+0]&&!(T[C+4]>>5),E[0]=x[0];_=0}if(i=i[0],m.Ja=m.Ja[0],m.xa=m.xa[0],r=r[0],0!=_)break;if(4294967286<m.Ja)return 3;if(null==u||y||(u[0]=m.xa?2:1),l=[l],g=[g],m.xa){if(5>i){_=7;break}u=l,d=g,y=s,null==t||5>i?t=0:5<=i&&47==t[r+0]&&!(t[r+4]>>5)?(x=[0],T=[0],S=[0],v(E=new b,t,r,i),mt(E,x,T,S)?(null!=u&&(u[0]=x[0]),null!=d&&(d[0]=T[0]),null!=y&&(y[0]=S[0]),t=1):t=0):t=0}else{if(10>i){_=7;break}u=g,null==t||10>i||!Yt(t,r+3,i-3)?t=0:(d=t[r+0]|t[r+1]<<8|t[r+2]<<16,y=16383&(t[r+7]<<8|t[r+6]),t=16383&(t[r+9]<<8|t[r+8]),1&d||3<(d>>1&7)||!(d>>4&1)||d>>5>=m.Ja||!y||!t?t=0:(l&&(l[0]=y),u&&(u[0]=t),t=1))}if(!t)return 3;if(l=l[0],g=g[0],p&&(h[0]!=l||f[0]!=g))return 3;null!=c&&(c[0]=m,c.offset=r-c.w,e(4294967286>r-c.w),e(c.offset==c.ha-i));break}return 0==_||7==_&&p&&null==c?(null!=s&&(s[0]|=null!=m.na&&0<m.na.length),null!=o&&(o[0]=l),null!=a&&(a[0]=g),0):_}function zn(t,e,n){var r=e.width,i=e.height,o=0,a=0,s=r,l=i;if(e.Da=null!=t&&0<t.Da,e.Da&&(s=t.cd,l=t.bd,o=t.v,a=t.j,11>n||(o&=-2,a&=-2),0>o||0>a||0>=s||0>=l||o+s>r||a+l>i))return 0;if(e.v=o,e.j=a,e.va=o+s,e.o=a+l,e.U=s,e.T=l,e.da=null!=t&&0<t.da,e.da){if(!z(s,l,n=[t.ib],o=[t.hb]))return 0;e.ib=n[0],e.hb=o[0]}return e.ob=null!=t&&t.ob,e.Kb=null==t||!t.Sd,e.da&&(e.ob=e.ib<3*r/4&&e.hb<3*i/4,e.Kb=0),1}function On(t){if(null==t)return 2;if(11>t.S){var e=t.f.RGBA;e.fb+=(t.height-1)*e.A,e.A=-e.A}else e=t.f.kb,t=t.height,e.O+=(t-1)*e.fa,e.fa=-e.fa,e.N+=(t-1>>1)*e.Ab,e.Ab=-e.Ab,e.W+=(t-1>>1)*e.Db,e.Db=-e.Db,null!=e.F&&(e.J+=(t-1)*e.lb,e.lb=-e.lb);return 0}function Fn(t,e,n,r){if(null==r||0>=t||0>=e)return 2;if(null!=n){if(n.Da){var i=n.cd,a=n.bd,s=-2&n.v,l=-2&n.j;if(0>s||0>l||0>=i||0>=a||s+i>t||l+a>e)return 2;t=i,e=a}if(n.da){if(!z(t,e,i=[n.ib],a=[n.hb]))return 2;t=i[0],e=a[0]}}r.width=t,r.height=e;t:{var u=r.width,c=r.height;if(t=r.S,0>=u||0>=c||!(t>=zr&&13>t))t=2;else{if(0>=r.Rd&&null==r.sd){s=a=i=e=0;var h=(l=u*Vi[t])*c;if(11>t||(a=(c+1)/2*(e=(u+1)/2),12==t&&(s=(i=u)*c)),null==(c=o(h+2*a+s))){t=1;break t}r.sd=c,11>t?((u=r.f.RGBA).eb=c,u.fb=0,u.A=l,u.size=h):((u=r.f.kb).y=c,u.O=0,u.fa=l,u.Fd=h,u.f=c,u.N=0+h,u.Ab=e,u.Cd=a,u.ea=c,u.W=0+h+a,u.Db=e,u.Ed=a,12==t&&(u.F=c,u.J=0+h+2*a),u.Tc=s,u.lb=i)}if(e=1,i=r.S,a=r.width,s=r.height,i>=zr&&13>i)if(11>i)t=r.f.RGBA,e&=(l=Math.abs(t.A))*(s-1)+a<=t.size,e&=l>=a*Vi[i],e&=null!=t.eb;else{t=r.f.kb,l=(a+1)/2,h=(s+1)/2,u=Math.abs(t.fa),c=Math.abs(t.Ab);var f=Math.abs(t.Db),p=Math.abs(t.lb),d=p*(s-1)+a;e&=u*(s-1)+a<=t.Fd,e&=c*(h-1)+l<=t.Cd,e=(e&=f*(h-1)+l<=t.Ed)&u>=a&c>=l&f>=l,e&=null!=t.y,e&=null!=t.f,e&=null!=t.ea,12==i&&(e&=p>=a,e&=d<=t.Tc,e&=null!=t.F)}else e=0;t=e?0:2}}return 0!=t||null!=n&&n.fd&&(t=On(r)),t}var Bn=64,jn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Un=24,Vn=32,Zn=8,qn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),t.Predictor0=function(){return 4278190080},t.Predictor1=function(t){return t},t.Predictor2=function(t,e,n){return e[n+0]},t.Predictor3=function(t,e,n){return e[n+1]},t.Predictor4=function(t,e,n){return e[n-1]},t.Predictor5=function(t,e,n){return U(U(t,e[n+1]),e[n+0])},t.Predictor6=function(t,e,n){return U(t,e[n-1])},t.Predictor7=function(t,e,n){return U(t,e[n+0])},t.Predictor8=function(t,e,n){return U(e[n-1],e[n+0])},t.Predictor9=function(t,e,n){return U(e[n+0],e[n+1])},t.Predictor10=function(t,e,n){return U(U(t,e[n-1]),U(e[n+0],e[n+1]))},t.Predictor11=function(t,e,n){var r=e[n+0];return 0>=q(r>>24&255,t>>24&255,(e=e[n-1])>>24&255)+q(r>>16&255,t>>16&255,e>>16&255)+q(r>>8&255,t>>8&255,e>>8&255)+q(255&r,255&t,255&e)?r:t},t.Predictor12=function(t,e,n){var r=e[n+0];return(V((t>>24&255)+(r>>24&255)-((e=e[n-1])>>24&255))<<24|V((t>>16&255)+(r>>16&255)-(e>>16&255))<<16|V((t>>8&255)+(r>>8&255)-(e>>8&255))<<8|V((255&t)+(255&r)-(255&e)))>>>0},t.Predictor13=function(t,e,n){var r=e[n-1];return(Z((t=U(t,e[n+0]))>>24&255,r>>24&255)<<24|Z(t>>16&255,r>>16&255)<<16|Z(t>>8&255,r>>8&255)<<8|Z(t>>0&255,r>>0&255))>>>0};var Gn=t.PredictorAdd0;t.PredictorAdd1=G,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Wn=t.PredictorAdd2;Y("ColorIndexInverseTransform","MapARGB","32b",(function(t){return t>>8&255}),(function(t){return t})),Y("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(t){return t}),(function(t){return t>>8&255}));var Xn,Hn=t.ColorIndexInverseTransform,Yn=t.MapARGB,$n=t.VP8LColorIndexInverseTransformAlpha,Kn=t.MapAlpha,Jn=t.VP8LPredictorsAdd=[];Jn.length=16,(t.VP8LPredictors=[]).length=16,(t.VP8LPredictorsAdd_C=[]).length=16,(t.VP8LPredictors_C=[]).length=16;var Qn,tr,er,nr,rr,ir,or,ar,sr,lr,ur,cr,hr,fr,pr,dr,mr,gr,vr,yr,_r,xr,br,wr,Sr,Er,kr,Cr,Ir=o(511),Tr=o(2041),Pr=o(225),Ar=o(767),Mr=0,Lr=Tr,Rr=Pr,Dr=Ar,Nr=Ir,zr=0,Or=1,Fr=2,Br=3,jr=4,Ur=5,Vr=6,Zr=7,qr=8,Gr=9,Wr=10,Xr=[2,3,7],Hr=[3,3,11],Yr=[280,256,256,256,40],$r=[0,1,1,1,0],Kr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Jr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Qr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ti=8,ei=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ni=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ri=null,ii=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],oi=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ai=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],si=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],li=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ui=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ci=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hi=[],fi=[],pi=[],di=1,mi=2,gi=[],vi=[];yn("UpsampleRgbLinePair",En,3),yn("UpsampleBgrLinePair",kn,3),yn("UpsampleRgbaLinePair",An,4),yn("UpsampleBgraLinePair",Pn,4),yn("UpsampleArgbLinePair",Tn,4),yn("UpsampleRgba4444LinePair",In,2),yn("UpsampleRgb565LinePair",Cn,2);var yi=t.UpsampleRgbLinePair,_i=t.UpsampleBgrLinePair,xi=t.UpsampleRgbaLinePair,bi=t.UpsampleBgraLinePair,wi=t.UpsampleArgbLinePair,Si=t.UpsampleRgba4444LinePair,Ei=t.UpsampleRgb565LinePair,ki=16,Ci=1<<ki-1,Ii=-227,Ti=482,Pi=6,Ai=(256<<Pi)-1,Mi=0,Li=o(256),Ri=o(256),Di=o(256),Ni=o(256),zi=o(Ti-Ii),Oi=o(Ti-Ii);Mn("YuvToRgbRow",En,3),Mn("YuvToBgrRow",kn,3),Mn("YuvToRgbaRow",An,4),Mn("YuvToBgraRow",Pn,4),Mn("YuvToArgbRow",Tn,4),Mn("YuvToRgba4444Row",In,2),Mn("YuvToRgb565Row",Cn,2);var Fi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Bi=[0,2,8],ji=[8,7,6,4,4,2,2,2,1,1,1,1],Ui=1;this.WebPDecodeRGBA=function(t,n,r,i,o){var a=Or,s=new nn,l=new at;s.ba=l,l.S=a,l.width=[l.width],l.height=[l.height];var u=l.width,c=l.height,h=new st;if(null==h||null==t)var f=2;else e(null!=h),f=Nn(t,n,r,h.width,h.height,h.Pd,h.Qd,h.format,null);if(0!=f?u=0:(null!=u&&(u[0]=h.width[0]),null!=c&&(c[0]=h.height[0]),u=1),u){l.width=l.width[0],l.height=l.height[0],null!=i&&(i[0]=l.width),null!=o&&(o[0]=l.height);t:{if(i=new Wt,(o=new rn).data=t,o.w=n,o.ha=r,o.kd=1,n=[0],e(null!=o),(0==(t=Nn(o.data,o.w,o.ha,null,null,null,n,null,o))||7==t)&&n[0]&&(t=4),0==(n=t)){if(e(null!=s),i.data=o.data,i.w=o.w+o.offset,i.ha=o.ha-o.offset,i.put=pt,i.ac=ft,i.bc=dt,i.ma=s,o.xa){if(null==(t=Tt())){s=1;break t}if(function(t,n){var r=[0],i=[0],o=[0];e:for(;;){if(null==t)return 0;if(null==n)return t.a=2,0;if(t.l=n,t.a=0,v(t.m,n.data,n.w,n.ha),!mt(t.m,r,i,o)){t.a=3;break e}if(t.xb=mi,n.width=r[0],n.height=i[0],!Pt(r[0],i[0],1,t,null))break e;return 1}return e(0!=t.a),0}(t,i)){if(i=0==(n=Fn(i.width,i.height,s.Oa,s.ba))){e:{i=t;n:for(;;){if(null==i){i=0;break e}if(e(null!=i.s.yc),e(null!=i.s.Ya),e(0<i.s.Wb),e(null!=(r=i.l)),e(null!=(o=r.ma)),0!=i.xb){if(i.ca=o.ba,i.tb=o.tb,e(null!=i.ca),!zn(o.Oa,r,Br)){i.a=2;break n}if(!At(i,r.width))break n;if(r.da)break n;if((r.da||rt(i.ca.S))&&vn(),11>i.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=i.ca.f.kb.F&&vn()),i.Pb&&0<i.s.ua&&null==i.s.vb.X&&!R(i.s.vb,i.s.Wa.Xa)){i.a=1;break n}i.xb=0}if(!Ct(i,i.V,i.Ba,i.c,i.i,r.o,wt))break n;o.Dc=i.Ma,i=1;break e}e(0!=i.a),i=0}i=!i}i&&(n=t.a)}else n=t.a}else{if(null==(t=new Xt)){s=1;break t}if(t.Fa=o.na,t.P=o.P,t.qc=o.Sa,$t(t,i)){if(0==(n=Fn(i.width,i.height,s.Oa,s.ba))){if(t.Aa=0,r=s.Oa,e(null!=(o=t)),null!=r){if(0<(u=0>(u=r.Md)?0:100<u?255:255*u/100)){for(c=h=0;4>c;++c)12>(f=o.pb[c]).lc&&(f.ia=u*ji[0>f.lc?0:f.lc]>>3),h|=f.ia;h&&(alert("todo:VP8InitRandom"),o.ia=1)}o.Ga=r.Id,100<o.Ga?o.Ga=100:0>o.Ga&&(o.Ga=0)}Qt(t,i)||(n=t.a)}}else n=t.a}0==n&&null!=s.Oa&&s.Oa.fd&&(n=On(s.ba))}s=n}a=0!=s?null:11>a?l.f.RGBA.eb:l.f.kb.y}else a=null;return a};var Vi=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(t,e){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(t[e++]);return n}function c(t,e){return(t[e+0]<<0|t[e+1]<<8|t[e+2]<<16)>>>0}function h(t,e){return(t[e+0]<<0|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}new l;var f=[0],p=[0],d=[],m=new l,g=t,v=function(t,e){var n={},r=0,i=!1,o=0,a=0;if(n.frames=[],!function(t,e,n,r){for(var i=0;i<4;i++)if(t[e+i]!="RIFF".charCodeAt(i))return!0;return!1}(t,e)){var s,l;for(h(t,e+=4),e+=8;e<t.length;){var f=u(t,e),p=h(t,e+=4);e+=4;var d=p+(1&p);switch(f){case"VP8 ":case"VP8L":void 0===n.frames[r]&&(n.frames[r]={}),(v=n.frames[r]).src_off=i?a:e-8,v.src_size=o+p+8,r++,i&&(i=!1,o=0,a=0);break;case"VP8X":(v=n.header={}).feature_flags=t[e];var m=e+4;v.canvas_width=1+c(t,m),m+=3,v.canvas_height=1+c(t,m),m+=3;break;case"ALPH":i=!0,o=d+8,a=e-8;break;case"ANIM":(v=n.header).bgcolor=h(t,e),m=e+4,v.loop_count=(s=t)[(l=m)+0]<<0|s[l+1]<<8,m+=2;break;case"ANMF":var g,v;(v=n.frames[r]={}).offset_x=2*c(t,e),e+=3,v.offset_y=2*c(t,e),e+=3,v.width=1+c(t,e),e+=3,v.height=1+c(t,e),e+=3,v.duration=c(t,e),e+=3,g=t[e++],v.dispose=1&g,v.blend=g>>1&1}"ANMF"!=f&&(e+=d)}return n}}(g,0);v.response=g,v.rgbaoutput=!0,v.dataurl=!1;var y=v.header?v.header:null,_=v.frames?v.frames:null;if(y){y.loop_counter=y.loop_count,f=[y.canvas_height],p=[y.canvas_width];for(var x=0;x<_.length&&0!=_[x].blend;x++);}var b=_[0],w=m.WebPDecodeRGBA(g,b.src_off,b.src_size,p,f);b.rgba=w,b.imgwidth=p[0],b.imgheight=f[0];for(var S=0;S<p[0]*f[0]*4;S++)d[S]=w[S];return this.width=p,this.height=f,this.data=d,this}!function(t){var e=function(e,r,l,u){var c=4,h=o;switch(u){case t.image_compression.FAST:c=1,h=i;break;case t.image_compression.MEDIUM:c=6,h=a;break;case t.image_compression.SLOW:c=9,h=s}var f=ft(e=n(e,r,l,h),{level:c});return t.__addimage__.arrayBufferToBinaryString(f)},n=function(t,e,n,r){for(var i,o,a,s=t.length/e,l=new Uint8Array(t.length+s),h=u(),f=0;f<s;f+=1){if(a=f*e,i=t.subarray(a,a+e),r)l.set(r(i,n,o),a+f);else{for(var p,d=h.length,m=[];p<d;p+=1)m[p]=h[p](i,n,o);var g=c(m.concat());l.set(m[g],a+f)}o=i}return l},r=function(t){var e=Array.apply([],t);return e.unshift(0),e},i=function(t,e){var n,r=[],i=t.length;r[0]=1;for(var o=0;o<i;o+=1)n=t[o-e]||0,r[o+1]=t[o]-n+256&255;return r},o=function(t,e,n){var r,i=[],o=t.length;i[0]=2;for(var a=0;a<o;a+=1)r=n&&n[a]||0,i[a+1]=t[a]-r+256&255;return i},a=function(t,e,n){var r,i,o=[],a=t.length;o[0]=3;for(var s=0;s<a;s+=1)r=t[s-e]||0,i=n&&n[s]||0,o[s+1]=t[s]+256-(r+i>>>1)&255;return o},s=function(t,e,n){var r,i,o,a,s=[],u=t.length;s[0]=4;for(var c=0;c<u;c+=1)r=t[c-e]||0,i=n&&n[c]||0,o=n&&n[c-e]||0,a=l(r,i,o),s[c+1]=t[c]-a+256&255;return s},l=function(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),o=Math.abs(t+e-n-n);return r<=i&&r<=o?t:i<=o?e:n},u=function(){return[r,i,o,a,s]},c=function(t){var e=t.map((function(t){return t.reduce((function(t,e){return t+Math.abs(e)}),0)}));return e.indexOf(Math.min.apply(null,e))};t.processPNG=function(n,r,i,o){var a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b=this.decode.FLATE_DECODE,w="";if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){if(n=(l=new on(n)).imgData,s=l.bits,a=l.colorSpace,c=l.colors,-1!==[4,6].indexOf(l.colorType)){if(8===l.bits){d=(p=32==l.pixelBitlength?new Uint32Array(l.decodePixels().buffer):16==l.pixelBitlength?new Uint16Array(l.decodePixels().buffer):new Uint8Array(l.decodePixels().buffer)).length,g=new Uint8Array(d*l.colors),m=new Uint8Array(d);var S,E=l.pixelBitlength-l.bits;for(_=0,x=0;_<d;_++){for(y=p[_],S=0;S<E;)g[x++]=y>>>S&255,S+=l.bits;m[_]=y>>>S&255}}if(16===l.bits){d=(p=new Uint32Array(l.decodePixels().buffer)).length,g=new Uint8Array(d*(32/l.pixelBitlength)*l.colors),m=new Uint8Array(d*(32/l.pixelBitlength)),v=l.colors>1,_=0,x=0;for(var k=0;_<d;)y=p[_++],g[x++]=y>>>0&255,v&&(g[x++]=y>>>16&255,y=p[_++],g[x++]=y>>>0&255),m[k++]=y>>>16&255;s=8}o!==t.image_compression.NONE?(n=e(g,l.width*l.colors,l.colors,o),f=e(m,l.width,1,o)):(n=g,f=m,b=void 0)}if(3===l.colorType&&(a=this.color_spaces.INDEXED,h=l.palette,l.transparency.indexed)){var C=l.transparency.indexed,I=0;for(_=0,d=C.length;_<d;++_)I+=C[_];if((I/=255)===d-1&&-1!==C.indexOf(0))u=[C.indexOf(0)];else if(I!==d){for(p=l.decodePixels(),m=new Uint8Array(p.length),_=0,d=p.length;_<d;_++)m[_]=C[p[_]];f=e(m,l.width,1)}}var T=function(e){var n;switch(e){case t.image_compression.FAST:n=11;break;case t.image_compression.MEDIUM:n=13;break;case t.image_compression.SLOW:n=14;break;default:n=12}return n}(o);return b===this.decode.FLATE_DECODE&&(w="/Predictor "+T+" "),w+="/Colors "+c+" /BitsPerComponent "+s+" /Columns "+l.width,(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:i,data:n,index:r,filter:b,decodeParameters:w,transparency:u,palette:h,sMask:f,predictor:T,width:l.width,height:l.height,bitsPerComponent:s,colorSpace:a}}}}(Xt.API),function(t){t.processGIF89A=function(e,n,r,i){var o=new an(e),a=o.width,s=o.height,l=[];o.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:a,height:s},c=new ln(100).encode(u,100);return t.processJPEG.call(this,c,n,r,i)},t.processGIF87A=t.processGIF89A}(Xt.API),un.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},un.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(t){gt.log("bit decode error:"+t)}},un.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*i*4,s=0;s<8&&8*i+s<this.width;s++){var l=this.palette[o>>7-s&1];this.data[a+4*s]=l.blue,this.data[a+4*s+1]=l.green,this.data[a+4*s+2]=l.red,this.data[a+4*s+3]=255}0!==n&&(this.pos+=4-n)}},un.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*i*4,s=o>>4,l=15&o,u=this.palette[s];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*i+1>=this.width)break;u=this.palette[l],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}0!==e&&(this.pos+=4-e)}},un.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+4*r;if(i<this.palette.length){var a=this.palette[i];this.data[o]=a.red,this.data[o+1]=a.green,this.data[o+2]=a.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}0!==t&&(this.pos+=4-t)}},un.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&e)/e*255|0,s=(o>>5&e)/e*255|0,l=(o>>10&e)/e*255|0,u=o>>15?255:0,c=r*this.width*4+4*i;this.data[c]=l,this.data[c+1]=s,this.data[c+2]=a,this.data[c+3]=u}this.pos+=t}},un.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,l=(a>>5&n)/n*255|0,u=(a>>11)/e*255|0,c=i*this.width*4+4*o;this.data[c]=u,this.data[c+1]=l,this.data[c+2]=s,this.data[c+3]=255}this.pos+=t}},un.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},un.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=r,this.data[s+3]=a}},un.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var o=new un(e,!1),a=o.width,s=o.height,l={data:o.getData(),width:a,height:s},u=new ln(100).encode(l,100);return t.processJPEG.call(this,u,n,r,i)}}(Xt.API),cn.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var o=new cn(e,!1),a=o.width,s=o.height,l={data:o.getData(),width:a,height:s},u=new ln(100).encode(l,100);return t.processJPEG.call(this,u,n,r,i)}}(Xt.API),Xt.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,o=new Uint8Array(i/4*3),a=new Uint8Array(i/4),s=0,l=0,u=0;u<i;u+=4){var c=r[u],h=r[u+1],f=r[u+2],p=r[u+3];o[s++]=c,o[s++]=h,o[s++]=f,a[l++]=p}var d=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:d,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Xt.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},Qe=Xt.API,tn=Qe.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),s=e.widths?e.widths:i.metadata.Unicode.widths,l=s.fof?s.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,c=u.fof?u.fof:1,h=!1!==e.doKerning,f=0,p=t.length,d=0,m=s[0]||l,g=[];for(n=0;n<p;n++)r=t.charCodeAt(n),"function"==typeof i.metadata.widthOfString?g.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+a*(1e3/o)||0)/1e3):(f=h&&"object"===(0,x.Z)(u[r])&&!isNaN(parseInt(u[r][d],10))?u[r][d]/c:0,g.push((s[r]||m)/l+f)),d=r;return g},en=Qe.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Qe.processArabic&&(t=Qe.processArabic(t)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(t,n,i)/n:tn.apply(this,arguments).reduce((function(t,e){return t+e}),0)},nn=function(t,e,n,r){for(var i=[],o=0,a=t.length,s=0;o!==a&&s+e[o]<n;)s+=e[o],o++;i.push(t.slice(0,o));var l=o;for(s=0;o!==a;)s+e[o]>r&&(i.push(t.slice(l,o)),s=0,l=o),s+=e[o],o++;return l!==o&&i.push(t.slice(l,o)),i},rn=function(t,e,n){n||(n={});var r,i,o,a,s,l,u,c=[],h=[c],f=n.textIndent||0,p=0,d=0,m=t.split(" "),g=tn.apply(this,[" ",n])[0];if(l=-1===n.lineIndent?m[0].length+2:n.lineIndent||0){var v=Array(l).join(" "),y=[];m.map((function(t){(t=t.split(/\s*\n/)).length>1?y=y.concat(t.map((function(t,e){return(e&&t.length?"\n":"")+t}))):y.push(t[0])})),m=y,l=en.apply(this,[v,n])}for(o=0,a=m.length;o<a;o++){var _=0;if(r=m[o],l&&"\n"==r[0]&&(r=r.substr(1),_=1),f+p+(d=(i=tn.apply(this,[r,n])).reduce((function(t,e){return t+e}),0))>e||_){if(d>e){for(s=nn.apply(this,[r,i,e-(f+p),e]),c.push(s.shift()),c=[s.pop()];s.length;)h.push([s.shift()]);d=i.slice(r.length-(c[0]?c[0].length:0)).reduce((function(t,e){return t+e}),0)}else c=[r];h.push(c),f=d+l,p=g}else c.push(r),f+=p+d,p=g}return u=l?function(t,e){return(e?v:"")+t.join(" ")}:function(t){return t.join(" ")},h.map(u)},Qe.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),o=function(t){if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning};var e=this.internal.getFont(t.fontName,t.fontStyle);return e.metadata.Unicode?{widths:e.metadata.Unicode.widths||{0:1},kerning:e.metadata.Unicode.kerning||{}}:{font:e.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/i;o.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=n.lineIndent;var s,l,u=[];for(s=0,l=r.length;s<l;s++)u=u.concat(rn.apply(this,[r[s],a,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",n={},r={},i=0;i<e.length;i++)n[e[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=e[i];var o=function(t){return"0x"+parseInt(t,10).toString(16)},a=t.__fontmetrics__.compress=function(t){var e,n,i,s,l=["{"];for(var u in t){if(e=t[u],isNaN(parseInt(u,10))?n="'"+u+"'":(u=parseInt(u,10),n=(n=o(u).slice(2)).slice(0,-1)+r[n.slice(-1)]),"number"==typeof e)e<0?(i=o(e).slice(3),s="-"):(i=o(e).slice(2),s=""),i=s+i.slice(0,-1)+r[i.slice(-1)];else{if("object"!==(0,x.Z)(e))throw new Error("Don't know what to do with value type "+(0,x.Z)(e)+".");i=a(e)}l.push(n+i)}return l.push("}"),l.join("")},s=t.__fontmetrics__.uncompress=function(t){if("string"!=typeof t)throw new Error("Invalid argument passed to uncompress.");for(var e,r,i,o,a={},s=1,l=a,u=[],c="",h="",f=t.length-1,p=1;p<f;p+=1)"'"==(o=t[p])?e?(i=e.join(""),e=void 0):e=[]:e?e.push(o):"{"==o?(u.push([l,i]),l={},i=void 0):"}"==o?((r=u.pop())[0][r[1]]=l,i=void 0,l=r[0]):"-"==o?s=-1:void 0===i?n.hasOwnProperty(o)?(c+=n[o],i=parseInt(c,16)*s,s=1,c=""):c+=o:n.hasOwnProperty(o)?(h+=n[o],l[i]=parseInt(h,16)*s,s=1,i=void 0,h=""):h+=o;return a},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:s("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},c={Unicode:{"Courier-Oblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":s("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":s("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:s("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:s("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":s("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":s("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e=t.font,n=c.Unicode[e.postScriptName];n&&(e.metadata.Unicode={},e.metadata.Unicode.widths=n.widths,e.metadata.Unicode.kerning=n.kerning);var r=u.Unicode[e.postScriptName];r&&(e.metadata.Unicode.encoding=r,e.encoding=r.codePages[0])}])}(Xt.API),function(t){var e=function(t){for(var e=t.length,n=new Uint8Array(e),r=0;r<e;r++)n[r]=t.charCodeAt(r);return n};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,o=n.instance;if(!i.isStandardFont){if(void 0===o)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if("string"!=typeof(r=!1===o.existsFileInVFS(i.postScriptName)?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");!function(n,r){r=/^\x00\x01\x00\x00/.test(r)?e(r):e(xt(r)),n.metadata=t.API.TTFFont.open(r),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(i,r)}}])}(Xt),function(t){function e(){return(dt.canvg?Promise.resolve(dt.canvg):n.e(610).then(n.bind(n,7610))).catch((function(t){return Promise.reject(new Error("Could not load canvg: "+t))})).then((function(t){return t.default?t.default:t}))}Xt.API.addSvgAsImage=function(t,n,r,i,o,a,s,l){if(isNaN(n)||isNaN(r))throw gt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw gt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=o;var c=u.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then((function(e){return e.fromString(c,t,h)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(t){return t.render(h)})).then((function(){f.addImage(u.toDataURL("image/jpeg",1),n,r,i,o,s,l)}))}}(),Xt.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},Xt.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,o,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},s=Object.keys(a),l=[],u=0,c=0,h=0;function f(t,e){var n,r=!1;for(n=0;n<t.length;n+=1)t[n]===e&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===t||!0===e){var p=s.length;for(h=0;h<p;h+=1)n[s[h]].value=n[s[h]].defaultValue,n[s[h]].explicitSet=!1}if("object"===(0,x.Z)(t))for(i in t)if(o=t[i],f(s,i)&&void 0!==o){if("boolean"===n[i].type&&"boolean"==typeof o)n[i].value=o;else if("name"===n[i].type&&f(n[i].valueSet,o))n[i].value=o;else if("integer"===n[i].type&&Number.isInteger(o))n[i].value=o;else if("array"===n[i].type){for(u=0;u<o.length;u+=1)if(r=!0,1===o[u].length&&"number"==typeof o[u][0])l.push(String(o[u]-1));else if(o[u].length>1){for(c=0;c<o[u].length;c+=1)"number"!=typeof o[u][c]&&(r=!1);!0===r&&l.push([o[u][0]-1,o[u][1]-1].join(" "))}n[i].value="["+l.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var t,e=[];for(t in n)!0===n[t].explicitSet&&("name"===n[t].type?e.push("/"+t+" /"+n[t].value):e.push("/"+t+" "+n[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(t)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),i=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),o=unescape(encodeURIComponent("</x:xmpmeta>")),a=n.length+r.length+i.length+e.length+o.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+a+" >>"),this.internal.write("stream"),this.internal.write(e+n+r+i+o),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(t,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:t,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(Xt.API),function(t){var e=t.API,n=e.pdfEscape16=function(t,e){for(var n,r=e.metadata.Unicode.widths,i=["","0","00","000","0000"],o=[""],a=0,s=t.length;a<s;++a){if(n=e.metadata.characterToGlyph(t.charCodeAt(a)),e.metadata.glyIdsUsed.push(n),e.metadata.toUnicode[n]=t.charCodeAt(a),-1==r.indexOf(n)&&(r.push(n),r.push([parseInt(e.metadata.widthOfGlyph(n),10)])),"0"==n)return o.join("");n=n.toString(16),o.push(i[4-n.length],n)}return o.join("")},r=function(t){var e,n,r,i,o,a,s;for(o="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],a=0,s=(n=Object.keys(t).sort((function(t,e){return t-e}))).length;a<s;a++)e=n[a],r.length>=100&&(o+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==t[e]&&null!==t[e]&&"function"==typeof t[e].toString&&(i=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),r.push("<"+e+"><"+i+">"));return r.length&&(o+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),o+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};e.events.push(["putFont",function(e){!function(e){var n=e.font,i=e.out,o=e.newObject,a=e.putStream;if(n.metadata instanceof t.API.TTFFont&&"Identity-H"===n.encoding){for(var s=n.metadata.Unicode.widths,l=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),u="",c=0;c<l.length;c++)u+=String.fromCharCode(l[c]);var h=o();a({data:u,addLength1:!0,objectId:h}),i("endobj");var f=o();a({data:r(n.metadata.toUnicode),addLength1:!0,objectId:f}),i("endobj");var p=o();i("<<"),i("/Type /FontDescriptor"),i("/FontName /"+Ut(n.fontName)),i("/FontFile2 "+h+" 0 R"),i("/FontBBox "+t.API.PDFObject.convert(n.metadata.bbox)),i("/Flags "+n.metadata.flags),i("/StemV "+n.metadata.stemV),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i(">>"),i("endobj");var d=o();i("<<"),i("/Type /Font"),i("/BaseFont /"+Ut(n.fontName)),i("/FontDescriptor "+p+" 0 R"),i("/W "+t.API.PDFObject.convert(s)),i("/CIDToGIDMap /Identity"),i("/DW 1000"),i("/Subtype /CIDFontType2"),i("/CIDSystemInfo"),i("<<"),i("/Supplement 0"),i("/Registry (Adobe)"),i("/Ordering ("+n.encoding+")"),i(">>"),i(">>"),i("endobj"),n.objectNumber=o(),i("<<"),i("/Type /Font"),i("/Subtype /Type0"),i("/ToUnicode "+f+" 0 R"),i("/BaseFont /"+Ut(n.fontName)),i("/Encoding /"+n.encoding),i("/DescendantFonts ["+d+" 0 R]"),i(">>"),i("endobj"),n.isAlreadyPutted=!0}}(e)}]),e.events.push(["putFont",function(e){!function(e){var n=e.font,i=e.out,o=e.newObject,a=e.putStream;if(n.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var s=n.metadata.rawData,l="",u=0;u<s.length;u++)l+=String.fromCharCode(s[u]);var c=o();a({data:l,addLength1:!0,objectId:c}),i("endobj");var h=o();a({data:r(n.metadata.toUnicode),addLength1:!0,objectId:h}),i("endobj");var f=o();i("<<"),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i("/StemV "+n.metadata.stemV),i("/Type /FontDescriptor"),i("/FontFile2 "+c+" 0 R"),i("/Flags 96"),i("/FontBBox "+t.API.PDFObject.convert(n.metadata.bbox)),i("/FontName /"+Ut(n.fontName)),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i(">>"),i("endobj"),n.objectNumber=o();for(var p=0;p<n.metadata.hmtx.widths.length;p++)n.metadata.hmtx.widths[p]=parseInt(n.metadata.hmtx.widths[p]*(1e3/n.metadata.head.unitsPerEm));i("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+Ut(n.fontName)+"/FontDescriptor "+f+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),i("endobj"),n.isAlreadyPutted=!0}}(e)}]);var i=function(t){var e,r=t.text||"",i=t.x,o=t.y,a=t.options||{},s=t.mutex||{},l=s.pdfEscape,u=s.activeFontKey,c=s.fonts,h=u,f="",p=0,d="",m=c[h].encoding;if("Identity-H"!==c[h].encoding)return{text:r,x:i,y:o,options:a,mutex:s};for(d=r,h=u,Array.isArray(r)&&(d=r[0]),p=0;p<d.length;p+=1)c[h].metadata.hasOwnProperty("cmap")&&(e=c[h].metadata.cmap.unicode.codeMap[d[p].charCodeAt(0)]),e||d[p].charCodeAt(0)<256&&c[h].metadata.hasOwnProperty("Unicode")?f+=d[p]:f+="";var g="";return parseInt(h.slice(1))<14||"WinAnsiEncoding"===m?g=l(f,h).split("").map((function(t){return t.charCodeAt(0).toString(16)})).join(""):"Identity-H"===m&&(g=n(f,c[h])),s.isHex=!0,{text:g,x:i,y:o,options:a,mutex:s}};e.events.push(["postProcessText",function(t){var e=t.text||"",n=[],r={text:e,x:t.x,y:t.y,options:t.options,mutex:t.mutex};if(Array.isArray(e)){var o=0;for(o=0;o<e.length;o+=1)Array.isArray(e[o])&&3===e[o].length?n.push([i(Object.assign({},r,{text:e[o][0]})).text,e[o][1],e[o][2]]):n.push(i(Object.assign({},r,{text:e[o]})).text);t.text=n}else t.text=i(Object.assign({},r,{text:e})).text}])}(Xt),function(t){var e=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]},t.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},t.getFileFromVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null}}(Xt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var n,r,i,o,a,s,l,u=e,c=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],f={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},d=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,v=0;this.__bidiEngine__={};var y=function(t){var e=t.charCodeAt(),n=e>>8,r=p[n];return void 0!==r?u[256*r+(255&e)]:252===n||253===n?"AL":m.test(n)?"L":8===n?"R":"N"},_=function(t){for(var e,n=0;n<t.length;n++){if("L"===(e=y(t.charAt(n))))return!1;if("R"===e)return!0}return!1},x=function(t,e,a,s){var l,u,c,h,f=e[s];switch(f){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(f="AN");break;case"AL":g=!0,f="R";break;case"WS":case"BN":f="N";break;case"CS":s<1||s+1>=e.length||"EN"!==(l=a[s-1])&&"AN"!==l||"EN"!==(u=e[s+1])&&"AN"!==u?f="N":g&&(u="AN"),f=u===l?u:"N";break;case"ES":f="EN"===(l=s>0?a[s-1]:"B")&&s+1<e.length&&"EN"===e[s+1]?"EN":"N";break;case"ET":if(s>0&&"EN"===a[s-1]){f="EN";break}if(g){f="N";break}for(c=s+1,h=e.length;c<h&&"ET"===e[c];)c++;f=c<h&&"EN"===e[c]?"EN":"N";break;case"NSM":if(i&&!o){for(h=e.length,c=s+1;c<h&&"NSM"===e[c];)c++;if(c<h){var p=t[s],d=p>=1425&&p<=2303||64286===p;if(l=e[c],d&&("R"===l||"AL"===l)){f="R";break}}}f=s<1||"B"===(l=e[s-1])?"N":a[s-1];break;case"B":g=!1,n=!0,f=v;break;case"S":r=!0,f="N"}return f},b=function(t,e,n){var r=t.split("");return n&&w(r,n,{hiLevel:v}),r.reverse(),e&&e.reverse(),r.join("")},w=function(t,e,i){var o,a,s,l,u,p=-1,d=t.length,m=0,_=[],b=v?h:c,w=[];for(g=!1,n=!1,r=!1,a=0;a<d;a++)w[a]=y(t[a]);for(s=0;s<d;s++){if(u=m,_[s]=x(t,w,_,s),o=240&(m=b[u][f[_[s]]]),m&=15,e[s]=l=b[m][5],o>0)if(16===o){for(a=p;a<s;a++)e[a]=1;p=-1}else p=-1;if(b[m][6])-1===p&&(p=s);else if(p>-1){for(a=p;a<s;a++)e[a]=l;p=-1}"B"===w[s]&&(e[s]=0),i.hiLevel|=l}r&&function(t,e,n){for(var r=0;r<n;r++)if("S"===t[r]){e[r]=v;for(var i=r-1;i>=0&&"WS"===t[i];i--)e[i]=v}}(w,e,d)},S=function(t,e,r,i,o){if(!(o.hiLevel<t)){if(1===t&&1===v&&!n)return e.reverse(),void(r&&r.reverse());for(var a,s,l,u,c=e.length,h=0;h<c;){if(i[h]>=t){for(l=h+1;l<c&&i[l]>=t;)l++;for(u=h,s=l-1;u<s;u++,s--)a=e[u],e[u]=e[s],e[s]=a,r&&(a=r[u],r[u]=r[s],r[s]=a);h=l}h++}}},E=function(t,e,n){var r=t.split(""),i={hiLevel:v};return n||(n=[]),w(r,n,i),function(t,e,n){if(0!==n.hiLevel&&l)for(var r,i=0;i<t.length;i++)1===e[i]&&(r=d.indexOf(t[i]))>=0&&(t[i]=d[r+1])}(r,n,i),S(2,r,e,n,i),S(1,r,e,n,i),r.join("")};return this.__bidiEngine__.doBidiReorder=function(t,e,n){if(function(t,e){if(e)for(var n=0;n<t.length;n++)e[n]=n;void 0===o&&(o=_(t)),void 0===s&&(s=_(t))}(t,e),i||!a||s)if(i&&a&&o^s)v=o?1:0,t=b(t,e,n);else if(!i&&a&&s)v=o?1:0,t=E(t,e,n),t=b(t,e);else if(!i||o||a||s){if(i&&!a&&o^s)t=b(t,e),o?(v=0,t=E(t,e,n)):(v=1,t=E(t,e,n),t=b(t,e));else if(i&&o&&!a&&s)v=1,t=E(t,e,n),t=b(t,e);else if(!i&&!a&&o^s){var r=l;o?(v=1,t=E(t,e,n),v=0,l=!1,t=E(t,e,n),l=r):(v=0,t=E(t,e,n),t=b(t,e),v=1,l=!1,t=E(t,e,n),l=r,t=b(t,e))}}else v=0,t=E(t,e,n);else v=o?1:0,t=E(t,e,n);return t},this.__bidiEngine__.setOptions=function(t){t&&(i=t.isInputVisual,a=t.isOutputVisual,o=t.isInputRtl,s=t.isOutputRtl,l=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(t){var e=t.text,r=(t.x,t.y,t.options||{}),i=(t.mutex,r.lang,[]);if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,n.setOptions(r),"[object Array]"===Object.prototype.toString.call(e)){var o=0;for(i=[],o=0;o<e.length;o+=1)"[object Array]"===Object.prototype.toString.call(e[o])?i.push([n.doBidiReorder(e[o][0]),e[o][1],e[o][2]]):i.push([n.doBidiReorder(e[o])]);t.text=i}else t.text=n.doBidiReorder(e);n.setOptions({isInputVisual:!0})}])}(Xt),Xt.API.TTFFont=function(){function t(t){var e;if(this.rawData=t,e=this.contents=new fn(t),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Mn(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new pn(this.contents),this.head=new gn(this),this.name=new Sn(this),this.cmap=new yn(this),this.toUnicode={},this.hhea=new _n(this),this.maxp=new En(this),this.hmtx=new kn(this),this.post=new bn(this),this.os2=new xn(this),this.loca=new An(this),this.glyf=new In(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var t,e,n,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,n,r,i;for(i=[],e=0,n=(r=this.bbox).length;e<n;e++)t=r[e],i.push(Math.round(t*this.scaleFactor));return i}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),0!=(32768&(e=r>>16))&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(i=this.familyClass)||2===i||3===i||4===i||5===i||7===i,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},t.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},t.prototype.widthOfString=function(t,e,n){var r,i,o,a;for(o=0,i=0,a=(t=""+t).length;0<=a?i<a:i>a;i=0<=a?++i:--i)r=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/e)||0;return o*(e/1e3)},t.prototype.lineHeight=function(t,e){var n;return null==e&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},t}();var hn,fn=function(){function t(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(t){return this.data[this.pos++]=t},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},t.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},t.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},t.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(t){var e,n,r;for(r=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)r.push(this.writeByte(t.charCodeAt(e)));return r},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(t){return this.writeInt16(t)},t.prototype.readLongLong=function(){var t,e,n,r,i,o,a,s;return t=this.readByte(),e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),a=this.readByte(),s=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^i)+65536*(255^o)+256*(255^a)+(255^s)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*r+16777216*i+65536*o+256*a+s},t.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(t){return this.writeInt32(t)},t.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},t.prototype.write=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;n<r;n++)e=t[n],i.push(this.writeByte(e));return i},t}(),pn=function(){var t;function e(t){var e,n,r;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}return e.prototype.encode=function(e){var n,r,i,o,a,s,l,u,c,h,f,p,d;for(d in f=Object.keys(e).length,s=Math.log(2),c=16*Math.floor(Math.log(f)/s),o=Math.floor(c/s),u=16*f-c,(r=new fn).writeInt(this.scalarType),r.writeShort(f),r.writeShort(c),r.writeShort(o),r.writeShort(u),i=16*f,l=r.pos+i,a=null,p=[],e)for(h=e[d],r.writeString(d),r.writeInt(t(h)),r.writeInt(l),r.writeInt(h.length),p=p.concat(h),"head"===d&&(a=l),l+=h.length;l%4;)p.push(0),l++;return r.write(p),n=2981146554-t(r.data),r.pos=a+8,r.writeUInt32(n),r.data},t=function(t){var e,n,r,i;for(t=Cn.call(t);t.length%4;)t.push(0);for(r=new fn(t),n=0,e=0,i=t.length;e<i;e=e+=4)n+=r.readUInt32();return 4294967295&n},e}(),dn={}.hasOwnProperty,mn=function(t,e){for(var n in e)dn.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};hn=function(){function t(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var gn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var e;return(e=new fn).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},e}(),vn=function(){function t(t,e){var n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),c=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(s=0;s<256;++s)this.codeMap[s]=t.readByte();break;case 4:for(f=t.readUInt16(),h=f/2,t.pos+=6,i=function(){var e,n;for(n=[],s=e=0;0<=h?e<h:e>h;s=0<=h?++e:--e)n.push(t.readUInt16());return n}(),t.pos+=2,d=function(){var e,n;for(n=[],s=e=0;0<=h?e<h:e>h;s=0<=h?++e:--e)n.push(t.readUInt16());return n}(),l=function(){var e,n;for(n=[],s=e=0;0<=h?e<h:e>h;s=0<=h?++e:--e)n.push(t.readUInt16());return n}(),u=function(){var e,n;for(n=[],s=e=0;0<=h?e<h:e>h;s=0<=h?++e:--e)n.push(t.readUInt16());return n}(),r=(this.length-t.pos+this.offset)/2,a=function(){var e,n;for(n=[],s=e=0;0<=r?e<r:e>r;s=0<=r?++e:--e)n.push(t.readUInt16());return n}(),s=g=0,y=i.length;g<y;s=++g)for(m=i[s],n=v=p=d[s];p<=m?v<=m:v>=m;n=p<=m?++v:--v)0===u[s]?o=n+l[s]:0!==(o=a[u[s]/2+(n-p)-(h-s)]||0)&&(o+=l[s]),this.codeMap[n]=65535&o}t.pos=c}return t.encode=function(t,e){var n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y,_,x,b,w,S,E,k,C,I,T,P,A,M,L,R,D,N,z,O,F,B,j,U,V,Z,q,G,W,X;switch(P=new fn,o=Object.keys(t).sort((function(t,e){return t-e})),e){case"macroman":for(d=0,m=function(){var t=[];for(p=0;p<256;++p)t.push(0);return t}(),v={0:0},i={},A=0,D=o.length;A<D;A++)null==v[q=t[r=o[A]]]&&(v[q]=++d),i[r]={old:t[r],new:v[t[r]]},m[r]=v[t[r]];return P.writeUInt16(1),P.writeUInt16(0),P.writeUInt32(12),P.writeUInt16(0),P.writeUInt16(262),P.writeUInt16(0),P.write(m),{charMap:i,subtable:P.data,maxGlyphID:d+1};case"unicode":for(I=[],c=[],y=0,v={},n={},g=l=null,M=0,N=o.length;M<N;M++)null==v[x=t[r=o[M]]]&&(v[x]=++y),n[r]={old:x,new:v[x]},a=v[x]-r,null!=g&&a===l||(g&&c.push(g),I.push(r),l=a),g=r;for(g&&c.push(g),c.push(65535),I.push(65535),k=2*(E=I.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),h=Math.log(S/2)/Math.LN2,w=2*E-S,s=[],b=[],f=[],p=L=0,z=I.length;L<z;p=++L){if(C=I[p],u=c[p],65535===C){s.push(0),b.push(0);break}if(C-(T=n[C].new)>=32768)for(s.push(0),b.push(2*(f.length+E-p)),r=R=C;C<=u?R<=u:R>=u;r=C<=u?++R:--R)f.push(n[r].new);else s.push(T-C),b.push(0)}for(P.writeUInt16(3),P.writeUInt16(1),P.writeUInt32(12),P.writeUInt16(4),P.writeUInt16(16+8*E+2*f.length),P.writeUInt16(0),P.writeUInt16(k),P.writeUInt16(S),P.writeUInt16(h),P.writeUInt16(w),V=0,O=c.length;V<O;V++)r=c[V],P.writeUInt16(r);for(P.writeUInt16(0),Z=0,F=I.length;Z<F;Z++)r=I[Z],P.writeUInt16(r);for(G=0,B=s.length;G<B;G++)a=s[G],P.writeUInt16(a);for(W=0,j=b.length;W<j;W++)_=b[W],P.writeUInt16(_);for(X=0,U=f.length;X<U;X++)d=f[X],P.writeUInt16(d);return{charMap:n,subtable:P.data,maxGlyphID:y+1}}},t}(),yn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="cmap",e.prototype.parse=function(t){var e,n,r;for(t.pos=this.offset,this.version=t.readUInt16(),r=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)e=new vn(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},e.encode=function(t,e){var n,r;return null==e&&(e="macroman"),n=vn.encode(t,e),(r=new fn).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},e}(),_n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),xn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var e,n;for(n=[],e=0;e<10;++e)n.push(t.readByte());return n}(),this.charRange=function(){var e,n;for(n=[],e=0;e<4;++e)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var e,n;for(n=[],e=0;e<2;e=++e)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),bn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="post",e.prototype.parse=function(t){var e,n,r;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],r=[];t.pos<this.offset+this.length;)e=t.readByte(),r.push(this.names.push(t.readString(e)));return r;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var e,n,r;for(r=[],i=e=0,n=this.file.maxp.numGlyphs;0<=n?e<n:e>n;i=0<=n?++e:--e)r.push(t.readUInt32());return r}.call(this)}},e}(),wn=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Sn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="name",e.prototype.parse=function(t){var e,n,r,i,o,a,s,l,u,c,h;for(t.pos=this.offset,t.readShort(),e=t.readShort(),a=t.readShort(),n=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(s={},i=u=0,c=n.length;u<c;i=++u)r=n[i],t.pos=r.offset,l=t.readString(r.length),o=new wn(l,r),null==s[h=r.nameID]&&(s[h]=[]),s[r.nameID].push(o);this.strings=s,this.copyright=s[0],this.fontFamily=s[1],this.fontSubfamily=s[2],this.uniqueSubfamily=s[3],this.fontName=s[4],this.version=s[5];try{this.postscriptName=s[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(t){this.postscriptName=s[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=s[7],this.manufacturer=s[8],this.designer=s[9],this.description=s[10],this.vendorUrl=s[11],this.designerUrl=s[12],this.license=s[13],this.licenseUrl=s[14],this.preferredFamily=s[15],this.preferredSubfamily=s[17],this.compatibleFull=s[18],this.sampleText=s[19]},e}(),En=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),kn=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="hmtx",e.prototype.parse=function(t){var e,n,r,i,o,a,s;for(t.pos=this.offset,this.metrics=[],e=0,a=this.file.hhea.numberOfMetrics;0<=a?e<a:e>a;e=0<=a?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,i;for(i=[],e=n=0;0<=r?n<r:n>r;e=0<=r?++n:--n)i.push(t.readInt16());return i}(),this.widths=function(){var t,e,n,r;for(r=[],t=0,e=(n=this.metrics).length;t<e;t++)i=n[t],r.push(i.advance);return r}.call(this),n=this.widths[this.widths.length-1],s=[],e=o=0;0<=r?o<r:o>r;e=0<=r?++o:--o)s.push(this.widths.push(n));return s},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Cn=[].slice,In=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var e,n,r,i,o,a,s,l,u,c;return t in this.cache?this.cache[t]:(i=this.file.loca,e=this.file.contents,n=i.indexOf(t),0===(r=i.lengthOf(t))?this.cache[t]=null:(e.pos=this.offset+n,o=(a=new fn(e.read(r))).readShort(),l=a.readShort(),c=a.readShort(),s=a.readShort(),u=a.readShort(),this.cache[t]=-1===o?new Pn(a,l,c,s,u):new Tn(a,o,l,c,s,u),this.cache[t]))},e.prototype.encode=function(t,e,n){var r,i,o,a,s;for(o=[],i=[],a=0,s=e.length;a<s;a++)r=t[e[a]],i.push(o.length),r&&(o=o.concat(r.encode(n)));return i.push(o.length),{table:o,offsets:i}},e}(),Tn=function(){function t(t,e,n,r,i,o){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Pn=function(){function t(t,e,n,r,i){var o,a;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return t.prototype.encode=function(){var t,e,n;for(e=new fn(Cn.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},t}(),An=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return mn(e,hn),e.prototype.tag="loca",e.prototype.parse=function(t){var e,n;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,r;for(r=[],n=0,e=this.length;n<e;n+=2)r.push(2*t.readUInt16());return r}.call(this):function(){var e,r;for(r=[],n=0,e=this.length;n<e;n+=4)r.push(t.readUInt32());return r}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,e){for(var n=new Uint32Array(this.offsets.length),r=0,i=0,o=0;o<n.length;++o)if(n[o]=r,i<e.length&&e[i]==o){++i,n[o]=r;var a=this.offsets[o],s=this.offsets[o+1]-a;s>0&&(r+=s)}for(var l=new Array(4*n.length),u=0;u<n.length;++u)l[4*u+3]=255&n[u],l[4*u+2]=(65280&n[u])>>8,l[4*u+1]=(16711680&n[u])>>16,l[4*u]=(4278190080&n[u])>>24;return l},e}(),Mn=function(){function t(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var t,e,n,r,i;for(e in r=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[e],t[e]=r[n];return t},t.prototype.glyphsFor=function(t){var e,n,r,i,o,a,s;for(r={},o=0,a=t.length;o<a;o++)r[i=t[o]]=this.font.glyf.glyphFor(i);for(i in e=[],r)(null!=(n=r[i])?n.compound:void 0)&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(i in s=this.glyphsFor(e))n=s[i],r[i]=n;return r},t.prototype.encode=function(t,e){var n,r,i,o,a,s,l,u,c,h,f,p,d,m,g;for(r in n=yn.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),f={0:0},g=n.charMap)f[(s=g[r]).old]=s.new;for(p in h=n.maxGlyphID,o)p in f||(f[p]=h++);return u=function(t){var e,n;for(e in n={},t)n[t[e]]=e;return n}(f),c=Object.keys(u).sort((function(t,e){return t-e})),d=function(){var t,e,n;for(n=[],t=0,e=c.length;t<e;t++)a=c[t],n.push(u[a]);return n}(),i=this.font.glyf.encode(o,d,f),l=this.font.loca.encode(i.offsets,d),m={cmap:this.font.cmap.raw(),glyf:i.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},t}();Xt.API.PDFObject=function(){var t;function e(){}return t=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},e.convert=function(n){var r,i,o,a;if(Array.isArray(n))return"["+function(){var t,i,o;for(o=[],t=0,i=n.length;t<i;t++)r=n[t],o.push(e.convert(r));return o}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(i in o=["<<"],n)a=n[i],o.push("/"+i+" "+e.convert(a));return o.push(">>"),o.join("\n")}return""+n},e}();var Ln=n(225),Rn=n(3361),Dn=n(9886),Nn=(n(1975),n(5438)),zn=n(9140),On=n(2561),Fn=(0,Dn.w)((function(e,n){var r=e.styles,i=(0,zn.O)([r],void 0,(0,t.useContext)(Dn.T)),o=(0,t.useRef)();return(0,On.j)((function(){var t=n.key+"-global",e=new n.sheet.constructor({key:t,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),r=!1,a=document.querySelector('style[data-emotion="'+t+" "+i.name+'"]');return n.sheet.tags.length&&(e.before=n.sheet.tags[0]),null!==a&&(r=!0,a.setAttribute("data-emotion",t),e.hydrate([a])),o.current=[e,r],function(){e.flush()}}),[n]),(0,On.j)((function(){var t=o.current,e=t[0];if(t[1])t[1]=!1;else{if(void 0!==i.next&&(0,Nn.My)(n,i.next,!0),e.tags.length){var r=e.tags[e.tags.length-1].nextElementSibling;e.before=r,e.flush()}n.insert("",i,e,!1)}}),[n,i.name]),null}));function Bn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,zn.O)(e)}var jn=function(){var t=Bn.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function Un(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function Vn(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function Zn(t){var e=t;if("undefined"===typeof e){if("undefined"===typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function qn(t,e){try{return new RegExp(t,"g").exec(e)}catch(n){return null}}function Gn(){if("undefined"===typeof navigator||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!(!e||!e.length)}function Wn(t){return t.replace(/_/g,".")}function Xn(t,e){var n=null,r="-1";return Un(t,(function(t){var i=qn("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!(!i||t.brand)&&(n=t,r=i[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(r=function(t,e){var n=qn("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}(t.versionTest.toLowerCase(),e)||r),r=Wn(r),!0)})),{preset:n,version:r}}function Hn(t,e){var n={brand:"",version:"-1"};return Un(t,(function(t){var r=Yn(e,t);return!!r&&(n.brand=t.id,n.version=t.versionAlias||r.version,"-1"!==n.version)})),n}function Yn(t,e){return Vn(t,(function(t){var n=t.brand;return qn(""+e.test,n.toLowerCase())}))}var $n=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],Kn=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Jn=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Qn=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],tr=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function er(t){return!!Xn(Qn,t).preset}function nr(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=t&&t.fullVersionList,i=e.mobile||!1,o=n[0],a=(t&&t.platform||e.platform||navigator.platform).toLowerCase(),s={name:o.brand,version:o.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Hn(Qn,n).brand||er(Zn())},l={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&Un(Jn,(function(t){return Yn(n,t)}));var u=Hn(Kn,n);if(s.chromium=!!u.brand,s.chromiumVersion=u.version,!s.chromium){var c=Hn(Jn,n);s.webkit=!!c.brand,s.webkitVersion=c.version}var h=Vn(tr,(function(t){return new RegExp(""+t.test,"g").exec(a)}));if(l.name=h?h.id:"",t&&(l.version=t.platformVersion),r&&r.length){var f=Hn($n,r);s.name=f.brand||s.name,s.version=f.version||s.version}else{var p=Hn($n,n);s.name=p.brand||s.name,s.version=p.brand&&t?t.uaFullVersion:p.version}return s.webkit&&(l.name=i?"ios":"mac"),"ios"===l.name&&s.webview&&(s.version="-1"),l.version=Wn(l.version),s.version=Wn(s.version),l.majorVersion=parseInt(l.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:l,isMobile:i,isHints:!0}}function rr(t){return"undefined"===typeof t&&Gn()?nr():function(t){var e=Zn(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:er(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},o=Xn($n,e),a=o.preset,s=o.version,l=Xn(tr,e),u=l.preset,c=l.version,h=Xn(Kn,e);if(r.chromium=!!h.preset,r.chromiumVersion=h.version,!r.chromium){var f=Xn(Jn,e);r.webkit=!!f.preset,r.webkitVersion=f.version}return u&&(i.name=u.id,i.version=c,i.majorVersion=parseInt(c,10)),a&&(r.name=a.id,r.version=s,r.webview&&"ios"===i.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}(t)}var ir=rr;function or(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}function ar(t,e){return function(n){n&&(t[e]=n)}}function sr(t,e,n){return function(r){r&&(t[e][n]=r)}}var lr="undefined",ur=typeof window!==lr,cr=(typeof document!==lr&&document,[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}]),hr=1e-7,fr={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function pr(t,e,n,r){return(t*r+e*n)/(n+r)}function dr(t){return typeof t===lr}function mr(t){return t&&"object"===typeof t}function gr(t){return Array.isArray(t)}function vr(t){return"string"===typeof t}function yr(t){return"number"===typeof t}function _r(t){return"function"===typeof t}function xr(t,e,n,r,i){return br(t,e,n)?n:function(t,e,n,r,i){for(var o,a=function(n){var a=e[n].trim();if(a===t.close&&!br(t,e,n))return{value:n};var s=n,l=Pr(i,(function(t){return t.open===a}));if(l&&(s=xr(l,e,n,r,i)),-1===s)return o=n,"break";o=n=s},s=n;s<r;++s){var l=a(s);if(s=o,"object"===typeof l)return l.value;if("break"===l)break}return-1}(t,e,n+1,r,i)}function br(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function wr(t,e){var n=vr(e)?{separator:e}:e,r=n.separator,i=void 0===r?",":r,o=n.isSeparateFirst,a=n.isSeparateOnlyOpenClose,s=n.isSeparateOpenClose,l=void 0===s?a:s,u=n.openCloseCharacters,c=void 0===u?cr:u,h=c.map((function(t){var e=t.open,n=t.close;return e===n?e:e+"|"+n})).join("|"),f=new RegExp("(\\s*"+i+"\\s*|"+h+"|\\s+)","g"),p=t.split(f).filter(Boolean),d=p.length,m=[],g=[];function v(){return!!g.length&&(m.push(g.join("")),g=[],!0)}for(var y,_=function(e){var n=p[e].trim(),r=e,s=Pr(c,(function(t){return t.open===n})),u=Pr(c,(function(t){return t.close===n}));if(s){if(-1!==(r=xr(s,p,e,d,c))&&l)return v()&&o?(y=e,"break"):(m.push(p.slice(e,r+1).join("")),e=r,o?(y=e,"break"):(y=e,"continue"))}else{if(u&&!br(u,p,e)){var h=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(c);return h.splice(c.indexOf(u),1),{value:wr(t,{separator:i,isSeparateFirst:o,isSeparateOnlyOpenClose:a,isSeparateOpenClose:l,openCloseCharacters:h})}}if(function(t,e){return(""===e||" "==e)&&(""===t||" "==t)||t===e}(n,i)&&!a)return v(),o?(y=e,"break"):(y=e,"continue")}-1===r&&(r=d-1),g.push(p.slice(e,r+1).join("")),y=e=r},x=0;x<d;++x){var b=_(x);if(x=y,"object"===typeof b)return b.value;if("break"===b)break}return g.length&&m.push(g.join("")),m}function Sr(t){return wr(t,"")}function Er(t){return wr(t,",")}function kr(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Cr(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2];return{prefix:n,unit:e[3],value:parseFloat(r)}}function Ir(){return Date.now?Date.now():(new Date).getTime()}function Tr(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function Pr(t,e,n){var r=Tr(t,e);return r>-1?t[r]:n}var Ar=function(){var t=Ir(),e=ur&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var n=Ir();return setTimeout((function(){e(n-t)}),1e3/60)}}(),Mr=function(){var t=ur&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(t){clearTimeout(t)}}();function Lr(t){return Object.keys(t)}function Rr(t,e){var n=Cr(t),r=n.value,i=n.unit;if(mr(e)){var o=e[i];if(o){if(_r(o))return o(r);if(fr[i])return fr[i](r,o)}}else if("%"===i)return r*e/100;return fr[i]?fr[i](r):r}function Dr(t,e,n){return Math.max(e,Math.min(t,n))}function Nr(t,e,n,r){return void 0===r&&(r=t[0]/t[1]),[[jr(e[0],hr),jr(e[0]/r,hr)],[jr(e[1]*r,hr),jr(e[1],hr)]].filter((function(t){return t.every((function(t,r){var i=e[r],o=jr(i,hr);return n?t<=i||t<=o:t>=i||t>=o}))}))[0]||t}function zr(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function Or(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function Fr(t){var e=function(t){return[0,1].map((function(e){return zr(t.map((function(t){return t[e]})))}))}(t),n=Or(e,t[0]),r=Or(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function Br(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function jr(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function Ur(t,e){return t.forEach((function(n,r){t[r]=jr(t[r],e)})),t}function Vr(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function Zr(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function qr(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function Gr(t,e,n,r){t.addEventListener(e,n,r)}function Wr(t,e,n,r){t.removeEventListener(e,n,r)}function Xr(t,e,n,r,i,o){for(var a=0;a<i;++a){var s=n+a*i,l=r+a*i;t[s]+=t[l]*o,e[s]+=e[l]*o}}function Hr(t,e,n,r,i){for(var o=0;o<i;++o){var a=n+o*i,s=r+o*i,l=t[a],u=e[a];t[a]=t[s],t[s]=l,e[a]=e[s],e[s]=u}}function Yr(t,e,n,r,i){for(var o=0;o<r;++o){var a=n+o*r;t[a]/=i,e[a]/=i}}function $r(t,e,n){void 0===n&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function Kr(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=gi(e),i=0;i<e;++i){var o=e*i+i;if(!jr(n[o],hr))for(var a=i+1;a<e;++a)if(n[e*i+a]){Hr(n,r,i,a,e);break}if(!jr(n[o],hr))return[];Yr(n,r,i,e,n[o]);for(a=0;a<e;++a){var s=a,l=n[a+i*e];jr(l,hr)&&i!==a&&Xr(n,r,s,i,e,-l)}}return r}function Jr(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function Qr(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function ti(t,e,n){if(void 0===e&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=gi(n),i=Math.min(e,n),o=0;o<i-1;++o){for(var a=0;a<i-1;++a)r[o*n+a]=t[o*e+a];r[(o+1)*n-1]=t[(o+1)*e-1],r[(n-1)*n+o]=t[(e-1)*e+o]}return r[n*n-1]=t[e*e-1],r}function ei(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=gi(t);return e.forEach((function(e){r=ni(r,e,t)})),r}function ni(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,o=e.length/i;if(!i)return e;if(!o)return t;for(var a=0;a<n;++a)for(var s=0;s<o;++s){r[s*n+a]=0;for(var l=0;l<i;++l)r[s*n+a]+=t[l*n+a]*e[s*i+l]}return r}function ri(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function ii(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function oi(t,e){return void 0===e&&(e=6===t.length),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function ai(t,e){return void 0===e&&(e=9===t.length),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function si(t,e,n){void 0===n&&(n=e.length);var r=ni(t,e,n),i=r[n-1];return r.map((function(t){return t/i}))}function li(t,e){return ni(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function ui(t,e){return ni(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function ci(t,e){return ni(t,mi(e,4))}function hi(t,e){var n=e[0],r=void 0===n?1:n,i=e[1],o=void 0===i?1:i,a=e[2];return ni(t,[r,0,0,0,0,o,0,0,0,0,void 0===a?1:a,0,0,0,0,1],4)}function fi(t,e){return si(mi(e,3),Qr(t,3))}function pi(t,e){var n=e[0],r=void 0===n?0:n,i=e[1],o=void 0===i?0:i,a=e[2];return ni(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,o,void 0===a?0:a,1],4)}function di(t,e){return ni(t,e,4)}function mi(t,e){var n=Math.cos(t),r=Math.sin(t),i=gi(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function gi(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function vi(t,e){for(var n=gi(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function yi(t,e){for(var n=gi(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function _i(t,e,n,r,i,o,a,s){var l=t[0],u=t[1],c=e[0],h=e[1],f=n[0],p=n[1],d=r[0],m=r[1],g=i[0],v=i[1],y=o[0],_=o[1],x=a[0],b=a[1],w=s[0],S=s[1],E=Kr([l,0,c,0,f,0,d,0,u,0,h,0,p,0,m,0,1,0,1,0,1,0,1,0,0,l,0,c,0,f,0,d,0,u,0,h,0,p,0,m,0,1,0,1,0,1,0,1,-g*l,-v*l,-y*c,-_*c,-x*f,-b*f,-w*d,-S*d,-g*u,-v*u,-y*h,-_*h,-x*p,-b*p,-w*m,-S*m],8);if(!E.length)return[];var k=ni(E,[g,v,y,_,x,b,w,S],8);return k[8]=1,ti(function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}(k),3,4)}function xi(t){return bi(wi(t))}function bi(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return t.forEach((function(t){var n=t.matrixFunction,r=t.functionValue;n&&(e=n(e,r))})),e}function wi(t){return(gr(t)?t:Sr(t)).map((function(t){var e=kr(t),n=e.prefix,r=e.value,i=null,o=n,a="";if("translate"===n||"translateX"===n||"translate3d"===n){var s=Er(r).map((function(t){return parseFloat(t)})),l=s[0],u=s[1],c=void 0===u?0:u,h=s[2];i=pi,a=[l,c,void 0===h?0:h]}else if("translateY"===n){i=pi,a=[0,c=parseFloat(r),0]}else if("translateZ"===n){i=pi,a=[0,0,parseFloat(r)]}else if("scale"===n||"scale3d"===n){var f=Er(r).map((function(t){return parseFloat(t)})),p=f[0],d=f[1],m=void 0===d?p:d,g=f[2];i=hi,a=[p,m,void 0===g?1:g]}else if("scaleX"===n){i=hi,a=[p=parseFloat(r),1,1]}else if("scaleY"===n){i=hi,a=[1,m=parseFloat(r),1]}else if("scaleZ"===n){i=hi,a=[1,1,parseFloat(r)]}else if("rotate"===n||"rotateZ"===n||"rotateX"===n||"rotateY"===n){var v=Cr(r),y=v.unit,_=v.value;"rotate"===n||"rotateZ"===n?(o="rotateZ",i=ci):"rotateX"===n?i=li:"rotateY"===n&&(i=ui),a="rad"===y?_:_*Math.PI/180}else if("matrix3d"===n)i=di,a=Er(r).map((function(t){return parseFloat(t)}));else if("matrix"===n){var x=Er(r).map((function(t){return parseFloat(t)}));i=di,a=[x[0],x[1],0,0,x[2],x[3],0,0,0,0,1,0,x[4],x[5],0,1]}else o="";return{name:n,functionName:o,value:r,matrixFunction:i,functionValue:a}}))}var Si=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,i=n.indexOf(t),o=-1===i?n.length:i;n[o]=t,r[o]=e},t}(),Ei=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),ki="function"===typeof Map,Ci=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}();var Ii=function(){function t(t,e,n,r,i,o,a,s){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=i,this.maintained=o,this.changedBeforeAdded=a,this.fixed=s}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=function(t,e){var n=[],r=[];return t.forEach((function(t){var e=t[0],i=t[1],o=new Ci;n[e]=o,r[i]=o})),n.forEach((function(t,e){t.connect(n[e-1])})),t.filter((function(t,n){return!e[n]})).map((function(t,e){var i=t[0],o=t[1];if(i===o)return[0,0];var a=n[i],s=r[o-1],l=a.getIndex();return a.disconnect(),s?a.connect(s,s.next):a.connect(void 0,n[0]),[l,a.getIndex()]}))}(this.changedBeforeAdded,this.fixed),e=this.changed,n=[];this.cacheOrdered=t.filter((function(t,r){var i=t[0],o=t[1],a=e[r],s=a[0],l=a[1];if(i!==o)return n.push([s,l]),!0})),this.cachePureChanged=n},t}();function Ti(t,e,n){var r=ki?Map:n?Ei:Si,i=n||function(t){return t},o=[],a=[],s=[],l=t.map(i),u=e.map(i),c=new r,h=new r,f=[],p=[],d={},m=[],g=0,v=0;return l.forEach((function(t,e){c.set(t,e)})),u.forEach((function(t,e){h.set(t,e)})),l.forEach((function(t,e){var n=h.get(t);"undefined"===typeof n?(++v,a.push(e)):d[n]=v})),u.forEach((function(t,e){var n=c.get(t);"undefined"===typeof n?(o.push(e),++g):(s.push([n,e]),v=d[e]||0,f.push([n-v,e-g]),p.push(e===n),n!==e&&m.push([n,e]))})),a.reverse(),new Ii(t,e,o,a,m,s,f,p)}var Pi=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),n=Ti(this.list,e,this.findKeyCallback);return this.list=e,n},t}(),Ai=Pi,Mi=function(t,e){return Mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Mi(t,e)};var Li="function"===typeof Map?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),Ri=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,Li)||this}return function(t,e){function n(){this.constructor=t}Mi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Ai);var Di=Ri;function Ni(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function zi(t){return jr(t,hr)}function Oi(t){return t.length<3?0:Math.abs(function(t){for(var e=0,n=t.length-1;n>=0;--n)e+=t[n];return e}(t.map((function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]}))))/2}function Fi(t,e){var n=e.width,r=e.height,i=e.left,o=e.top,a=Bi(t),s=a.minX,l=a.minY,u=a.maxX,c=a.maxY,h=n/(u-s),f=r/(c-l);return t.map((function(t){return[i+(t[0]-s)*h,o+(t[1]-l)*f]}))}function Bi(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]}));return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function ji(t,e,n){var r=t[0],i=t[1],o=Bi(e),a=o.minX,s=o.maxX,l=[[a,i],[s,i]],u=Ui(l[0],l[1]),c=qi(e),h=[];if(c.forEach((function(e){var n,r=Ui(e[0],e[1]),o=e[0];(n=r,u.every((function(t,e){return 0===zi(t-n[e])})))?h.push({pos:t,line:e,type:"line"}):Zi(Vi(u,r),[l,e]).forEach((function(t){e.some((function(e){return r=t,!zi((n=e)[0]-r[0])&&!zi(n[1]-r[1]);var n,r}))?h.push({pos:t,line:e,type:"point"}):0!==zi(o[1]-i)&&h.push({pos:t,line:e,type:"intersection"})}))})),!n&&Pr(h,(function(t){return t[0]===r})))return!0;var f=0,p={};return h.forEach((function(t){var e=t.pos,n=t.type,o=t.line;if(!(e[0]>r))if("intersection"===n)++f;else{if("line"===n)return;if("point"===n){var a=Pr(o,(function(t){return t[1]!==i})),s=p[e[0]],l=a[1]>i?1:-1;s?s!==l&&++f:p[e[0]]=l}}})),f%2===1}function Ui(t,e){var n=t[0],r=t[1],i=e[0]-n,o=e[1]-r;Math.abs(i)<hr&&(i=0),Math.abs(o)<hr&&(o=0);var a=0,s=0,l=0;return i?o?(s=1,l=-(a=-o/i)*n-r):(s=1,l=-r):o&&(a=-1,l=n),[a,s,l]}function Vi(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],l=0===n&&0===o,u=0===r&&0===a,c=[];if(l&&u)return[];if(l){var h=-i/r;return h!==-s/a?[]:[[-1/0,h],[1/0,h]]}if(u){var f=-i/n;return f!==-s/o?[]:[[f,-1/0],[f,1/0]]}if(0===n)c=[[p=-(a*(d=-i/r)+s)/o,d]];else if(0===o){c=[[p=-(r*(d=-s/a)+i)/n,d]]}else if(0===r){c=[[p=-i/n,d=-(o*p+s)/a]]}else if(0===a){c=[[p=-s/o,d=-(n*p+i)/r]]}else{var p,d;c=[[p=(r*s-a*i)/(a*n-r*o),d=-(n*p+i)/r]]}return c.map((function(t){return[t[0],t[1]]}))}function Zi(t,e){var n=e.map((function(t){return[0,1].map((function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]}))})),r=[];if(2===t.length){var i=t[0],o=i[0],a=i[1];if(zi(o-t[1][0])){if(!zi(a-t[1][1])){var s=Math.max.apply(Math,n.map((function(t){return t[0][0]}))),l=Math.min.apply(Math,n.map((function(t){return t[0][1]})));if(zi(s-l)>0)return[];r=[[s,a],[l,a]]}}else{var u=Math.max.apply(Math,n.map((function(t){return t[1][0]}))),c=Math.min.apply(Math,n.map((function(t){return t[1][1]})));if(zi(u-c)>0)return[];r=[[o,u],[o,c]]}}return r.length||(r=t.filter((function(t){var e=t[0],r=t[1];return n.every((function(t){return 0<=zi(e-t[0][0])&&0<=zi(t[0][1]-e)&&0<=zi(r-t[1][0])&&0<=zi(t[1][1]-r)}))}))),r.map((function(t){return[zi(t[0]),zi(t[1])]}))}function qi(t){return Ni(t.slice(1),[t[0]]).map((function(e,n){return[t[n],e]}))}function Gi(t,e){var n=t.slice(),r=e.slice();-1===Fr(n)&&n.reverse(),-1===Fr(r)&&r.reverse();var i=qi(n),o=qi(r),a=i.map((function(t){return Ui(t[0],t[1])})),s=o.map((function(t){return Ui(t[0],t[1])})),l=[];a.forEach((function(t,e){var n=i[e],a=[];s.forEach((function(r,i){var s=Zi(Vi(t,r),[n,o[i]]);a.push.apply(a,s.map((function(t){return{index1:e,index2:i,pos:t,type:"intersection"}})))})),a.sort((function(t,e){return Br(n[0],t.pos)-Br(n[0],e.pos)})),l.push.apply(l,a),ji(n[1],r)&&l.push({index1:e,index2:-1,pos:n[1],type:"inside"})})),o.forEach((function(t,e){if(ji(t[1],n)){var r=!1,i=Tr(l,(function(t){return t.index2===e?(r=!0,!1):!!r}));-1===i&&(r=!1,i=Tr(l,(function(t){var n=t.index1,i=t.index2;return-1===n&&i+1===e?(r=!0,!1):!!r}))),-1===i?l.push({index1:-1,index2:e,pos:t[1],type:"inside"}):l.splice(i,0,{index1:-1,index2:e,pos:t[1],type:"inside"})}}));var u={};return l.filter((function(t){var e=t.pos,n=e[0]+"x"+e[1];return!u[n]&&(u[n]=!0,!0)}))}function Wi(t,e){var n=function(t,e){return Gi(t,e).map((function(t){return t.pos}))}(t,e);return Oi(n)}var Xi=function(){return Xi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Xi.apply(this,arguments)};var Hi=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(mr(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(mr(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=Tr(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[],r[t].push(Xi({listener:e},n))},t}(),Yi=Hi,$i=function(t,e){return $i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},$i(t,e)};var Ki=function(){return Ki=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ki.apply(this,arguments)};function Ji(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function Qi(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function to(t){return t?vr(t)?document.querySelector(t):_r(t)?t():t instanceof Element?t:"current"in t?t.current:"value"in t?t.value:void 0:null}var eo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._startRect=null,e._startPos=[],e._prevTime=0,e._timer=0,e._prevScrollPos=[0,0],e._isWait=!1,e._flag=!1,e._currentOptions=null,e._lock=!1,e._unregister=null,e._onScroll=function(){var t=e._currentOptions;!e._lock&&t&&e.emit("scrollDrag",{next:function(n){e.checkScroll({container:t.container,inputEvent:n})}})},e}!function(t,e){function n(){this.constructor=t}$i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t);var n=e.prototype;return n.dragStart=function(t,e){var n=to(e.container);if(n){var r=0,i=0,o=0,a=0;if(n===document.body)o=window.innerWidth,a=window.innerHeight;else{var s=n.getBoundingClientRect();r=s.top,i=s.left,o=s.width,a=s.height}this._flag=!0,this._startPos=[t.clientX,t.clientY],this._startRect={top:r,left:i,width:o,height:a},this._prevScrollPos=this._getScrollPosition([0,0],e),this._currentOptions=e,this._registerScrollEvent(e)}else this._flag=!1},n.drag=function(t,e){if(clearTimeout(this._timer),this._flag){var n=t.clientX,r=t.clientY,i=e.threshold,o=void 0===i?0:i,a=this._startRect,s=this._startPos;this._currentOptions=e;var l=[0,0];return a.top>r-o?(s[1]>a.top||r<s[1])&&(l[1]=-1):a.top+a.height<r+o&&(s[1]<a.top+a.height||r>s[1])&&(l[1]=1),a.left>n-o?(s[0]>a.left||n<s[0])&&(l[0]=-1):a.left+a.width<n+o&&(s[0]<a.left+a.width||n>s[0])&&(l[0]=1),!(!l[0]&&!l[1])&&this._continueDrag(Ki(Ki({},e),{direction:l,inputEvent:t,isDrag:!0}))}},n.checkScroll=function(t){var e=this;if(this._isWait)return!1;var n=t.prevScrollPos,r=void 0===n?this._prevScrollPos:n,i=t.direction,o=t.throttleTime,a=void 0===o?0:o,s=t.inputEvent,l=t.isDrag,u=this._getScrollPosition(i||[0,0],t),c=u[0]-r[0],h=u[1]-r[1],f=i||[c?Math.abs(c)/c:0,h?Math.abs(h)/h:0];return this._prevScrollPos=u,this._lock=!1,!(!c&&!h)&&(this.emit("move",{offsetX:f[0]?c:0,offsetY:f[1]?h:0,inputEvent:s}),a&&l&&(clearTimeout(this._timer),this._timer=window.setTimeout((function(){e._continueDrag(t)}),a)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(t,e){var n=e.container,r=e.getScrollPosition;return(void 0===r?Ji:r)({container:to(n),direction:t})},n._continueDrag=function(t){var e,n=this,r=t.container,i=t.direction,o=t.throttleTime,a=t.useScroll,s=t.isDrag,l=t.inputEvent;if(!(!this._flag||s&&this._isWait)){var u=Ir(),c=Math.max(o+this._prevTime-u,0);if(c>0)return clearTimeout(this._timer),this._timer=window.setTimeout((function(){n._continueDrag(t)}),c),!1;this._prevTime=u;var h=this._getScrollPosition(i,t);this._prevScrollPos=h,s&&(this._isWait=!0),a||(this._lock=!0);var f={container:to(r),direction:i,inputEvent:l};return null===(e=t.requestScroll)||void 0===e||e.call(t,f),this.emit("scroll",f),this._isWait=!1,a||this.checkScroll(Ki(Ki({},t),{prevScrollPos:h,direction:i,inputEvent:l}))}},n._registerScrollEvent=function(t){this._unregisterScrollEvent();var e=t.checkScrollEvent;if(e){var n=!0===e?Qi:e,r=to(t.container);!0!==e||r!==document.body&&r!==document.documentElement?this._unregister=n(r,this._onScroll):this._unregister=Qi(window,this._onScroll)}},n._unregisterScrollEvent=function(){var t;null===(t=this._unregister)||void 0===t||t.call(this),this._unregister=null},e}(Yi),no=eo,ro=function(t,e){return ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ro(t,e)};var io=function(){return io=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},io.apply(this,arguments)};function oo(t){return function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function ao(t){return t?t.touches?function(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(uo(t[r]));return n}(t.touches):[uo(t)]:[]}function so(t,e,n){var r=n.length,i=co(t,r),o=i.clientX,a=i.clientY,s=i.originalClientX,l=i.originalClientY,u=co(e,r),c=u.clientX,h=u.clientY,f=co(n,r);return{clientX:s,clientY:l,deltaX:o-c,deltaY:a-h,distX:o-f.clientX,distY:a-f.clientY}}function lo(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function uo(t){return{clientX:t.clientX,clientY:t.clientY}}function co(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=0;r<e;++r){var i=t[r];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var ho=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return t.prototype.getAngle=function(t){return void 0===t&&(t=this.prevClients),oo(t)},t.prototype.getRotation=function(t){return void 0===t&&(t=this.prevClients),oo(t)-oo(this.startClients)},t.prototype.getPosition=function(t,e){void 0===t&&(t=this.prevClients);var n=so(t||this.prevClients,this.prevClients,this.startClients),r=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(r*r+i*i),this.prevClients=t,n},t.prototype.getPositions=function(t){void 0===t&&(t=this.prevClients);var e=this.prevClients;return this.startClients.map((function(n,r){return so([t[r]],[e[r]],[n])}))},t.prototype.getMovement=function(t){var e=this.movement;if(!t)return e;var n=co(t,this.length),r=co(this.prevClients,this.length),i=n.clientX-r.clientX,o=n.clientY-r.clientY;return Math.sqrt(i*i+o*o)+e},t.prototype.getDistance=function(t){return void 0===t&&(t=this.prevClients),lo(t)},t.prototype.getScale=function(t){return void 0===t&&(t=this.prevClients),lo(t)/lo(this.startClients)},t.prototype.move=function(t,e){this.startClients.forEach((function(n){n.clientX-=t,n.clientY-=e})),this.prevClients.forEach((function(n){n.clientX-=t,n.clientY-=e}))},t}(),fo=["textarea","input"],po=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.data={},r.isDrag=!1,r.isPinch=!1,r.isMouse=!1,r.isTouch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r._dragFlag=!1,r._isTrusted=!1,r._isMouseEvent=!1,r._isSecondaryButton=!1,r._preventMouseEvent=!1,r._prevInputEvent=null,r.onDragStart=function(t,e){if(void 0===e&&(e=!0),r.flag||!1!==t.cancelable){var n=r.options,i=n.container,o=n.pinchOutside,a=n.preventWheelClick,s=n.preventRightClick,l=n.preventDefault,u=n.checkInput,c=n.preventClickEventOnDragStart,h=n.preventClickEventOnDrag,f=n.preventClickEventByCondition,p=r.isTouch,d=!r.flag;if(r._isSecondaryButton=3===t.which||2===t.button,a&&(2===t.which||1===t.button)||s&&(3===t.which||2===t.button))return r.stop(),!1;if(d){var m=document.activeElement,g=t.target;if(g){var v=g.tagName.toLowerCase(),y=fo.indexOf(v)>-1,_=g.isContentEditable;if(y||_){if(u||m===g)return!1;if(m&&_&&m.isContentEditable&&m.contains(g))return!1}else if((l||"touchstart"===t.type)&&m){var x=m.tagName.toLowerCase();(m.isContentEditable||fo.indexOf(x)>-1)&&m.blur()}(c||h||f)&&Gr(window,"click",r._onClick,!0)}r.clientStores=[new ho(ao(t))],r.flag=!0,r.isDrag=!1,r._isTrusted=e,r._dragFlag=!0,r._prevInputEvent=t,r.data={},r.doubleFlag=Ir()-r.prevTime<200,r._isMouseEvent=function(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}(t),!r._isMouseEvent&&r._preventMouseEvent&&(r._preventMouseEvent=!1),!1===(r._preventMouseEvent||r.emit("dragStart",io(io({data:r.data,datas:r.data,inputEvent:t,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,isTrusted:e,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()),{preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}})))&&r.stop(),r._isMouseEvent&&r.flag&&l&&t.preventDefault()}if(!r.flag)return!1;var b=0;if(d?(r._attchDragEvent(),p&&o&&(b=setTimeout((function(){Gr(i,"touchstart",r.onDragStart,{passive:!1})})))):p&&o&&Wr(i,"touchstart",r.onDragStart),r.flag&&function(t){return t.touches&&t.touches.length>=2}(t)){if(clearTimeout(b),d&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}}},r.onDrag=function(t,e){if(r.flag){var n=r.options.preventDefault;!r._isMouseEvent&&n&&t.preventDefault(),r._prevInputEvent=t;var i=ao(t),o=r.moveClients(i,t,!1);if(r._dragFlag){if(r.pinchFlag||o.deltaX||o.deltaY)if(!1===(r._preventMouseEvent||r.emit("drag",io(io({},o),{isScroll:!!e,inputEvent:t}))))return void r.stop();r.pinchFlag&&r.onPinch(t,i)}r.getCurrentStore().getPosition(i,!0)}},r.onDragEnd=function(t){if(r.flag){var e=r.options,n=e.pinchOutside,i=e.container,o=e.preventClickEventOnDrag,a=e.preventClickEventOnDragStart,s=e.preventClickEventByCondition,l=r.isDrag;(o||a||s)&&requestAnimationFrame((function(){r._allowClickEvent()})),s||a||!o||l||r._allowClickEvent(),r.isTouch&&n&&Wr(i,"touchstart",r.onDragStart),r.pinchFlag&&r.onPinchEnd(t);var u=(null===t||void 0===t?void 0:t.touches)?ao(t):[];0!==u.length&&r.options.keepDragging?r._addStore(new ho(u)):r.flag=!1;var c=r._getPosition(),h=Ir(),f=!l&&r.doubleFlag;r._prevInputEvent=null,r.prevTime=l||f?0:h,r.flag||(r._dettachDragEvent(),r._preventMouseEvent||r.emit("dragEnd",io({data:r.data,datas:r.data,isDouble:f,isDrag:l,isClick:!l,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,inputEvent:t,isTrusted:r._isTrusted},c)),r.clientStores=[],r._isMouseEvent||(r._preventMouseEvent=!0,requestAnimationFrame((function(){requestAnimationFrame((function(){r._preventMouseEvent=!1}))}))))}},r.onBlur=function(){r.onDragEnd()},r._allowClickEvent=function(){Wr(window,"click",r._onClick,!0)},r._onClick=function(t){r._allowClickEvent(),r._preventMouseEvent=!1;var e=r.options.preventClickEventByCondition;(null===e||void 0===e?void 0:e(t))||(t.stopPropagation(),t.preventDefault())},r._onContextMenu=function(t){r.options.preventRightClick?r.onDragEnd(t):t.preventDefault()},r._passCallback=function(){};var i=[].concat(e);r.options=io({checkInput:!1,container:i.length>1?window:i[0],preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=r.options,a=o.container,s=o.events,l=o.checkWindowBlur;if(r.isTouch=s.indexOf("touch")>-1,r.isMouse=s.indexOf("mouse")>-1,r.targets=i,r.isMouse&&(i.forEach((function(t){Gr(t,"mousedown",r.onDragStart),Gr(t,"mousemove",r._passCallback)})),Gr(a,"contextmenu",r._onContextMenu)),l&&Gr(window,"blur",r.onBlur),r.isTouch){var u={passive:!1};i.forEach((function(t){Gr(t,"touchstart",r.onDragStart,u),Gr(t,"touchmove",r._passCallback,u)}))}return r}return function(t,e){function n(){this.constructor=t}ro(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce((function(t,e){return t+e.movement}),0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(n,!0))},e.prototype.move=function(t,e){var n=t[0],r=t[1],i=this.getCurrentStore().prevClients;return this.moveClients(i.map((function(t){var e=t.clientX,i=t.clientY;return{clientX:e+n,clientY:i+r,originalClientX:e,originalClientY:i}})),e,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var e=this.data;for(var n in t)e[n]=t[n];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return void 0===t&&(t=this._prevInputEvent),io(io({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,e=this.targets,n=this.options.container;this.off(),Wr(window,"blur",this.onBlur),this.isMouse&&(e.forEach((function(e){Wr(e,"mousedown",t.onDragStart)})),Wr(n,"contextmenu",this._onContextMenu)),this.isTouch&&(e.forEach((function(e){Wr(e,"touchstart",t.onDragStart)})),Wr(n,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var e=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>e)){var n=new ho(ao(t));this.pinchFlag=!0,this._addStore(n),!1===this.emit("pinchStart",io(io({data:this.data,datas:this.data,angle:n.getAngle(),touches:this.getCurrentStore().getPositions()},n.getPosition()),{inputEvent:t,isTrusted:this._isTrusted}))&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",io(io({data:this.data,datas:this.data,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",io(io({data:this.data,datas:this.data,isPinch:e,touches:n.getPositions()},n.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,e,n){var r=this._getPosition(t,n),i=this.isDrag;(r.deltaX||r.deltaY)&&(this.isDrag=!0);var o=!1;return!i&&this.isDrag&&(o=!0),io(io({data:this.data,datas:this.data},r),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:e,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,e){var n=this.getCurrentStore().getPosition(t,e),r=this.clientStores.slice(1).reduce((function(t,e){var n=e.getPosition();return t.distX+=n.distX,t.distY+=n.distY,t}),n),i=r.distX,o=r.distY;return io(io({},n),{distX:i,distY:o})},e.prototype._attchDragEvent=function(){var t=this.options.container,e={passive:!1};this.isMouse&&(Gr(t,"mousemove",this.onDrag),Gr(t,"mouseup",this.onDragEnd)),this.isTouch&&(Gr(t,"touchmove",this.onDrag,e),Gr(t,"touchend",this.onDragEnd,e),Gr(t,"touchcancel",this.onDragEnd,e))},e.prototype._dettachDragEvent=function(){var t=this.options.container;this.isMouse&&(Wr(t,"mousemove",this.onDrag),Wr(t,"mouseup",this.onDragEnd)),this.isTouch&&(Wr(t,"touchstart",this.onDragStart),Wr(t,"touchmove",this.onDrag),Wr(t,"touchend",this.onDragEnd),Wr(t,"touchcancel",this.onDragEnd))},e}(Yi);var mo=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function go(t,e,n,r){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",t),n.nonce&&i.setAttribute("nonce",n.nonce),i.innerHTML=function(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(e,n){var r=n.trim();return(r?Er(r):[""]).map((function(e){var n=e.trim();return 0===n.indexOf("@")?n:n.indexOf(":global")>-1?n.replace(/\:global/g,""):n.indexOf(":host")>-1?""+n.replace(/\:host/g,"."+t):n?"."+t+" "+n:"."+t})).join(", ")+" {"}))}(t,e,n),(r||document.head||document.body).appendChild(i),i}var vo=function(t){var e,n="rCS"+mo(t).toString(36),r=0;return{className:n,inject:function(i,o){void 0===o&&(o={});var a,s=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(i),l=0===r;return(s||l)&&(a=go(n,t,o,s)),l&&(e=a),s||++r,{destroy:function(){s?(s.removeChild(a),a=null):(r>0&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}},yo=function(t,e){return yo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},yo(t,e)};function _o(t,e){function n(){this.constructor=t}yo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var xo=function(){return xo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},xo.apply(this,arguments)};var bo=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.injectResult=null,t.tag="div",t}_o(n,e);var r=n.prototype;return r.render=function(){var e=this.props,n=e.className,r=void 0===n?"":n,i=(e.cspNonce,e.portalContainer),o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["className","cspNonce","portalContainer"]),a=this.injector.className,s=this.tag,l={};return(t.version||"").indexOf("simple")>-1&&i&&(l={portalContainer:i}),(0,t.createElement)(s,xo({ref:ar(this,"element"),"data-styled-id":a,className:r+" "+a},l,o))},r.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},r.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},r.getElement=function(){return this.element},n}(t.Component);var wo=function(t,e){var n=vo(e);return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.injector=n,r.tag=t,r}return _o(r,e),r}(bo)},So=function(t,e){return So=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},So(t,e)};function Eo(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}So(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ko=function(){return ko=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ko.apply(this,arguments)};function Co(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function Io(t,e){var n;return ko({events:{},props:(n={},n[t]=Boolean,n),name:t},e)}var To=ir(),Po=To.browser.webkit,Ao=Po&&function(){var t="undefined"===typeof window?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return!!e&&parseFloat(e[1])<605}(),Mo="firefox"===To.browser.name,Lo=parseInt(To.browser.webkitVersion,10)>=612||parseInt(To.browser.version,10)>=15,Ro="moveable-",Do="\n{\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n    outline: 1px solid transparent;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.line.edge {\n    z-index: 1;\n    background: transparent;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n".concat([0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'.concat(t,'"], :global .view-control-rotation').concat(t," {\n\t").concat(function(t){var e=function(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}(1,t),n=45*Math.round(t/45)%180,r="ns-resize";return 135===n?r="nwse-resize":45===n?r="nesw-resize":90===n&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}(t),"\n}\n")})).join("\n"),"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid, .area.pass {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n").concat(Ao?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"","\n"),No=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],zo=1e-4,Oo=1e-7,Fo=1e-9,Bo=Math.pow(10,10),jo=-Bo,Uo=["n","w","s","e"],Vo=["n","w","s","e","nw","ne","sw","se"],Zo={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},qo={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},Go={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Wo=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function Xo(t,e,n,r,i,o){var a,s;void 0===o&&(o="draggable");var l=null!==(s=null===(a=e.gestos[o])||void 0===a?void 0:a.move(n,t.inputEvent))&&void 0!==s?s:{},u=l.originalDatas||l.datas,c=u[o]||(u[o]={});return ko(ko({},i?ds(e,l):l),{isPinch:!!r,parentEvent:!0,datas:c,originalDatas:t.originalDatas})}var Ho=function(){function t(t){var e;void 0===t&&(t="draggable"),this.ableName=t,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=((e={})[t]={},e)}var e=t.prototype;return e.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),ko(ko({},this.move(t,e.inputEvent)),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var n,r,i=!1;if(this.isFlag){var o=this.isDrag;n=this.prevX+t[0],r=this.prevY+t[1],(t[0]||t[1])&&(this.isDrag=!0),!o&&this.isDrag&&(i=!0)}else this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0;return this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:e,isFirstDrag:i,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function Yo(t,e){var n=e.clientX,r=e.clientY,i=e.datas,o=t.state,a=o.moveableClientRect,s=o.rootMatrix,l=o.is3d,u=o.pos1,c=ii(ps(s,[n-a.left,r-a.top],l?4:3),u),h=na({datas:i,distX:c[0],distY:c[1]});return[h[0],h[1]]}function $o(t,e){var n=e.datas,r=t.state,i=r.allMatrix,o=r.beforeMatrix,a=r.is3d,s=r.left,l=r.top,u=r.origin,c=r.offsetMatrix,h=r.targetMatrix,f=r.transformOrigin,p=a?4:3;n.is3d=a,n.matrix=i,n.targetMatrix=h,n.beforeMatrix=o,n.offsetMatrix=c,n.transformOrigin=f,n.inverseMatrix=Kr(i,p),n.inverseBeforeMatrix=Kr(o,p),n.absoluteOrigin=Qr(ri([s,l],u),p),n.startDragBeforeDist=si(n.inverseBeforeMatrix,n.absoluteOrigin,p),n.startDragDist=si(n.inverseMatrix,n.absoluteOrigin,p)}function Ko(t,e){var n=t.datas,r=t.originalDatas.beforeRenderable,i=n.transformIndex,o=r.nextTransforms,a=o.length,s=r.nextTransformAppendedIndexes,l=0;-1===i?("translate"===e?l=0:"rotate"===e&&(l=Tr(o,(function(t){return t.match(/scale\(/g)}))),-1===l&&(l=o.length),n.transformIndex=l):l=Pr(s,(function(t){return t.index===i&&t.functionName===e}))?i:i+s.filter((function(t){return t.index<i})).length;var u=function(t,e){var n=t.slice(0,e<0?void 0:e),r=t.slice(0,e<0?void 0:e+1),i=t[e]||"",o=e<0?[]:t.slice(e),a=e<0?[]:t.slice(e+1),s=wi(n),l=wi(r),u=wi([i]),c=wi(o),h=wi(a),f=bi(s),p=bi(l),d=bi(c),m=bi(h),g=ni(f,d,4);return{transforms:t,beforeFunctionMatrix:f,beforeFunctionMatrix2:p,targetFunctionMatrix:bi(u),afterFunctionMatrix:d,afterFunctionMatrix2:m,allFunctionMatrix:g,beforeFunctions:s,beforeFunctions2:l,targetFunction:u[0],afterFunctions:c,afterFunctions2:h,beforeFunctionTexts:n,beforeFunctionTexts2:r,targetFunctionText:i,afterFunctionTexts:o,afterFunctionTexts2:a}}(o,l),c=u.targetFunction,h="rotate"===e?"rotateZ":e;n.beforeFunctionTexts=u.beforeFunctionTexts,n.afterFunctionTexts=u.afterFunctionTexts,n.beforeTransform=u.beforeFunctionMatrix,n.beforeTransform2=u.beforeFunctionMatrix2,n.targetTansform=u.targetFunctionMatrix,n.afterTransform=u.afterFunctionMatrix,n.afterTransform2=u.afterFunctionMatrix2,n.targetAllTransform=u.allFunctionMatrix,c.functionName===h?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):a>l&&(n.isAppendTransform=!0,r.nextTransformAppendedIndexes=Co(Co([],s,!0),[{functionName:e,index:l,isAppend:!0}],!1))}function Jo(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function Qo(t){var e=t.datas,n=ea({datas:e,distX:t.distX,distY:t.distY}),r=ta(e,function(t,e){for(var n=gi(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}([n[0],n[1]],4));return si(r,Qr([0,0,0],4),4)}function ta(t,e,n){var r=t.beforeTransform,i=t.afterTransform,o=t.beforeTransform2,a=t.afterTransform2,s=t.targetAllTransform,l=n?ni(s,e,4):ni(e,s,4),u=ni(Kr(n?o:r,4),l,4);return ni(u,Kr(n?a:i,4),4)}function ea(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,o=e.is3d,a=e.startDragBeforeDist,s=o?4:3;return ii(si(i,ri(e.absoluteOrigin,[n,r]),s),a)}function na(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.inverseBeforeMatrix,a=n.inverseMatrix,s=n.is3d,l=n.startDragBeforeDist,u=n.startDragDist,c=s?4:3;return ii(si(e?o:a,ri(n.absoluteOrigin,[r,i]),c),e?l:u)}function ra(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function ia(t,e){var n=(e[0]+1)/2,r=(e[1]+1)/2,i=[pr(t[0][0],t[1][0],n,1-n),pr(t[0][1],t[1][1],n,1-n)],o=[pr(t[2][0],t[3][0],n,1-n),pr(t[2][1],t[3][1],n,1-n)];return[pr(i[0],o[0],r,1-r),pr(i[1],o[1],r,1-r)]}function oa(t,e,n,r){return ni(t,Sa(e,r,n),r)}function aa(t){var e=ca(t);return{setTransform:function(n,r){void 0===r&&(r=-1),e.startTransforms=gr(n)?n:Sr(n),la(t,r)},setTransformIndex:function(e){la(t,e)}}}function sa(t,e){la(t,Tr(ca(t).startTransforms,(function(t){return 0===t.indexOf("".concat(e,"("))})))}function la(t,e){var n=ca(t),r=t.datas;if(r.transformIndex=e,-1!==e){var i=n.startTransforms[e];if(i){var o=wi([i]);r.startValue=o[0].functionValue}}}function ua(t,e){ca(t).nextTransforms=Sr(e)}function ca(t){return t.originalDatas.beforeRenderable}function ha(t){return t.originalDatas.beforeRenderable.nextTransforms}function fa(t){return ha(t).join(" ")}function pa(t){return ca(t).nextStyle}function da(t,e,n,r,i){ua(i,e);var o=Bl.drag(t,Xo(i,t.state,n,r,!1)),a=o?o.transform:e;return ko(ko({transform:e,drag:o},es({transform:a},i)),{afterTransform:a})}function ma(t,e,n,r,i){var o=t.state,a=o.left,s=o.top,l=t.props.groupable,u=function(t,e,n){var r=t.transformOrigin,i=t.offsetMatrix,o=t.is3d,a=e.beforeTransform,s=e.afterTransform,l=o?4:3;return oa(i,ti(ni(ni(a,xi([n]),4),s,4),4,l),r,l)}(t.state,i,e),c=l?a:0,h=l?s:0,f=ii(r,va(t,n,u));return ii(f,[c,h])}function ga(t,e,n){return[t[0]/(e/2)-1,t[1]/(n/2)-1]}function va(t,e,n){void 0===n&&(n=t.state.allMatrix);var r=t.state,i=r.width,o=r.height,a=r.is3d?4:3;return Na(n,[i/2*(1+e[0]),o/2*(1+e[1])],a)}function ya(t,e,n,r,i,o){var a=t.props.groupable,s=t.state,l=s.transformOrigin,u=s.offsetMatrix,c=s.is3d,h=s.width,f=s.height,p=s.left,d=s.top,m=o.fixedDirection,g=o.nextTargetMatrix||s.targetMatrix,v=c?4:3,y=function(t,e,n,r,i,o){return void 0===r&&(r=e),void 0===i&&(i=n),void 0===o&&(o=[0,0]),t?t.map((function(t,a){var s=Cr(t),l=s.value,u=s.unit,c=a?i:r,h=a?n:e;return"%"===t||isNaN(l)?h*(c?o[a]/c:0):"%"!==u?l:h*l/100})):o}(i,e,n,h,f,l),_=a?p:0,x=a?d:0,b=function(t,e,n,r,i,o){var a=ia(za(e,n,r,i),o);return[t[0]-a[0],t[1]-a[1]]}(r,oa(u,g,y,v),e,n,v,m);return ii(b,[_,x])}function _a(t,e){return ia(Qa(t.state),e)}function xa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return or.apply(void 0,Co([Ro],t,!1))}function ba(t){t()}function wa(t){return t&&"none"!==t?mr(t)?t:xi(t):[1,0,0,1,0,0]}function Sa(t,e,n){return ei(e,yi(n,e),t,yi(n.map((function(t){return-t})),e))}function Ea(t){return ka(ss(t,":before")).map((function(e,n){var r=Cr(e),i=r.value,o=r.unit;return i*function(t,e,n){return"%"===e?Ra(t.ownerSVGElement)[n?"width":"height"]/100:1}(t,o,0===n)}))}function ka(t){var e=t.transformOrigin;return e?e.split(" "):["0","0"]}function Ca(t,e){void 0===e&&(e=ss(t));var n=e.transform;if(n&&"none"!==n)return e.transform;if("transform"in t){var r=t.transform.baseVal;if(!r)return"";var i=r.length;if(!i)return"";for(var o=[],a=function(t){var e=r[t].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map((function(t){return e[t]})).join(", "),")"))},s=0;s<i;++s)a(s);return o.join(" ")}return""}function Ia(t,e,n,r,i){var o,a,s,l,u,c=t&&t.ownerDocument?t.ownerDocument:document,h=c.documentElement||c.body,f=!1;if(!t||n)l=t;else{var p=null===(o=null===t||void 0===t?void 0:t.assignedSlot)||void 0===o?void 0:o.parentElement,d=t.parentElement;p?(f=!0,u=d,l=p):l=d}for(var m=!1,g=t===e||l===e,v="relative",y=1,_=parseFloat(null===(a=i)||void 0===a?void 0:a.zoom)||1,x=null===i||void 0===i?void 0:i.position;l&&l!==h;){e===l&&(g=!0);var b=ss(l),w=l.tagName.toLowerCase(),S=Ca(l,b),E=b.willChange,k=parseFloat(b.zoom)||1;if(v=b.position,r&&1!==k){y=k;break}if(!n&&r&&1!==_&&x&&"absolute"!==x||"svg"===w||"static"!==v||S&&"none"!==S||"transform"===E)break;var C=null===(s=null===t||void 0===t?void 0:t.assignedSlot)||void 0===s?void 0:s.parentNode,I=l.parentNode;C&&(f=!0,u=I);var T=C||I;if(T&&11===T.nodeType){l=T.host,m=!0;break}l=T,v="relative"}return{offsetZoom:y,hasSlot:f,parentSlotElement:u,isCustomElement:m,isStatic:"static"===v,isEnd:g||!l||l===h,offsetParent:l||h}}function Ta(t,e,n){var r,i,o,a=t.tagName.toLowerCase(),s=t.offsetLeft,l=t.offsetTop,u=dr(s),c=!u;return c||"svg"===a?o=(i=ka(n).map((function(t){return parseFloat(t)}))).slice():(o=(i=Ao?Ea(t):ka(n).map((function(t){return parseFloat(t)}))).slice(),c=!0,r=function(t,e,n){if(!t.getBBox||!n&&"g"===t.tagName.toLowerCase())return[0,0,0,0];var r=t.getBBox(),i=Ra(t.ownerSVGElement),o=r.x-i.x,a=r.y-i.y;return[o,a,e[0]-o,e[1]-a]}(t,i,t===e&&"g"===e.tagName.toLowerCase()),s=r[0],l=r[1],i[0]=r[2],i[1]=r[3]),{tagName:a,isSVG:u,hasOffset:c,offset:[s||0,l||0],origin:i,targetOrigin:o}}function Pa(t,e,n){void 0===n&&(n=ss(t));var r=ss(document.body),i=r.position;if(!e&&(!i||"static"===i))return[0,0];var o=parseInt(r.marginLeft,10),a=parseInt(r.marginTop,10);return"absolute"===n.position&&("auto"===n.top&&"auto"===n.bottom||(a=0),"auto"===n.left&&"auto"===n.right||(o=0)),[o,a]}function Aa(t){t.forEach((function(t){var e=t.matrix;e&&(t.matrix=ti(e,3,4))}))}function Ma(t){for(var e=t.parentElement,n=!1;e;){var r=ss(e).transform;if(r&&"none"!==r){n=!0;break}if(e===document.body)break;e=e.parentElement}return{fixedContainer:e||document.body,hasTransform:n}}function La(t,e){return void 0===e&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(ai(t,!e).join(","),")")}function Ra(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function Da(t,e){var n=Ra(t),r=n.width,i=n.height,o=n.clientWidth,a=n.clientHeight,s=o/r,l=a/i,u=t.preserveAspectRatio.baseVal,c=u.align,h=u.meetOrSlice,f=[0,0],p=[s,l],d=[0,0];if(1!==c){var m=(c-2)%3,g=Math.floor((c-2)/3);f[0]=r*m/2,f[1]=i*g/2;var v=2===h?Math.max(l,s):Math.min(s,l);p[0]=v,p[1]=v,d[0]=(o-r)/2*m,d[1]=(a-i)/2*g}var y=vi(p,e);return y[e*(e-1)]=d[0],y[e*(e-1)+1]=d[1],Sa(y,e,f)}function Na(t,e,n){return si(t,Qr(e,n),n)}function za(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map((function(e){return Na(t,e,r)}))}function Oa(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(Math,e),i=Math.min.apply(Math,n),o=Math.max.apply(Math,e),a=Math.max.apply(Math,n);return{left:r,top:i,right:o,bottom:a,width:o-r,height:a-i}}function Fa(t,e,n,r){return Oa(za(t,e,n,r))}function Ba(t,e,n,r){var i=16===t.length?4:3,o=za(t,n,r,i),a=o[0],s=a[0],l=a[1],u=o[1],c=u[0],h=u[1],f=o[2],p=f[0],d=f[1],m=o[3],g=m[0],v=m[1],y=Na(t,e,i),_=y[0],x=y[1],b=Math.min(s,c,p,g),w=Math.min(l,h,d,v),S=Math.max(s,c,p,g);return s=s-b||0,{left:b,top:w,right:S,bottom:Math.max(l,h,d,v),origin:[_=_-b||0,x=x-w||0],pos1:[s,l=l-w||0],pos2:[c=c-b||0,h=h-w||0],pos3:[p=p-b||0,d=d-w||0],pos4:[g=g-b||0,v=v-w||0],direction:Fr(za(t,100,100,i))}}function ja(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ua(t,e){return ja([e[0]-t[0],e[1]-t[1]])}function Va(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=Or(t,e));var i=Ua(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function Za(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,o=n.reduce((function(t,e){return t+e[0]}),0)/i,a=n.reduce((function(t,e){return t+e[1]}),0)/i;return{transform:"translateZ(0px) translate(".concat(o,"px, ").concat(a,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function qa(t,e){var n=t[e];return mr(n)?ko(ko({},t),n):t}function Ga(t,e){void 0===e&&(e=t?ss(t):null);var n=t&&!dr(t.offsetWidth),r=0,i=0,o=0,a=0,s=0,l=0,u=0,c=0,h=0,f=0,p=0,d=0,m=1/0,g=1/0,v=1/0,y=1/0,_=0,x=0,b=!1;if(t)if(n||"svg"===t.tagName.toLowerCase()){var w=t.style,S="border-box"===e.boxSizing,E=parseFloat(e.borderLeftWidth)||0,k=parseFloat(e.borderRightWidth)||0,C=parseFloat(e.borderTopWidth)||0,I=parseFloat(e.borderBottomWidth)||0,T=(parseFloat(e.paddingLeft)||0)+(parseFloat(e.paddingRight)||0),P=(parseFloat(e.paddingTop)||0)+(parseFloat(e.paddingBottom)||0),A=T+(E+k),M=P+(C+I),L=e.position,R=0,D=0;if("clientLeft"in t){var N=null;if("absolute"===L)N=Ia(t,document.body).offsetParent;else N=t.parentElement;if(N){var z=ss(N);R=parseFloat(z.width),D=parseFloat(z.height)}}h=Math.max(T,Rr(e.minWidth,R)||0),f=Math.max(P,Rr(e.minHeight,D)||0),m=Rr(e.maxWidth,R),g=Rr(e.maxHeight,D),isNaN(m)&&(m=1/0),isNaN(g)&&(g=1/0),_=Rr(w.width,0)||0,x=Rr(w.height,0)||0,s=parseFloat(e.width)||0,l=parseFloat(e.height)||0,r=u=Math.abs(s-_)<1?Dr(h,_||s,m):s,i=c=Math.abs(l-x)<1?Dr(f,x||l,g):l,o=u,a=c,S?(v=m,y=g,p=h,d=f,u=r-A,c=i-M):(v=m+A,y=g+M,p=h+A,d=f+M,r=u+A,i=c+M),o=u+T,a=c+P}else{var O=t.getBBox();b=!0,s=r=O.width,l=i=O.height,u=r,c=i,o=r,a=i}return{svg:b,offsetWidth:r,offsetHeight:i,clientWidth:o,clientHeight:a,contentWidth:u,contentHeight:c,inlineCSSWidth:_,inlineCSSHeight:x,cssWidth:s,cssHeight:l,minWidth:h,minHeight:f,maxWidth:m,maxHeight:g,minOffsetWidth:p,minOffsetHeight:d,maxOffsetWidth:v,maxOffsetHeight:y}}function Wa(t,e){return Or(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Xa(t,e){var n=t===document.body||t===document.documentElement,r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow="visible"!==ss(t).overflow,ko(ko({},e),r)}function Ha(t,e,n,r){var i=t.left,o=t.right,a=t.top,s=t.bottom,l=e.top,u=e.left,c={left:u+i,top:l+a,right:u+o,bottom:l+s,width:o-i,height:s-a};return n&&r?Xa(n,c):c}function Ya(t,e){var n=0,r=0,i=0,o=0;if(t){var a=t.getBoundingClientRect();n=a.left,r=a.top,i=a.width,o=a.height}var s={left:n,top:r,width:i,height:o,right:n+i,bottom:r+o};return t&&e?Xa(t,s):s}function $a(t,e,n,r){var i;if(t)i=t;else if(e)i=[0,0];else{i=Ka(n.target,r)}return i}function Ka(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function Ja(t,e){return[ri(e,t[0]),ri(e,t[1]),ri(e,t[2]),ri(e,t[3])]}function Qa(t){var e=t.left,n=t.top;return Ja([t.pos1,t.pos2,t.pos3,t.pos4],[e,n])}function ts(t,e){var n;null===(n=t[e])||void 0===n||n.unset(),t[e]=null}function es(t,e){if(e){var n=ca(e);n.nextStyle=ko(ko({},n.nextStyle),t)}return{style:t,cssText:Lr(t).map((function(e){return"".concat((n=e,r="-",void 0===r&&(r="-"),n.replace(/([a-z])([A-Z])/g,(function(t,e,n){return""+e+r+n.toLowerCase()}))),": ").concat(t[e],";");var n,r})).join("")}}function ns(t,e,n){var r=e.afterTransform||e.transform;return ko(ko({},es(ko(ko(ko({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function rs(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var o=ko(ko({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isFirstDrag:!!e.isFirstDrag,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var t;null===(t=e.stop)||void 0===t||t.call(e)}});return i.isStartEvent?r||(i.lastEvent=o):i.isStartEvent=!0,o}function is(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),ko(ko({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function os(t,e,n){t._emitter.on(e,n)}function as(t,e,n,r){return t.triggerEvent(e,n,r)}function ss(t,e){return window.getComputedStyle(t,e)}function ls(t,e,n){var r={},i={};return t.filter((function(t){var o=t.name;if(r[o]||!e.some((function(e){return t[e]})))return!1;if(!n&&t.ableGroup){if(i[t.ableGroup])return!1;i[t.ableGroup]=!0}return r[o]=!0,!0}))}function us(t,e){return t===e||null==t&&null==e}function cs(t,e){var n=[],r=[];return t.forEach((function(i,o){var a=e(i,o,t),s=r.indexOf(a),l=n[s]||[];-1===s&&(r.push(a),n.push(l)),l.push(i)})),n}function hs(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function fs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(e)-Math.abs(t)})),t[0]}function ps(t,e,n){return si(Kr(t,n),Qr(e,n),n)}function ds(t,e){var n,r=t.is3d?4:3;return n=ps(t.rootMatrix,[e.distX,e.distY],r),e.distX=n[0],e.distY=n[1],e}function ms(t,e,n,r,i){return ii(Na(t,ri(n,e),i),r)}function gs(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function vs(t){return Math.abs(t)<=Oo?0:t}function ys(t){return function(e){if(!e.isDragging(t))return"";var n=function(t,e){var n,r=t.targetGesto,i=t.controlGesto;return(null===r||void 0===r?void 0:r.isFlag())&&(n=r.getEventData()[e]),!n&&(null===i||void 0===i?void 0:i.isFlag())&&(n=i.getEventData()[e]),n||{}}(e,t),r=n.deg;return r?xa("view-control-rotation".concat(r)):""}}function _s(t,e){return void 0===e&&(e=[t]),function(n,r){if(r.isRequest)return!!e.some((function(t){return r.requestAble===t}))&&r.parentDirection;var i=r.inputEvent.target;return Vr(i,xa("direction"))&&(!t||Vr(i,xa(t)))}}function xs(t){var e={};for(var n in t)e[t[n]]=n;return e}function bs(t,e){return t?t instanceof Element?t:vr(t)?e?document.querySelector(t):t:_r(t)?t():"current"in t?t.current:t:null}function ws(t,e){return t?(!(n=t)||!mr(n)||n instanceof Element||!gr(n)&&!("length"in n)?[t]:[].slice.call(t)).reduce((function(t,n){return vr(n)&&e?Co(Co([],t,!0),[].slice.call(document.querySelectorAll(n)),!0):(gr(n)?t.push(ws(n,e)):t.push(bs(n,e)),t)}),[]):[];var n}function Ss(t,e){var n=t.rootMatrix,r=t.is3d,i=Kr(n,r?4:3);return r||(i=ti(i,3,4)),i[12]=0,i[13]=0,i[14]=0,function(t,e){var n=si(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}(i,e)}function Es(t,e,n,r,i){var o=t[0],a=t[1],s=0,l=0;if(i&&o&&a){var u=Or([0,0],e),c=Or([0,0],r),h=ja(e),f=Math.cos(u-c)*h;if(r[0])if(r[1]){var p=2*r[0]*o,d=2*r[1]*a,m=ja([p+e[0],d+e[1]])-ja([p,d]),g=Or([0,0],[n,1]);s=Math.cos(g)*m,l=Math.sin(g)*m}else l=(s=f)/n;else s=(l=f)*n}else s=r[0]*e[0],l=r[1]*e[1];return[s,l]}function ks(t,e,n,r){var i,o=n.ratio,a=n.startOffsetWidth,s=n.startOffsetHeight,l=0,u=0,c=r.distX,h=r.distY,f=r.parentDistance,p=r.parentDist,d=r.parentScale,m=n.fixedDirection,g=[0,1].map((function(e){return Math.abs(t[e]-m[e])})),v=[0,1].map((function(t){var e=g[t];return 0!==e&&(e=2/e),e}));if(p)l=p[0],u=p[1],e&&(l?u||(u=l/o):l=u*o);else if(d)l=(d[0]-1)*a,u=(d[1]-1)*s;else if(f){var y=a*g[0],_=s*g[1],x=ja([y,_]);l=f/x*y*v[0],u=f/x*_*v[1]}else{var b=na({datas:n,distX:c,distY:h});b=v.map((function(t,e){return b[e]*t})),l=(i=Es([a,s],b,o,t,e))[0],u=i[1]}return{distWidth:l,distHeight:u}}function Cs(t,e){if(e){if("left"===t)return{x:"0%",y:"50%"};if("top"===t)return{x:"50%",y:"50%"};if("center"===t)return{x:"50%",y:"50%"};if("right"===t)return{x:"100%",y:"50%"};if("bottom"===t)return{x:"50%",y:"100%"};var n=t.split(" "),r=n[0],i=n[1],o=Cs(r||""),a=Cs(i||""),s=ko(ko({},o),a),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return"left"===t?{x:"0%"}:"right"===t?{x:"100%"}:"top"===t?{y:"0%"}:"bottom"===t?{y:"100%"}:t?"center"===t?{value:"50%"}:{value:t}:{}}function Is(t,e,n){var r=Cs(t,!0),i=r.x,o=r.y;return[Rr(i,e)||0,Rr(o,n)||0]}function Ts(t,e){return t.length===e.length&&t.every((function(t,n){var r=e[n],i=gr(t),o=gr(r);return i&&o?Ts(t,r):!i&&!o&&t===r}))}var Ps=Io("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,o=e.originalDatas,a=t.props,s=a.pinchable,l=a.ables;if(!s)return!1;var u="onPinch".concat(r?"Group":"","Start"),c="drag".concat(r?"Group":"","ControlStart"),h=(!0===s?t.controlAbles:l.filter((function(t){return s.indexOf(t.name)>-1}))).filter((function(t){return t.canPinch&&t[c]})),f=rs(t,e,{});r&&(f.targets=r);var p=as(t,u,f);n.isPinch=!1!==p,n.ables=h;var d=n.isPinch;return!!d&&(h.forEach((function(n){if(o[n.name]=o[n.name]||{},n[c]){var r=ko(ko({},e),{datas:o[n.name],parentRotate:i,isPinch:!0});n[c](t,r)}})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},d)},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,o=e.originalDatas,a=e.inputEvent,s=e.targets,l=e.angle;if(n.isPinch){var u=i*(1-1/r),c=rs(t,e,{});s&&(c.targets=s);var h="onPinch".concat(s?"Group":"");as(t,h,c);var f=n.ables,p="drag".concat(s?"Group":"","Control");return f.forEach((function(n){n[p]&&n[p](t,ko(ko({},e),{datas:o[n.name],inputEvent:a,parentDistance:u,parentRotate:l,isPinch:!0}))})),c}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=e.targets,a=e.originalDatas;if(n.isPinch){var s="onPinch".concat(o?"Group":"","End"),l=is(t,e,{isDrag:r});o&&(l.targets=o),as(t,s,l);var u=n.ables,c="drag".concat(o?"Group":"","ControlEnd");return u.forEach((function(n){n[c]&&n[c](t,ko(ko({},e),{isDrag:r,datas:a[n.name],inputEvent:i,isPinch:!0}))})),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,ko(ko({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,ko(ko({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,ko(ko({},e),{targets:t.props.targets}))}});function As(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var o=i.childDatas;return t.moveables.map((function(t,r){return o[r]=o[r]||{},o[r][e]=o[r][e]||{},ko(ko({},n),{datas:o[r][e],originalDatas:o[r]})}))}function Ms(t,e,n,r,i,o,a){var s=!!n.match(/Start$/g),l=!!n.match(/End$/g),u=i.isPinch,c=i.datas,h=As(t,e.name,i),f=t.moveables,p=h.map((function(t,i){var h=f[i],p=h.state,d=p.gestos,m=t;if(s)m=new Ho(a).dragStart(r,t);else{if(d[a]||(d[a]=c.childGestos[i]),!d[a])return;m=Xo(t,p,r,u,o,a)}var g=e[n](h,ko(ko({},m),{parentFlag:!0}));return l&&(d[a]=null),g}));return s&&(c.childGestos=f.map((function(t){return t.state.gestos[a]}))),p}function Ls(t,e,n,r,i,o){void 0===i&&(i=function(t,e){return e});var a=!!n.match(/End$/g),s=As(t,e.name,r),l=t.moveables,u=s.map((function(t,r){var s,u=l[r];s=i(u,t);var c=e[n](u,ko(ko({},s),{parentFlag:!0}));return c&&o&&o(u,t,c,r),a&&(u.state.gestos={}),c}));return u}var Rs=["left","right","center"],Ds=["top","bottom","middle"],Ns={start:"left",end:"right",center:"center"},zs={start:"top",end:"bottom",center:"middle"};function Os(t,e){var n=t.props,r=n.snappable,i=n.bounds,o=n.innerBounds,a=n.verticalGuidelines,s=n.horizontalGuidelines,l=n.snapGridWidth,u=n.snapGridHeight,c=t.state,h=c.guidelines,f=c.enableSnap;return!(!r||!f||e&&!0!==r&&r.indexOf(e)<0)&&!!(l||u||i||o||h&&h.length||a&&a.length||s&&s.length)}function Fs(t){return!1===t?{}:!0!==t&&t?t:{left:!0,right:!0,top:!0,bottom:!0}}function Bs(t,e){var n=function(t,e){var n=Fs(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}(t,e),r=Ds.filter((function(t){return t in n})),i=Rs.filter((function(t){return t in n}));return{horizontal:r.map((function(t){return n[t]})),vertical:i.map((function(t){return n[t]}))}}function js(t,e,n,r){var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!dr(i))return i}return t[n]}(r,t.props.snapThreshold,5);return Us(t.state.guidelines,e,n,i)}function Us(t,e,n,r){return{vertical:qs(t,"vertical",e,r),horizontal:qs(t,"horizontal",n,r)}}function Vs(t,e,n){var r=Bs(t.props.snapDirections,e);return js(t,r.vertical,r.horizontal,n)}function Zs(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,o=r.dist,a=r.guideline;return{isSnap:e,offset:i,dist:o,pos:n.pos,guideline:a}}function qs(t,e,n,r){if(!t||!t.length)return{isSnap:!1,index:-1,posInfos:[]};var i="vertical"===e?0:1,o=n.map((function(n,o){var a=t.map((function(t){var e=t.pos,r=n-e[i];return{offset:r,dist:Math.abs(r),guideline:t}})).filter((function(t){var n=t.guideline,i=t.dist;return!(n.type!==e||i>r)})).sort((function(t,e){return t.dist-e.dist}));return{pos:n,index:o,guidelineInfos:a}})).filter((function(t){return t.guidelineInfos.length>0})).sort((function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist})),a=o.length>0;return{isSnap:a,index:a?o[0].index:-1,posInfos:o}}function Gs(t,e,n,r){void 0===r&&(r=1);var i=[];if(n[0]&&n[1])i=[n,[-n[0],n[1]],[n[0],-n[1]]].map((function(t){return ia(e,t)}));else if(n[0]||n[1])t.props.keepRatio?i=[[-1,-1],[-1,1],[1,-1],[1,1],n].map((function(t){return ia(e,t)})):(i=function(t,e){return ra(e).map((function(e){return t[e]}))}(e,n),i.length>1&&i.push([(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]));else for(var o=[e[0],e[1],e[3],e[2],e[0]],a=0;a<4;++a)i.push(o[a]),i.push([(o[a][0]+o[a+1][0])/2,(o[a][1]+o[a+1][1])/2]);return js(t,i.map((function(t){return t[0]})),i.map((function(t){return t[1]})),r)}function Ws(t,e){var n=Math.abs(t.offset),r=Math.abs(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Oo?1:r<Oo?-1:n-r}function Xs(t,e){return t.slice().sort((function(t,n){var r=t.sign[e],i=n.sign[e],o=t.offset[e],a=n.offset[e];return r?i?Ws({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:a}):-1:1}))[0]}function Hs(t,e){var n=zr([e[0][0],e[1][0]]),r=zr([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function Ys(t,e){var n,r,i=e[0],o=e[1],a=o[0]-i[0],s=o[1]-i[1];if(Math.abs(a)<Oo&&(a=0),Math.abs(s)<Oo&&(s=0),a)if(s){n=s/a*(t[0]-i[0])+i[1],r=t[1]}else n=i[1],r=t[1];else n=i[0],r=t[0];return n-r}function $s(t,e,n,r){return void 0===r&&(r=Oo),t.every((function(t){var i=Ys(t,e);return i<=0===n||Math.abs(i)<=r}))}function Ks(t,e,n,r,i){return void 0===i&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function Js(t,e,n,r,i,o){var a=e[0],s=e[1],l=t[0],u=n[0],c=n[1],h=vs(c[1]-u[1]),f=s,p=a,d=-a/s;if(!vs(c[0]-u[0])){if(o&&!p)return{isBound:!1,offset:0};if(f)return Ks(d*(u[0]-l[0])+l[1],u[1],c[1],r,i);var m=u[0]-l[0];return{isBound:g=Math.abs(m)<=(i||0),offset:g?m:0}}if(!h){if(o&&!f)return{isBound:!1,offset:0};if(p)return Ks((u[1]-l[1])/d+l[0],u[0],c[0],r,i);var g;m=u[1]-l[1];return{isBound:g=Math.abs(m)<=(i||0),offset:g?m:0}}return{isBound:!1,offset:0}}function Qs(t,e,n){return e.map((function(e){var r=function(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,o=e.horizontalSign,a=e.lineConstants,s=t.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,u=s.top,c=s.width,h=s.height,f=[[l,u],[l,u+h]],p=[[l,u],[l+c,u]],d=[[l+c,u],[l+c,u+h]],m=[[l,u+h],[l+c,u+h]];if($s([[l,u],[l+c,u],[l,u+h],[l+c,u+h]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Js(n,a,p,i),v=Js(n,a,m,i),y=Js(n,a,f,o),_=Js(n,a,d,o),x=g.isBound&&v.isBound,b=g.isBound||v.isBound,w=y.isBound&&_.isBound,S=y.isBound||_.isBound,E=fs(g.offset,v.offset),k=fs(y.offset,_.offset),C=[0,0],I=!1,T=!1;return Math.abs(k)<Math.abs(E)?(C=[E,0],I=b,T=x):(C=[0,k],I=S,T=w),{isAllBound:T,isVerticalBound:b,isHorizontalBound:S,isBound:I,offset:C}}(t,e),i=r.isBound,o=r.offset,a=r.isVerticalBound,s=r.isHorizontalBound,l=e.multiple,u=na({datas:n,distX:o[0],distY:o[1]}).map((function(t,e){return t*(l[e]?2/l[e]:0)}));return{sign:l,isBound:i,isVerticalBound:a,isHorizontalBound:s,isSnap:!1,offset:u}}))}function tl(t,e,n){var r,i=Qs(t,el(t,e,[0,0],!1).map((function(t){return ko(ko({},t),{multiple:t.multiple.map((function(t){return 2*Math.abs(t)}))})})),n),o=Xs(i,0),a=Xs(i,1),s=0,l=0,u=o.isVerticalBound||a.isVerticalBound,c=o.isHorizontalBound||a.isHorizontalBound;return(u||c)&&(r=function(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.beforeMatrix,a=n.matrix,s=n.is3d,l=n.startDragBeforeDist,u=n.startDragDist,c=n.absoluteOrigin,h=s?4:3;return ii(si(e?o:a,ri(e?l:u,[r,i]),h),c)}({datas:n,distX:-o.offset[0],distY:-a.offset[1]}),s=r[0],l=r[1]),{vertical:{isBound:u,offset:s},horizontal:{isBound:c,offset:l}}}function el(t,e,n,r){var i=t.state,o=za(i.allMatrix,100,100,i.is3d?4:3),a=ia(o,[0,0]);return function(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,2*i],t,[-r,i]],[[2*r,0],t,[r,-i]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,2*i],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}(n,r).map((function(t){var n=t[0],r=t[1],i=t[2],s=[ia(o,r),ia(o,i)],l=function(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];Math.abs(r)<hr&&(r=0),Math.abs(i)<hr&&(i=0);var o=0,a=0,s=0;return r?i?(a=1,s=(o=-i/r)*e[0]-e[1]):(a=1,s=-e[1]):(o=-1,s=e[0]),[o,a,s].map((function(t){return jr(t,hr)}))}(s),u=Hs(a,s),c=u.vertical,h=u.horizontal;return{multiple:n,centerSign:Ys(a,s)<=0,verticalSign:c,horizontalSign:h,lineConstants:l,line:[ia(e,r),ia(e,i)]}}))}function nl(t,e,n,r){var i=r?t.map((function(t){return fi(t,r)})):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some((function(t){var r=Ys(n,t)<=0;return!$s(e,t,r)}))}function rl(t,e,n,r,i){var o=t.props.innerBounds,a=i*Math.PI/180;if(!o)return[];var s=o.left,l=o.top,u=o.width,c=o.height,h=s-r[0],f=s+u-r[0],p=l-r[1],d=l+c-r[1],m=[[h,p],[f,p],[h,d],[f,d]],g=ia(n,[0,0]);if(!nl(n,m,g,0))return[];var v=[],y=m.map((function(t){return[ja(t),Or([0,0],t)]}));return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach((function(t){var n=Or([0,0],function(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return[e[0],0];if(!i)return[0,e[1]];var o=i/r,a=-o*e[0]+e[1];return[-a/(o+1/o),a/(o*o+1)]}(t)),r=function(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return Math.abs(e[0]);if(!i)return Math.abs(e[1]);var o=i/r;return Math.abs((-o*e[0]+e[1])/Math.sqrt(Math.pow(o,2)+1))}(t);v.push.apply(v,y.filter((function(t){var e=t[0];return e&&r<=e})).map((function(t){var e=t[0],i=t[1],o=Math.acos(e?r/e:0);return[a+(i+o)-n,a+(i-o)-n]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!nl(e,m,g,t)})).map((function(t){return jr(180*t/Math.PI,Oo)})))})),v}function il(t,e,n){var r=t||{},i=r.position,o=void 0===i?"client":i,a=r.left,s=void 0===a?-1/0:a,l=r.top,u=void 0===l?-1/0:l,c=r.right,h=void 0===c?1/0:c,f=r.bottom,p={position:o,left:s,top:u,right:h,bottom:void 0===f?1/0:f};return{vertical:al(p,e,!0),horizontal:al(p,n,!1)}}function ol(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,o=r.clientWidth,a=r.clientLeft,s=r.clientTop,l=n.snapOffset,u=l.left,c=l.top,h=l.right,f=l.bottom,p=e||t.props.bounds||{},d="css"===(p.position||"client"),m=p.left,g=void 0===m?-1/0:m,v=p.top,y=void 0===v?-1/0:v,_=p.right,x=void 0===_?d?-1/0:1/0:_,b=p.bottom,w=void 0===b?d?-1/0:1/0:b;return d&&(x=o+h-u-x,w=i+f-c-w),{left:g+u-a,right:x+u-a,top:y+c-s,bottom:w+c-s}}function al(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],o=Math.min.apply(Math,e),a=Math.max.apply(Math,e),s=[];return r+1>o&&s.push({isBound:!0,offset:o-r,pos:r}),i-1<a&&s.push({isBound:!0,offset:a-i,pos:i}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort((function(t,e){return Math.abs(e.offset)-Math.abs(t.offset)}))}function sl(t,e,n){return(n?t.map((function(t){return fi(t,n)})):t).some((function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>.1||t[0]>e.right&&Math.abs(t[0]-e.right)>.1||t[1]<e.top&&Math.abs(t[1]-e.top)>.1||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>.1}))}function ll(t,e,n,r,i){if(!t.props.bounds)return[];var o=i*Math.PI/180,a=ol(t),s=a.left,l=a.top,u=a.right,c=a.bottom,h=s-r[0],f=u-r[0],p=l-r[1],d=c-r[1],m={left:h,top:p,right:f,bottom:d};if(!sl(n,m,0))return[];var g=[];return[[h,0],[f,0],[p,1],[d,1]].forEach((function(t){var r=t[0],i=t[1];n.forEach((function(t){var n=Or([0,0],t);g.push.apply(g,function(t,e,n){var r=ja(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort((function(e,r){return Math.abs(e-t[n?0:1])-Math.abs(r-t[n?0:1])})).map((function(t){return Or([0,0],n?[t,e]:[e,t])}))}(t,r,i).map((function(t){return o+t-n})).filter((function(t){return!sl(e,m,t)})).map((function(t){return jr(180*t/Math.PI,Oo)})))}))})),g}function ul(t,e){return function(t,e){var n,r=t.direction,i=t.classNames,o=t.size,a=t.pos,s=t.zoom,l=t.key,u="horizontal"===r,c=u?"Y":"X";return e.createElement("div",{key:l,className:i.join(" "),style:(n={},n[u?"width":"height"]="".concat(o),n.transform="translate(".concat(a[0],", ").concat(a[1],") translate").concat(c,"(-50%) scale").concat(c,"(").concat(s,")"),n)})}(ko(ko({},t),{classNames:Co([xa("line","guideline",t.direction)],t.classNames,!0).filter((function(t){return t})),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map((function(t){return"".concat(jr(t,.1),"px")}))}),e)}function cl(t,e,n,r,i,o,a,s){var l=t.props.zoom;return n.map((function(t,n){var u=t.type,c=t.pos,h=[0,0];return h[a]=r,h[a?0:1]=-i+c,ul({key:"".concat(e,"TargetGuideline").concat(n),classNames:[xa("target","bold",u)],posValue:h,sizeValue:o,zoom:l,direction:e},s)}))}function hl(t,e,n,r,i,o){var a=t.props,s=a.zoom,l=a.isDisplayInnerSnapDigit,u="horizontal"===e?Ns:zs,c=i[u.start],h=i[u.end];return n.filter((function(t){var e=t.hide,n=t.elementRect;if(e)return!1;if(l&&n){var r=n.rect;if(r[u.start]<=c&&h<=r[u.end])return!1}return!0})).map((function(t,n){var i=t.pos,a=t.size,l=t.element,u=t.className,c=[-r[0]+i[0],-r[1]+i[1]];return ul({key:"".concat(e,"-default-guideline-").concat(n),classNames:l?[xa("bold"),u]:[xa("normal"),u],direction:e,posValue:c,sizeValue:a,zoom:s},o)}))}function fl(t,e,n,r,i,o,a,s){var l,u=t.props,c=u.snapDigit,h=void 0===c?0:c,f=u.isDisplaySnapDigit,p=void 0===f||f,d=u.snapDistFormat,m=void 0===d?function(t,e){return t}:d,g=u.zoom,v="horizontal"===e?"X":"Y",y="vertical"===e?"height":"width",_=Math.abs(i),x=p?parseFloat(_.toFixed(h)):0;return s.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:xa("guideline-group",e),style:(l={left:"".concat(o[0],"px"),top:"".concat(o[1],"px")},l[y]="".concat(_,"px"),l)},ul({direction:e,classNames:[xa(n),a],size:"100%",posValue:[0,0],sizeValue:_,zoom:g},s),s.createElement("div",{className:xa("size-value","gap"),style:{transform:"translate".concat(v,"(-50%) scale(").concat(g,")")}},x>0?m(x,e):""))}function pl(t,e,n,r,i){var o=t.props.isDisplayInnerSnapDigit,a=[];return["vertical","horizontal"].forEach((function(s){var l=e.filter((function(t){return t.type===s})),u="vertical"===s?1:0,c=u?0:1,h=function(t,e,n,r){var i="vertical"===t?0:1,o="vertical"===t?1:0,a=i?Ns:zs,s=n[a.start],l=n[a.end];return cs(e,(function(t){return t.pos[i]})).map((function(e){var n=[],u=[];return e.forEach((function(e){var c,h,f=e.element,p=e.elementRect.rect;if(p[a.end]<s)n.push(e);else if(l<p[a.start])u.push(e);else if(p[a.start]<=s&&l<=p[a.end]&&r){var d=e.pos,m={element:f,rect:ko(ko({},p),(c={},c[a.end]=p[a.start],c))},g={element:f,rect:ko(ko({},p),(h={},h[a.start]=p[a.end],h))},v=[0,0],y=[0,0];v[i]=d[i],v[o]=d[o],y[i]=d[i],y[o]=d[o]+e.size,n.push({type:t,pos:v,size:0,elementRect:m}),u.push({type:t,pos:y,size:0,elementRect:g})}})),n.sort((function(t,e){return e.pos[o]-t.pos[o]})),u.sort((function(t,e){return t.pos[o]-e.pos[o]})),{total:e,start:n,end:u,inner:[]}}))}(s,l,r,o),f=u?zs:Ns,p=u?Ns:zs,d=r[f.start],m=r[f.end];h.forEach((function(e){var o=e.total,l=e.start,h=e.end,g=e.inner,v=n[c]+o[0].pos[c]-r[p.start],y=r;l.forEach((function(e){var r=e.elementRect.rect,o=y[f.start]-r[f.end];if(o>0){var l=[0,0];l[u]=n[u]+y[f.start]-d-o,l[c]=v,a.push(fl(t,s,"dashed",a.length,o,l,e.className,i))}y=r})),y=r,h.forEach((function(e){var r=e.elementRect.rect,o=r[f.start]-y[f.end];if(o>0){var l=[0,0];l[u]=n[u]+y[f.end]-d,l[c]=v,a.push(fl(t,s,"dashed",a.length,o,l,e.className,i))}y=r})),g.forEach((function(e){var r=e.elementRect.rect,o=d-r[f.start],l=r[f.end]-m,h=[0,0],p=[0,0];h[u]=n[u]-o,h[c]=v,p[u]=n[u]+m-d,p[c]=v,a.push(fl(t,s,"dashed",a.length,o,h,e.className,i)),a.push(fl(t,s,"dashed",a.length,l,p,e.className,i))}))}))})),a}function dl(t,e,n,r,i){var o=function(t,e,n,r){var i=e[0]-t[0],o=e[1]-t[1];if(Math.abs(i)<hr&&(i=0),Math.abs(o)<hr&&(o=0),!i)return r?[0,0]:[0,n];if(!o)return r?[n,0]:[0,0];var a=o/i,s=t[1]-a*t[0];return r?[n,a*(e[0]+n)+s-e[1]]:[(e[1]+n-s)/a-e[0],n]}(t,e,n,r);if(!o)return{isOutside:!1,offset:[0,0]};var a=Br(t,e),s=Br(o,t),l=Br(o,e),u=s>a||l>a,c=na({datas:i,distX:o[0],distY:o[1]});return{offset:[c[0],c[1]],isOutside:u}}function ml(t,e){return t.isBound?t.offset:e.isSnap?Zs(e).offset:0}function gl(t,e,n,r,i,o){if(!Os(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var a=Ja(o.absolutePoses,[e,n]),s=Oa(a),l=s.left,u=s.right,c=s.top,h=s.bottom,f={horizontal:a.map((function(t){return t[1]})),vertical:a.map((function(t){return t[0]}))},p=vl(t,i,Bs(Fs(t.props.snapDirections),{left:l,right:u,top:c,bottom:h,center:(l+u)/2,middle:(c+h)/2}),f),d=p.vertical,m=p.horizontal,g=tl(t,a,o),v=g.vertical,y=g.horizontal,_=d.isSnap,x=m.isSnap,b=d.isBound||v.isBound,w=m.isBound||y.isBound,S=function(t,e,n,r,i){var o=e[0],a=e[1],s=n[0],l=n[1],u=r[0],c=r[1],h=i[0],f=i[1],p=-h,d=-f;if(t&&o&&a){p=0,d=0;var m=[];if(s&&l?m.push([0,f],[h,0]):s?m.push([h,0]):l?m.push([0,f]):u&&c?m.push([0,f],[h,0]):u?m.push([h,0]):c&&m.push([0,f]),m.length){m.sort((function(t,e){return ja(ii([o,a],t))-ja(ii([o,a],e))}));var g=m[0];if(g[0]&&Math.abs(o)>hr)p=-g[0],d=a*Math.abs(o+p)/Math.abs(o)-a;else if(g[1]&&Math.abs(a)>hr){var v=a;d=-g[1],p=o*Math.abs(a+d)/Math.abs(v)-o}if(t&&l&&s)if(Math.abs(p)>hr&&Math.abs(p)<Math.abs(h))p*=y=Math.abs(h)/Math.abs(p),d*=y;else if(Math.abs(d)>hr&&Math.abs(d)<Math.abs(f)){var y;p*=y=Math.abs(f)/Math.abs(d),d*=y}else p=fs(-h,p),d=fs(-f,d)}}else p=o||s?-h:0,d=a||l?-f:0;return[p,d]}(r,[e,n],[b,w],[_,x],[fs(d.offset,v.offset),fs(m.offset,y.offset)]);return[{isBound:b,isSnap:_,offset:S[0]},{isBound:w,isSnap:x,offset:S[1]}]}function vl(t,e,n,r){void 0===r&&(r=n);var i=il(ol(t),r.vertical,r.horizontal),o=i.horizontal,a=i.vertical,s=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:js(t,n.vertical,n.horizontal),l=s.horizontal,u=s.vertical,c=ml(o[0],l),h=ml(a[0],u),f=Math.abs(c),p=Math.abs(h);return{horizontal:{isBound:o[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:c,dist:f,bounds:o,snap:l},vertical:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:p,bounds:a,snap:u}}}function yl(t,e,n,r,i){var o=il(e,n,r),a=o.horizontal,s=o.vertical,l=Us(t,n,r,i),u=l.horizontal,c=l.vertical,h=ml(a[0],u),f=ml(s[0],c),p=Math.abs(h),d=Math.abs(f);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:p,bounds:a,snap:u},vertical:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:d,bounds:s,snap:c}}}function _l(t,e,n,r,i,o){return n.map((function(n){var a=n[0],s=n[1],l=ia(e,a),u=ia(e,s),c=r?function(t,e,n,r){var i=function(t,e,n){var r=ol(t),i=r.left,o=r.top,a=r.right,s=r.bottom,l=n[0],u=n[1],c=ii(n,e),h=c[0],f=c[1];Math.abs(h)<Oo&&(h=0),Math.abs(f)<Oo&&(f=0);var p=f>0,d=h>0,m={isBound:!1,offset:0,pos:0},g={isBound:!1,offset:0,pos:0};if(0===h&&0===f)return{vertical:m,horizontal:g};if(0===h)p?s<u&&(g.pos=s,g.offset=u-s):o>u&&(g.pos=o,g.offset=u-o);else if(0===f)d?a<l&&(m.pos=a,m.offset=l-a):i>l&&(m.pos=i,m.offset=l-i);else{var v=f/h,y=n[1]-v*l,_=0,x=0,b=!1;d&&a<=l?(_=v*a+y,x=a,b=!0):!d&&l<=i&&(_=v*i+y,x=i,b=!0),b&&(_<o||_>s)&&(b=!1),b||(p&&s<=u?(x=((_=s)-y)/v,b=!0):!p&&u<=o&&(x=((_=o)-y)/v,b=!0)),b&&(m.isBound=!0,m.pos=x,m.offset=l-x,g.isBound=!0,g.pos=_,g.offset=u-_)}return{vertical:m,horizontal:g}}(t,e,n),o=i.horizontal,a=i.vertical,s=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(t,e,n){var r=n[0],i=n[1],o=e[0],a=e[1],s=ii(n,e),l=s[0],u=s[1],c=u>0,h=l>0;l=vs(l),u=vs(u);var f={isSnap:!1,offset:0,pos:0},p={isSnap:!1,offset:0,pos:0};if(0===l&&0===u)return{vertical:f,horizontal:p};var d=js(t,l?[r]:[],u?[i]:[]),m=d.vertical,g=d.horizontal;m.posInfos.filter((function(t){var e=t.pos;return h?e>=o:e<=o})),g.posInfos.filter((function(t){var e=t.pos;return c?e>=a:e<=a})),m.isSnap=m.posInfos.length>0,g.isSnap=g.posInfos.length>0;var v=Zs(m),y=v.isSnap,_=v.guideline,x=Zs(g),b=x.isSnap,w=x.guideline,S=b?w.pos[1]:0,E=y?_.pos[0]:0;if(0===l)b&&(p.isSnap=!0,p.pos=w.pos[1],p.offset=i-p.pos);else if(0===u)y&&(f.isSnap=!0,f.pos=E,f.offset=r-E);else{var k=u/l,C=n[1]-k*r,I=0,T=0,P=!1;y?(I=k*(T=E)+C,P=!0):b&&(T=((I=S)-C)/k,P=!0),P&&(f.isSnap=!0,f.pos=T,f.offset=r-T,p.isSnap=!0,p.pos=I,p.offset=i-I)}return{vertical:f,horizontal:p}}(t,e,n),l=s.horizontal,u=s.vertical,c=xl(o,l),h=xl(a,u),f=Math.abs(c),p=Math.abs(h);return{horizontal:{isBound:o.isBound,isSnap:l.isSnap,offset:c,dist:f},vertical:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:p}}}(t,l,u,i):vl(t,i,{vertical:[u[0]],horizontal:[u[1]]}),h=c.horizontal,f=h.offset,p=h.isBound,d=h.isSnap,m=c.vertical,g=m.offset,v=m.isBound,y=m.isSnap,_=ii(s,a);if(!g&&!f)return{isBound:v||p,isSnap:y||d,sign:_,offset:[0,0]};var x=function(t,e,n,r){var i=Or(t,e)/Math.PI*180,o=n.vertical,a=o.isBound,s=o.isSnap,l=o.dist,u=n.horizontal,c=u.isBound,h=u.isSnap,f=i%180,p=f<3||f>177,d=f>87&&f<93;return u.dist<l&&(a||s&&!d&&(!r||!p))?"vertical":!c&&(!h||p||r&&d)?"":"horizontal"}(l,u,c,r);if(!x)return{sign:_,isBound:!1,isSnap:!1,offset:[0,0]};var b="vertical"===x,w=[0,0];return w=(w=r||1!==Math.abs(s[0])||1!==Math.abs(s[1])||a[0]===s[0]||a[1]===s[1]?dl(l,u,-(b?g:f),b,o).offset:na({datas:o,distX:-g,distY:-f})).map((function(t,e){return t*(_[e]?2/_[e]:0)})),{sign:_,isBound:b?v:p,isSnap:b?y:d,offset:w}}))}function xl(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function bl(t){var e=t.state,n=e.containerClientRect,r=e.hasFixed,i=n.overflow,o=n.scrollHeight,a=n.scrollWidth,s=n.clientHeight,l=n.clientWidth,u=n.clientLeft,c=n.clientTop,h=t.props,f=h.snapGap,p=void 0===f||f,d=h.verticalGuidelines,m=h.horizontalGuidelines,g=h.snapThreshold,v=void 0===g?5:g,y=h.snapGridWidth,_=void 0===y?0:y,x=h.snapGridHeight,b=void 0===x?0:x,w=h.maxSnapElementGuidelineDistance,S=void 0===w?1/0:w,E=Oa(Qa(t.state)),k=E.top,C=E.left,I=E.bottom,T=E.right,P={top:k,left:C,bottom:I,right:T,center:(C+T)/2,middle:(k+I)/2},A=function(t){var e=t.state,n=t.props.elementGuidelines,r=void 0===n?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter((function(t){return!t.refresh})),o=r.map((function(t){return mr(t)&&"element"in t?ko(ko({},t),{element:bs(t.element,!0)}):{element:bs(t,!0)}})).filter((function(t){return t.element})),a=(c=i.map((function(t){return t.element})),h=o.map((function(t){return t.element})),Ti(c,h,Li)),s=a.maintained,l=a.added,u=[];var c,h;s.forEach((function(t){var e=t[0],n=t[1];u[n]=i[e]})),function(t,e){if(!e.length)return[];var n=t.state,r=n.containerClientRect,i=n.targetClientRect,o=i.top,a=i.left,s=n.rootMatrix,l=n.is3d?4:3,u=function(t,e,n){var r=Na(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}(s,r,l),c=u[0],h=u[1],f=Bi(Qa(n)),p=f.minX,d=f.minY,m=ii([p,d],ps(s,[a-c,o-h],l)).map((function(t){return e=t,Math.round(e%1===-.5?e-1:e);var e})),g=m[0],v=m[1];return e.map((function(t){var e=t.element.getBoundingClientRect(),n=e.left-c,r=e.top-h,i=r+e.height,o=n+e.width,a=ps(s,[n,r],l),u=a[0],f=a[1],p=ps(s,[o,i],l),d=p[0],m=p[1];return ko(ko({},t),{rect:{left:u+g,right:d+g,top:f+v,bottom:m+v,center:(u+d)/2+g,middle:(f+m)/2+v}})}))}(t,l.map((function(t){return o[t]}))).map((function(t,e){u[l[e]]=t})),e.elementRects=u;var f=Fs(t.props.elementSnapDirections),p=[];return u.forEach((function(t){var e=t.element,n=t.top,r=void 0===n?f.top:n,i=t.left,o=void 0===i?f.left:i,a=t.right,s=void 0===a?f.right:a,l=t.bottom,u=void 0===l?f.bottom:l,c=t.center,h=void 0===c?f.center:c,d=t.middle,m=void 0===d?f.middle:d,g=t.className,v=t.rect,y=Bs({top:r,right:s,left:o,bottom:u,center:h,middle:m},v),_=y.horizontal,x=y.vertical,b=v.top,w=v.left,S=v.right-w,E=v.bottom-b,k=[S,E];x.forEach((function(n){p.push({type:"vertical",element:e,pos:[jr(n,.1),b],size:E,sizes:k,className:g,elementRect:t})})),_.forEach((function(n){p.push({type:"horizontal",element:e,pos:[w,jr(n,.1)],size:S,sizes:k,className:g,elementRect:t})}))})),p}(t),M=Co([],A,!0);p&&M.push.apply(M,function(t,e,n){var r=t.props,i=r.maxSnapElementGuidelineDistance,o=void 0===i?1/0:i,a=r.maxSnapElementGapDistance,s=void 0===a?1/0:a,l=t.state.elementRects,u=[];return[["vertical",Ns,zs],["horizontal",zs,Ns]].forEach((function(t){var r=t[0],i=t[1],a=t[2],c=e[i.start],h=e[i.end],f=e[i.center],p=e[a.start],d=e[a.end];function m(t){var e=t.rect;return e[i.end]<c+n?c-e[i.end]:h-n<e[i.start]?e[i.start]-h:-1}var g=l.filter((function(t){var e=t.rect;return!(e[a.start]>d||e[a.end]<p)&&m(t)>0})).sort((function(t,e){return m(t)-m(e)})),v=[];g.forEach((function(t){g.forEach((function(e){if(t!==e){var n=t.rect,r=e.rect,i=n[a.start],o=n[a.end],s=r[a.start];i>r[a.end]||s>o||v.push([t,e])}}))})),v.forEach((function(t){var a=t[0],l=t[1],p=a.rect,d=l.rect,m=p[i.start],g=p[i.end],v=d[i.start],y=d[i.end],_=0,x=0,b=!1,w=!1,S=!1;if(g<=c&&h<=v){if(w=!0,x=g+(_=(v-g-(h-c))/2)+(h-c)/2,Math.abs(x-f)>n)return}else if(g<v&&y<c+n){if(b=!0,x=y+(_=v-g),Math.abs(x-c)>n)return}else{if(!(g<v&&h-n<m))return;if(S=!0,x=m-(_=v-g),Math.abs(x-h)>n)return}_&&wl(e,d,r,o)&&(_>s||u.push({type:r,pos:"vertical"===r?[x,0]:[0,x],element:l.element,size:0,className:l.className,isStart:b,isCenter:w,isEnd:S,gap:_,hide:!0,gapRects:[a,l]}))}))})),u}(t,P,v)),M.push.apply(M,function(t,e,n,r,i,o){void 0===i&&(i=0);void 0===o&&(o=0);var a=[];if(e)for(var s=0;s<=r;s+=e)a.push({type:"horizontal",pos:[0,jr(s-o,.1)],size:n,hide:!0});if(t)for(s=0;s<=n;s+=t)a.push({type:"vertical",pos:[jr(s-i,.1),0],size:r,hide:!0});return a}(_,b,i?a:l,i?o:s,u,c));var L=ko({},e.snapOffset||{left:0,top:0,bottom:0,right:0});if(r){var R=n.left,D=n.top;L.left+=R,L.top+=D,L.right+=R,L.bottom+=D}return M.push.apply(M,Sl(m||!1,d||!1,i?a:l,i?o:s,u,c,L)),M=M.filter((function(t){var e=t.element,n=t.elementRect,r=t.type;if(!e||!n)return!0;var i=n.rect;return wl(P,i,r,S)})),M}function wl(t,e,n,r){return"horizontal"===n?Math.abs(t.right-e.left)<=r||Math.abs(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:"vertical"!==n||(Math.abs(t.bottom-e.top)<=r||Math.abs(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom)}function Sl(t,e,n,r,i,o,a){void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a={left:0,top:0,right:0,bottom:0});var s=[],l=a.left,u=a.top,c=a.bottom,h=n+a.right-l,f=r+c-u;return t&&t.forEach((function(t){var e=mr(t)?t:{pos:t};s.push({type:"horizontal",pos:[l,jr(e.pos-o+u,.1)],size:h,className:e.className})})),e&&e.forEach((function(t){var e=mr(t)?t:{pos:t};s.push({type:"vertical",pos:[jr(e.pos-i+l,.1),u],size:f,className:e.className})})),s}function El(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,o={left:0,top:0,bottom:0,right:0};if(n!==r){var a=bs(r,!0);if(a){var s=Ya(a),l=Ss(e,[s.left-i.left,s.top-i.top]),u=Ss(e,[s.right-i.right,s.bottom-i.bottom]);o.left=jr(l[0],1e-5),o.top=jr(l[1],1e-5),o.right=jr(u[0],1e-5),o.bottom=jr(u[1],1e-5)}}return e.snapContainer=r,e.snapOffset=o,e.guidelines=bl(t),e.enableSnap=!0,!0}function kl(t,e,n,r,i,o){var a=za(t,e,n,o?4:3);return Ja(a,ii(i,ia(a,r)))}function Cl(t,e,n,r,i,o){var a=function(t,e,n){var r=[];if(n)1!==Math.abs(e[0])||1!==Math.abs(e[1])?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach((function(t){[1,-1].forEach((function(n){var o=[t*i[0],n*i[1]];e[0]===o[0]&&e[1]===o[1]||r.push([e,o])}))}))}else t[0]?(1===Math.abs(e[0])?[1]:[1,-1]).forEach((function(n){r.push([[e[0],-1],[n*t[0],-1]],[[e[0],0],[n*t[0],0]],[[e[0],1],[n*t[0],1]])})):t[1]&&(1===Math.abs(e[1])?[1]:[1,-1]).forEach((function(n){r.push([[-1,e[1]],[-1,n*t[1]]],[[0,e[1]],[0,n*t[1]]],[[1,e[1]],[1,n*t[1]]])}));return r}(n,o.fixedDirection,r),s=el(t,e,n,r),l=Co(Co([],_l(t,e,a,r,i,o),!0),Qs(t,s,o),!0),u=Xs(l,0),c=Xs(l,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:c.isBound,offset:c.offset[1]}}}function Il(t,e,n,r,i,o,a,s){for(var l=Qa(t.state),u=t.props.keepRatio,c=0,h=0,f=0;f<2;++f){var p=Cl(t,e(c,h),i,u,a,s),d=p.width,m=p.height,g=d.isBound,v=m.isBound,y=d.offset,_=m.offset;if(1===f&&(g||(y=0),v||(_=0)),0===f&&a&&!g&&!v)return[0,0];if(u){var x=Math.abs(y)*(n?1/n:1),b=Math.abs(_)*(r?1/r:1);(g&&v?x<b:v||!g&&x<b)?y=n*_/r:_=r*y/n}c+=y,h+=_}if(i[0]&&i[1]){var w=function(t,e,n,r,i){var o=[-n[0],-n[1]],a=t.state,s=a.width,l=a.height,u=t.props.bounds,c=1/0,h=1/0;if(u){var f=[[n[0],-n[1]],[-n[0],n[1]]],p=u.left,d=void 0===p?-1/0:p,m=u.top,g=void 0===m?-1/0:m,v=u.right,y=void 0===v?1/0:v,_=u.bottom,x=void 0===_?1/0:_;f.forEach((function(t){var n=t[0]!==o[0],a=t[1]!==o[1],u=ia(e,t),f=360*Or(r,u)/Math.PI;if(a){var p=u.slice();(Math.abs(f-360)<2||Math.abs(f-180)<2)&&(p[1]=r[1]);var m=dl(r,p,(r[1]<u[1]?x:g)-u[1],!1,i),v=m.offset[1],_=m.isOutside;isNaN(v)||(h=l+(_?1:-1)*Math.abs(v))}if(n){p=u.slice(),(Math.abs(f-90)<2||Math.abs(f-270)<2)&&(p[0]=r[0]);var b=dl(r,p,(r[0]<u[0]?y:d)-u[0],!0,i),w=b.offset[0],S=b.isOutside;isNaN(w)||(c=s+(S?1:-1)*Math.abs(w))}}))}return{maxWidth:c,maxHeight:h}}(t,l,i,o,s),S=w.maxWidth,E=w.maxHeight,k=function(t,e,n,r,i,o,a,s,l){var u=ia(e,a),c=vl(t,s,{vertical:[u[0]],horizontal:[u[1]]}),h=c.horizontal.offset,f=c.vertical.offset;if(jr(f,zo)||jr(h,zo)){var p=na({datas:l,distX:-f,distY:-h}),d=p[0],m=p[1];return[Math.min(i||1/0,n+a[0]*d)-n,Math.min(o||1/0,r+a[1]*m)-r]}return[0,0]}(t,e(c,h).map((function(t){return t.map((function(t){return jr(t,zo)}))})),n+c,r+h,S,E,i,a,s);c+=y=k[0],h+=_=k[1]}return[c,h]}function Tl(t,e,n,r,i){if(!Os(t,"scalable"))return[0,0];var o=i.startOffsetWidth,a=i.startOffsetHeight,s=i.fixedPosition,l=i.fixedDirection,u=i.is3d,c=Il(t,(function(t,n){return kl(function(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d?4:3;return oa(r,ni(t.targetMatrix,vi(e,i),i),n,i)}(i,ri(e,[t/o,n/a])),o,a,l,s,u)}),o,a,n,s,r,i);return[c[0]/o,c[1]/a]}function Pl(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){var n=t.guideline;e.indexOf(n)>-1||e.push(n)}))})),e}function Al(t,e,n,r,i,o){var a=il(ol(t,o),e,n),s=a.vertical,l=a.horizontal;s.forEach((function(t){t.isBound&&r.push({type:"bounds",pos:t.pos})})),l.forEach((function(t){t.isBound&&i.push({type:"bounds",pos:t.pos})}));var u=function(t){var e=t.props.innerBounds;if(!e)return{vertical:[],horizontal:[]};var n=t.getRect(),r=[n.pos1,n.pos2,n.pos3,n.pos4],i=ia(r,[0,0]),o=e.left,a=e.top,s=e.width,l=e.height,u=[[o,a],[o,a+l]],c=[[o,a],[o+s,a]],h=[[o+s,a],[o+s,a+l]],f=[[o,a+l],[o+s,a+l]],p=el(t,r,[0,0],!1),d=[],m=[],g={top:!1,bottom:!1,left:!1,right:!1};return p.forEach((function(t){var e=t.line,n=t.lineConstants,r=Hs(i,e),p=r.horizontal,v=r.vertical,y=Js(e,n,c,v,1,!0),_=Js(e,n,f,v,1,!0),x=Js(e,n,u,p,1,!0),b=Js(e,n,h,p,1,!0);y.isBound&&!g.top&&(d.push(a),g.top=!0),_.isBound&&!g.bottom&&(d.push(a+l),g.bottom=!0),x.isBound&&!g.left&&(m.push(o),g.left=!0),b.isBound&&!g.right&&(m.push(o+s),g.right=!0)})),{horizontal:d,vertical:m}}(t),c=u.vertical,h=u.horizontal;c.forEach((function(t){Tr(r,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||r.push({type:"bounds",pos:t})})),h.forEach((function(t){Tr(i,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||i.push({type:"bounds",pos:t})}))}var Ml=_s("",["resizable","scalable"]),Ll={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,snapRenderThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,maxSnapElementGuidelineDistance:Number,maxSnapElementGapDistance:Number},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}\n.guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.guideline-group .size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.guideline-group.horizontal .size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.guideline-group.vertical .size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.guideline.gap {\n    background: #f55;\n}\n.size-value.gap {\n    color: #f55;\n}\n"],render:function(t,e){var n=t.state,r=n.top,i=n.left,o=n.pos1,a=n.pos2,s=n.pos3,l=n.pos4,u=n.snapRenderInfo,c=t.props.snapRenderThreshold,h=void 0===c?1:c;if(!u||!u.render||!Os(t,""))return[];n.guidelines=bl(t);var f=Math.min(o[0],a[0],s[0],l[0]),p=Math.min(o[1],a[1],s[1],l[1]),d=u.externalPoses||[],m=Qa(t.state),g=[],v=[],y=[],_=[],x=[],b=Oa(m),w=b.width,S=b.height,E=b.top,k=b.left,C=b.bottom,I=b.right,T={left:k,right:I,top:E,bottom:C,center:(k+I)/2,middle:(E+C)/2},P=d.length>0,A=P?Oa(d):{};if(!u.request){if(u.direction&&x.push(Gs(t,m,u.direction,h)),u.snap){var M=Oa(m);u.center&&(M.middle=(M.top+M.bottom)/2,M.center=(M.left+M.right)/2),x.push(Vs(t,M,h))}P&&(u.center&&(A.middle=(A.top+A.bottom)/2,A.center=(A.left+A.right)/2),x.push(Vs(t,A,h))),x.forEach((function(t){var e=t.vertical.posInfos,n=t.horizontal.posInfos;g.push.apply(g,e.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),v.push.apply(v,n.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),y.push.apply(y,Pl(e)),_.push.apply(_,Pl(n))}))}Al(t,[k,I],[E,C],g,v),P&&Al(t,[A.left,A.right],[A.top,A.bottom],g,v,u.externalBounds);var L=Co(Co([],y,!0),_,!0),R=L.filter((function(t){return t.element&&!t.gapRects})),D=L.filter((function(t){return t.gapRects})).sort((function(t,e){return t.gap-e.gap}));return as(t,"onSnap",{guidelines:L.filter((function(t){return!t.element})),elements:R,gaps:D},!0),Co(Co(Co(Co(Co(Co([],pl(t,R,[f,p],T,e),!0),function(t,e,n,r,i){var o=[];return["horizontal","vertical"].forEach((function(a){var s=e.filter((function(t){return t.type===a})).slice(0,1),l="vertical"===a?0:1,u=l?0:1,c=l?zs:Ns,h=l?Ns:zs,f=r[c.start],p=r[c.end],d=r[h.start],m=r[h.end];s.forEach((function(e){var r=e.gap,a=e.gapRects,s=Math.max.apply(Math,Co([d],a.map((function(t){return t.rect[h.start]})),!1)),g=Math.min.apply(Math,Co([m],a.map((function(t){return t.rect[h.end]})),!1)),v=(s+g)/2;s!==g&&v!==(d+m)/2&&a.forEach((function(e){var a=e.rect,s=e.className,h=[n[0],n[1]];if(a[c.end]<f)h[l]+=a[c.end]-f;else{if(!(p<a[c.start]))return;h[l]+=a[c.start]-f-r}h[u]+=v-d,o.push(fl(t,l?"vertical":"horizontal","gap",o.length,r,h,s,i))}))}))})),o}(t,D,[f,p],T,e),!0),hl(t,"horizontal",_,[i,r],T,e),!0),hl(t,"vertical",y,[i,r],T,e),!0),cl(t,"horizontal",v,f,r,w,0,e),!0),cl(t,"vertical",g,p,i,S,1,e),!0)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},El(t)},drag:function(t){var e=t.state;El(t)||(e.guidelines=bl(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!Ml(t,e)&&!Xl(t,e))||(!e.isRequest&&e.inputEvent?Vr(e.inputEvent.target,xa("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,El(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,El(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function Rl(t,e,n,r){var i=t.getState(),o=i.renderPoses,a=i.rotation,s=i.direction,l=qa(t.props,e).zoom,u=s>0?1:-1,c=a/Math.PI*180,h={},f=t.renderState;f.renderDirectionMap||(f.renderDirectionMap={});var p=f.renderDirectionMap;return n.forEach((function(t){var e=t.dir;h[e]=!0})),n.map((function(t){var n=t.data,i=t.classNames,s=t.dir,f=qo[s];if(!f||!h[s])return null;p[s]=!0;var d=(jr(c,15)+u*Go[s]+720)%180,m={};return Lr(n).forEach((function(t){m["data-".concat(t)]=n[t]})),r.createElement("div",ko({className:xa.apply(void 0,Co(["control","direction",s,e],i,!1)),"data-rotation":d,"data-direction":s},m,{key:"direction-".concat(s),style:Za.apply(void 0,Co([a,l],f.map((function(t){return o[t]})),!1))}))}))}function Dl(t,e,n,r){var i=qa(t.props,n).renderDirections,o=void 0===i?e:i;return o?Rl(t,n,(!0===o?Vo:o).map((function(t){return{data:{},classNames:[],dir:t}})),r):[]}function Nl(t,e,n,r,i,o){for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];var l=Or(n,r),u=e?jr(l/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(o),className:xa.apply(void 0,Co(["line","direction",e?"edge":"",e],a,!1)),"data-rotation":u,"data-line-key":o,"data-direction":e,style:Va(n,r,i,l)})}function zl(t,e,n,r,i){return(!0===n?Uo:n).map((function(n,o){var a=qo[n],s=a[0],l=a[1];if(null!=l)return Nl(t,n,r[s],r[l],i,"".concat(e,"Edge").concat(o),e)})).filter(Boolean)}function Ol(t){return function(e,n){var r=qa(e.props,t).edge;return r&&(!0===r||r.length)?Co(Co([],zl(n,t,r,e.getState().renderPoses,e.props.zoom),!0),function(t,e,n){return Dl(t,["nw","ne","sw","se"],e,n)}(e,t,n),!0):Fl(e,t,n)}}function Fl(t,e,n){return Dl(t,Vo,e,n)}var Bl={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},requestStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.throttleDragRotate,i=n.zoom,o=t.getState(),a=o.dragInfo,s=o.beforeOrigin;if(!r||!a)return[];var l=a.dist;if(!l[0]&&!l[1])return[];var u=ja(l),c=Or(l,[0,0]);return[e.createElement("div",{className:xa("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(s[0],"px, ").concat(s[1],"px) rotate(").concat(c,"rad) scaleY(").concat(i,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,o=t.state,a=o.gestos,s=o.style;if(a.draggable)return!1;a.draggable=i||t.targetGesto,n.datas={},n.left=parseFloat(s.left||"")||0,n.top=parseFloat(s.top||"")||0,n.bottom=parseFloat(s.bottom||"")||0,n.right=parseFloat(s.right||"")||0,n.startValue=[0,0],$o(t,e),sa(e,"translate"),function(t,e){e.absolutePoses=Qa(t.state)}(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var l=rs(t,e,ko({set:function(t){n.startValue=t}},aa(e)));return!1!==(r||as(t,"onDragStart",l))?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(a.draggable=null,n.isPinch=!1),!!n.isDrag&&l},drag:function(t,e){if(e){Ko(e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,o=e.isPinch,a=e.isRequest,s=e.deltaOffset,l=e.distX,u=e.distY,c=n.isDrag,h=n.prevDist,f=n.prevBeforeDist,p=n.startValue;if(c){s&&(l+=s[0],u+=s[1]);var d=t.props,m=d.parentMoveable,g=r?0:d.throttleDrag||0,v=r?0:d.throttleDragRotate||0,y=0,_=!1,x=!1,b=!1,w=!1;if(!r&&v>0&&(l||u)){var S=d.startDragRotate||0,E=jr(S+180*Or([0,0],[l,u])/Math.PI,v)-S,k=u*Math.abs(Math.cos((E-90)/180*Math.PI)),C=ja([l*Math.abs(Math.cos(E/180*Math.PI)),k]);y=E*Math.PI/180,l=C*Math.cos(y),u=C*Math.sin(y)}if(!o&&!r&&!i){var I=gl(t,l,u,v,a||s,n),T=I[0],P=I[1];_=T.isSnap,x=T.isBound,b=P.isSnap,w=P.isBound,l+=T.offset,u+=P.offset}var A=ri(ea({datas:n,distX:l,distY:u}),p),M=ri(Qo({datas:n,distX:l,distY:u}),p);Ur(M,Oo),Ur(A,Oo),v||(_||x||(M[0]=jr(M[0],g),A[0]=jr(A[0],g)),b||w||(M[1]=jr(M[1],g),A[1]=jr(A[1],g)));var L=ii(A,p),R=ii(M,p),D=ii(R,h),N=ii(L,f);n.prevDist=R,n.prevBeforeDist=L,n.passDelta=D,n.passDist=R;var z=n.left+L[0],O=n.top+L[1],F=n.right-L[0],B=n.bottom-L[1],j=Jo(n,"translate(".concat(M[0],"px, ").concat(M[1],"px)"),"translate(".concat(R[0],"px, ").concat(R[1],"px)"));if(ua(e,j),t.state.dragInfo.dist=r?[0,0]:R,r||m||!D.every((function(t){return!t}))||!N.some((function(t){return!t}))){var U=t.state,V=U.width,Z=U.height,q=rs(t,e,ko({transform:j,dist:R,delta:D,translate:M,beforeDist:L,beforeDelta:N,beforeTranslate:A,left:z,top:O,right:F,bottom:B,width:V,height:Z,isPinch:o},es({transform:j},e)));return!r&&as(t,"onDrag",q),q}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return!(!r[0]&&!r[1])&&(n.deltaOffset=[0,0],this.drag(t,ko(ko({},e),{deltaOffset:r})))},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,r.isDrag){r.isDrag=!1;var i=is(t,e,{});return!n&&as(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var a=Ms(t,this,"dragStart",[r||0,i||0],e,!1,"draggable"),s=as(t,"onDragGroupStart",ko(ko({},o),{targets:t.props.targets,events:a}));return n.isDrag=!1!==s,!!n.isDrag&&o},dragGroup:function(t,e){if(e.datas.isDrag){var n=this.drag(t,e),r=Ms(t,this,"drag",e.datas.passDelta,e,!1,"draggable");if(n){var i=ko({targets:t.props.targets,events:r},n);return as(t,"onDragGroup",i),i}}},dragGroupEnd:function(t,e){var n=e.isDrag;if(e.datas.isDrag){this.dragEnd(t,e);var r=Ms(t,this,"dragEnd",[0,0],e,!1,"draggable");return as(t,"onDragGroupEnd",is(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY),{datas:e,distX:r,distY:i}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}},jl=_s("resizable"),Ul={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function,keepRatioFinally:Boolean,edge:Boolean,checkResizableError:Boolean},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:Ol("resizable"),dragControlCondition:jl,viewClassName:ys("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,o=e.isGroup,a=e.parentDirection,s=e.parentGesto,l=e.datas,u=e.parentFixedDirection,c=e.parentEvent,h=$a(a,i,r,l),f=t.state,p=f.target,d=f.width,m=f.height,g=f.gestos;if(!h||!p)return!1;if(g.resizable)return!1;g.resizable=s||t.controlGesto,!i&&$o(t,e),l.datas={},l.direction=h,l.startOffsetWidth=d,l.startOffsetHeight=m,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=f.inlineCSSWidth||f.cssWidth,l.startHeight=f.inlineCSSHeight||f.cssHeight,l.maxSize=[1/0,1/0],o||(l.minSize=[f.minOffsetWidth,f.minOffsetHeight],l.maxSize=[f.maxOffsetWidth,f.maxOffsetHeight]);var v=t.props.transformOrigin||"% %";function y(t){l.ratio=t&&isFinite(t)?t:0}function _(t){l.fixedDirection=t,l.fixedPosition=ia(l.startPositions,t)}function x(e){var n=t.state,r=n.width,i=n.height;l.fixedPosition=e,l.fixedDirection=ga(e,r,i)}function b(t){l.minSize=[Rr("".concat(t[0]),0)||0,Rr("".concat(t[1]),0)||0]}function w(t){var e=[t[0]||1/0,t[1]||1/0];yr(e[0])&&!isFinite(e[0])||(e[0]=Rr("".concat(e[0]),0)||1/0),yr(e[1])&&!isFinite(e[1])||(e[1]=Rr("".concat(e[1]),0)||1/0),l.maxSize=e}l.transformOrigin=v&&vr(v)?v.split(" "):v,l.startOffsetMatrix=f.offsetMatrix,l.startTransformOrigin=f.transformOrigin,l.isWidth=null!==(n=null===e||void 0===e?void 0:e.parentIsWidth)&&void 0!==n?n:!h[0]&&!h[1]||h[0]||!h[1],l.startPositions=Qa(t.state),y(d/m),_(u||[-h[0],-h[1]]),l.setFixedDirection=_,l.setFixedPosition=x,l.setMin=b,l.setMax=w;var S=rs(t,e,{direction:h,startRatio:l.ratio,set:function(t){var e=t[0],n=t[1];l.startWidth=e,l.startHeight=n},setMin:b,setMax:w,setRatio:y,setFixedDirection:_,setFixedPosition:x,setOrigin:function(t){l.transformOrigin=t},dragStart:Bl.dragStart(t,(new Ho).dragStart([0,0],e))}),E=c||as(t,"onResizeStart",S);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,!1!==E&&(l.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:h}),!!l.isResize&&S},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,o=e.isPinch,a=e.parentKeepRatio,s=e.dragClient,l=e.parentDist,u=e.isRequest,c=e.isGroup,h=e.parentEvent,f=e.resolveMatrix,p=r.isResize,d=r.transformOrigin,m=r.startWidth,g=r.startHeight,v=r.prevWidth,y=r.prevHeight,_=r.minSize,x=r.maxSize,b=r.ratio,w=r.startOffsetWidth,S=r.startOffsetHeight,E=r.isWidth;if(p){if(f){var k=t.state.is3d,C=r.startOffsetMatrix,I=r.startTransformOrigin,T=k?4:3,P=xi(ha(e)),A=Math.sqrt(P.length);T!==A&&(P=ti(P,A,T));var M=oa(C,P,I,T),L=za(M,w,S,T);r.startPositions=L,r.nextTargetMatrix=P,r.nextAllMatrix=M}var R=qa(t.props,"resizable"),D=R.resizeFormat,N=R.throttleResize,z=void 0===N?i?0:1:N,O=R.parentMoveable,F=R.keepRatioFinally,B=r.direction,j=B,U=0,V=0;B[0]||B[1]||(j=[1,1]);var Z=b&&(null!=a?a:R.keepRatio)||!1,q=rt(),G=q[0],W=q[1];h||(r.setFixedDirection(r.fixedDirection),as(t,"onBeforeResize",rs(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(t){var e;return r.setFixedDirection(t),e=rt(),G=e[0],W=e[1],[G,W]},setFixedPosition:function(t){var e;return r.setFixedPosition(t),e=rt(),G=e[0],W=e[1],[G,W]},boundingWidth:G,boundingHeight:W,setSize:function(t){G=t[0],W=t[1]}},!0)));var X=s;s||(X=!i&&o?_a(t,[0,0]):r.fixedPosition);var H=[0,0];if(o||(H=function(t,e,n,r,i,o,a){if(!Os(t,"resizable"))return[0,0];var s=a.fixedDirection,l=a.nextAllMatrix,u=t.state,c=u.allMatrix,h=u.is3d;return Il(t,(function(t,r){return kl(l||c,e+t,n+r,s,i,h)}),e,n,r,i,o,a)}(t,G,W,B,X,u,r)),l&&(!l[0]&&(H[0]=0),!l[1]&&(H[1]=0)),Z){j[0]&&j[1]&&H[0]&&H[1]&&(Math.abs(H[0])>Math.abs(H[1])?H[1]=0:H[0]=0);var Y=!H[0]&&!H[1];Y&&it(),j[0]&&!j[1]||H[0]&&!H[1]||Y&&E?(G+=H[0],W=G/b):(!j[0]&&j[1]||!H[0]&&H[1]||Y&&!E)&&(W+=H[1],G=W*b)}else G+=H[0],W+=H[1],G=Math.max(0,G),W=Math.max(0,W);n=function(t,e,n,r){if(!r)return t.map((function(t,r){return Dr(t,e[r],n[r])}));var i=t[0],o=t[1],a=!0===r?i/o:r,s=Nr(t,e,!1,a),l=s[0],u=s[1],c=Nr(t,n,!0,a),h=c[0],f=c[1];return i<l||o<u?(i=l,o=u):(i>h||o>f)&&(i=h,o=f),[i,o]}([G,W],_,x,!!Z&&b),G=n[0],W=n[1],it(),Z&&(c||F)&&(E?W=G/b:G=W*b);var $=[(U=G-w)-v,(V=W-S)-y];r.prevWidth=U,r.prevHeight=V;var K=ya(t,G,W,X,d,r);if(O||!$.every((function(t){return!t}))||!K.every((function(t){return!t}))){var J=Bl.drag(t,Xo(e,t.state,K,!!o,!1,"draggable")),Q=J.transform,tt=m+U,et=g+V,nt=rs(t,e,ko({width:tt,height:et,offsetWidth:Math.round(G),offsetHeight:Math.round(W),startRatio:b,boundingWidth:G,boundingHeight:W,direction:B,dist:[U,V],delta:$,isPinch:!!o,drag:J},ns({style:{width:"".concat(tt,"px"),height:"".concat(et,"px")},transform:Q},J,e)));return!h&&as(t,"onResize",nt),nt}}function rt(){var t=r.fixedDirection,n=ks(j,Z,r,e);U=n.distWidth,V=n.distHeight;var i=j[0]-t[0]||Z?Math.max(w+U,Oo):w,o=j[1]-t[1]||Z?Math.max(S+V,Oo):S;return Z&&w&&S&&(E?o=i/b:i=o*b),[i,o]}function it(){var t;D&&(t=D([G,W]),G=t[0],W=t[1]),G=jr(G,z),W=jr(W,z)}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,o=n.startOffsetHeight,a=n.prevWidth,s=n.prevHeight;if(r&&!1!==t.props.checkResizableError){var l=t.state,u=l.width-(i+a),c=l.height-(o+s),h=Math.abs(u)>3,f=Math.abs(c)>3;return h&&(n.startWidth+=u,n.startOffsetWidth+=u,n.prevWidth+=u),f&&(n.startHeight+=c,n.startOffsetHeight+=c,n.prevHeight+=c),h||f?this.dragControl(t,e):void 0}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var i=is(t,e,{});return!r&&as(t,"onResizeEnd",i),i}},dragGroupControlCondition:jl,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,ko(ko({},e),{isGroup:!0}));if(!r)return!1;var i=As(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,a=ia(r.datas.startPositions||Qa(e.state),i),s=si(mi(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),l=s[0],u=s[1];return r.datas.originalX=l,r.datas.originalY=u,r}var a=n.startOffsetWidth,s=n.startOffsetHeight;function l(){var t=n.minSize;i.forEach((function(e){var n=e.datas,r=n.minSize,i=n.startOffsetWidth,o=n.startOffsetHeight,l=a*(i?r[0]/i:0),u=s*(o?r[1]/o:0);t[0]=Math.max(t[0],l),t[1]=Math.max(t[1],u)}))}function u(){var t=n.maxSize;i.forEach((function(e){var n=e.datas,r=n.maxSize,i=n.startOffsetWidth,o=n.startOffsetHeight,l=a*(i?r[0]/i:0),u=s*(o?r[1]/o:0);t[0]=Math.min(t[0],l),t[1]=Math.min(t[1],u)}))}var c=Ls(t,this,"dragControlStart",e,(function(t,e){return o(t,e)}));l(),u();var h=function(t){r.setFixedDirection(t),c.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))};n.setFixedDirection=h;var f=ko(ko({},r),{targets:t.props.targets,events:c.map((function(t){return ko(ko({},t),{setMin:function(e){t.setMin(e),l()},setMax:function(e){t.setMax(e),u()}})})),setFixedDirection:h,setMin:function(t){r.setMin(t),l()},setMax:function(t){r.setMax(t),u()}}),p=as(t,"onResizeGroupStart",f);return n.isResize=!1!==p,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=qa(t.props,"resizable");os(t,"onBeforeResize",(function(n){as(t,"onBeforeResizeGroup",rs(t,e,ko(ko({},n),{targets:r.targets}),!0))}));var i=this.dragControl(t,ko(ko({},e),{isGroup:!0}));if(i){var o=i.boundingWidth,a=i.boundingHeight,s=i.dist,l=r.keepRatio,u=[o/(o-s[0]),a/(a-s[1])],c=n.fixedPosition,h=Ls(t,this,"dragControl",e,(function(e,n){var r=si(mi(t.rotation/180*Math.PI,3),[n.datas.originalX*u[0],n.datas.originalY*u[1],1],3),i=r[0],o=r[1];return ko(ko({},n),{parentDist:null,parentScale:u,dragClient:ri(c,[i,o]),parentKeepRatio:l})})),f=ko({targets:r.targets,events:h},i);return as(t,"onResizeGroup",f),f}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isResize){this.dragControlEnd(t,e);var r=Ls(t,this,"dragControlEnd",e);return as(t,"onResizeGroupEnd",is(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=0,r=0,i=t.getRect();return{isControl:!0,requestStart:function(t){var n;return{datas:e,parentDirection:t.direction||[1,1],parentIsWidth:null===(n=null===t||void 0===t?void 0:t.horizontal)||void 0===n||n}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:t.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.gestos.resizable=null}};function Vl(t,e,n,r,i){var o=t.props.groupable,a=t.state,s=a.is3d?4:3,l=e.origin,u=Na(t.state.rootMatrix,ii([l[0],l[1]],o?[0,0]:[a.left,a.top]),s),c=ri([i.left,i.top],u);e.startAbsoluteOrigin=c,e.prevDeg=Or(c,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Br(c,[n,r])}function Zl(t,e,n){var r=n.defaultDeg,i=n.prevDeg,o=i%360,a=Math.floor(i/360);o<0&&(o+=360),o>t&&o>270&&t<90?++a:o<t&&o<90&&t>270&&--a;var s=e*(360*a+t-r);return n.prevDeg=r+s,s}function ql(t,e,n,r){return Zl(Or(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function Gl(t,e,n,r,i,o){var a=t.props.throttleRotate,s=void 0===a?0:a,l=n.prevSnapDeg,u=0,c=!1;if(o){var h=function(t,e,n){if(!Os(t,"rotatable"))return{isSnap:!1,rotation:n};var r=e.pos1,i=e.pos2,o=e.pos3,a=e.pos4,s=e.origin,l=n*Math.PI/180,u=[r,i,o,a].map((function(t){return ii(t,s)})),c=u.map((function(t){return fi(t,l)})),h=Co(Co([],ll(t,u,c,s,n),!0),rl(t,u,c,s,n),!0);h.sort((function(t,e){return Math.abs(t-n)-Math.abs(e-n)}));var f=h.length>0;return{isSnap:f,rotation:f?h[0]:n}}(t,e,r);c=h.isSnap,u=i+h.rotation}c||(u=jr(i+r,s));var f=u-i;return n.prevSnapDeg=f,[f-l,f,u]}function Wl(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];if("none"===t)return[];if(gr(t))return t.map((function(t){return Wl(t,[r,i,o,a],n)[0]}));var s=(t||"top").split("-"),l=s[0],u=s[1],c=[r,i];"left"===l?c=[o,r]:"right"===l?c=[i,a]:"bottom"===l&&(c=[a,o]);var h=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],f=Wa(c,n);if(u){var p="top"===u||"left"===u,d="bottom"===l||"left"===l;h=c[p&&!d||!p&&d?0:1]}return[[h,f]]}function Xl(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var n=e.inputEvent.target;if(Vr(n,xa("rotation-control"))||Vr(n,xa("around-control"))||Vr(n,xa("control"))&&Vr(n,xa("rotatable")))return!0;var r=t.props.rotationTarget;return!!r&&ws(r,!0).some((function(t){return!!t&&(n===t||n.contains(t))}))}var Hl=Vo.map((function(t){var e="",n="",r="center",i="center";return t.indexOf("n")>-1&&(e="top: -20px;",i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(n="left: -20px;",r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,'"] {\n        ').concat(n).concat(e,"\n        transform-origin: ").concat(r," ").concat(i,";\n    }")})).join("\n"),Yl=".rotation {\n    position: absolute;\n    height: 40px;\n    width: 1px;\n    transform-origin: 50% 100%;\n    height: calc(40px * var(--zoom));\n    top: auto;\n    left: 0;\n    bottom: 100%;\n    will-change: transform;\n}\n.rotation .rotation-line {\n    display: block;\n    width: 100%;\n    height: 100%;\n    transform-origin: 50% 50%;\n}\n.rotation .rotation-control {\n    border-color: #4af;\n    border-color: var(--moveable-color);\n    background:#fff;\n    cursor: alias;\n}\n:global .view-rotation-dragging, .rotatable.direction.control {\n    cursor: alias;\n}\n.around-control {\n    position: absolute;\n    will-change: transform;\n    width: 20px;\n    height: 20px;\n    left: -10px;\n    top: -10px;\n    box-sizing: border-box;\n    background: transparent;\n    z-index: 8;\n    cursor: alias;\n    transform-origin: center center;\n}\n.rotatable.direction.control.move {\n    cursor: move;\n}\n".concat(Hl,"\n"),$l={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object,rotateAroundControls:Boolean,edge:Boolean,resolveAblesWithRotatable:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[Yl],viewClassName:function(t){return t.isDragging("rotatable")?xa("view-rotation-dragging"):""},render:function(t,e){var n=qa(t.props,"rotatable"),r=n.rotatable,i=n.rotationPosition,o=n.zoom,a=n.renderDirections,s=n.rotateAroundControls,l=n.resolveAblesWithRotatable,u=t.getState(),c=u.renderPoses,h=u.direction;if(!r)return null;var f=Wl(i,c,h),p=[];if(f.forEach((function(t,n){var r=t[0],i=t[1];p.push(e.createElement("div",{key:"rotation".concat(n),className:xa("rotation"),style:{transform:"translate(-50%) translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(i,"rad)")}},e.createElement("div",{className:xa("line rotation-line"),style:{transform:"scaleX(".concat(o,")")}}),e.createElement("div",{className:xa("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(o,")")}})))})),a){var d=Lr(l||{}),m={};d.forEach((function(t){l[t].forEach((function(e){m[e]=t}))}));var g=[];gr(a)&&(g=a.map((function(t){var e=m[t];return{data:e?{resolve:e}:{},classNames:e?["move"]:[],dir:t}}))),p.push.apply(p,Rl(t,"rotatable",g,e))}return s&&p.push.apply(p,function(t,e){var n=t.renderState;n.renderDirectionMap||(n.renderDirectionMap={});var r=t.getState(),i=r.renderPoses,o=r.rotation,a=r.direction,s=n.renderDirectionMap,l=t.props.zoom,u=a>0?1:-1,c=o/Math.PI*180;return Lr(s).map((function(t){var n=qo[t];if(!n)return null;var r=(jr(c,15)+u*Go[t]+720)%180;return e.createElement("div",{className:xa("around-control"),"data-rotation":r,"data-direction":t,key:"direction-around-".concat(t),style:Za.apply(void 0,Co([o,l],n.map((function(t){return i[t]})),!1))})}))}(t,e)),p},dragControlCondition:Xl,dragControlStart:function(t,e){var n,r,i=e.datas,o=e.clientX,a=e.clientY,s=e.parentRotate,l=e.parentFlag,u=e.isPinch,c=e.isRequest,h=t.state,f=h.target,p=h.left,d=h.top,m=h.direction,g=h.beforeDirection,v=h.targetTransform,y=h.moveableClientRect,_=h.offsetMatrix,x=h.targetMatrix,b=h.allMatrix,w=h.width,S=h.height;if(!c&&!f)return!1;var E=t.getRect();i.rect=E,i.transform=v,i.left=p,i.top=d;var k=function(e){var n=t.state,r=n.allMatrix,o=n.is3d,a=ga(e,n.width,n.height);i.fixedDirection=a,i.fixedPosition=Na(r,e,o?4:3),O&&O.setFixedPosition(e)},C=function(e){i.fixedDirection=e,i.fixedPosition=va(t,e),O&&O.setFixedDirection(e)},I=o,T=a;if(c||u||l){var P=s||0;i.beforeInfo={origin:E.beforeOrigin,prevDeg:P,defaultDeg:P,prevSnapDeg:0,startDist:0},i.afterInfo=ko(ko({},i.beforeInfo),{origin:E.origin}),i.absoluteInfo=ko(ko({},i.beforeInfo),{origin:E.origin,startValue:P})}else{var A=null===(r=e.inputEvent)||void 0===r?void 0:r.target;if(A){var M=A.getAttribute("data-direction")||"",L=Zo[M];if(L){i.isControl=!0,i.isAroundControl=Vr(A,xa("around-control")),i.controlDirection=L;var R=A.getAttribute("data-resolve");R&&(i.resolveAble=R);var D=function(t,e,n){var r=16===t.length?4:3,i=e.map((function(e){return Na(t,e,r)})),o=n.left,a=n.top;return i.map((function(t){return[t[0]+o,t[1]+a]}))}(h.rootMatrix,h.renderPoses,y);n=ia(D,L),I=n[0],T=n[1]}}i.beforeInfo={origin:E.beforeOrigin},i.afterInfo={origin:E.origin},i.absoluteInfo={origin:E.origin,startValue:E.rotation};var N=k;k=function(e){var n=h.is3d?4:3,r=ri(Jr(x,n),e),o=r[0],a=r[1],s=si(_,Qr([o,a],n)),l=si(b,Qr([e[0],e[1]],n));N(e);var u=h.posDelta;i.beforeInfo.origin=ii(s,u),i.afterInfo.origin=ii(l,u),i.absoluteInfo.origin=ii(l,u),Vl(t,i.beforeInfo,I,T,y),Vl(t,i.afterInfo,I,T,y),Vl(t,i.absoluteInfo,I,T,y)},C=function(t){var e=ia([[0,0],[w,0],[0,S],[w,S]],t);k(e)}}i.startClientX=I,i.startClientY=T,i.direction=m,i.beforeDirection=g,i.startValue=0,i.datas={},sa(e,"rotate");var z=!1,O=!1;i.isControl&&i.resolveAble&&("resizable"===i.resolveAble&&(O=Ul.dragControlStart(t,ko(ko({},new Ho("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition}))));O||(z=Bl.dragStart(t,(new Ho).dragStart([0,0],e))),k(h.transformOrigin);var F=rs(t,e,ko(ko({set:function(t){i.startValue=t*Math.PI/180},setFixedDirection:C,setFixedPosition:k},aa(e)),{dragStart:z,resizeStart:O})),B=as(t,"onRotateStart",F);return i.isRotate=!1!==B,h.snapRenderInfo={request:e.isRequest},!!i.isRotate&&F},dragControl:function(t,e){var n,r,i,o=e.datas,a=e.clientDistX,s=e.clientDistY,l=e.parentRotate,u=e.parentFlag,c=e.isPinch,h=e.groupDelta,f=o.beforeDirection,p=o.beforeInfo,d=o.afterInfo,m=o.absoluteInfo,g=o.isRotate,v=o.startValue,y=o.rect,_=o.startClientX,x=o.startClientY;if(g){Ko(e,"rotate");var b,w,S,E,k,C,I,T,P,A=function(t){return Ba(t.datas.beforeTransform,[50,50],100,100).direction}(e),M=f*A,L=t.props.parentMoveable,R=180/Math.PI*v,D=m.startValue,N=!1,z=_+a,O=x+s;if(!u&&"parentDist"in e){var F=e.parentDist;w=F,k=F,T=F}else c||u?(w=Zl(l,f,p),k=Zl(l,M,d),T=Zl(l,M,m)):(w=ql(z,O,f,p),k=ql(z,O,M,d),T=ql(z,O,M,m),N=!0);if(as(t,"onBeforeRotate",rs(t,e,{beforeRotation:S=R+w,rotation:C=R+k,absoluteRotation:P=D+T,setRotation:function(t){w=k=t-R,T=k}},!0)),b=(n=Gl(t,y,p,w,R,N))[0],w=n[1],S=n[2],E=(r=Gl(t,y,d,k,R,N))[0],k=r[1],C=r[2],I=(i=Gl(t,y,m,T,D,N))[0],T=i[1],P=i[2],I||E||b||L){var B=Jo(o,"rotate(".concat(C,"deg)"),"rotate(".concat(k,"deg)")),j=function(t,e,n){var r=n.fixedDirection,i=n.fixedPosition;return ma(t,"rotate(".concat(e,"deg)"),r,i,n)}(t,k,o),U=ii(ri(h||[0,0],j),o.prevInverseDist||[0,0]);o.prevInverseDist=j,o.requestValue=null;var V=da(t,B,U,c,e),Z=V,q=Br([z,O],m.startAbsoluteOrigin)-m.startDist,G=void 0;if("resizable"===o.resolveAble){var W=Ul.dragControl(t,ko(ko({},Xo(e,t.state,[e.deltaX,e.deltaY],!!c,!1,"resizable")),{resolveMatrix:!0,parentDistance:q}));W&&(G=W,Z=ns(Z,W,e))}var X=rs(t,e,ko(ko({delta:E,dist:k,rotate:C,rotation:C,beforeDist:w,beforeDelta:b,beforeRotate:S,beforeRotation:S,absoluteDist:T,absoluteDelta:I,absoluteRotate:P,absoluteRotation:P,isPinch:!!c,resize:G},V),Z));return as(t,"onRotate",X),X}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=is(t,e,{});return as(t,"onRotateEnd",r),r}},dragGroupControlCondition:Xl,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,o=r.top,a=r.beforeOrigin,s=this.dragControlStart(t,e);if(!s)return!1;s.set(n.beforeDirection*t.rotation);var l=Ls(t,this,"dragControlStart",e,(function(t,e){var n=t.state,r=n.left,s=n.top,l=n.beforeOrigin,u=ri(ii([r,s],[i,o]),ii(l,a));return e.datas.startGroupClient=u,e.datas.groupClient=u,ko(ko({},e),{parentRotate:0})})),u=as(t,"onRotateGroupStart",ko(ko({},s),{targets:t.props.targets,events:l}));return n.isRotate=!1!==u,!!n.isRotate&&s},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){os(t,"onBeforeRotate",(function(n){as(t,"onBeforeRotateGroup",rs(t,e,ko(ko({},n),{targets:t.props.targets}),!0))}));var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,o=r.beforeDist,a=o/180*Math.PI,s=Ls(t,this,"dragControl",e,(function(t,e){var n=e.datas.startGroupClient,r=e.datas.groupClient,s=r[0],l=r[1],u=fi(n,a*i),c=u[0],h=u[1],f=[c-s,h-l];return e.datas.groupClient=[c,h],ko(ko({},e),{parentRotate:o,groupDelta:f})}));t.rotation=i*r.beforeRotation;var l=ko({targets:t.props.targets,events:s,set:function(e){t.rotation=e},setGroupRotation:function(e){t.rotation=e}},r);return as(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isRotate){this.dragControlEnd(t,e);var r=Ls(t,this,"dragControlEnd",e);return as(t,"onRotateGroupEnd",is(t,e,{targets:t.props.targets,events:r})),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Kl=_s("scalable"),Jl={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean,edge:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:Ol("scalable"),dragControlCondition:Kl,viewClassName:ys("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=$a(e.parentDirection,r,i,n),a=t.state,s=a.width,l=a.height,u=a.targetTransform,c=a.target,h=a.pos1,f=a.pos2,p=a.pos4;if(!o||!c)return!1;r||$o(t,e),n.datas={},n.transform=u,n.prevDist=[1,1],n.direction=o,n.startOffsetWidth=s,n.startOffsetHeight=l,n.startValue=[1,1];var d=Br(h,f),m=Br(f,p),g=!o[0]&&!o[1]||o[0]||!o[1];function v(t){n.ratio=t&&isFinite(t)?t:0}function y(t){n.fixedDirection=t,n.fixedPosition=ia(n.startPositions,t)}n.scaleWidth=d,n.scaleHeight=m,n.scaleXRatio=d/s,n.scaleYRatio=m/l,sa(e,"scale"),n.isWidth=g,n.startPositions=Qa(t.state),n.setFixedDirection=y,v(Br(h,f)/Br(f,p)),y([-o[0],-o[1]]);var _=rs(t,e,ko(ko({direction:o,set:function(t){n.startValue=t},setRatio:v,setFixedDirection:y},aa(e)),{dragStart:Bl.dragStart(t,(new Ho).dragStart([0,0],e))})),x=as(t,"onScaleStart",_);return n.startFixedDirection=n.fixedDirection,!1!==x&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),!!n.isScale&&_},dragControl:function(t,e){Ko(e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,o=e.isPinch,a=e.dragClient,s=e.isRequest,l=n.prevDist,u=n.direction,c=n.startOffsetWidth,h=n.startOffsetHeight,f=n.isScale,p=n.startValue,d=n.isWidth,m=n.ratio;if(!f)return!1;var g=t.props,v=g.throttleScale,y=g.parentMoveable,_=u;u[0]||u[1]||(_=[1,1]);var x=m&&(null!=r?r:g.keepRatio)||!1,b=t.state;function w(){var t=ks(_,x,n,e),r=t.distWidth,i=t.distHeight,o=c?(c+r)/c:1,a=h?(h+i)/h:1;return o=_[0]||x?o*p[0]:p[0],a=_[1]||x?a*p[1]:p[1],0===o&&(o=(l[0]>0?1:-1)*Fo),0===a&&(a=(l[1]>0?1:-1)*Fo),[o,a]}var S=w();if(!o&&t.props.groupable){var E=(b.snapRenderInfo||{}).direction;gr(E)&&(E[0]||E[1])&&(b.snapRenderInfo={direction:u,request:e.isRequest})}as(t,"onBeforeScale",rs(t,e,{scale:S,setFixedDirection:function(t){return n.setFixedDirection(t),S=w()},startFixedDirection:n.startFixedDirection,setScale:function(t){S=t}},!0));var k=[S[0]/p[0],S[1]/p[1]],C=a,I=[0,0];if(a||(C=!i&&o?_a(t,[0,0]):n.fixedPosition),o||(I=Tl(t,k,u,s,n)),x){_[0]&&_[1]&&I[0]&&I[1]&&(Math.abs(I[0]*c)>Math.abs(I[1]*h)?I[1]=0:I[0]=0);var T=!I[0]&&!I[1];if(T&&(d?k[0]=jr(k[0]*p[0],v)/p[0]:k[1]=jr(k[1]*p[1],v)/p[1]),_[0]&&!_[1]||I[0]&&!I[1]||T&&d){k[0]+=I[0];var P=c*k[0]*p[0]/m;k[1]=P/h/p[1]}else if(!_[0]&&_[1]||!I[0]&&I[1]||T&&!d){k[1]+=I[1];var A=h*k[1]*p[1]*m;k[0]=A/c/p[0]}}else k[0]+=I[0],k[1]+=I[1],I[0]||(k[0]=jr(k[0]*p[0],v)/p[0]),I[1]||(k[1]=jr(k[1]*p[1],v)/p[1]);0===k[0]&&(k[0]=(l[0]>0?1:-1)*Fo),0===k[1]&&(k[1]=(l[1]>0?1:-1)*Fo);var M,L,R=[k[0]/l[0],k[1]/l[1]];L=p,S=[(M=k)[0]*L[0],M[1]*L[1]];var D=function(t,e,n,r,i){return ma(t,"scale(".concat(e.join(", "),")"),n,r,i)}(t,k,n.fixedDirection,C,n),N=ii(D,n.prevInverseDist||[0,0]);if(n.prevDist=k,n.prevInverseDist=D,S[0]===l[0]&&S[1]===l[1]&&N.every((function(t){return!t}))&&!y)return!1;var z=Jo(n,"scale(".concat(S.join(", "),")"),"scale(".concat(k.join(", "),")")),O=rs(t,e,ko({offsetWidth:c,offsetHeight:h,direction:u,scale:S,dist:k,delta:R,isPinch:!!o},da(t,z,N,o,e)));return as(t,"onScale",O),O},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=is(t,e,{});return as(t,"onScaleEnd",r),r},dragGroupControlCondition:Kl,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=As(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,a=ia(r.datas.startPositions||Qa(e.state),i),s=si(mi(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),l=s[0],u=s[1];return r.datas.originalX=l,r.datas.originalY=u,r}n.moveableScale=t.scale;var a=Ls(t,this,"dragControlStart",e,(function(t,e){return o(t,e)})),s=function(t){r.setFixedDirection(t),a.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))};n.setFixedDirection=s;var l=ko(ko({},r),{targets:t.props.targets,events:a,setFixedDirection:s}),u=as(t,"onScaleGroupStart",l);return n.isScale=!1!==u,!!n.isScale&&l},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){os(t,"onBeforeScale",(function(n){as(t,"onBeforeScaleGroup",rs(t,e,ko(ko({},n),{targets:t.props.targets}),!0))}));var r=this.dragControl(t,e);if(r){var i=n.moveableScale;t.scale=[r.scale[0]*i[0],r.scale[1]*i[1]];var o=t.props.keepRatio,a=r.dist,s=r.scale,l=n.fixedPosition,u=Ls(t,this,"dragControl",e,(function(e,n){var r=si(mi(t.rotation/180*Math.PI,3),[n.datas.originalX*a[0],n.datas.originalY*a[1],1],3),i=r[0],u=r[1];return ko(ko({},n),{parentDist:null,parentScale:s,parentKeepRatio:o,dragClient:ri(l,[i,u])})})),c=ko({targets:t.props.targets,events:u},r);return as(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,e){var n=e.isDrag;if(e.datas.isScale){this.dragControlEnd(t,e);var r=Ls(t,this,"dragControlEnd",e);return as(t,"onScaleGroupEnd",is(t,e,{targets:t.props.targets,events:r})),n}},request:function(){var t={},e=0,n=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,n+=r.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:r.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function Ql(t,e){return t.map((function(t,n){return pr(t,e[n],1,2)}))}function tu(t,e,n){var r=Or(t,e),i=Or(t,n)-r;return i>=0?i:i+2*Math.PI}var eu={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array,edge:Boolean},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},viewClassName:ys("warpable"),render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,o=n.warpable,a=n.zoom;if(r||i||!o)return[];var s=t.state,l=s.pos1,u=s.pos2,c=s.pos3,h=s.pos4,f=Ql(l,u),p=Ql(u,l),d=Ql(l,c),m=Ql(c,l),g=Ql(c,h),v=Ql(h,c),y=Ql(u,h),_=Ql(h,u);return Co([e.createElement("div",{className:xa("line"),key:"middeLine1",style:Va(f,g,a)}),e.createElement("div",{className:xa("line"),key:"middeLine2",style:Va(p,v,a)}),e.createElement("div",{className:xa("line"),key:"middeLine3",style:Va(d,y,a)}),e.createElement("div",{className:xa("line"),key:"middeLine4",style:Va(m,_,a)})],Fl(t,"warpable",e),!0)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return Vr(n,xa("direction"))&&Vr(n,xa("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,o=Ka(r.target,n);if(!o||!i)return!1;var a=t.state,s=a.transformOrigin,l=a.is3d,u=a.targetTransform,c=a.targetMatrix,h=a.width,f=a.height,p=a.left,d=a.top;return n.datas={},n.targetTransform=u,n.warpTargetMatrix=l?c:ti(c,3,4),n.targetInverseMatrix=$r(Kr(n.warpTargetMatrix,4),3,4),n.direction=o,n.left=p,n.top=d,n.poses=[[0,0],[h,0],[0,f],[h,f]].map((function(t){return ii(t,s)})),n.nextPoses=n.poses.map((function(t){var e=t[0],r=t[1];return si(n.warpTargetMatrix,[e,r,0,1],4)})),n.startValue=gi(4),n.prevMatrix=gi(4),n.absolutePoses=Qa(a),n.posIndexes=ra(o),$o(t,e),sa(e,"matrix3d"),a.snapRenderInfo={request:e.isRequest,direction:o},!1!==as(t,"onWarpStart",rs(t,e,ko({set:function(t){n.startValue=t}},aa(e))))&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,o=e.distY,a=n.targetInverseMatrix,s=n.prevMatrix,l=n.isWarp,u=n.startValue,c=n.poses,h=n.posIndexes,f=n.absolutePoses;if(!l)return!1;if(Ko(e,"matrix3d"),Os(t,"warpable")){var p=h.map((function(t){return f[t]}));p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var d=vl(t,r,{horizontal:p.map((function(t){return t[1]+o})),vertical:p.map((function(t){return t[0]+i}))}),m=d.horizontal,g=d.vertical;o-=m.offset,i-=g.offset}var v=na({datas:n,distX:i,distY:o},!0),y=n.nextPoses.slice();if(h.forEach((function(t){y[t]=ri(y[t],v)})),!No.every((function(t){return function(t,e){var n=tu(t[0],t[1],t[2]),r=tu(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}(t.map((function(t){return c[t]})),t.map((function(t){return y[t]})))})))return!1;var _=_i(c[0],c[2],c[1],c[3],y[0],y[2],y[1],y[3]);if(!_.length)return!1;var x=ta(n,ni(a,_,4),!0),b=ni(Kr(s,4),x,4);n.prevMatrix=x;var w=ni(u,x,4),S=Jo(n,"matrix3d(".concat(w.join(", "),")"),"matrix3d(".concat(x.join(", "),")"));return ua(e,S),as(t,"onWarp",rs(t,e,ko({delta:b,matrix:w,dist:x,multiply:ni,transform:S},es({transform:S},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,as(t,"onWarpEnd",is(t,e,{})),r)}},nu=xa("area-pieces"),ru=xa("area-piece"),iu=xa("avoid"),ou=xa("view-dragging");function au(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;qr(e,iu),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function su(t){return t.createElement("div",{key:"area_pieces",className:nu},t.createElement("div",{className:ru}),t.createElement("div",{className:ru}),t.createElement("div",{className:ru}),t.createElement("div",{className:ru}))}var lu={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,o=n.groupable,a=n.passDragArea,s=t.getState(),l=s.width,u=s.height,c=s.renderPoses,h=a?xa("area","pass"):xa("area");if(o)return[e.createElement("div",{key:"area",ref:ar(t,"areaElement"),className:h}),su(e)];if(!r||!i)return[];var f=_i([0,0],[l,0],[0,u],[l,u],c[0],c[1],c[2],c[3]),p=f.length?La(f,!0):"none";return[e.createElement("div",{key:"area",ref:ar(t,"areaElement"),className:h,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:p}}),su(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY;if(!e.inputEvent)return!1;n.isDragArea=!1;var o=t.areaElement,a=t.state,s=a.moveableClientRect,l=a.renderPoses,u=a.rootMatrix,c=a.is3d,h=s.left,f=s.top,p=Oa(l),d=p.left,m=p.top,g=p.width,v=p.height,y=ps(u,[r-h,i-f],c?4:3),_=y[0],x=y[1],b=[{left:d,top:m,width:g,height:(x-=m)-10},{left:d,top:m,width:(_-=d)-10,height:v},{left:d,top:m+x+10,width:g,height:v-x-10},{left:d+_+10,top:m,width:g-_-10,height:v}],w=[].slice.call(o.nextElementSibling.children);b.forEach((function(t,e){w[e].style.cssText="left: ".concat(t.left,"px;top: ").concat(t.top,"px; width: ").concat(t.width,"px; height: ").concat(t.height,"px;")})),Zr(o,iu),a.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,au(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||au(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){au(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&Ar((function(){e.disableNativeEvent=!1}))}},uu=Io("origin",{render:function(t,e){var n=t.props.zoom,r=t.getState(),i=r.beforeOrigin,o=r.rotation;return[e.createElement("div",{className:xa("control","origin"),style:Za(o,n,i),key:"beforeOrigin"})]}});function cu(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var hu={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,scrollThrottleTime:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(t,e){var n=t.props.scrollContainer,r=void 0===n?t.getContainer():n,i=new no,o=bs(r,!0);e.datas.dragScroll=i;var a=e.isControl?"controlGesto":"targetGesto",s=e.targets;i.on("scroll",(function(n){var r=n.container,i=n.direction,o=rs(t,e,{scrollContainer:r,direction:i}),a=s?"onScrollGroup":"onScroll";s&&(o.targets=s),as(t,a,o)})).on("move",(function(e){var n=e.offsetX,r=e.offsetY,i=e.inputEvent;t[a].scrollBy(n,r,i.inputEvent,!1)})),i.dragStart(e,{container:o})},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,o=void 0===i?t.getContainer():i,a=r.scrollThreshold,s=void 0===a?0:a,l=r.scrollThrottleTime,u=void 0===l?0:l,c=r.getScrollPosition,h=void 0===c?cu:c;return n.drag(e,{container:o,threshold:s,throttleTime:u,getScrollPosition:function(t){return h({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,ko(ko({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,ko(ko({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,ko(ko({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,ko(ko({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,ko(ko({},e),{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,ko(ko({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,ko(ko({},e),{targets:t.props.targets}))}},fu={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Object,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object,flushSync:Function,stopPropagation:Boolean,preventClickEventOnDrag:Boolean,preventClickDefault:Boolean,viewContainer:Object,persistData:Object,useAccuratePosition:Boolean,firstRenderState:Object},events:{onChangeTargets:"changeTargets"}},pu=Io("padding",{render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=n.padding||{},i=r.left,o=void 0===i?0:i,a=r.top,s=void 0===a?0:a,l=r.right,u=void 0===l?0:l,c=r.bottom,h=void 0===c?0:c,f=t.getState(),p=f.renderPoses,d=[f.pos1,f.pos2,f.pos3,f.pos4],m=[];return o>0&&m.push([0,2]),s>0&&m.push([0,1]),u>0&&m.push([1,3]),h>0&&m.push([2,3]),m.map((function(t,n){var r=t[0],i=t[1],o=_i([0,0],[100,0],[0,100],[100,100],d[r],d[i],p[r],p[i]);if(o.length)return e.createElement("div",{key:"padding".concat(n),className:xa("padding"),style:{transform:La(o,!0)}})}))}}),du=["nw","ne","se","sw"];function mu(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var gu=[1,2,5,6],vu=[0,3,4,7],yu=[1,-1,-1,1],_u=[1,1,-1,-1];function xu(t,e,n,r,i,o,a,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=n),void 0===s&&(s=r);var l=[],u=!1,c=t.filter((function(t){return!t.virtual})),h=c.map((function(t){var c=t.horizontal,h=t.vertical,f=t.pos;if(h&&!u&&(u=!0,l.push("/")),u){var p=Math.max(0,1===h?f[1]-o:s-f[1]);return l.push(gs(p,r,e)),p}p=Math.max(0,1===c?f[0]-i:a-f[0]);return l.push(gs(p,n,e)),p}));return{radiusPoses:c,styles:l,raws:h}}function bu(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var o=t[i];o.sub&&(o.horizontal&&(0===e[1]&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),o.vertical&&(0===n[1]&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function wu(t,e,n,r,i,o,a){var s,l,u,c;void 0===o&&(o=[0,0]),void 0===a&&(a=!1);var h=t.indexOf("/"),f=(h>-1?t.slice(0,h):t).length,p=t.slice(0,f),d=t.slice(f+1),m=p.length,g=d.length,v=g>0,y=p[0],_=void 0===y?"0px":y,x=p[1],b=void 0===x?_:x,w=p[2],S=void 0===w?_:w,E=p[3],k=void 0===E?b:E,C=d[0],I=void 0===C?_:C,T=d[1],P=void 0===T?v?I:b:T,A=d[2],M=void 0===A?v?I:S:A,L=d[3],R=void 0===L?v?P:k:L,D=[_,b,S,k].map((function(t){return Rr(t,e)})),N=[I,P,M,R].map((function(t){return Rr(t,n)})),z=D.slice(),O=N.slice();s=mu([z[0],z[1]],e),z[0]=s[0],z[1]=s[1],l=mu([z[3],z[2]],e),z[3]=l[0],z[2]=l[1],u=mu([O[0],O[3]],n),O[0]=u[0],O[3]=u[1],c=mu([O[1],O[2]],n),O[1]=c[0],O[2]=c[1];var F=a?z:z.slice(0,Math.max(o[0],m)),B=a?O:O.slice(0,Math.max(o[1],g));return Co(Co([],F.map((function(t,e){var o=du[e];return{virtual:e>=m,horizontal:yu[e],vertical:0,pos:[r+t,i+(-1===_u[e]?n:0)],sub:!0,raw:D[e],direction:o}})),!0),B.map((function(t,n){var o=du[n];return{virtual:n>=g,horizontal:0,vertical:_u[n],pos:[r+(-1===yu[n]?e:0),i+t],sub:!0,raw:N[n],direction:o}})),!0)}var Su=[[0,-1,"n"],[1,0,"e"]],Eu=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function ku(t,e,n){var r=t.props.clipRelative,i=t.state,o=i.width,a=i.height,s=e,l=s.type,u=s.poses,c="rect"===l,h="circle"===l;if("polygon"===l)return n.map((function(t){return"".concat(gs(t[0],o,r)," ").concat(gs(t[1],a,r))}));if(c||"inset"===l){var f=n[1][1],p=n[3][0],d=n[7][0],m=n[5][1];if(c)return[f,p,m,d].map((function(t){return"".concat(t,"px")}));var g=[f,o-p,a-m,d].map((function(t,e){return gs(t,e%2?o:a,r)}));if(n.length>8){var v=ii(n[4],n[0]),y=v[0],_=v[1];g.push.apply(g,Co(["round"],xu(u.slice(8).map((function(t,e){return ko(ko({},t),{pos:n[e]})})),r,y,_,d,f,p,m).styles,!1))}return g}if(h||"ellipse"===l){var x=n[0],b=gs(Math.abs(n[1][1]-x[1]),h?Math.sqrt((o*o+a*a)/2):a,r);return(g=h?[b]:[gs(Math.abs(n[2][0]-x[0]),o,r),b]).push("at",gs(x[0],o,r),gs(x[1],a,r)),g}}function Cu(t,e,n,r){var i=[r,(r+e)/2,e],o=[t,(t+n)/2,n];return Eu.map((function(t){var e=t[0],n=t[1],r=t[2],a=i[e+1],s=o[n+1];return{vertical:Math.abs(n),horizontal:Math.abs(e),direction:r,pos:[a,s]}}))}function Iu(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach((function(t){var r=t.pos;e[0]=Math.min(e[0],r[0]),e[1]=Math.max(e[1],r[0]),n[0]=Math.min(n[0],r[1]),n[1]=Math.max(n[1],r[1])})),[Math.abs(e[1]-e[0]),Math.abs(n[1]-n[0])]}function Tu(t,e,n,r,i){var o,a,s,l,u,c,h;if(t){var f=i;if(!f){var p=getComputedStyle(t),d=p.clipPath;f="none"!==d?d:p.clip}if(f&&"none"!==f&&"auto"!==f||(f=r)){var m=kr(f),g=m.prefix,v=void 0===g?f:g,y=m.value,_=void 0===y?"":y,x="circle"===v,b=" ";if("polygon"===v){b=",";var w=(T=Er(_||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map((function(t){var r=t.split(" "),i=r[0],o=r[1];return{vertical:1,horizontal:1,pos:[Rr(i,e),Rr(o,n)]}})),S=Bi(w.map((function(t){return t.pos})));return{type:v,clipText:f,poses:w,splitter:b,left:S.minX,right:S.maxX,top:S.minY,bottom:S.maxY}}if(x||"ellipse"===v){var E="",k="",C=0,I=0,T=Sr(_);if(x){var P;P=void 0===(o=T[0])?"50%":o,E=void 0===(a=T[2])?"50%":a,k=void 0===(s=T[3])?"50%":s,C=Rr(P,Math.sqrt((e*e+n*n)/2)),I=C}else{var A,M;A=void 0===(l=T[0])?"50%":l,M=void 0===(u=T[1])?"50%":u,E=void 0===(c=T[3])?"50%":c,k=void 0===(h=T[4])?"50%":h,C=Rr(A,e),I=Rr(M,n)}var L=[Rr(E,e),Rr(k,n)];w=Co([{vertical:1,horizontal:1,pos:L,direction:"nesw"}],Su.slice(0,x?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[L[0]+t[0]*C,L[1]+t[1]*I]}})),!0);return{type:v,clipText:f,radiusX:C,radiusY:I,left:L[0]-C,top:L[1]-I,right:L[0]+C,bottom:L[1]+I,poses:w,splitter:b}}if("inset"===v){var R=(T=Sr(_||"0 0 0 0")).indexOf("round"),D=(R>-1?T.slice(0,R):T).length,N=T.slice(D+1),z=T.slice(0,D),O=z[0],F=z[1],B=void 0===F?O:F,j=z[2],U=void 0===j?O:j,V=z[3],Z=void 0===V?B:V,q=[O,U].map((function(t){return Rr(t,n)})),G=q[0],W=q[1],X=[Z,B].map((function(t){return Rr(t,e)})),H=X[0],Y=X[1],$=e-Y,K=n-W,J=wu(N,$-H,K-G,H,G);return{type:"inset",clipText:f,poses:w=Co(Co([],Cu(G,$,K,H),!0),J,!0),top:G,left:H,right:$,bottom:K,radius:N,splitter:b}}if("rect"===v){b=",";var Q=(T=Er(_||"0px, ".concat(e,"px, ").concat(n,"px, 0px"))).map((function(t){return Cr(t).value}));return{type:"rect",clipText:f,poses:w=Cu(G=Q[0],Y=Q[1],W=Q[2],H=Q[3]),top:G,right:Y,bottom:W,left:H,values:T,splitter:b}}}}}function Pu(t,e){var n=Yo(t,e),r=n[0],i=n[1],o=e.datas,a=o.clipPath,s=o.clipIndex,l=a,u=l.type,c=l.poses,h=l.splitter,f=c.map((function(t){return t.pos}));if("polygon"===u)f.splice(s,0,[r,i]);else{if("inset"!==u)return;var p=gu.indexOf(s),d=vu.indexOf(s),m=c.length;if(function(t,e,n,r,i,o,a,s,l,u,c){void 0===u&&(u=0),void 0===c&&(c=0);var h=bu(t.slice(n)),f=h.horizontalRange,p=h.verticalRange;if(r>-1)for(var d=1===yu[r]?o-u:s-o,m=f[1];m<=r;++m){var g=1===_u[m]?c:l,v=0;if(r===m?v=o:0===m?v=u+d:-1===yu[m]&&(v=s-(e[n][0]-u)),t.splice(n+m,0,{horizontal:yu[m],vertical:0,pos:[v,g]}),e.splice(n+m,0,[v,g]),0===m)break}else if(i>-1){var y=1===_u[i]?a-c:l-a;if(0===f[1]&&0===p[1]){var _=[u+y,c];t.push({horizontal:yu[0],vertical:0,pos:_}),e.push(_)}var x=p[0];for(m=p[1];m<=i&&(v=1===yu[m]?u:s,g=0,i===m?g=a:0===m?g=c+y:1===_u[m]?g=e[n+x][1]:-1===_u[m]&&(g=l-(e[n+x][1]-c)),t.push({horizontal:0,vertical:_u[m],pos:[v,g]}),e.push([v,g]),0!==m);++m);}}(c,f,8,p,d,r,i,f[4][0],f[4][1],f[0][0],f[0][1]),m===c.length)return}var g=ku(t,a,f),v="".concat(u,"(").concat(g.join(h),")");as(t,"onClip",rs(t,e,ko({clipEventType:"added",clipType:u,poses:f,clipStyles:g,clipStyle:v,distX:0,distY:0},es({clipPath:v},e))))}function Au(t,e){var n=e.datas,r=n.clipPath,i=n.clipIndex,o=r,a=o.type,s=o.poses,l=o.splitter,u=s.map((function(t){return t.pos})),c=u.length;if("polygon"===a)s.splice(i,1),u.splice(i,1);else{if("inset"!==a)return;if(i<8)return;if(function(t,e,n,r,i){void 0===i&&(i=e.length);var o=bu(t.slice(r)),a=o.horizontalRange,s=o.verticalRange,l=n-r,u=0;if(0===l)u=i;else if(l>0&&l<a[1])u=a[1]-l;else{if(!(l>=s[0]))return;u=s[0]+s[1]-l}t.splice(n,u),e.splice(n,u)}(s,u,i,8,c),c===s.length)return}var h=ku(t,r,u),f="".concat(a,"(").concat(h.join(l),")");as(t,"onClip",rs(t,e,ko({clipEventType:"removed",clipType:a,poses:u,clipStyles:h,clipStyle:f,distX:0,distY:0},es({clipPath:f},e))))}var Mu={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,keepRatio:Boolean,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}",":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 2;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,o=n.clipArea,a=n.zoom,s=n.groupable,l=t.getState(),u=l.target,c=l.width,h=l.height,f=l.allMatrix,p=l.is3d,d=l.left,m=l.top,g=l.pos1,v=l.pos2,y=l.pos3,_=l.pos4,x=l.clipPathState,b=l.snapBoundInfos,w=l.rotation;if(!u||s)return[];var S=Tu(u,c,h,i||"inset",x||r);if(!S)return[];var E=p?4:3,k=S.type,C=S.poses.map((function(t){var e=Na(f,t.pos,E);return[e[0]-d,e[1]-m]})),I=[],T=[],P="rect"===k,A="inset"===k,M="polygon"===k;if(P||A||M){var L=A?C.slice(0,8):C;T=L.map((function(t,n){var r=0===n?L[L.length-1]:L[n-1],i=Or(r,t),o=Ua(r,t);return e.createElement("div",{key:"clipLine".concat(n),className:xa("line","clip-line","snap-control"),"data-clip-index":n,style:{width:"".concat(o,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(i,"rad) scaleY(").concat(a,")")}})}))}if(I=C.map((function(t,n){return e.createElement("div",{key:"clipControl".concat(n),className:xa("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(w,"rad) scale(").concat(a,")")}})})),A&&I.push.apply(I,C.slice(8).map((function(t,n){return e.createElement("div",{key:"clipRadiusControl".concat(n),className:xa("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(w,"rad) scale(").concat(a,")")}})}))),"circle"===k||"ellipse"===k){var R=S.left,D=S.top,N=S.radiusX,z=S.radiusY,O=ii(Na(f,[R,D],E),Na(f,[0,0],E)),F=O[0],B=O[1],j="none";if(!o){for(var U=Math.max(10,N/5,z/5),V=[],Z=0;Z<=U;++Z){var q=2*Math.PI/U*Z;V.push([N+(N-a)*Math.cos(q),z+(z-a)*Math.sin(q)])}V.push([N,-2]),V.push([-2,-2]),V.push([-2,2*z+2]),V.push([2*N+2,2*z+2]),V.push([2*N+2,-2]),V.push([N,-2]),j="polygon(".concat(V.map((function(t){return"".concat(t[0],"px ").concat(t[1],"px")})).join(", "),")")}I.push(e.createElement("div",{key:"clipEllipse",className:xa("clip-ellipse","snap-control"),style:{width:"".concat(2*N,"px"),height:"".concat(2*z,"px"),clipPath:j,transform:"translate(".concat(-d+F,"px, ").concat(-m+B,"px) ").concat(La(f))}}))}if(o){var G=Oa(Co([g,v,y,_],C,!0)),W=G.width,X=G.height,H=G.left,Y=G.top;if(M||P||A){V=A?C.slice(0,8):C;I.push(e.createElement("div",{key:"clipArea",className:xa("clip-area","snap-control"),style:{width:"".concat(W,"px"),height:"".concat(X,"px"),transform:"translate(".concat(H,"px, ").concat(Y,"px)"),clipPath:"polygon(".concat(V.map((function(t){return"".concat(t[0]-H,"px ").concat(t[1]-Y,"px")})).join(", "),")")}}))}}return b&&["vertical","horizontal"].forEach((function(t){var n=b[t],r="horizontal"===t;n.isSnap&&T.push.apply(T,n.snap.posInfos.map((function(n,i){var o=n.pos,s=ii(Na(f,r?[0,o]:[o,0],E),[d,m]),l=ii(Na(f,r?[c,o]:[o,h],E),[d,m]);return Nl(e,"",s,l,a,"clip".concat(t,"snap").concat(i),"guideline")}))),n.isBound&&T.push.apply(T,n.bounds.map((function(n,i){var o=n.pos,s=ii(Na(f,r?[0,o]:[o,0],E),[d,m]),l=ii(Na(f,r?[c,o]:[o,h],E),[d,m]);return Nl(e,"",s,l,a,"clip".concat(t,"bounds").concat(i),"guideline","bounds","bold")})))})),Co(Co([],I,!0),T,!0)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props.dragWithClip;return!(void 0===n||n)&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,ko(ko({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,o=r.customClipPath,a=n.target,s=n.width,l=n.height,u=e.inputEvent?e.inputEvent.target:null,c=u&&u.getAttribute("class")||"",h=e.datas,f=Tu(a,s,l,i||"inset",o);if(!f)return!1;var p=f.clipText;return!1===as(t,"onClipStart",rs(t,e,{clipType:f.type,clipStyle:p,poses:f.poses.map((function(t){return t.pos}))}))?(h.isClipStart=!1,!1):(h.isControl=c&&c.indexOf("clip-control")>-1,h.isLine=c.indexOf("clip-line")>-1,h.isArea=c.indexOf("clip-area")>-1||c.indexOf("clip-ellipse")>-1,h.clipIndex=u?parseInt(u.getAttribute("data-clip-index"),10):-1,h.clipPath=f,h.isClipStart=!0,n.clipPathState=p,$o(t,e),!0)},dragControl:function(t,e){var n,r,i=e.datas,o=e.originalDatas,a=e.isDragTarget;if(!i.isClipStart)return!1;var s=i,l=s.isControl,u=s.isLine,c=s.isArea,h=s.clipIndex,f=s.clipPath;if(!f)return!1;var p=qa(t.props,"clippable"),d=p.keepRatio,m=0,g=0,v=o.draggable,y=na(e);a&&v?(n=v.prevBeforeDist,m=n[0],g=n[1]):(m=y[0],g=y[1]);var _=[m,g],x=t.state,b=x.width,w=x.height,S=!c&&!l&&!u,E=f.type,k=f.poses,C=f.splitter,I=k.map((function(t){return t.pos}));S&&(m=-m,g=-g);var T=!l||"nesw"===k[h].direction,P="inset"===E||"rect"===E,A=k.map((function(){return[0,0]}));if(l&&!T){var M=k[h],L=M.horizontal,R=M.vertical,D=[m*Math.abs(L),g*Math.abs(R)];A=function(t,e,n,r,i){var o=t[e],a=o.direction,s=o.sub,l=t.map((function(){return[0,0]})),u=a?a.split(""):[];if(r&&e<8){var c=u.filter((function(t){return"w"===t||"e"===t})),h=u.filter((function(t){return"n"===t||"s"===t})),f=c[0],p=h[0];l[e]=n;var d=Iu(t),m=d[0],g=d[1],v=m&&g?m/g:0;if(v&&i){var y=t[(e+4)%8].pos,_=[0,0];a.indexOf("w")>-1?_[0]=-1:a.indexOf("e")>-1&&(_[0]=1),a.indexOf("n")>-1?_[1]=-1:a.indexOf("s")>-1&&(_[1]=1);var x=Es([m,g],n,v,_,!0),b=m+x[0],w=g+x[1],S=y[1],E=y[1],k=y[0],C=y[0];-1===_[0]?k=C-b:1===_[0]?C=k+b:(k-=b/2,C+=b/2),-1===_[1]?S=E-w:E=1===_[1]?S+w:(S=E-w/2)+w;var I=Cu(S,C,E,k);t.forEach((function(t,e){l[e][0]=I[e].pos[0]-t.pos[0],l[e][1]=I[e].pos[1]-t.pos[1]}))}else t.forEach((function(t,e){var r=t.direction;r&&(r.indexOf(f)>-1&&(l[e][0]=n[0]),r.indexOf(p)>-1&&(l[e][1]=n[1]))})),f&&(l[1][0]=n[0]/2,l[5][0]=n[0]/2),p&&(l[3][1]=n[1]/2,l[7][1]=n[1]/2)}else a&&!s?u.forEach((function(e){var r="n"===e||"s"===e;t.forEach((function(t,i){var o=t.direction,a=t.horizontal,s=t.vertical;o&&-1!==o.indexOf(e)&&(l[i]=[r||!a?0:n[0],r&&s?n[1]:0])}))})):l[e]=n;return l}(k,h,D,P,d)}else T&&(A=I.map((function(){return[m,g]})));var N=I.map((function(t,e){return ri(t,A[e])})),z=Co([],N,!0);x.snapBoundInfos=null;var O="circle"===f.type,F="ellipse"===f.type;if(O||F){var B=Oa(N),j=Math.abs(B.bottom-B.top),U=Math.abs(F?B.right-B.left:j),V=N[0][1]+j,Z=N[0][0]-U,q=N[0][0]+U;O&&(z.push([q,B.bottom]),A.push([1,0])),z.push([B.left,V]),A.push([0,1]),z.push([Z,B.bottom]),A.push([1,0])}var G=Sl((p.clipHorizontalGuidelines||[]).map((function(t){return Rr("".concat(t),w)})),(p.clipVerticalGuidelines||[]).map((function(t){return Rr("".concat(t),b)})),b,w),W=[],X=[];if(O||F)W=[z[4][0],z[2][0]],X=[z[1][1],z[3][1]];else if(P){var H=[z[0],z[2],z[4],z[6]],Y=[A[0],A[2],A[4],A[6]];W=H.filter((function(t,e){return Y[e][0]})).map((function(t){return t[0]})),X=H.filter((function(t,e){return Y[e][1]})).map((function(t){return t[1]}))}else W=z.filter((function(t,e){return A[e][0]})).map((function(t){return t[0]})),X=z.filter((function(t,e){return A[e][1]})).map((function(t){return t[1]}));var $=[0,0],K=yl(G,p.clipTargetBounds&&{left:0,top:0,right:b,bottom:w},W,X,5),J=K.horizontal,Q=K.vertical,tt=J.offset,et=Q.offset;if(J.isBound&&($[1]+=tt),Q.isBound&&($[0]+=et),(F||O)&&0===A[0][0]&&0===A[0][1]){var nt=(B=Oa(N)).bottom-B.top,rt=F?B.right-B.left:nt;rt-=Q.isBound?Math.abs(et):0===Q.snapIndex?-et:et,nt-=J.isBound?Math.abs(tt):0===J.snapIndex?-tt:tt,O&&(rt=nt=Ws(Q,J)>0?nt:rt);var it=z[0];z[1][1]=it[1]-nt,z[2][0]=it[0]+rt,z[3][1]=it[1]+nt,z[4][0]=it[0]-rt}else if(P&&d&&l){var ot=Iu(k),at=ot[0],st=ot[1],lt=at&&st?at/st:0,ut=k[h].direction||"",ct=z[1][1];V=z[5][1],Z=z[7][0],q=z[3][0];tt<=et?tt=et/lt:et=tt*lt,ut.indexOf("w")>-1?Z-=et:ut.indexOf("e")>-1?q-=et:(Z+=et/2,q-=et/2),ut.indexOf("n")>-1?ct-=tt:ut.indexOf("s")>-1?V-=tt:(ct+=tt/2,V-=tt/2);var ht=Cu(ct,q,V,Z);z.forEach((function(t,e){var n;n=ht[e].pos,t[0]=n[0],t[1]=n[1]}))}else z.forEach((function(t,e){var n=A[e];n[0]&&(t[0]-=et),n[1]&&(t[1]-=tt)}));var ft=ku(t,f,N),pt="".concat(E,"(").concat(ft.join(C),")");if(x.clipPathState=pt,O||F)W=[z[4][0],z[2][0]],X=[z[1][1],z[3][1]];else if(P){W=(H=[z[0],z[2],z[4],z[6]]).map((function(t){return t[0]})),X=H.map((function(t){return t[1]}))}else W=z.map((function(t){return t[0]})),X=z.map((function(t){return t[1]}));if(x.snapBoundInfos=yl(G,p.clipTargetBounds&&{left:0,top:0,right:b,bottom:w},W,X,1),v){var dt=x.is3d,mt=x.allMatrix,gt=dt?4:3,vt=$;a&&(vt=[_[0]+$[0]-y[0],_[1]+$[1]-y[1]]),v.deltaOffset=ni(mt,[vt[0],vt[1],0,0],gt)}return as(t,"onClip",rs(t,e,ko({clipEventType:"changed",clipType:E,poses:N,clipStyle:pt,clipStyles:ft,distX:m,distY:g},es(((r={})["rect"===E?"clip":"clipPath"]=pt,r),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,o=r.isLine,a=r.isClipStart,s=r.isControl;return!!a&&(as(t,"onClipEnd",is(t,e,{})),i&&(s?Au(t,e):o&&Pu(t,e)),i||n)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Lu={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:Vr(e.inputEvent.target,xa("origin"))},dragControlStart:function(t,e){var n=e.datas;$o(t,e);var r=rs(t,e,{dragStart:Bl.dragStart(t,(new Ho).dragStart([0,0],e))}),i=as(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,!1===i?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var o=na(e),a=o[0],s=o[1],l=t.state,u=l.width,c=l.height,h=l.offsetMatrix,f=l.targetMatrix,p=l.is3d,d=t.props.originRelative,m=void 0===d||d,g=p?4:3,v=[a,s];if(i){var y=e.distOrigin;(y[0]||y[1])&&(v=y)}var _=ri(n.startOrigin,v),x=ri(n.startTargetOrigin,v),b=ii(v,n.prevOrigin),w=oa(h,f,_,g),S=t.getRect(),E=Oa(za(w,u,c,g)),k=[S.left-E.left,S.top-E.top];n.prevOrigin=v;var C=[gs(x[0],u,m),gs(x[1],c,m)].join(" "),I=Bl.drag(t,Xo(e,t.state,k,!!r,!1)),T=rs(t,e,ko(ko({width:u,height:c,origin:_,dist:v,delta:b,transformOrigin:C,drag:I},es({transformOrigin:C,transform:I.transform},e)),{afterTransform:I.transform}));return as(t,"onDragOrigin",T),T},dragControlEnd:function(t,e){return!!e.datas.isDragOrigin&&(as(t,"onDragOriginEnd",is(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){return!!this.dragControlStart(t,e)},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return!!n&&(t.transformOrigin=n.transformOrigin,!0)},request:function(t){var e={},n=t.getRect(),r=0,i=0,o=n.transformOrigin,a=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(a[0]+=t.deltaOrigin[0],a[1]+=t.deltaOrigin[1]):"origin"in t?(a[0]=t.origin[0]-o[0],a[1]=t.origin[1]-o[1]):("x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY)),{datas:e,distX:r,distY:i,distOrigin:a}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Ru(t,e,n,r,i){void 0===r&&(r=[0,0]);return wu(t&&"0px"!==t?Sr(t):[],e,n,0,0,r,i)}function Du(t,e,n,r,i){var o=t.state,a=o.width,s=o.height,l=xu(i,t.props.roundRelative,a,s),u=l.raws,c=l.styles,h=function(t,e){void 0===e&&(e=t.map((function(t){return t.raw})));var n=t.map((function(t,n){return t.horizontal?e[n]:null})).filter((function(t){return null!=t})),r=t.map((function(t,n){return t.vertical?e[n]:null})).filter((function(t){return null!=t}));return{horizontals:n,verticals:r}}(l.radiusPoses,u),f=h.horizontals,p=h.verticals,d=c.join(" ");o.borderRadiusState=d;var m=rs(t,e,ko({horizontals:f,verticals:p,borderRadius:d,width:a,height:s,delta:r,dist:n},es({borderRadius:d},e)));return as(t,"onRound",m),m}function Nu(t){var e=t.getState().style,n=e.borderRadius||"";if(!n&&t.props.groupable){var r=t.getTargets()[0];r&&(n=getComputedStyle(r).borderRadius,e.borderRadius=n)}return n}var zu={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean,roundPadding:Number,isDisplayShadowRoundControls:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd",onRoundGroupStart:"roundGroupStart",onRoundGroup:"roundGroup",onRoundGroupEnd:"roundGroupEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n    z-index: 3;\n}",".control.border-radius.vertical {\n    background: #d6d;\n    z-index: 2;\n}",".control.border-radius.virtual {\n    opacity: 0.5;\n    z-index: 1;\n}",":host.round-line-clickable .line.direction {\n    cursor: pointer;\n}"],className:function(t){var e=t.props.roundClickable;return!0===e||"line"===e?xa("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,i=n.width,o=n.height,a=n.allMatrix,s=n.is3d,l=n.left,u=n.top,c=n.borderRadiusState,h=t.props,f=h.minRoundControls,p=void 0===f?[0,0]:f,d=h.maxRoundControls,m=void 0===d?[4,4]:d,g=h.zoom,v=h.roundPadding,y=void 0===v?0:v,_=h.isDisplayShadowRoundControls,x=h.groupable;if(!r)return null;var b=c||Nu(t),w=s?4:3,S=Ru(b,i,o,p,!0);if(!S)return null;var E=0,k=0,C=x?[0,0]:[l,u];return S.map((function(t,n){var r=t.horizontal,i=t.vertical,o=t.direction||"",s=Co([],t.pos,!0);k+=Math.abs(r),E+=Math.abs(i),r&&o.indexOf("n")>-1&&(s[1]-=y),i&&o.indexOf("w")>-1&&(s[0]-=y),r&&o.indexOf("s")>-1&&(s[1]+=y),i&&o.indexOf("e")>-1&&(s[0]+=y);var l=ii(Na(a,s,w),C),u=t.vertical?E<=m[1]&&(_||!t.virtual):k<=m[0]&&(_||!t.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(n),className:xa("control","border-radius",t.vertical?"vertical":"",t.virtual?"virtual":""),"data-radius-index":n,style:{display:u?"block":"none",transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) scale(").concat(g,")")}})}))},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,o=i.getAttribute("class")||"",a=o.indexOf("border-radius")>-1,s=o.indexOf("moveable-line")>-1&&o.indexOf("moveable-direction")>-1,l=a?parseInt(i.getAttribute("data-radius-index"),10):-1,u=-1;if(s){var c=i.getAttribute("data-line-key")||"";c&&(u=parseInt(c.replace(/render-line-/g,""),10),isNaN(u)&&(u=-1))}if(!a&&!s)return!1;var h=rs(t,e,{});if(!1===as(t,"onRoundStart",h))return!1;r.lineIndex=u,r.controlIndex=l,r.isControl=a,r.isLine=s,$o(t,e);var f=t.props,p=f.roundRelative,d=f.minRoundControls,m=void 0===d?[0,0]:d,g=t.state,v=g.width,y=g.height;r.isRound=!0,r.prevDist=[0,0];var _=Ru(Nu(t)||"",v,y,m,!0)||[];return r.controlPoses=_,g.borderRadiusState=xu(_,p,v,y).styles.join(" "),h},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var i=n.controlIndex,o=na(e),a=o[0],s=o[1],l=[a,s],u=ii(l,n.prevDist),c=t.props.maxRoundControls,h=void 0===c?[4,4]:c,f=t.state,p=f.width,d=f.height,m=r[i],g=m.vertical,v=m.horizontal,y=r.map((function(t){var e=t.horizontal,n=t.vertical,r=[e*v*l[0],n*g*l[1]];if(e){if(1===h[0])return r;if(h[0]<4&&e!==v)return r}else{if(0===h[1])return r[1]=n*v*l[0]/p*d,r;if(g){if(1===h[1])return r;if(h[1]<4&&n!==g)return r}}return[0,0]}));y[i]=l;var _=r.map((function(t,e){return ko(ko({},t),{pos:ri(t.pos,y[e])})}));return i<4?_.slice(0,i+1).forEach((function(t){t.virtual=!1})):_.slice(4,i+1).forEach((function(t){t.virtual=!1})),n.prevDist=[a,s],Du(t,e,l,u,_)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var o=r.isControl,a=r.controlIndex,s=r.isLine,l=r.lineIndex,u=r.controlPoses,c=u.filter((function(t){return t.virtual})).length,h=t.props.roundClickable,f=void 0===h||h;if(i&&f){if(!o||!0!==f&&"control"!==f){if(s&&(!0===f||"line"===f)){var p=Yo(t,e);!function(t,e,n,r){var i=t.filter((function(t){var e=t.virtual;return t.horizontal&&!e})).length,o=t.filter((function(t){var e=t.virtual;return t.vertical&&!e})).length,a=-1;if(0===e&&(0===i?a=0:1===i&&(a=1)),2===e&&(i<=2?a=2:i<=3&&(a=3)),3===e&&(0===o?a=4:o<4&&(a=7)),1===e&&(o<=1?a=5:o<=2&&(a=6)),-1!==a&&t[a].virtual){var s=t[a];!function(t,e){e<4?t.slice(0,e+1).forEach((function(t){t.virtual=!1})):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach((function(t){t.virtual=!1})))}(t,a),a<4?s.pos[0]=n:s.pos[1]=r}}(u,l,p[0],p[1])}}else!function(t,e){e<4?t.slice(e,4).forEach((function(t){t.virtual=!0})):t.slice(e).forEach((function(t){t.virtual=!0}))}(u,a);c!==u.filter((function(t){return t.virtual})).length&&Du(t,e,[0,0],[0,0],u)}var d=is(t,e,{});return as(t,"onRoundEnd",d),n.borderRadiusState="",d},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,o=As(t,"roundable",e),a=ko({targets:t.props.targets,events:o.map((function(t,e){return ko(ko({},t),{target:i[e],moveable:r[e],currentTarget:r[e]})}))},n);return as(t,"onRoundGroupStart",a),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,o=As(t,"roundable",e),a=ko({targets:t.props.targets,events:o.map((function(t,e){return ko(ko(ko({},t),{target:i[e],moveable:r[e],currentTarget:r[e]}),es({borderRadius:n.borderRadius},t))}))},n);return as(t,"onRoundGroup",a),a},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,i=As(t,"roundable",e);os(t,"onRound",(function(e){var o=ko({targets:t.props.targets,events:i.map((function(t,i){return ko(ko(ko({},t),{target:r[i],moveable:n[i],currentTarget:n[i]}),es({borderRadius:e.borderRadius},t))}))},e);as(t,"onRoundGroup",o)}));var o=this.dragControlEnd(t,e);if(!o)return!1;var a=ko({targets:t.props.targets,events:i.map((function(t,e){var i;return ko(ko({},t),{target:r[e],moveable:n[e],currentTarget:n[e],lastEvent:null===(i=t.datas)||void 0===i?void 0:i.lastEvent})}))},o);return as(t,"onRoundGroupEnd",a),a},unset:function(t){t.state.borderRadiusState=""}};var Ou={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.target,o=n.targetMatrix,a=null===i||void 0===i?void 0:i.style.transform,s=r?"matrix3d(".concat(o.join(","),")"):"matrix(".concat(ai(o,!0),")"),l=a&&"none"!==a?a:s;e.datas.startTransforms=function(t,e){var n=gi(e?4:3);return t==="matrix".concat(e?"3d":"","(").concat(n.join(","),")")||"matrix(1,0,0,1,0,0)"===t}(l,r)?[]:Sr(l)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return rs(t,e,{setTransform:function(t){e.datas.startTransforms=gr(t)?t:Sr(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return rs(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),as(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){this.resetStyle(e),as(t,"onBeforeRender",rs(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){as(t,"onBeforeRenderEnd",rs(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=As(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.setTransform(r,t),n.resetStyle(t),n.fillDragStartParams(r,t)}));as(t,"onBeforeRenderGroupStart",rs(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:o}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=As(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.resetStyle(t),n.fillDragParams(r,t)}));as(t,"onBeforeRenderGroup",rs(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:o}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),as(t,"onBeforeRenderGroupEnd",rs(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Fu={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(t,e){as(t,"onRenderStart",rs(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){as(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){if(e.resultCount)return this.drag(t,e)},dragEnd:function(t,e){as(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){as(t,"onRenderGroupStart",rs(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=As(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.fillDragParams(r,t)}));as(t,"onRenderGroup",rs(t,e,ko(ko({isPinch:!!e.isPinch,targets:t.props.targets,transform:fa(e)},es(pa(e))),{events:o})))},dragGroupEnd:function(t,e){var n=this,r=As(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.fillDragEndParams(r,t)}));as(t,"onRenderGroupEnd",rs(t,e,ko({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:o,transform:fa(e)},es(pa(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){return rs(t,e,ko({isPinch:!!e.isPinch,transform:fa(e)},es(pa(e))))},fillDragEndParams:function(t,e){return rs(t,e,ko({isPinch:!!e.isPinch,isDrag:e.isDrag,transform:fa(e)},es(pa(e))))}};function Bu(t,e,n,r,i,o,a){var s="Start"===i,l=t.state.target,u=o.isRequest;if(!l||s&&r.indexOf("Control")>-1&&!u&&t.areaElement===o.inputEvent.target)return!1;var c="".concat(n).concat(r).concat(i),h="".concat(n).concat(r,"Condition"),f="End"===i,p="After"===i,d=s&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());d&&t.updateRect(i,!0,!1),o.clientDistX=o.distX,o.clientDistY=o.distY,""!==i||u||ds(t.state,o);var m=Co([],t[e],!0);if(u){var g=o.requestAble;m.some((function(t){return t.name===g}))||m.push.apply(m,t.props.ables.filter((function(t){return t.name===g})))}if(!m.length||m.every((function(t){return t.dragRelation})))return!1;var v=Co(Co([Ou],m,!0),[Fu],!1).filter((function(t){return t[c]})),y=o.datas;d&&v.forEach((function(e){e.unset&&e.unset(t)}));var _,x=o.inputEvent;f&&x&&(_=document.elementFromPoint(o.clientX,o.clientY)||x.target);var b=0,w=!1,S=function(){var t;w=!0,null===(t=o.stop)||void 0===t||t.call(o)},E=v.filter((function(e){var n=e.name,r=y[n]||(y[n]={});if(s&&(r.isEventStart=!e[h]||e[h](t,o)),r.isEventStart){var i=e[c](t,ko(ko({},o),{stop:S,resultCount:b,datas:r,originalDatas:y,inputTarget:_}));return t._emitter.off(),s&&!1===i&&(r.isEventStart=!1),b+=i||r.isEventStart?1:0,i}return!1})).length,k=!1;if(w&&(k=!0),!k&&s&&v.length&&!E&&(k=v.filter((function(t){var e=t.name;return!!y[e].isEventStart&&"strong"!==t.dragRelation})).length),(f||k)&&(t.state.gestos={},t.moveables&&t.moveables.forEach((function(t){t.state.gestos={}})),v.forEach((function(e){e.unset&&e.unset(t)}))),s&&!k&&!u&&E&&(null===o||void 0===o||o.preventDefault()),t.isUnmounted||k)return!1;(!s&&E&&!a||f)&&(t.props.flushSync||ba)((function(){t.updateRect(f?i:"",!0,!1),t.forceUpdate()}));return s||f||p||!E||a||Bu(t,e,n,r,i+"After",o),!0}function ju(t){return function(e){var n=t.props.dragTarget,r=e.inputEvent.target,i=t.areaElement;return n&&(r===n||n.contains(r))||r===i||!t.isMoveableElement(r)&&!t.controlBox.getElement().contains(r)||Vr(r,"moveable-area")||Vr(r,"moveable-padding")||Vr(r,"moveable-edgeDraggable")}}function Uu(t,e,n){var r=t.controlBox.getElement(),i=[],o=t.props.dragTarget;return i.push(r),t.props.dragArea&&!o||i.push(e),Vu(t,i,"targetAbles",n,{dragStart:ju(t),pinchStart:ju(t)})}function Vu(t,e,n,r,i){void 0===i&&(i={});var o="targetAbles"===n,a=t.props,s=a.pinchOutside,l=a.pinchThreshold,u=a.preventClickEventOnDrag,c=a.preventClickDefault,h=a.checkInput,f={preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:!!o&&u,preventClickEventOnDragStart:!!o&&c,preventClickEventByCondition:o?null:function(e){return t.controlBox.getElement().contains(e.target)},checkInput:!!o&&h},p=new po(e,f),d="Control"===r;return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(o){p.on("".concat(e).concat(o),(function(a){var s,l=a.eventType;!i[l]||i[l](a)?Bu(t,n,e,r,o,a)?(t.props.stopPropagation||"Start"===o&&d)&&(null===(s=null===a||void 0===a?void 0:a.inputEvent)||void 0===s||s.stopPropagation()):a.stop():a.stop()}))}))})),p}var Zu=function(){function t(t,e,n){var r=this;this.target=t,this.moveable=e,this.eventName=n,this.ables=[],this._onEvent=function(t){var e=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach((function(r){r[e](n,{inputEvent:t})}))},t.addEventListener(n.toLowerCase(),this._onEvent)}var e=t.prototype;return e.setAbles=function(t){this.ables=t},e.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function qu(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}function Gu(t,e,n){for(var r,i,o,a=t,s=[],l=document.documentElement||document.body,u=!n&&t===e||t===l,c=u,h=!1,f=3,p=!1,d=Ia(e,e,!0).offsetParent,m=1;a&&!c;){c=u;var g=getComputedStyle(a),v=g.position,y=oi(wa(Ca(a,g))),_="fixed"===v,x={hasTransform:!1,fixedContainer:null};_&&(p=!0,d=(x=Ma(a)).fixedContainer);var b=y.length;h||16!==b||(h=!0,f=4,Aa(s),o&&(o=ti(o,3,4))),h&&9===b&&(y=ti(y,3,4));var w=Ta(a,t,g),S=w.tagName,E=w.hasOffset,k=w.isSVG,C=w.origin,I=w.targetOrigin,T=w.offset,P=T[0],A=T[1];"svg"===S&&o&&(s.push({type:"target",target:a,matrix:Da(a,f)}),s.push({type:"offset",target:a,matrix:gi(f)}));var M=void 0,L=!1,R=!1,D=parseFloat(g.zoom)||1;if(_)M=x.fixedContainer,L=!0;else{var N=Ia(a,e,!1,!0,g),z=N.offsetZoom;if(M=N.offsetParent,L=N.isEnd,R=N.isStatic,m*=z,1!==z&&R)P-=M.offsetLeft,A-=M.offsetTop;else if(Mo){if(N.parentSlotElement){for(var O=M,F=0,B=0;O&&qu(O);)F+=O.offsetLeft,B+=O.offsetTop,O=O.offsetParent;P-=F,A-=B}}}!Po||Lo||!E||k||!R||"relative"!==v&&"static"!==v||(P-=M.offsetLeft,A-=M.offsetTop,u=u||L);var j=0,U=0,V=0,Z=0;if(_)E&&x.hasTransform&&(V=M.clientLeft,Z=M.clientTop);else if(E&&d!==M&&(j=M.clientLeft,U=M.clientTop),E&&M===l){var q=Pa(a,!1,g);P+=q[0],A+=q[1]}if(s.push({type:"target",target:a,matrix:Sa(y,f,C)}),E){var G=a===t,W=G?0:a.scrollLeft,X=G?0:a.scrollTop;s.push({type:"offset",target:a,matrix:yi([P-W+j-V,A-X+U-Z],f)})}else s.push({type:"offset",target:a,origin:C});if(1!==D&&s.push({type:"zoom",target:a,matrix:Sa(vi([D,D],f),f,[0,0])}),o||(o=y),r||(r=C),i||(i=I),c||_)break;a=M,u=L,n&&a!==l||(c=u)}return o||(o=gi(f)),r||(r=[0,0]),i||(i=[0,0]),{zoom:m,offsetContainer:d,matrixes:s,targetMatrix:o,transformOrigin:r,targetOrigin:i,is3d:h,hasFixed:p}}function Wu(t,e,n,r){var i;void 0===n&&(n=e);var o=Gu(t,e),a=o.matrixes,s=o.is3d,l=o.targetMatrix,u=o.transformOrigin,c=o.targetOrigin,h=o.offsetContainer,f=o.hasFixed,p=o.zoom,d=Gu(h,n,!0),m=d.matrixes,g=d.is3d,v=d.offsetContainer,y=d.zoom,_=r||g||s,x=_?4:3,b="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,w=l,S=gi(x),E=gi(x),k=gi(x),C=gi(x),I=a.length;m.reverse(),a.reverse(),!s&&_&&(w=ti(w,3,4),Aa(a)),!g&&_&&Aa(m),m.forEach((function(t){E=ni(E,t.matrix,x)}));var T=n||document.body,P=(null===(i=m[0])||void 0===i?void 0:i.target)||Ia(T,T,!0).offsetParent,A=m.slice(1).reduce((function(t,e){return ni(t,e.matrix,x)}),gi(x));a.forEach((function(t,e){if(I-2===e&&(k=S.slice()),I-1===e&&(C=S.slice()),!t.matrix){var n=function(t,e,n,r,i){var o,a=t.target,s=t.origin,l=e.matrix,u=Ga(a),c=u.offsetWidth,h=u.offsetHeight,f=n.getBoundingClientRect(),p=[0,0];n===document.body&&(p=Pa(a,!0));for(var d=a.getBoundingClientRect(),m=d.left-f.left+n.scrollLeft-(n.clientLeft||0)+p[0],g=d.top-f.top+n.scrollTop-(n.clientTop||0)+p[1],v=d.width,y=d.height,_=ei(r,i,l),x=Fa(_,c,h,r),b=x.left,w=x.top,S=x.width,E=x.height,k=Na(_,s,r),C=ii(k,[b,w]),I=[m+C[0]*v/S,g+C[1]*y/E],T=[0,0],P=0;++P<10;){var A=Kr(i,r);o=ii(Na(A,I,r),Na(A,k,r)),T[0]=o[0],T[1]=o[1];var M=Fa(ei(r,i,yi(T,r),l),c,h,r),L=M.left-m,R=M.top-g;if(Math.abs(L)<2&&Math.abs(R)<2)break;I[0]-=L,I[1]-=R}return T.map((function(t){return Math.round(t)}))}(t,a[e+1],P,x,ni(A,S,x));t.matrix=yi(n,x)}S=ni(S,t.matrix,x)}));var M=!b&&s;w||(w=gi(M?4:3));var L=La(b&&16===w.length?ti(w,4,3):w,M),R=E;return{hasZoom:1!==p||1!==y,hasFixed:f,rootMatrix:E=$r(E,x,x),originalRootMatrix:R,beforeMatrix:k,offsetMatrix:C,allMatrix:S,targetMatrix:w,targetTransform:L,transformOrigin:u,targetOrigin:c,is3d:_,offsetContainer:h,offsetRootContainer:v}}function Xu(t,e,n,r){void 0===n&&(n=e);var i=0,o=0,a=0,s={},l=Ga(t);if(t&&(i=l.offsetWidth,o=l.offsetHeight),t){var u=Wu(t,e,n,r),c=Ba(u.allMatrix,u.transformOrigin,i,o);s=ko(ko({},u),c);var h=Ba(u.allMatrix,[50,50],100,100);a=Wa([h.pos1,h.pos2],h.direction)}var f=r?4:3;return ko(ko(ko({hasZoom:!1,width:i,height:o,rotation:a},l),{originalRootMatrix:gi(f),rootMatrix:gi(f),beforeMatrix:gi(f),offsetMatrix:gi(f),allMatrix:gi(f),targetMatrix:gi(f),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),s)}function Hu(t,e,n,r,i,o){void 0===o&&(o=[]);var a=1,s=[0,0],l={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},u={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},c={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},h={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},f=[0,0],p={},d=Xu(e,n,i,!0);if(e){var m=getComputedStyle(e);o.forEach((function(t){p[t]=m[t]}));var g=d.is3d?4:3,v=Ba(d.offsetMatrix,ri(d.transformOrigin,Jr(d.targetMatrix,g)),d.width,d.height);a=v.direction,s=ri(v.origin,[v.left-d.left,v.top-d.top]),h=Ya(d.offsetRootContainer);var y=Ia(r,r,!0).offsetParent||d.offsetRootContainer;if(d.hasZoom){var _=Ba(ni(d.originalRootMatrix,d.allMatrix),d.transformOrigin,d.width,d.height),x=Ba(d.originalRootMatrix,ka(getComputedStyle(y)).map((function(t){return parseFloat(t)})),y.offsetWidth,y.offsetHeight);if(l=Ha(_,h),c=Ha(x,h,y,!0),t){var b=_.left,w=_.top;u=Ha({left:b,top:w,bottom:w,right:w},h)}}else{l=Ya(e),c=Ya(y,!0),t&&(u=Ya(t));var S=c.left,E=c.top,k=c.clientLeft,C=c.clientTop,I=[l.left-S,l.top-E];f=ii(ps(d.rootMatrix,I,4),[k+d.left,C+d.top])}}return ko({targetClientRect:l,containerClientRect:c,moveableClientRect:u,rootContainerClientRect:h,beforeDirection:a,beforeOrigin:s,originalBeforeOrigin:s,target:e,style:p,offsetDelta:f},d)}function Yu(t){var e=t.pos1,n=t.pos2,r=t.pos3,i=t.pos4;if(!e||!n||!r||!i)return null;var o=Bi([e,n,r,i]),a=[o.minX,o.minY],s=ii(t.origin,a);return e=ii(e,a),n=ii(n,a),r=ii(r,a),i=ii(i,a),ko(ko({},t),{left:t.left,top:t.top,posDelta:a,pos1:e,pos2:n,pos3:r,pos4:i,origin:s,beforeOrigin:s,isPersisted:!0})}var $u=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=ko({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Hu(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new Yi,t._prevTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._observer=null,t._observerId=0,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t.checkUpdateRect=function(){if(!t.isDragging()){var e=t.props.parentMoveable;e?e.checkUpdateRect():(Mr(t._observerId),t._observerId=Ar((function(){t.isDragging()||t.updateRect()})))}},t._onPreventClick=function(t){t.stopPropagation(),t.preventDefault()},t}Eo(n,e);var r=n.prototype;return r.render=function(){var e=this.props,n=this.getState(),r=e.parentPosition,i=e.className,o=e.target,a=e.zoom,s=e.cspNonce,l=e.translateZ,u=e.cssStyled,c=e.portalContainer,h=e.groupable;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var f=r||[0,0],p=f[0],d=f[1],m=n.left,g=n.top,v=n.target,y=n.direction,_=n.hasFixed,x=n.offsetDelta,b=e.targets,w=this.isDragging(),S={};this.getEnabledAbles().forEach((function(t){S["data-able-".concat(t.name.toLowerCase())]=!0}));var E=this._getAbleClassName(),k=b&&b.length&&(v||h)||o||!this._hasFirstTarget&&this.state.isPersisted,C=this.controlBox||this.props.firstRenderState||this.props.persistData,I=[m-p,g-d];return!h&&e.useAccuratePosition&&(I[0]+=x[0],I[1]+=x[1]),t.createElement(u,ko({cspNonce:s,ref:ar(this,"controlBox"),className:"".concat(xa("control-box",-1===y?"reverse":"",w?"dragging":"")," ").concat(E," ").concat(i)},S,{onClick:this._onPreventClick,portalContainer:c,style:{position:_?"fixed":"absolute",display:k?"block":"none",visibility:C?"visible":"hidden",transform:"translate3d(".concat(I[0],"px, ").concat(I[1],"px, ").concat(l,")"),"--zoom":a,"--zoompx":"".concat(a,"px")}}),this.renderAbles(),this._renderLines())},r.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1,this.controlBox.getElement();var t=this.props,e=t.parentMoveable,n=t.container,r=t.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),n||e||r||this.state.isPersisted||(this.updateRect("",!1,!1),this.forceUpdate())},r.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(t)},r.componentWillUnmount=function(){this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),this._viewContainer&&this._changeAbleViewClassNames([]),ts(this,"targetGesto"),ts(this,"controlGesto");var t=this.events;for(var e in t){var n=t[e];n&&n.destroy()}},r.getTargets=function(){var t=this.props.target;return t?[t]:[]},r.getAble=function(t){return Pr(this.props.ables||[],(function(e){return e.name===t}))},r.getContainer=function(){var t=this.props,e=t.parentMoveable,n=t.wrapperMoveable;return t.container||n&&n.getContainer()||e&&e.getContainer()||this.controlBox.getElement().parentElement},r.isMoveableElement=function(t){var e;return t&&((null===(e=t.getAttribute)||void 0===e?void 0:e.call(t,"class"))||"").indexOf(Ro)>-1},r.dragStart=function(t){var e=this.targetGesto,n=this.controlGesto;return e&&ju(this)({inputEvent:t})?e.isFlag()||e.triggerDragStart(t):n&&this.isMoveableElement(t.target)&&(n.isFlag()||n.triggerDragStart(t)),this},r.hitTest=function(t){var e,n=this.state,r=n.target,i=n.pos1,o=n.pos2,a=n.pos3,s=n.pos4,l=n.targetClientRect;if(!r)return 0;if(t instanceof Element){var u=t.getBoundingClientRect();e={left:u.left,top:u.top,width:u.width,height:u.height}}else e=ko({width:0,height:0},t);var c=e.left,h=e.top,f=e.width,p=e.height,d=Fi([i,o,s,a],l),m=Wi(d,[[c,h],[c+f,h],[c+f,h+p],[c,h+p]]),g=Oi(d);return m&&g?Math.min(100,m/g*100):0},r.isInside=function(t,e){var n=this.state,r=n.target,i=n.pos1,o=n.pos2,a=n.pos3,s=n.pos4,l=n.targetClientRect;return!!r&&ji([t,e],Fi([i,o,s,a],l))},r.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=this.props,i=r.parentMoveable,o=this.state.target||this.props.target,a=this.getContainer(),s=i?i._rootContainer:this._rootContainer,l=Hu(this.controlBox&&this.controlBox.getElement(),o,a,a,s||a,this._getRequestStyles());if(!o&&this._hasFirstTarget&&r.persistData){var u=Yu(r.persistData);for(var c in u)l[c]=u[c]}this.updateState(l,!i&&n)},r.isDragging=function(t){var e,n,r=this.targetGesto,i=this.controlGesto;return(null===r||void 0===r?void 0:r.isFlag())?!t||!!(null===(e=r.getEventData()[t])||void 0===e?void 0:e.isEventStart):!!(null===i||void 0===i?void 0:i.isFlag())&&(!t||!!(null===(n=i.getEventData()[t])||void 0===n?void 0:n.isEventStart))},r.updateTarget=function(t){this.updateRect(t,!0)},r.getRect=function(){var t=this.state,e=Qa(this.state),n=e[0],r=e[1],i=e[2],o=e[3],a=Oa(e),s=t.width,l=t.height,u=a.width,c=a.height,h=a.left,f=a.top,p=[t.left,t.top],d=ri(p,t.origin);return{width:u,height:c,left:h,top:f,pos1:n,pos2:r,pos3:i,pos4:o,offsetWidth:s,offsetHeight:l,beforeOrigin:ri(p,t.beforeOrigin),origin:d,transformOrigin:t.transformOrigin,rotation:this.getRotation()}},r.getManager=function(){return this},r.stopDrag=function(t){var e,n;t&&"target"!==t||null===(e=this.targetGesto)||void 0===e||e.stop(),t&&"control"!==t||null===(n=this.controlGesto)||void 0===n||n.stop()},r.getRotation=function(){var t=this.state;return function(t,e,n){var r=Or(t,e)/Math.PI*180;return(r=n>=0?r:180-r)>=0?r:360+r}(t.pos1,t.pos2,t.direction)},r.request=function(t,e,n){void 0===e&&(e={});var r=this.props,i=r.ables,o=r.groupable,a=i.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!a||!a.request)return{request:function(){return this},requestEnd:function(){return this}};var s=this,l=a.request(this),u=n||e.isInstant,c=l.isControl?"controlAbles":"targetAbles",h="".concat(o?"Group":"").concat(l.isControl?"Control":""),f={request:function(e){return Bu(s,c,"drag",h,"",ko(ko({},l.request(e)),{requestAble:t,isRequest:!0}),u),this},requestEnd:function(){return Bu(s,c,"drag",h,"End",ko(ko({},l.requestEnd()),{requestAble:t,isRequest:!0}),u),this}};return Bu(s,c,"drag",h,"Start",ko(ko({},l.requestStart(e)),{requestAble:t,isRequest:!0}),u),u?f.request(e).requestEnd():f},r.destroy=function(){this.componentWillUnmount()},r.updateRenderPoses=function(){var t=this.getState(),e=this.props,n=t.originalBeforeOrigin,r=t.transformOrigin,i=t.allMatrix,o=t.is3d,a=t.pos1,s=t.pos2,l=t.pos3,u=t.pos4,c=t.left,h=t.top,f=t.isPersisted,p=e.padding||{},d=p.left,m=void 0===d?0:d,g=p.top,v=void 0===g?0:g,y=p.bottom,_=void 0===y?0:y,x=p.right,b=void 0===x?0:x,w=o?4:3,S=[];S=f?r:this.controlBox&&e.groupable?n:ri(n,[c,h]),t.renderPoses=[ri(a,ms(i,[-m,-v],r,S,w)),ri(s,ms(i,[b,-v],r,S,w)),ri(l,ms(i,[-m,_],r,S,w)),ri(u,ms(i,[b,_],r,S,w))]},r.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,e=t.target,n=t.container,r=t.parentMoveable,i=this.state,o=i.target,a=i.container;if(o||e){this.updateAbles();var s=!us(o,e);if(s||!us(a,n)){var l=n||this.controlBox;l&&this.unsetAbles(),this.updateState({target:e,container:n}),!r&&l&&this.updateRect("End",!1,!1),this._isPropTargetChanged=s}}},r.waitToChangeTarget=function(){return new Promise((function(){}))},r.triggerEvent=function(t,e){this._emitter.trigger(t,e);var n=this.props[t];return n&&n(e)},r.useCSS=function(t,e){var n=this.props.customStyledMap,r=t+e;return n[r]||(n[r]=wo(t,e)),n[r]},r.getState=function(){var t,e=this.props;(e.target||(null===(t=e.targets)||void 0===t?void 0:t.length))&&(this._hasFirstTarget=!0);var n=this.controlBox,r=e.persistData,i=e.firstRenderState;if(i&&!n)return i;if(!this._hasFirstTarget&&r){var o=Yu(r);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},r.updateSelectors=function(){},r.unsetAbles=function(){var t=this;this.targetAbles.forEach((function(e){e.unset&&e.unset(t)}))},r.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props.triggerAblesSimultaneously,r=this.getEnabledAbles(t),i="drag".concat(e,"Start"),o="pinch".concat(e,"Start"),a="drag".concat(e,"ControlStart"),s=ls(r,[i,o],n),l=ls(r,[a],n);this.enabledAbles=r,this.targetAbles=s,this.controlAbles=l},r.updateState=function(t,e){if(e){if(this.isUnmounted)return;this.setState(t)}else{var n=this.state;for(var r in t)n[r]=t[r]}},r.getEnabledAbles=function(t){void 0===t&&(t=this.props.ables);var e=this.props;return t.filter((function(t){return t&&(t.always&&!1!==e[t.name]||e[t.name])}))},r.renderAbles=function(){var e=this,n=this.props.triggerAblesSimultaneously,r={createElement:t.createElement};return this.renderState={},function(t,e){var n=[],r={};return t.forEach((function(i,o){var a=e(i,o,t),s=r[a];s||(s=[],r[a]=s,n.push(s)),s.push(i)})),n}(hs(ls(this.getEnabledAbles(),["render"],n).map((function(t){return(0,t.render)(e,r)||[]}))).filter((function(t){return t})),(function(t){return t.key})).map((function(t){return t[0]}))},r.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r._getRequestStyles=function(){var t=this.getEnabledAbles().reduce((function(t,e){var n,r,i=null!==(r=null===(n=e.requestStyle)||void 0===n?void 0:n.call(e))&&void 0!==r?r:[];return Co(Co([],t,!0),i,!0)}),[]);return t},r._updateObserver=function(t){var e,n=this.props,r=n.target;if(window.ResizeObserver&&r&&n.useResizeObserver){if(t.target!==r||!this._observer){var i=new ResizeObserver(this.checkUpdateRect);i.observe(r,{box:"border-box"}),this._observer=i}}else null===(e=this._observer)||void 0===e||e.disconnect()},r._updateEvents=function(){var t=this.controlBox.getElement(),e=this.targetAbles.length,n=this.controlAbles.length,r=this.props,i=r.dragTarget||r.target;(!e&&this.targetGesto||this._isTargetChanged(!0))&&(ts(this,"targetGesto"),this.updateState({gesto:null})),n||ts(this,"controlGesto"),i&&e&&!this.targetGesto&&(this.targetGesto=Uu(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=Vu(this,t,"controlAbles","Control"))},r._updateTargets=function(){var t=this.props;this._prevTarget=t.dragTarget||t.target,this._prevDragArea=t.dragArea},r._renderLines=function(){var e=this.props,n=e.zoom,r=e.hideDefaultLines,i=e.hideChildMoveableDefaultLines,o=e.parentMoveable;if(r||o&&i)return[];var a=this.getState().renderPoses,s={createElement:t.createElement};return[[0,1],[1,3],[3,2],[2,0]].map((function(t,e){var r=t[0],i=t[1];return Nl(s,"",a[r],a[i],n,"render-line-".concat(e))}))},r._isTargetChanged=function(t){var e=this.props,n=e.dragTarget||e.target,r=this._prevTarget,i=this._prevDragArea,o=e.dragArea;return!o&&r!==n||(t||o)&&i!==o},r._updateNativeEvents=function(){var t=this,e=this.props.dragArea?this.areaElement:this.state.target,n=this.events,r=Lr(n);if(this._isTargetChanged())for(var i in n){var o=n[i];o&&o.destroy(),n[i]=null}if(e){var a=this.enabledAbles;r.forEach((function(r){var i=ls(a,[r]),o=i.length>0,s=n[r];o?(s||(s=new Zu(e,t,r),n[r]=s),s.setAbles(i)):s&&(s.destroy(),n[r]=null)}))}},r._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=bs(t,!0))},r._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=bs(t,!0)),this._viewContainer&&this._changeAbleViewClassNames(Co(Co([],this._getAbleViewClassNames(),!0),[this.isDragging()?ou:""],!1))},r._changeAbleViewClassNames=function(t){var e=this._viewContainer,n=cs(t.filter(Boolean),(function(t){return t})).map((function(t){return t[0]})),r=this._viewClassNames,i=Ti(r,n),o=i.removed,a=i.added;o.forEach((function(t){qr(e,r[t])})),a.forEach((function(t){Zr(e,n[t])})),this._viewClassNames=n},r._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map((function(e){var n;return(null===(n=e.viewClassName)||void 0===n?void 0:n.call(e,t))||""})).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r._getAbleClassName=function(t){var e=this;void 0===t&&(t="");var n=this.getEnabledAbles(),r=this.targetGesto,i=this.controlGesto,o=(null===r||void 0===r?void 0:r.isFlag())?r.getEventData():{},a=(null===i||void 0===i?void 0:i.isFlag())?i.getEventData():{};return n.map((function(n){var r,i,s,l=n.name,u=(null===(r=n.className)||void 0===r?void 0:r.call(n,e))||"";return((null===(i=o[l])||void 0===i?void 0:i.isEventStart)||(null===(s=a[l])||void 0===s?void 0:s.isEventStart))&&(u+=" ".concat(xa("".concat(l).concat(t,"-dragging")))),u.trim()})).filter(Boolean).join(" ")},n.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,portalContainer:null,useResizeObserver:!1,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:ba,firstRenderState:null,persistData:null,viewContainer:null,useAccuratePosition:!1},n}(t.PureComponent),Ku={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean,groupableProps:Object,targetGroups:Object,hideChildMoveableDefaultLines:Boolean},events:{},render:function(t,e){var n,r=t.props,i=r.targets||[];t.moveables=[];var o=t.getState(),a=o.left,s=o.top,l=o.isPersisted,u=[a,s],c=r.zoom||1,h=t.renderGroupRects,f=(null===(n=r.persistData)||void 0===n?void 0:n.children)||[];return l?i=f.map((function(){return null})):f=[],Co(Co([],i.map((function(n,i){return e.createElement($u,{key:"moveable"+i,ref:sr(t,"moveables",i),target:n,origin:!1,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:u,persistData:f[i],zoom:c})})),!0),hs(h.map((function(t,n){var r=[t.pos1,t.pos2,t.pos3,t.pos4];return[[0,1],[1,3],[3,2],[2,0]].map((function(t,i){var o=t[0],a=t[1];return Nl(e,"",ii(r[o],u),ii(r[a],u),c,"group-rect-".concat(n,"-").concat(i))}))}))),!0)}},Ju=Io("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,o=!t.isMoveableElement(i)&&t.controlBox.getElement().contains(i);if(r&&i&&!e.isDrag&&!t.isMoveableElement(i)&&!o){var a=n.contains(i);as(t,"onClick",rs(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:a}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(n&&r&&!e.isDrag&&!t.isMoveableElement(r)&&e.datas.inputTarget!==r){var i=t.props.targets,o=i.indexOf(r),a=o>-1,s=!1;-1===o&&(s=(o=Tr(i,(function(t){return t.contains(r)})))>-1),as(t,"onClickGroup",rs(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:o,isTarget:a,containsTarget:s,moveableTarget:i[o]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Qu(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),ko(ko({},t),{datas:e})}var tc=Io("edgeDraggable",{css:[".edge.edgeDraggable.line {\n    cursor: move;\n}"],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?zl(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,i=null===(n=e.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!i)&&(!r.draggable&&Vr(i,xa("direction"))&&Vr(i,xa("edge"))&&Vr(i,xa("edgeDraggable")))},dragStart:function(t,e){return Bl.dragStart(t,Qu(e))},drag:function(t,e){return Bl.drag(t,Qu(e))},dragEnd:function(t,e){return Bl.dragEnd(t,Qu(e))},dragGroupCondition:function(t,e){var n,r=t.props,i=null===(n=e.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!i)&&(!r.draggable&&Vr(i,xa("direction"))&&Vr(i,xa("line")))},dragGroupStart:function(t,e){return Bl.dragGroupStart(t,Qu(e))},dragGroup:function(t,e){return Bl.dragGroup(t,Qu(e))},dragGroupEnd:function(t,e){return Bl.dragGroupEnd(t,Qu(e))},unset:function(t){return Bl.unset(t)}}),ec={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},nc=[Ou,fu,Ll,Ps,Bl,tc,Ul,Jl,eu,$l,hu,pu,uu,Lu,Mu,zu,Ku,ec,Ju,lu,Fu],rc=nc.reduce((function(t,e){return ko(ko({},t),"events"in e?e.events:{})}),{}),ic=nc.reduce((function(t,e){return ko(ko({},t),e.props)}),{}),oc=xs(rc);Object.keys(oc),Object.keys(ic);function ac(t,e){var n=t[0],r=t[1],i=t[2];return(n*e[0]+r*e[1]+i)/Math.sqrt(n*n+r*r)}function sc(t,e){var n=t[0],r=t[1];return-n*e[0]-r*e[1]}function lc(t,e){return Math.max.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.max(n[e],r[e],i[e],o[e])})))}function uc(t,e){return Math.min.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.min(n[e],r[e],i[e],o[e])})))}function cc(t,e){var n=e.map((function(e){if(gr(e)){var n=cc(t,e),r=n.length;return r>1?n:1===r?n[0]:null}var i=Pr(t,(function(t){return t.manager.props.target===e}));return i?(i.finded=!0,i.manager):null})).filter(Boolean);return 1===n.length&&gr(n[0])?n[0]:n}var hc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new Di,e.moveables=[],e.transformOrigin="50% 50%",e.renderGroupRects=[],e._targetGroups=[],e._hasFirstTargets=!1,e}Eo(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this)},n.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},n.getTargets=function(){return this.props.targets},n.updateRect=function(t,e,n){var r;void 0===n&&(n=!0);var i=this.state;if(this.controlBox&&!i.isPersisted){this.moveables.forEach((function(e){e.updateRect(t,!1,!1)}));var o=this.props,a=this.moveables,s=i.target||o.target,l=a.map((function(t){return{finded:!1,manager:t}})),u=this.props.targetGroups||[],c=cc(l,u);c.push.apply(c,l.filter((function(t){return!t.finded})).map((function(t){return t.manager})));var h=[],f=!e||""!==t&&o.updateGroup,p=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var d=null===(r=this.props.persistData)||void 0===r?void 0:r.rotation;null!=d&&(p=d)}var m=function t(e,n,r){var i=e.map((function(e){if(gr(e)){var r=t(e,n),i=[r.pos1,r.pos2,r.pos3,r.pos4];return h.push(r),{poses:i,rotation:r.rotation}}return{poses:Qa(e.state),rotation:e.getRotation()}})),o=i.map((function(t){return t.rotation})),a=0,s=o[0],l=o.every((function(t){return Math.abs(s-t)<.1}));a=f?l?s:p:!r&&l?s:n;var u=i.map((function(t){return t.poses})),c=function(t,e){var n,r=[0,0],i=[0,0],o=[0,0],a=[0,0],s=0,l=0;if(!t.length)return{pos1:r,pos2:i,pos3:o,pos4:a,minX:0,minY:0,maxX:0,maxY:0,width:s,height:l,rotation:e};var u=jr(e,Oo);if(u%90){var c=u/180*Math.PI,h=Math.tan(c),f=-1/h,p=[Bo,jo],d=[[0,0],[0,0]],m=[Bo,jo],g=[[0,0],[0,0]];t.forEach((function(t){t.forEach((function(t){var e=ac([-h,1,0],t),n=ac([-f,1,0],t);p[0]>e&&(d[0]=t,p[0]=e),p[1]<e&&(d[1]=t,p[1]=e),m[0]>n&&(g[0]=t,m[0]=n),m[1]<n&&(g[1]=t,m[1]=n)}))}));var v=d[0],y=d[1],_=g[0],x=g[1],b=[-h,1,sc([-h,1],v)],w=[-h,1,sc([-h,1],y)],S=[-f,1,sc([-f,1],_)],E=[-f,1,sc([-f,1],x)];r=(n=[[b,S],[b,E],[w,S],[w,E]].map((function(t){return Vi(t[0],t[1])[0]})))[0],i=n[1],o=n[2],a=n[3],s=m[1]-m[0],l=p[1]-p[0]}else{var k,C=uc(t,0),I=uc(t,1),T=lc(t,0),P=lc(t,1);r=[C,I],i=[T,I],o=[C,P],a=[T,P],s=T-C,l=P-I,u%180&&(r=(k=[o,r,a,i])[0],i=k[1],o=k[2],a=k[3],s=P-I,l=T-C)}u%360>180&&(r=(k=[a,o,i,r])[0],i=k[1],o=k[2],a=k[3]);var A=Bi([r,i,o,a]);return{pos1:r,pos2:i,pos3:o,pos4:a,width:s,height:l,minX:A.minX,minY:A.minY,maxX:A.maxX,maxY:A.maxY,rotation:e}}(u,a);return c}(c,this.rotation,!0);f&&(this.rotation=m.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=u,this.renderGroupRects=h;var g=this.transformOrigin,v=this.rotation,y=this.scale,_=m.width,x=m.height,b=m.minX,w=m.minY,S=function(t,e,n){var r=t.map((function(t){return ii(t,e)})),i=r.map((function(t){return fi(t,n)}));return{prev:r,next:i,result:i.map((function(t){return ri(t,e)}))}}([[0,0],[_,0],[0,x],[_,x]],Is(g,_,x),this.rotation/180*Math.PI),E=Bi(S.result),k=E.minX,C=E.minY,I=" rotate(".concat(v,"deg)")+" scale(".concat(y[0]>=0?1:-1,", ").concat(y[1]>=0?1:-1,")"),T="translate(".concat(-k,"px, ").concat(-C,"px)").concat(I);this.controlBox.getElement().style.transform="translate3d(".concat(b,"px, ").concat(w,"px, ").concat(this.props.translateZ||0,")"),s.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(g,";")+"width:".concat(_,"px;height:").concat(x,"px;")+"transform: ".concat(T),i.width=_,i.height=x;var P=this.getContainer(),A=Hu(this.controlBox.getElement(),s,this.controlBox.getElement(),this.getContainer(),this._rootContainer||P,[]),M=[A.left,A.top],L=Qa(A),R=L[0],D=L[1],N=L[2],z=L[3],O=Bi([R,D,N,z]),F=[O.minX,O.minY],B=y[0]*y[1]>0?1:-1;A.pos1=ii(R,F),A.pos2=ii(D,F),A.pos3=ii(N,F),A.pos4=ii(z,F),A.left=b-A.left+F[0],A.top=w-A.top+F[1],A.origin=ii(ri(M,A.origin),F),A.beforeOrigin=ii(ri(M,A.beforeOrigin),F),A.originalBeforeOrigin=ri(M,A.originalBeforeOrigin),A.transformOrigin=ii(ri(M,A.transformOrigin),F),s.style.transform="translate(".concat(-k-F[0],"px, ").concat(-C-F[1],"px)")+I,this.updateState(ko(ko({},A),{posDelta:F,direction:B,beforeDirection:B}),n)}},n.getRect=function(){return ko(ko({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.triggerEvent=function(e,n,r){if(r||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n);this._emitter.trigger(e,n)},n.updateAbles=function(){t.prototype.updateAbles.call(this,Co(Co([],this.props.ables,!0),[Ku],!1),"Group")},n._updateTargets=function(){t.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},n._updateEvents=function(){var t=this.state,e=this.props,n=this._prevTarget,r=e.dragTarget||this.areaElement;n!==r&&(ts(this,"targetGesto"),ts(this,"controlGesto"),t.target=null),t.target||(t.target=this.areaElement,this.controlBox.getElement().style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=Uu(this,r,"Group")),this.controlGesto||(this.controlGesto=Vu(this,this.controlBox.getElement(),"controlAbles","GroupControl")));var i=!us(t.container,e.container);i&&(t.container=e.container);var o=e.targets,a=this.differ.update(o),s=a.added,l=a.changed,u=a.removed,c=s.length||u.length;(i||c||l.length||o.length&&!Ts(this._targetGroups,e.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!c},n._updateObserver=function(){},e.defaultProps=ko(ko({},$u.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}($u),fc=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveables=[],t}Eo(n,e);var r=n.prototype;return r.render=function(){var e,n=this,r=this.props,i=r.cspNonce,o=r.cssStyled,a=r.persistData,s=r.targets||[],l=s.length,u=this.isUnmounted||!l,c=null!==(e=null===a||void 0===a?void 0:a.children)&&void 0!==e?e:[];return u&&!l&&c.length?s=c.map((function(){return null})):u||(c=[]),t.createElement(o,{cspNonce:i,ref:ar(this,"controlBox"),className:xa("control-box")},s.map((function(e,r){return t.createElement($u,ko({key:"moveable"+r,ref:sr(n,"moveables",r)},n.props,{target:e,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:c[r]}))})))},r.componentDidUpdate=function(){},r.getTargets=function(){return this.props.targets},r.updateRect=function(t,e,n){void 0===n&&(n=!0),this.moveables.forEach((function(r){r.updateRect(t,e,n)}))},r.getRect=function(){return ko(ko({},e.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},r.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},r.dragStart=function(){return this},r.hitTest=function(){return 0},r.isInside=function(){return!1},r.isDragging=function(){return!1},r.updateRenderPoses=function(){},r.checkUpdate=function(){},r.triggerEvent=function(){},r.updateAbles=function(){},r._updateEvents=function(){},r._updateObserver=function(){},n}($u);function pc(t,e){var n=[];return t.forEach((function(t){t&&(vr(t)?e[t]&&n.push.apply(n,e[t]):gr(t)?n.push.apply(n,pc(t,e)):n.push(t))})),n}function dc(t,e){var n=[];return t.forEach((function(t){t&&(vr(t)?e[t]&&n.push.apply(n,e[t]):gr(t)?n.push(dc(t,e)):n.push(t))})),n}function mc(t,e){return t.length!==e.length||t.some((function(t,n){var r=e[n];return!(!t&&!r)&&(t!=r&&(!gr(t)||!gr(r)||mc(t,r)))}))}t.PureComponent;var gc=6371008.8,vc={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:250826616.45599997,kilometers:6371.0088,kilometres:6371.0088,meters:gc,metres:gc,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:3440.069546436285,radians:1,yards:6967335.223679999};function yc(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function _c(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ic(t[0])||!Ic(t[1]))throw new Error("coordinates must contain numbers");return yc({type:"Point",coordinates:t},e,n)}function xc(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return yc({type:"Polygon",coordinates:t},e,n)}function bc(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return yc({type:"LineString",coordinates:t},e,n)}function wc(t,e,n){return void 0===n&&(n={}),yc({type:"MultiPoint",coordinates:t},e,n)}function Sc(t,e){void 0===e&&(e="kilometers");var n=vc[e];if(!n)throw new Error(e+" units is invalid");return t*n}function Ec(t,e){void 0===e&&(e="kilometers");var n=vc[e];if(!n)throw new Error(e+" units is invalid");return t/n}function kc(t){return 180*(t%(2*Math.PI))/Math.PI}function Cc(t){return t%360*Math.PI/180}function Ic(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Tc(t,e,n){if(null!==t)for(var r,i,o,a,s,l,u,c,h=0,f=0,p=t.type,d="FeatureCollection"===p,m="Feature"===p,g=d?t.features.length:1,v=0;v<g;v++){s=(c=!!(u=d?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<s;y++){var _=0,x=0;if(null!==(a=c?u.geometries[y]:u)){l=a.coordinates;var b=a.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(l,f,v,_,x))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],f,v,_,x))return!1;f++,"MultiPoint"===b&&_++}"LineString"===b&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(i=0;i<l[r].length-h;i++){if(!1===e(l[r][i],f,v,_,x))return!1;f++}"MultiLineString"===b&&_++,"Polygon"===b&&x++}"Polygon"===b&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(x=0,i=0;i<l[r].length;i++){for(o=0;o<l[r][i].length-h;o++){if(!1===e(l[r][i][o],f,v,_,x))return!1;f++}x++}_++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===Tc(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Pc(t,e){var n,r,i,o,a,s,l,u,c,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,m=p?t.features.length:1;for(n=0;n<m;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,u=p?t.features[n].properties:d?t.properties:{},c=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function Ac(t,e){Pc(t,(function(t,n,r,i,o){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(yc(t,r,{bbox:i,id:o}),n,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(yc({type:a,coordinates:u},r),n,l))return!1}}))}function Mc(t,e,n){var r=n,i=!1;return function(t,e){Ac(t,(function(t,n,r){var i=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,l=0,u=0;return!1!==Tc(t,(function(o,c,h,f,p){if(void 0===a||n>s||f>l||p>u)return a=o,s=n,l=f,u=p,void(i=0);var d=bc([a,o],t.properties);if(!1===e(d,n,r,p,i))return!1;i++,a=o}))&&void 0}}}))}(t,(function(t,o,a,s,l){r=!1===i&&void 0===n?t:e(r,t,o,a,s,l),i=!0})),r}function Lc(t){var e=[1/0,1/0,-1/0,-1/0];return Tc(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}Lc.default=Lc;var Rc=Lc;function Dc(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Nc(t){return"Feature"===t.type?t.geometry:t}n(1725);n(4161);function zc(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Dc(t),i=Nc(e),o=i.type,a=e.bbox,s=i.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===o&&(s=[s]);for(var l=!1,u=0;u<s.length&&!l;u++)if(Oc(r,s[u][0],n.ignoreBoundary)){for(var c=!1,h=1;h<s[u].length&&!c;)Oc(r,s[u][h],!n.ignoreBoundary)&&(c=!0),h++;c||(l=!0)}return l}function Oc(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],l=e[o][0],u=e[o][1];if(t[1]*(a-l)+s*(l-t[0])+u*(t[0]-a)===0&&(a-t[0])*(l-t[0])<=0&&(s-t[1])*(u-t[1])<=0)return!n;s>t[1]!==u>t[1]&&t[0]<(l-a)*(t[1]-s)/(u-s)+a&&(r=!r)}return r}var Fc=function(t,e,n){void 0===n&&(n={});var r=Dc(t),i=Dc(e),o=Cc(i[1]-r[1]),a=Cc(i[0]-r[0]),s=Cc(r[1]),l=Cc(i[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(l);return Sc(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),n.units)};Object.prototype.hasOwnProperty;var Bc=new ArrayBuffer(16);new Float64Array(Bc),new Uint32Array(Bc);n(1977);!function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],r=this.points[e+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){var i=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,a=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+a)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}t.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var i=this.pos(r);Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)+(i.z-n.z)*(i.z-n.z))>t&&(e.push(r),n=i)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n);return function(t,e,n,r,i){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:i.x*o[0]+r.x*o[1]+n.x*o[2]+e.x*o[3],y:i.y*o[0]+r.y*o[1]+n.y*o[2]+e.y*o[3],z:i.z*o[0]+r.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])}}();var jc=function(t){return function(t,e){void 0===e&&(e={});var n=Number(t[0]),r=Number(t[1]),i=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,r];return xc([[a,[i,r],[i,o],[n,o],a]],e.properties,{bbox:t,id:e.id})}(Rc(t))};function Uc(t,e,n,r){void 0===r&&(r={});var i=Dc(t),o=Cc(i[0]),a=Cc(i[1]),s=Cc(n),l=Ec(e,r.units),u=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(s));return _c([kc(o+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(u))),kc(u)],r.properties)}var Vc=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},o=[],a=0;a<r;a++)o.push(Uc(t,e,-360*a/r,n).geometry.coordinates);return o.push(o[0]),xc([o],i)};function Zc(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=Zc(e,t);return n=(n+180)%360}(t,e);var r=Dc(t),i=Dc(e),o=Cc(r[0]),a=Cc(i[0]),s=Cc(r[1]),l=Cc(i[1]),u=Math.sin(a-o)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return kc(Math.atan2(u,c))}n(7089);n(9234);function qc(t,e){return void 0===e&&(e={}),Mc(t,(function(t,n){var r=n.geometry.coordinates;return t+Fc(r[0],r[1],e)}),0)}var Gc=Math.PI/180,Wc=180/Math.PI,Xc=function(t,e){this.lon=t,this.lat=e,this.x=Gc*t,this.y=Gc*e};Xc.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Xc.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new Xc(e,t)};var Hc=function(){this.coords=[],this.length=0};Hc.prototype.move_to=function(t){this.length++,this.coords.push(t)};var Yc=function(t){this.properties=t||{},this.geometries=[]};Yc.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},Yc.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var $c=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Xc(t.x,t.y),this.end=new Xc(e.x,e.y),this.properties=n||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};$c.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),a=Wc*Math.atan2(o,Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));return[Wc*Math.atan2(i,r),a]},$c.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),i=0;i<t;++i){var o=r*i,a=this.interpolate(o);n.push(a)}for(var s=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,h=-180+u,f=360-u,p=1;p<n.length;++p){var d=n[p-1][0],m=n[p][0],g=Math.abs(m-d);g>f&&(m>c&&d<h||d>c&&m<h)?s=!0:g>l&&(l=g)}var v=[];if(s&&l<u){var y=[];v.push(y);for(var _=0;_<n.length;++_){var x=parseFloat(n[_][0]);if(_>0&&Math.abs(x-n[_-1][0])>f){var b=parseFloat(n[_-1][0]),w=parseFloat(n[_-1][1]),S=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(b>-180&&b<h&&180===S&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<h){y.push([-180,n[_][1]]),_++,y.push([n[_][0],n[_][1]]);continue}if(b>c&&b<180&&-180===S&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){y.push([180,n[_][1]]),_++,y.push([n[_][0],n[_][1]]);continue}if(b<h&&S>c){var k=b;b=S,S=k;var C=w;w=E,E=C}if(b>c&&S<h&&(S+=360),b<=180&&S>=180&&b<S){var I=(180-b)/(S-b),T=I*E+(1-I)*w;y.push([n[_-1][0]>c?180:-180,T]),(y=[]).push([n[_-1][0]>c?-180:180,T]),v.push(y)}else y=[],v.push(y);y.push([x,n[_][1]])}else y.push([n[_][0],n[_][1]])}}else{var P=[];v.push(P);for(var A=0;A<n.length;++A)P.push([n[A][0],n[A][1]])}for(var M=new Yc(this.properties),L=0;L<v.length;++L){var R=new Hc;M.geometries.push(R);for(var D=v[L],N=0;N<D.length;++N)R.move_to(D[N])}return M};function Kc(t){var e=t%360;return e<0&&(e+=360),e}n(4058);var Jc=[],Qc=[],th=[],eh=[],nh=[],rh=[],ih=[],oh=[],ah=[],sh=[],lh=[],uh=[],ch=[],hh=[],fh=[],ph=[],dh=[],mh=[],gh=[],vh=[],yh=[],_h=[],xh=[],bh=[];ih[85]=sh[85]=-1,oh[85]=lh[85]=0,ah[85]=uh[85]=1,gh[85]=_h[85]=1,vh[85]=xh[85]=0,yh[85]=bh[85]=1,Jc[85]=eh[85]=0,Qc[85]=nh[85]=-1,th[85]=fh[85]=0,ph[85]=ch[85]=0,dh[85]=hh[85]=1,rh[85]=mh[85]=1,_h[1]=_h[169]=0,xh[1]=xh[169]=-1,bh[1]=bh[169]=0,ch[1]=ch[169]=-1,hh[1]=hh[169]=0,fh[1]=fh[169]=0,sh[4]=sh[166]=0,lh[4]=lh[166]=-1,uh[4]=uh[166]=1,ph[4]=ph[166]=1,dh[4]=dh[166]=0,mh[4]=mh[166]=0,ih[16]=ih[154]=0,oh[16]=oh[154]=1,ah[16]=ah[154]=1,eh[16]=eh[154]=1,nh[16]=nh[154]=0,rh[16]=rh[154]=1,gh[64]=gh[106]=0,vh[64]=vh[106]=1,yh[64]=yh[106]=0,Jc[64]=Jc[106]=-1,Qc[64]=Qc[106]=0,th[64]=th[106]=1,gh[2]=gh[168]=0,vh[2]=vh[168]=-1,yh[2]=yh[168]=1,_h[2]=_h[168]=0,xh[2]=xh[168]=-1,bh[2]=bh[168]=0,ch[2]=ch[168]=-1,hh[2]=hh[168]=0,fh[2]=fh[168]=0,ph[2]=ph[168]=-1,dh[2]=dh[168]=0,mh[2]=mh[168]=1,ih[8]=ih[162]=0,oh[8]=oh[162]=-1,ah[8]=ah[162]=0,sh[8]=sh[162]=0,lh[8]=lh[162]=-1,uh[8]=uh[162]=1,ch[8]=ch[162]=1,hh[8]=hh[162]=0,fh[8]=fh[162]=1,ph[8]=ph[162]=1,dh[8]=dh[162]=0,mh[8]=mh[162]=0,ih[32]=ih[138]=0,oh[32]=oh[138]=1,ah[32]=ah[138]=1,sh[32]=sh[138]=0,lh[32]=lh[138]=1,uh[32]=uh[138]=0,Jc[32]=Jc[138]=1,Qc[32]=Qc[138]=0,th[32]=th[138]=0,eh[32]=eh[138]=1,nh[32]=nh[138]=0,rh[32]=rh[138]=1,_h[128]=_h[42]=0,xh[128]=xh[42]=1,bh[128]=bh[42]=1,gh[128]=gh[42]=0,vh[128]=vh[42]=1,yh[128]=yh[42]=0,Jc[128]=Jc[42]=-1,Qc[128]=Qc[42]=0,th[128]=th[42]=1,eh[128]=eh[42]=-1,nh[128]=nh[42]=0,rh[128]=rh[42]=0,sh[5]=sh[165]=-1,lh[5]=lh[165]=0,uh[5]=uh[165]=0,_h[5]=_h[165]=1,xh[5]=xh[165]=0,bh[5]=bh[165]=0,ph[20]=ph[150]=0,dh[20]=dh[150]=1,mh[20]=mh[150]=1,eh[20]=eh[150]=0,nh[20]=nh[150]=-1,rh[20]=rh[150]=1,ih[80]=ih[90]=-1,oh[80]=oh[90]=0,ah[80]=ah[90]=1,gh[80]=gh[90]=1,vh[80]=vh[90]=0,yh[80]=yh[90]=1,ch[65]=ch[105]=0,hh[65]=hh[105]=1,fh[65]=fh[105]=0,Jc[65]=Jc[105]=0,Qc[65]=Qc[105]=-1,th[65]=th[105]=0,ih[160]=ih[10]=-1,oh[160]=oh[10]=0,ah[160]=ah[10]=1,sh[160]=sh[10]=-1,lh[160]=lh[10]=0,uh[160]=uh[10]=0,_h[160]=_h[10]=1,xh[160]=xh[10]=0,bh[160]=bh[10]=0,gh[160]=gh[10]=1,vh[160]=vh[10]=0,yh[160]=yh[10]=1,ph[130]=ph[40]=0,dh[130]=dh[40]=1,mh[130]=mh[40]=1,ch[130]=ch[40]=0,hh[130]=hh[40]=1,fh[130]=fh[40]=0,Jc[130]=Jc[40]=0,Qc[130]=Qc[40]=-1,th[130]=th[40]=0,eh[130]=eh[40]=0,nh[130]=nh[40]=-1,rh[130]=rh[40]=1,sh[37]=sh[133]=0,lh[37]=lh[133]=1,uh[37]=uh[133]=1,_h[37]=_h[133]=0,xh[37]=xh[133]=1,bh[37]=bh[133]=0,Jc[37]=Jc[133]=-1,Qc[37]=Qc[133]=0,th[37]=th[133]=0,eh[37]=eh[133]=1,nh[37]=nh[133]=0,rh[37]=rh[133]=0,ph[148]=ph[22]=-1,dh[148]=dh[22]=0,mh[148]=mh[22]=0,_h[148]=_h[22]=0,xh[148]=xh[22]=-1,bh[148]=bh[22]=1,gh[148]=gh[22]=0,vh[148]=vh[22]=1,yh[148]=yh[22]=1,eh[148]=eh[22]=-1,nh[148]=nh[22]=0,rh[148]=rh[22]=1,ih[82]=ih[88]=0,oh[82]=oh[88]=-1,ah[82]=ah[88]=1,ph[82]=ph[88]=1,dh[82]=dh[88]=0,mh[82]=mh[88]=1,ch[82]=ch[88]=-1,hh[82]=hh[88]=0,fh[82]=fh[88]=1,gh[82]=gh[88]=0,vh[82]=vh[88]=-1,yh[82]=yh[88]=0,ih[73]=ih[97]=0,oh[73]=oh[97]=1,ah[73]=ah[97]=0,sh[73]=sh[97]=0,lh[73]=lh[97]=-1,uh[73]=uh[97]=0,ch[73]=ch[97]=1,hh[73]=hh[97]=0,fh[73]=fh[97]=0,Jc[73]=Jc[97]=1,Qc[73]=Qc[97]=0,th[73]=th[97]=1,ih[145]=ih[25]=0,oh[145]=oh[25]=-1,ah[145]=ah[25]=0,ch[145]=ch[25]=1,hh[145]=hh[25]=0,fh[145]=fh[25]=1,_h[145]=_h[25]=0,xh[145]=xh[25]=1,bh[145]=bh[25]=1,eh[145]=eh[25]=-1,nh[145]=nh[25]=0,rh[145]=rh[25]=0,sh[70]=sh[100]=0,lh[70]=lh[100]=1,uh[70]=uh[100]=0,ph[70]=ph[100]=-1,dh[70]=dh[100]=0,mh[70]=mh[100]=1,gh[70]=gh[100]=0,vh[70]=vh[100]=-1,yh[70]=yh[100]=1,Jc[70]=Jc[100]=1,Qc[70]=Qc[100]=0,th[70]=th[100]=0,sh[101]=sh[69]=0,lh[101]=lh[69]=1,uh[101]=uh[69]=0,Jc[101]=Jc[69]=1,Qc[101]=Qc[69]=0,th[101]=th[69]=0,_h[149]=_h[21]=0,xh[149]=xh[21]=1,bh[149]=bh[21]=1,eh[149]=eh[21]=-1,nh[149]=nh[21]=0,rh[149]=rh[21]=0,ph[86]=ph[84]=-1,dh[86]=dh[84]=0,mh[86]=mh[84]=1,gh[86]=gh[84]=0,vh[86]=vh[84]=-1,yh[86]=yh[84]=1,ih[89]=ih[81]=0,oh[89]=oh[81]=-1,ah[89]=ah[81]=0,ch[89]=ch[81]=1,hh[89]=hh[81]=0,fh[89]=fh[81]=1,ih[96]=ih[74]=0,oh[96]=oh[74]=1,ah[96]=ah[74]=0,sh[96]=sh[74]=-1,lh[96]=lh[74]=0,uh[96]=uh[74]=1,gh[96]=gh[74]=1,vh[96]=vh[74]=0,yh[96]=yh[74]=0,Jc[96]=Jc[74]=1,Qc[96]=Qc[74]=0,th[96]=th[74]=1,ih[24]=ih[146]=0,oh[24]=oh[146]=-1,ah[24]=ah[146]=1,ph[24]=ph[146]=1,dh[24]=dh[146]=0,mh[24]=mh[146]=1,ch[24]=ch[146]=0,hh[24]=hh[146]=1,fh[24]=fh[146]=1,eh[24]=eh[146]=0,nh[24]=nh[146]=-1,rh[24]=rh[146]=0,sh[6]=sh[164]=-1,lh[6]=lh[164]=0,uh[6]=uh[164]=1,ph[6]=ph[164]=-1,dh[6]=dh[164]=0,mh[6]=mh[164]=0,_h[6]=_h[164]=0,xh[6]=xh[164]=-1,bh[6]=bh[164]=1,gh[6]=gh[164]=1,vh[6]=vh[164]=0,yh[6]=yh[164]=0,ch[129]=ch[41]=0,hh[129]=hh[41]=1,fh[129]=fh[41]=1,_h[129]=_h[41]=0,xh[129]=xh[41]=1,bh[129]=bh[41]=0,Jc[129]=Jc[41]=-1,Qc[129]=Qc[41]=0,th[129]=th[41]=0,eh[129]=eh[41]=0,nh[129]=nh[41]=-1,rh[129]=rh[41]=0,ph[66]=ph[104]=0,dh[66]=dh[104]=1,mh[66]=mh[104]=0,ch[66]=ch[104]=-1,hh[66]=hh[104]=0,fh[66]=fh[104]=1,gh[66]=gh[104]=0,vh[66]=vh[104]=-1,yh[66]=yh[104]=0,Jc[66]=Jc[104]=0,Qc[66]=Qc[104]=-1,th[66]=th[104]=1,ih[144]=ih[26]=-1,oh[144]=oh[26]=0,ah[144]=ah[26]=0,_h[144]=_h[26]=1,xh[144]=xh[26]=0,bh[144]=bh[26]=1,gh[144]=gh[26]=0,vh[144]=vh[26]=1,yh[144]=yh[26]=1,eh[144]=eh[26]=-1,nh[144]=nh[26]=0,rh[144]=rh[26]=1,sh[36]=sh[134]=0,lh[36]=lh[134]=1,uh[36]=uh[134]=1,ph[36]=ph[134]=0,dh[36]=dh[134]=1,mh[36]=mh[134]=0,Jc[36]=Jc[134]=0,Qc[36]=Qc[134]=-1,th[36]=th[134]=1,eh[36]=eh[134]=1,nh[36]=nh[134]=0,rh[36]=rh[134]=0,ih[9]=ih[161]=-1,oh[9]=oh[161]=0,ah[9]=ah[161]=0,sh[9]=sh[161]=0,lh[9]=lh[161]=-1,uh[9]=uh[161]=0,ch[9]=ch[161]=1,hh[9]=hh[161]=0,fh[9]=fh[161]=0,_h[9]=_h[161]=1,xh[9]=xh[161]=0,bh[9]=bh[161]=1,ih[136]=0,oh[136]=1,ah[136]=1,sh[136]=0,lh[136]=1,uh[136]=0,ph[136]=-1,dh[136]=0,mh[136]=1,ch[136]=-1,hh[136]=0,fh[136]=0,_h[136]=0,xh[136]=-1,bh[136]=0,gh[136]=0,vh[136]=-1,yh[136]=1,Jc[136]=1,Qc[136]=0,th[136]=0,eh[136]=1,nh[136]=0,rh[136]=1,ih[34]=0,oh[34]=-1,ah[34]=0,sh[34]=0,lh[34]=-1,uh[34]=1,ph[34]=1,dh[34]=0,mh[34]=0,ch[34]=1,hh[34]=0,fh[34]=1,_h[34]=0,xh[34]=1,bh[34]=1,gh[34]=0,vh[34]=1,yh[34]=0,Jc[34]=-1,Qc[34]=0,th[34]=1,eh[34]=-1,nh[34]=0,rh[34]=0,ih[35]=0,oh[35]=1,ah[35]=1,sh[35]=0,lh[35]=-1,uh[35]=1,ph[35]=1,dh[35]=0,mh[35]=0,ch[35]=-1,hh[35]=0,fh[35]=0,_h[35]=0,xh[35]=-1,bh[35]=0,gh[35]=0,vh[35]=1,yh[35]=0,Jc[35]=-1,Qc[35]=0,th[35]=1,eh[35]=1,nh[35]=0,rh[35]=1,ih[153]=0,oh[153]=1,ah[153]=1,ch[153]=-1,hh[153]=0,fh[153]=0,_h[153]=0,xh[153]=-1,bh[153]=0,eh[153]=1,nh[153]=0,rh[153]=1,sh[102]=0,lh[102]=-1,uh[102]=1,ph[102]=1,dh[102]=0,mh[102]=0,gh[102]=0,vh[102]=1,yh[102]=0,Jc[102]=-1,Qc[102]=0,th[102]=1,ih[155]=0,oh[155]=-1,ah[155]=0,ch[155]=1,hh[155]=0,fh[155]=1,_h[155]=0,xh[155]=1,bh[155]=1,eh[155]=-1,nh[155]=0,rh[155]=0,sh[103]=0,lh[103]=1,uh[103]=0,ph[103]=-1,dh[103]=0,mh[103]=1,gh[103]=0,vh[103]=-1,yh[103]=1,Jc[103]=1,Qc[103]=0,th[103]=0,ih[152]=0,oh[152]=1,ah[152]=1,ph[152]=-1,dh[152]=0,mh[152]=1,ch[152]=-1,hh[152]=0,fh[152]=0,_h[152]=0,xh[152]=-1,bh[152]=0,gh[152]=0,vh[152]=-1,yh[152]=1,eh[152]=1,nh[152]=0,rh[152]=1,ih[156]=0,oh[156]=-1,ah[156]=1,ph[156]=1,dh[156]=0,mh[156]=1,ch[156]=-1,hh[156]=0,fh[156]=0,_h[156]=0,xh[156]=-1,bh[156]=0,gh[156]=0,vh[156]=1,yh[156]=1,eh[156]=-1,nh[156]=0,rh[156]=1,ih[137]=0,oh[137]=1,ah[137]=1,sh[137]=0,lh[137]=1,uh[137]=0,ch[137]=-1,hh[137]=0,fh[137]=0,_h[137]=0,xh[137]=-1,bh[137]=0,Jc[137]=1,Qc[137]=0,th[137]=0,eh[137]=1,nh[137]=0,rh[137]=1,ih[139]=0,oh[139]=1,ah[139]=1,sh[139]=0,lh[139]=-1,uh[139]=0,ch[139]=1,hh[139]=0,fh[139]=0,_h[139]=0,xh[139]=1,bh[139]=0,Jc[139]=-1,Qc[139]=0,th[139]=0,eh[139]=1,nh[139]=0,rh[139]=1,ih[98]=0,oh[98]=-1,ah[98]=0,sh[98]=0,lh[98]=-1,uh[98]=1,ph[98]=1,dh[98]=0,mh[98]=0,ch[98]=1,hh[98]=0,fh[98]=1,gh[98]=0,vh[98]=1,yh[98]=0,Jc[98]=-1,Qc[98]=0,th[98]=1,ih[99]=0,oh[99]=1,ah[99]=0,sh[99]=0,lh[99]=-1,uh[99]=1,ph[99]=1,dh[99]=0,mh[99]=0,ch[99]=-1,hh[99]=0,fh[99]=1,gh[99]=0,vh[99]=-1,yh[99]=0,Jc[99]=1,Qc[99]=0,th[99]=1,sh[38]=0,lh[38]=-1,uh[38]=1,ph[38]=1,dh[38]=0,mh[38]=0,_h[38]=0,xh[38]=1,bh[38]=1,gh[38]=0,vh[38]=1,yh[38]=0,Jc[38]=-1,Qc[38]=0,th[38]=1,eh[38]=-1,nh[38]=0,rh[38]=0,sh[39]=0,lh[39]=1,uh[39]=1,ph[39]=-1,dh[39]=0,mh[39]=0,_h[39]=0,xh[39]=-1,bh[39]=1,gh[39]=0,vh[39]=1,yh[39]=0,Jc[39]=-1,Qc[39]=0,th[39]=1,eh[39]=1,nh[39]=0,rh[39]=0;var wh=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Sh=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},Eh=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},kh=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},Ch=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},Ih=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Th=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},Ph=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Ah=[],Mh=[],Lh=[],Rh=[],Dh=[],Nh=[],zh=[],Oh=[];Rh[1]=Dh[1]=18,Rh[169]=Dh[169]=18,Lh[4]=Mh[4]=12,Lh[166]=Mh[166]=12,Ah[16]=Oh[16]=4,Ah[154]=Oh[154]=4,Nh[64]=zh[64]=22,Nh[106]=zh[106]=22,Lh[2]=Nh[2]=17,Rh[2]=Dh[2]=18,Lh[168]=Nh[168]=17,Rh[168]=Dh[168]=18,Ah[8]=Rh[8]=9,Mh[8]=Lh[8]=12,Ah[162]=Rh[162]=9,Mh[162]=Lh[162]=12,Ah[32]=Oh[32]=4,Mh[32]=zh[32]=1,Ah[138]=Oh[138]=4,Mh[138]=zh[138]=1,Dh[128]=Oh[128]=21,Nh[128]=zh[128]=22,Dh[42]=Oh[42]=21,Nh[42]=zh[42]=22,Mh[5]=Dh[5]=14,Mh[165]=Dh[165]=14,Lh[20]=Oh[20]=6,Lh[150]=Oh[150]=6,Ah[80]=Nh[80]=11,Ah[90]=Nh[90]=11,Rh[65]=zh[65]=3,Rh[105]=zh[105]=3,Ah[160]=Nh[160]=11,Mh[160]=Dh[160]=14,Ah[10]=Nh[10]=11,Mh[10]=Dh[10]=14,Lh[130]=Oh[130]=6,Rh[130]=zh[130]=3,Lh[40]=Oh[40]=6,Rh[40]=zh[40]=3,Mh[101]=zh[101]=1,Mh[69]=zh[69]=1,Dh[149]=Oh[149]=21,Dh[21]=Oh[21]=21,Lh[86]=Nh[86]=17,Lh[84]=Nh[84]=17,Ah[89]=Rh[89]=9,Ah[81]=Rh[81]=9,Ah[96]=zh[96]=0,Mh[96]=Nh[96]=15,Ah[74]=zh[74]=0,Mh[74]=Nh[74]=15,Ah[24]=Lh[24]=8,Rh[24]=Oh[24]=7,Ah[146]=Lh[146]=8,Rh[146]=Oh[146]=7,Mh[6]=Nh[6]=15,Lh[6]=Dh[6]=16,Mh[164]=Nh[164]=15,Lh[164]=Dh[164]=16,Rh[129]=Oh[129]=7,Dh[129]=zh[129]=20,Rh[41]=Oh[41]=7,Dh[41]=zh[41]=20,Lh[66]=zh[66]=2,Rh[66]=Nh[66]=19,Lh[104]=zh[104]=2,Rh[104]=Nh[104]=19,Ah[144]=Dh[144]=10,Nh[144]=Oh[144]=23,Ah[26]=Dh[26]=10,Nh[26]=Oh[26]=23,Mh[36]=Oh[36]=5,Lh[36]=zh[36]=2,Mh[134]=Oh[134]=5,Lh[134]=zh[134]=2,Ah[9]=Dh[9]=10,Mh[9]=Rh[9]=13,Ah[161]=Dh[161]=10,Mh[161]=Rh[161]=13,Mh[37]=Oh[37]=5,Dh[37]=zh[37]=20,Mh[133]=Oh[133]=5,Dh[133]=zh[133]=20,Lh[148]=Dh[148]=16,Nh[148]=Oh[148]=23,Lh[22]=Dh[22]=16,Nh[22]=Oh[22]=23,Ah[82]=Lh[82]=8,Rh[82]=Nh[82]=19,Ah[88]=Lh[88]=8,Rh[88]=Nh[88]=19,Ah[73]=zh[73]=0,Mh[73]=Rh[73]=13,Ah[97]=zh[97]=0,Mh[97]=Rh[97]=13,Ah[145]=Rh[145]=9,Dh[145]=Oh[145]=21,Ah[25]=Rh[25]=9,Dh[25]=Oh[25]=21,Mh[70]=zh[70]=1,Lh[70]=Nh[70]=17,Mh[100]=zh[100]=1,Lh[100]=Nh[100]=17,Ah[34]=Rh[34]=9,Mh[34]=Lh[34]=12,Dh[34]=Oh[34]=21,Nh[34]=zh[34]=22,Ah[136]=Oh[136]=4,Mh[136]=zh[136]=1,Lh[136]=Nh[136]=17,Rh[136]=Dh[136]=18,Ah[35]=Oh[35]=4,Mh[35]=Lh[35]=12,Rh[35]=Dh[35]=18,Nh[35]=zh[35]=22,Ah[153]=Oh[153]=4,Rh[153]=Dh[153]=18,Mh[102]=Lh[102]=12,Nh[102]=zh[102]=22,Ah[155]=Rh[155]=9,Dh[155]=Oh[155]=23,Mh[103]=zh[103]=1,Lh[103]=Nh[103]=17,Ah[152]=Oh[152]=4,Lh[152]=Nh[152]=17,Rh[152]=Dh[152]=18,Ah[156]=Lh[156]=8,Rh[156]=Dh[156]=18,Nh[156]=Oh[156]=23,Ah[137]=Oh[137]=4,Mh[137]=zh[137]=1,Rh[137]=Dh[137]=18,Ah[139]=Oh[139]=4,Mh[139]=Rh[139]=13,Dh[139]=zh[139]=20,Ah[98]=Rh[98]=9,Mh[98]=Lh[98]=12,Nh[98]=zh[98]=22,Ah[99]=zh[99]=0,Mh[99]=Lh[99]=12,Rh[99]=Nh[99]=19,Mh[38]=Lh[38]=12,Dh[38]=Oh[38]=21,Nh[38]=zh[38]=22,Mh[39]=Oh[39]=5,Lh[39]=Dh[39]=16,Nh[39]=zh[39]=22;var Fh=[];Fh[1]=Fh[169]=wh,Fh[4]=Fh[166]=Sh,Fh[16]=Fh[154]=Eh,Fh[64]=Fh[106]=kh,Fh[168]=Fh[2]=Ch,Fh[162]=Fh[8]=Ih,Fh[138]=Fh[32]=Th,Fh[42]=Fh[128]=Ph,Fh[5]=Fh[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},Fh[20]=Fh[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},Fh[80]=Fh[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},Fh[65]=Fh[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Fh[160]=Fh[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},Fh[130]=Fh[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},Fh[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Fh[101]=Fh[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},Fh[149]=Fh[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},Fh[86]=Fh[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},Fh[89]=Fh[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},Fh[96]=Fh[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},Fh[24]=Fh[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},Fh[6]=Fh[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},Fh[129]=Fh[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},Fh[66]=Fh[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Fh[144]=Fh[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Fh[36]=Fh[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},Fh[9]=Fh[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Fh[37]=Fh[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Fh[148]=Fh[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Fh[82]=Fh[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},Fh[73]=Fh[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Fh[145]=Fh[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Fh[70]=Fh[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Fh[34]=function(t){return[Ph(t),Ih(t)]},Fh[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Fh[136]=function(t){return[Th(t),Ch(t)]},Fh[153]=function(t){return[Eh(t),wh(t)]},Fh[102]=function(t){return[Sh(t),kh(t)]},Fh[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Fh[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Fh[152]=function(t){return[Eh(t),Ch(t)]},Fh[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Fh[137]=function(t){return[Th(t),wh(t)]},Fh[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Fh[98]=function(t){return[Ih(t),kh(t)]},Fh[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Fh[38]=function(t){return[Sh(t),Ph(t)]},Fh[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};function Bh(t,e,n){var r=e[0]-t[0],i=e[1]-t[1],o=n[0]-e[0];return function(t){return(t>0)-(t<0)||+t}(r*(n[1]-e[1])-o*i)}function jh(t,e){return e.geometry.coordinates[0].every((function(e){return zc(_c(e),t)}))}var Uh=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var r=e.to,i=n.to;if(r.coordinates[0]-t.coordinates[0]>=0&&i.coordinates[0]-t.coordinates[0]<0)return 1;if(r.coordinates[0]-t.coordinates[0]<0&&i.coordinates[0]-t.coordinates[0]>=0)return-1;if(r.coordinates[0]-t.coordinates[0]===0&&i.coordinates[0]-t.coordinates[0]===0)return r.coordinates[1]-t.coordinates[1]>=0||i.coordinates[1]-t.coordinates[1]>=0?r.coordinates[1]-i.coordinates[1]:i.coordinates[1]-r.coordinates[1];var o=Bh(t.coordinates,r.coordinates,i.coordinates);return o<0?1:o>0?-1:Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2)-(Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),Vh=Uh,Zh=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return bc([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return Bh(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}(),qh=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,r){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=r),e}),0),n=(0===e?this.length:e)-1,r=(e+1)%this.length,i=Bh(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[r].from.coordinates);return 0===i?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:i>0},t.prototype.toMultiPoint=function(){return wc(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=xc([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=jc(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var n,r,i=t.getEnvelope();return e.forEach((function(e){var o=e.getEnvelope();if(r&&(n=r.getEnvelope()),!function(t,e){var n=t.geometry.coordinates[0].map((function(t){return t[0]})),r=t.geometry.coordinates[0].map((function(t){return t[1]})),i=e.geometry.coordinates[0].map((function(t){return t[0]})),o=e.geometry.coordinates[0].map((function(t){return t[1]}));return Math.max.apply(null,n)===Math.max.apply(null,i)&&Math.max.apply(null,r)===Math.max.apply(null,o)&&Math.min.apply(null,n)===Math.min.apply(null,i)&&Math.min.apply(null,r)===Math.min.apply(null,o)}(o,i)&&jh(o,i)){for(var a=t.map((function(t){return t.from.coordinates})),s=void 0,l=function(t){e.some((function(e){return n=t,r=e.from.coordinates,n[0]===r[0]&&n[1]===r[1];var n,r}))||(s=t)},u=0,c=a;u<c.length;u++){l(c[u])}s&&e.inside(_c(s))&&(r&&!jh(n,o)||(r=e))}})),r},t.prototype.inside=function(t){return zc(t,this.toPolygon())},t}(),Gh=qh;!function(){function t(){this.edges=[],this.nodes={}}t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return Ac(e,(function(t){!function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}(t,"LineString","Graph::fromGeoJson"),function(t,e,n,r){var i=n;Tc(t,(function(t,r,o,a,s){i=0===r&&void 0===n?t:e(i,t,r,o,a,s)}),r)}(t,(function(t,e){if(t){var r=n.getNode(t),i=n.getNode(e);n.addEdge(r,i)}return e}))})),n},t.prototype.getNode=function(t){var e=Vh.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new Vh(t)),n},t.prototype.addEdge=function(t,e){var n=new Zh(t,e),r=n.getSymetric();this.edges.push(n),this.edges.push(r)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;"undefined"===typeof t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var n,r,i=t.getOuterEdges(),o=i.length-1;o>=0;--o){var a=i[o],s=a.symetric,l=void 0,u=void 0;a.label===e&&(l=a),s.label===e&&(u=s),l&&u&&(u&&(r=u),l&&(r&&(r.next=l,r=void 0),n||(n=l)))}r&&(r.next=n)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var r=n;do{r.label=e,r=r.next}while(!n.isEqual(r));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],n=t,r=function(){var r=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++r})),r>1&&e.push(n.from),n=n.next};do{r()}while(!t.isEqual(n));return e},t.prototype._findEdgeRing=function(t){var e=t,n=new Gh;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()}}();n(4042);n(5107);n(6530);function Wh(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var Xh={search:function(t,e,n,r){t.cleanDirty();var i=(r=r||{}).heuristic||Xh.heuristics.manhattan,o=r.closest||!1,a=new $h((function(t){return t.f})),s=e;for(e.h=i(e,n),a.push(e);a.size()>0;){var l=a.pop();if(l===n)return Wh(l);l.closed=!0;for(var u=t.neighbors(l),c=0,h=u.length;c<h;++c){var f=u[c];if(!f.closed&&!f.isWall()){var p=l.g+f.getCost(l),d=f.visited;(!d||p<f.g)&&(f.visited=!0,f.parent=l,f.h=f.h||i(f,n),f.g=p,f.f=f.g+f.h,t.markDirty(f),o&&(f.h<s.h||f.h===s.h&&f.g<s.g)&&(s=f),d?a.rescoreElement(f):a.push(f))}}}return o?Wh(s):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return 1*(r+i)+(n-2)*Math.min(r,i)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function Hh(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var r=0,i=t[n];r<i.length;r++){var o=new Yh(n,r,i[r]);this.grid[n][r]=o,this.nodes.push(o)}}this.init()}function Yh(t,e,n){this.x=t,this.y=e,this.weight=n}function $h(t){this.content=[],this.scoreFunction=t}Hh.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Xh.cleanNode(this.nodes[t])},Hh.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Xh.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Hh.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Hh.prototype.neighbors=function(t){var e=[],n=t.x,r=t.y,i=this.grid;return i[n-1]&&i[n-1][r]&&e.push(i[n-1][r]),i[n+1]&&i[n+1][r]&&e.push(i[n+1][r]),i[n]&&i[n][r-1]&&e.push(i[n][r-1]),i[n]&&i[n][r+1]&&e.push(i[n][r+1]),this.diagonal&&(i[n-1]&&i[n-1][r-1]&&e.push(i[n-1][r-1]),i[n+1]&&i[n+1][r-1]&&e.push(i[n+1][r-1]),i[n-1]&&i[n-1][r+1]&&e.push(i[n-1][r+1]),i[n+1]&&i[n+1][r+1]&&e.push(i[n+1][r+1])),e},Hh.prototype.toString=function(){for(var t,e,n,r,i=[],o=this.grid,a=0,s=o.length;a<s;a++){for(t=[],n=0,r=(e=o[a]).length;n<r;n++)t.push(e[n].weight);i.push(t.join(" "))}return i.join("\n")},Yh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Yh.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Yh.prototype.isWall=function(){return 0===this.weight},$h.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i,o=t+1<<1,a=o-1,s=null;if(a<e){var l=this.content[a];(i=this.scoreFunction(l))<r&&(s=a)}if(o<e){var u=this.content[o];this.scoreFunction(u)<(null===s?r:i)&&(s=o)}if(null===s)break;this.content[t]=this.content[s],this.content[s]=n,t=s}}};function Kh(){this._=null}function Jh(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Qh(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function tf(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ef(t){for(;t.L;)t=t.L;return t}Kh.prototype={constructor:Kh,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ef(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Qh(this,n),n=(t=n).U),n.C=!1,r.C=!0,tf(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(tf(this,n),n=(t=n).U),n.C=!1,r.C=!0,Qh(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?ef(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Qh(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,tf(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Qh(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,tf(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Qh(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,tf(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var nf=Kh;function rf(t,e,n,r){var i=[null,null],o=Tf.push(i)-1;return i.left=t,i.right=e,n&&af(i,t,e,n),r&&af(i,e,t,r),Cf[t.index].halfedges.push(o),Cf[e.index].halfedges.push(o),i}function of(t,e,n){var r=[e,n];return r.left=t,r}function af(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function sf(t,e,n,r,i){var o,a=t[0],s=t[1],l=a[0],u=a[1],c=0,h=1,f=s[0]-l,p=s[1]-u;if(o=e-l,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*f,u+c*p]),h<1&&(t[1]=[l+h*f,u+h*p]),!0)}}}}}function lf(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,l=t[0],u=t.left,c=t.right,h=u[0],f=u[1],p=c[0],d=c[1],m=(h+p)/2,g=(f+d)/2;if(d===f){if(m<e||m>=r)return;if(h>p){if(l){if(l[1]>=i)return}else l=[m,n];o=[m,i]}else{if(l){if(l[1]<n)return}else l=[m,i];o=[m,n]}}else if(s=g-(a=(h-p)/(d-f))*m,a<-1||a>1)if(h>p){if(l){if(l[1]>=i)return}else l=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<d){if(l){if(l[0]>=r)return}else l=[e,a*e+s];o=[r,a*r+s]}else{if(l){if(l[0]<e)return}else l=[r,a*r+s];o=[e,a*e+s]}return t[0]=l,t[1]=o,!0}function uf(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function cf(t,e){return e[+(e.left!==t.site)]}function hf(t,e){return e[+(e.left===t.site)]}var ff,pf=[];function df(){Jh(this),this.x=this.y=this.arc=this.site=this.cy=null}function mf(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],l=r[0]-a,u=r[1]-s,c=o[0]-a,h=o[1]-s,f=2*(l*h-u*c);if(!(f>=-Af)){var p=l*l+u*u,d=c*c+h*h,m=(h*p-u*d)/f,g=(l*d-c*p)/f,v=pf.pop()||new df;v.arc=t,v.site=i,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,_=If._;_;)if(v.y<_.y||v.y===_.y&&v.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}If.insert(y,v),y||(ff=v)}}}}function gf(t){var e=t.circle;e&&(e.P||(ff=e.N),If.remove(e),pf.push(e),Jh(e),t.circle=null)}var vf=[];function yf(){Jh(this),this.edge=this.site=this.circle=null}function _f(t){var e=vf.pop()||new yf;return e.site=t,e}function xf(t){gf(t),kf.remove(t),vf.push(t),Jh(t)}function bf(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];xf(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<Pf&&Math.abs(r-l.circle.cy)<Pf;)o=l.P,s.unshift(l),xf(l),l=o;s.unshift(l),gf(l);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<Pf&&Math.abs(r-u.circle.cy)<Pf;)a=u.N,s.push(u),xf(u),u=a;s.push(u),gf(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],af(u.edge,l.site,u.site,i);l=s[0],(u=s[h-1]).edge=rf(l.site,u.site,null,i),mf(l),mf(u)}function wf(t){for(var e,n,r,i,o=t[0],a=t[1],s=kf._;s;)if((r=Sf(s,a)-o)>Pf)s=s.L;else{if(!((i=o-Ef(s,a))>Pf)){r>-Pf?(e=s.P,n=s):i>-Pf?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){Cf[t.index]={site:t,halfedges:[]}}(t);var l=_f(t);if(kf.insert(e,l),e||n){if(e===n)return gf(e),n=_f(e.site),kf.insert(l,n),l.edge=n.edge=rf(e.site,l.site),mf(e),void mf(n);if(n){gf(e),gf(n);var u=e.site,c=u[0],h=u[1],f=t[0]-c,p=t[1]-h,d=n.site,m=d[0]-c,g=d[1]-h,v=2*(f*g-p*m),y=f*f+p*p,_=m*m+g*g,x=[(g*y-p*_)/v+c,(f*_-m*y)/v+h];af(n.edge,u,d,x),l.edge=rf(u,t,null,x),n.edge=rf(t,d,null,x),mf(e),mf(n)}else l.edge=rf(e.site,l.site)}}function Sf(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],l=n[1],u=l-e;if(!u)return s;var c=s-r,h=1/o-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+i-o/2)))/h+r:(r+s)/2}function Ef(t,e){var n=t.N;if(n)return Sf(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var kf,Cf,If,Tf,Pf=1e-6,Af=1e-12;function Mf(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Lf(t,e){return e[1]-t[1]||e[0]-t[0]}function Rf(t,e){var n,r,i,o=t.sort(Lf).pop();for(Tf=[],Cf=new Array(t.length),kf=new nf,If=new nf;;)if(i=ff,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(wf(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;bf(i.arc)}if(function(){for(var t,e,n,r,i=0,o=Cf.length;i<o;++i)if((t=Cf[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=uf(t,Tf[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,o=Tf.length;o--;)lf(i=Tf[o],t,e,n,r)&&sf(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>Pf||Math.abs(i[0][1]-i[1][1])>Pf)||delete Tf[o]}(a,s,l,u),function(t,e,n,r){var i,o,a,s,l,u,c,h,f,p,d,m,g=Cf.length,v=!0;for(i=0;i<g;++i)if(o=Cf[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)Tf[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)d=(p=hf(o,Tf[l[s]]))[0],m=p[1],h=(c=cf(o,Tf[l[++s%u]]))[0],f=c[1],(Math.abs(d-h)>Pf||Math.abs(m-f)>Pf)&&(l.splice(s,0,Tf.push(of(a,p,Math.abs(d-t)<Pf&&r-m>Pf?[t,Math.abs(h-t)<Pf?f:r]:Math.abs(m-r)<Pf&&n-d>Pf?[Math.abs(f-r)<Pf?h:n,r]:Math.abs(d-n)<Pf&&m-e>Pf?[n,Math.abs(h-n)<Pf?f:e]:Math.abs(m-e)<Pf&&d-t>Pf?[Math.abs(f-e)<Pf?h:t,e]:null))-1),++u);u&&(v=!1)}if(v){var y,_,x,b=1/0;for(i=0,v=null;i<g;++i)(o=Cf[i])&&(x=(y=(a=o.site)[0]-t)*y+(_=a[1]-e)*_)<b&&(b=x,v=o);if(v){var w=[t,e],S=[t,r],E=[n,r],k=[n,e];v.halfedges.push(Tf.push(of(a=v.site,w,S))-1,Tf.push(of(a,S,E))-1,Tf.push(of(a,E,k))-1,Tf.push(of(a,k,w))-1)}}for(i=0;i<g;++i)(o=Cf[i])&&(o.halfedges.length||delete Cf[i])}(a,s,l,u)}this.edges=Tf,this.cells=Cf,kf=If=Tf=Cf=null}Rf.prototype={constructor:Rf,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return cf(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,l=-1,u=e[i[o-1]],c=u.left===s?u.right:u.left;++l<o;)a=c,c=(u=e[i[l]]).left===s?u.right:u.left,a&&c&&r<a.index&&r<c.index&&Mf(s,a,c)<0&&t.push([s.data,a.data,c.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,a=s.index)}}))}while(null!==a);return o._found=r,null==n||c<=n*n?i.site:null}};n(9056);n(4035);function Df(){return new Nf}function Nf(){this.reset()}Nf.prototype={constructor:Nf,reset:function(){this.s=this.t=0},add:function(t){Of(zf,t,this.t),Of(this,zf.s,this.s),this.s?this.t+=zf.t:this.s=zf.t},valueOf:function(){return this.s}};var zf=new Nf;function Of(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var Ff=1e-6,Bf=Math.PI,jf=Bf/2,Uf=Bf/4,Vf=2*Bf,Zf=Bf/180,qf=Math.abs,Gf=Math.atan,Wf=Math.atan2,Xf=Math.cos,Hf=(Math.ceil,Math.exp),Yf=(Math.floor,Math.log),$f=(Math.pow,Math.sin),Kf=(Math.sign,Math.sqrt),Jf=Math.tan;function Qf(t){return t>1?jf:t<-1?-jf:Math.asin(t)}function tp(){}Df(),Df();function ep(t){var e=t[0],n=t[1],r=Xf(n);return[r*Xf(e),r*$f(e),$f(n)]}function np(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function rp(t){var e=Kf(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}Df();function ip(t,e){return[t>Bf?t-Vf:t<-Bf?t+Vf:t,e]}function op(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ap(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!(t.length-1<=0)){var e,n,r=t[0],a=t[e];if(function(t,e){return qf(t[0]-e[0])<Ff&&qf(t[1]-e[1])<Ff}(r,a)){for(i.lineStart(),0;o<e;++o)i.point(t[o][0],r[1]);i.lineEnd()}else s.push(new op(r,t,null,!0)),l.push(n.o=new op(r,null,n,!1)),s.push(new op(a,t,null,!1)),l.push(n.o=new op(a,null,n,!0))}})),s.length){for(l.sort(e),sp(s),sp(l),0,l.length;o<a;++o)l[o].e=!n;for(var u,c,h=s[0];;){for(var f=h,p=!0;f.v;)if(f.n===h)return;f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(0,u.length;o<a;++o)i.point(u[o][0],c[1]);else r(f.x,f.n.x,1,i);f.n}else{if(p)for(f.p.z,u.length-1;o>=0;--o)i.point(u[o][0],c[1]);else r(f.x,f.p.x,-1,i);f.p}f.o.z,!p}while(!f.v);i.lineEnd()}}}function sp(t){if(t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=t[r],n.p=i,n;i.n=t[0],n.p=i}}function lp(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}ip.invert=ip;1===(up=lp).length&&(up=function(t){return function(e,n){return lp(t(e),n)}}(up));var up,cp=Array.prototype;cp.slice,cp.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var hp=Df();function fp(t,e){var n=e[0],r=e[1],i=[$f(n),-Xf(n),0],o=0,a=0;hp.reset();for(var s=0,l=t.length;s<l;++s)if(t[s].length)for(var u,c,h=u[c-1],f=h[0],p=h[1]/2+Uf,d=$f(p),m=Xf(p),g=0;g<c;y,x,b,v){var v=u[g],y=v[0],_=v[1]/2+Uf,x=$f(_),b=Xf(_),w=y-f,S=w>=0?1:-1,E=S*w,k=E>Bf,C=d*x;if(hp.add(Wf(C*S*$f(E),m*b+C*Xf(E))),k?w+S*Vf:w,k^f>=n^y>=n){var I=np(ep(h),ep(v));rp(I);var T=np(i,I);rp(T);var P=(k^w>=0?-1:1)*Qf(T[2]);(r>P||r===P&&(I[0]||I[1]))&&(k^w>=0?1:-1)}}return(o<-1e-6||o<Ff&&hp<-1e-6)^1&a}Df();Df(),Df();Df();function pp(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function dp(t){return t.length>1}function mp(t,e){return(t.x[0]<0?t[1]-jf-Ff:jf-t[1])-(e.x[0]<0?e[1]-jf-Ff:jf-e[1])}pp(4.5);function gp(t){return function(e){var n=new vp;for(var r in t)n[r]=t[r];return n.stream=e,n}}function vp(){}vp.prototype={constructor:vp,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};Xf(30*Zf);gp({point:function(t,e){this.stream.point(t*Zf,e*Zf)}});function yp(t){return function(e,n){var r=Xf(e),i=Xf(n),o=t(r*i);return[o*i*$f(e),o*$f(n)]}}function _p(t){return function(e,n){var r=Kf(e*e+n*n),i=t(r),o=$f(i),a=Xf(i);return[Wf(e*o,r*a),Qf(r&&n*o/r)]}}var xp=yp((function(t){return Kf(2/(1+t))}));xp.invert=_p((function(t){return 2*Qf(t/2)}));var bp=yp((function(t){return(t=function(t){return t>1?0:t<-1?Bf:Math.acos(t)}(t))&&t/$f(t)}));function wp(t,e){return[t,Yf(Jf((jf+e)/2))]}function Sp(t,e){return[t,e]}function Ep(t,e){var n=Xf(e),r=Xf(t)*n;return[n*$f(t)/r,$f(e)/r]}function kp(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Cp(t,e){return[Xf(e)*$f(t),$f(e)]}function Ip(t,e){var n=Xf(e),r=1+Xf(t)*n;return[n*$f(t)/r,$f(e)/r]}function Tp(t,e){return[Yf(Jf((jf+e)/2)),-t]}bp.invert=_p((function(t){return t})),wp.invert=function(t,e){return[t,2*Gf(Hf(e))-jf]},Sp.invert=Sp,Ep.invert=_p(Gf),kp.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(qf(n)>Ff&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},Cp.invert=_p(Qf),Ip.invert=_p((function(t){return 2*Gf(t)})),Tp.invert=function(t,e){return[-e,2*Gf(Hf(t))-jf]};var Pp=n(1048),Ap=n(2793),Mp=n(8182),Lp=n(4419),Rp=n(3736),Dp=n(7630);function Np(t){return null!=t&&!(Array.isArray(t)&&0===t.length)}function zp(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&(Np(t.value)&&""!==t.value||e&&Np(t.defaultValue)&&""!==t.defaultValue)}var Op=n(4036),Fp=n(9103);var Bp=t.createContext(void 0),jp=n(5878),Up=n(1217);function Vp(t){return(0,Up.Z)("MuiFormControl",t)}(0,jp.Z)("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);var Zp=n(184),qp=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Gp=(0,Dp.ZP)("div",{name:"MuiFormControl",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return(0,Ap.Z)({},e.root,e["margin".concat((0,Op.Z)(n.margin))],n.fullWidth&&e.fullWidth)}})((function(t){var e=t.ownerState;return(0,Ap.Z)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===e.margin&&{marginTop:16,marginBottom:8},"dense"===e.margin&&{marginTop:8,marginBottom:4},e.fullWidth&&{width:"100%"})})),Wp=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiFormControl"}),i=r.children,o=r.className,a=r.color,s=void 0===a?"primary":a,u=r.component,c=void 0===u?"div":u,h=r.disabled,f=void 0!==h&&h,p=r.error,d=void 0!==p&&p,m=r.focused,g=r.fullWidth,v=void 0!==g&&g,y=r.hiddenLabel,_=void 0!==y&&y,x=r.margin,b=void 0===x?"none":x,w=r.required,S=void 0!==w&&w,E=r.size,k=void 0===E?"medium":E,C=r.variant,I=void 0===C?"outlined":C,T=(0,Pp.Z)(r,qp),P=(0,Ap.Z)({},r,{color:s,component:c,disabled:f,error:d,fullWidth:v,hiddenLabel:_,margin:b,required:S,size:k,variant:I}),A=function(t){var e=t.classes,n=t.margin,r=t.fullWidth,i={root:["root","none"!==n&&"margin".concat((0,Op.Z)(n)),r&&"fullWidth"]};return(0,Lp.Z)(i,Vp,e)}(P),M=t.useState((function(){var e=!1;return i&&t.Children.forEach(i,(function(t){if((0,Fp.Z)(t,["Input","Select"])){var n=(0,Fp.Z)(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)}})),e})),L=(0,l.Z)(M,2),R=L[0],D=L[1],N=t.useState((function(){var e=!1;return i&&t.Children.forEach(i,(function(t){(0,Fp.Z)(t,["Input","Select"])&&zp(t.props,!0)&&(e=!0)})),e})),z=(0,l.Z)(N,2),O=z[0],F=z[1],B=t.useState(!1),j=(0,l.Z)(B,2),U=j[0],V=j[1];f&&U&&V(!1);var Z,q=void 0===m||f?U:m,G=t.useMemo((function(){return{adornedStart:R,setAdornedStart:D,color:s,disabled:f,error:d,filled:O,focused:q,fullWidth:v,hiddenLabel:_,size:k,onBlur:function(){V(!1)},onEmpty:function(){F(!1)},onFilled:function(){F(!0)},onFocus:function(){V(!0)},registerEffect:Z,required:S,variant:I}}),[R,s,f,d,O,q,v,_,Z,S,k,I]);return(0,Zp.jsx)(Bp.Provider,{value:G,children:(0,Zp.jsx)(Gp,(0,Ap.Z)({as:c,ownerState:P,className:(0,Mp.Z)(A.root,o),ref:n},T,{children:i}))})})),Xp=Wp;function Hp(t){var e=t.props,n=t.states,r=t.muiFormControl;return n.reduce((function(t,n){return t[n]=e[n],r&&"undefined"===typeof e[n]&&(t[n]=r[n]),t}),{})}function Yp(){return t.useContext(Bp)}function $p(t){return(0,Up.Z)("MuiFormLabel",t)}var Kp=(0,jp.Z)("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Jp=["children","className","color","component","disabled","error","filled","focused","required"],Qp=(0,Dp.ZP)("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return(0,Ap.Z)({},e.root,"secondary"===n.color&&e.colorSecondary,n.filled&&e.filled)}})((function(t){var e,n=t.theme,r=t.ownerState;return(0,Ap.Z)({color:(n.vars||n).palette.text.secondary},n.typography.body1,(e={lineHeight:"1.4375em",padding:0,position:"relative"},(0,s.Z)(e,"&.".concat(Kp.focused),{color:(n.vars||n).palette[r.color].main}),(0,s.Z)(e,"&.".concat(Kp.disabled),{color:(n.vars||n).palette.text.disabled}),(0,s.Z)(e,"&.".concat(Kp.error),{color:(n.vars||n).palette.error.main}),e))})),td=(0,Dp.ZP)("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:function(t,e){return e.asterisk}})((function(t){var e=t.theme;return(0,s.Z)({},"&.".concat(Kp.error),{color:(e.vars||e).palette.error.main})})),ed=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiFormLabel"}),r=n.children,i=n.className,o=n.component,a=void 0===o?"label":o,s=(0,Pp.Z)(n,Jp),l=Hp({props:n,muiFormControl:Yp(),states:["color","required","focused","disabled","error","filled"]}),u=(0,Ap.Z)({},n,{color:l.color||"primary",component:a,disabled:l.disabled,error:l.error,filled:l.filled,focused:l.focused,required:l.required}),c=function(t){var e=t.classes,n=t.color,r=t.focused,i=t.disabled,o=t.error,a=t.filled,s=t.required,l={root:["root","color".concat((0,Op.Z)(n)),i&&"disabled",o&&"error",a&&"filled",r&&"focused",s&&"required"],asterisk:["asterisk",o&&"error"]};return(0,Lp.Z)(l,$p,e)}(u);return(0,Zp.jsxs)(Qp,(0,Ap.Z)({as:a,ownerState:u,className:(0,Mp.Z)(c.root,i),ref:e},s,{children:[r,l.required&&(0,Zp.jsxs)(td,{ownerState:u,"aria-hidden":!0,className:c.asterisk,children:["\u2009","*"]})]}))})),nd=ed;function rd(t){return(0,Up.Z)("MuiInputLabel",t)}(0,jp.Z)("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);var id=["disableAnimation","margin","shrink","variant","className"],od=(0,Dp.ZP)(nd,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiInputLabel",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"& .".concat(Kp.asterisk),e.asterisk),e.root,n.formControl&&e.formControl,"small"===n.size&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,e[n.variant]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},"filled"===n.variant&&(0,Ap.Z)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&(0,Ap.Z)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&(0,Ap.Z)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 24px)",transform:"translate(14px, -9px) scale(0.75)"}))})),ad=t.forwardRef((function(t,e){var n=(0,Rp.Z)({name:"MuiInputLabel",props:t}),r=n.disableAnimation,i=void 0!==r&&r,o=n.shrink,a=n.className,s=(0,Pp.Z)(n,id),l=Yp(),u=o;"undefined"===typeof u&&l&&(u=l.filled||l.focused||l.adornedStart);var c=Hp({props:n,muiFormControl:l,states:["size","variant","required"]}),h=(0,Ap.Z)({},n,{disableAnimation:i,formControl:l,shrink:u,size:c.size,variant:c.variant,required:c.required}),f=function(t){var e=t.classes,n=t.formControl,r=t.size,i=t.shrink,o={root:["root",n&&"formControl",!t.disableAnimation&&"animated",i&&"shrink","small"===r&&"sizeSmall",t.variant],asterisk:[t.required&&"asterisk"]},a=(0,Lp.Z)(o,rd,e);return(0,Ap.Z)({},e,a)}(h);return(0,Zp.jsx)(od,(0,Ap.Z)({"data-shrink":u,ownerState:h,ref:e,className:(0,Mp.Z)(f.root,a)},s,{classes:f}))})),sd=ad,ld=n(2466),ud=n(6189),cd=(n(7441),n(8301));var hd=t.createContext({});function fd(t){return(0,Up.Z)("MuiList",t)}(0,jp.Z)("MuiList",["root","padding","dense","subheader"]);var pd=["children","className","component","dense","disablePadding","subheader"],dd=(0,Dp.ZP)("ul",{name:"MuiList",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0})})),md=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiList"}),i=r.children,o=r.className,a=r.component,s=void 0===a?"ul":a,l=r.dense,u=void 0!==l&&l,c=r.disablePadding,h=void 0!==c&&c,f=r.subheader,p=(0,Pp.Z)(r,pd),d=t.useMemo((function(){return{dense:u}}),[u]),m=(0,Ap.Z)({},r,{component:s,dense:u,disablePadding:h}),g=function(t){var e=t.classes,n={root:["root",!t.disablePadding&&"padding",t.dense&&"dense",t.subheader&&"subheader"]};return(0,Lp.Z)(n,fd,e)}(m);return(0,Zp.jsx)(hd.Provider,{value:d,children:(0,Zp.jsxs)(dd,(0,Ap.Z)({as:s,className:(0,Mp.Z)(g.root,o),ref:n,ownerState:m},p,{children:[f,i]}))})})),gd=md;function vd(t){var e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}var yd=vd,_d=n(2071),xd=n(162),bd=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function wd(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function Sd(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function Ed(t,e){if(void 0===e)return!0;var n=t.innerText;return void 0===n&&(n=t.textContent),0!==(n=n.trim().toLowerCase()).length&&(e.repeating?n[0]===e.keys[0]:0===n.indexOf(e.keys.join("")))}function kd(t,e,n,r,i,o){for(var a=!1,s=i(t,e,!!e&&n);s;){if(s===t.firstChild){if(a)return!1;a=!0}var l=!r&&(s.disabled||"true"===s.getAttribute("aria-disabled"));if(s.hasAttribute("tabindex")&&Ed(s,o)&&!l)return s.focus(),!0;s=i(t,s,n)}return!1}var Cd=t.forwardRef((function(e,n){var r=e.actions,i=e.autoFocus,o=void 0!==i&&i,a=e.autoFocusItem,s=void 0!==a&&a,l=e.children,u=e.className,c=e.disabledItemsFocusable,h=void 0!==c&&c,f=e.disableListWrap,p=void 0!==f&&f,d=e.onKeyDown,m=e.variant,g=void 0===m?"selectedMenu":m,v=(0,Pp.Z)(e,bd),y=t.useRef(null),_=t.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});(0,xd.Z)((function(){o&&y.current.focus()}),[o]),t.useImperativeHandle(r,(function(){return{adjustStyleForScrollbar:function(t,e){var n=!y.current.style.width;if(t.clientHeight<y.current.clientHeight&&n){var r="".concat(yd((0,cd.Z)(t)),"px");y.current.style["rtl"===e.direction?"paddingLeft":"paddingRight"]=r,y.current.style.width="calc(100% + ".concat(r,")")}return y.current}}}),[]);var x=(0,_d.Z)(y,n),b=-1;t.Children.forEach(l,(function(e,n){t.isValidElement(e)&&(e.props.disabled||("selectedMenu"===g&&e.props.selected||-1===b)&&(b=n))}));var w=t.Children.map(l,(function(e,n){if(n===b){var r={};return s&&(r.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===g&&(r.tabIndex=0),t.cloneElement(e,r)}return e}));return(0,Zp.jsx)(gd,(0,Ap.Z)({role:"menu",ref:x,className:u,onKeyDown:function(t){var e=y.current,n=t.key,r=(0,cd.Z)(e).activeElement;if("ArrowDown"===n)t.preventDefault(),kd(e,r,p,h,wd);else if("ArrowUp"===n)t.preventDefault(),kd(e,r,p,h,Sd);else if("Home"===n)t.preventDefault(),kd(e,null,p,h,wd);else if("End"===n)t.preventDefault(),kd(e,null,p,h,Sd);else if(1===n.length){var i=_.current,o=n.toLowerCase(),a=performance.now();i.keys.length>0&&(a-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&o!==i.keys[0]&&(i.repeating=!1)),i.lastTime=a,i.keys.push(o);var s=r&&!i.repeating&&Ed(r,i);i.previousKeyMatched&&(s||kd(e,r,!1,h,wd,i))?t.preventDefault():i.previousKeyMatched=!1}d&&d(t)},tabIndex:o?0:-1},v,{children:w}))})),Id=Cd,Td=n(2065),Pd=function(t){return((t<1?5.11916*Math.pow(t,2):4.5*Math.log(t+1)+2)/100).toFixed(2)};function Ad(t){return(0,Up.Z)("MuiPaper",t)}(0,jp.Z)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);var Md=["className","component","elevation","square","variant"],Ld=(0,Dp.ZP)("div",{name:"MuiPaper",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.variant],!n.square&&e.rounded,"elevation"===n.variant&&e["elevation".concat(n.elevation)]]}})((function(t){var e,n=t.theme,r=t.ownerState;return(0,Ap.Z)({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!r.square&&{borderRadius:n.shape.borderRadius},"outlined"===r.variant&&{border:"1px solid ".concat((n.vars||n).palette.divider)},"elevation"===r.variant&&(0,Ap.Z)({boxShadow:(n.vars||n).shadows[r.elevation]},!n.vars&&"dark"===n.palette.mode&&{backgroundImage:"linear-gradient(".concat((0,Td.Fq)("#fff",Pd(r.elevation)),", ").concat((0,Td.Fq)("#fff",Pd(r.elevation)),")")},n.vars&&{backgroundImage:null==(e=n.vars.overlays)?void 0:e[r.elevation]}))})),Rd=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiPaper"}),r=n.className,i=n.component,o=void 0===i?"div":i,a=n.elevation,s=void 0===a?1:a,l=n.square,u=void 0!==l&&l,c=n.variant,h=void 0===c?"elevation":c,f=(0,Pp.Z)(n,Md),p=(0,Ap.Z)({},n,{component:o,elevation:s,square:u,variant:h}),d=function(t){var e=t.square,n=t.elevation,r=t.variant,i=t.classes,o={root:["root",r,!e&&"rounded","elevation"===r&&"elevation".concat(n)]};return(0,Lp.Z)(o,Ad,i)}(p);return(0,Zp.jsx)(Ld,(0,Ap.Z)({as:o,ownerState:p,className:(0,Mp.Z)(d.root,r),ref:e},f))})),Dd=Rd,Nd=n(3199),zd=n(7602);function Od(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var Fd=n(9611);function Bd(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,(0,Fd.Z)(t,e)}var jd=!1,Ud=t.createContext(null),Vd="unmounted",Zd="exited",qd="entering",Gd="entered",Wd="exiting",Xd=function(e){function n(t,n){var r;r=e.call(this,t,n)||this;var i,o=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(i=Zd,r.appearStatus=qd):i=Gd:i=t.unmountOnExit||t.mountOnEnter?Vd:Zd,r.state={status:i},r.nextCallback=null,r}Bd(n,e),n.getDerivedStateFromProps=function(t,e){return t.in&&e.status===Vd?{status:Zd}:null};var i=n.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(t){var e=null;if(t!==this.props){var n=this.state.status;this.props.in?n!==qd&&n!==Gd&&(e=qd):n!==qd&&n!==Gd||(e=Wd)}this.updateStatus(!1,e)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var t,e,n,r=this.props.timeout;return t=e=n=r,null!=r&&"number"!==typeof r&&(t=r.exit,e=r.enter,n=void 0!==r.appear?r.appear:e),{exit:t,enter:e,appear:n}},i.updateStatus=function(t,e){if(void 0===t&&(t=!1),null!==e)if(this.cancelNextCallback(),e===qd){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:r.findDOMNode(this);n&&function(t){t.scrollTop}(n)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Zd&&this.setState({status:Vd})},i.performEnter=function(t){var e=this,n=this.props.enter,i=this.context?this.context.isMounting:t,o=this.props.nodeRef?[i]:[r.findDOMNode(this),i],a=o[0],s=o[1],l=this.getTimeouts(),u=i?l.appear:l.enter;!t&&!n||jd?this.safeSetState({status:Gd},(function(){e.props.onEntered(a)})):(this.props.onEnter(a,s),this.safeSetState({status:qd},(function(){e.props.onEntering(a,s),e.onTransitionEnd(u,(function(){e.safeSetState({status:Gd},(function(){e.props.onEntered(a,s)}))}))})))},i.performExit=function(){var t=this,e=this.props.exit,n=this.getTimeouts(),i=this.props.nodeRef?void 0:r.findDOMNode(this);e&&!jd?(this.props.onExit(i),this.safeSetState({status:Wd},(function(){t.props.onExiting(i),t.onTransitionEnd(n.exit,(function(){t.safeSetState({status:Zd},(function(){t.props.onExited(i)}))}))}))):this.safeSetState({status:Zd},(function(){t.props.onExited(i)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},i.setNextCallback=function(t){var e=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,e.nextCallback=null,t(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},i.onTransitionEnd=function(t,e){this.setNextCallback(e);var n=this.props.nodeRef?this.props.nodeRef.current:r.findDOMNode(this),i=null==t&&!this.props.addEndListener;if(n&&!i){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=o[0],s=o[1];this.props.addEndListener(a,s)}null!=t&&setTimeout(this.nextCallback,t)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===Vd)return null;var n=this.props,r=n.children,i=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,Od(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(Ud.Provider,{value:null},"function"===typeof r?r(e,i):t.cloneElement(t.Children.only(r),i))},n}(t.Component);function Hd(){}Xd.contextType=Ud,Xd.propTypes={},Xd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Hd,onEntering:Hd,onEntered:Hd,onExit:Hd,onExiting:Hd,onExited:Hd},Xd.UNMOUNTED=Vd,Xd.EXITED=Zd,Xd.ENTERING=qd,Xd.ENTERED=Gd,Xd.EXITING=Wd;var Yd=Xd,$d=n(418),Kd=n(6482);function Jd(){return(0,$d.Z)(Kd.Z)}var Qd=function(t){return t.scrollTop};function tm(t,e){var n,r,i=t.timeout,o=t.easing,a=t.style,s=void 0===a?{}:a;return{duration:null!=(n=s.transitionDuration)?n:"number"===typeof i?i:i[e.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"===typeof o?o[e.mode]:o,delay:s.transitionDelay}}var em=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function nm(t){return"scale(".concat(t,", ").concat(Math.pow(t,2),")")}var rm={entering:{opacity:1,transform:nm(1)},entered:{opacity:1,transform:"none"}},im="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),om=t.forwardRef((function(e,n){var r=e.addEndListener,i=e.appear,o=void 0===i||i,a=e.children,s=e.easing,l=e.in,u=e.onEnter,c=e.onEntered,h=e.onEntering,f=e.onExit,p=e.onExited,d=e.onExiting,m=e.style,g=e.timeout,v=void 0===g?"auto":g,y=e.TransitionComponent,_=void 0===y?Yd:y,x=(0,Pp.Z)(e,em),b=t.useRef(),w=t.useRef(),S=Jd(),E=t.useRef(null),k=(0,_d.Z)(E,a.ref,n),C=function(t){return function(e){if(t){var n=E.current;void 0===e?t(n):t(n,e)}}},I=C(h),T=C((function(t,e){Qd(t);var n,r=tm({style:m,timeout:v,easing:s},{mode:"enter"}),i=r.duration,o=r.delay,a=r.easing;"auto"===v?(n=S.transitions.getAutoHeightDuration(t.clientHeight),w.current=n):n=i,t.style.transition=[S.transitions.create("opacity",{duration:n,delay:o}),S.transitions.create("transform",{duration:im?n:.666*n,delay:o,easing:a})].join(","),u&&u(t,e)})),P=C(c),A=C(d),M=C((function(t){var e,n=tm({style:m,timeout:v,easing:s},{mode:"exit"}),r=n.duration,i=n.delay,o=n.easing;"auto"===v?(e=S.transitions.getAutoHeightDuration(t.clientHeight),w.current=e):e=r,t.style.transition=[S.transitions.create("opacity",{duration:e,delay:i}),S.transitions.create("transform",{duration:im?e:.666*e,delay:im?i:i||.333*e,easing:o})].join(","),t.style.opacity=0,t.style.transform=nm(.75),f&&f(t)})),L=C(p);return t.useEffect((function(){return function(){clearTimeout(b.current)}}),[]),(0,Zp.jsx)(_,(0,Ap.Z)({appear:o,in:l,nodeRef:E,onEnter:T,onEntered:P,onEntering:I,onExit:M,onExited:L,onExiting:A,addEndListener:function(t){"auto"===v&&(b.current=setTimeout(t,w.current||0)),r&&r(E.current,t)},timeout:"auto"===v?null:v},x,{children:function(e,n){return t.cloneElement(a,(0,Ap.Z)({style:(0,Ap.Z)({opacity:0,transform:nm(.75),visibility:"exited"!==e||l?void 0:"hidden"},rm[e],m,a.props.style),ref:k},n))}}))}));om.muiSupportAuto=!0;var am=om;function sm(){return sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sm.apply(this,arguments)}function lm(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var um=n(7563),cm=n(9723),hm=n(8956),fm=n(8949),pm=n(5721),dm=n(2971);var mm=t.forwardRef((function(e,n){var i=e.children,o=e.container,a=e.disablePortal,s=void 0!==a&&a,u=t.useState(null),c=(0,l.Z)(u,2),h=c[0],f=c[1],p=(0,um.Z)(t.isValidElement(i)?i.ref:null,n);return(0,pm.Z)((function(){s||f(function(t){return"function"===typeof t?t():t}(o)||document.body)}),[o,s]),(0,pm.Z)((function(){if(h&&!s)return(0,dm.Z)(n,h),function(){(0,dm.Z)(n,null)}}),[n,h,s]),s?t.isValidElement(i)?t.cloneElement(i,{ref:p}):i:(0,Zp.jsx)(t.Fragment,{children:h?r.createPortal(i,h):h})}));var gm=mm,vm=n(5671),ym=n(3144),_m=n(7979);function xm(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function bm(t){return parseInt((0,_m.Z)(t).getComputedStyle(t).paddingRight,10)||0}function wm(t,e,n,r,i){var o=[e,n].concat((0,a.Z)(r));[].forEach.call(t.children,(function(t){var e=-1===o.indexOf(t),n=!function(t){var e=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName),n="INPUT"===t.tagName&&"hidden"===t.getAttribute("type");return e||n}(t);e&&n&&xm(t,i)}))}function Sm(t,e){var n=-1;return t.some((function(t,r){return!!e(t)&&(n=r,!0)})),n}function Em(t,e){var n=[],r=t.container;if(!e.disableScrollLock){if(function(t){var e=(0,cm.Z)(t);return e.body===t?(0,_m.Z)(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}(r)){var i=vd((0,cm.Z)(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight="".concat(bm(r)+i,"px");var o=(0,cm.Z)(r).querySelectorAll(".mui-fixed");[].forEach.call(o,(function(t){n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight="".concat(bm(t)+i,"px")}))}var a;if(r.parentNode instanceof DocumentFragment)a=(0,cm.Z)(r).body;else{var s=r.parentElement,l=(0,_m.Z)(r);a="HTML"===(null==s?void 0:s.nodeName)&&"scroll"===l.getComputedStyle(s).overflowY?s:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return function(){n.forEach((function(t){var e=t.value,n=t.el,r=t.property;e?n.style.setProperty(r,e):n.style.removeProperty(r)}))}}var km=function(){function t(){(0,vm.Z)(this,t),this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}return(0,ym.Z)(t,[{key:"add",value:function(t,e){var n=this.modals.indexOf(t);if(-1!==n)return n;n=this.modals.length,this.modals.push(t),t.modalRef&&xm(t.modalRef,!1);var r=function(t){var e=[];return[].forEach.call(t.children,(function(t){"true"===t.getAttribute("aria-hidden")&&e.push(t)})),e}(e);wm(e,t.mount,t.modalRef,r,!0);var i=Sm(this.containers,(function(t){return t.container===e}));return-1!==i?(this.containers[i].modals.push(t),n):(this.containers.push({modals:[t],container:e,restore:null,hiddenSiblings:r}),n)}},{key:"mount",value:function(t,e){var n=Sm(this.containers,(function(e){return-1!==e.modals.indexOf(t)})),r=this.containers[n];r.restore||(r.restore=Em(r,e))}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.modals.indexOf(t);if(-1===n)return n;var r=Sm(this.containers,(function(e){return-1!==e.modals.indexOf(t)})),i=this.containers[r];if(i.modals.splice(i.modals.indexOf(t),1),this.modals.splice(n,1),0===i.modals.length)i.restore&&i.restore(),t.modalRef&&xm(t.modalRef,e),wm(i.container,t.mount,t.modalRef,i.hiddenSiblings,!1),this.containers.splice(r,1);else{var o=i.modals[i.modals.length-1];o.modalRef&&xm(o.modalRef,!1)}return n}},{key:"isTopModal",value:function(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}]),t}(),Cm=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Im(t){var e=[],n=[];return Array.from(t.querySelectorAll(Cm)).forEach((function(t,r){var i=function(t){var e=parseInt(t.getAttribute("tabindex"),10);return Number.isNaN(e)?"true"===t.contentEditable||("AUDIO"===t.nodeName||"VIDEO"===t.nodeName||"DETAILS"===t.nodeName)&&null===t.getAttribute("tabindex")?0:t.tabIndex:e}(t);-1!==i&&function(t){return!(t.disabled||"INPUT"===t.tagName&&"hidden"===t.type||function(t){if("INPUT"!==t.tagName||"radio"!==t.type)return!1;if(!t.name)return!1;var e=function(e){return t.ownerDocument.querySelector('input[type="radio"]'.concat(e))},n=e('[name="'.concat(t.name,'"]:checked'));return n||(n=e('[name="'.concat(t.name,'"]'))),n!==t}(t))}(t)&&(0===i?e.push(t):n.push({documentOrder:r,tabIndex:i,node:t}))})),n.sort((function(t,e){return t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex})).map((function(t){return t.node})).concat(e)}function Tm(){return!0}var Pm=function(e){var n=e.children,r=e.disableAutoFocus,i=void 0!==r&&r,o=e.disableEnforceFocus,a=void 0!==o&&o,s=e.disableRestoreFocus,l=void 0!==s&&s,u=e.getTabbable,c=void 0===u?Im:u,h=e.isEnabled,f=void 0===h?Tm:h,p=e.open,d=t.useRef(),m=t.useRef(null),g=t.useRef(null),v=t.useRef(null),y=t.useRef(null),_=t.useRef(!1),x=t.useRef(null),b=(0,um.Z)(n.ref,x),w=t.useRef(null);t.useEffect((function(){p&&x.current&&(_.current=!i)}),[i,p]),t.useEffect((function(){if(p&&x.current){var t=(0,cm.Z)(x.current);return x.current.contains(t.activeElement)||(x.current.hasAttribute("tabIndex")||x.current.setAttribute("tabIndex",-1),_.current&&x.current.focus()),function(){l||(v.current&&v.current.focus&&(d.current=!0,v.current.focus()),v.current=null)}}}),[p]),t.useEffect((function(){if(p&&x.current){var t=(0,cm.Z)(x.current),e=function(e){var n=x.current;if(null!==n)if(t.hasFocus()&&!a&&f()&&!d.current){if(!n.contains(t.activeElement)){if(e&&y.current!==e.target||t.activeElement!==y.current)y.current=null;else if(null!==y.current)return;if(!_.current)return;var r=[];if(t.activeElement!==m.current&&t.activeElement!==g.current||(r=c(x.current)),r.length>0){var i,o,s=Boolean((null==(i=w.current)?void 0:i.shiftKey)&&"Tab"===(null==(o=w.current)?void 0:o.key)),l=r[0],u=r[r.length-1];s?u.focus():l.focus()}else n.focus()}}else d.current=!1},n=function(e){w.current=e,!a&&f()&&"Tab"===e.key&&t.activeElement===x.current&&e.shiftKey&&(d.current=!0,g.current.focus())};t.addEventListener("focusin",e),t.addEventListener("keydown",n,!0);var r=setInterval((function(){"BODY"===t.activeElement.tagName&&e()}),50);return function(){clearInterval(r),t.removeEventListener("focusin",e),t.removeEventListener("keydown",n,!0)}}}),[i,a,l,f,p,c]);var S=function(t){null===v.current&&(v.current=t.relatedTarget),_.current=!0};return(0,Zp.jsxs)(t.Fragment,{children:[(0,Zp.jsx)("div",{tabIndex:p?0:-1,onFocus:S,ref:m,"data-testid":"sentinelStart"}),t.cloneElement(n,{ref:b,onFocus:function(t){null===v.current&&(v.current=t.relatedTarget),_.current=!0,y.current=t.target;var e=n.props.onFocus;e&&e(t)}}),(0,Zp.jsx)("div",{tabIndex:p?0:-1,onFocus:S,ref:g,"data-testid":"sentinelEnd"})]})};function Am(t){return(0,Up.Z)("MuiModal",t)}(0,jp.Z)("MuiModal",["root","hidden"]);var Mm=function(t){return"string"===typeof t};function Lm(t){if(void 0===t)return{};var e={};return Object.keys(t).filter((function(e){return!(e.match(/^on[A-Z]/)&&"function"===typeof t[e])})).forEach((function(n){e[n]=t[n]})),e}function Rm(t){var e=t.getSlotProps,n=t.additionalProps,r=t.externalSlotProps,i=t.externalForwardedProps,o=t.className;if(!e){var a=(0,Mp.Z)(null==i?void 0:i.className,null==r?void 0:r.className,o,null==n?void 0:n.className),s=sm({},null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),l=sm({},n,i,r);return a.length>0&&(l.className=a),Object.keys(s).length>0&&(l.style=s),{props:l,internalRef:void 0}}var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===t)return{};var n={};return Object.keys(t).filter((function(n){return n.match(/^on[A-Z]/)&&"function"===typeof t[n]&&!e.includes(n)})).forEach((function(e){n[e]=t[e]})),n}(sm({},i,r)),c=Lm(r),h=Lm(i),f=e(u),p=(0,Mp.Z)(null==f?void 0:f.className,null==n?void 0:n.className,o,null==i?void 0:i.className,null==r?void 0:r.className),d=sm({},null==f?void 0:f.style,null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),m=sm({},f,n,h,c);return p.length>0&&(m.className=p),Object.keys(d).length>0&&(m.style=d),{props:m,internalRef:f.ref}}function Dm(t,e){return"function"===typeof t?t(e):t}var Nm=["elementType","externalSlotProps","ownerState"];function zm(t){var e,n=t.elementType,r=t.externalSlotProps,i=t.ownerState,o=lm(t,Nm),a=Dm(r,i),s=Rm(sm({},o,{externalSlotProps:a})),l=s.props,u=s.internalRef,c=function(t,e,n){return void 0===t||Mm(t)?e:sm({},e,{ownerState:sm({},e.ownerState,n)})}(n,sm({},l,{ref:(0,um.Z)(u,null==a?void 0:a.ref,null==(e=t.additionalProps)?void 0:e.ref)}),i);return c}var Om=["children","classes","closeAfterTransition","component","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","onTransitionEnter","onTransitionExited","slotProps","slots"];var Fm=new km,Bm=t.forwardRef((function(e,n){var r,i,o=e.children,a=e.classes,s=e.closeAfterTransition,u=void 0!==s&&s,c=e.component,h=e.container,f=e.disableAutoFocus,p=void 0!==f&&f,d=e.disableEnforceFocus,m=void 0!==d&&d,g=e.disableEscapeKeyDown,v=void 0!==g&&g,y=e.disablePortal,_=void 0!==y&&y,x=e.disableRestoreFocus,b=void 0!==x&&x,w=e.disableScrollLock,S=void 0!==w&&w,E=e.hideBackdrop,k=void 0!==E&&E,C=e.keepMounted,I=void 0!==C&&C,T=e.manager,P=void 0===T?Fm:T,A=e.onBackdropClick,M=e.onClose,L=e.onKeyDown,R=e.open,D=e.onTransitionEnter,N=e.onTransitionExited,z=e.slotProps,O=void 0===z?{}:z,F=e.slots,B=void 0===F?{}:F,j=lm(e,Om),U=t.useState(!R),V=(0,l.Z)(U,2),Z=V[0],q=V[1],G=t.useRef({}),W=t.useRef(null),X=t.useRef(null),H=(0,um.Z)(X,n),Y=function(t){return!!t.children&&t.children.props.hasOwnProperty("in")}(e),$=null==(r=e["aria-hidden"])||r,K=function(){return G.current.modalRef=X.current,G.current.mountNode=W.current,G.current},J=function(){P.mount(K(),{disableScrollLock:S}),X.current.scrollTop=0},Q=(0,hm.Z)((function(){var t=function(t){return"function"===typeof t?t():t}(h)||(0,cm.Z)(W.current).body;P.add(K(),t),X.current&&J()})),tt=t.useCallback((function(){return P.isTopModal(K())}),[P]),et=(0,hm.Z)((function(t){W.current=t,t&&(R&&tt()?J():xm(X.current,$))})),nt=t.useCallback((function(){P.remove(K(),$)}),[P,$]);t.useEffect((function(){return function(){nt()}}),[nt]),t.useEffect((function(){R?Q():Y&&u||nt()}),[R,nt,Y,u,Q]);var rt=sm({},e,{classes:a,closeAfterTransition:u,disableAutoFocus:p,disableEnforceFocus:m,disableEscapeKeyDown:v,disablePortal:_,disableRestoreFocus:b,disableScrollLock:S,exited:Z,hideBackdrop:k,keepMounted:I}),it=function(t){var e=t.open,n=t.exited,r=t.classes,i={root:["root",!e&&n&&"hidden"]};return(0,Lp.Z)(i,Am,r)}(rt),ot={};void 0===o.props.tabIndex&&(ot.tabIndex="-1"),Y&&(ot.onEnter=(0,fm.Z)((function(){q(!1),D&&D()}),o.props.onEnter),ot.onExited=(0,fm.Z)((function(){q(!0),N&&N(),u&&nt()}),o.props.onExited));var at=null!=(i=null!=c?c:B.root)?i:"div",st=zm({elementType:at,externalSlotProps:O.root,externalForwardedProps:j,additionalProps:{ref:H,role:"presentation",onKeyDown:function(t){L&&L(t),"Escape"===t.key&&tt()&&(v||(t.stopPropagation(),M&&M(t,"escapeKeyDown")))}},className:it.root,ownerState:rt}),lt=B.backdrop,ut=zm({elementType:lt,externalSlotProps:O.backdrop,additionalProps:{"aria-hidden":!0,onClick:function(t){t.target===t.currentTarget&&(A&&A(t),M&&M(t,"backdropClick"))},open:R},className:it.backdrop,ownerState:rt});return I||R||Y&&!Z?(0,Zp.jsx)(gm,{ref:et,container:h,disablePortal:_,children:(0,Zp.jsxs)(at,sm({},st,{children:[!k&&lt?(0,Zp.jsx)(lt,sm({},ut)):null,(0,Zp.jsx)(Pm,{disableEnforceFocus:m,disableAutoFocus:p,disableRestoreFocus:b,isEnabled:tt,open:R,children:t.cloneElement(o,ot)})]}))}):null})),jm=Bm,Um=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Vm={entering:{opacity:1},entered:{opacity:1}},Zm=t.forwardRef((function(e,n){var r=Jd(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},o=e.addEndListener,a=e.appear,s=void 0===a||a,l=e.children,u=e.easing,c=e.in,h=e.onEnter,f=e.onEntered,p=e.onEntering,d=e.onExit,m=e.onExited,g=e.onExiting,v=e.style,y=e.timeout,_=void 0===y?i:y,x=e.TransitionComponent,b=void 0===x?Yd:x,w=(0,Pp.Z)(e,Um),S=t.useRef(null),E=(0,_d.Z)(S,l.ref,n),k=function(t){return function(e){if(t){var n=S.current;void 0===e?t(n):t(n,e)}}},C=k(p),I=k((function(t,e){Qd(t);var n=tm({style:v,timeout:_,easing:u},{mode:"enter"});t.style.webkitTransition=r.transitions.create("opacity",n),t.style.transition=r.transitions.create("opacity",n),h&&h(t,e)})),T=k(f),P=k(g),A=k((function(t){var e=tm({style:v,timeout:_,easing:u},{mode:"exit"});t.style.webkitTransition=r.transitions.create("opacity",e),t.style.transition=r.transitions.create("opacity",e),d&&d(t)})),M=k(m);return(0,Zp.jsx)(b,(0,Ap.Z)({appear:s,in:c,nodeRef:S,onEnter:I,onEntered:T,onEntering:C,onExit:A,onExited:M,onExiting:P,addEndListener:function(t){o&&o(S.current,t)},timeout:_},w,{children:function(e,n){return t.cloneElement(l,(0,Ap.Z)({style:(0,Ap.Z)({opacity:0,visibility:"exited"!==e||c?void 0:"hidden"},Vm[e],v,l.props.style),ref:E},n))}}))})),qm=Zm;function Gm(t){return(0,Up.Z)("MuiBackdrop",t)}(0,jp.Z)("MuiBackdrop",["root","invisible"]);var Wm=["children","component","components","componentsProps","className","invisible","open","slotProps","slots","transitionDuration","TransitionComponent"],Xm=(0,Dp.ZP)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.invisible&&e.invisible]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})})),Hm=t.forwardRef((function(t,e){var n,r,i,o=(0,Rp.Z)({props:t,name:"MuiBackdrop"}),a=o.children,s=o.component,l=void 0===s?"div":s,u=o.components,c=void 0===u?{}:u,h=o.componentsProps,f=void 0===h?{}:h,p=o.className,d=o.invisible,m=void 0!==d&&d,g=o.open,v=o.slotProps,y=void 0===v?{}:v,_=o.slots,x=void 0===_?{}:_,b=o.transitionDuration,w=o.TransitionComponent,S=void 0===w?qm:w,E=(0,Pp.Z)(o,Wm),k=(0,Ap.Z)({},o,{component:l,invisible:m}),C=function(t){var e=t.classes,n={root:["root",t.invisible&&"invisible"]};return(0,Lp.Z)(n,Gm,e)}(k),I=null!=(n=y.root)?n:f.root;return(0,Zp.jsx)(S,(0,Ap.Z)({in:g,timeout:b},E,{children:(0,Zp.jsx)(Xm,(0,Ap.Z)({"aria-hidden":!0},I,{as:null!=(r=null!=(i=x.root)?i:c.Root)?r:l,className:(0,Mp.Z)(C.root,p,null==I?void 0:I.className),ownerState:(0,Ap.Z)({},k,null==I?void 0:I.ownerState),classes:C,ref:e,children:a}))}))})),Ym=Hm,$m=["BackdropComponent","BackdropProps","closeAfterTransition","children","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","slotProps","slots","theme"],Km=(0,Dp.ZP)("div",{name:"MuiModal",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,!n.open&&n.exited&&e.hidden]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),Jm=(0,Dp.ZP)(Ym,{name:"MuiModal",slot:"Backdrop",overridesResolver:function(t,e){return e.backdrop}})({zIndex:-1}),Qm=t.forwardRef((function(e,n){var r,i,o,a,s,u,c=(0,Rp.Z)({name:"MuiModal",props:e}),h=c.BackdropComponent,f=void 0===h?Jm:h,p=c.BackdropProps,d=c.closeAfterTransition,m=void 0!==d&&d,g=c.children,v=c.component,y=c.components,_=void 0===y?{}:y,x=c.componentsProps,b=void 0===x?{}:x,w=c.disableAutoFocus,S=void 0!==w&&w,E=c.disableEnforceFocus,k=void 0!==E&&E,C=c.disableEscapeKeyDown,I=void 0!==C&&C,T=c.disablePortal,P=void 0!==T&&T,A=c.disableRestoreFocus,M=void 0!==A&&A,L=c.disableScrollLock,R=void 0!==L&&L,D=c.hideBackdrop,N=void 0!==D&&D,z=c.keepMounted,O=void 0!==z&&z,F=c.slotProps,B=c.slots,j=c.theme,U=(0,Pp.Z)(c,$m),V=t.useState(!0),Z=(0,l.Z)(V,2),q=Z[0],G=Z[1],W={closeAfterTransition:m,disableAutoFocus:S,disableEnforceFocus:k,disableEscapeKeyDown:I,disablePortal:P,disableRestoreFocus:M,disableScrollLock:R,hideBackdrop:N,keepMounted:O},X=(0,Ap.Z)({},c,W,{exited:q}),H=function(t){return t.classes}(X),Y=null!=(r=null!=(i=null==B?void 0:B.root)?i:_.Root)?r:Km,$=null!=(o=null!=(a=null==B?void 0:B.backdrop)?a:_.Backdrop)?o:f,K=null!=(s=null==F?void 0:F.root)?s:b.root,J=null!=(u=null==F?void 0:F.backdrop)?u:b.backdrop;return(0,Zp.jsx)(jm,(0,Ap.Z)({slots:{root:Y,backdrop:$},slotProps:{root:function(){return(0,Ap.Z)({},Dm(K,X),!Mm(Y)&&{as:v,theme:j})},backdrop:function(){return(0,Ap.Z)({},p,Dm(J,X))}},onTransitionEnter:function(){return G(!1)},onTransitionExited:function(){return G(!0)},ref:n},U,{classes:H},W,{children:g}))})),tg=Qm;function eg(t){return(0,Up.Z)("MuiPopover",t)}(0,jp.Z)("MuiPopover",["root","paper"]);var ng=["onEntering"],rg=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"];function ig(t,e){var n=0;return"number"===typeof e?n=e:"center"===e?n=t.height/2:"bottom"===e&&(n=t.height),n}function og(t,e){var n=0;return"number"===typeof e?n=e:"center"===e?n=t.width/2:"right"===e&&(n=t.width),n}function ag(t){return[t.horizontal,t.vertical].map((function(t){return"number"===typeof t?"".concat(t,"px"):t})).join(" ")}function sg(t){return"function"===typeof t?t():t}var lg=(0,Dp.ZP)(tg,{name:"MuiPopover",slot:"Root",overridesResolver:function(t,e){return e.root}})({}),ug=(0,Dp.ZP)(Dd,{name:"MuiPopover",slot:"Paper",overridesResolver:function(t,e){return e.paper}})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),cg=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiPopover"}),i=r.action,o=r.anchorEl,a=r.anchorOrigin,s=void 0===a?{vertical:"top",horizontal:"left"}:a,u=r.anchorPosition,c=r.anchorReference,h=void 0===c?"anchorEl":c,f=r.children,p=r.className,d=r.container,m=r.elevation,g=void 0===m?8:m,v=r.marginThreshold,y=void 0===v?16:v,_=r.open,x=r.PaperProps,b=void 0===x?{}:x,w=r.transformOrigin,S=void 0===w?{vertical:"top",horizontal:"left"}:w,E=r.TransitionComponent,k=void 0===E?am:E,C=r.transitionDuration,I=void 0===C?"auto":C,T=r.TransitionProps,P=(T=void 0===T?{}:T).onEntering,A=(0,Pp.Z)(r.TransitionProps,ng),M=(0,Pp.Z)(r,rg),L=t.useRef(),R=(0,_d.Z)(L,b.ref),D=(0,Ap.Z)({},r,{anchorOrigin:s,anchorReference:h,elevation:g,marginThreshold:y,PaperProps:b,transformOrigin:S,TransitionComponent:k,transitionDuration:I,TransitionProps:A}),N=function(t){var e=t.classes;return(0,Lp.Z)({root:["root"],paper:["paper"]},eg,e)}(D),z=t.useCallback((function(){if("anchorPosition"===h)return u;var t=sg(o),e=(t&&1===t.nodeType?t:(0,cd.Z)(L.current).body).getBoundingClientRect();return{top:e.top+ig(e,s.vertical),left:e.left+og(e,s.horizontal)}}),[o,s.horizontal,s.vertical,u,h]),O=t.useCallback((function(t){return{vertical:ig(t,S.vertical),horizontal:og(t,S.horizontal)}}),[S.horizontal,S.vertical]),F=t.useCallback((function(t){var e={width:t.offsetWidth,height:t.offsetHeight},n=O(e);if("none"===h)return{top:null,left:null,transformOrigin:ag(n)};var r=z(),i=r.top-n.vertical,a=r.left-n.horizontal,s=i+e.height,l=a+e.width,u=(0,zd.Z)(sg(o)),c=u.innerHeight-y,f=u.innerWidth-y;if(i<y){var p=i-y;i-=p,n.vertical+=p}else if(s>c){var d=s-c;i-=d,n.vertical+=d}if(a<y){var m=a-y;a-=m,n.horizontal+=m}else if(l>f){var g=l-f;a-=g,n.horizontal+=g}return{top:"".concat(Math.round(i),"px"),left:"".concat(Math.round(a),"px"),transformOrigin:ag(n)}}),[o,h,z,O,y]),B=t.useState(_),j=(0,l.Z)(B,2),U=j[0],V=j[1],Z=t.useCallback((function(){var t=L.current;if(t){var e=F(t);null!==e.top&&(t.style.top=e.top),null!==e.left&&(t.style.left=e.left),t.style.transformOrigin=e.transformOrigin,V(!0)}}),[F]);t.useEffect((function(){_&&Z()})),t.useImperativeHandle(i,(function(){return _?{updatePosition:function(){Z()}}:null}),[_,Z]),t.useEffect((function(){if(_){var t=(0,Nd.Z)((function(){Z()})),e=(0,zd.Z)(o);return e.addEventListener("resize",t),function(){t.clear(),e.removeEventListener("resize",t)}}}),[o,_,Z]);var q=I;"auto"!==I||k.muiSupportAuto||(q=void 0);var G=d||(o?(0,cd.Z)(sg(o)).body:void 0);return(0,Zp.jsx)(lg,(0,Ap.Z)({BackdropProps:{invisible:!0},className:(0,Mp.Z)(N.root,p),container:G,open:_,ref:n,ownerState:D},M,{children:(0,Zp.jsx)(k,(0,Ap.Z)({appear:!0,in:_,onEntering:function(t,e){P&&P(t,e),Z()},onExited:function(){V(!1)},timeout:q},A,{children:(0,Zp.jsx)(ug,(0,Ap.Z)({elevation:g},b,{ref:R,className:(0,Mp.Z)(N.paper,b.className)},U?void 0:{style:(0,Ap.Z)({},b.style,{opacity:0})},{ownerState:D,children:f}))}))}))})),hg=cg;function fg(t){return(0,Up.Z)("MuiMenu",t)}(0,jp.Z)("MuiMenu",["root","paper","list"]);var pg=["onEntering"],dg=["autoFocus","children","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant"],mg={vertical:"top",horizontal:"right"},gg={vertical:"top",horizontal:"left"},vg=(0,Dp.ZP)(hg,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiMenu",slot:"Root",overridesResolver:function(t,e){return e.root}})({}),yg=(0,Dp.ZP)(Dd,{name:"MuiMenu",slot:"Paper",overridesResolver:function(t,e){return e.paper}})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),_g=(0,Dp.ZP)(Id,{name:"MuiMenu",slot:"List",overridesResolver:function(t,e){return e.list}})({outline:0}),xg=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiMenu"}),i=r.autoFocus,o=void 0===i||i,a=r.children,s=r.disableAutoFocusItem,l=void 0!==s&&s,u=r.MenuListProps,c=void 0===u?{}:u,h=r.onClose,f=r.open,p=r.PaperProps,d=void 0===p?{}:p,m=r.PopoverClasses,g=r.transitionDuration,v=void 0===g?"auto":g,y=r.TransitionProps,_=(y=void 0===y?{}:y).onEntering,x=r.variant,b=void 0===x?"selectedMenu":x,w=(0,Pp.Z)(r.TransitionProps,pg),S=(0,Pp.Z)(r,dg),E=Jd(),k="rtl"===E.direction,C=(0,Ap.Z)({},r,{autoFocus:o,disableAutoFocusItem:l,MenuListProps:c,onEntering:_,PaperProps:d,transitionDuration:v,TransitionProps:w,variant:b}),I=function(t){var e=t.classes;return(0,Lp.Z)({root:["root"],paper:["paper"],list:["list"]},fg,e)}(C),T=o&&!l&&f,P=t.useRef(null),A=-1;return t.Children.map(a,(function(e,n){t.isValidElement(e)&&(e.props.disabled||("selectedMenu"===b&&e.props.selected||-1===A)&&(A=n))})),(0,Zp.jsx)(vg,(0,Ap.Z)({onClose:h,anchorOrigin:{vertical:"bottom",horizontal:k?"right":"left"},transformOrigin:k?mg:gg,PaperProps:(0,Ap.Z)({component:yg},d,{classes:(0,Ap.Z)({},d.classes,{root:I.paper})}),className:I.root,open:f,ref:n,transitionDuration:v,TransitionProps:(0,Ap.Z)({onEntering:function(t,e){P.current&&P.current.adjustStyleForScrollbar(t,E),_&&_(t,e)}},w),ownerState:C},S,{classes:m,children:(0,Zp.jsx)(_g,(0,Ap.Z)({onKeyDown:function(t){"Tab"===t.key&&(t.preventDefault(),h&&h(t,"tabKeyDown"))},actions:P,autoFocus:o&&(-1===A||l),autoFocusItem:T,variant:b},c,{className:(0,Mp.Z)(I.list,c.className),children:a}))}))})),bg=xg;function wg(t){return(0,Up.Z)("MuiNativeSelect",t)}var Sg=(0,jp.Z)("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),Eg=["className","disabled","IconComponent","inputRef","variant"],kg=function(t){var e,n=t.ownerState,r=t.theme;return(0,Ap.Z)((e={MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,Ap.Z)({},r.vars?{backgroundColor:"rgba(".concat(r.vars.palette.common.onBackgroundChannel," / 0.05)")}:{backgroundColor:"light"===r.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"}},(0,s.Z)(e,"&.".concat(Sg.disabled),{cursor:"default"}),(0,s.Z)(e,"&[multiple]",{height:"auto"}),(0,s.Z)(e,"&:not([multiple]) option, &:not([multiple]) optgroup",{backgroundColor:(r.vars||r).palette.background.paper}),(0,s.Z)(e,"&&&",{paddingRight:24,minWidth:16}),e),"filled"===n.variant&&{"&&&":{paddingRight:32}},"outlined"===n.variant&&{borderRadius:(r.vars||r).shape.borderRadius,"&:focus":{borderRadius:(r.vars||r).shape.borderRadius},"&&&":{paddingRight:32}})},Cg=(0,Dp.ZP)("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Dp.FO,overridesResolver:function(t,e){var n=t.ownerState;return[e.select,e[n.variant],(0,s.Z)({},"&.".concat(Sg.multiple),e.multiple)]}})(kg),Ig=function(t){var e=t.ownerState,n=t.theme;return(0,Ap.Z)((0,s.Z)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active},"&.".concat(Sg.disabled),{color:(n.vars||n).palette.action.disabled}),e.open&&{transform:"rotate(180deg)"},"filled"===e.variant&&{right:7},"outlined"===e.variant&&{right:7})},Tg=(0,Dp.ZP)("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:function(t,e){var n=t.ownerState;return[e.icon,n.variant&&e["icon".concat((0,Op.Z)(n.variant))],n.open&&e.iconOpen]}})(Ig),Pg=t.forwardRef((function(e,n){var r=e.className,i=e.disabled,o=e.IconComponent,a=e.inputRef,s=e.variant,l=void 0===s?"standard":s,u=(0,Pp.Z)(e,Eg),c=(0,Ap.Z)({},e,{disabled:i,variant:l}),h=function(t){var e=t.classes,n=t.variant,r=t.disabled,i=t.multiple,o=t.open,a={select:["select",n,r&&"disabled",i&&"multiple"],icon:["icon","icon".concat((0,Op.Z)(n)),o&&"iconOpen",r&&"disabled"]};return(0,Lp.Z)(a,wg,e)}(c);return(0,Zp.jsxs)(t.Fragment,{children:[(0,Zp.jsx)(Cg,(0,Ap.Z)({ownerState:c,className:(0,Mp.Z)(h.select,r),disabled:i,ref:a||n},u)),e.multiple?null:(0,Zp.jsx)(Tg,{as:o,ownerState:c,className:h.icon})]})})),Ag=Pg,Mg=n(8744);function Lg(t){return(0,Up.Z)("MuiSelect",t)}var Rg,Dg=(0,jp.Z)("MuiSelect",["select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),Ng=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],zg=(0,Dp.ZP)("div",{name:"MuiSelect",slot:"Select",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"&.".concat(Dg.select),e.select),(0,s.Z)({},"&.".concat(Dg.select),e[n.variant]),(0,s.Z)({},"&.".concat(Dg.multiple),e.multiple)]}})(kg,(0,s.Z)({},"&.".concat(Dg.select),{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"})),Og=(0,Dp.ZP)("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:function(t,e){var n=t.ownerState;return[e.icon,n.variant&&e["icon".concat((0,Op.Z)(n.variant))],n.open&&e.iconOpen]}})(Ig),Fg=(0,Dp.ZP)("input",{shouldForwardProp:function(t){return(0,Dp.Dz)(t)&&"classes"!==t},name:"MuiSelect",slot:"NativeInput",overridesResolver:function(t,e){return e.nativeInput}})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Bg(t,e){return"object"===typeof e&&null!==e?t===e:String(t)===String(e)}function jg(t){return null==t||"string"===typeof t&&!t.trim()}var Ug=t.forwardRef((function(e,n){var r=e["aria-describedby"],i=e["aria-label"],o=e.autoFocus,a=e.autoWidth,s=e.children,u=e.className,c=e.defaultOpen,h=e.defaultValue,f=e.disabled,p=e.displayEmpty,d=e.IconComponent,m=e.inputRef,g=e.labelId,v=e.MenuProps,y=void 0===v?{}:v,_=e.multiple,x=e.name,b=e.onBlur,w=e.onChange,S=e.onClose,E=e.onFocus,k=e.onOpen,C=e.open,I=e.readOnly,T=e.renderValue,P=e.SelectDisplayProps,A=void 0===P?{}:P,M=e.tabIndex,L=e.value,R=e.variant,D=void 0===R?"standard":R,N=(0,Pp.Z)(e,Ng),z=(0,Mg.Z)({controlled:L,default:h,name:"Select"}),O=(0,l.Z)(z,2),F=O[0],B=O[1],j=(0,Mg.Z)({controlled:C,default:c,name:"Select"}),U=(0,l.Z)(j,2),V=U[0],Z=U[1],q=t.useRef(null),G=t.useRef(null),W=t.useState(null),X=(0,l.Z)(W,2),H=X[0],Y=X[1],$=t.useRef(null!=C).current,K=t.useState(),J=(0,l.Z)(K,2),Q=J[0],tt=J[1],et=(0,_d.Z)(n,m),nt=t.useCallback((function(t){G.current=t,t&&Y(t)}),[]);t.useImperativeHandle(et,(function(){return{focus:function(){G.current.focus()},node:q.current,value:F}}),[F]),t.useEffect((function(){c&&V&&H&&!$&&(tt(a?null:H.clientWidth),G.current.focus())}),[H,a]),t.useEffect((function(){o&&G.current.focus()}),[o]),t.useEffect((function(){if(g){var t=(0,cd.Z)(G.current).getElementById(g);if(t){var e=function(){getSelection().isCollapsed&&G.current.focus()};return t.addEventListener("click",e),function(){t.removeEventListener("click",e)}}}}),[g]);var rt,it,ot=function(t,e){t?k&&k(e):S&&S(e),$||(tt(a?null:H.clientWidth),Z(t))},at=t.Children.toArray(s),st=function(t){return function(e){var n;if(e.currentTarget.hasAttribute("tabindex")){if(_){n=Array.isArray(F)?F.slice():[];var r=F.indexOf(t.props.value);-1===r?n.push(t.props.value):n.splice(r,1)}else n=t.props.value;if(t.props.onClick&&t.props.onClick(e),F!==n&&(B(n),w)){var i=e.nativeEvent||e,o=new i.constructor(i.type,i);Object.defineProperty(o,"target",{writable:!0,value:{value:n,name:x}}),w(o,t)}_||ot(!1,e)}}},lt=null!==H&&V;delete N["aria-invalid"];var ut=[],ct=!1;(zp({value:F})||p)&&(T?rt=T(F):ct=!0);var ht=at.map((function(e,n,r){if(!t.isValidElement(e))return null;var i;if(_){if(!Array.isArray(F))throw new Error((0,ud.Z)(2));i=F.some((function(t){return Bg(t,e.props.value)})),i&&ct&&ut.push(e.props.children)}else(i=Bg(F,e.props.value))&&ct&&(it=e.props.children);if(i&&!0,void 0===e.props.value)return t.cloneElement(e,{"aria-readonly":!0,role:"option"});return t.cloneElement(e,{"aria-selected":i?"true":"false",onClick:st(e),onKeyUp:function(t){" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:void 0===r[0].props.value||!0===r[0].props.disabled?function(){if(F)return i;var t=r.find((function(t){return void 0!==t.props.value&&!0!==t.props.disabled}));return e===t||i}():i,value:void 0,"data-value":e.props.value})}));ct&&(rt=_?0===ut.length?null:ut.reduce((function(t,e,n){return t.push(e),n<ut.length-1&&t.push(", "),t}),[]):it);var ft,pt=Q;!a&&$&&H&&(pt=H.clientWidth),ft="undefined"!==typeof M?M:f?null:0;var dt=A.id||(x?"mui-component-select-".concat(x):void 0),mt=(0,Ap.Z)({},e,{variant:D,value:F,open:lt}),gt=function(t){var e=t.classes,n=t.variant,r=t.disabled,i=t.multiple,o=t.open,a={select:["select",n,r&&"disabled",i&&"multiple"],icon:["icon","icon".concat((0,Op.Z)(n)),o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return(0,Lp.Z)(a,Lg,e)}(mt);return(0,Zp.jsxs)(t.Fragment,{children:[(0,Zp.jsx)(zg,(0,Ap.Z)({ref:nt,tabIndex:ft,role:"button","aria-disabled":f?"true":void 0,"aria-expanded":lt?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[g,dt].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:function(t){if(!I){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(t.key)&&(t.preventDefault(),ot(!0,t))}},onMouseDown:f||I?null:function(t){0===t.button&&(t.preventDefault(),G.current.focus(),ot(!0,t))},onBlur:function(t){!lt&&b&&(Object.defineProperty(t,"target",{writable:!0,value:{value:F,name:x}}),b(t))},onFocus:E},A,{ownerState:mt,className:(0,Mp.Z)(A.className,gt.select,u),id:dt,children:jg(rt)?Rg||(Rg=(0,Zp.jsx)("span",{className:"notranslate",children:"\u200b"})):rt})),(0,Zp.jsx)(Fg,(0,Ap.Z)({value:Array.isArray(F)?F.join(","):F,name:x,ref:q,"aria-hidden":!0,onChange:function(t){var e=at.map((function(t){return t.props.value})).indexOf(t.target.value);if(-1!==e){var n=at[e];B(n.props.value),w&&w(t,n)}},tabIndex:-1,disabled:f,className:gt.nativeInput,autoFocus:o,ownerState:mt},N)),(0,Zp.jsx)(Og,{as:d,className:gt.icon,ownerState:mt}),(0,Zp.jsx)(bg,(0,Ap.Z)({id:"menu-".concat(x||""),anchorEl:H,open:lt,onClose:function(t){ot(!1,t)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:(0,Ap.Z)({"aria-labelledby":g,role:"listbox",disableListWrap:!0},y.MenuListProps),PaperProps:(0,Ap.Z)({},y.PaperProps,{style:(0,Ap.Z)({minWidth:pt},null!=y.PaperProps?y.PaperProps.style:null)}),children:ht}))]})})),Vg=Ug,Zg=n(9201),qg=(0,Zg.Z)((0,Zp.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Gg=n(3981),Wg=["onChange","maxRows","minRows","style","value"];function Xg(t,e){return parseInt(t[e],10)||0}var Hg={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function Yg(t){return void 0===t||null===t||0===Object.keys(t).length}var $g=t.forwardRef((function(e,n){var i=e.onChange,o=e.maxRows,a=e.minRows,s=void 0===a?1:a,u=e.style,c=e.value,h=lm(e,Wg),f=t.useRef(null!=c).current,p=t.useRef(null),d=(0,um.Z)(n,p),m=t.useRef(null),g=t.useRef(0),v=t.useState({}),y=(0,l.Z)(v,2),_=y[0],x=y[1],b=t.useCallback((function(){var t=p.current,n=(0,_m.Z)(t).getComputedStyle(t);if("0px"===n.width)return{};var r=m.current;r.style.width=n.width,r.value=t.value||e.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var i=n["box-sizing"],a=Xg(n,"padding-bottom")+Xg(n,"padding-top"),l=Xg(n,"border-bottom-width")+Xg(n,"border-top-width"),u=r.scrollHeight;r.value="x";var c=r.scrollHeight,h=u;return s&&(h=Math.max(Number(s)*c,h)),o&&(h=Math.min(Number(o)*c,h)),{outerHeightStyle:(h=Math.max(h,c))+("border-box"===i?a+l:0),overflow:Math.abs(h-u)<=1}}),[o,s,e.placeholder]),w=function(t,e){var n=e.outerHeightStyle,r=e.overflow;return g.current<20&&(n>0&&Math.abs((t.outerHeightStyle||0)-n)>1||t.overflow!==r)?(g.current+=1,{overflow:r,outerHeightStyle:n}):t},S=t.useCallback((function(){var t=b();Yg(t)||x((function(e){return w(e,t)}))}),[b]);t.useEffect((function(){var t,e=(0,Gg.Z)((function(){g.current=0,p.current&&function(){var t=b();Yg(t)||(0,r.flushSync)((function(){x((function(e){return w(e,t)}))}))}()})),n=(0,_m.Z)(p.current);return n.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(t=new ResizeObserver(e)).observe(p.current),function(){e.clear(),n.removeEventListener("resize",e),t&&t.disconnect()}})),(0,pm.Z)((function(){S()})),t.useEffect((function(){g.current=0}),[c]);return(0,Zp.jsxs)(t.Fragment,{children:[(0,Zp.jsx)("textarea",sm({value:c,onChange:function(t){g.current=0,f||S(),i&&i(t)},ref:d,rows:s,style:sm({height:_.outerHeightStyle,overflow:_.overflow?"hidden":null},u)},h)),(0,Zp.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:m,tabIndex:-1,style:sm({},Hg,u,{padding:0})})]})})),Kg=$g;function Jg(t){var e=t.styles,n=t.defaultTheme,r=void 0===n?{}:n,i="function"===typeof e?function(t){return e(void 0===(n=t)||null===n||0===Object.keys(n).length?r:t);var n}:e;return(0,Zp.jsx)(Fn,{styles:i})}var Qg=function(t){return(0,Zp.jsx)(Jg,(0,Ap.Z)({},t,{defaultTheme:Kd.Z}))};function tv(t){return(0,Up.Z)("MuiInputBase",t)}var ev=(0,jp.Z)("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),nv=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],rv=function(t,e){var n=t.ownerState;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,"small"===n.size&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e["color".concat((0,Op.Z)(n.color))],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},iv=function(t,e){var n=t.ownerState;return[e.input,"small"===n.size&&e.inputSizeSmall,n.multiline&&e.inputMultiline,"search"===n.type&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},ov=(0,Dp.ZP)("div",{name:"MuiInputBase",slot:"Root",overridesResolver:rv})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({},e.typography.body1,(0,s.Z)({color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center"},"&.".concat(ev.disabled),{color:(e.vars||e).palette.text.disabled,cursor:"default"}),n.multiline&&(0,Ap.Z)({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),av=(0,Dp.ZP)("input",{name:"MuiInputBase",slot:"Input",overridesResolver:iv})((function(t){var e,n=t.theme,r=t.ownerState,i="light"===n.palette.mode,o=(0,Ap.Z)({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),a={opacity:"0 !important"},l=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5};return(0,Ap.Z)((e={font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"}},(0,s.Z)(e,"label[data-shrink=false] + .".concat(ev.formControl," &"),{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":l,"&:focus::-moz-placeholder":l,"&:focus:-ms-input-placeholder":l,"&:focus::-ms-input-placeholder":l}),(0,s.Z)(e,"&.".concat(ev.disabled),{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled}),(0,s.Z)(e,"&:-webkit-autofill",{animationDuration:"5000s",animationName:"mui-auto-fill"}),e),"small"===r.size&&{paddingTop:1},r.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===r.type&&{MozAppearance:"textfield"})})),sv=(0,Zp.jsx)(Qg,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),lv=t.forwardRef((function(e,n){var r,i=(0,Rp.Z)({props:e,name:"MuiInputBase"}),o=i["aria-describedby"],a=i.autoComplete,s=i.autoFocus,u=i.className,c=i.components,h=void 0===c?{}:c,f=i.componentsProps,p=void 0===f?{}:f,d=i.defaultValue,m=i.disabled,g=i.disableInjectingGlobalStyles,v=i.endAdornment,y=i.fullWidth,_=void 0!==y&&y,x=i.id,b=i.inputComponent,w=void 0===b?"input":b,S=i.inputProps,E=void 0===S?{}:S,k=i.inputRef,C=i.maxRows,I=i.minRows,T=i.multiline,P=void 0!==T&&T,A=i.name,M=i.onBlur,L=i.onChange,R=i.onClick,D=i.onFocus,N=i.onKeyDown,z=i.onKeyUp,O=i.placeholder,F=i.readOnly,B=i.renderSuffix,j=i.rows,U=i.slotProps,V=void 0===U?{}:U,Z=i.slots,q=void 0===Z?{}:Z,G=i.startAdornment,W=i.type,X=void 0===W?"text":W,H=i.value,Y=(0,Pp.Z)(i,nv),$=null!=E.value?E.value:H,K=t.useRef(null!=$).current,J=t.useRef(),Q=t.useCallback((function(t){0}),[]),tt=(0,_d.Z)(J,k,E.ref,Q),et=t.useState(!1),nt=(0,l.Z)(et,2),rt=nt[0],it=nt[1],ot=Yp();var at=Hp({props:i,muiFormControl:ot,states:["color","disabled","error","hiddenLabel","size","required","filled"]});at.focused=ot?ot.focused:rt,t.useEffect((function(){!ot&&m&&rt&&(it(!1),M&&M())}),[ot,m,rt,M]);var st=ot&&ot.onFilled,lt=ot&&ot.onEmpty,ut=t.useCallback((function(t){zp(t)?st&&st():lt&&lt()}),[st,lt]);(0,xd.Z)((function(){K&&ut({value:$})}),[$,ut,K]);t.useEffect((function(){ut(J.current)}),[]);var ct=w,ht=E;P&&"input"===ct&&(ht=j?(0,Ap.Z)({type:void 0,minRows:j,maxRows:j},ht):(0,Ap.Z)({type:void 0,maxRows:C,minRows:I},ht),ct=Kg);t.useEffect((function(){ot&&ot.setAdornedStart(Boolean(G))}),[ot,G]);var ft=(0,Ap.Z)({},i,{color:at.color||"primary",disabled:at.disabled,endAdornment:v,error:at.error,focused:at.focused,formControl:ot,fullWidth:_,hiddenLabel:at.hiddenLabel,multiline:P,size:at.size,startAdornment:G,type:X}),pt=function(t){var e=t.classes,n=t.color,r=t.disabled,i=t.error,o=t.endAdornment,a=t.focused,s=t.formControl,l=t.fullWidth,u=t.hiddenLabel,c=t.multiline,h=t.readOnly,f=t.size,p=t.startAdornment,d=t.type,m={root:["root","color".concat((0,Op.Z)(n)),r&&"disabled",i&&"error",l&&"fullWidth",a&&"focused",s&&"formControl","small"===f&&"sizeSmall",c&&"multiline",p&&"adornedStart",o&&"adornedEnd",u&&"hiddenLabel",h&&"readOnly"],input:["input",r&&"disabled","search"===d&&"inputTypeSearch",c&&"inputMultiline","small"===f&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",h&&"readOnly"]};return(0,Lp.Z)(m,tv,e)}(ft),dt=q.root||h.Root||ov,mt=V.root||p.root||{},gt=q.input||h.Input||av;return ht=(0,Ap.Z)({},ht,null!=(r=V.input)?r:p.input),(0,Zp.jsxs)(t.Fragment,{children:[!g&&sv,(0,Zp.jsxs)(dt,(0,Ap.Z)({},mt,!Mm(dt)&&{ownerState:(0,Ap.Z)({},ft,mt.ownerState)},{ref:n,onClick:function(t){J.current&&t.currentTarget===t.target&&J.current.focus(),R&&R(t)}},Y,{className:(0,Mp.Z)(pt.root,mt.className,u),children:[G,(0,Zp.jsx)(Bp.Provider,{value:null,children:(0,Zp.jsx)(gt,(0,Ap.Z)({ownerState:ft,"aria-invalid":at.error,"aria-describedby":o,autoComplete:a,autoFocus:s,defaultValue:d,disabled:at.disabled,id:x,onAnimationStart:function(t){ut("mui-auto-fill-cancel"===t.animationName?J.current:{value:"x"})},name:A,placeholder:O,readOnly:F,required:at.required,rows:j,value:$,onKeyDown:N,onKeyUp:z,type:X},ht,!Mm(gt)&&{as:ct,ownerState:(0,Ap.Z)({},ft,ht.ownerState)},{ref:tt,className:(0,Mp.Z)(pt.input,ht.className),onBlur:function(t){M&&M(t),E.onBlur&&E.onBlur(t),ot&&ot.onBlur?ot.onBlur(t):it(!1)},onChange:function(t){if(!K){var e=t.target||J.current;if(null==e)throw new Error((0,ud.Z)(1));ut({value:e.value})}for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];E.onChange&&E.onChange.apply(E,[t].concat(r)),L&&L.apply(void 0,[t].concat(r))},onFocus:function(t){at.disabled?t.stopPropagation():(D&&D(t),E.onFocus&&E.onFocus(t),ot&&ot.onFocus?ot.onFocus(t):it(!0))}}))}),v,B?B((0,Ap.Z)({},at,{startAdornment:G})):null]}))]})})),uv=lv;function cv(t){return(0,Up.Z)("MuiInput",t)}var hv=(0,Ap.Z)({},ev,(0,jp.Z)("MuiInput",["root","underline","input"])),fv=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],pv=(0,Dp.ZP)(ov,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiInput",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[].concat((0,a.Z)(rv(t,e)),[!n.disableUnderline&&e.underline])}})((function(t){var e,n=t.theme,r=t.ownerState,i="light"===n.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(i="rgba(".concat(n.vars.palette.common.onBackgroundChannel," / ").concat(n.vars.opacity.inputUnderline,")")),(0,Ap.Z)({position:"relative"},r.formControl&&{"label + &":{marginTop:16}},!r.disableUnderline&&(e={"&:after":{borderBottom:"2px solid ".concat((n.vars||n).palette[r.color].main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"}},(0,s.Z)(e,"&.".concat(hv.focused,":after"),{transform:"scaleX(1) translateX(0)"}),(0,s.Z)(e,"&.".concat(hv.error,":after"),{borderBottomColor:(n.vars||n).palette.error.main,transform:"scaleX(1)"}),(0,s.Z)(e,"&:before",{borderBottom:"1px solid ".concat(i),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"}),(0,s.Z)(e,"&:hover:not(.".concat(hv.disabled,"):before"),{borderBottom:"2px solid ".concat((n.vars||n).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(i)}}),(0,s.Z)(e,"&.".concat(hv.disabled,":before"),{borderBottomStyle:"dotted"}),e))})),dv=(0,Dp.ZP)(av,{name:"MuiInput",slot:"Input",overridesResolver:iv})({}),mv=t.forwardRef((function(t,e){var n,r,i,o,a=(0,Rp.Z)({props:t,name:"MuiInput"}),s=a.disableUnderline,l=a.components,u=void 0===l?{}:l,c=a.componentsProps,h=a.fullWidth,f=void 0!==h&&h,p=a.inputComponent,d=void 0===p?"input":p,m=a.multiline,g=void 0!==m&&m,v=a.slotProps,y=a.slots,_=void 0===y?{}:y,x=a.type,b=void 0===x?"text":x,w=(0,Pp.Z)(a,fv),S=function(t){var e=t.classes,n={root:["root",!t.disableUnderline&&"underline"],input:["input"]},r=(0,Lp.Z)(n,cv,e);return(0,Ap.Z)({},e,r)}(a),E={root:{ownerState:{disableUnderline:s}}},k=(null!=v?v:c)?(0,ld.Z)(null!=v?v:c,E):E,C=null!=(n=null!=(r=_.root)?r:u.Root)?n:pv,I=null!=(i=null!=(o=_.input)?o:u.Input)?i:dv;return(0,Zp.jsx)(uv,(0,Ap.Z)({slots:{root:C,input:I},slotProps:k,fullWidth:f,inputComponent:d,multiline:g,ref:e,type:b},w,{classes:S}))}));mv.muiName="Input";var gv=mv;function vv(t){return(0,Up.Z)("MuiFilledInput",t)}var yv=(0,Ap.Z)({},ev,(0,jp.Z)("MuiFilledInput",["root","underline","input"])),_v=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],xv=(0,Dp.ZP)(ov,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiFilledInput",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[].concat((0,a.Z)(rv(t,e)),[!n.disableUnderline&&e.underline])}})((function(t){var e,n,r,i=t.theme,o=t.ownerState,a="light"===i.palette.mode,l=a?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",u=a?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",c=a?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",h=a?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,Ap.Z)((e={position:"relative",backgroundColor:i.vars?i.vars.palette.FilledInput.bg:u,borderTopLeftRadius:(i.vars||i).shape.borderRadius,borderTopRightRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create("background-color",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),"&:hover":{backgroundColor:i.vars?i.vars.palette.FilledInput.hoverBg:c,"@media (hover: none)":{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:u}}},(0,s.Z)(e,"&.".concat(yv.focused),{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:u}),(0,s.Z)(e,"&.".concat(yv.disabled),{backgroundColor:i.vars?i.vars.palette.FilledInput.disabledBg:h}),e),!o.disableUnderline&&(n={"&:after":{borderBottom:"2px solid ".concat(null==(r=(i.vars||i).palette[o.color||"primary"])?void 0:r.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:i.transitions.create("transform",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),pointerEvents:"none"}},(0,s.Z)(n,"&.".concat(yv.focused,":after"),{transform:"scaleX(1) translateX(0)"}),(0,s.Z)(n,"&.".concat(yv.error,":after"),{borderBottomColor:(i.vars||i).palette.error.main,transform:"scaleX(1)"}),(0,s.Z)(n,"&:before",{borderBottom:"1px solid ".concat(i.vars?"rgba(".concat(i.vars.palette.common.onBackgroundChannel," / ").concat(i.vars.opacity.inputUnderline,")"):l),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:i.transitions.create("border-bottom-color",{duration:i.transitions.duration.shorter}),pointerEvents:"none"}),(0,s.Z)(n,"&:hover:not(.".concat(yv.disabled,"):before"),{borderBottom:"1px solid ".concat((i.vars||i).palette.text.primary)}),(0,s.Z)(n,"&.".concat(yv.disabled,":before"),{borderBottomStyle:"dotted"}),n),o.startAdornment&&{paddingLeft:12},o.endAdornment&&{paddingRight:12},o.multiline&&(0,Ap.Z)({padding:"25px 12px 8px"},"small"===o.size&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17}))})),bv=(0,Dp.ZP)(av,{name:"MuiFilledInput",slot:"Input",overridesResolver:iv})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.vars&&(0,s.Z)({"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.getColorSchemeSelector("dark"),{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}),"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9})})),wv=t.forwardRef((function(t,e){var n,r,i,o,a=(0,Rp.Z)({props:t,name:"MuiFilledInput"}),s=a.components,l=void 0===s?{}:s,u=a.componentsProps,c=a.fullWidth,h=void 0!==c&&c,f=a.inputComponent,p=void 0===f?"input":f,d=a.multiline,m=void 0!==d&&d,g=a.slotProps,v=a.slots,y=void 0===v?{}:v,_=a.type,x=void 0===_?"text":_,b=(0,Pp.Z)(a,_v),w=(0,Ap.Z)({},a,{fullWidth:h,inputComponent:p,multiline:m,type:x}),S=function(t){var e=t.classes,n={root:["root",!t.disableUnderline&&"underline"],input:["input"]},r=(0,Lp.Z)(n,vv,e);return(0,Ap.Z)({},e,r)}(a),E={root:{ownerState:w},input:{ownerState:w}},k=(null!=g?g:u)?(0,ld.Z)(null!=g?g:u,E):E,C=null!=(n=null!=(r=y.root)?r:l.Root)?n:xv,I=null!=(i=null!=(o=y.input)?o:l.Input)?i:bv;return(0,Zp.jsx)(uv,(0,Ap.Z)({slots:{root:C,input:I},componentsProps:k,fullWidth:h,inputComponent:p,multiline:m,ref:e,type:x},b,{classes:S}))}));wv.muiName="Input";var Sv,Ev=wv,kv=["children","classes","className","label","notched"],Cv=(0,Dp.ZP)("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Iv=(0,Dp.ZP)("legend")((function(t){var e=t.ownerState,n=t.theme;return(0,Ap.Z)({float:"unset",width:"auto",overflow:"hidden"},!e.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},e.withLabel&&(0,Ap.Z)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},e.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function Tv(t){return(0,Up.Z)("MuiOutlinedInput",t)}var Pv=(0,Ap.Z)({},ev,(0,jp.Z)("MuiOutlinedInput",["root","notchedOutline","input"])),Av=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Mv=(0,Dp.ZP)(ov,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiOutlinedInput",slot:"Root",overridesResolver:rv})((function(t){var e,n=t.theme,r=t.ownerState,i="light"===n.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,Ap.Z)((e={position:"relative",borderRadius:(n.vars||n).shape.borderRadius},(0,s.Z)(e,"&:hover .".concat(Pv.notchedOutline),{borderColor:(n.vars||n).palette.text.primary}),(0,s.Z)(e,"@media (hover: none)",(0,s.Z)({},"&:hover .".concat(Pv.notchedOutline),{borderColor:n.vars?"rgba(".concat(n.vars.palette.common.onBackgroundChannel," / 0.23)"):i})),(0,s.Z)(e,"&.".concat(Pv.focused," .").concat(Pv.notchedOutline),{borderColor:(n.vars||n).palette[r.color].main,borderWidth:2}),(0,s.Z)(e,"&.".concat(Pv.error," .").concat(Pv.notchedOutline),{borderColor:(n.vars||n).palette.error.main}),(0,s.Z)(e,"&.".concat(Pv.disabled," .").concat(Pv.notchedOutline),{borderColor:(n.vars||n).palette.action.disabled}),e),r.startAdornment&&{paddingLeft:14},r.endAdornment&&{paddingRight:14},r.multiline&&(0,Ap.Z)({padding:"16.5px 14px"},"small"===r.size&&{padding:"8.5px 14px"}))})),Lv=(0,Dp.ZP)((function(t){var e=t.className,n=t.label,r=t.notched,i=(0,Pp.Z)(t,kv),o=null!=n&&""!==n,a=(0,Ap.Z)({},t,{notched:r,withLabel:o});return(0,Zp.jsx)(Cv,(0,Ap.Z)({"aria-hidden":!0,className:e,ownerState:a},i,{children:(0,Zp.jsx)(Iv,{ownerState:a,children:o?(0,Zp.jsx)("span",{children:n}):Sv||(Sv=(0,Zp.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:function(t,e){return e.notchedOutline}})((function(t){var e=t.theme,n="light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?"rgba(".concat(e.vars.palette.common.onBackgroundChannel," / 0.23)"):n}})),Rv=(0,Dp.ZP)(av,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:iv})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({padding:"16.5px 14px"},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderRadius:"inherit"}},e.vars&&(0,s.Z)({"&:-webkit-autofill":{borderRadius:"inherit"}},e.getColorSchemeSelector("dark"),{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}),"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),Dv=t.forwardRef((function(e,n){var r,i,o,a,s,l=(0,Rp.Z)({props:e,name:"MuiOutlinedInput"}),u=l.components,c=void 0===u?{}:u,h=l.fullWidth,f=void 0!==h&&h,p=l.inputComponent,d=void 0===p?"input":p,m=l.label,g=l.multiline,v=void 0!==g&&g,y=l.notched,_=l.slots,x=void 0===_?{}:_,b=l.type,w=void 0===b?"text":b,S=(0,Pp.Z)(l,Av),E=function(t){var e=t.classes,n=(0,Lp.Z)({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Tv,e);return(0,Ap.Z)({},e,n)}(l),k=Yp(),C=Hp({props:l,muiFormControl:k,states:["required"]}),I=(0,Ap.Z)({},l,{color:C.color||"primary",disabled:C.disabled,error:C.error,focused:C.focused,formControl:k,fullWidth:f,hiddenLabel:C.hiddenLabel,multiline:v,size:C.size,type:w}),T=null!=(r=null!=(i=x.root)?i:c.Root)?r:Mv,P=null!=(o=null!=(a=x.input)?a:c.Input)?o:Rv;return(0,Zp.jsx)(uv,(0,Ap.Z)({slots:{root:T,input:P},renderSuffix:function(e){return(0,Zp.jsx)(Lv,{ownerState:I,className:E.notchedOutline,label:null!=m&&""!==m&&C.required?s||(s=(0,Zp.jsxs)(t.Fragment,{children:[m,"\xa0","*"]})):m,notched:"undefined"!==typeof y?y:Boolean(e.startAdornment||e.filled||e.focused)})},fullWidth:f,inputComponent:d,multiline:v,ref:n,type:w},S,{classes:(0,Ap.Z)({},E,{notchedOutline:null})}))}));Dv.muiName="Input";var Nv,zv,Ov=Dv,Fv=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Bv={name:"MuiSelect",overridesResolver:function(t,e){return e.root},shouldForwardProp:function(t){return(0,Dp.FO)(t)&&"variant"!==t},slot:"Root"},jv=(0,Dp.ZP)(gv,Bv)(""),Uv=(0,Dp.ZP)(Ov,Bv)(""),Vv=(0,Dp.ZP)(Ev,Bv)(""),Zv=t.forwardRef((function(e,n){var r=(0,Rp.Z)({name:"MuiSelect",props:e}),i=r.autoWidth,o=void 0!==i&&i,a=r.children,s=r.classes,l=void 0===s?{}:s,u=r.className,c=r.defaultOpen,h=void 0!==c&&c,f=r.displayEmpty,p=void 0!==f&&f,d=r.IconComponent,m=void 0===d?qg:d,g=r.id,v=r.input,y=r.inputProps,_=r.label,x=r.labelId,b=r.MenuProps,w=r.multiple,S=void 0!==w&&w,E=r.native,k=void 0!==E&&E,C=r.onClose,I=r.onOpen,T=r.open,P=r.renderValue,A=r.SelectDisplayProps,M=r.variant,L=void 0===M?"outlined":M,R=(0,Pp.Z)(r,Fv),D=k?Ag:Vg,N=Hp({props:r,muiFormControl:Yp(),states:["variant"]}).variant||L,z=v||{standard:Nv||(Nv=(0,Zp.jsx)(jv,{})),outlined:(0,Zp.jsx)(Uv,{label:_}),filled:zv||(zv=(0,Zp.jsx)(Vv,{}))}[N],O=function(t){return t.classes}((0,Ap.Z)({},r,{variant:N,classes:l})),F=(0,_d.Z)(n,z.ref);return(0,Zp.jsx)(t.Fragment,{children:t.cloneElement(z,(0,Ap.Z)({inputComponent:D,inputProps:(0,Ap.Z)({children:a,IconComponent:m,variant:N,type:void 0,multiple:S},k?{id:g}:{autoWidth:o,defaultOpen:h,displayEmpty:p,labelId:x,MenuProps:b,onClose:C,onOpen:I,open:T,renderValue:P,SelectDisplayProps:(0,Ap.Z)({id:g},A)},y,{classes:y?(0,ld.Z)(O,y.classes):O},v?v.props.inputProps:{})},S&&k&&"outlined"===N?{notched:!0}:{},{ref:F,className:(0,Mp.Z)(z.props.className,u)},!v&&{variant:N},R))})}));Zv.muiName="Select";var qv=Zv,Gv=n(9683),Wv=n(3031),Xv=n(7462),Hv=n(7326);function Yv(e,n){var r=Object.create(null);return e&&t.Children.map(e,(function(t){return t})).forEach((function(e){r[e.key]=function(e){return n&&(0,t.isValidElement)(e)?n(e):e}(e)})),r}function $v(t,e,n){return null!=n[e]?n[e]:t.props[e]}function Kv(e,n,r){var i=Yv(e.children),o=function(t,e){function n(n){return n in e?e[n]:t[n]}t=t||{},e=e||{};var r,i=Object.create(null),o=[];for(var a in t)a in e?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var l in e){if(i[l])for(r=0;r<i[l].length;r++){var u=i[l][r];s[i[l][r]]=n(u)}s[l]=n(l)}for(r=0;r<o.length;r++)s[o[r]]=n(o[r]);return s}(n,i);return Object.keys(o).forEach((function(a){var s=o[a];if((0,t.isValidElement)(s)){var l=a in n,u=a in i,c=n[a],h=(0,t.isValidElement)(c)&&!c.props.in;!u||l&&!h?u||!l||h?u&&l&&(0,t.isValidElement)(c)&&(o[a]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:c.props.in,exit:$v(s,"exit",e),enter:$v(s,"enter",e)})):o[a]=(0,t.cloneElement)(s,{in:!1}):o[a]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:$v(s,"exit",e),enter:$v(s,"enter",e)})}})),o}var Jv=Object.values||function(t){return Object.keys(t).map((function(e){return t[e]}))},Qv=function(e){function n(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind((0,Hv.Z)(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}Bd(n,e);var r=n.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(e,n){var r,i,o=n.children,a=n.handleExited;return{children:n.firstRender?(r=e,i=a,Yv(r.children,(function(e){return(0,t.cloneElement)(e,{onExited:i.bind(null,e),in:!0,appear:$v(e,"appear",r),enter:$v(e,"enter",r),exit:$v(e,"exit",r)})}))):Kv(e,o,a),firstRender:!1}},r.handleExited=function(t,e){var n=Yv(this.props.children);t.key in n||(t.props.onExited&&t.props.onExited(e),this.mounted&&this.setState((function(e){var n=(0,Xv.Z)({},e.children);return delete n[t.key],{children:n}})))},r.render=function(){var e=this.props,n=e.component,r=e.childFactory,i=Od(e,["component","childFactory"]),o=this.state.contextValue,a=Jv(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,null===n?t.createElement(Ud.Provider,{value:o},a):t.createElement(Ud.Provider,{value:o},t.createElement(n,i,a))},n}(t.Component);Qv.propTypes={},Qv.defaultProps={component:"div",childFactory:function(t){return t}};var ty=Qv;var ey=function(e){var n=e.className,r=e.classes,i=e.pulsate,o=void 0!==i&&i,a=e.rippleX,s=e.rippleY,u=e.rippleSize,c=e.in,h=e.onExited,f=e.timeout,p=t.useState(!1),d=(0,l.Z)(p,2),m=d[0],g=d[1],v=(0,Mp.Z)(n,r.ripple,r.rippleVisible,o&&r.ripplePulsate),y={width:u,height:u,top:-u/2+s,left:-u/2+a},_=(0,Mp.Z)(r.child,m&&r.childLeaving,o&&r.childPulsate);return c||m||g(!0),t.useEffect((function(){if(!c&&null!=h){var t=setTimeout(h,f);return function(){clearTimeout(t)}}}),[h,c,f]),(0,Zp.jsx)("span",{className:v,style:y,children:(0,Zp.jsx)("span",{className:_})})};var ny,ry,iy,oy,ay,sy,ly,uy,cy=(0,jp.Z)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),hy=["center","classes","className"],fy=jn(ay||(ay=ny||(ny=i(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),py=jn(sy||(sy=ry||(ry=i(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),dy=jn(ly||(ly=iy||(iy=i(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),my=(0,Dp.ZP)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),gy=(0,Dp.ZP)(ey,{name:"MuiTouchRipple",slot:"Ripple"})(uy||(uy=oy||(oy=i(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),cy.rippleVisible,fy,550,(function(t){return t.theme.transitions.easing.easeInOut}),cy.ripplePulsate,(function(t){return t.theme.transitions.duration.shorter}),cy.child,cy.childLeaving,py,550,(function(t){return t.theme.transitions.easing.easeInOut}),cy.childPulsate,dy,(function(t){return t.theme.transitions.easing.easeInOut})),vy=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiTouchRipple"}),i=r.center,o=void 0!==i&&i,s=r.classes,u=void 0===s?{}:s,c=r.className,h=(0,Pp.Z)(r,hy),f=t.useState([]),p=(0,l.Z)(f,2),d=p[0],m=p[1],g=t.useRef(0),v=t.useRef(null);t.useEffect((function(){v.current&&(v.current(),v.current=null)}),[d]);var y=t.useRef(!1),_=t.useRef(null),x=t.useRef(null),b=t.useRef(null);t.useEffect((function(){return function(){clearTimeout(_.current)}}),[]);var w=t.useCallback((function(t){var e=t.pulsate,n=t.rippleX,r=t.rippleY,i=t.rippleSize,o=t.cb;m((function(t){return[].concat((0,a.Z)(t),[(0,Zp.jsx)(gy,{classes:{ripple:(0,Mp.Z)(u.ripple,cy.ripple),rippleVisible:(0,Mp.Z)(u.rippleVisible,cy.rippleVisible),ripplePulsate:(0,Mp.Z)(u.ripplePulsate,cy.ripplePulsate),child:(0,Mp.Z)(u.child,cy.child),childLeaving:(0,Mp.Z)(u.childLeaving,cy.childLeaving),childPulsate:(0,Mp.Z)(u.childPulsate,cy.childPulsate)},timeout:550,pulsate:e,rippleX:n,rippleY:r,rippleSize:i},g.current)])})),g.current+=1,v.current=o}),[u]),S=t.useCallback((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=e.pulsate,i=void 0!==r&&r,a=e.center,s=void 0===a?o||e.pulsate:a,l=e.fakeElement,u=void 0!==l&&l;if("mousedown"===(null==t?void 0:t.type)&&y.current)y.current=!1;else{"touchstart"===(null==t?void 0:t.type)&&(y.current=!0);var c,h,f,p=u?null:b.current,d=p?p.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===t||0===t.clientX&&0===t.clientY||!t.clientX&&!t.touches)c=Math.round(d.width/2),h=Math.round(d.height/2);else{var m=t.touches&&t.touches.length>0?t.touches[0]:t,g=m.clientX,v=m.clientY;c=Math.round(g-d.left),h=Math.round(v-d.top)}if(s)(f=Math.sqrt((2*Math.pow(d.width,2)+Math.pow(d.height,2))/3))%2===0&&(f+=1);else{var S=2*Math.max(Math.abs((p?p.clientWidth:0)-c),c)+2,E=2*Math.max(Math.abs((p?p.clientHeight:0)-h),h)+2;f=Math.sqrt(Math.pow(S,2)+Math.pow(E,2))}null!=t&&t.touches?null===x.current&&(x.current=function(){w({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})},_.current=setTimeout((function(){x.current&&(x.current(),x.current=null)}),80)):w({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})}}),[o,w]),E=t.useCallback((function(){S({},{pulsate:!0})}),[S]),k=t.useCallback((function(t,e){if(clearTimeout(_.current),"touchend"===(null==t?void 0:t.type)&&x.current)return x.current(),x.current=null,void(_.current=setTimeout((function(){k(t,e)})));x.current=null,m((function(t){return t.length>0?t.slice(1):t})),v.current=e}),[]);return t.useImperativeHandle(n,(function(){return{pulsate:E,start:S,stop:k}}),[E,S,k]),(0,Zp.jsx)(my,(0,Ap.Z)({className:(0,Mp.Z)(cy.root,u.root,c),ref:b},h,{children:(0,Zp.jsx)(ty,{component:null,exit:!0,children:d})}))})),yy=vy;function _y(t){return(0,Up.Z)("MuiButtonBase",t)}var xy,by=(0,jp.Z)("MuiButtonBase",["root","disabled","focusVisible"]),wy=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],Sy=(0,Dp.ZP)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(t,e){return e.root}})((xy={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},(0,s.Z)(xy,"&.".concat(by.disabled),{pointerEvents:"none",cursor:"default"}),(0,s.Z)(xy,"@media print",{colorAdjust:"exact"}),xy)),Ey=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiButtonBase"}),i=r.action,o=r.centerRipple,a=void 0!==o&&o,s=r.children,u=r.className,c=r.component,h=void 0===c?"button":c,f=r.disabled,p=void 0!==f&&f,d=r.disableRipple,m=void 0!==d&&d,g=r.disableTouchRipple,v=void 0!==g&&g,y=r.focusRipple,_=void 0!==y&&y,x=r.LinkComponent,b=void 0===x?"a":x,w=r.onBlur,S=r.onClick,E=r.onContextMenu,k=r.onDragLeave,C=r.onFocus,I=r.onFocusVisible,T=r.onKeyDown,P=r.onKeyUp,A=r.onMouseDown,M=r.onMouseLeave,L=r.onMouseUp,R=r.onTouchEnd,D=r.onTouchMove,N=r.onTouchStart,z=r.tabIndex,O=void 0===z?0:z,F=r.TouchRippleProps,B=r.touchRippleRef,j=r.type,U=(0,Pp.Z)(r,wy),V=t.useRef(null),Z=t.useRef(null),q=(0,_d.Z)(Z,B),G=(0,Wv.Z)(),W=G.isFocusVisibleRef,X=G.onFocus,H=G.onBlur,Y=G.ref,$=t.useState(!1),K=(0,l.Z)($,2),J=K[0],Q=K[1];p&&J&&Q(!1),t.useImperativeHandle(i,(function(){return{focusVisible:function(){Q(!0),V.current.focus()}}}),[]);var tt=t.useState(!1),et=(0,l.Z)(tt,2),nt=et[0],rt=et[1];t.useEffect((function(){rt(!0)}),[]);var it=nt&&!m&&!p;function ot(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return(0,Gv.Z)((function(r){return e&&e(r),!n&&Z.current&&Z.current[t](r),!0}))}t.useEffect((function(){J&&_&&!m&&nt&&Z.current.pulsate()}),[m,_,J,nt]);var at=ot("start",A),st=ot("stop",E),lt=ot("stop",k),ut=ot("stop",L),ct=ot("stop",(function(t){J&&t.preventDefault(),M&&M(t)})),ht=ot("start",N),ft=ot("stop",R),pt=ot("stop",D),dt=ot("stop",(function(t){H(t),!1===W.current&&Q(!1),w&&w(t)}),!1),mt=(0,Gv.Z)((function(t){V.current||(V.current=t.currentTarget),X(t),!0===W.current&&(Q(!0),I&&I(t)),C&&C(t)})),gt=function(){var t=V.current;return h&&"button"!==h&&!("A"===t.tagName&&t.href)},vt=t.useRef(!1),yt=(0,Gv.Z)((function(t){_&&!vt.current&&J&&Z.current&&" "===t.key&&(vt.current=!0,Z.current.stop(t,(function(){Z.current.start(t)}))),t.target===t.currentTarget&&gt()&&" "===t.key&&t.preventDefault(),T&&T(t),t.target===t.currentTarget&&gt()&&"Enter"===t.key&&!p&&(t.preventDefault(),S&&S(t))})),_t=(0,Gv.Z)((function(t){_&&" "===t.key&&Z.current&&J&&!t.defaultPrevented&&(vt.current=!1,Z.current.stop(t,(function(){Z.current.pulsate(t)}))),P&&P(t),S&&t.target===t.currentTarget&&gt()&&" "===t.key&&!t.defaultPrevented&&S(t)})),xt=h;"button"===xt&&(U.href||U.to)&&(xt=b);var bt={};"button"===xt?(bt.type=void 0===j?"button":j,bt.disabled=p):(U.href||U.to||(bt.role="button"),p&&(bt["aria-disabled"]=p));var wt=(0,_d.Z)(n,Y,V);var St=(0,Ap.Z)({},r,{centerRipple:a,component:h,disabled:p,disableRipple:m,disableTouchRipple:v,focusRipple:_,tabIndex:O,focusVisible:J}),Et=function(t){var e=t.disabled,n=t.focusVisible,r=t.focusVisibleClassName,i=t.classes,o={root:["root",e&&"disabled",n&&"focusVisible"]},a=(0,Lp.Z)(o,_y,i);return n&&r&&(a.root+=" ".concat(r)),a}(St);return(0,Zp.jsxs)(Sy,(0,Ap.Z)({as:xt,className:(0,Mp.Z)(Et.root,u),ownerState:St,onBlur:dt,onClick:S,onContextMenu:st,onFocus:mt,onKeyDown:yt,onKeyUp:_t,onMouseDown:at,onMouseLeave:ct,onMouseUp:ut,onDragLeave:lt,onTouchEnd:ft,onTouchMove:pt,onTouchStart:ht,ref:wt,tabIndex:p?-1:O,type:j},bt,U,{children:[s,it?(0,Zp.jsx)(yy,(0,Ap.Z)({ref:q,center:a},F)):null]}))})),ky=Ey;function Cy(t){return(0,Up.Z)("MuiDivider",t)}var Iy=(0,jp.Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);var Ty=(0,jp.Z)("MuiListItemIcon",["root","alignItemsFlexStart"]);function Py(t){return(0,Up.Z)("MuiListItemText",t)}var Ay=(0,jp.Z)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);var My=(0,jp.Z)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]);(0,Dp.ZP)(ky,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiMenuItem",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]}})((function(t){var e,n=t.theme,r=t.ownerState;return(0,Ap.Z)({},n.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.divider&&{borderBottom:"1px solid ".concat((n.vars||n).palette.divider),backgroundClip:"padding-box"},(e={"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},(0,s.Z)(e,"&.".concat(My.selected),(0,s.Z)({backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)},"&.".concat(My.focusVisible),{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.focusOpacity,"))"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)})),(0,s.Z)(e,"&.".concat(My.selected,":hover"),{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.hoverOpacity,"))"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)}}),(0,s.Z)(e,"&.".concat(My.focusVisible),{backgroundColor:(n.vars||n).palette.action.focus}),(0,s.Z)(e,"&.".concat(My.disabled),{opacity:(n.vars||n).palette.action.disabledOpacity}),(0,s.Z)(e,"& + .".concat(Iy.root),{marginTop:n.spacing(1),marginBottom:n.spacing(1)}),(0,s.Z)(e,"& + .".concat(Iy.inset),{marginLeft:52}),(0,s.Z)(e,"& .".concat(Ay.root),{marginTop:0,marginBottom:0}),(0,s.Z)(e,"& .".concat(Ay.inset),{paddingLeft:36}),(0,s.Z)(e,"& .".concat(Ty.root),{minWidth:36}),e),!r.dense&&(0,s.Z)({},n.breakpoints.up("sm"),{minHeight:"auto"}),r.dense&&(0,Ap.Z)({minHeight:32,paddingTop:4,paddingBottom:4},n.typography.body2,(0,s.Z)({},"& .".concat(Ty.root," svg"),{fontSize:"1.25rem"})))}));(0,jp.Z)("MuiFormGroup",["root","row","error"]),(0,Dp.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.row&&e.row]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},e.row&&{flexDirection:"row"})}));n(7384);var Ly=n(4695),Ry=n(916),Dy=n(7416),Ny=["sx"];function zy(t){var e,n=t.sx,r=function(t){var e,n,r={systemProps:{},otherProps:{}},i=null!=(e=null==t||null==(n=t.theme)?void 0:n.unstable_sxConfig)?e:Dy.Z;return Object.keys(t).forEach((function(e){i[e]?r.systemProps[e]=t[e]:r.otherProps[e]=t[e]})),r}((0,Ry.Z)(t,Ny)),i=r.systemProps,o=r.otherProps;return e=Array.isArray(n)?[i].concat((0,a.Z)(n)):"function"===typeof n?function(){var t=n.apply(void 0,arguments);return(0,ld.P)(t)?(0,Ly.Z)({},i,t):i}:(0,Ly.Z)({},i,n),(0,Ly.Z)({},o,{sx:e})}function Oy(t){return(0,Up.Z)("MuiTypography",t)}(0,jp.Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var Fy=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],By=(0,Dp.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.variant&&e[n.variant],"inherit"!==n.align&&e["align".concat((0,Op.Z)(n.align))],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({margin:0},n.variant&&e.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),jy={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Uy={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Vy=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiTypography"}),r=function(t){return Uy[t]||t}(n.color),i=zy((0,Ap.Z)({},n,{color:r})),o=i.align,a=void 0===o?"inherit":o,s=i.className,l=i.component,u=i.gutterBottom,c=void 0!==u&&u,h=i.noWrap,f=void 0!==h&&h,p=i.paragraph,d=void 0!==p&&p,m=i.variant,g=void 0===m?"body1":m,v=i.variantMapping,y=void 0===v?jy:v,_=(0,Pp.Z)(i,Fy),x=(0,Ap.Z)({},i,{align:a,color:r,className:s,component:l,gutterBottom:c,noWrap:f,paragraph:d,variant:g,variantMapping:y}),b=l||(d?"p":y[g]||jy[g])||"span",w=function(t){var e=t.align,n=t.gutterBottom,r=t.noWrap,i=t.paragraph,o=t.variant,a=t.classes,s={root:["root",o,"inherit"!==t.align&&"align".concat((0,Op.Z)(e)),n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]};return(0,Lp.Z)(s,Oy,a)}(x);return(0,Zp.jsx)(By,(0,Ap.Z)({as:b,ref:e,ownerState:x,className:(0,Mp.Z)(w.root,s)},_))})),Zy=Vy;var qy=(0,jp.Z)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error"]);(0,Dp.ZP)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"& .".concat(qy.label),e.label),e.root,e["labelPlacement".concat((0,Op.Z)(n.labelPlacement))]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)((0,s.Z)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16},"&.".concat(qy.disabled),{cursor:"default"}),"start"===n.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===n.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===n.labelPlacement&&{flexDirection:"column",marginLeft:16},(0,s.Z)({},"& .".concat(qy.label),(0,s.Z)({},"&.".concat(qy.disabled),{color:(e.vars||e).palette.text.disabled})))}));function Gy(t){return(0,Up.Z)("PrivateSwitchBase",t)}(0,jp.Z)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var Wy=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Xy=(0,Dp.ZP)(ky)((function(t){var e=t.ownerState;return(0,Ap.Z)({padding:9,borderRadius:"50%"},"start"===e.edge&&{marginLeft:"small"===e.size?-3:-12},"end"===e.edge&&{marginRight:"small"===e.size?-3:-12})})),Hy=(0,Dp.ZP)("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Yy=t.forwardRef((function(t,e){var n=t.autoFocus,r=t.checked,i=t.checkedIcon,o=t.className,a=t.defaultChecked,s=t.disabled,u=t.disableFocusRipple,c=void 0!==u&&u,h=t.edge,f=void 0!==h&&h,p=t.icon,d=t.id,m=t.inputProps,g=t.inputRef,v=t.name,y=t.onBlur,_=t.onChange,x=t.onFocus,b=t.readOnly,w=t.required,S=t.tabIndex,E=t.type,k=t.value,C=(0,Pp.Z)(t,Wy),I=(0,Mg.Z)({controlled:r,default:Boolean(a),name:"SwitchBase",state:"checked"}),T=(0,l.Z)(I,2),P=T[0],A=T[1],M=Yp(),L=s;M&&"undefined"===typeof L&&(L=M.disabled);var R="checkbox"===E||"radio"===E,D=(0,Ap.Z)({},t,{checked:P,disabled:L,disableFocusRipple:c,edge:f}),N=function(t){var e=t.classes,n=t.checked,r=t.disabled,i=t.edge,o={root:["root",n&&"checked",r&&"disabled",i&&"edge".concat((0,Op.Z)(i))],input:["input"]};return(0,Lp.Z)(o,Gy,e)}(D);return(0,Zp.jsxs)(Xy,(0,Ap.Z)({component:"span",className:(0,Mp.Z)(N.root,o),centerRipple:!0,focusRipple:!c,disabled:L,tabIndex:null,role:void 0,onFocus:function(t){x&&x(t),M&&M.onFocus&&M.onFocus(t)},onBlur:function(t){y&&y(t),M&&M.onBlur&&M.onBlur(t)},ownerState:D,ref:e},C,{children:[(0,Zp.jsx)(Hy,(0,Ap.Z)({autoFocus:n,checked:r,defaultChecked:a,className:N.input,disabled:L,id:R&&d,name:v,onChange:function(t){if(!t.nativeEvent.defaultPrevented){var e=t.target.checked;A(e),_&&_(t,e)}},readOnly:b,ref:g,required:w,ownerState:D,tabIndex:S,type:E},"checkbox"===E&&void 0===k?{}:{value:k},m)),P?i:p]}))})),$y=Yy,Ky=(0,Zg.Z)((0,Zp.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),Jy=(0,Zg.Z)((0,Zp.jsx)("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked");(0,Dp.ZP)("span")({position:"relative",display:"flex"}),(0,Dp.ZP)(Ky)({transform:"scale(1)"}),(0,Dp.ZP)(Jy)((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest})},n.checked&&{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})})}));n(1260);var Qy=(0,jp.Z)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]);(0,Dp.ZP)($y,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiRadio",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e["color".concat((0,Op.Z)(n.color))]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({color:(e.vars||e).palette.text.secondary},!n.disableRipple&&{"&:hover":{backgroundColor:e.vars?"rgba(".concat("default"===n.color?e.vars.palette.action.activeChannel:e.vars.palette[n.color].mainChannel," / ").concat(e.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)("default"===n.color?e.palette.action.active:e.palette[n.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==n.color&&(0,s.Z)({},"&.".concat(Qy.checked),{color:(e.vars||e).palette[n.color].main}),(0,s.Z)({},"&.".concat(Qy.disabled),{color:(e.vars||e).palette.action.disabled}))}));var t_=n(5735);function e_(t){return(0,Up.Z)("MuiButton",t)}var n_=(0,jp.Z)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var r_=t.createContext({}),i_=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],o_=function(t){return(0,Ap.Z)({},"small"===t.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===t.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===t.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},a_=(0,Dp.ZP)(ky,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiButton",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.variant],e["".concat(n.variant).concat((0,Op.Z)(n.color))],e["size".concat((0,Op.Z)(n.size))],e["".concat(n.variant,"Size").concat((0,Op.Z)(n.size))],"inherit"===n.color&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})((function(t){var e,n,r,i=t.theme,o=t.ownerState;return(0,Ap.Z)({},i.typography.button,(e={minWidth:64,padding:"6px 16px",borderRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create(["background-color","box-shadow","border-color","color"],{duration:i.transitions.duration.short}),"&:hover":(0,Ap.Z)({textDecoration:"none",backgroundColor:i.vars?"rgba(".concat(i.vars.palette.text.primaryChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)(i.palette.text.primary,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===o.variant&&"inherit"!==o.color&&{backgroundColor:i.vars?"rgba(".concat(i.vars.palette[o.color].mainChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)(i.palette[o.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===o.variant&&"inherit"!==o.color&&{border:"1px solid ".concat((i.vars||i).palette[o.color].main),backgroundColor:i.vars?"rgba(".concat(i.vars.palette[o.color].mainChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)(i.palette[o.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===o.variant&&{backgroundColor:(i.vars||i).palette.grey.A100,boxShadow:(i.vars||i).shadows[4],"@media (hover: none)":{boxShadow:(i.vars||i).shadows[2],backgroundColor:(i.vars||i).palette.grey[300]}},"contained"===o.variant&&"inherit"!==o.color&&{backgroundColor:(i.vars||i).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(i.vars||i).palette[o.color].main}}),"&:active":(0,Ap.Z)({},"contained"===o.variant&&{boxShadow:(i.vars||i).shadows[8]})},(0,s.Z)(e,"&.".concat(n_.focusVisible),(0,Ap.Z)({},"contained"===o.variant&&{boxShadow:(i.vars||i).shadows[6]})),(0,s.Z)(e,"&.".concat(n_.disabled),(0,Ap.Z)({color:(i.vars||i).palette.action.disabled},"outlined"===o.variant&&{border:"1px solid ".concat((i.vars||i).palette.action.disabledBackground)},"outlined"===o.variant&&"secondary"===o.color&&{border:"1px solid ".concat((i.vars||i).palette.action.disabled)},"contained"===o.variant&&{color:(i.vars||i).palette.action.disabled,boxShadow:(i.vars||i).shadows[0],backgroundColor:(i.vars||i).palette.action.disabledBackground})),e),"text"===o.variant&&{padding:"6px 8px"},"text"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].main},"outlined"===o.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].main,border:i.vars?"1px solid rgba(".concat(i.vars.palette[o.color].mainChannel," / 0.5)"):"1px solid ".concat((0,Td.Fq)(i.palette[o.color].main,.5))},"contained"===o.variant&&{color:i.vars?i.vars.palette.text.primary:null==(n=(r=i.palette).getContrastText)?void 0:n.call(r,i.palette.grey[300]),backgroundColor:(i.vars||i).palette.grey[300],boxShadow:(i.vars||i).shadows[2]},"contained"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].contrastText,backgroundColor:(i.vars||i).palette[o.color].main},"inherit"===o.color&&{color:"inherit",borderColor:"currentColor"},"small"===o.size&&"text"===o.variant&&{padding:"4px 5px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"text"===o.variant&&{padding:"8px 11px",fontSize:i.typography.pxToRem(15)},"small"===o.size&&"outlined"===o.variant&&{padding:"3px 9px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"outlined"===o.variant&&{padding:"7px 21px",fontSize:i.typography.pxToRem(15)},"small"===o.size&&"contained"===o.variant&&{padding:"4px 10px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"contained"===o.variant&&{padding:"8px 22px",fontSize:i.typography.pxToRem(15)},o.fullWidth&&{width:"100%"})}),(function(t){var e;return t.ownerState.disableElevation&&(e={boxShadow:"none","&:hover":{boxShadow:"none"}},(0,s.Z)(e,"&.".concat(n_.focusVisible),{boxShadow:"none"}),(0,s.Z)(e,"&:active",{boxShadow:"none"}),(0,s.Z)(e,"&.".concat(n_.disabled),{boxShadow:"none"}),e)})),s_=(0,Dp.ZP)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(t,e){var n=t.ownerState;return[e.startIcon,e["iconSize".concat((0,Op.Z)(n.size))]]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({display:"inherit",marginRight:8,marginLeft:-4},"small"===e.size&&{marginLeft:-2},o_(e))})),l_=(0,Dp.ZP)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(t,e){var n=t.ownerState;return[e.endIcon,e["iconSize".concat((0,Op.Z)(n.size))]]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({display:"inherit",marginRight:-4,marginLeft:8},"small"===e.size&&{marginRight:-2},o_(e))})),u_=t.forwardRef((function(e,n){var r=t.useContext(r_),i=(0,t_.Z)(r,e),o=(0,Rp.Z)({props:i,name:"MuiButton"}),a=o.children,s=o.color,l=void 0===s?"primary":s,u=o.component,c=void 0===u?"button":u,h=o.className,f=o.disabled,p=void 0!==f&&f,d=o.disableElevation,m=void 0!==d&&d,g=o.disableFocusRipple,v=void 0!==g&&g,y=o.endIcon,_=o.focusVisibleClassName,x=o.fullWidth,b=void 0!==x&&x,w=o.size,S=void 0===w?"medium":w,E=o.startIcon,k=o.type,C=o.variant,I=void 0===C?"text":C,T=(0,Pp.Z)(o,i_),P=(0,Ap.Z)({},o,{color:l,component:c,disabled:p,disableElevation:m,disableFocusRipple:v,fullWidth:b,size:S,type:k,variant:I}),A=function(t){var e=t.color,n=t.disableElevation,r=t.fullWidth,i=t.size,o=t.variant,a=t.classes,s={root:["root",o,"".concat(o).concat((0,Op.Z)(e)),"size".concat((0,Op.Z)(i)),"".concat(o,"Size").concat((0,Op.Z)(i)),"inherit"===e&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat((0,Op.Z)(i))],endIcon:["endIcon","iconSize".concat((0,Op.Z)(i))]},l=(0,Lp.Z)(s,e_,a);return(0,Ap.Z)({},a,l)}(P),M=E&&(0,Zp.jsx)(s_,{className:A.startIcon,ownerState:P,children:E}),L=y&&(0,Zp.jsx)(l_,{className:A.endIcon,ownerState:P,children:y});return(0,Zp.jsxs)(a_,(0,Ap.Z)({ownerState:P,className:(0,Mp.Z)(r.className,A.root,h),component:c,disabled:p,focusRipple:!v,focusVisibleClassName:(0,Mp.Z)(A.focusVisible,_),ref:n,type:k},T,{classes:A,children:[M,a,L]}))})),c_=u_;(0,jp.Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var h_,f_,p_,d_,m_,g_,v_,y_,__=jn(m_||(m_=h_||(h_=i(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),x_=jn(g_||(g_=f_||(f_=i(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"]))));(0,Dp.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.variant],e["color".concat((0,Op.Z)(n.color))]]}})((function(t){var e=t.ownerState,n=t.theme;return(0,Ap.Z)({display:"inline-block"},"determinate"===e.variant&&{transition:n.transitions.create("transform")},"inherit"!==e.color&&{color:(n.vars||n).palette[e.color].main})}),(function(t){return"indeterminate"===t.ownerState.variant&&Bn(v_||(v_=p_||(p_=i(["\n      animation: "," 1.4s linear infinite;\n    "]))),__)})),(0,Dp.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:function(t,e){return e.svg}})({display:"block"}),(0,Dp.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:function(t,e){var n=t.ownerState;return[e.circle,e["circle".concat((0,Op.Z)(n.variant))],n.disableShrink&&e.circleDisableShrink]}})((function(t){var e=t.ownerState,n=t.theme;return(0,Ap.Z)({stroke:"currentColor"},"determinate"===e.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(function(t){var e=t.ownerState;return"indeterminate"===e.variant&&!e.disableShrink&&Bn(y_||(y_=d_||(d_=i(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),x_)})),n(4434);function b_(t,e){if(void 0===t.inserted[e.name])return t.insert("",e,t.sheet,!0)}function w_(t,e,n){var r=[],i=(0,Nn.fp)(t,r,n);return r.length<2?n:i+e(r)}var S_=function t(e){for(var n="",r=0;r<e.length;r++){var i=e[r];if(null!=i){var o=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))o=t(i);else for(var a in o="",i)i[a]&&a&&(o&&(o+=" "),o+=a);break;default:o=i}o&&(n&&(n+=" "),n+=o)}}return n},E_=function(t){var e=(0,Rn.Z)(t);e.sheet.speedy=function(t){this.isSpeedy=t},e.compat=!0;var n=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(0,zn.O)(n,e.registered,void 0);return(0,Nn.My)(e,i,!1),e.key+"-"+i.name};return{css:n,cx:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return w_(e.registered,n,S_(r))},injectGlobal:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(0,zn.O)(n,e.registered);b_(e,i)},keyframes:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(0,zn.O)(n,e.registered),o="animation-"+i.name;return b_(e,{name:i.name,styles:"@keyframes "+o+"{"+i.styles+"}"}),o},hydrate:function(t){t.forEach((function(t){e.inserted[t]=!0}))},flush:function(){e.registered={},e.inserted={},e.sheet.flush()},sheet:e.sheet,cache:e,getRegisteredStyles:Nn.fp.bind(null,e.registered),merge:w_.bind(null,e.registered,n)}},k_=E_({key:"css"}),C_=(k_.flush,k_.hydrate,k_.cx,k_.merge,k_.getRegisteredStyles,k_.injectGlobal,k_.keyframes,k_.css),I_=(k_.sheet,k_.cache,n(1380),function(t){return void 0!==t}),T_=function(t,e,n){return e in t?t[e]:t[e]=n},P_=1,A_=3,M_=4;function L_(t,e){return R_(t,e,[]).join("")}function R_(t,e,n){var r;if(t.nodeType===M_||t.nodeType===A_)e?n.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):n.push(t.nodeValue);else for(r=t.firstChild;r;r=r.nextSibling)R_(r,e,n);return n}function D_(t,e,n,r){for(var i=function(t){var e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==P_;)e=e.nextSibling;return e}(e);i;i=N_(i)){var o=t[i.namespaceURI||null];if(I_(o)){var a=o[i.localName];I_(a)&&a.call(r,i,n)}}}function N_(t){for(var e=t.nextElementSibling||t.nextSibling;e&&e.nodeType!==P_;)e=e.nextSibling;return e}function z_(t,e,n){return function(t,e,n){var r,i,o=I_(n)?n:{};for(r=0,i=t.length;r<i;++r)o[t[r]]=e;return o}(t,e,n)}function O_(t,e){return function(n,r){var i=t.call(I_(e)?e:this,n,r);I_(i)&&r[r.length-1].push(i)}}function F_(t,e,n,r,i){return r.push(t),D_(e,n,r,i),r.pop()}function B_(t,e,n){return function(r,i){var o=t.call(I_(n)?n:this,r,i);I_(o)&&(i[i.length-1][I_(e)?e:r.localName]=o)}}function j_(t,e,n){return function(r,i){var o=t.call(I_(n)?n:this,r,i);if(I_(o)){var a=i[i.length-1],s=I_(e)?e:r.localName;T_(a,s,[]).push(o)}}}var U_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function V_(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?I_(e[1])||!1:void 0}function Z_(t){return q_(L_(t,!1))}function q_(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function G_(t){return W_(L_(t,!1))}function W_(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function X_(t){return L_(t,!1).replace(U_,"")}function H_(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}function Y_(t){return[q_(t.getAttribute("minx")),q_(t.getAttribute("miny")),q_(t.getAttribute("maxx")),q_(t.getAttribute("maxy"))]}function $_(t,e){return F_({},mx,t,e)}function K_(t,e){return F_({},hx,t,e)}function J_(t,e){var n=$_(t,e);if(I_(n)){var r=[W_(t.getAttribute("width")),W_(t.getAttribute("height"))];return n.size=r,n}}function Q_(t,e){return F_([],gx,t,e)}var tx=[null,"http://www.opengis.net/wms"],ex=(z_(tx,{Service:B_((function(t,e){return F_({},nx,t,e)})),Capability:B_((function(t,e){return F_({},ex,t,e)}))}),z_(tx,{Request:B_((function(t,e){return F_({},cx,t,e)})),Exception:B_((function(t,e){return F_([],ax,t,e)})),Layer:B_((function(t,e){var n=V_(t.getAttribute("queryable"));return F_({queryable:!!I_(n)&&n},sx,t,e)}))})),nx=z_(tx,{Name:B_(X_),Title:B_(X_),Abstract:B_(X_),KeywordList:B_(Q_),OnlineResource:B_(H_),ContactInformation:B_((function(t,e){return F_({},rx,t,e)})),Fees:B_(X_),AccessConstraints:B_(X_),LayerLimit:B_(G_),MaxWidth:B_(G_),MaxHeight:B_(G_)}),rx=z_(tx,{ContactPersonPrimary:B_((function(t,e){return F_({},ix,t,e)})),ContactPosition:B_(X_),ContactAddress:B_((function(t,e){return F_({},ox,t,e)})),ContactVoiceTelephone:B_(X_),ContactFacsimileTelephone:B_(X_),ContactElectronicMailAddress:B_(X_)}),ix=z_(tx,{ContactPerson:B_(X_),ContactOrganization:B_(X_)}),ox=z_(tx,{AddressType:B_(X_),Address:B_(X_),City:B_(X_),StateOrProvince:B_(X_),PostCode:B_(X_),Country:B_(X_)}),ax=z_(tx,{Format:O_(X_)}),sx=z_(tx,{Name:B_(X_),Title:B_(X_),Abstract:B_(X_),KeywordList:B_(Q_),CRS:j_(X_),SRS:j_(X_),EX_GeographicBoundingBox:B_((function(t,e){var n=F_({},ux,t,e);if(I_(n)){var r=n.westBoundLongitude,i=n.southBoundLatitude,o=n.eastBoundLongitude,a=n.northBoundLatitude;if(I_(r)&&I_(i)&&I_(o)&&I_(a))return[r,i,o,a]}})),LatLonBoundingBox:B_((function(t,e){var n=Y_(t);if(I_(n[0])&&I_(n[1])&&I_(n[2])&&I_(n[3]))return n})),BoundingBox:j_((function(t,e){var n=Y_(t),r=[q_(t.getAttribute("resx")),q_(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:n,res:r}})),Dimension:j_((function(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:V_(t.getAttribute("multipleValues")),nearestValue:V_(t.getAttribute("nearestValue")),current:V_(t.getAttribute("current")),values:X_(t)}})),Attribution:B_((function(t,e){return F_({},lx,t,e)})),AuthorityURL:j_((function(t,e){var n=$_(t,e);if(I_(n))return n.name=t.getAttribute("name"),n})),Identifier:j_(X_),MetadataURL:j_((function(t,e){var n=$_(t,e);if(I_(n))return n.type=t.getAttribute("type"),n})),DataURL:j_($_),FeatureListURL:j_($_),Style:j_((function(t,e){return F_({},dx,t,e)})),MinScaleDenominator:B_(Z_),MaxScaleDenominator:B_(Z_),ScaleHint:B_((function(t,e){return{min:parseFloat(t.getAttribute("min")),max:parseFloat(t.getAttribute("max"))}})),Layer:j_((function(t,e){var n=e[e.length-1],r=F_({},sx,t,e);if(I_(r)){var i=V_(t.getAttribute("queryable"));I_(i)||(i=n.queryable),r.queryable=!!I_(i)&&i;var o=W_(t.getAttribute("cascaded"));I_(o)||(o=n.cascaded),r.cascaded=o;var a=V_(t.getAttribute("opaque"));I_(a)||(a=n.opaque),r.opaque=!!I_(a)&&a;var s=V_(t.getAttribute("noSubsets"));I_(s)||(s=n.noSubsets),r.noSubsets=!!I_(s)&&s;var l=q_(t.getAttribute("fixedWidth"));I_(l)||(l=n.fixedWidth),r.fixedWidth=l;var u=q_(t.getAttribute("fixedHeight"));I_(u)||(u=n.fixedHeight),r.fixedHeight=u;for(var c=["Style","CRS","AuthorityURL"],h=0,f=c.length;h<f;h++){var p=c[h],d=n[p];if(I_(d)){var m=T_(r,p,[]);m=m.concat(d),r[p]=m}}for(var g=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"],v=0,y=g.length;v<y;v++){var _=g[v],x=r[_];if(!I_(x)){var b=n[_];r[_]=b}}return r}}))}),lx=z_(tx,{Title:B_(X_),OnlineResource:B_(H_),LogoURL:B_(J_)}),ux=z_(tx,{westBoundLongitude:B_(Z_),eastBoundLongitude:B_(Z_),southBoundLatitude:B_(Z_),northBoundLatitude:B_(Z_)}),cx=z_(tx,{GetCapabilities:B_(K_),GetMap:B_(K_),GetFeatureInfo:B_(K_)}),hx=z_(tx,{Format:j_(X_),DCPType:j_((function(t,e){return F_({},fx,t,e)}))}),fx=z_(tx,{HTTP:B_((function(t,e){return F_({},px,t,e)}))}),px=z_(tx,{Get:B_($_),Post:B_($_)}),dx=z_(tx,{Name:B_(X_),Title:B_(X_),Abstract:B_(X_),LegendURL:j_(J_),StyleSheetURL:B_($_),StyleURL:B_($_)}),mx=z_(tx,{Format:B_(X_),OnlineResource:B_(H_)}),gx=z_(tx,{Keyword:O_(X_)});function vx(){}function yx(t){return null==t?vx:function(){return this.querySelector(t)}}function _x(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function xx(){return[]}function bx(t){return null==t?xx:function(){return this.querySelectorAll(t)}}function wx(t){return function(){return this.matches(t)}}function Sx(t){return function(e){return e.matches(t)}}var Ex=Array.prototype.find;function kx(){return this.firstElementChild}var Cx=Array.prototype.filter;function Ix(){return Array.from(this.children)}function Tx(t){return new Array(t.length)}function Px(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ax(t){return function(){return t}}function Mx(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Px(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function Lx(t,e,n,r,i,o,a){var s,l,u,c=new Map,h=e.length,f=o.length,p=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(p[s]=u=a.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<f;++s)u=a.call(t,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new Px(t,o[s]);for(s=0;s<h;++s)(l=e[s])&&c.get(p[s])===l&&(i[s]=l)}function Rx(t){return t.__data__}function Dx(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function Nx(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Px.prototype={constructor:Px,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var zx=n(7762);var Ox="http://www.w3.org/1999/xhtml",Fx={svg:"http://www.w3.org/2000/svg",xhtml:Ox,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Bx(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Fx.hasOwnProperty(e)?{space:Fx[e],local:t}:t}function jx(t){return function(){this.removeAttribute(t)}}function Ux(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vx(t,e){return function(){this.setAttribute(t,e)}}function Zx(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qx(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Gx(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Wx(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xx(t){return function(){this.style.removeProperty(t)}}function Hx(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Yx(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function $x(t,e){return t.style.getPropertyValue(e)||Wx(t).getComputedStyle(t,null).getPropertyValue(e)}function Kx(t){return function(){delete this[t]}}function Jx(t,e){return function(){this[t]=e}}function Qx(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function tb(t){return t.trim().split(/^|\s+/)}function eb(t){return t.classList||new nb(t)}function nb(t){this._node=t,this._names=tb(t.getAttribute("class")||"")}function rb(t,e){for(var n=eb(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function ib(t,e){for(var n=eb(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ob(t){return function(){rb(this,t)}}function ab(t){return function(){ib(this,t)}}function sb(t,e){return function(){(e.apply(this,arguments)?rb:ib)(this,t)}}function lb(){this.textContent=""}function ub(t){return function(){this.textContent=t}}function cb(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function hb(){this.innerHTML=""}function fb(t){return function(){this.innerHTML=t}}function pb(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function db(){this.nextSibling&&this.parentNode.appendChild(this)}function mb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gb(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ox&&e.documentElement.namespaceURI===Ox?e.createElement(t):e.createElementNS(n,t)}}function vb(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function yb(t){var e=Bx(t);return(e.local?vb:gb)(e)}function _b(){return null}function xb(){var t=this.parentNode;t&&t.removeChild(this)}function bb(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wb(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Sb(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Eb(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function kb(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Cb(t,e,n){var r=Wx(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ib(t,e){return function(){return Cb(this,t,e)}}function Tb(t,e){return function(){return Cb(this,t,e.apply(this,arguments))}}nb.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Pb=n(4165),Ab=(0,Pb.Z)().mark(Mb);function Mb(){var t,e,n,r,i,o,a;return(0,Pb.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:t=this._groups,e=0,n=t.length;case 1:if(!(e<n)){s.next=13;break}r=t[e],i=0,o=r.length;case 3:if(!(i<o)){s.next=10;break}if(!(a=r[i])){s.next=7;break}return s.next=7,a;case 7:++i,s.next=3;break;case 10:++e,s.next=1;break;case 13:case"end":return s.stop()}}),Ab,this)}var Lb=[null];function Rb(t,e){this._groups=t,this._parents=e}function Db(){return new Rb([[document.documentElement]],Lb)}Rb.prototype=Db.prototype=(0,s.Z)({constructor:Rb,select:function(t){"function"!==typeof t&&(t=yx(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new Rb(r,this._parents)},selectAll:function(t){t="function"===typeof t?function(t){return function(){return _x(t.apply(this,arguments))}}(t):bx(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new Rb(r,i)},selectChild:function(t){return this.select(null==t?kx:function(t){return function(){return Ex.call(this.children,t)}}("function"===typeof t?t:Sx(t)))},selectChildren:function(t){return this.selectAll(null==t?Ix:function(t){return function(){return Cx.call(this.children,t)}}("function"===typeof t?t:Sx(t)))},filter:function(t){"function"!==typeof t&&(t=wx(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new Rb(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Rx);var n=e?Lx:Mx,r=this._parents,i=this._groups;"function"!==typeof t&&(t=Ax(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],h=i[u],f=h.length,p=Dx(t.call(c,c&&c.__data__,u,r)),d=p.length,m=s[u]=new Array(d),g=a[u]=new Array(d),v=l[u]=new Array(f);n(c,h,m,g,v,p,e);for(var y,_,x=0,b=0;x<d;++x)if(y=m[x]){for(x>=b&&(b=x+1);!(_=g[b])&&++b<d;);y._next=_||null}}return(a=new Rb(a,r))._enter=s,a._exit=l,a},enter:function(){return new Rb(this._enter||this._groups.map(Tx),this._parents)},exit:function(){return new Rb(this._exit||this._groups.map(Tx),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"===typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],h=r[l],f=c.length,p=s[l]=new Array(f),d=0;d<f;++d)(u=c[d]||h[d])&&(p[d]=u);for(;l<i;++l)s[l]=n[l];return new Rb(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Nx);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new Rb(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t,e=0,n=(0,zx.Z)(this);try{for(n.s();!(t=n.n()).done;){t.value;++e}}catch(r){n.e(r)}finally{n.f()}return e},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=Bx(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ux:jx:"function"===typeof e?n.local?Gx:qx:n.local?Zx:Vx)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Xx:"function"===typeof e?Yx:Hx)(t,e,null==n?"":n)):$x(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Kx:"function"===typeof e?Qx:Jx)(t,e)):this.node()[t]},classed:function(t,e){var n=tb(t+"");if(arguments.length<2){for(var r=eb(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?sb:e?ob:ab)(n,e))},text:function(t){return arguments.length?this.each(null==t?lb:("function"===typeof t?cb:ub)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?hb:("function"===typeof t?pb:fb)(t)):this.node().innerHTML},raise:function(){return this.each(db)},lower:function(){return this.each(mb)},append:function(t){var e="function"===typeof t?t:yb(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:yb(t),r=null==e?_b:"function"===typeof e?e:yx(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(xb)},clone:function(t){return this.select(t?wb:bb)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=Sb(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?kb:Eb,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"===typeof e?Tb:Ib)(t,e))}},Symbol.iterator,Mb);var Nb=Db,zb={value:function(){}};function Ob(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Fb(r)}function Fb(t){this._=t}function Bb(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function jb(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Ub(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=zb,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Fb.prototype=Ob.prototype={constructor:Fb,on:function(t,e){var n,r=this._,i=Bb(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Ub(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ub(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=jb(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Fb(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Vb,Zb,qb=Ob,Gb=0,Wb=0,Xb=0,Hb=0,Yb=0,$b=0,Kb="object"===typeof performance&&performance.now?performance:Date,Jb="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Qb(){return Yb||(Jb(tw),Yb=Kb.now()+$b)}function tw(){Yb=0}function ew(){this._call=this._time=this._next=null}function nw(t,e,n){var r=new ew;return r.restart(t,e,n),r}function rw(){Yb=(Hb=Kb.now())+$b,Gb=Wb=0;try{!function(){Qb(),++Gb;for(var t,e=Vb;e;)(t=Yb-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Gb}()}finally{Gb=0,function(){var t,e,n=Vb,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Vb=e);Zb=t,ow(r)}(),Yb=0}}function iw(){var t=Kb.now(),e=t-Hb;e>1e3&&($b-=e,Hb=t)}function ow(t){Gb||(Wb&&(Wb=clearTimeout(Wb)),t-Yb>24?(t<1/0&&(Wb=setTimeout(rw,t-Kb.now()-$b)),Xb&&(Xb=clearInterval(Xb))):(Xb||(Hb=Kb.now(),Xb=setInterval(iw,1e3)),Gb=1,Jb(rw)))}function aw(t,e,n){var r=new ew;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r}ew.prototype=nw.prototype={constructor:ew,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?Qb():+n)+(null==e?0:+e),this._next||Zb===this||(Zb?Zb._next=this:Vb=this,Zb=this),this._call=t,this._time=n,ow()},stop:function(){this._call&&(this._call=null,this._time=1/0,ow())}};var sw=qb("start","end","cancel","interrupt"),lw=[];function uw(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var u,c,h,f;if(1!==n.state)return l();for(u in i)if((f=i[u]).name===n.name){if(3===f.state)return aw(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(aw((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=nw(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:sw,tween:lw,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function cw(t,e){var n=fw(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function hw(t,e){var n=fw(t,e);if(n.state>3)throw new Error("too late; already running");return n}function fw(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function pw(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var dw,mw=180/Math.PI,gw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vw(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*mw,skewX:Math.atan(l)*mw,scaleX:a,scaleY:s}}function yw(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:pw(t,i)},{i:l-2,x:pw(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:pw(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:pw(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:pw(t,n)},{i:s-2,x:pw(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var _w=yw((function(t){var e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gw:vw(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),xw=yw((function(t){return null==t?gw:(dw||(dw=document.createElementNS("http://www.w3.org/2000/svg","g")),dw.setAttribute("transform",t),(t=dw.transform.baseVal.consolidate())?vw((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):gw)}),", ",")",")");function bw(t,e){var n,r;return function(){var i=hw(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function ww(t,e,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=hw(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function Sw(t,e,n){var r=t._id;return t.each((function(){var t=hw(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return fw(t,r).value[e]}}function Ew(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function kw(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Cw(){}var Iw=.7,Tw=1/Iw,Pw="\\s*([+-]?\\d+)\\s*",Aw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Lw=/^#([0-9a-f]{3,8})$/,Rw=new RegExp("^rgb\\(".concat(Pw,",").concat(Pw,",").concat(Pw,"\\)$")),Dw=new RegExp("^rgb\\(".concat(Mw,",").concat(Mw,",").concat(Mw,"\\)$")),Nw=new RegExp("^rgba\\(".concat(Pw,",").concat(Pw,",").concat(Pw,",").concat(Aw,"\\)$")),zw=new RegExp("^rgba\\(".concat(Mw,",").concat(Mw,",").concat(Mw,",").concat(Aw,"\\)$")),Ow=new RegExp("^hsl\\(".concat(Aw,",").concat(Mw,",").concat(Mw,"\\)$")),Fw=new RegExp("^hsla\\(".concat(Aw,",").concat(Mw,",").concat(Mw,",").concat(Aw,"\\)$")),Bw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function jw(){return this.rgb().formatHex()}function Uw(){return this.rgb().formatRgb()}function Vw(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Lw.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Zw(e):3===n?new Xw(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?qw(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?qw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Rw.exec(t))?new Xw(e[1],e[2],e[3],1):(e=Dw.exec(t))?new Xw(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Nw.exec(t))?qw(e[1],e[2],e[3],e[4]):(e=zw.exec(t))?qw(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ow.exec(t))?Qw(e[1],e[2]/100,e[3]/100,1):(e=Fw.exec(t))?Qw(e[1],e[2]/100,e[3]/100,e[4]):Bw.hasOwnProperty(t)?Zw(Bw[t]):"transparent"===t?new Xw(NaN,NaN,NaN,0):null}function Zw(t){return new Xw(t>>16&255,t>>8&255,255&t,1)}function qw(t,e,n,r){return r<=0&&(t=e=n=NaN),new Xw(t,e,n,r)}function Gw(t){return t instanceof Cw||(t=Vw(t)),t?new Xw((t=t.rgb()).r,t.g,t.b,t.opacity):new Xw}function Ww(t,e,n,r){return 1===arguments.length?Gw(t):new Xw(t,e,n,null==r?1:r)}function Xw(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Hw(){return"#".concat(Jw(this.r)).concat(Jw(this.g)).concat(Jw(this.b))}function Yw(){var t=$w(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(Kw(this.r),", ").concat(Kw(this.g),", ").concat(Kw(this.b)).concat(1===t?")":", ".concat(t,")"))}function $w(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Kw(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jw(t){return((t=Kw(t))<16?"0":"")+t.toString(16)}function Qw(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new eS(t,e,n,r)}function tS(t){if(t instanceof eS)return new eS(t.h,t.s,t.l,t.opacity);if(t instanceof Cw||(t=Vw(t)),!t)return new eS;if(t instanceof eS)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new eS(a,s,l,t.opacity)}function eS(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function nS(t){return(t=(t||0)%360)<0?t+360:t}function rS(t){return Math.max(0,Math.min(1,t||0))}function iS(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function oS(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Ew(Cw,Vw,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:jw,formatHex:jw,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return tS(this).formatHsl()},formatRgb:Uw,toString:Uw}),Ew(Xw,Ww,kw(Cw,{brighter:function(t){return t=null==t?Tw:Math.pow(Tw,t),new Xw(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Iw:Math.pow(Iw,t),new Xw(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new Xw(Kw(this.r),Kw(this.g),Kw(this.b),$w(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hw,formatHex:Hw,formatHex8:function(){return"#".concat(Jw(this.r)).concat(Jw(this.g)).concat(Jw(this.b)).concat(Jw(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Yw,toString:Yw})),Ew(eS,(function(t,e,n,r){return 1===arguments.length?tS(t):new eS(t,e,n,null==r?1:r)}),kw(Cw,{brighter:function(t){return t=null==t?Tw:Math.pow(Tw,t),new eS(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Iw:Math.pow(Iw,t),new eS(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Xw(iS(t>=240?t-240:t+120,i,r),iS(t,i,r),iS(t<120?t+240:t-120,i,r),this.opacity)},clamp:function(){return new eS(nS(this.h),rS(this.s),rS(this.l),$w(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=$w(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(nS(this.h),", ").concat(100*rS(this.s),"%, ").concat(100*rS(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));var aS=function(t){return function(){return t}};function sS(t,e){return function(n){return t+n*e}}function lS(t){return 1===(t=+t)?uS:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):aS(isNaN(e)?n:e)}}function uS(t,e){var n=e-t;return n?sS(t,n):aS(isNaN(t)?e:t)}var cS=function t(e){var n=lS(e);function r(t,e){var r=n((t=Ww(t)).r,(e=Ww(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=uS(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function hS(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ww(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}hS((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return oS((n-r/e)*e,a,i,o,s)}})),hS((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return oS((n-r/e)*e,i,o,a,s)}}));var fS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pS=new RegExp(fS.source,"g");function dS(t,e){var n,r,i,o=fS.lastIndex=pS.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=fS.exec(t))&&(r=pS.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:pw(n,r)})),o=pS.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function mS(t,e){var n;return("number"===typeof e?pw:e instanceof Vw?cS:(n=Vw(e))?(e=n,cS):dS)(t,e)}function gS(t){return function(){this.removeAttribute(t)}}function vS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function yS(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function _S(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function xS(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function bS(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function wS(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function SS(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ES(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&SS(t,i)),n}return i._value=e,i}function kS(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&wS(t,i)),n}return i._value=e,i}function CS(t,e){return function(){cw(this,t).delay=+e.apply(this,arguments)}}function IS(t,e){return e=+e,function(){cw(this,t).delay=e}}function TS(t,e){return function(){hw(this,t).duration=+e.apply(this,arguments)}}function PS(t,e){return e=+e,function(){hw(this,t).duration=e}}function AS(t,e){if("function"!==typeof e)throw new Error;return function(){hw(this,t).ease=e}}function MS(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?cw:hw;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var LS=Nb.prototype.constructor;function RS(t){return function(){this.style.removeProperty(t)}}function DS(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function NS(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&DS(t,o,n)),r}return o._value=e,o}function zS(t){return function(e){this.textContent=t.call(this,e)}}function OS(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&zS(r)),e}return r._value=t,r}var FS=0;function BS(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function jS(){return++FS}var US=Nb.prototype;BS.prototype=function(t){return Nb().transition(t)}.prototype=(0,s.Z)({constructor:BS,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=yx(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,h=o[a]=new Array(c),f=0;f<c;++f)(s=u[f])&&(l=t.call(s,s.__data__,f,u))&&("__data__"in s&&(l.__data__=s.__data__),h[f]=l,uw(h[f],e,n,f,h,fw(s,n)));return new BS(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=bx(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,p=t.call(l,l.__data__,h,u),d=fw(l,n),m=0,g=p.length;m<g;++m)(f=p[m])&&uw(f,e,n,m,p,d);o.push(p),a.push(l)}return new BS(o,a,e,n)},selectChild:US.selectChild,selectChildren:US.selectChildren,filter:function(t){"function"!==typeof t&&(t=wx(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new BS(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],h=u.length,f=a[s]=new Array(h),p=0;p<h;++p)(l=u[p]||c[p])&&(f[p]=l);for(;s<r;++s)a[s]=e[s];return new BS(a,this._parents,this._name,this._id)},selection:function(){return new LS(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=jS(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=fw(a,e);uw(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new BS(r,this._parents,t,n)},call:US.call,nodes:US.nodes,node:US.node,size:US.size,empty:US.empty,each:US.each,on:function(t,e){var n=this._id;return arguments.length<2?fw(this.node(),n).on.on(t):this.each(MS(n,t,e))},attr:function(t,e){var n=Bx(t),r="transform"===n?xw:mS;return this.attrTween(t,"function"===typeof e?(n.local?bS:xS)(n,r,Sw(this,"attr."+t,e)):null==e?(n.local?vS:gS)(n):(n.local?_S:yS)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=Bx(t);return this.tween(n,(r.local?ES:kS)(r,e))},style:function(t,e,n){var r="transform"===(t+="")?_w:mS;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=$x(this,t),a=(this.style.removeProperty(t),$x(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,RS(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=$x(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=$x(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,Sw(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=hw(this,t),u=l.on,c=null==l.value[a]?o||(o=RS(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=$x(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,NS(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Sw(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,OS(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=fw(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?bw:ww)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?CS:IS)(e,t)):fw(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?TS:PS)(e,t)):fw(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(AS(e,t)):fw(this.node(),e).ease},easeVarying:function(t){if("function"!==typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!==typeof n)throw new Error;hw(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0===--i&&o()}};n.each((function(){var n=hw(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))}},Symbol.iterator,US[Symbol.iterator]);var VS={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function ZS(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}Nb.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},Nb.prototype.transition=function(t){var e,n;t instanceof BS?(e=t._id,t=t._name):(e=jS(),(n=VS).time=Qb(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&uw(a,t,e,u,s,n||ZS(a,e));return new BS(r,this._parents,t,e)};Math.abs,Math.max,Math.min;function qS(t){return[+t[0],+t[1]]}function GS(t){return[qS(t[0]),qS(t[1])]}["w","e"].map(WS),["n","s"].map(WS),["n","w","e","s","nw","ne","sw","se"].map(WS);function WS(t){return{type:t}}var XS={},HS={};function YS(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function $S(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function KS(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function JS(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+KS(-e,6):e>9999?"+"+KS(e,6):KS(e,4))+"-"+KS(t.getUTCMonth()+1,2)+"-"+KS(t.getUTCDate(),2)+(o?"T"+KS(n,2)+":"+KS(r,2)+":"+KS(i,2)+"."+KS(o,3)+"Z":i?"T"+KS(n,2)+":"+KS(r,2)+":"+KS(i,2)+"Z":r||n?"T"+KS(n,2)+":"+KS(r,2)+"Z":"")}function QS(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return HS;if(u)return u=!1,XS;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?l=!0:10===(r=t.charCodeAt(a++))?u=!0:13===r&&(u=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))u=!0;else if(13===r)u=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=c())!==HS;){for(var h=[];r!==XS&&r!==HS;)h.push(r),r=c();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?JS(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=YS(t);return function(r,i){return e(n(r),i,t)}}(t,e):YS(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=$S(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=$S(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var tE=QS(","),eE=tE.parse,nE=(tE.parseRows,tE.format,tE.formatBody,tE.formatRows,tE.formatRow,tE.formatValue,QS("\t")),rE=nE.parse;nE.parseRows,nE.format,nE.formatBody,nE.formatRows,nE.formatRow,nE.formatValue;function iE(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function oE(t,e){return fetch(t,e).then(iE)}function aE(t){return function(e,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),oE(e,n).then((function(e){return t(e,r)}))}}var sE=aE(eE);aE(rE);function lE(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function uE(t){return function(e,n){return oE(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}var cE=uE("application/xml");uE("text/html"),uE("image/svg+xml");function hE(t,e,n){this.k=t,this.x=e,this.y=n}hE.prototype={constructor:hE,scale:function(t){return 1===t?this:new hE(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new hE(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fE,pE,dE,mE,gE;new hE(1,0,0);hE.prototype;var vE=function(){return vE=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vE.apply(this,arguments)};function yE(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function _E(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(e){o(e)}}function s(t){try{l(r.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function xE(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(l){s=[6,l],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function bE(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function wE(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var SE=t.createContext({}),EE=function(e){var n=e.children,r=(0,t.useState)(void 0),i=r[0],o=r[1],a=(0,t.useState)([]),s=a[0],l=a[1],u=(0,t.useRef)([]),c=(0,t.useRef)({}),h={map:i,setMap:function(t){if(o(t),0===s.length){var e="anonymous_map";l(bE(bE([],s,!0),[e],!1)),c.current[e]=t}},maps:c.current,mapIds:s,registerMap:function(t,e){t&&e&&(c.current[t]=e,u.current.push(t),l(bE([],u.current,!0)),i||o(e))},removeMap:function t(e){if(e){"undefined"!==typeof c.current[e]&&delete c.current[e];var n=u.current.indexOf(e);n>-1&&u.current.splice(n,1),l(bE([],u.current,!0)),1===s.length&&i&&o(void 0)}else o(void 0),t("anonymous_map")},mapExists:function(t){return(!t||-1!==Object.keys(c.current).indexOf(t))&&!(!t&&!i)},getMap:function(t){return t&&-1!==s.indexOf(t)?c.current[t]:!t&&i?i:null}};return t.createElement(SE.Provider,{value:h},n)},kE=function(t){var e=this,n=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[]},this.wrapper={on:function(t,e,r,i){if(n.eventHandlers[t]){"string"===typeof r&&(i=r,r={}),n.eventHandlers[t].push({handler:e,options:r});var o=[t,e];i&&"string"===typeof i&&(n.initRegisteredElements(i),n.registeredElements[i].wrapperEvents.push(o))}},off:function(t,e){n.eventHandlers[t]&&(n.eventHandlers[t]=n.eventHandlers[t].filter((function(t){return!Object.is(t[1],e)&&t})))},fire:function(t,e){if(n.eventHandlers[t]){var r=e||window,i=new Event(t);n.eventHandlers[t].forEach((function(t){t.handler.call(r,i,n)}))}},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:function(t){return{id:t.id,type:t.type,visible:"none"!==t.visibility,baseLayer:-1!==n.baseLayers.indexOf(t.id)}},buildLayerObjects:function(){return n.map.style._order.map((function(t){return n.wrapper.buildLayerObject(n.map.style._layers[t])})).filter((function(t){return"undefined"!==typeof t}))},refreshLayerState:function(){n.wrapper.layerState=n.wrapper.buildLayerObjects(),JSON.stringify(n.wrapper.layerState)!==n.wrapper.layerStateString&&(n.wrapper.fire("layerchange"),n.wrapper.layerStateString=JSON.stringify(n.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:function(){return"function"===typeof n.map.getCenter?{center:function(t){return{lng:t.lng,lat:t.lat}}(n.map.getCenter()),zoom:n.map.getZoom(),bearing:n.map.getBearing(),pitch:n.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0}},refreshViewport:function(){n.wrapper.viewportState=n.wrapper.getViewport()}},this.initRegisteredElements=function(t,e){("undefined"===typeof n.registeredElements[t]||"undefined"!==typeof e&&e)&&(n.registeredElements[t]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=function(t,e,r){if(n.map.style)return r&&"string"===typeof r&&"undefined"!==typeof t.id&&(n.initRegisteredElements(r),n.registeredElements[r].layers.push(t.id),(null===t||void 0===t?void 0:t.source)&&"string"!==typeof(null===t||void 0===t?void 0:t.source)&&n.registeredElements[r].sources.push(t.id)),n.map.addLayer(t,e),n.map},this.addSource=function(t,e,r){if(n.map.style)return r&&"string"===typeof r&&"undefined"!==typeof t&&(n.initRegisteredElements(r),n.registeredElements[r].sources.push(t)),n.map.addSource(t,e),n.map},this.addImage=function(t,e,r){n.map.style&&(r&&"string"===typeof r&&"undefined"!==typeof t&&(n.initRegisteredElements(r),n.registeredElements[r].images.push(t)),n.map.addImage(t,e))},this.on=function(t,e,r,i){var o;if("string"===typeof r&&"function"===typeof e)return n.on.call(n,t,void 0,e,r);var a=[t,e,r];return e||(a=[t,r]),i&&"string"===typeof i&&(n.initRegisteredElements(i),n.registeredElements[i].events.push(a)),(o=n.map).on.apply(o,a),n.map},this.addControl=function(t,e,r){return r&&"string"===typeof r&&(n.initRegisteredElements(r),n.registeredElements[r].controls.push(t)),n.map.addControl(t,e),n.map},this.cleanup=function(t){n.map.style&&"undefined"!==typeof n.registeredElements[t]&&(n.registeredElements[t].layers.forEach((function(t){n.map.style.getLayer(t)&&n.map.style.removeLayer(t)})),n.registeredElements[t].sources.forEach((function(t){n.map.style.getSource(t)&&n.map.style.removeSource(t)})),n.registeredElements[t].images.forEach((function(t){n.map.hasImage(t)&&n.map.style.removeImage(t)})),n.registeredElements[t].events.forEach((function(t){var e;(e=n.map).off.apply(e,t)})),n.registeredElements[t].controls.forEach((function(t){n.map.removeControl(t)})),n.registeredElements[t].wrapperEvents.forEach((function(t){var e;(e=n.wrapper).off.apply(e,t)})),n.initRegisteredElements(t,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach((function(t){e[t]=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n.map&&n.map.style&&"function"===typeof n.map.style[t]&&(e=n.map.style)[t].apply(e,r),n.map._update?n.map._update(!0):void 0}})),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach((function(t){e[t]=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return!(!n.map||!n.map.style)&&(e=n.map.style)[t].apply(e,r)}})),this.addNativeMaplibreFunctionsAndProps=function(){Object.getOwnPropertyNames(Object.getPrototypeOf(e.map)).forEach((function(t){"undefined"===typeof e[t]&&(e[t]=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return(e=n.map)[t].apply(e,r)})})),Object.keys(e.map).forEach((function(t){"undefined"===typeof e[t]&&(e[t]=n.map[t])}))},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach((function(t){e[t]=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if("function"===typeof n.map[t])return(e=n.map[t]).call.apply(e,bE([n.map],r,!1))}})),_E(e,void 0,void 0,(function(){return xE(this,(function(e){switch(e.label){case 0:return"string"!==typeof t.mapOptions.style||-1!==t.mapOptions.style.indexOf("mapbox://")?[3,2]:[4,fetch(t.mapOptions.style).then((function(t){if(t.ok)return t.json();throw new Error("error loading map style.json")})).then((function(e){e.layers.forEach((function(t){n.baseLayers.push(t.id),n.firstSymbolLayer||"symbol"!==t.type||(n.firstSymbolLayer=t.id)})),n.styleJson=e,t.mapOptions.style=e})).catch((function(t){console.log(t)}))];case 1:e.sent(),e.label=2;case 2:return n.map=new u.Map(t.mapOptions),window._map=n.map,n.addNativeMaplibreFunctionsAndProps(),n.wrapper.refreshViewport(),n.wrapper.fire("viewportchange"),n.map.on("load",(function(){n.addNativeMaplibreFunctionsAndProps()})),n.map.on("move",(function(){n.wrapper.viewportState=n.wrapper.getViewport(),n.wrapper.fire("viewportchange")})),n.map.on("idle",(function(){n.wrapper.refreshLayerState()})),n.map.on("data",(function(){n.wrapper.refreshLayerState()})),"function"===typeof t.onReady&&t.onReady(n.map,n),[2]}}))}))},CE=function(e){var n,r=(0,t.useRef)(null),i=(0,t.useRef)(),o=(0,t.useContext)(SE),a=(0,t.useRef)(e.mapId),s=(0,t.useRef)(!1),l=(0,t.useRef)(null===(n=e.options)||void 0===n?void 0:n.style);return(0,t.useEffect)((function(){var t=a.current;return function(){var e,n;o.removeMap(t),null===(n=null===(e=r.current)||void 0===e?void 0:e.remove)||void 0===n||n.call(e),r.current=null}}),[]),(0,t.useEffect)((function(){s.current||i.current&&(s.current=!0,r.current=new kE({mapOptions:vE({style:"",container:i.current},e.options),onReady:function(t,n){t.once("load",(function(){e.mapId?o.registerMap(e.mapId,n):o.setMap(n)}))}}))}),[e.options,e.mapId]),(0,t.useEffect)((function(){var t,n;(null===(t=r.current)||void 0===t?void 0:t.map)&&(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.style)&&l.current!==e.options.style&&(console.log("set style"),l.current=e.options.style,r.current.map.setStyle(e.options.style))}),[e.options.style]),t.createElement("div",{ref:i,className:"mapContainer",style:e.style})};function IE(e){var n=(0,t.useContext)(SE),r=(0,t.useRef)(!1),i=(0,t.useRef)(),o=(0,t.useState)(),a=o[0],s=o[1],l=(0,t.useRef)(void 0),u=(0,t.useState)([]),c=u[0],h=u[1],f=(0,t.useRef)(),p=(0,t.useRef)(g()),d=(0,t.useCallback)((function(t){var n,r;return!(!(null===(n=null===e||void 0===e?void 0:e.filter)||void 0===n?void 0:n.includeBaseLayers)&&t.baseLayer)&&("undefined"===typeof(null===(r=e.filter)||void 0===r?void 0:r.matchLayerIds)||(e.filter.matchLayerIds instanceof RegExp?e.filter.matchLayerIds.test(t.id):t.id.includes(e.filter.matchLayerIds)))}),[e.filter]),m=(0,t.useCallback)((function(){if(i.current){var t=i.current.wrapper.layerState.filter(d),e=JSON.stringify(t);f.current!==e&&(f.current=e,h(t))}}),[d]);return(0,t.useEffect)((function(){var t=p.current;return function(){i.current&&(i.current.cleanup(t),i.current=void 0),r.current=!1}}),[]),(0,t.useEffect)((function(){var t,o,a,u;n.mapExists(e.mapId)&&!r.current&&(r.current=!0,i.current=n.getMap(e.mapId),i.current?((null===(t=null===e||void 0===e?void 0:e.watch)||void 0===t?void 0:t.viewport)&&(s(i.current.wrapper.viewportState),i.current.wrapper.on("viewportchange",(function(){var t,e;l.current!==(null===(t=i.current)||void 0===t?void 0:t.wrapper.viewportStateString)&&s(null===(e=i.current)||void 0===e?void 0:e.wrapper.viewportState)}),p.current)),(null===(o=null===e||void 0===e?void 0:e.watch)||void 0===o?void 0:o.layers)&&(m(),i.current.wrapper.on("layerchange",m,{includeBaseLayers:null===(a=null===e||void 0===e?void 0:e.filter)||void 0===a?void 0:a.includeBaseLayers,matchLayerIds:null===(u=null===e||void 0===e?void 0:e.filter)||void 0===u?void 0:u.matchLayerIds},p.current))):r.current=!1)}),[n.mapIds,n,e.mapId,m,e]),{layers:c,viewport:a}}function TE(e){var n=(0,t.useContext)(SE),r=(0,t.useState)(),i=r[0],o=r[1],a=IE({mapId:null===e||void 0===e?void 0:e.mapId,watch:{viewport:!1,layers:!!(null===e||void 0===e?void 0:e.waitForLayer),sources:!1},filter:{includeBaseLayers:!0}}),s=(0,t.useRef)(!1),l=(0,t.useRef)(),u=(0,t.useRef)(g()),c=(0,t.useState)(!1),h=c[0],f=c[1],p=function(){l.current&&l.current.cleanup(u.current),s.current=!1};return(0,t.useEffect)((function(){return function(){p(),f(!1),l.current=void 0}}),[]),(0,t.useEffect)((function(){var t;if(n.mapExists(null===e||void 0===e?void 0:e.mapId)&&!s.current){if(null===e||void 0===e?void 0:e.waitForLayer){var r=!1;if(null===(t=null===a||void 0===a?void 0:a.layers)||void 0===t||t.forEach((function(t){t.id===(null===e||void 0===e?void 0:e.waitForLayer)&&(r=!0)})),!r)return}s.current=!0,l.current=n.getMap(null===e||void 0===e?void 0:e.mapId),o(l.current),f(!0)}}),[n.mapIds,a.layers,n,e]),{map:i,mapIsReady:h,componentId:u.current,layers:a.layers,cleanup:p}}CE.defaultProps={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},layers:[{id:"background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},IE.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}},IE.propTypes={mapId:y().string,watch:y().shape({layers:y().bool,sources:y().bool,viewport:y().bool}),filter:y().shape({includeBaseLayers:y().bool,matchLayerIds:y().oneOfType([y().string,y().instanceOf(RegExp)]),matchSourceIds:y().oneOfType([y().string,y().instanceOf(RegExp)])})};function PE(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}var AE,ME={},LE={exports:{}};(AE=LE).exports=function(t){return t&&t.__esModule?t:{default:t}},AE.exports.__esModule=!0,AE.exports.default=AE.exports;var RE={};function DE(){return DE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},DE.apply(this,arguments)}function NE(t){return null!==t&&"object"===typeof t&&t.constructor===Object}function zE(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=n.clone?DE({},t):t;return NE(t)&&NE(e)&&Object.keys(e).forEach((function(i){"__proto__"!==i&&(NE(e[i])&&i in t&&NE(t[i])?r[i]=zE(t[i],e[i],n):r[i]=e[i])})),r}y().elementType;function OE(t){for(var e="https://mui.com/production-error/?code="+t,n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}var FE,BE={exports:{}},jE={},UE=Symbol.for("react.element"),VE=Symbol.for("react.portal"),ZE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),GE=Symbol.for("react.profiler"),WE=Symbol.for("react.provider"),XE=Symbol.for("react.context"),HE=Symbol.for("react.server_context"),YE=Symbol.for("react.forward_ref"),$E=Symbol.for("react.suspense"),KE=Symbol.for("react.suspense_list"),JE=Symbol.for("react.memo"),QE=Symbol.for("react.lazy"),tk=Symbol.for("react.offscreen");function ek(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case UE:switch(t=t.type){case ZE:case GE:case qE:case $E:case KE:return t;default:switch(t=t&&t.$$typeof){case HE:case XE:case YE:case QE:case JE:case WE:return t;default:return e}}case VE:return e}}}FE=Symbol.for("react.module.reference"),jE.ContextConsumer=XE,jE.ContextProvider=WE,jE.Element=UE,jE.ForwardRef=YE,jE.Fragment=ZE,jE.Lazy=QE,jE.Memo=JE,jE.Portal=VE,jE.Profiler=GE,jE.StrictMode=qE,jE.Suspense=$E,jE.SuspenseList=KE,jE.isAsyncMode=function(){return!1},jE.isConcurrentMode=function(){return!1},jE.isContextConsumer=function(t){return ek(t)===XE},jE.isContextProvider=function(t){return ek(t)===WE},jE.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===UE},jE.isForwardRef=function(t){return ek(t)===YE},jE.isFragment=function(t){return ek(t)===ZE},jE.isLazy=function(t){return ek(t)===QE},jE.isMemo=function(t){return ek(t)===JE},jE.isPortal=function(t){return ek(t)===VE},jE.isProfiler=function(t){return ek(t)===GE},jE.isStrictMode=function(t){return ek(t)===qE},jE.isSuspense=function(t){return ek(t)===$E},jE.isSuspenseList=function(t){return ek(t)===KE},jE.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===ZE||t===GE||t===qE||t===$E||t===KE||t===tk||"object"===typeof t&&null!==t&&(t.$$typeof===QE||t.$$typeof===JE||t.$$typeof===WE||t.$$typeof===XE||t.$$typeof===YE||t.$$typeof===FE||void 0!==t.getModuleId)},jE.typeOf=ek,BE.exports=jE;y().oneOfType([y().func,y().object]);function nk(t){if("string"!==typeof t)throw new Error(OE(7));return t.charAt(0).toUpperCase()+t.slice(1)}function rk(t){return t&&t.ownerDocument||document}function ik(t,e){"function"===typeof t?t(e):t&&(t.current=e)}var ok="undefined"!==typeof window?t.useLayoutEffect:t.useEffect,ak=0;var sk=e.useId;function lk(e){var n=t.useRef(e);return ok((function(){n.current=e})),t.useCallback((function(){return n.current.apply(void 0,arguments)}),[])}function uk(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.useMemo((function(){return n.every((function(t){return null==t}))?null:function(t){n.forEach((function(e){ik(e,t)}))}}),n)}var ck,hk=!0,fk=!1,pk={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function dk(t){t.metaKey||t.altKey||t.ctrlKey||(hk=!0)}function mk(){hk=!1}function gk(){"hidden"===this.visibilityState&&fk&&(hk=!0)}function vk(t){var e=t.target;try{return e.matches(":focus-visible")}catch(n){}return hk||function(t){var e=t.type,n=t.tagName;return!("INPUT"!==n||!pk[e]||t.readOnly)||"TEXTAREA"===n&&!t.readOnly||!!t.isContentEditable}(e)}function yk(){var e=t.useCallback((function(t){null!=t&&function(t){t.addEventListener("keydown",dk,!0),t.addEventListener("mousedown",mk,!0),t.addEventListener("pointerdown",mk,!0),t.addEventListener("touchstart",mk,!0),t.addEventListener("visibilitychange",gk,!0)}(t.ownerDocument)}),[]),n=t.useRef(!1);return{isFocusVisibleRef:n,onFocus:function(t){return!!vk(t)&&(n.current=!0,!0)},onBlur:function(){return!!n.current&&(fk=!0,window.clearTimeout(ck),ck=window.setTimeout((function(){fk=!1}),100),n.current=!1,!0)},ref:e}}Number.isInteger;function _k(){return null}_k.isRequired=_k;function xk(t,e){var n=DE({},e);return Object.keys(t).forEach((function(e){void 0===n[e]&&(n[e]=t[e])})),n}function bk(t,e,n){var r={};return Object.keys(t).forEach((function(i){r[i]=t[i].reduce((function(t,r){return r&&(t.push(e(r)),n&&n[r]&&t.push(n[r])),t}),[]).join(" ")})),r}var wk=function(t){return t},Sk=function(){var t=wk;return{configure:function(e){t=e},generate:function(e){return t(e)},reset:function(){t=wk}}}(),Ek={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function kk(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r=Ek[e];return r?"".concat(n,"-").concat(r):"".concat(Sk.generate(t),"-").concat(e)}function Ck(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r={};return e.forEach((function(e){r[e]=kk(t,e,n)})),r}function Ik(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function Tk(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Tk(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Pk(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Tk(t))&&(r&&(r+=" "),r+=e);return r}var Ak={exports:{}},Mk={},Lk=Object.getOwnPropertySymbols,Rk=Object.prototype.hasOwnProperty,Dk=Object.prototype.propertyIsEnumerable;function Nk(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map((function(t){return e[t]}));if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(o){return!1}})()&&Object.assign;var zk=t,Ok=60103;if(Mk.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var Fk=Symbol.for;Ok=Fk("react.element"),Mk.Fragment=Fk("react.fragment")}var Bk=zk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jk=Object.prototype.hasOwnProperty,Uk={key:!0,ref:!0,__self:!0,__source:!0};function Vk(t,e,n){var r,i={},o=null,a=null;for(r in void 0!==n&&(o=""+n),void 0!==e.key&&(o=""+e.key),void 0!==e.ref&&(a=e.ref),e)jk.call(e,r)&&!Uk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:Ok,type:t,key:o,ref:a,props:i,_owner:Bk.current}}Mk.jsx=Vk,Mk.jsxs=Vk;function Zk(t,e){return(0,Ln.Z)(t,e)}Ak.exports=Mk;var qk=function(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function Gk(t,e){return e?zE(t,e,{clone:!1}):t}var Wk={xs:0,sm:600,md:900,lg:1200,xl:1536},Xk={keys:["xs","sm","md","lg","xl"],up:function(t){return"@media (min-width:".concat(Wk[t],"px)")}};function Hk(t,e,n){var r=t.theme||{};if(Array.isArray(e)){var i=r.breakpoints||Xk;return e.reduce((function(t,r,o){return t[i.up(i.keys[o])]=n(e[o]),t}),{})}if("object"===typeof e){var o=r.breakpoints||Xk;return Object.keys(e).reduce((function(t,r){if(-1!==Object.keys(o.values||Wk).indexOf(r)){t[o.up(r)]=n(e[r],r)}else{var i=r;t[i]=e[i]}return t}),{})}return n(e)}function Yk(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||"string"!==typeof e)return null;if(t&&t.vars&&n){var r="vars.".concat(e).split(".").reduce((function(t,e){return t&&t[e]?t[e]:null}),t);if(null!=r)return r}return e.split(".").reduce((function(t,e){return t&&null!=t[e]?t[e]:null}),t)}function $k(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof t?t(n):Array.isArray(t)?t[n]||i:Yk(t,n)||i,e&&(r=e(r,i,t)),r}function Kk(t){var e=t.prop,n=t.cssProperty,r=void 0===n?t.prop:n,i=t.themeKey,o=t.transform,a=function(t){if(null==t[e])return null;var n=t[e],a=Yk(t.theme,i)||{};return Hk(t,n,(function(t){var n=$k(a,o,t);return t===n&&"string"===typeof t&&(n=$k(a,o,"".concat(e).concat("default"===t?"":nk(t)),t)),!1===r?n:(0,s.Z)({},r,n)}))};return a.propTypes={},a.filterProps=[e],a}function Jk(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce((function(t,e){return e.filterProps.forEach((function(n){t[n]=e})),t}),{}),i=function(t){return Object.keys(t).reduce((function(e,n){return r[n]?Gk(e,r[n](t)):e}),{})};return i.propTypes={},i.filterProps=e.reduce((function(t,e){return t.concat(e.filterProps)}),[]),i}var Qk={m:"margin",p:"padding"},tC={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},eC={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},nC=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}((function(t){if(t.length>2){if(!eC[t])return[t];t=eC[t]}var e=t.split(""),n=(0,l.Z)(e,2),r=n[0],i=n[1],o=Qk[r],a=tC[i]||"";return Array.isArray(a)?a.map((function(t){return o+t})):[o+a]})),rC=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],iC=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[].concat(rC,iC);function oC(t,e,n,r){var i,o=null!=(i=Yk(t,e,!1))?i:n;return"number"===typeof o?function(t){return"string"===typeof t?t:o*t}:Array.isArray(o)?function(t){return"string"===typeof t?t:o[t]}:"function"===typeof o?o:function(){}}function aC(t){return oC(t,"spacing",8)}function sC(t,e){if("string"===typeof e||null==e)return e;var n=t(Math.abs(e));return e>=0?n:"number"===typeof n?-n:"-".concat(n)}function lC(t,e,n,r){if(-1===e.indexOf(n))return null;var i=function(t,e){return function(n){return t.reduce((function(t,r){return t[r]=sC(e,n),t}),{})}}(nC(n),r);return Hk(t,t[n],i)}function uC(t,e){var n=aC(t.theme);return Object.keys(t).map((function(r){return lC(t,e,r,n)})).reduce(Gk,{})}function cC(t){return uC(t,rC)}function hC(t){return uC(t,iC)}function fC(t){return"number"!==typeof t?t:"".concat(t,"px solid")}cC.propTypes={},cC.filterProps=rC,hC.propTypes={},hC.filterProps=iC;var pC=Kk({prop:"border",themeKey:"borders",transform:fC}),dC=Kk({prop:"borderTop",themeKey:"borders",transform:fC}),mC=Kk({prop:"borderRight",themeKey:"borders",transform:fC}),gC=Kk({prop:"borderBottom",themeKey:"borders",transform:fC}),vC=Kk({prop:"borderLeft",themeKey:"borders",transform:fC}),yC=Kk({prop:"borderColor",themeKey:"palette"}),_C=Kk({prop:"borderTopColor",themeKey:"palette"}),xC=Kk({prop:"borderRightColor",themeKey:"palette"}),bC=Kk({prop:"borderBottomColor",themeKey:"palette"}),wC=Kk({prop:"borderLeftColor",themeKey:"palette"}),SC=function(t){if(void 0!==t.borderRadius&&null!==t.borderRadius){var e=oC(t.theme,"shape.borderRadius",4);return Hk(t,t.borderRadius,(function(t){return{borderRadius:sC(e,t)}}))}return null};SC.propTypes={},SC.filterProps=["borderRadius"],Jk(pC,dC,mC,gC,vC,yC,_C,xC,bC,wC,SC);var EC=function(t){if(void 0!==t.gap&&null!==t.gap){var e=oC(t.theme,"spacing",8);return Hk(t,t.gap,(function(t){return{gap:sC(e,t)}}))}return null};EC.propTypes={},EC.filterProps=["gap"];var kC=function(t){if(void 0!==t.columnGap&&null!==t.columnGap){var e=oC(t.theme,"spacing",8);return Hk(t,t.columnGap,(function(t){return{columnGap:sC(e,t)}}))}return null};kC.propTypes={},kC.filterProps=["columnGap"];var CC=function(t){if(void 0!==t.rowGap&&null!==t.rowGap){var e=oC(t.theme,"spacing",8);return Hk(t,t.rowGap,(function(t){return{rowGap:sC(e,t)}}))}return null};function IC(t,e){return"grey"===e?e:t}function TC(t){return t<=1&&0!==t?"".concat(100*t,"%"):t}CC.propTypes={},CC.filterProps=["rowGap"],Jk(EC,kC,CC,Kk({prop:"gridColumn"}),Kk({prop:"gridRow"}),Kk({prop:"gridAutoFlow"}),Kk({prop:"gridAutoColumns"}),Kk({prop:"gridAutoRows"}),Kk({prop:"gridTemplateColumns"}),Kk({prop:"gridTemplateRows"}),Kk({prop:"gridTemplateAreas"}),Kk({prop:"gridArea"})),Jk(Kk({prop:"color",themeKey:"palette",transform:IC}),Kk({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:IC}),Kk({prop:"backgroundColor",themeKey:"palette",transform:IC}));var PC=Kk({prop:"width",transform:TC}),AC=function(t){if(void 0!==t.maxWidth&&null!==t.maxWidth){return Hk(t,t.maxWidth,(function(e){var n,r,i;return{maxWidth:(null==(n=t.theme)||null==(r=n.breakpoints)||null==(i=r.values)?void 0:i[e])||Wk[e]||TC(e)}}))}return null};AC.filterProps=["maxWidth"];var MC=Kk({prop:"minWidth",transform:TC}),LC=Kk({prop:"height",transform:TC}),RC=Kk({prop:"maxHeight",transform:TC}),DC=Kk({prop:"minHeight",transform:TC});Kk({prop:"size",cssProperty:"width",transform:TC}),Kk({prop:"size",cssProperty:"height",transform:TC}),Jk(PC,AC,MC,LC,RC,DC,Kk({prop:"boxSizing"}));var NC={border:{themeKey:"borders",transform:fC},borderTop:{themeKey:"borders",transform:fC},borderRight:{themeKey:"borders",transform:fC},borderBottom:{themeKey:"borders",transform:fC},borderLeft:{themeKey:"borders",transform:fC},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:SC},color:{themeKey:"palette",transform:IC},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:IC},backgroundColor:{themeKey:"palette",transform:IC},p:{style:hC},pt:{style:hC},pr:{style:hC},pb:{style:hC},pl:{style:hC},px:{style:hC},py:{style:hC},padding:{style:hC},paddingTop:{style:hC},paddingRight:{style:hC},paddingBottom:{style:hC},paddingLeft:{style:hC},paddingX:{style:hC},paddingY:{style:hC},paddingInline:{style:hC},paddingInlineStart:{style:hC},paddingInlineEnd:{style:hC},paddingBlock:{style:hC},paddingBlockStart:{style:hC},paddingBlockEnd:{style:hC},m:{style:cC},mt:{style:cC},mr:{style:cC},mb:{style:cC},ml:{style:cC},mx:{style:cC},my:{style:cC},margin:{style:cC},marginTop:{style:cC},marginRight:{style:cC},marginBottom:{style:cC},marginLeft:{style:cC},marginX:{style:cC},marginY:{style:cC},marginInline:{style:cC},marginInlineStart:{style:cC},marginInlineEnd:{style:cC},marginBlock:{style:cC},marginBlockStart:{style:cC},marginBlockEnd:{style:cC},displayPrint:{cssProperty:!1,transform:function(t){return{"@media print":{display:t}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:EC},rowGap:{style:CC},columnGap:{style:kC},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:TC},maxWidth:{style:AC},minWidth:{transform:TC},height:{transform:TC},maxHeight:{transform:TC},minHeight:{transform:TC},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};var zC=function(){function t(t,e,n,r){var i,o=(i={},(0,s.Z)(i,t,e),(0,s.Z)(i,"theme",n),i),a=r[t];if(!a)return(0,s.Z)({},t,e);var l=a.cssProperty,u=void 0===l?t:l,c=a.themeKey,h=a.transform,f=a.style;if(null==e)return null;var p=Yk(n,c)||{};if(f)return f(o);return Hk(o,e,(function(e){var n=$k(p,h,e);return e===n&&"string"===typeof e&&(n=$k(p,h,"".concat(t).concat("default"===e?"":nk(e)),e)),!1===u?n:(0,s.Z)({},u,n)}))}return function e(n){var r,i=n||{},o=i.sx,a=i.theme,l=void 0===a?{}:a;if(!o)return null;var u=null!=(r=l.unstable_sxConfig)?r:NC;function c(n){var r=n;if("function"===typeof n)r=n(l);else if("object"!==typeof n)return n;if(!r)return null;var i=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(t=e.keys)?void 0:t.reduce((function(t,n){return t[e.up(n)]={},t}),{}))||{}}(l.breakpoints),o=Object.keys(i),a=i;return Object.keys(r).forEach((function(n){var i,o,c=(i=r[n],o=l,"function"===typeof i?i(o):i);if(null!==c&&void 0!==c)if("object"===typeof c)if(u[n])a=Gk(a,t(n,c,l,u));else{var h=Hk({theme:l},c,(function(t){return(0,s.Z)({},n,t)}));!function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce((function(t,e){return t.concat(Object.keys(e))}),[]),i=new Set(r);return e.every((function(t){return i.size===Object.keys(t).length}))}(h,c)?a=Gk(a,h):a[n]=e({sx:c,theme:l})}else a=Gk(a,t(n,c,l,u))})),function(t,e){return t.reduce((function(t,e){var n=t[e];return(!n||0===Object.keys(n).length)&&delete t[e],t}),e)}(o,a)}return Array.isArray(o)?o.map(c):c(o)}}();zC.filterProps=["sx"];var OC=zC,FC=["sx"];function BC(t){var e,n=t.sx,r=function(t){var e,n,r={systemProps:{},otherProps:{}},i=null!=(e=null==t||null==(n=t.theme)?void 0:n.unstable_sxConfig)?e:NC;return Object.keys(t).forEach((function(e){i[e]?r.systemProps[e]=t[e]:r.otherProps[e]=t[e]})),r}(Ik(t,FC)),i=r.systemProps,o=r.otherProps;return e=Array.isArray(n)?[i].concat((0,a.Z)(n)):"function"===typeof n?function(){var t=n.apply(void 0,arguments);return NE(t)?DE({},i,t):i}:DE({},i,n),DE({},o,{sx:e})}var jC=["values","unit","step"];function UC(t){var e=t.values,n=void 0===e?{xs:0,sm:600,md:900,lg:1200,xl:1536}:e,r=t.unit,i=void 0===r?"px":r,o=t.step,a=void 0===o?5:o,l=Ik(t,jC),u=function(t){var e=Object.keys(t).map((function(e){return{key:e,val:t[e]}}))||[];return e.sort((function(t,e){return t.val-e.val})),e.reduce((function(t,e){return DE({},t,(0,s.Z)({},e.key,e.val))}),{})}(n),c=Object.keys(u);function h(t){var e="number"===typeof n[t]?n[t]:t;return"@media (min-width:".concat(e).concat(i,")")}function f(t){var e="number"===typeof n[t]?n[t]:t;return"@media (max-width:".concat(e-a/100).concat(i,")")}function p(t,e){var r=c.indexOf(e);return"@media (min-width:".concat("number"===typeof n[t]?n[t]:t).concat(i,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[c[r]]?n[c[r]]:e)-a/100).concat(i,")")}return DE({keys:c,values:u,up:h,down:f,between:p,only:function(t){return c.indexOf(t)+1<c.length?p(t,c[c.indexOf(t)+1]):h(t)},not:function(t){var e=c.indexOf(t);return 0===e?h(c[1]):e===c.length-1?f(c[e]):p(t,c[c.indexOf(t)+1]).replace("@media","@media not all and")},unit:i},l)}var VC={borderRadius:4};function ZC(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(t.mui)return t;var e=aC({spacing:t}),n=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=0===n.length?[1]:n;return i.map((function(t){var n=e(t);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}var qC=["breakpoints","palette","spacing","shape"];function GC(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.breakpoints,n=void 0===e?{}:e,r=t.palette,i=void 0===r?{}:r,o=t.spacing,a=t.shape,s=void 0===a?{}:a,l=Ik(t,qC),u=UC(n),c=ZC(o),h=zE({breakpoints:u,direction:"ltr",components:{},palette:DE({mode:"light"},i),spacing:c,shape:DE({},VC,s)},l),f=arguments.length,p=new Array(f>1?f-1:0),d=1;d<f;d++)p[d-1]=arguments[d];return(h=p.reduce((function(t,e){return zE(t,e)}),h)).unstable_sxConfig=DE({},NC,null==l?void 0:l.unstable_sxConfig),h.unstable_sx=function(t){return OC({sx:t,theme:this})},h}var WC=t.createContext(null);function XC(){return t.useContext(WC)}function HC(t){return 0===Object.keys(t).length}function YC(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=XC();return!e||HC(e)?t:e}var $C=GC();function KC(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$C;return YC(t)}var JC=["className","component"];var QC=["variant"];function tI(t){return 0===t.length}function eI(t){var e=t.variant,n=Ik(t,QC),r=e||"";return Object.keys(n).sort().forEach((function(e){r+="color"===e?tI(r)?t[e]:nk(t[e]):"".concat(tI(r)?e:nk(e)).concat(nk(t[e].toString()))})),r}var nI=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],rI=["theme"],iI=["theme"];function oI(t){return 0===Object.keys(t).length}function aI(t){return"string"===typeof t&&t.charCodeAt(0)>96}var sI=function(t,e){return e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null},lI=function(t,e){var n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);var r={};return n.forEach((function(t){var e=eI(t.props);r[e]=t.style})),r},uI=function(t,e,n,r){var i,o,a=t.ownerState,s=void 0===a?{}:a,l=[],u=null==n||null==(i=n.components)||null==(o=i[r])?void 0:o.variants;return u&&u.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(e){s[e]!==n.props[e]&&t[e]!==n.props[e]&&(r=!1)})),r&&l.push(e[eI(n.props)])})),l};function cI(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t}var hI=GC();function fI(t){var e=t.theme,n=t.name,r=t.props;return e&&e.components&&e.components[n]&&e.components[n].defaultProps?xk(e.components[n].defaultProps,r):r}function pI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)}function dI(t){if(t.type)return t;if("#"===t.charAt(0))return dI(function(t){t=t.slice(1);var e=new RegExp(".{1,".concat(t.length>=6?2:1,"}"),"g"),n=t.match(e);return n&&1===n[0].length&&(n=n.map((function(t){return t+t}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(t,e){return e<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3})).join(", "),")"):""}(t));var e=t.indexOf("("),n=t.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(OE(9,t));var r,i=t.substring(e+1,t.length-1);if("color"===n){if(r=(i=i.split(" ")).shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(OE(10,r))}else i=i.split(",");return{type:n,values:i=i.map((function(t){return parseFloat(t)})),colorSpace:r}}function mI(t){var e=t.type,n=t.colorSpace,r=t.values;return-1!==e.indexOf("rgb")?r=r.map((function(t,e){return e<3?parseInt(t,10):t})):-1!==e.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==e.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(e,"(").concat(r,")")}function gI(t){var e="hsl"===(t=dI(t)).type||"hsla"===t.type?dI(function(t){var e=(t=dI(t)).values,n=e[0],r=e[1]/100,i=e[2]/100,o=r*Math.min(i,1-i),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+n/30)%12;return i-o*Math.max(Math.min(e-3,9-e,1),-1)},s="rgb",l=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===t.type&&(s+="a",l.push(e[3])),mI({type:s,values:l})}(t)).values:t.values;return e=e.map((function(e){return"color"!==t.type&&(e/=255),e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function vI(t,e){return t=dI(t),e=pI(e),"rgb"!==t.type&&"hsl"!==t.type||(t.type+="a"),"color"===t.type?t.values[3]="/".concat(e):t.values[3]=e,mI(t)}function yI(t,e){var n;return DE({toolbar:(n={minHeight:56},(0,s.Z)(n,t.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),(0,s.Z)(n,t.up("sm"),{minHeight:64}),n)},e)}var _I={black:"#000",white:"#fff"},xI={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},bI={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},wI={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},SI={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},EI={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},kI={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},CI={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},II=["mode","contrastThreshold","tonalOffset"],TI={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:_I.white,default:_I.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},PI={text:{primary:_I.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:_I.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function AI(t,e,n,r){var i=r.light||r,o=r.dark||1.5*r;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:"light"===e?t.light=function(t,e){if(t=dI(t),e=pI(e),-1!==t.type.indexOf("hsl"))t.values[2]+=(100-t.values[2])*e;else if(-1!==t.type.indexOf("rgb"))for(var n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(-1!==t.type.indexOf("color"))for(var r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return mI(t)}(t.main,i):"dark"===e&&(t.dark=function(t,e){if(t=dI(t),e=pI(e),-1!==t.type.indexOf("hsl"))t.values[2]*=1-e;else if(-1!==t.type.indexOf("rgb")||-1!==t.type.indexOf("color"))for(var n=0;n<3;n+=1)t.values[n]*=1-e;return mI(t)}(t.main,o)))}function MI(t){var e=t.mode,n=void 0===e?"light":e,r=t.contrastThreshold,i=void 0===r?3:r,o=t.tonalOffset,a=void 0===o?.2:o,s=Ik(t,II),l=t.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:EI[200],light:EI[50],dark:EI[400]}:{main:EI[700],light:EI[400],dark:EI[800]}}(n),u=t.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:bI[200],light:bI[50],dark:bI[400]}:{main:bI[500],light:bI[300],dark:bI[700]}}(n),c=t.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:wI[500],light:wI[300],dark:wI[700]}:{main:wI[700],light:wI[400],dark:wI[800]}}(n),h=t.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:kI[400],light:kI[300],dark:kI[700]}:{main:kI[700],light:kI[500],dark:kI[900]}}(n),f=t.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:CI[400],light:CI[300],dark:CI[700]}:{main:CI[800],light:CI[500],dark:CI[900]}}(n),p=t.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:SI[400],light:SI[300],dark:SI[700]}:{main:"#ed6c02",light:SI[500],dark:SI[900]}}(n);function d(t){var e=function(t,e){var n=gI(t),r=gI(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(t,PI.text.primary)>=i?PI.text.primary:TI.text.primary;return e}var m=function(t){var e=t.color,n=t.name,r=t.mainShade,i=void 0===r?500:r,o=t.lightShade,s=void 0===o?300:o,l=t.darkShade,u=void 0===l?700:l;if(!(e=DE({},e)).main&&e[i]&&(e.main=e[i]),!e.hasOwnProperty("main"))throw new Error(OE(11,n?" (".concat(n,")"):"",i));if("string"!==typeof e.main)throw new Error(OE(12,n?" (".concat(n,")"):"",JSON.stringify(e.main)));return AI(e,"light",s,a),AI(e,"dark",u,a),e.contrastText||(e.contrastText=d(e.main)),e},g={dark:PI,light:TI};return zE(DE({common:DE({},_I),mode:n,primary:m({color:l,name:"primary"}),secondary:m({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:c,name:"error"}),warning:m({color:p,name:"warning"}),info:m({color:h,name:"info"}),success:m({color:f,name:"success"}),grey:xI,contrastThreshold:i,getContrastText:d,augmentColor:m,tonalOffset:a},g[n]),s)}var LI=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var RI={textTransform:"uppercase"},DI='"Roboto", "Helvetica", "Arial", sans-serif';function NI(t,e){var n="function"===typeof e?e(t):e,r=n.fontFamily,i=void 0===r?DI:r,o=n.fontSize,a=void 0===o?14:o,s=n.fontWeightLight,l=void 0===s?300:s,u=n.fontWeightRegular,c=void 0===u?400:u,h=n.fontWeightMedium,f=void 0===h?500:h,p=n.fontWeightBold,d=void 0===p?700:p,m=n.htmlFontSize,g=void 0===m?16:m,v=n.allVariants,y=n.pxToRem,_=Ik(n,LI);var x=a/14,b=y||function(t){return"".concat(t/g*x,"rem")},w=function(t,e,n,r,o){return DE({fontFamily:i,fontWeight:t,fontSize:b(e),lineHeight:n},i===DI?{letterSpacing:"".concat((a=r/e,Math.round(1e5*a)/1e5),"em")}:{},o,v);var a},S={h1:w(l,96,1.167,-1.5),h2:w(l,60,1.2,-.5),h3:w(c,48,1.167,0),h4:w(c,34,1.235,.25),h5:w(c,24,1.334,0),h6:w(f,20,1.6,.15),subtitle1:w(c,16,1.75,.15),subtitle2:w(f,14,1.57,.1),body1:w(c,16,1.5,.15),body2:w(c,14,1.43,.15),button:w(f,14,1.75,.4,RI),caption:w(c,12,1.66,.4),overline:w(c,12,2.66,1,RI)};return zE(DE({htmlFontSize:g,pxToRem:b,fontFamily:i,fontSize:a,fontWeightLight:l,fontWeightRegular:c,fontWeightMedium:f,fontWeightBold:d},S),_,{clone:!1})}function zI(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var OI=["none",zI(0,2,1,-1,0,1,1,0,0,1,3,0),zI(0,3,1,-2,0,2,2,0,0,1,5,0),zI(0,3,3,-2,0,3,4,0,0,1,8,0),zI(0,2,4,-1,0,4,5,0,0,1,10,0),zI(0,3,5,-1,0,5,8,0,0,1,14,0),zI(0,3,5,-1,0,6,10,0,0,1,18,0),zI(0,4,5,-2,0,7,10,1,0,2,16,1),zI(0,5,5,-3,0,8,10,1,0,3,14,2),zI(0,5,6,-3,0,9,12,1,0,3,16,2),zI(0,6,6,-3,0,10,14,1,0,4,18,3),zI(0,6,7,-4,0,11,15,1,0,4,20,3),zI(0,7,8,-4,0,12,17,2,0,5,22,4),zI(0,7,8,-4,0,13,19,2,0,5,24,4),zI(0,7,9,-4,0,14,21,2,0,5,26,4),zI(0,8,9,-5,0,15,22,2,0,6,28,5),zI(0,8,10,-5,0,16,24,2,0,6,30,5),zI(0,8,11,-5,0,17,26,2,0,6,32,5),zI(0,9,11,-5,0,18,28,2,0,7,34,6),zI(0,9,12,-6,0,19,29,2,0,7,36,6),zI(0,10,13,-6,0,20,31,3,0,8,38,7),zI(0,10,13,-6,0,21,33,3,0,8,40,7),zI(0,10,14,-6,0,22,35,3,0,8,42,7),zI(0,11,14,-7,0,23,36,3,0,9,44,8),zI(0,11,15,-7,0,24,38,3,0,9,46,8)],FI=["duration","easing","delay"],BI={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},jI={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function UI(t){return"".concat(Math.round(t),"ms")}function VI(t){if(!t)return 0;var e=t/36;return Math.round(10*(4+15*Math.pow(e,.25)+e/5))}function ZI(t){var e=DE({},BI,t.easing),n=DE({},jI,t.duration);return DE({getAutoHeightDuration:VI,create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.duration,o=void 0===i?n.standard:i,a=r.easing,s=void 0===a?e.easeInOut:a,l=r.delay,u=void 0===l?0:l;Ik(r,FI);return(Array.isArray(t)?t:[t]).map((function(t){return"".concat(t," ").concat("string"===typeof o?o:UI(o)," ").concat(s," ").concat("string"===typeof u?u:UI(u))})).join(",")}},t,{easing:e,duration:n})}var qI={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},GI=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function WI(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.mixins,n=void 0===e?{}:e,r=t.palette,i=void 0===r?{}:r,o=t.transitions,a=void 0===o?{}:o,s=t.typography,l=void 0===s?{}:s,u=Ik(t,GI);if(t.vars)throw new Error(OE(18));var c=MI(i),h=GC(t),f=zE(h,{mixins:yI(h.breakpoints,n),palette:c,shadows:OI.slice(),typography:NI(c,l),transitions:ZI(a),zIndex:DE({},qI)});f=zE(f,u);for(var p=arguments.length,d=new Array(p>1?p-1:0),m=1;m<p;m++)d[m-1]=arguments[m];return(f=d.reduce((function(t,e){return zE(t,e)}),f)).unstable_sxConfig=DE({},NC,null==u?void 0:u.unstable_sxConfig),f.unstable_sx=function(t){return OC({sx:t,theme:this})},f}var XI=WI();function HI(t){return function(t){var e=t.props,n=t.name;return fI({theme:KC(t.defaultTheme),name:n,props:e})}({props:t.props,name:t.name,defaultTheme:XI})}var YI=function(t){return cI(t)&&"classes"!==t},$I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.defaultTheme,n=void 0===e?hI:e,r=t.rootShouldForwardProp,i=void 0===r?cI:r,o=t.slotShouldForwardProp,s=void 0===o?cI:o,u=function(t){var e=oI(t.theme)?n:t.theme;return OC(DE({},t,{theme:e}))};return u.__mui_systemSx=!0,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qk(t,(function(t){return t.filter((function(t){return!(null!=t&&t.__mui_systemSx)}))}));var r,o=e.name,c=e.slot,h=e.skipVariantsResolver,f=e.skipSx,p=e.overridesResolver,d=Ik(e,nI),m=void 0!==h?h:c&&"Root"!==c||!1,g=f||!1;var v=cI;"Root"===c?v=i:c?v=s:aI(t)&&(v=void 0);var y=Zk(t,DE({shouldForwardProp:v,label:r},d)),_=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var s=r?r.map((function(t){return"function"===typeof t&&t.__emotion_real!==t?function(e){var r=e.theme,i=Ik(e,rI);return t(DE({theme:oI(r)?n:r},i))}:t})):[],c=t;o&&p&&s.push((function(t){var e=oI(t.theme)?n:t.theme,r=sI(o,e);if(r){var i={};return Object.entries(r).forEach((function(n){var r=(0,l.Z)(n,2),o=r[0],a=r[1];i[o]="function"===typeof a?a(DE({},t,{theme:e})):a})),p(t,i)}return null})),o&&!m&&s.push((function(t){var e=oI(t.theme)?n:t.theme;return uI(t,lI(o,e),e,o)})),g||s.push(u);var h=s.length-r.length;if(Array.isArray(t)&&h>0){var f=new Array(h).fill("");(c=[].concat((0,a.Z)(t),(0,a.Z)(f))).raw=[].concat((0,a.Z)(t.raw),(0,a.Z)(f))}else"function"===typeof t&&t.__emotion_real!==t&&(c=function(e){var r=e.theme,i=Ik(e,iI);return t(DE({theme:oI(r)?n:r},i))});var d=y.apply(void 0,[c].concat((0,a.Z)(s)));return d};return y.withConfig&&(_.withConfig=y.withConfig),_}}({defaultTheme:XI,rootShouldForwardProp:YI}),KI=$I;function JI(t){return kk("MuiSvgIcon",t)}Ck("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var QI=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],tT=KI("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,"inherit"!==n.color&&e["color".concat(nk(n.color))],e["fontSize".concat(nk(n.fontSize))]]}})((function(t){var e,n,r,i,o,a,s,l,u,c,h,f,p,d,m,g,v,y=t.theme,_=t.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:null==(e=y.transitions)||null==(n=e.create)?void 0:n.call(e,"fill",{duration:null==(r=y.transitions)||null==(i=r.duration)?void 0:i.shorter}),fontSize:{inherit:"inherit",small:(null==(o=y.typography)||null==(a=o.pxToRem)?void 0:a.call(o,20))||"1.25rem",medium:(null==(s=y.typography)||null==(l=s.pxToRem)?void 0:l.call(s,24))||"1.5rem",large:(null==(u=y.typography)||null==(c=u.pxToRem)?void 0:c.call(u,35))||"2.1875rem"}[_.fontSize],color:null!=(h=null==(f=(y.vars||y).palette)||null==(p=f[_.color])?void 0:p.main)?h:{action:null==(d=(y.vars||y).palette)||null==(m=d.action)?void 0:m.active,disabled:null==(g=(y.vars||y).palette)||null==(v=g.action)?void 0:v.disabled,inherit:void 0}[_.color]}})),eT=t.forwardRef((function(t,e){var n=HI({props:t,name:"MuiSvgIcon"}),r=n.children,i=n.className,o=n.color,a=void 0===o?"inherit":o,s=n.component,l=void 0===s?"svg":s,u=n.fontSize,c=void 0===u?"medium":u,h=n.htmlColor,f=n.inheritViewBox,p=void 0!==f&&f,d=n.titleAccess,m=n.viewBox,g=void 0===m?"0 0 24 24":m,v=Ik(n,QI),y=DE({},n,{color:a,component:l,fontSize:c,instanceFontSize:t.fontSize,inheritViewBox:p,viewBox:g}),_={};p||(_.viewBox=g);var x=function(t){var e=t.color,n=t.fontSize,r=t.classes;return bk({root:["root","inherit"!==e&&"color".concat(nk(e)),"fontSize".concat(nk(n))]},JI,r)}(y);return Ak.exports.jsxs(tT,DE({as:l,className:Pk(x.root,i),focusable:"false",color:h,"aria-hidden":!d||void 0,role:d?"img":void 0,ref:e},_,v,{ownerState:y,children:[r,d?Ak.exports.jsx("title",{children:d}):null]}))}));eT.muiName="SvgIcon";var nT=eT;var rT={configure:function(t){Sk.configure(t)}},iT=Object.freeze({__proto__:null,unstable_ClassNameGenerator:rT,capitalize:nk,createChainedFunction:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce((function(t,e){return null==e?t:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r),e.apply(this,r)}}),(function(){}))},createSvgIcon:function(e,n){function r(t,r){return Ak.exports.jsx(nT,DE({"data-testid":"".concat(n,"Icon"),ref:r},t,{children:e}))}return r.muiName=nT.muiName,t.memo(t.forwardRef(r))},debounce:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=this,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s=function(){t.apply(r,o)};clearTimeout(e),e=setTimeout(s,n)}return r.clear=function(){clearTimeout(e)},r},deprecatedPropType:function(t,e){return function(){return null}},isMuiElement:function(e,n){return t.isValidElement(e)&&-1!==n.indexOf(e.type.muiName)},ownerDocument:rk,ownerWindow:function(t){return rk(t).defaultView||window},requirePropFactory:function(t,e){return function(){return null}},setRef:ik,unstable_useEnhancedEffect:ok,unstable_useId:function(e){if(void 0!==sk){var n=sk();return null!=e?e:n}return function(e){var n=t.useState(e),r=(0,l.Z)(n,2),i=r[0],o=r[1],a=e||i;return t.useEffect((function(){null==i&&o("mui-".concat(ak+=1))}),[i]),a}(e)},unsupportedProp:function(t,e,n,r,i){return null},useControlled:function(e){var n=e.controlled,r=e.default,i=(e.name,e.state,t.useRef(void 0!==n).current),o=t.useState(r),a=(0,l.Z)(o,2),s=a[0],u=a[1];return[i?n:s,t.useCallback((function(t){i||u(t)}),[])]},useEventCallback:lk,useForkRef:uk,useIsFocusVisible:yk}),oT=PE(iT);!function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=oT}(RE);var aT=LE.exports;Object.defineProperty(ME,"__esModule",{value:!0});ME.default=void 0;var sT=aT(RE),lT=Ak.exports,uT=(0,sT.default)((0,lT.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"}),"Print");function cT(t,e){return cT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cT(t,e)}ME.default=uT;var hT=t.createContext(null);function fT(e,n){var r=Object.create(null);return e&&t.Children.map(e,(function(t){return t})).forEach((function(e){r[e.key]=function(e){return n&&(0,t.isValidElement)(e)?n(e):e}(e)})),r}function pT(t,e,n){return null!=n[e]?n[e]:t.props[e]}function dT(e,n,r){var i=fT(e.children),o=function(t,e){function n(n){return n in e?e[n]:t[n]}t=t||{},e=e||{};var r,i=Object.create(null),o=[];for(var a in t)a in e?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var l in e){if(i[l])for(r=0;r<i[l].length;r++){var u=i[l][r];s[i[l][r]]=n(u)}s[l]=n(l)}for(r=0;r<o.length;r++)s[o[r]]=n(o[r]);return s}(n,i);return Object.keys(o).forEach((function(a){var s=o[a];if((0,t.isValidElement)(s)){var l=a in n,u=a in i,c=n[a],h=(0,t.isValidElement)(c)&&!c.props.in;!u||l&&!h?u||!l||h?u&&l&&(0,t.isValidElement)(c)&&(o[a]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:c.props.in,exit:pT(s,"exit",e),enter:pT(s,"enter",e)})):o[a]=(0,t.cloneElement)(s,{in:!1}):o[a]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:pT(s,"exit",e),enter:pT(s,"enter",e)})}})),o}var mT=Object.values||function(t){return Object.keys(t).map((function(e){return t[e]}))},gT=function(e){var n,r;function i(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,cT(n,r);var o=i.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},i.getDerivedStateFromProps=function(e,n){var r,i,o=n.children,a=n.handleExited;return{children:n.firstRender?(r=e,i=a,fT(r.children,(function(e){return(0,t.cloneElement)(e,{onExited:i.bind(null,e),in:!0,appear:pT(e,"appear",r),enter:pT(e,"enter",r),exit:pT(e,"exit",r)})}))):dT(e,o,a),firstRender:!1}},o.handleExited=function(t,e){var n=fT(this.props.children);t.key in n||(t.props.onExited&&t.props.onExited(e),this.mounted&&this.setState((function(e){var n=DE({},e.children);return delete n[t.key],{children:n}})))},o.render=function(){var e=this.props,n=e.component,r=e.childFactory,i=Ik(e,["component","childFactory"]),o=this.state.contextValue,a=mT(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,null===n?t.createElement(hT.Provider,{value:o},a):t.createElement(hT.Provider,{value:o},t.createElement(n,i,a))},i}(t.Component);gT.propTypes={},gT.defaultProps={component:"div",childFactory:function(t){return t}};var vT=gT;var yT,_T,xT,bT,wT=Ck("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),ST=["center","classes","className"],ET=jn(yT||(yT=fE||(fE=i(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),kT=jn(_T||(_T=pE||(pE=i(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),CT=jn(xT||(xT=dE||(dE=i(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),IT=KI("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TT=KI((function(e){var n=e.className,r=e.classes,i=e.pulsate,o=void 0!==i&&i,a=e.rippleX,s=e.rippleY,u=e.rippleSize,c=e.in,h=e.onExited,f=e.timeout,p=t.useState(!1),d=(0,l.Z)(p,2),m=d[0],g=d[1],v=Pk(n,r.ripple,r.rippleVisible,o&&r.ripplePulsate),y={width:u,height:u,top:-u/2+s,left:-u/2+a},_=Pk(r.child,m&&r.childLeaving,o&&r.childPulsate);return c||m||g(!0),t.useEffect((function(){if(!c&&null!=h){var t=setTimeout(h,f);return function(){clearTimeout(t)}}}),[h,c,f]),Ak.exports.jsx("span",{className:v,style:y,children:Ak.exports.jsx("span",{className:_})})}),{name:"MuiTouchRipple",slot:"Ripple"})(bT||(bT=mE||(mE=i(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),wT.rippleVisible,ET,550,(function(t){return t.theme.transitions.easing.easeInOut}),wT.ripplePulsate,(function(t){return t.theme.transitions.duration.shorter}),wT.child,wT.childLeaving,kT,550,(function(t){return t.theme.transitions.easing.easeInOut}),wT.childPulsate,CT,(function(t){return t.theme.transitions.easing.easeInOut})),PT=t.forwardRef((function(e,n){var r=HI({props:e,name:"MuiTouchRipple"}),i=r.center,o=void 0!==i&&i,s=r.classes,u=void 0===s?{}:s,c=r.className,h=Ik(r,ST),f=t.useState([]),p=(0,l.Z)(f,2),d=p[0],m=p[1],g=t.useRef(0),v=t.useRef(null);t.useEffect((function(){v.current&&(v.current(),v.current=null)}),[d]);var y=t.useRef(!1),_=t.useRef(null),x=t.useRef(null),b=t.useRef(null);t.useEffect((function(){return function(){clearTimeout(_.current)}}),[]);var w=t.useCallback((function(t){var e=t.pulsate,n=t.rippleX,r=t.rippleY,i=t.rippleSize,o=t.cb;m((function(t){return[].concat((0,a.Z)(t),[Ak.exports.jsx(TT,{classes:{ripple:Pk(u.ripple,wT.ripple),rippleVisible:Pk(u.rippleVisible,wT.rippleVisible),ripplePulsate:Pk(u.ripplePulsate,wT.ripplePulsate),child:Pk(u.child,wT.child),childLeaving:Pk(u.childLeaving,wT.childLeaving),childPulsate:Pk(u.childPulsate,wT.childPulsate)},timeout:550,pulsate:e,rippleX:n,rippleY:r,rippleSize:i},g.current)])})),g.current+=1,v.current=o}),[u]),S=t.useCallback((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=e.pulsate,i=void 0!==r&&r,a=e.center,s=void 0===a?o||e.pulsate:a,l=e.fakeElement,u=void 0!==l&&l;if("mousedown"===(null==t?void 0:t.type)&&y.current)y.current=!1;else{"touchstart"===(null==t?void 0:t.type)&&(y.current=!0);var c,h,f,p=u?null:b.current,d=p?p.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===t||0===t.clientX&&0===t.clientY||!t.clientX&&!t.touches)c=Math.round(d.width/2),h=Math.round(d.height/2);else{var m=t.touches&&t.touches.length>0?t.touches[0]:t,g=m.clientX,v=m.clientY;c=Math.round(g-d.left),h=Math.round(v-d.top)}if(s)(f=Math.sqrt((2*Math.pow(d.width,2)+Math.pow(d.height,2))/3))%2===0&&(f+=1);else{var S=2*Math.max(Math.abs((p?p.clientWidth:0)-c),c)+2,E=2*Math.max(Math.abs((p?p.clientHeight:0)-h),h)+2;f=Math.sqrt(Math.pow(S,2)+Math.pow(E,2))}null!=t&&t.touches?null===x.current&&(x.current=function(){w({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})},_.current=setTimeout((function(){x.current&&(x.current(),x.current=null)}),80)):w({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})}}),[o,w]),E=t.useCallback((function(){S({},{pulsate:!0})}),[S]),k=t.useCallback((function(t,e){if(clearTimeout(_.current),"touchend"===(null==t?void 0:t.type)&&x.current)return x.current(),x.current=null,void(_.current=setTimeout((function(){k(t,e)})));x.current=null,m((function(t){return t.length>0?t.slice(1):t})),v.current=e}),[]);return t.useImperativeHandle(n,(function(){return{pulsate:E,start:S,stop:k}}),[E,S,k]),Ak.exports.jsx(IT,DE({className:Pk(wT.root,u.root,c),ref:b},h,{children:Ak.exports.jsx(vT,{component:null,exit:!0,children:d})}))})),AT=PT;function MT(t){return kk("MuiButtonBase",t)}var LT=Ck("MuiButtonBase",["root","disabled","focusVisible"]),RT=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],DT=KI("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(t,e){return e.root}})((gE={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},(0,s.Z)(gE,"&.".concat(LT.disabled),{pointerEvents:"none",cursor:"default"}),(0,s.Z)(gE,"@media print",{colorAdjust:"exact"}),gE)),NT=t.forwardRef((function(e,n){var r=HI({props:e,name:"MuiButtonBase"}),i=r.action,o=r.centerRipple,a=void 0!==o&&o,s=r.children,u=r.className,c=r.component,h=void 0===c?"button":c,f=r.disabled,p=void 0!==f&&f,d=r.disableRipple,m=void 0!==d&&d,g=r.disableTouchRipple,v=void 0!==g&&g,y=r.focusRipple,_=void 0!==y&&y,x=r.LinkComponent,b=void 0===x?"a":x,w=r.onBlur,S=r.onClick,E=r.onContextMenu,k=r.onDragLeave,C=r.onFocus,I=r.onFocusVisible,T=r.onKeyDown,P=r.onKeyUp,A=r.onMouseDown,M=r.onMouseLeave,L=r.onMouseUp,R=r.onTouchEnd,D=r.onTouchMove,N=r.onTouchStart,z=r.tabIndex,O=void 0===z?0:z,F=r.TouchRippleProps,B=r.touchRippleRef,j=r.type,U=Ik(r,RT),V=t.useRef(null),Z=t.useRef(null),q=uk(Z,B),G=yk(),W=G.isFocusVisibleRef,X=G.onFocus,H=G.onBlur,Y=G.ref,$=t.useState(!1),K=(0,l.Z)($,2),J=K[0],Q=K[1];p&&J&&Q(!1),t.useImperativeHandle(i,(function(){return{focusVisible:function(){Q(!0),V.current.focus()}}}),[]);var tt=t.useState(!1),et=(0,l.Z)(tt,2),nt=et[0],rt=et[1];t.useEffect((function(){rt(!0)}),[]);var it=nt&&!m&&!p;function ot(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return lk((function(r){return e&&e(r),!n&&Z.current&&Z.current[t](r),!0}))}t.useEffect((function(){J&&_&&!m&&nt&&Z.current.pulsate()}),[m,_,J,nt]);var at=ot("start",A),st=ot("stop",E),lt=ot("stop",k),ut=ot("stop",L),ct=ot("stop",(function(t){J&&t.preventDefault(),M&&M(t)})),ht=ot("start",N),ft=ot("stop",R),pt=ot("stop",D),dt=ot("stop",(function(t){H(t),!1===W.current&&Q(!1),w&&w(t)}),!1),mt=lk((function(t){V.current||(V.current=t.currentTarget),X(t),!0===W.current&&(Q(!0),I&&I(t)),C&&C(t)})),gt=function(){var t=V.current;return h&&"button"!==h&&!("A"===t.tagName&&t.href)},vt=t.useRef(!1),yt=lk((function(t){_&&!vt.current&&J&&Z.current&&" "===t.key&&(vt.current=!0,Z.current.stop(t,(function(){Z.current.start(t)}))),t.target===t.currentTarget&&gt()&&" "===t.key&&t.preventDefault(),T&&T(t),t.target===t.currentTarget&&gt()&&"Enter"===t.key&&!p&&(t.preventDefault(),S&&S(t))})),_t=lk((function(t){_&&" "===t.key&&Z.current&&J&&!t.defaultPrevented&&(vt.current=!1,Z.current.stop(t,(function(){Z.current.pulsate(t)}))),P&&P(t),S&&t.target===t.currentTarget&&gt()&&" "===t.key&&!t.defaultPrevented&&S(t)})),xt=h;"button"===xt&&(U.href||U.to)&&(xt=b);var bt={};"button"===xt?(bt.type=void 0===j?"button":j,bt.disabled=p):(U.href||U.to||(bt.role="button"),p&&(bt["aria-disabled"]=p));var wt=uk(n,Y,V);var St=DE({},r,{centerRipple:a,component:h,disabled:p,disableRipple:m,disableTouchRipple:v,focusRipple:_,tabIndex:O,focusVisible:J}),Et=function(t){var e=t.disabled,n=t.focusVisible,r=t.focusVisibleClassName,i=bk({root:["root",e&&"disabled",n&&"focusVisible"]},MT,t.classes);return n&&r&&(i.root+=" ".concat(r)),i}(St);return Ak.exports.jsxs(DT,DE({as:xt,className:Pk(Et.root,u),ownerState:St,onBlur:dt,onClick:S,onContextMenu:st,onFocus:mt,onKeyDown:yt,onKeyUp:_t,onMouseDown:at,onMouseLeave:ct,onMouseUp:ut,onDragLeave:lt,onTouchEnd:ft,onTouchMove:pt,onTouchStart:ht,ref:wt,tabIndex:p?-1:O,type:j},bt,U,{children:[s,it?Ak.exports.jsx(AT,DE({ref:q,center:a},F)):null]}))})),zT=NT;function OT(t){return kk("MuiButton",t)}var FT=Ck("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var BT=t.createContext({}),jT=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],UT=function(t){return DE({},"small"===t.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===t.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===t.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},VT=KI(zT,{shouldForwardProp:function(t){return YI(t)||"classes"===t},name:"MuiButton",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.variant],e["".concat(n.variant).concat(nk(n.color))],e["size".concat(nk(n.size))],e["".concat(n.variant,"Size").concat(nk(n.size))],"inherit"===n.color&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})((function(t){var e,n,r,i=t.theme,o=t.ownerState;return DE({},i.typography.button,(e={minWidth:64,padding:"6px 16px",borderRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create(["background-color","box-shadow","border-color","color"],{duration:i.transitions.duration.short}),"&:hover":DE({textDecoration:"none",backgroundColor:i.vars?"rgba(".concat(i.vars.palette.text.primaryChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):vI(i.palette.text.primary,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===o.variant&&"inherit"!==o.color&&{backgroundColor:i.vars?"rgba(".concat(i.vars.palette[o.color].mainChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):vI(i.palette[o.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===o.variant&&"inherit"!==o.color&&{border:"1px solid ".concat((i.vars||i).palette[o.color].main),backgroundColor:i.vars?"rgba(".concat(i.vars.palette[o.color].mainChannel," / ").concat(i.vars.palette.action.hoverOpacity,")"):vI(i.palette[o.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===o.variant&&{backgroundColor:(i.vars||i).palette.grey.A100,boxShadow:(i.vars||i).shadows[4],"@media (hover: none)":{boxShadow:(i.vars||i).shadows[2],backgroundColor:(i.vars||i).palette.grey[300]}},"contained"===o.variant&&"inherit"!==o.color&&{backgroundColor:(i.vars||i).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(i.vars||i).palette[o.color].main}}),"&:active":DE({},"contained"===o.variant&&{boxShadow:(i.vars||i).shadows[8]})},(0,s.Z)(e,"&.".concat(FT.focusVisible),DE({},"contained"===o.variant&&{boxShadow:(i.vars||i).shadows[6]})),(0,s.Z)(e,"&.".concat(FT.disabled),DE({color:(i.vars||i).palette.action.disabled},"outlined"===o.variant&&{border:"1px solid ".concat((i.vars||i).palette.action.disabledBackground)},"outlined"===o.variant&&"secondary"===o.color&&{border:"1px solid ".concat((i.vars||i).palette.action.disabled)},"contained"===o.variant&&{color:(i.vars||i).palette.action.disabled,boxShadow:(i.vars||i).shadows[0],backgroundColor:(i.vars||i).palette.action.disabledBackground})),e),"text"===o.variant&&{padding:"6px 8px"},"text"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].main},"outlined"===o.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].main,border:i.vars?"1px solid rgba(".concat(i.vars.palette[o.color].mainChannel," / 0.5)"):"1px solid ".concat(vI(i.palette[o.color].main,.5))},"contained"===o.variant&&{color:i.vars?i.vars.palette.text.primary:null==(n=(r=i.palette).getContrastText)?void 0:n.call(r,i.palette.grey[300]),backgroundColor:(i.vars||i).palette.grey[300],boxShadow:(i.vars||i).shadows[2]},"contained"===o.variant&&"inherit"!==o.color&&{color:(i.vars||i).palette[o.color].contrastText,backgroundColor:(i.vars||i).palette[o.color].main},"inherit"===o.color&&{color:"inherit",borderColor:"currentColor"},"small"===o.size&&"text"===o.variant&&{padding:"4px 5px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"text"===o.variant&&{padding:"8px 11px",fontSize:i.typography.pxToRem(15)},"small"===o.size&&"outlined"===o.variant&&{padding:"3px 9px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"outlined"===o.variant&&{padding:"7px 21px",fontSize:i.typography.pxToRem(15)},"small"===o.size&&"contained"===o.variant&&{padding:"4px 10px",fontSize:i.typography.pxToRem(13)},"large"===o.size&&"contained"===o.variant&&{padding:"8px 22px",fontSize:i.typography.pxToRem(15)},o.fullWidth&&{width:"100%"})}),(function(t){var e;return t.ownerState.disableElevation&&(e={boxShadow:"none","&:hover":{boxShadow:"none"}},(0,s.Z)(e,"&.".concat(FT.focusVisible),{boxShadow:"none"}),(0,s.Z)(e,"&:active",{boxShadow:"none"}),(0,s.Z)(e,"&.".concat(FT.disabled),{boxShadow:"none"}),e)})),ZT=KI("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(t,e){var n=t.ownerState;return[e.startIcon,e["iconSize".concat(nk(n.size))]]}})((function(t){var e=t.ownerState;return DE({display:"inherit",marginRight:8,marginLeft:-4},"small"===e.size&&{marginLeft:-2},UT(e))})),qT=KI("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(t,e){var n=t.ownerState;return[e.endIcon,e["iconSize".concat(nk(n.size))]]}})((function(t){var e=t.ownerState;return DE({display:"inherit",marginRight:-4,marginLeft:8},"small"===e.size&&{marginRight:-2},UT(e))})),GT=t.forwardRef((function(e,n){var r=t.useContext(BT),i=HI({props:xk(r,e),name:"MuiButton"}),o=i.children,a=i.color,s=void 0===a?"primary":a,l=i.component,u=void 0===l?"button":l,c=i.className,h=i.disabled,f=void 0!==h&&h,p=i.disableElevation,d=void 0!==p&&p,m=i.disableFocusRipple,g=void 0!==m&&m,v=i.endIcon,y=i.focusVisibleClassName,_=i.fullWidth,x=void 0!==_&&_,b=i.size,w=void 0===b?"medium":b,S=i.startIcon,E=i.type,k=i.variant,C=void 0===k?"text":k,I=Ik(i,jT),T=DE({},i,{color:s,component:u,disabled:f,disableElevation:d,disableFocusRipple:g,fullWidth:x,size:w,type:E,variant:C}),P=function(t){var e=t.color,n=t.disableElevation,r=t.fullWidth,i=t.size,o=t.variant,a=t.classes;return DE({},a,bk({root:["root",o,"".concat(o).concat(nk(e)),"size".concat(nk(i)),"".concat(o,"Size").concat(nk(i)),"inherit"===e&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat(nk(i))],endIcon:["endIcon","iconSize".concat(nk(i))]},OT,a))}(T),A=S&&Ak.exports.jsx(ZT,{className:P.startIcon,ownerState:T,children:S}),M=v&&Ak.exports.jsx(qT,{className:P.endIcon,ownerState:T,children:v});return Ak.exports.jsxs(VT,DE({ownerState:T,className:Pk(r.className,P.root,c),component:u,disabled:f,focusRipple:!g,focusVisibleClassName:Pk(P.focusVisible,y),ref:n,type:E},I,{classes:P,children:[A,o,M]}))})),WT=GT,XT={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}};t.createContext({}),XT.A4["72dpi"];var HT="mapbox-gl-draw_boxselect",YT="add",$T="move",KT="pointer",JT="none",QT="polygon",tP="Feature",eP="Polygon",nP="LineString",rP="Point",iP="Multi",oP="MultiPoint",aP="MultiLineString",sP="MultiPolygon",lP="draw.create",uP="draw.update",cP="draw.combine",hP="draw.uncombine",fP="move",pP="change_coordinates",dP="feature",mP="midpoint",gP="vertex",vP="true",yP="false";function _P(t){return function(e){var n=e.featureTarget;return!!n&&(!!n.properties&&n.properties.meta===t)}}function xP(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===vP&&t.featureTarget.properties.meta===dP))}function bP(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===yP&&t.featureTarget.properties.meta===dP))}function wP(t){return void 0===t.featureTarget}function SP(t){var e=t.featureTarget;return!!e&&(!!e.properties&&e.properties.meta===gP)}function EP(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey}var kP=function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()}),0)},CP=function(t){setTimeout((function(){t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()}),0)};var IP=function(t,e,n,r){return{type:tP,properties:{meta:gP,parent:t,coord_path:n,active:r?vP:yP},geometry:{type:rP,coordinates:e}}},TP={onSetup:function(){console.log("Change mode: custom polygon");var t=this.newFeature({type:tP,properties:{},geometry:{type:eP,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),CP(this),this.updateUIClasses({mouse:YT}),this.activateUIButton(QT),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&function(t,e){return!!t.lngLat&&t.lngLat.lng===e[0]&&t.lngLat.lat===e[1]}(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode("custom_select",{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:YT}),t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat),this.map.fire(lP,{features:[t.polygon.toGeoJSON()]})},clickOnVertex:function(t){return this.changeMode("custom_select",{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat),SP(e)&&this.updateUIClasses({mouse:KT})}};TP.onTap=TP.onClick=function(t,e){return SP(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},TP.onKeyUp=function(t,e){!function(t){return 27===t.keyCode}(e)?function(t){return 13===t.keyCode}(e)&&this.changeMode("custom_select",{featureIds:[t.polygon.id]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode("custom_select"))},TP.onStop=function(t){this.updateUIClasses({mouse:JT}),kP(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate("0.".concat(t.currentVertexPosition)),t.polygon.isValid()?this.map.fire(lP,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode("custom_select",{},{silent:!0})))},TP.toDisplayFeatures=function(t,e,n){var r=e.properties.id===t.polygon.id;if(e.properties.active=r?vP:yP,!r)return n(e);if(0!==e.geometry.coordinates.length){var i=e.geometry.coordinates[0].length;if(!(i<3)){if(e.properties.meta=dP,n(IP(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),i>3){var o=e.geometry.coordinates[0].length-3;n(IP(t.polygon.id,e.geometry.coordinates[0][o],"0.".concat(o),!1))}if(i<=4){var a=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:tP,properties:e.properties,geometry:{coordinates:a,type:nP}}),3===i)return}return n(e)}}},TP.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode("custom_select")};var PP=AP;function AP(t,e){this.x=t,this.y=e}function MP(t,e){var n=e.getBoundingClientRect();return new PP(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}AP.prototype={clone:function(){return new AP(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},AP.convert=function(t){return t instanceof AP?t:Array.isArray(t)?new AP(t[0],t[1]):t};var LP=function(t,e,n){var r=e.geometry.coordinates,i=n.geometry.coordinates;if(r[1]>85||r[1]<-85||i[1]>85||i[1]<-85)return null;var o={lng:(r[0]+i[0])/2,lat:(r[1]+i[1])/2};return{type:tP,properties:{meta:mP,parent:t,lng:o.lng,lat:o.lat,coord_path:n.properties.coord_path},geometry:{type:rP,coordinates:[o.lng,o.lat]}}};function RP(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.geometry,i=r.type,o=r.coordinates,a=t.properties&&t.properties.id,s=[];function l(t,n){var r="",i=null;t.forEach((function(t,o){var l=void 0!==n&&null!==n?"".concat(n,".").concat(o):String(o),c=IP(a,t,l,u(l));if(e.midpoints&&i){var h=LP(a,i,c);h&&s.push(h)}i=c;var f=JSON.stringify(t);r!==f&&s.push(c),0===o&&(r=f)}))}function u(t){return!!e.selectedPaths&&-1!==e.selectedPaths.indexOf(t)}function c(){var n=i.replace(iP,"");o.forEach((function(r,i){var o={type:tP,properties:t.properties,geometry:{type:n,coordinates:r}};s=s.concat(RP(o,e,i))}))}return i===rP?s.push(IP(a,o,n,u(n))):i===eP?o.forEach((function(t,e){l(t,null!==n?"".concat(n,".").concat(e):String(e))})):i===nP?l(o,n):0===i.indexOf(iP)&&c(),s}function DP(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,n=t.length;e<n;e++)this.add(t[e]),void 0!==t[e]&&("string"===typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}DP.prototype.add=function(t){return this.has(t)||(this._length++,"string"===typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},DP.prototype.delete=function(t){return!1===this.has(t)||(this._length--,delete this._items[t],delete this._nums[t]),this},DP.prototype.has=function(t){return("string"===typeof t||"number"===typeof t)&&(void 0!==this._items[t]||void 0!==this._nums[t])},DP.prototype.values=function(){var t=this,e=[];return Object.keys(this._items).forEach((function(n){e.push({k:n,v:t._items[n]})})),Object.keys(this._nums).forEach((function(n){e.push({k:JSON.parse(n),v:t._nums[n]})})),e.sort((function(t,e){return t.v-e.v})).map((function(t){return t.k}))},DP.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var NP={exports:{}},zP=function(t){if(!t||!t.type)return null;var e=OP[t.type];if(!e)return null;if("geometry"===e)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===e)return{type:"FeatureCollection",features:[t]};if("featurecollection"===e)return t},OP={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};var FP=Object.freeze({__proto__:null,default:function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce((function(e,n){return e.concat(t(n))}),[]),e;case"Feature":return e.geometry?t(e.geometry).map((function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return void 0!==e.id&&(n.id=e.id),n})):[e];case"MultiPoint":return e.coordinates.map((function(t){return{type:"Point",coordinates:t}}));case"MultiPolygon":return e.coordinates.map((function(t){return{type:"Polygon",coordinates:t}}));case"MultiLineString":return e.coordinates.map((function(t){return{type:"LineString",coordinates:t}}));case"GeometryCollection":return e.geometries.map(t).reduce((function(t,e){return t.concat(e)}),[]);case"Point":case"Polygon":case"LineString":return[e]}}}),BP=zP,jP=PE(FP),UP=function(t){return function t(e){if(Array.isArray(e)&&e.length&&"number"===typeof e[0])return[e];return e.reduce((function(e,n){return Array.isArray(n)&&Array.isArray(n[0])?e.concat(t(n)):(e.push(n),e)}),[])}(t)};jP instanceof Function||(jP=jP.default);function VP(t){return Object.prototype.toString.call(t)}var ZP=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function qP(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)}var GP=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},WP=Object.prototype.hasOwnProperty||function(t,e){return e in t};function XP(t){if("object"===typeof t&&null!==t){var e;if(ZP(t))e=[];else if("[object Date]"===VP(t))e=new Date(t.getTime?t.getTime():t);else if(function(t){return"[object RegExp]"===VP(t)}(t))e=new RegExp(t);else if(function(t){return"[object Error]"===VP(t)}(t))e={message:t.message};else if(function(t){return"[object Boolean]"===VP(t)}(t)||function(t){return"[object Number]"===VP(t)}(t)||function(t){return"[object String]"===VP(t)}(t))e=Object(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},r=function(){};r.prototype=n,e=new r}return qP(GP(t),(function(n){e[n]=t[n]})),e}return t}function HP(t,e,n){var r=[],i=[],o=!0;return function t(a){var s=n?XP(a):a,l={},u=!0,c={node:s,node_:a,path:[].concat(r),parent:i[i.length-1],parents:i,key:r[r.length-1],isRoot:0===r.length,level:r.length,circular:null,update:function(t,e){c.isRoot||(c.parent.node[c.key]=t),c.node=t,e&&(u=!1)},delete:function(t){delete c.parent.node[c.key],t&&(u=!1)},remove:function(t){ZP(c.parent.node)?c.parent.node.splice(c.key,1):delete c.parent.node[c.key],t&&(u=!1)},keys:null,before:function(t){l.before=t},after:function(t){l.after=t},pre:function(t){l.pre=t},post:function(t){l.post=t},stop:function(){o=!1},block:function(){u=!1}};if(!o)return c;function h(){if("object"===typeof c.node&&null!==c.node){c.keys&&c.node_===c.node||(c.keys=GP(c.node)),c.isLeaf=0===c.keys.length;for(var t=0;t<i.length;t++)if(i[t].node_===a){c.circular=i[t];break}}else c.isLeaf=!0,c.keys=null;c.notLeaf=!c.isLeaf,c.notRoot=!c.isRoot}h();var f=e.call(c,c.node);return void 0!==f&&c.update&&c.update(f),l.before&&l.before.call(c,c.node),u?("object"!==typeof c.node||null===c.node||c.circular||(i.push(c),h(),qP(c.keys,(function(e,i){r.push(e),l.pre&&l.pre.call(c,c.node[e],e);var o=t(c.node[e]);n&&WP.call(c.node,e)&&(c.node[e]=o.node),o.isLast=i===c.keys.length-1,o.isFirst=0===i,l.post&&l.post.call(c,o),r.pop()})),i.pop()),l.after&&l.after.call(c,c.node),c):c}(t).node}function YP(t){this.value=t}function $P(t){return new YP(t)}YP.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!WP.call(e,r))return;e=e[r]}return e},YP.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!WP.call(e,r))return!1;e=e[r]}return!0},YP.prototype.set=function(t,e){for(var n=this.value,r=0;r<t.length-1;r++){var i=t[r];WP.call(n,i)||(n[i]={}),n=n[i]}return n[t[r]]=e,e},YP.prototype.map=function(t){return HP(this.value,t,!0)},YP.prototype.forEach=function(t){return this.value=HP(this.value,t,!1),this.value},YP.prototype.reduce=function(t,e){var n=1===arguments.length,r=n?this.value:e;return this.forEach((function(e){this.isRoot&&n||(r=t.call(this,r,e))})),r},YP.prototype.paths=function(){var t=[];return this.forEach((function(){t.push(this.path)})),t},YP.prototype.nodes=function(){var t=[];return this.forEach((function(){t.push(this.node)})),t},YP.prototype.clone=function(){var t=[],e=[];return function n(r){for(var i=0;i<t.length;i++)if(t[i]===r)return e[i];if("object"===typeof r&&null!==r){var o=XP(r);return t.push(r),e.push(o),qP(GP(r),(function(t){o[t]=n(r[t])})),t.pop(),e.pop(),o}return r}(this.value)},qP(GP(YP.prototype),(function(t){$P[t]=function(e){var n=[].slice.call(arguments,1),r=new YP(e);return r[t].apply(r,n)}}));var KP=$P,JP=QP;function QP(t){if(!(this instanceof QP))return new QP(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}QP.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},QP.prototype.equals=function(t){var e;return e=t instanceof QP?t.bbox():t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]},QP.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},QP.prototype.union=function(t){var e;return this._valid=!0,e=t instanceof QP?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},QP.prototype.bbox=function(){return this._valid?this._bbox:null},QP.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n},QP.prototype.intersect=function(t){return this._valid?(e=t instanceof QP?t.bbox():t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])):null;var e},QP.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)},QP.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var tA=function(t){if(!t)return[];var e=jP(BP(t)),n=[];return e.features.forEach((function(t){t.geometry&&(n=n.concat(UP(t.geometry.coordinates)))})),n},eA=KP,nA=JP,rA={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},iA=Object.keys(rA);function oA(t){for(var e=nA(),n=tA(t),r=0;r<n.length;r++)e.include(n[r]);return e}NP.exports=function(t){return oA(t).bbox()},NP.exports.polygon=function(t){return oA(t).polygon()},NP.exports.bboxify=function(t){return eA(t).map((function(t){t&&(iA.some((function(e){return!!t[e]&&-1!==rA[e].indexOf(t.type)}))&&(t.bbox=oA(t).bbox(),this.update(t)))}))};var aA=NP.exports,sA=-90,lA=function(t,e){var n=sA,r=90,i=sA,o=90,a=270,s=-270;t.forEach((function(t){var e=aA(t),l=e[1],u=e[3],c=e[0],h=e[2];l>n&&(n=l),u<r&&(r=u),u>i&&(i=u),l<o&&(o=l),c<a&&(a=c),h>s&&(s=h)}));var l=e;return n+l.lat>85&&(l.lat=85-n),i+l.lat>90&&(l.lat=90-i),r+l.lat<-85&&(l.lat=-85-r),o+l.lat<sA&&(l.lat=sA-o),a+l.lng<=-270&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),s+l.lng>=270&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l},uA=function(t,e){var n=lA(t.map((function(t){return t.toGeoJSON()})),e);t.forEach((function(t){var e,r=t.getCoordinates(),i=function(t){var e={lng:t[0]+n.lng,lat:t[1]+n.lat};return[e.lng,e.lat]},o=function(t){return t.map((function(t){return i(t)}))};t.type===rP?e=i(r):t.type===nP||t.type===oP?e=r.map(i):t.type===eP||t.type===aP?e=r.map(o):t.type===sP&&(e=r.map((function(t){return t.map((function(t){return o(t)}))}))),t.incomingCoords(e)}))},cA={onSetup:function(t){var e=this;console.log("Change mode: custom select");var n={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(n.initiallySelectedFeatureIds.filter((function(t){return void 0!==e.getFeature(t)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),n},fireUpdate:function(){this.map.fire(uP,{action:fP,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(){var t=this,e=this.getSelected(),n=e.filter((function(e){return t.isInstanceOf("MultiFeature",e)})),r=!1;if(e.length>1){r=!0;var i=e[0].type.replace("Multi","");e.forEach((function(t){t.type.replace("Multi","")!==i&&(r=!1)}))}var o=n.length>0,a=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:o,trash:a})},getUniqueIds:function(t){if(!t.length)return[];var e=t.map((function(t){return t.properties.id})).filter((function(t){return void 0!==t})).reduce((function(t,e){return t.add(e),t}),new DP);return e.values()},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){kP(this)},onMouseMove:function(t){return this.stopExtendedInteractions(t)},onMouseOut:function(t){if(t.dragMoving)return this.fireUpdate()}};cA.onTap=cA.onClick=function(t,e){return wP(e)?this.clickAnywhere(t,e):_P(gP)(e)?this.clickOnVertex(t,e):function(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.meta===dP}(e)?this.clickOnFeature(t,e):void 0},cA.clickAnywhere=function(t){var e=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach((function(t){return e.doRender(t)}))),kP(this),this.stopExtendedInteractions(t)},cA.clickOnVertex=function(t,e){this.changeMode("custom_direct_select",{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:$T})},cA.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},cA.clickOnFeature=function(t,e){var n=this;CP(this),this.stopExtendedInteractions(t);var r=EP(e),i=this.getSelectedIds(),o=e.featureTarget.properties.id,a=this.isSelected(o);if(!r&&a&&this.getFeature(o).type!==rP)return this.changeMode("custom_direct_select",{featureId:o});a&&r?(this.deselect(o),this.updateUIClasses({mouse:KT}),1===i.length&&kP(this)):!a&&r?(this.select(o),this.updateUIClasses({mouse:$T})):a||r||(i.forEach((function(t){return n.doRender(t)})),this.setSelected(o),this.updateUIClasses({mouse:$T})),this.doRender(o)},cA.onMouseDown=function(t,e){return xP(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&function(t){return!!t.originalEvent&&!!t.originalEvent.shiftKey&&0===t.originalEvent.button}(e)?this.startBoxSelect(t,e):void 0},cA.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=MP(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},cA.onTouchStart=function(t,e){if(xP(e))return this.startOnActiveFeature(t,e)},cA.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},cA.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:YT}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(HT),this.map.getContainer().appendChild(t.boxSelectElement));var n=MP(e.originalEvent,this.map.getContainer()),r=Math.min(t.boxSelectStartLocation.x,n.x),i=Math.max(t.boxSelectStartLocation.x,n.x),o=Math.min(t.boxSelectStartLocation.y,n.y),a=Math.max(t.boxSelectStartLocation.y,n.y),s="translate(".concat(r,"px, ").concat(o,"px)");t.boxSelectElement.style.transform=s,t.boxSelectElement.style.WebkitTransform=s,t.boxSelectElement.style.width="".concat(i-r,"px"),t.boxSelectElement.style.height="".concat(a-o,"px")},cA.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};uA(this.getSelected(),n),t.dragMoveLocation=e.lngLat},cA.onMouseUp=function(t,e){var n=this;if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){var r=[t.boxSelectStartLocation,MP(e.originalEvent,this.map.getContainer())],i=this.featuresAt(null,r,"click"),o=this.getUniqueIds(i).filter((function(t){return!n.isSelected(t)}));o.length&&(this.select(o),o.forEach((function(t){return n.doRender(t)})),this.updateUIClasses({mouse:$T}))}this.stopExtendedInteractions(t)},cA.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?vP:yP,n(e),this.fireActionable(),e.properties.active===vP&&e.geometry.type!==rP&&RP(e).forEach(n)},cA.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},cA.onCombineFeatures=function(){var t=this.getSelected();if(!(0===t.length||t.length<2)){for(var e=[],n=[],r=t[0].type.replace("Multi",""),i=0;i<t.length;i++){var o=t[i];if(o.type.replace("Multi","")!==r)return;o.type.includes("Multi")?o.getCoordinates().forEach((function(t){e.push(t)})):e.push(o.getCoordinates()),n.push(o.toGeoJSON())}if(n.length>1){var a=this.newFeature({type:tP,properties:n[0].properties,geometry:{type:"Multi".concat(r),coordinates:e}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.map.fire(cP,{createdFeatures:[a.toGeoJSON()],deletedFeatures:n})}this.fireActionable()}},cA.onUncombineFeatures=function(){var t=this,e=this.getSelected();if(0!==e.length){for(var n=[],r=[],i=function(i){var o=e[i];t.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((function(e){t.addFeature(e),e.properties=o.properties,n.push(e.toGeoJSON()),t.select([e.id])})),t.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))},o=0;o<e.length;o++)i(o);n.length>1&&this.map.fire(hP,{createdFeatures:n,deletedFeatures:r}),this.fireActionable()}};var hA=function(t,e,n,r){for(var i=[],o=t[0].toFixed(5),a=t[1].toFixed(5),s=0;s<n.length;s++)if(n[s].id!==e)for(var l=0;l<n[s].geometry.coordinates.length;l++)for(var u=0;u<n[s].geometry.coordinates[l].length;u++)o===n[s].geometry.coordinates[l][u][0].toFixed(5)&&a===n[s].geometry.coordinates[l][u][1].toFixed(5)&&i.push({featureId:n[s].id,coord_path:l+"."+u,lng:n[s].geometry.coordinates[l][u][0],lat:n[s].geometry.coordinates[l][u][1]});return i},fA=function(t){for(var e=t._controls.length-1;e>=0;e--){var n,r;if("simple_select"===(null===(n=t._controls[e])||void 0===n||null===(r=n.modes)||void 0===r?void 0:r.SIMPLE_SELECT))return t._controls[e]}return null},pA=_P(gP),dA=_P(mP),mA={fireUpdate:function(){this.map.fire(uP,{action:pP,features:this.getSelected().map((function(t){return t.toGeoJSON()}))})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties,r=t.selectedCoordPaths.indexOf(n.coord_path);EP(e)||-1!==r?EP(e)&&-1===r&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path];var i=fA(this.map).getAll(),o=hA(e.featureTarget._geometry.coordinates,e.featureTarget.properties.parent,i.features,this.map);t.groupMove_vertices=o;for(var a=0;a<t.groupMove_vertices.length;a++)t.groupMove_vertices[a].feature=this.getFeature(t.groupMove_vertices[a].featureId);var s=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(s)},onMidpoint:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties;t.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),t.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(t,e){return e.map((function(e){return{feature_id:t,coord_path:e}}))},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){uA(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,n){for(var r=t.selectedCoordPaths.map((function(e){return t.feature.getCoordinate(e)})),i=r.map((function(t){return{type:tP,properties:{},geometry:{type:rP,coordinates:t}}})),o=lA(i,n),a=0;a<r.length;a++){var s=r[a];t.feature.updateCoordinate(t.selectedCoordPaths[a],s[0]+o.lng,s[1]+o.lat);for(var l=0;l<t.groupMove_vertices.length;l++){var u=t.groupMove_vertices[l].coord_path.split(".");if("undefined"!==typeof u[0]&&"undefined"!==typeof u[1]&&"undefined"!==typeof t.groupMove_vertices[l].feature.coordinates[u[0]]&&"undefined"!==typeof t.groupMove_vertices[l].feature.coordinates[u[0]][u[1]]){var c=t.groupMove_vertices[l].feature.coordinates[u[0]][u[1]];t.groupMove_vertices[l].feature.updateCoordinate(t.groupMove_vertices[l].coord_path,c[0]+o.lng,c[1]+o.lat)}}}},clickNoTarget:function(){this.changeMode("custom_select")},clickInactive:function(){this.changeMode("custom_select")},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){var e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===rP)throw new TypeError("direct_select mode doesn't handle point features");var r={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[],groupMove_vertices:t.groupMove_vertices?t.groupMove_vertices:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,r.selectedCoordPaths)),this.setSelected(e),CP(this),this.setActionableState({trash:!0}),r},onStop:function(){kP(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=vP,n(e),RP(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=yP,n(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort((function(t,e){return e.localeCompare(t,"en",{numeric:!0})})).forEach((function(e){return t.feature.removeCoordinate(e)})),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),!1===t.feature.isValid()&&(this.deleteFeature([t.featureId]),this.changeMode("custom_select",{}))},onMouseMove:function(t,e){var n=xP(e),r=pA(e),i=0===t.selectedCoordPaths.length;n&&i||r&&!i?this.updateUIClasses({mouse:$T}):this.updateUIClasses({mouse:JT}),this.stopDragging(t)},onMouseOut:function(t){t.dragMoving&&this.fireUpdate()}};mA.onTouchStart=mA.onMouseDown=function(t,e){return pA(e)?this.onVertex(t,e):xP(e)?this.onFeature(t,e):dA(e)?this.onMidpoint(t,e):void 0},mA.onDrag=function(t,e){if(!0===t.canDragMove){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat}},mA.onClick=function(t,e){return wP(e)?this.clickNoTarget(t,e):xP(e)?this.clickActiveFeature(t,e):bP(e)?this.clickInactive(t,e):void this.stopDragging(t)},mA.onTap=function(t,e){return wP(e)?this.clickNoTarget(t,e):xP(e)?this.clickActiveFeature(t,e):bP(e)?this.clickInactive(t,e):void 0},mA.onTouchEnd=mA.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)};var gA=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function vA(e){var n=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=(0,t.useRef)(""),i=(0,t.useRef)(""),o=(0,t.useRef)(""),a=(0,t.useState)(),s=a[0],l=a[1],u=(0,t.useRef)(!1),c=(0,t.useRef)(e.layerId||(e.idPrefix?e.idPrefix:"Layer-")+n.componentId),h=(0,t.useCallback)((function(){var t,a;n.map&&(n.map.map.getLayer(c.current)&&n.cleanup(),n.map.map.getSource(c.current)&&n.map.map.removeSource(c.current),("string"!==typeof e.source||""!==e.source&&n.map.map.getSource(e.source))&&"undefined"!==typeof e.options.type&&(u.current=!0,n.map.addLayer(vE(vE(vE(vE({},e.options),e.geojson&&!e.source?{source:{type:"geojson",data:e.geojson}}:{}),e.source?{source:e.source}:{}),{id:c.current}),e.insertBeforeLayer?e.insertBeforeLayer:e.insertBeforeFirstSymbolLayer?n.map.firstSymbolLayer:void 0,n.componentId),l((function(){var t;return null===(t=n.map)||void 0===t?void 0:t.map.getLayer(c.current)})),"undefined"!==typeof e.onHover&&n.map.on("mousemove",c.current,e.onHover,n.componentId),"undefined"!==typeof e.onClick&&n.map.on("click",c.current,e.onClick,n.componentId),"undefined"!==typeof e.onLeave&&n.map.on("mouseleave",c.current,e.onLeave,n.componentId),n.map.on("styledata",(function(){var t;u.current&&!(null===(t=n.map)||void 0===t?void 0:t.map.getLayer(c.current))&&(console.log("Recreate Layer"),h())}),n.componentId),i.current=JSON.stringify(null===(t=e.options)||void 0===t?void 0:t.paint),o.current=JSON.stringify(null===(a=e.options)||void 0===a?void 0:a.layout),r.current=e.options.type))}),[e,n.map]);return(0,t.useEffect)((function(){n.map&&(u.current&&(-1===gA.indexOf(e.options.type)||-1!==gA.indexOf(e.options.type)&&e.options.type===r.current)||h())}),[n.map,e.options,h]),(0,t.useEffect)((function(){var t,r,i,o;u.current&&(null===(r=null===(t=n.map)||void 0===t?void 0:t.map)||void 0===r?void 0:r.getSource(c.current))&&(null===(o=null===(i=n.map.map.getSource(c.current))||void 0===i?void 0:i.setData)||void 0===o||o.call(i,e.geojson))}),[e.geojson,n.map,e.options.type]),(0,t.useEffect)((function(){var t,a,s,l,h;if(n.map&&(null===(s=null===(a=null===(t=n.map)||void 0===t?void 0:t.map)||void 0===a?void 0:a.getLayer)||void 0===s?void 0:s.call(a,c.current))&&u.current&&e.options.type===r.current){var f,p=JSON.stringify(e.options.layout);if(e.options.layout&&p!==o.current){var d=JSON.parse(o.current);for(f in e.options.layout)(null===(l=e.options.layout)||void 0===l?void 0:l[f])&&e.options.layout[f]!==d[f]&&n.map.map.setLayoutProperty(c.current,f,e.options.layout[f]);o.current=p}var m=JSON.stringify(e.options.paint);if(m!==i.current){var g=JSON.parse(i.current);for(f in e.options.paint)(null===(h=e.options.paint)||void 0===h?void 0:h[f])&&e.options.paint[f]!==g[f]&&n.map.map.setPaintProperty(c.current,f,e.options.paint[f]);i.current=m}}}),[e.options,n.map]),(0,t.useEffect)((function(){return function(){u.current=!1,n.cleanup()}}),[]),{map:n.map,layer:s,layerId:c.current,componentId:n.componentId,mapHook:n}}vA.defaultProps={};var yA=function(t,e){switch(t){case"fill":return(null===e||void 0===e?void 0:e.fill)?e.fill:{"fill-color":"rgba(10,240,256,0.6)"};case"line":return(null===e||void 0===e?void 0:e.line)?e.line:{"line-color":"rgb(203,211,2)","line-width":5};default:return(null===e||void 0===e?void 0:e.circle)?e.circle:{"circle-color":"rgba(10,240,256,0.8)","circle-stroke-color":"#fff","circle-stroke-width":2}}},_A={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},xA=function t(e){var n;return"Feature"===(null===e||void 0===e?void 0:e.type)?(null===_A||void 0===_A?void 0:_A[null===(n=null===e||void 0===e?void 0:e.geometry)||void 0===n?void 0:n.type])?_A[e.geometry.type]:"circle":"FeatureCollection"===(null===e||void 0===e?void 0:e.type)?e.features.length?t(e.features[0]):"circle":"fill"},bA=function(e){var n=e.type||xA(e.geojson);return vA({mapId:e.mapId,layerId:e.layerId||"MlGeoJsonLayer-"+g(),geojson:e.geojson,options:vE(vE({paint:e.paint||yA(n,e.defaultPaintOverrides),layout:e.layout||{}},e.options),{type:n}),insertBeforeLayer:e.insertBeforeLayer,onHover:e.onHover,onClick:e.onClick,onLeave:e.onLeave}),t.createElement(t.Fragment,null)},wA={},SA=LE.exports;Object.defineProperty(wA,"__esModule",{value:!0});var EA=wA.default=void 0,kA=SA(RE),CA=Ak.exports,IA=(0,kA.default)((0,CA.jsx)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"GpsFixed");EA=wA.default=IA;var TA=function(e){var n,r,i=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),o=(0,t.useState)(!1),a=o[0],s=o[1],l=(0,t.useState)(),u=l[0],c=l[1],h=(0,t.useState)(!1),f=h[0],p=h[1],d=(0,t.useState)(),m=d[0],g=d[1],v=(0,t.useState)(0),y=v[0],_=v[1],x=(0,t.useRef)(!1),b=(0,t.useCallback)((function(t){if(i.map&&((!e.centerUserPosition&&!x.current||e.centerUserPosition)&&(e.useFlyTo?i.map.map.flyTo({center:[t.coords.longitude,t.coords.latitude],zoom:18,speed:1,curve:1}):i.map.map.setCenter([t.coords.longitude,t.coords.latitude]),x.current=!0),e.showUserLocation)){var n=_c([t.coords.longitude,t.coords.latitude]);c(n),g(Vc(n,t.coords.accuracy/1e3))}}),[i.map,e]),w=function(){console.log("Access of user location denied"),p(!0)},S=(0,t.useMemo)((function(){if(u){var t=function(t,e,n,r,i){void 0===i&&(i={});var o=i.steps||64,a=Kc(n),s=Kc(r),l=Array.isArray(t)||"Feature"!==t.type?{}:t.properties;if(a===s)return bc(Vc(t,e,i).geometry.coordinates[0],l);for(var u=a,c=a<s?s:s+360,h=u,f=[],p=0;h<c;)f.push(Uc(t,e,h,i).geometry.coordinates),h=u+360*++p/o;return h>c&&f.push(Uc(t,e,c,i).geometry.coordinates),bc(f,l)}(u,.02,y-15,y+15,{steps:65}),e=t;return e.geometry.coordinates.push(u.geometry.coordinates),e.geometry.coordinates.slice(0,0),e}}),[y,u]),E=function(t){_(-t.alpha)};return(0,t.useEffect)((function(){if(a){var t=E;return window.addEventListener("deviceorientation",t),function(){window.removeEventListener("deviceorientation",t)}}x.current=!1}),[a]),(0,t.useEffect)((function(){if(i.map&&a){var t=navigator.geolocation.watchPosition(b,w);return function(){navigator.geolocation.clearWatch(t)}}}),[i.map,a,b]),t.createElement(t.Fragment,null,a&&u&&t.createElement(bA,{geojson:m,type:"fill",paint:vE({"fill-color":"#cbd300","fill-opacity":.3},e.accuracyPaint),insertBeforeLayer:e.insertBeforeLayer}),a&&S&&t.createElement(bA,{geojson:S,type:"fill",paint:vE({"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3},e.orientationConePaint),insertBeforeLayer:e.insertBeforeLayer}),a&&u&&t.createElement(bA,{geojson:u,type:"circle",paint:vE({"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1},e.circlePaint),insertBeforeLayer:e.insertBeforeLayer}),t.createElement(c_,{sx:vE({zIndex:1002,color:a?e.onColor:e.offColor},e.buttonSx),disabled:f,onClick:function(){s(!a)}}," ",t.createElement(EA,{sx:vE({},(null===(n=e.buttonSx)||void 0===n?void 0:n.fontSize)?{fontSize:null===(r=e.buttonSx)||void 0===r?void 0:r.fontSize}:{})})," "))};TA.defaultProps={mapId:void 0,buttonSx:{minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:"1.3em",":hover":{backgroundColor:"#515151",color:"#ececec"}},onColor:"#ececec",offColor:"#666",showAccuracyCircle:!0,showUserLocation:!0,showOrientation:!0,centerUserPosition:!0,useFlyTo:!1};function PA(t){return kk("MuiButtonGroup",t)}var AA=Ck("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]),MA=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],LA=KI("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"& .".concat(AA.grouped),e.grouped),(0,s.Z)({},"& .".concat(AA.grouped),e["grouped".concat(nk(n.orientation))]),(0,s.Z)({},"& .".concat(AA.grouped),e["grouped".concat(nk(n.variant))]),(0,s.Z)({},"& .".concat(AA.grouped),e["grouped".concat(nk(n.variant)).concat(nk(n.orientation))]),(0,s.Z)({},"& .".concat(AA.grouped),e["grouped".concat(nk(n.variant)).concat(nk(n.color))]),e.root,e[n.variant],!0===n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,"vertical"===n.orientation&&e.vertical]}})((function(t){var e=t.theme,n=t.ownerState;return DE({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},"contained"===n.variant&&{boxShadow:(e.vars||e).shadows[2]},n.disableElevation&&{boxShadow:"none"},n.fullWidth&&{width:"100%"},"vertical"===n.orientation&&{flexDirection:"column"},(0,s.Z)({},"& .".concat(AA.grouped),DE({minWidth:40,"&:not(:first-of-type)":DE({},"horizontal"===n.orientation&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},"vertical"===n.orientation&&{borderTopRightRadius:0,borderTopLeftRadius:0},"outlined"===n.variant&&"horizontal"===n.orientation&&{marginLeft:-1},"outlined"===n.variant&&"vertical"===n.orientation&&{marginTop:-1}),"&:not(:last-of-type)":DE({},"horizontal"===n.orientation&&{borderTopRightRadius:0,borderBottomRightRadius:0},"vertical"===n.orientation&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},"text"===n.variant&&"horizontal"===n.orientation&&{borderRight:e.vars?"1px solid rgba(".concat(e.vars.palette.common.onBackgroundChannel," / 0.23)"):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"vertical"===n.orientation&&{borderBottom:e.vars?"1px solid rgba(".concat(e.vars.palette.common.onBackgroundChannel," / 0.23)"):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"inherit"!==n.color&&{borderColor:e.vars?"rgba(".concat(e.vars.palette[n.color].mainChannel," / 0.5)"):vI(e.palette[n.color].main,.5)},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"transparent"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"transparent"},"contained"===n.variant&&"horizontal"===n.orientation&&(0,s.Z)({borderRight:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(AA.disabled),{borderRight:"1px solid ".concat((e.vars||e).palette.action.disabled)}),"contained"===n.variant&&"vertical"===n.orientation&&(0,s.Z)({borderBottom:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(AA.disabled),{borderBottom:"1px solid ".concat((e.vars||e).palette.action.disabled)}),"contained"===n.variant&&"inherit"!==n.color&&{borderColor:(e.vars||e).palette[n.color].dark},{"&:hover":DE({},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"currentColor"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"currentColor"})}),"&:hover":DE({},"contained"===n.variant&&{boxShadow:"none"})},"contained"===n.variant&&{boxShadow:"none"})))})),RA=t.forwardRef((function(e,n){var r=HI({props:e,name:"MuiButtonGroup"}),i=r.children,o=r.className,a=r.color,s=void 0===a?"primary":a,l=r.component,u=void 0===l?"div":l,c=r.disabled,h=void 0!==c&&c,f=r.disableElevation,p=void 0!==f&&f,d=r.disableFocusRipple,m=void 0!==d&&d,g=r.disableRipple,v=void 0!==g&&g,y=r.fullWidth,_=void 0!==y&&y,x=r.orientation,b=void 0===x?"horizontal":x,w=r.size,S=void 0===w?"medium":w,E=r.variant,k=void 0===E?"outlined":E,C=Ik(r,MA),I=DE({},r,{color:s,component:u,disabled:h,disableElevation:p,disableFocusRipple:m,disableRipple:v,fullWidth:_,orientation:b,size:S,variant:k}),T=function(t){var e=t.classes,n=t.color,r=t.disabled,i=t.disableElevation,o=t.fullWidth,a=t.orientation,s=t.variant;return bk({root:["root",s,"vertical"===a&&"vertical",o&&"fullWidth",i&&"disableElevation"],grouped:["grouped","grouped".concat(nk(a)),"grouped".concat(nk(s)),"grouped".concat(nk(s)).concat(nk(a)),"grouped".concat(nk(s)).concat(nk(n)),r&&"disabled"]},PA,e)}(I),P=t.useMemo((function(){return{className:T.grouped,color:s,disabled:h,disableElevation:p,disableFocusRipple:m,disableRipple:v,fullWidth:_,size:S,variant:k}}),[s,h,p,m,v,_,S,k,T.grouped]);return Ak.exports.jsx(LA,DE({as:u,role:"group",className:Pk(T.root,o),ref:n,ownerState:I},C,{children:Ak.exports.jsx(BT.Provider,{value:P,children:i})}))})),DA=RA,NA={},zA=LE.exports;Object.defineProperty(NA,"__esModule",{value:!0});var OA=NA.default=void 0,FA=zA(RE),BA=Ak.exports,jA=(0,FA.default)((0,BA.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"ControlPoint");OA=NA.default=jA;var UA={},VA=LE.exports;Object.defineProperty(UA,"__esModule",{value:!0});var ZA=UA.default=void 0,qA=VA(RE),GA=Ak.exports,WA=(0,qA.default)((0,GA.jsx)("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutline");ZA=UA.default=WA;var XA=function(t){return((t<1?5.11916*Math.pow(t,2):4.5*Math.log(t+1)+2)/100).toFixed(2)},HA=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultTheme,r=e.defaultClassName,i=void 0===r?"MuiBox-root":r,o=e.generateClassName,a=Zk("div",{shouldForwardProp:function(t){return"theme"!==t&&"sx"!==t&&"as"!==t}})(OC),s=t.forwardRef((function(t,e){var r=KC(n),s=BC(t),l=s.className,u=s.component,c=void 0===u?"div":u,h=Ik(s,JC);return Ak.exports.jsx(a,DE({as:c,ref:e,className:Pk(l,o?o(i):i),theme:r},h))}));return s}({defaultTheme:WI(),defaultClassName:"MuiBox-root",generateClassName:Sk.generate}),YA=HA;function $A(){return $A=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$A.apply(this,arguments)}var KA,JA=function(e){return t.createElement("svg",$A({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064"},e),t.createElement("g",{transform:"translate(-86.019554,-58.032633)"},t.createElement("path",{style:{strokeWidth:.744756},d:"m 442.74023,219.33594 -117.62695,32.32422 54.71094,31.12304 c -21.99397,41.5931 -32.8507,84.88283 -38.33008,127.89649 -6.86182,50.94051 -5.95715,103.99765 20.23828,155.46484 5.97246,11.72776 13.65817,23.59773 24.38867,35.06641 2.6597,2.84073 5.65602,5.75455 9.12891,8.68164 0.87557,0.7378 1.85363,1.52609 2.95117,2.35547 0.29669,0.22563 0.63616,0.47742 1.02149,0.75586 l 0.58203,0.42578 34.57812,-15.12305 -0.33789,-0.2207 c -0.0265,-0.0151 -0.0842,-0.0587 -0.18359,-0.13086 -0.46723,-0.34885 -0.9819,-0.76796 -1.56055,-1.25 -2.29757,-1.91343 -4.46539,-4.04643 -6.64062,-6.33985 -8.80052,-9.27114 -15.30333,-19.4993 -20.83985,-30.13867 -24.42289,-46.90715 -24.77465,-97.03535 -18.58008,-146.68164 4.94388,-37.37493 13.65299,-74.4847 30.20508,-109.92969 l 58.6211,33.34766 z",transform:"scale(0.26458333)"})))};function QA(){return QA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},QA.apply(this,arguments)}var tM,eM=function(e){return t.createElement("svg",QA({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064"},e),KA||(KA=t.createElement("g",{transform:"translate(-86.019554,-58.032633)"},t.createElement("path",{d:"m 94.572523,58.032633 31.122127,8.55245 -14.4756,8.234638 c 5.81924,11.004841 8.69175,22.458582 10.1415,33.839279 1.81552,13.47801 1.57616,27.51604 -5.35471,41.13341 -1.58021,3.10296 -3.61373,6.24356 -6.45284,9.27798 -0.70371,0.75161 -1.49649,1.52256 -2.41535,2.29702 -0.23167,0.19521 -0.49044,0.40378 -0.78083,0.62322 -0.0785,0.0597 -0.16832,0.12632 -0.27027,0.19999 l -0.154,0.11265 -9.148793,-4.00131 0.0894,-0.0584 c 0.007,-0.004 0.02228,-0.0155 0.04857,-0.0346 0.123621,-0.0923 0.259794,-0.20319 0.412895,-0.33073 0.607899,-0.50626 1.181468,-1.07062 1.756997,-1.67742 2.328481,-2.45299 4.049011,-5.15919 5.513881,-7.97419 6.46189,-12.41085 6.55496,-25.67394 4.91598,-38.80952 -1.30807,-9.888781 -3.61235,-19.707408 -7.99176,-29.085561 l -15.510171,8.823235 z"}))))};function nM(){return nM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nM.apply(this,arguments)}var rM,iM,oM,aM=function(e){return t.createElement("svg",nM({width:"75.967445mm",height:"234.71339mm",viewBox:"0 0 75.967445 234.71339"},e),tM||(tM=t.createElement("g",{transform:"translate(-76.705281,-29.77268)"},t.createElement("path",{d:"m 114.68901,29.77268 37.98372,117.3567 H 76.705281 Z"}),t.createElement("path",{d:"m 114.68901,264.48608 37.98372,-117.3567 H 76.705281 Z"}))))},sM=Ln.Z.div(rM||(rM=wE(["\n\twidth: 40%;\n\tdisplay: flex;\n\talign-items: center;\n\n\t&:hover {\n\t\tcursor: pointer;\n\t}\n\tpath {\n\t\tfilter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n\t}\n\t&:hover path {\n\t\tfilter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n\t}\n\tpath:nth-of-type(2) {\n\t\tfill: #343434;\n\t}\n\t&:hover path:nth-of-type(2) {\n\t\tfill: #434343;\n\t}\n\tpath:nth-of-type(1) {\n\t\tfill: #e90318;\n\t}\n\t&:hover path:nth-of-type(1) {\n\t\tfill: #fb4052;\n\t}\n"],["\n\twidth: 40%;\n\tdisplay: flex;\n\talign-items: center;\n\n\t&:hover {\n\t\tcursor: pointer;\n\t}\n\tpath {\n\t\tfilter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n\t}\n\t&:hover path {\n\t\tfilter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n\t}\n\tpath:nth-of-type(2) {\n\t\tfill: #343434;\n\t}\n\t&:hover path:nth-of-type(2) {\n\t\tfill: #434343;\n\t}\n\tpath:nth-of-type(1) {\n\t\tfill: #e90318;\n\t}\n\t&:hover path:nth-of-type(1) {\n\t\tfill: #fb4052;\n\t}\n"]))),lM=Ln.Z.div(iM||(iM=wE(["\n\tpointer-events: none;\n\tdisplay: flex;\n\tz-index: 1002;\n\tposition: absolute;\n\talign-items: center;\n\n\tmargin-left: -30%;\n\tpath:nth-of-type(2) {\n\t}\n\tsvg g {\n\t\ttransform: translate(-76.7053, -29.7727) scale(2, 1);\n\t}\n\tsvg {\n\t\tz-index: 9990;\n\t\theight: 150px;\n\t\twidth: 200px;\n\t}\n"],["\n\tpointer-events: none;\n\tdisplay: flex;\n\tz-index: 1002;\n\tposition: absolute;\n\talign-items: center;\n\n\tmargin-left: -30%;\n\tpath:nth-of-type(2) {\n\t}\n\tsvg g {\n\t\ttransform: translate(-76.7053, -29.7727) scale(2, 1);\n\t}\n\tsvg {\n\t\tz-index: 9990;\n\t\theight: 150px;\n\t\twidth: 200px;\n\t}\n"]))),uM=Ln.Z.div(oM||(oM=wE(["\n\twidth: 30%;\n\tmargin-top: 14px;\n\tz-index: 999;\n\tdisplay: flex;\n\n\tsvg:hover {\n\t\tcursor: pointer;\n\t}\n\tsvg:hover path {\n\t\tfill: #ececec;\n\t\tfilter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n\t}\n\tpath {\n\t\tfill: #bbb;\n\t}\n\tsvg {\n\t\ttransform: scale(0.6);\n\t\tz-index: 9990;\n\t\theight: 172px;\n\t}\n"],["\n\twidth: 30%;\n\tmargin-top: 14px;\n\tz-index: 999;\n\tdisplay: flex;\n\n\tsvg:hover {\n\t\tcursor: pointer;\n\t}\n\tsvg:hover path {\n\t\tfill: #ececec;\n\t\tfilter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n\t}\n\tpath {\n\t\tfill: #bbb;\n\t}\n\tsvg {\n\t\ttransform: scale(0.6);\n\t\tz-index: 9990;\n\t\theight: 172px;\n\t}\n"]))),cM=function(e){var n=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=(0,t.useState)(0),i=r[0],o=r[1];return(0,t.useEffect)((function(){if(n.map){var t=function(){var t,e;(null===(e=null===(t=n.map)||void 0===t?void 0:t.map)||void 0===e?void 0:e.getBearing)&&o(Math.round(n.map.map.getBearing()))};return n.map.on("rotate",t,n.componentId),t(),function(){var e;null===(e=n.map)||void 0===e||e.map.off("rotate",t)}}}),[n.map,e.mapId]),t.createElement(t.Fragment,null,t.createElement("div",{className:C_(vE({zIndex:1e3,top:0,position:"absolute"},e.style))},t.createElement("div",{className:C_(vE({position:"absolute",border:"10px solid #bcbcbc",backgroundColor:"#717171",background:"radial-gradient(#717171, #414141)",height:"200px",width:"200px",borderRadius:"50%",display:"flex",justifyContent:"center",transform:"scale(0.2) translateX(-448px) translateY(-448px)"},e.backgroundStyle))},t.createElement(uM,{className:C_(vE({},e.rotateRightStyle))},t.createElement(JA,{onClick:function(){if(n.map){var t=Math.round(n.map.map.getBearing()),e=Math.round(t%90);t>0&&(e=90-e),0===e&&(e=90),n.map.map.setBearing(Math.round(t+Math.abs(e)))}}})),t.createElement(sM,{className:C_(vE({},e.needleStyle)),onClick:function(){var t;null===(t=n.map)||void 0===t||t.map.setBearing(0)}},t.createElement(lM,{style:{transform:"rotate("+(i>0?"-"+i:-1*i)+"deg)"}},t.createElement(aM,null))),t.createElement(uM,{className:C_(vE({},e.rotateLeftStyle))},t.createElement(eM,{onClick:function(){if(n.map){var t=Math.round(n.map.map.getBearing()),e=Math.round(t%90);t<0&&(e=90+e),0===e&&(e=90),n.map.map.setBearing(Math.round(t-Math.abs(e)))}}})))))};function hM(e,n,r,i,o){var a="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,s=t.useState((function(){return o&&a?r(e).matches:i?i(e).matches:n})),u=(0,l.Z)(s,2),c=u[0],h=u[1];return ok((function(){var t=!0;if(a){var n=r(e),i=function(){t&&h(n.matches)};return i(),n.addListener(i),function(){t=!1,n.removeListener(i)}}}),[e,r,a]),c}cM.propTypes={idPrefix:y().string,style:y().object,backgroundStyle:y().object,needleStyle:y().object,rotateRightStyle:y().object,rotateLeftStyle:y().object};var fM=e.useSyncExternalStore;function pM(e,n,r,i){var o=t.useCallback((function(){return n}),[n]),a=t.useMemo((function(){if(null!==i){var t=i(e).matches;return function(){return t}}return o}),[o,e,i]),s=t.useMemo((function(){if(null===r)return[o,function(){return function(){}}];var t=r(e);return[function(){return t.matches},function(e){return t.addListener(e),function(){t.removeListener(e)}}]}),[o,r,e]),u=(0,l.Z)(s,2),c=u[0],h=u[1];return fM(h,c,a)}var dM=function(e){var n,r,i=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),o=(0,t.useState)(!1),a=o[0],s=o[1],l=(0,t.useCallback)((function(t){var e,n,r;null===(r=null===(e=i.map)||void 0===e?void 0:(n=e.map).setCenter)||void 0===r||r.call(n,[t.coords.longitude,t.coords.latitude])}),[i.map]),u=function(){console.log("Access of user location denied"),s(!0)};return t.createElement(t.Fragment,null,t.createElement(c_,{sx:vE({zIndex:1002,color:a?e.offColor:e.onColor},e.style),onClick:function(){navigator.geolocation.getCurrentPosition(l,u)},disabled:a},t.createElement(EA,{sx:vE({},(null===(n=e.style)||void 0===n?void 0:n.fontSize)?{fontSize:null===(r=e.style)||void 0===r?void 0:r.fontSize}:{})})," "))};dM.defaultProps={mapId:void 0,style:{minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:"1.3em",":hover":{backgroundColor:"#515151",color:"#ececec"}},onColor:"#ececec",offColor:"#666"};var mM=function(e){var n=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=(0,t.useState)(0),i=r[0],o=r[1],a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=YC(),r="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,i=fI({name:"MuiUseMediaQuery",props:e,theme:n}),o=i.defaultMatches,a=void 0!==o&&o,s=i.matchMedia,l=void 0===s?r?window.matchMedia:null:s,u=i.ssrMatchMedia,c=void 0===u?null:u,h=i.noSsr,f="function"===typeof t?t(n):t;return f=f.replace(/^@media( ?)/m,""),(void 0!==fM?pM:hM)(f,a,l,c,h)}("(max-width:900px)"),s={minWidth:"20px",minHeight:"20px",width:a?"50px":"30px",height:a?"50px":"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:a?"1.4em":"1.2em",":hover":{backgroundColor:"#515151"},color:"#ececec"},l={fontSize:s.fontSize};(0,t.useEffect)((function(){n.map&&(n.map.on("pitchend",(function(){n.map&&o(n.map.map.getPitch())}),n.componentId),o(n.map.map.getPitch()))}),[n.map,e.mapId]);return t.createElement(YA,{sx:vE(vE({zIndex:501,position:"absolute",display:"flex",flexDirection:"column"},a?{margin:"20px 10px 20px 10px"}:{}),e.sx)},t.createElement(cM,{style:{width:"31px",position:"relative",height:a?"55px":"45px",marginLeft:a?"3px":"-5px",transform:a?"scale(1.6)":"scale(1)"},backgroundStyle:{boxShadow:"0px 0px 18px rgba(0,0,0,.5)"}}),e.show3DButton&&t.createElement(WT,{sx:vE(vE({},s),{fontSize:a?"1.4em":"1em",fontWeight:600}),onClick:function(){if(n.map){var t=60;0!==n.map.map.getPitch()&&(t=0),n.map.map.easeTo({pitch:t})}}},i?"2D":"3D"),e.showFollowGpsButton&&t.createElement(TA,{buttonSx:vE({},function(t){return yE(t,["color"])}(s))}),e.showCenterLocationButton&&t.createElement(dM,{style:vE({},function(t){return yE(t,["color"])}(s))}),t.createElement(DA,{orientation:"vertical",sx:{width:"50px",border:"none",Button:{minWidth:"20px !important",border:"none",padding:0},"Button:hover":{border:"none"}}},e.showZoomButtons&&t.createElement(t.Fragment,null,t.createElement(WT,{sx:vE({},s),onClick:function(){n.map&&n.map.map.transform._zoom+.5<=n.map.map.transform._maxZoom&&n.map.map.easeTo({zoom:n.map.map.transform._zoom+.5})}},t.createElement(OA,{sx:vE({},l)})),t.createElement(WT,{sx:vE({},s),onClick:function(){n.map&&n.map.map.transform._zoom-.5>=n.map.map.transform._minZoom&&n.map.map.easeTo({zoom:n.map.map.transform._zoom-.5})}},t.createElement(ZA,{sx:vE({},l)})))),e.children&&t.cloneElement(e.children,{sx:vE({},s)}))};mM.defaultProps={mapId:void 0,show3DButton:!0,showFollowGpsButton:!0,showCenterLocationButton:!1,showZoomButtons:!0,sx:{right:"5px",bottom:"20px"}};var gM={visible:!0,urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:256,height:256,styles:""},attribution:"",sourceOptions:{minZoom:0,maxZoom:20},layerOptions:{minZoom:0,maxZoom:20}},vM=function(e){var n=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=(0,t.useRef)(!1),i=(0,t.useRef)(e.layerId||"MlWmsLayer-"+n.componentId),o=(0,t.useMemo)((function(){var t,n=e.url;-1!==e.url.indexOf("?")&&(n=(t=e.url.split("?"))[0]);var r=new URLSearchParams(null===t||void 0===t?void 0:t[1]),i=vE(vE(vE({},gM.urlParameters),Object.fromEntries(r)),e.urlParameters),o=new URLSearchParams(i);return n+"?"+(decodeURIComponent(o.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":"))}),[e.urlParameters,e.url]),a=(0,t.useCallback)((function(){n.map&&(r.current=!0,n.map.map.getLayer(i.current)&&n.cleanup(),n.map.addSource(i.current,vE({type:"raster",tiles:[o],tileSize:256,attribution:e.attribution},e.sourceOptions),n.componentId),n.map.addLayer(vE({id:i.current,type:"raster",source:i.current},e.layerOptions),e.insertBeforeLayer,n.componentId),n.map.on("styledata",(function(){var t;r.current&&!(null===(t=n.map)||void 0===t?void 0:t.map.getLayer(i.current))&&(console.log("Recreate Layer "+i.current),a())}),n.componentId),e.visible||n.map.map.setLayoutProperty(i.current,"visibility","none"))}),[n.map,e,o]);return(0,t.useEffect)((function(){r.current||a()}),[a]),(0,t.useEffect)((function(){var t,e,a,s;n.map&&(null===(s=null===(a=null===(e=null===(t=n.map)||void 0===t?void 0:t.map)||void 0===e?void 0:e.style)||void 0===a?void 0:a.sourceCaches)||void 0===s?void 0:s[i.current])&&r.current&&(n.map.map.getSource(i.current).tiles=[o],n.map.map.style.sourceCaches[i.current].clearTiles(),n.map.map.style.sourceCaches[i.current].update(n.map.map.transform),n.map.map.triggerRepaint())}),[n.map,o]),(0,t.useEffect)((function(){n.map&&r.current&&(e.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))}),[e.visible,n.map]),t.createElement(t.Fragment,null)};function yM(t){return yM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yM(t)}function _M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(t,e)||xM(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xM(t,e){if(t){if("string"===typeof t)return bM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bM(t,e):void 0}}function bM(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}vM.defaultProps=vE({},gM),vM.propTypes={url:y().string.isRequired,urlParameters:y().shape({layers:y().string.isRequired,bbox:y().string,format:y().string,service:y().string,version:y().string,request:y().string,srs:y().string,width:y().number,height:y().number}),mapId:y().string,attribution:y().string,layerOptions:y().object,sourceOptions:y().object,insertBeforeLayer:y().string,visible:y().bool};Ck("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);KI("div",{name:"MuiPaper",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.variant],!n.square&&e.rounded,"elevation"===n.variant&&e["elevation".concat(n.elevation)]]}})((function(t){var e,n=t.theme,r=t.ownerState;return DE({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!r.square&&{borderRadius:n.shape.borderRadius},"outlined"===r.variant&&{border:"1px solid ".concat((n.vars||n).palette.divider)},"elevation"===r.variant&&DE({boxShadow:(n.vars||n).shadows[r.elevation]},!n.vars&&"dark"===n.palette.mode&&{backgroundImage:"linear-gradient(".concat(vI("#fff",XA(r.elevation)),", ").concat(vI("#fff",XA(r.elevation)),")")},n.vars&&{backgroundImage:null==(e=n.vars.overlays)?void 0:e[r.elevation]}))}));var wM=function(){var t,e=/\s*/g,r=/^\s*|\s*$/g,i=/\s+/;function o(t){if(!t||!t.length)return 0;for(var e=0,n=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e)|0;return n}function a(t,e){return t.getElementsByTagName(e)}function s(t,e){return t.getAttribute(e)}function l(t,e){return parseFloat(s(t,e))}function u(t,e){var n=a(t,e);return n.length?n[0]:null}function c(t){for(var e=0,n=[];e<t.length;e++)n[e]=parseFloat(t[e]);return n}function h(t){var e;return t&&(e=t).normalize&&e.normalize(),t&&t.textContent||""}function f(t,e){var n,r,i={};for(r=0;r<e.length;r++)(n=u(t,e[r]))&&(i[e[r]]=h(n));return i}function p(t,e){for(var n in e)t[n]=e[n]}function d(t){return c(t.replace(e,"").split(","))}function m(t){for(var e=t.replace(r,"").split(i),n=[],o=0;o<e.length;o++)n.push(d(e[o]));return n}function g(t){var e,n=[l(t,"lon"),l(t,"lat")],r=u(t,"ele"),i=u(t,"gpxtpx:hr")||u(t,"hr"),o=u(t,"time");return r&&(e=parseFloat(h(r)),isNaN(e)||n.push(e)),{coordinates:n,time:o?h(o):null,heartRate:i?parseFloat(h(i)):null}}if("undefined"!==typeof XMLSerializer)t=new XMLSerializer;else{var v="object"===("undefined"===typeof process?"undefined":yM(process))&&!process.browser,y="object"===("undefined"===typeof Titanium?"undefined":yM(Titanium));if("object"!==("undefined"===typeof exports?"undefined":yM(exports))||!v&&!y)throw new Error("Unable to initialize serializer");t=new(n(8655).XMLSerializer)}function _(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}var x={kml:function(t){for(var e={type:"FeatureCollection",features:[]},n={},r={},i={},l=["Polygon","LineString","Point","Track","gx:Track"],f=a(t,"Placemark"),p=a(t,"Style"),g=a(t,"StyleMap"),v=0;v<p.length;v++){var y=o(_(p[v])).toString(16);n["#"+s(p[v],"id")]=y,r[y]=p[v]}for(var x=0;x<g.length;x++){n["#"+s(g[x],"id")]=o(_(g[x])).toString(16);for(var b=a(g[x],"Pair"),w={},S=0;S<b.length;S++)w[h(u(b[S],"key"))]=h(u(b[S],"styleUrl"));i["#"+s(g[x],"id")]=w}for(var E=0;E<f.length;E++)e.features=e.features.concat(P(f[E]));function k(t){var e,n;return"#"===(t=t||"").substr(0,1)&&(t=t.substr(1)),6!==t.length&&3!==t.length||(e=t),8===t.length&&(n=parseInt(t.substr(0,2),16)/255,e="#"+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)),[e,isNaN(n)?void 0:n]}function C(t){return c(t.split(" "))}function I(t){var e=a(t,"coord"),n=[],r=[];0===e.length&&(e=a(t,"gx:coord"));for(var i=0;i<e.length;i++)n.push(C(h(e[i])));for(var o=a(t,"when"),s=0;s<o.length;s++)r.push(h(o[s]));return{coords:n,times:r}}function T(t){var e,n,r,i,o,s=[],c=[];if(u(t,"MultiGeometry"))return T(u(t,"MultiGeometry"));if(u(t,"MultiTrack"))return T(u(t,"MultiTrack"));if(u(t,"gx:MultiTrack"))return T(u(t,"gx:MultiTrack"));for(r=0;r<l.length;r++)if(n=a(t,l[r]))for(i=0;i<n.length;i++)if(e=n[i],"Point"===l[r])s.push({type:"Point",coordinates:d(h(u(e,"coordinates")))});else if("LineString"===l[r])s.push({type:"LineString",coordinates:m(h(u(e,"coordinates")))});else if("Polygon"===l[r]){var f=a(e,"LinearRing"),p=[];for(o=0;o<f.length;o++)p.push(m(h(u(f[o],"coordinates"))));s.push({type:"Polygon",coordinates:p})}else if("Track"===l[r]||"gx:Track"===l[r]){var g=I(e);s.push({type:"LineString",coordinates:g.coords}),g.times.length&&c.push(g.times)}return{geoms:s,coordTimes:c}}function P(t){var e,o=T(t),l={},c=h(u(t,"name")),f=h(u(t,"address")),p=h(u(t,"styleUrl")),d=h(u(t,"description")),m=u(t,"TimeSpan"),g=u(t,"TimeStamp"),v=u(t,"ExtendedData"),y=u(t,"LineStyle"),_=u(t,"PolyStyle"),x=u(t,"visibility");if(!o.geoms.length)return[];if(c&&(l.name=c),f&&(l.address=f),p){"#"!==p[0]&&(p="#"+p),l.styleUrl=p,n[p]&&(l.styleHash=n[p]),i[p]&&(l.styleMapHash=i[p],l.styleHash=n[i[p].normal]);var b=r[l.styleHash];if(b){y||(y=u(b,"LineStyle")),_||(_=u(b,"PolyStyle"));var w=u(b,"IconStyle");if(w){var S=u(w,"Icon");if(S){var E=h(u(S,"href"));E&&(l.icon=E)}}}}if(d&&(l.description=d),m){var C=h(u(m,"begin")),I=h(u(m,"end"));l.timespan={begin:C,end:I}}if(g&&(l.timestamp=h(u(g,"when"))),y){var P=k(h(u(y,"color"))),A=P[0],M=P[1],L=parseFloat(h(u(y,"width")));A&&(l.stroke=A),isNaN(M)||(l["stroke-opacity"]=M),isNaN(L)||(l["stroke-width"]=L)}if(_){var R=k(h(u(_,"color"))),D=R[0],N=R[1],z=h(u(_,"fill")),O=h(u(_,"outline"));D&&(l.fill=D),isNaN(N)||(l["fill-opacity"]=N),z&&(l["fill-opacity"]="1"===z?l["fill-opacity"]||1:0),O&&(l["stroke-opacity"]="1"===O?l["stroke-opacity"]||1:0)}if(v){var F=a(v,"Data"),B=a(v,"SimpleData");for(e=0;e<F.length;e++)l[F[e].getAttribute("name")]=h(u(F[e],"value"));for(e=0;e<B.length;e++)l[B[e].getAttribute("name")]=h(B[e])}x&&(l.visibility=h(x)),o.coordTimes.length&&(l.coordTimes=1===o.coordTimes.length?o.coordTimes[0]:o.coordTimes);var j={type:"Feature",geometry:1===o.geoms.length?o.geoms[0]:{type:"GeometryCollection",geometries:o.geoms},properties:l};return s(t,"id")&&(j.id=s(t,"id")),[j]}return e},gpx:function(t){var e,n,r=a(t,"trk"),i=a(t,"rte"),o=a(t,"wpt"),l={type:"FeatureCollection",features:[]};for(e=0;e<r.length;e++)(n=m(r[e]))&&l.features.push(n);for(e=0;e<i.length;e++)(n=v(i[e]))&&l.features.push(n);for(e=0;e<o.length;e++)l.features.push(y(o[e]));function c(t,e){for(var n=0;n<e;n++)t.push(null);return t}function d(t,e){var n=a(t,e),r=[],i=[],o=[],s=n.length;if(s<2)return{};for(var l=0;l<s;l++){var u=g(n[l]);r.push(u.coordinates),u.time&&i.push(u.time),(u.heartRate||o.length)&&(o.length||c(o,l),o.push(u.heartRate||null))}return{line:r,times:i,heartRates:o}}function m(t){for(var e,n=a(t,"trkseg"),r=[],i=[],o=[],s=0;s<n.length;s++)if((e=d(n[s],"trkpt"))&&(e.line&&r.push(e.line),e.times&&e.times.length&&i.push(e.times),o.length||e.heartRates&&e.heartRates.length)){if(!o.length)for(var l=0;l<s;l++)o.push(c([],r[l].length));e.heartRates&&e.heartRates.length?o.push(e.heartRates):o.push(c([],e.line.length||0))}if(0!==r.length){var h=x(t);return p(h,_(u(t,"extensions"))),i.length&&(h.coordTimes=1===r.length?i[0]:i),o.length&&(h.heartRates=1===r.length?o[0]:o),{type:"Feature",properties:h,geometry:{type:1===r.length?"LineString":"MultiLineString",coordinates:1===r.length?r[0]:r}}}}function v(t){var e=d(t,"rtept");if(e.line){var n=x(t);return p(n,_(u(t,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:e.line}}}}function y(t){var e=x(t);return p(e,f(t,["sym"])),{type:"Feature",properties:e,geometry:{type:"Point",coordinates:g(t).coordinates}}}function _(t){var e={};if(t){var n=u(t,"line");if(n){var r=h(u(n,"color")),i=parseFloat(h(u(n,"opacity"))),o=parseFloat(h(u(n,"width")));r&&(e.stroke=r),isNaN(i)||(e["stroke-opacity"]=i),isNaN(o)||(e["stroke-width"]=96*o/25.4)}}return e}function x(t){var e=f(t,["name","cmt","desc","type","time","keywords"]),n=a(t,"link");n.length&&(e.links=[]);for(var r,i=0;i<n.length;i++)p(r={href:s(n[i],"href")},f(n[i],["text","type"])),e.links.push(r);return e}return l}};return x}(),SM=function(e){var n=(0,t.useState)(),r=n[0],i=n[1],o=(0,t.useState)([]),a=o[0],s=o[1];return(0,t.useEffect)((function(){e.data&&function(t){try{s([]);var e=(new DOMParser).parseFromString(t,"application/xml"),n=e.querySelector("metadata");null===n||void 0===n||n.childNodes.forEach((function(t){var e=t.textContent,n=t.nodeName;if("link"===t.nodeName&&(e=t.getAttribute("href")),null===e||void 0===e?void 0:e.trim().length){var r={title:n,value:e,id:(new Date).getTime()};s((function(t){return bE(bE([],t,!0),[r],!1)}))}}));var r=wM.gpx(e);i(r)}catch(o){console.log(o)}}(e.data)}),[e.data]),{geojson:r,metadata:a}};SM.defaultProps={data:void 0};var EM=function(e){var n=TE({mapId:e.mapId,waitForLayer:e.layerId}),r=(0,t.useRef)(new _.Popup({closeButton:!1,closeOnClick:!0}));return(0,t.useEffect)((function(){n.map&&e.layerId&&n.map.on("mouseenter",e.layerId,(function(t){var i,o;if(n.map){var a=null===(i=null===t||void 0===t?void 0:t.features)||void 0===i?void 0:i[0].geometry.coordinates.slice(),s="";if((null===(o=null===t||void 0===t?void 0:t.features)||void 0===o?void 0:o[0])&&"function"===typeof e.getPopupContent&&(s=e.getPopupContent(t.features[0])),null===a||void 0===a?void 0:a[0]){for(;Math.abs(t.lngLat.lng-a[0])>180;)a[0]+=t.lngLat.lng>a[0]?360:-360;r.current.setLngLat(a).setHTML(s).addTo(n.map.map)}}}),n.componentId)}),[n.map]),t.createElement(t.Fragment,null)};EM.defaultProps={mapId:void 0};t.createContext({}).Provider;y().string,y().string,y().object,y().object,y().string;(function(e){var n=(0,t.useRef)(!1),r=(0,t.useRef)(e.pause),i=(0,t.useRef)(e.zoom),o=(0,t.useRef)(e.pitch),a=(0,t.useRef)(1),s=(0,t.useRef)(e.speed),l=(0,t.useRef)(),u=e.kmPerStep||.01,c=qc(e.route),h=e.stepDuration||70,f=TE({mapId:e.mapId,waitForLayer:e.insertBeforeLayer});(0,t.useEffect)((function(){r.current=e.pause,r.current||g()}),[e.pause]),(0,t.useEffect)((function(){f.map&&(i.current=e.zoom,"undefined"!==typeof i.current&&f.map.map.getZoom()!==i.current&&f.map.map.setZoom(i.current))}),[f.map,e.zoom]),(0,t.useEffect)((function(){f.map&&(o.current=e.pitch,"undefined"!==typeof o.current&&o.current!==f.map.map.getPitch()&&f.map.map.setPitch(o.current))}),[f.map,e.pitch]),(0,t.useEffect)((function(){s.current=e.speed}),[e.speed]);var p=(0,t.useCallback)((function(){f.map&&(f.map.map.scrollZoom.disable(),f.map.map.boxZoom.disable(),f.map.map.dragRotate.disable(),f.map.map.dragPan.disable(),f.map.map.keyboard.disable(),f.map.map.doubleClickZoom.disable(),f.map.map.touchZoomRotate.disable())}),[f.map]),d=(0,t.useCallback)((function(){f.map&&(f.map.map.scrollZoom.enable(),f.map.map.boxZoom.enable(),f.map.map.dragRotate.enable(),f.map.map.dragPan.enable(),f.map.map.keyboard.enable(),f.map.map.doubleClickZoom.enable(),f.map.map.touchZoomRotate.enable())}),[f.map]);function m(){if(f.map&&e.route){var t,n=Rc(e.route);n&&n.length>3&&(t=[[n[0],n[1]],[n[2],n[3]]],f.map.map.fitBounds(t,{padding:100}))}}function g(){if(f.map)if(r.current)d();else{p(),"undefined"!==typeof i.current&&f.map.map.getZoom()!==i.current&&f.map.map.setZoom(i.current);var t=function(t,e,n){void 0===n&&(n={});for(var r=Nc(t).coordinates,i=0,o=0;o<r.length&&!(e>=i&&o===r.length-1);o++){if(i>=e){var a=e-i;if(a){var s=Zc(r[o],r[o-1])-180;return Uc(r[o],a,s,n)}return _c(r[o])}i+=Fc(r[o],r[o+1],n)}return _c(r[r.length-1])}(e.route,a.current*u).geometry.coordinates;a.current*u<c?(f.map.map.easeTo({center:t,bearing:Zc(_c([f.map.map.getCenter().lng,f.map.map.getCenter().lat]),_c(t)),duration:h,essential:!0}),"undefined"!==typeof s.current?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout((function(){g()}),100)):(f.map.map.setPitch(0),m(),d(),console.log("ENABLE CONTROLS"),a.current=1)}}return(0,t.useEffect)((function(){f.map&&!n.current&&(n.current=!0,m())}),[f.map]),(0,t.useEffect)((function(){return function(){l.current&&clearTimeout(l.current)}}),[]),{play:g,reset:function(){f.map&&(m(),d(),a.current=1)}}}).defaultProps={mapId:void 0,zoom:18};var kM=t.createContext({}).Provider;function CM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function IM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?CM(Object(n),!0).forEach((function(e){(0,s.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CM(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}(function(e){var n=_M((0,t.useState)(null),2),r=n[0],i=n[1];(0,t.useEffect)((function(){if(e.url){var t=null;"json"===e.format?t=function(t,e){return fetch(t,e).then(lE)}(e.url):"csv"===e.format?t=sE(e.url):"xml"===e.format&&(t=cE(e.url)),t&&t.then((function(t){if("xml"===e.format){if(e.nodeType){var n=[];t.querySelectorAll(e.nodeType).forEach((function(t){n.push(e.formatData(t))})),i(n)}}else e.data_property&&(t=t[e.data_property]),"function"===typeof e.formatData?i(t.map(e.formatData)):i(t);"function"===typeof e.onData&&e.onData()}))}}),[e.url,e]);var o={data:r,setData:i};return t.createElement(kM,{value:o},e.children)}).propTypes={children:y().node.isRequired};var TM=n(9120),PM=n(3073);function AM(e,n,r,i,o){var a="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,s=t.useState((function(){return o&&a?r(e).matches:i?i(e).matches:n})),u=(0,l.Z)(s,2),c=u[0],h=u[1];return(0,xd.Z)((function(){var t=!0;if(a){var n=r(e),i=function(){t&&h(n.matches)};return i(),n.addListener(i),function(){t=!1,n.removeListener(i)}}}),[e,r,a]),c}var MM=e.useSyncExternalStore;function LM(e,n,r,i){var o=t.useCallback((function(){return n}),[n]),a=t.useMemo((function(){if(null!==i){var t=i(e).matches;return function(){return t}}return o}),[o,e,i]),s=t.useMemo((function(){if(null===r)return[o,function(){return function(){}}];var t=r(e);return[function(){return t.matches},function(e){return t.addListener(e),function(){t.removeListener(e)}}]}),[o,r,e]),u=(0,l.Z)(s,2),c=u[0],h=u[1];return MM(h,c,a)}function RM(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,TM.Z)(),r="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,i=(0,PM.Z)({name:"MuiUseMediaQuery",props:e,theme:n}),o=i.defaultMatches,a=void 0!==o&&o,s=i.matchMedia,l=void 0===s?r?window.matchMedia:null:s,u=i.ssrMatchMedia,c=void 0===u?null:u,h=i.noSsr;var f="function"===typeof t?t(n):t;f=f.replace(/^@media( ?)/m,"");var p=void 0!==MM?LM:AM,d=p(f,a,l,c,h);return d}var DM=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function NM(t,e,n){var r,i=function(t,e,n){var r,i=e.getBoundingClientRect(),o=n&&n.getBoundingClientRect(),a=(0,zd.Z)(e);if(e.fakeTransform)r=e.fakeTransform;else{var s=a.getComputedStyle(e);r=s.getPropertyValue("-webkit-transform")||s.getPropertyValue("transform")}var l=0,u=0;if(r&&"none"!==r&&"string"===typeof r){var c=r.split("(")[1].split(")")[0].split(",");l=parseInt(c[4],10),u=parseInt(c[5],10)}return"left"===t?"translateX(".concat(o?o.right+l-i.left:a.innerWidth+l-i.left,"px)"):"right"===t?"translateX(-".concat(o?i.right-o.left-l:i.left+i.width-l,"px)"):"up"===t?"translateY(".concat(o?o.bottom+u-i.top:a.innerHeight+u-i.top,"px)"):"translateY(-".concat(o?i.top-o.top+i.height-u:i.top+i.height-u,"px)")}(t,e,"function"===typeof(r=n)?r():r);i&&(e.style.webkitTransform=i,e.style.transform=i)}var zM=t.forwardRef((function(e,n){var r=Jd(),i={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},a=e.addEndListener,s=e.appear,l=void 0===s||s,u=e.children,c=e.container,h=e.direction,f=void 0===h?"down":h,p=e.easing,d=void 0===p?i:p,m=e.in,g=e.onEnter,v=e.onEntered,y=e.onEntering,_=e.onExit,x=e.onExited,b=e.onExiting,w=e.style,S=e.timeout,E=void 0===S?o:S,k=e.TransitionComponent,C=void 0===k?Yd:k,I=(0,Pp.Z)(e,DM),T=t.useRef(null),P=(0,_d.Z)(u.ref,T,n),A=function(t){return function(e){t&&(void 0===e?t(T.current):t(T.current,e))}},M=A((function(t,e){NM(f,t,c),Qd(t),g&&g(t,e)})),L=A((function(t,e){var n=tm({timeout:E,style:w,easing:d},{mode:"enter"});t.style.webkitTransition=r.transitions.create("-webkit-transform",(0,Ap.Z)({},n)),t.style.transition=r.transitions.create("transform",(0,Ap.Z)({},n)),t.style.webkitTransform="none",t.style.transform="none",y&&y(t,e)})),R=A(v),D=A(b),N=A((function(t){var e=tm({timeout:E,style:w,easing:d},{mode:"exit"});t.style.webkitTransition=r.transitions.create("-webkit-transform",e),t.style.transition=r.transitions.create("transform",e),NM(f,t,c),_&&_(t)})),z=A((function(t){t.style.webkitTransition="",t.style.transition="",x&&x(t)})),O=t.useCallback((function(){T.current&&NM(f,T.current,c)}),[f,c]);return t.useEffect((function(){if(!m&&"down"!==f&&"right"!==f){var t=(0,Nd.Z)((function(){T.current&&NM(f,T.current,c)})),e=(0,zd.Z)(T.current);return e.addEventListener("resize",t),function(){t.clear(),e.removeEventListener("resize",t)}}}),[f,m,c]),t.useEffect((function(){m||O()}),[m,O]),(0,Zp.jsx)(C,(0,Ap.Z)({nodeRef:T,onEnter:M,onEntered:R,onEntering:L,onExit:N,onExited:z,onExiting:D,addEndListener:function(t){a&&a(T.current,t)},appear:l,in:m,timeout:E},I,{children:function(e,n){return t.cloneElement(u,(0,Ap.Z)({ref:P,style:(0,Ap.Z)({visibility:"exited"!==e||m?void 0:"hidden"},w,u.props.style)},n))}}))})),OM=zM;function FM(t){return(0,Up.Z)("MuiDrawer",t)}(0,jp.Z)("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);var BM=["BackdropProps"],jM=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],UM=function(t,e){var n=t.ownerState;return[e.root,("permanent"===n.variant||"persistent"===n.variant)&&e.docked,e.modal]},VM=(0,Dp.ZP)(tg,{name:"MuiDrawer",slot:"Root",overridesResolver:UM})((function(t){var e=t.theme;return{zIndex:(e.vars||e).zIndex.drawer}})),ZM=(0,Dp.ZP)("div",{shouldForwardProp:Dp.FO,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:UM})({flex:"0 0 auto"}),qM=(0,Dp.ZP)(Dd,{name:"MuiDrawer",slot:"Paper",overridesResolver:function(t,e){var n=t.ownerState;return[e.paper,e["paperAnchor".concat((0,Op.Z)(n.anchor))],"temporary"!==n.variant&&e["paperAnchorDocked".concat((0,Op.Z)(n.anchor))]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},"left"===n.anchor&&{left:0},"top"===n.anchor&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},"right"===n.anchor&&{right:0},"bottom"===n.anchor&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},"left"===n.anchor&&"temporary"!==n.variant&&{borderRight:"1px solid ".concat((e.vars||e).palette.divider)},"top"===n.anchor&&"temporary"!==n.variant&&{borderBottom:"1px solid ".concat((e.vars||e).palette.divider)},"right"===n.anchor&&"temporary"!==n.variant&&{borderLeft:"1px solid ".concat((e.vars||e).palette.divider)},"bottom"===n.anchor&&"temporary"!==n.variant&&{borderTop:"1px solid ".concat((e.vars||e).palette.divider)})})),GM={left:"right",right:"left",top:"down",bottom:"up"};var WM=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiDrawer"}),i=Jd(),o={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},a=r.anchor,s=void 0===a?"left":a,l=r.BackdropProps,u=r.children,c=r.className,h=r.elevation,f=void 0===h?16:h,p=r.hideBackdrop,d=void 0!==p&&p,m=r.ModalProps,g=(m=void 0===m?{}:m).BackdropProps,v=r.onClose,y=r.open,_=void 0!==y&&y,x=r.PaperProps,b=void 0===x?{}:x,w=r.SlideProps,S=r.TransitionComponent,E=void 0===S?OM:S,k=r.transitionDuration,C=void 0===k?o:k,I=r.variant,T=void 0===I?"temporary":I,P=(0,Pp.Z)(r.ModalProps,BM),A=(0,Pp.Z)(r,jM),M=t.useRef(!1);t.useEffect((function(){M.current=!0}),[]);var L=function(t,e){return"rtl"===t.direction&&function(t){return-1!==["left","right"].indexOf(t)}(e)?GM[e]:e}(i,s),R=s,D=(0,Ap.Z)({},r,{anchor:R,elevation:f,open:_,variant:T},A),N=function(t){var e=t.classes,n=t.anchor,r=t.variant,i={root:["root"],docked:[("permanent"===r||"persistent"===r)&&"docked"],modal:["modal"],paper:["paper","paperAnchor".concat((0,Op.Z)(n)),"temporary"!==r&&"paperAnchorDocked".concat((0,Op.Z)(n))]};return(0,Lp.Z)(i,FM,e)}(D),z=(0,Zp.jsx)(qM,(0,Ap.Z)({elevation:"temporary"===T?f:0,square:!0},b,{className:(0,Mp.Z)(N.paper,b.className),ownerState:D,children:u}));if("permanent"===T)return(0,Zp.jsx)(ZM,(0,Ap.Z)({className:(0,Mp.Z)(N.root,N.docked,c),ownerState:D,ref:n},A,{children:z}));var O=(0,Zp.jsx)(E,(0,Ap.Z)({in:_,direction:GM[L],timeout:C,appear:M.current},w,{children:z}));return"persistent"===T?(0,Zp.jsx)(ZM,(0,Ap.Z)({className:(0,Mp.Z)(N.root,N.docked,c),ownerState:D,ref:n},A,{children:O})):(0,Zp.jsx)(VM,(0,Ap.Z)({BackdropProps:(0,Ap.Z)({},l,g,{transitionDuration:C}),className:(0,Mp.Z)(N.root,N.modal,c),open:_,ownerState:D,onClose:v,hideBackdrop:d,ref:n},A,P,{children:O}))})),XM=WM,HM=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],YM=(0,Dp.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.absolute&&e.absolute,e[n.variant],n.light&&e.light,"vertical"===n.orientation&&e.vertical,n.flexItem&&e.flexItem,n.children&&e.withChildren,n.children&&"vertical"===n.orientation&&e.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&e.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&e.textAlignLeft]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},n.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},n.light&&{borderColor:e.vars?"rgba(".concat(e.vars.palette.dividerChannel," / 0.08)"):(0,Td.Fq)(e.palette.divider,.08)},"inset"===n.variant&&{marginLeft:72},"middle"===n.variant&&"horizontal"===n.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===n.variant&&"vertical"===n.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===n.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},n.flexItem&&{alignSelf:"stretch",height:"auto"})}),(function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({},n.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:"thin solid ".concat((e.vars||e).palette.divider),top:"50%",content:'""',transform:"translateY(50%)"}})}),(function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({},n.children&&"vertical"===n.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:"thin solid ".concat((e.vars||e).palette.divider),transform:"translateX(0%)"}})}),(function(t){var e=t.ownerState;return(0,Ap.Z)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})})),$M=(0,Dp.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:function(t,e){var n=t.ownerState;return[e.wrapper,"vertical"===n.orientation&&e.wrapperVertical]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({display:"inline-block",paddingLeft:"calc(".concat(e.spacing(1)," * 1.2)"),paddingRight:"calc(".concat(e.spacing(1)," * 1.2)")},"vertical"===n.orientation&&{paddingTop:"calc(".concat(e.spacing(1)," * 1.2)"),paddingBottom:"calc(".concat(e.spacing(1)," * 1.2)")})})),KM=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiDivider"}),r=n.absolute,i=void 0!==r&&r,o=n.children,a=n.className,s=n.component,l=void 0===s?o?"div":"hr":s,u=n.flexItem,c=void 0!==u&&u,h=n.light,f=void 0!==h&&h,p=n.orientation,d=void 0===p?"horizontal":p,m=n.role,g=void 0===m?"hr"!==l?"separator":void 0:m,v=n.textAlign,y=void 0===v?"center":v,_=n.variant,x=void 0===_?"fullWidth":_,b=(0,Pp.Z)(n,HM),w=(0,Ap.Z)({},n,{absolute:i,component:l,flexItem:c,light:f,orientation:d,role:g,textAlign:y,variant:x}),S=function(t){var e=t.absolute,n=t.children,r=t.classes,i=t.flexItem,o=t.light,a=t.orientation,s=t.textAlign,l={root:["root",e&&"absolute",t.variant,o&&"light","vertical"===a&&"vertical",i&&"flexItem",n&&"withChildren",n&&"vertical"===a&&"withChildrenVertical","right"===s&&"vertical"!==a&&"textAlignRight","left"===s&&"vertical"!==a&&"textAlignLeft"],wrapper:["wrapper","vertical"===a&&"wrapperVertical"]};return(0,Lp.Z)(l,Cy,r)}(w);return(0,Zp.jsx)(YM,(0,Ap.Z)({as:l,className:(0,Mp.Z)(S.root,a),role:g,ref:e,ownerState:w},b,{children:o?(0,Zp.jsx)($M,{className:S.wrapper,ownerState:w,children:o}):null}))})),JM=KM;function QM(t){return(0,Up.Z)("MuiIconButton",t)}var tL=(0,jp.Z)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),eL=["edge","children","className","color","disabled","disableFocusRipple","size"],nL=(0,Dp.ZP)(ky,{name:"MuiIconButton",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,"default"!==n.color&&e["color".concat((0,Op.Z)(n.color))],n.edge&&e["edge".concat((0,Op.Z)(n.edge))],e["size".concat((0,Op.Z)(n.size))]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:e.vars?"rgba(".concat(e.vars.palette.action.activeChannel," / ").concat(e.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===n.edge&&{marginLeft:"small"===n.size?-3:-12},"end"===n.edge&&{marginRight:"small"===n.size?-3:-12})}),(function(t){var e,n=t.theme,r=t.ownerState,i=null==(e=(n.vars||n).palette)?void 0:e[r.color];return(0,Ap.Z)({},"inherit"===r.color&&{color:"inherit"},"inherit"!==r.color&&"default"!==r.color&&(0,Ap.Z)({color:null==i?void 0:i.main},!r.disableRipple&&{"&:hover":(0,Ap.Z)({},i&&{backgroundColor:n.vars?"rgba(".concat(i.mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,Td.Fq)(i.main,n.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===r.size&&{padding:5,fontSize:n.typography.pxToRem(18)},"large"===r.size&&{padding:12,fontSize:n.typography.pxToRem(28)},(0,s.Z)({},"&.".concat(tL.disabled),{backgroundColor:"transparent",color:(n.vars||n).palette.action.disabled}))})),rL=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiIconButton"}),r=n.edge,i=void 0!==r&&r,o=n.children,a=n.className,s=n.color,l=void 0===s?"default":s,u=n.disabled,c=void 0!==u&&u,h=n.disableFocusRipple,f=void 0!==h&&h,p=n.size,d=void 0===p?"medium":p,m=(0,Pp.Z)(n,eL),g=(0,Ap.Z)({},n,{edge:i,color:l,disabled:c,disableFocusRipple:f,size:d}),v=function(t){var e=t.classes,n=t.disabled,r=t.color,i=t.edge,o=t.size,a={root:["root",n&&"disabled","default"!==r&&"color".concat((0,Op.Z)(r)),i&&"edge".concat((0,Op.Z)(i)),"size".concat((0,Op.Z)(o))]};return(0,Lp.Z)(a,QM,e)}(g);return(0,Zp.jsx)(nL,(0,Ap.Z)({className:(0,Mp.Z)(v.root,a),centerRipple:!0,focusRipple:!f,disabled:c,ref:e,ownerState:g},m,{children:o}))})),iL=rL,oL=n(9823);function aL(t){return(0,Up.Z)("MuiListItemButton",t)}var sL=(0,jp.Z)("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),lL=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],uL=(0,Dp.ZP)(ky,{shouldForwardProp:function(t){return(0,Dp.FO)(t)||"classes"===t},name:"MuiListItemButton",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.dense&&e.dense,"flex-start"===n.alignItems&&e.alignItemsFlexStart,n.divider&&e.divider,!n.disableGutters&&e.gutters]}})((function(t){var e,n=t.theme,r=t.ownerState;return(0,Ap.Z)((e={display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},(0,s.Z)(e,"&.".concat(sL.selected),(0,s.Z)({backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)},"&.".concat(sL.focusVisible),{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.focusOpacity,"))"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)})),(0,s.Z)(e,"&.".concat(sL.selected,":hover"),{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.hoverOpacity,"))"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Td.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)}}),(0,s.Z)(e,"&.".concat(sL.focusVisible),{backgroundColor:(n.vars||n).palette.action.focus}),(0,s.Z)(e,"&.".concat(sL.disabled),{opacity:(n.vars||n).palette.action.disabledOpacity}),e),r.divider&&{borderBottom:"1px solid ".concat((n.vars||n).palette.divider),backgroundClip:"padding-box"},"flex-start"===r.alignItems&&{alignItems:"flex-start"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.dense&&{paddingTop:4,paddingBottom:4})})),cL=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiListItemButton"}),i=r.alignItems,o=void 0===i?"center":i,a=r.autoFocus,s=void 0!==a&&a,l=r.component,u=void 0===l?"div":l,c=r.children,h=r.dense,f=void 0!==h&&h,p=r.disableGutters,d=void 0!==p&&p,m=r.divider,g=void 0!==m&&m,v=r.focusVisibleClassName,y=r.selected,_=void 0!==y&&y,x=r.className,b=(0,Pp.Z)(r,lL),w=t.useContext(hd),S=t.useMemo((function(){return{dense:f||w.dense||!1,alignItems:o,disableGutters:d}}),[o,w.dense,f,d]),E=t.useRef(null);(0,xd.Z)((function(){s&&E.current&&E.current.focus()}),[s]);var k=(0,Ap.Z)({},r,{alignItems:o,dense:S.dense,disableGutters:d,divider:g,selected:_}),C=function(t){var e=t.alignItems,n=t.classes,r=t.dense,i=t.disabled,o={root:["root",r&&"dense",!t.disableGutters&&"gutters",t.divider&&"divider",i&&"disabled","flex-start"===e&&"alignItemsFlexStart",t.selected&&"selected"]},a=(0,Lp.Z)(o,aL,n);return(0,Ap.Z)({},n,a)}(k),I=(0,_d.Z)(E,n);return(0,Zp.jsx)(hd.Provider,{value:S,children:(0,Zp.jsx)(uL,(0,Ap.Z)({ref:I,href:b.href||b.to,component:(b.href||b.to)&&"div"===u?"a":u,focusVisibleClassName:(0,Mp.Z)(C.focusVisible,v),ownerState:k,className:(0,Mp.Z)(C.root,x)},b,{classes:C,children:c}))})})),hL=cL,fL=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],pL=(0,Dp.ZP)("div",{name:"MuiListItemText",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"& .".concat(Ay.primary),e.primary),(0,s.Z)({},"& .".concat(Ay.secondary),e.secondary),e.root,n.inset&&e.inset,n.primary&&n.secondary&&e.multiline,n.dense&&e.dense]}})((function(t){var e=t.ownerState;return(0,Ap.Z)({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})})),dL=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiListItemText"}),i=r.children,o=r.className,a=r.disableTypography,s=void 0!==a&&a,l=r.inset,u=void 0!==l&&l,c=r.primary,h=r.primaryTypographyProps,f=r.secondary,p=r.secondaryTypographyProps,d=(0,Pp.Z)(r,fL),m=t.useContext(hd).dense,g=null!=c?c:i,v=f,y=(0,Ap.Z)({},r,{disableTypography:s,inset:u,primary:!!g,secondary:!!v,dense:m}),_=function(t){var e=t.classes,n=t.inset,r=t.primary,i=t.secondary,o={root:["root",n&&"inset",t.dense&&"dense",r&&i&&"multiline"],primary:["primary"],secondary:["secondary"]};return(0,Lp.Z)(o,Py,e)}(y);return null==g||g.type===Zy||s||(g=(0,Zp.jsx)(Zy,(0,Ap.Z)({variant:m?"body2":"body1",className:_.primary,component:null!=h&&h.variant?void 0:"span",display:"block"},h,{children:g}))),null==v||v.type===Zy||s||(v=(0,Zp.jsx)(Zy,(0,Ap.Z)({variant:"body2",className:_.secondary,color:"text.secondary",display:"block"},p,{children:v}))),(0,Zp.jsxs)(pL,(0,Ap.Z)({className:(0,Mp.Z)(_.root,o),ownerState:y,ref:n},d,{children:[g,v]}))})),mL=dL,gL=n(1314);function vL(t){return(0,Up.Z)("MuiCollapse",t)}(0,jp.Z)("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);var yL=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],_L=(0,Dp.ZP)("div",{name:"MuiCollapse",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.orientation],"entered"===n.state&&e.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&e.hidden]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({height:0,overflow:"hidden",transition:e.transitions.create("height")},"horizontal"===n.orientation&&{height:"auto",width:0,transition:e.transitions.create("width")},"entered"===n.state&&(0,Ap.Z)({height:"auto",overflow:"visible"},"horizontal"===n.orientation&&{width:"auto"}),"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&{visibility:"hidden"})})),xL=(0,Dp.ZP)("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:function(t,e){return e.wrapper}})((function(t){var e=t.ownerState;return(0,Ap.Z)({display:"flex",width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"})})),bL=(0,Dp.ZP)("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:function(t,e){return e.wrapperInner}})((function(t){var e=t.ownerState;return(0,Ap.Z)({width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"})})),wL=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiCollapse"}),i=r.addEndListener,o=r.children,a=r.className,l=r.collapsedSize,u=void 0===l?"0px":l,c=r.component,h=r.easing,f=r.in,p=r.onEnter,d=r.onEntered,m=r.onEntering,g=r.onExit,v=r.onExited,y=r.onExiting,_=r.orientation,x=void 0===_?"vertical":_,b=r.style,w=r.timeout,S=void 0===w?gL.x9.standard:w,E=r.TransitionComponent,k=void 0===E?Yd:E,C=(0,Pp.Z)(r,yL),I=(0,Ap.Z)({},r,{orientation:x,collapsedSize:u}),T=function(t){var e=t.orientation,n=t.classes,r={root:["root","".concat(e)],entered:["entered"],hidden:["hidden"],wrapper:["wrapper","".concat(e)],wrapperInner:["wrapperInner","".concat(e)]};return(0,Lp.Z)(r,vL,n)}(I),P=Jd(),A=t.useRef(),M=t.useRef(null),L=t.useRef(),R="number"===typeof u?"".concat(u,"px"):u,D="horizontal"===x,N=D?"width":"height";t.useEffect((function(){return function(){clearTimeout(A.current)}}),[]);var z=t.useRef(null),O=(0,_d.Z)(n,z),F=function(t){return function(e){if(t){var n=z.current;void 0===e?t(n):t(n,e)}}},B=function(){return M.current?M.current[D?"clientWidth":"clientHeight"]:0},j=F((function(t,e){M.current&&D&&(M.current.style.position="absolute"),t.style[N]=R,p&&p(t,e)})),U=F((function(t,e){var n=B();M.current&&D&&(M.current.style.position="");var r=tm({style:b,timeout:S,easing:h},{mode:"enter"}),i=r.duration,o=r.easing;if("auto"===S){var a=P.transitions.getAutoHeightDuration(n);t.style.transitionDuration="".concat(a,"ms"),L.current=a}else t.style.transitionDuration="string"===typeof i?i:"".concat(i,"ms");t.style[N]="".concat(n,"px"),t.style.transitionTimingFunction=o,m&&m(t,e)})),V=F((function(t,e){t.style[N]="auto",d&&d(t,e)})),Z=F((function(t){t.style[N]="".concat(B(),"px"),g&&g(t)})),q=F(v),G=F((function(t){var e=B(),n=tm({style:b,timeout:S,easing:h},{mode:"exit"}),r=n.duration,i=n.easing;if("auto"===S){var o=P.transitions.getAutoHeightDuration(e);t.style.transitionDuration="".concat(o,"ms"),L.current=o}else t.style.transitionDuration="string"===typeof r?r:"".concat(r,"ms");t.style[N]=R,t.style.transitionTimingFunction=i,y&&y(t)}));return(0,Zp.jsx)(k,(0,Ap.Z)({in:f,onEnter:j,onEntered:V,onEntering:U,onExit:Z,onExited:q,onExiting:G,addEndListener:function(t){"auto"===S&&(A.current=setTimeout(t,L.current||0)),i&&i(z.current,t)},nodeRef:z,timeout:"auto"===S?null:S},C,{children:function(t,e){return(0,Zp.jsx)(_L,(0,Ap.Z)({as:c,className:(0,Mp.Z)(T.root,a,{entered:T.entered,exited:!f&&"0px"===R&&T.hidden}[t]),style:(0,Ap.Z)((0,s.Z)({},D?"minWidth":"minHeight",R),b),ownerState:(0,Ap.Z)({},I,{state:t}),ref:O},e,{children:(0,Zp.jsx)(xL,{ownerState:(0,Ap.Z)({},I,{state:t}),className:T.wrapper,ref:M,children:(0,Zp.jsx)(bL,{ownerState:(0,Ap.Z)({},I,{state:t}),className:T.wrapperInner,children:o})})}))}}))}));wL.muiSupportAuto=!0;var SL=wL,EL=n(1184);var kL=t.createContext();function CL(t){return(0,Up.Z)("MuiGrid",t)}var IL=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],TL=(0,jp.Z)("MuiGrid",["root","container","item","zeroMinWidth"].concat((0,a.Z)([0,1,2,3,4,5,6,7,8,9,10].map((function(t){return"spacing-xs-".concat(t)}))),(0,a.Z)(["column-reverse","column","row-reverse","row"].map((function(t){return"direction-xs-".concat(t)}))),(0,a.Z)(["nowrap","wrap-reverse","wrap"].map((function(t){return"wrap-xs-".concat(t)}))),(0,a.Z)(IL.map((function(t){return"grid-xs-".concat(t)}))),(0,a.Z)(IL.map((function(t){return"grid-sm-".concat(t)}))),(0,a.Z)(IL.map((function(t){return"grid-md-".concat(t)}))),(0,a.Z)(IL.map((function(t){return"grid-lg-".concat(t)}))),(0,a.Z)(IL.map((function(t){return"grid-xl-".concat(t)}))))),PL=TL,AL=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function ML(t){var e=parseFloat(t);return"".concat(e).concat(String(t).replace(String(e),"")||"px")}function LL(t){var e=t.breakpoints,n=t.values,r="";Object.keys(n).forEach((function(t){""===r&&0!==n[t]&&(r=t)}));var i=Object.keys(e).sort((function(t,n){return e[t]-e[n]}));return i.slice(0,i.indexOf(r))}var RL=(0,Dp.ZP)("div",{name:"MuiGrid",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState,r=n.container,i=n.direction,o=n.item,s=n.spacing,l=n.wrap,u=n.zeroMinWidth,c=n.breakpoints,h=[];r&&(h=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||t<=0)return[];if("string"===typeof t&&!Number.isNaN(Number(t))||"number"===typeof t)return[n["spacing-xs-".concat(String(t))]];var r=[];return e.forEach((function(e){var i=t[e];Number(i)>0&&r.push(n["spacing-".concat(e,"-").concat(String(i))])})),r}(s,c,e));var f=[];return c.forEach((function(t){var r=n[t];r&&f.push(e["grid-".concat(t,"-").concat(String(r))])})),[e.root,r&&e.container,o&&e.item,u&&e.zeroMinWidth].concat((0,a.Z)(h),["row"!==i&&e["direction-xs-".concat(String(i))],"wrap"!==l&&e["wrap-xs-".concat(String(l))]],f)}})((function(t){var e=t.ownerState;return(0,Ap.Z)({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},"wrap"!==e.wrap&&{flexWrap:e.wrap})}),(function(t){var e=t.theme,n=t.ownerState,r=(0,EL.P$)({values:n.direction,breakpoints:e.breakpoints.values});return(0,EL.k9)({theme:e},r,(function(t){var e={flexDirection:t};return 0===t.indexOf("column")&&(e["& > .".concat(PL.item)]={maxWidth:"none"}),e}))}),(function(t){var e=t.theme,n=t.ownerState,r=n.container,i=n.rowSpacing,o={};if(r&&0!==i){var a,l=(0,EL.P$)({values:i,breakpoints:e.breakpoints.values});"object"===typeof l&&(a=LL({breakpoints:e.breakpoints.values,values:l})),o=(0,EL.k9)({theme:e},l,(function(t,n){var r,i=e.spacing(t);return"0px"!==i?(0,s.Z)({marginTop:"-".concat(ML(i))},"& > .".concat(PL.item),{paddingTop:ML(i)}):null!=(r=a)&&r.includes(n)?{}:(0,s.Z)({marginTop:0},"& > .".concat(PL.item),{paddingTop:0})}))}return o}),(function(t){var e=t.theme,n=t.ownerState,r=n.container,i=n.columnSpacing,o={};if(r&&0!==i){var a,l=(0,EL.P$)({values:i,breakpoints:e.breakpoints.values});"object"===typeof l&&(a=LL({breakpoints:e.breakpoints.values,values:l})),o=(0,EL.k9)({theme:e},l,(function(t,n){var r,i=e.spacing(t);return"0px"!==i?(0,s.Z)({width:"calc(100% + ".concat(ML(i),")"),marginLeft:"-".concat(ML(i))},"& > .".concat(PL.item),{paddingLeft:ML(i)}):null!=(r=a)&&r.includes(n)?{}:(0,s.Z)({width:"100%",marginLeft:0},"& > .".concat(PL.item),{paddingLeft:0})}))}return o}),(function(t){var e,n=t.theme,r=t.ownerState;return n.breakpoints.keys.reduce((function(t,i){var o={};if(r[i]&&(e=r[i]),!e)return t;if(!0===e)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===e)o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{var a=(0,EL.P$)({values:r.columns,breakpoints:n.breakpoints.values}),s="object"===typeof a?a[i]:a;if(void 0===s||null===s)return t;var l="".concat(Math.round(e/s*1e8)/1e6,"%"),u={};if(r.container&&r.item&&0!==r.columnSpacing){var c=n.spacing(r.columnSpacing);if("0px"!==c){var h="calc(".concat(l," + ").concat(ML(c),")");u={flexBasis:h,maxWidth:h}}}o=(0,Ap.Z)({flexBasis:l,flexGrow:0,maxWidth:l},u)}return 0===n.breakpoints.values[i]?Object.assign(t,o):t[n.breakpoints.up(i)]=o,t}),{})}));var DL=function(t){var e=t.classes,n=t.container,r=t.direction,i=t.item,o=t.spacing,s=t.wrap,l=t.zeroMinWidth,u=t.breakpoints,c=[];n&&(c=function(t,e){if(!t||t<=0)return[];if("string"===typeof t&&!Number.isNaN(Number(t))||"number"===typeof t)return["spacing-xs-".concat(String(t))];var n=[];return e.forEach((function(e){var r=t[e];if(Number(r)>0){var i="spacing-".concat(e,"-").concat(String(r));n.push(i)}})),n}(o,u));var h=[];u.forEach((function(e){var n=t[e];n&&h.push("grid-".concat(e,"-").concat(String(n)))}));var f={root:["root",n&&"container",i&&"item",l&&"zeroMinWidth"].concat((0,a.Z)(c),["row"!==r&&"direction-xs-".concat(String(r)),"wrap"!==s&&"wrap-xs-".concat(String(s))],h)};return(0,Lp.Z)(f,CL,e)},NL=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiGrid"}),i=Jd().breakpoints,o=zy(r),a=o.className,s=o.columns,l=o.columnSpacing,u=o.component,c=void 0===u?"div":u,h=o.container,f=void 0!==h&&h,p=o.direction,d=void 0===p?"row":p,m=o.item,g=void 0!==m&&m,v=o.rowSpacing,y=o.spacing,_=void 0===y?0:y,x=o.wrap,b=void 0===x?"wrap":x,w=o.zeroMinWidth,S=void 0!==w&&w,E=(0,Pp.Z)(o,AL),k=v||_,C=l||_,I=t.useContext(kL),T=f?s||12:I,P={},A=(0,Ap.Z)({},E);i.keys.forEach((function(t){null!=E[t]&&(P[t]=E[t],delete A[t])}));var M=(0,Ap.Z)({},o,{columns:T,container:f,direction:d,item:g,rowSpacing:k,columnSpacing:C,wrap:b,zeroMinWidth:S,spacing:_},P,{breakpoints:i.keys}),L=DL(M);return(0,Zp.jsx)(kL.Provider,{value:T,children:(0,Zp.jsx)(RL,(0,Ap.Z)({ownerState:M,className:(0,Mp.Z)(L.root,a),as:c,ref:n},A))})})),zL=NL,OL=n(2885),FL=n(1131);function BL(e){var n,r,i,o,a,s,u,c=RM("(max-width:900px)"),h=(0,t.useState)(!0),f=(0,l.Z)(h,2),p=f[0],d=f[1],m=(0,t.useState)(!0),g=(0,l.Z)(m,2),v=g[0],y=g[1];return(0,Zp.jsxs)(gd,{sx:{width:"100%",maxWidth:360,backgroundColor:"#353535",color:"white"},component:"nav","aria-labelledby":"nested-list-subheader",children:[(0,Zp.jsxs)(hL,{onClick:function(){y(!v)},children:[(0,Zp.jsx)(mL,{primary:"Info"}),v?(0,Zp.jsx)(OL.Z,{}):(0,Zp.jsx)(FL.Z,{})]}),(0,Zp.jsx)(SL,{in:v,timeout:"auto",unmountOnExit:!0,children:(0,Zp.jsx)(zL,{paddingLeft:c?1.4:5,paddingRight:1,children:(0,Zp.jsx)(gd,{component:"div",children:(0,Zp.jsxs)(mL,{children:["Resource Type: ",(0,Zp.jsx)("br",{}),null===(n=e.feature)||void 0===n?void 0:n.properties.primary_fuel," ",(0,Zp.jsx)("br",{}),"Prduction Capacity [mw]:"," ",null===(r=e.feature)||void 0===r?void 0:r.properties.capacity_mw," ",(0,Zp.jsx)("br",{}),"Year of Commision:"," ",null!==(i=e.feature)&&void 0!==i&&i.properties.commissioning_year?parseInt(null===(o=e.feature)||void 0===o?void 0:o.properties.commissioning_year):"unkown"," ",(0,Zp.jsx)("br",{})]})})})}),(0,Zp.jsxs)(hL,{onClick:function(){d(!p)},children:[(0,Zp.jsx)(mL,{primary:"Location"}),p?(0,Zp.jsx)(OL.Z,{}):(0,Zp.jsx)(FL.Z,{})]}),(0,Zp.jsx)(SL,{in:p,timeout:"auto",unmountOnExit:!0,children:(0,Zp.jsx)(zL,{paddingLeft:c?1.4:5,paddingRight:1,children:(0,Zp.jsx)(gd,{component:"div",children:(0,Zp.jsxs)(mL,{children:["Country: ",null===(a=e.feature)||void 0===a?void 0:a.properties.country_long," ",(0,Zp.jsx)("br",{}),(0,Zp.jsx)("br",{}),"Latitude: ",null===(s=e.feature)||void 0===s?void 0:s.properties.latitude," ",(0,Zp.jsx)("br",{}),"Longitude: ",null===(u=e.feature)||void 0===u?void 0:u.properties.longitude," ",(0,Zp.jsx)("br",{})]})})})})]})}var jL=(0,Dp.ZP)("div")((function(t){var e=t.theme;return IM(IM({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-start"})}));function UL(t){var e,n,r=RM("(max-width:900px)"),i=RM("(max-height: 500px)"),o=Jd();return(0,Zp.jsx)(Zp.Fragment,{children:(0,Zp.jsxs)(XM,{transitionDuration:800,sx:r?{width:300,maxWidth:"50%",flexShrink:0,"& .MuiDrawer-paper":{width:i?{width:250}:{width:200},height:i?{height:305}:{height:500},backgroundColor:"#353535",color:"white",opacity:.75,marginTop:"80px",right:0}}:{width:300,maxWidth:"50%",flexShrink:0,"& .MuiDrawer-paper":{width:300,height:600,backgroundColor:"#353535",color:"white",opacity:.75,marginTop:"120px",right:10}},variant:"persistent",anchor:"right",open:t.open,children:[(0,Zp.jsxs)(jL,{children:[(0,Zp.jsx)(iL,{style:{position:"absolute",marginTop:"15px",backgroundColor:"#353535",color:"white",right:"0"},onClick:t.closeHandler,children:(o.direction,(0,Zp.jsx)(oL.Z,{}))}),(0,Zp.jsxs)(Zy,{variant:"body1",paddingTop:"5px",children:[null===(e=t.feature)||void 0===e?void 0:e.properties.name," ",(0,Zp.jsx)("br",{}),null===(n=t.feature)||void 0===n?void 0:n.properties.country_long]})]}),(0,Zp.jsx)(JM,{}),(0,Zp.jsx)(BL,{feature:t.feature})]})})}function VL(t){return(0,Up.Z)("MuiAppBar",t)}(0,jp.Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var ZL=["className","color","enableColorOnDark","position"],qL=function(t,e){return"".concat(null==t?void 0:t.replace(")",""),", ").concat(e,")")},GL=(0,Dp.ZP)(Dd,{name:"MuiAppBar",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e["position".concat((0,Op.Z)(n.position))],e["color".concat((0,Op.Z)(n.color))]]}})((function(t){var e=t.theme,n=t.ownerState,r="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,Ap.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===n.position&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===n.position&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===n.position&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"static"===n.position&&{position:"static"},"relative"===n.position&&{position:"relative"},!e.vars&&(0,Ap.Z)({},"default"===n.color&&{backgroundColor:r,color:e.palette.getContrastText(r)},n.color&&"default"!==n.color&&"inherit"!==n.color&&"transparent"!==n.color&&{backgroundColor:e.palette[n.color].main,color:e.palette[n.color].contrastText},"inherit"===n.color&&{color:"inherit"},"dark"===e.palette.mode&&!n.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===n.color&&(0,Ap.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"})),e.vars&&(0,Ap.Z)({},"default"===n.color&&{"--AppBar-background":n.enableColorOnDark?e.vars.palette.AppBar.defaultBg:qL(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":n.enableColorOnDark?e.vars.palette.text.primary:qL(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},n.color&&!n.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":n.enableColorOnDark?e.vars.palette[n.color].main:qL(e.vars.palette.AppBar.darkBg,e.vars.palette[n.color].main),"--AppBar-color":n.enableColorOnDark?e.vars.palette[n.color].contrastText:qL(e.vars.palette.AppBar.darkColor,e.vars.palette[n.color].contrastText)},{backgroundColor:"var(--AppBar-background)",color:"inherit"===n.color?"inherit":"var(--AppBar-color)"},"transparent"===n.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),WL=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiAppBar"}),r=n.className,i=n.color,o=void 0===i?"primary":i,a=n.enableColorOnDark,s=void 0!==a&&a,l=n.position,u=void 0===l?"fixed":l,c=(0,Pp.Z)(n,ZL),h=(0,Ap.Z)({},n,{color:o,position:u,enableColorOnDark:s}),f=function(t){var e=t.color,n=t.position,r=t.classes,i={root:["root","color".concat((0,Op.Z)(e)),"position".concat((0,Op.Z)(n))]};return(0,Lp.Z)(i,VL,r)}(h);return(0,Zp.jsx)(GL,(0,Ap.Z)({square:!0,component:"header",ownerState:h,elevation:4,className:(0,Mp.Z)(f.root,r,"fixed"===u&&"mui-fixed"),ref:e},c))})),XL=WL;function HL(t){return(0,Up.Z)("MuiButtonGroup",t)}var YL=(0,jp.Z)("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]),$L=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],KL=(0,Dp.ZP)("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[(0,s.Z)({},"& .".concat(YL.grouped),e.grouped),(0,s.Z)({},"& .".concat(YL.grouped),e["grouped".concat((0,Op.Z)(n.orientation))]),(0,s.Z)({},"& .".concat(YL.grouped),e["grouped".concat((0,Op.Z)(n.variant))]),(0,s.Z)({},"& .".concat(YL.grouped),e["grouped".concat((0,Op.Z)(n.variant)).concat((0,Op.Z)(n.orientation))]),(0,s.Z)({},"& .".concat(YL.grouped),e["grouped".concat((0,Op.Z)(n.variant)).concat((0,Op.Z)(n.color))]),e.root,e[n.variant],!0===n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,"vertical"===n.orientation&&e.vertical]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},"contained"===n.variant&&{boxShadow:(e.vars||e).shadows[2]},n.disableElevation&&{boxShadow:"none"},n.fullWidth&&{width:"100%"},"vertical"===n.orientation&&{flexDirection:"column"},(0,s.Z)({},"& .".concat(YL.grouped),(0,Ap.Z)({minWidth:40,"&:not(:first-of-type)":(0,Ap.Z)({},"horizontal"===n.orientation&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},"vertical"===n.orientation&&{borderTopRightRadius:0,borderTopLeftRadius:0},"outlined"===n.variant&&"horizontal"===n.orientation&&{marginLeft:-1},"outlined"===n.variant&&"vertical"===n.orientation&&{marginTop:-1}),"&:not(:last-of-type)":(0,Ap.Z)({},"horizontal"===n.orientation&&{borderTopRightRadius:0,borderBottomRightRadius:0},"vertical"===n.orientation&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},"text"===n.variant&&"horizontal"===n.orientation&&{borderRight:e.vars?"1px solid rgba(".concat(e.vars.palette.common.onBackgroundChannel," / 0.23)"):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"vertical"===n.orientation&&{borderBottom:e.vars?"1px solid rgba(".concat(e.vars.palette.common.onBackgroundChannel," / 0.23)"):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"inherit"!==n.color&&{borderColor:e.vars?"rgba(".concat(e.vars.palette[n.color].mainChannel," / 0.5)"):(0,Td.Fq)(e.palette[n.color].main,.5)},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"transparent"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"transparent"},"contained"===n.variant&&"horizontal"===n.orientation&&(0,s.Z)({borderRight:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(YL.disabled),{borderRight:"1px solid ".concat((e.vars||e).palette.action.disabled)}),"contained"===n.variant&&"vertical"===n.orientation&&(0,s.Z)({borderBottom:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(YL.disabled),{borderBottom:"1px solid ".concat((e.vars||e).palette.action.disabled)}),"contained"===n.variant&&"inherit"!==n.color&&{borderColor:(e.vars||e).palette[n.color].dark},{"&:hover":(0,Ap.Z)({},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"currentColor"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"currentColor"})}),"&:hover":(0,Ap.Z)({},"contained"===n.variant&&{boxShadow:"none"})},"contained"===n.variant&&{boxShadow:"none"})))})),JL=t.forwardRef((function(e,n){var r=(0,Rp.Z)({props:e,name:"MuiButtonGroup"}),i=r.children,o=r.className,a=r.color,s=void 0===a?"primary":a,l=r.component,u=void 0===l?"div":l,c=r.disabled,h=void 0!==c&&c,f=r.disableElevation,p=void 0!==f&&f,d=r.disableFocusRipple,m=void 0!==d&&d,g=r.disableRipple,v=void 0!==g&&g,y=r.fullWidth,_=void 0!==y&&y,x=r.orientation,b=void 0===x?"horizontal":x,w=r.size,S=void 0===w?"medium":w,E=r.variant,k=void 0===E?"outlined":E,C=(0,Pp.Z)(r,$L),I=(0,Ap.Z)({},r,{color:s,component:u,disabled:h,disableElevation:p,disableFocusRipple:m,disableRipple:v,fullWidth:_,orientation:b,size:S,variant:k}),T=function(t){var e=t.classes,n=t.color,r=t.disabled,i=t.disableElevation,o=t.fullWidth,a=t.orientation,s=t.variant,l={root:["root",s,"vertical"===a&&"vertical",o&&"fullWidth",i&&"disableElevation"],grouped:["grouped","grouped".concat((0,Op.Z)(a)),"grouped".concat((0,Op.Z)(s)),"grouped".concat((0,Op.Z)(s)).concat((0,Op.Z)(a)),"grouped".concat((0,Op.Z)(s)).concat((0,Op.Z)(n)),r&&"disabled"]};return(0,Lp.Z)(l,HL,e)}(I),P=t.useMemo((function(){return{className:T.grouped,color:s,disabled:h,disableElevation:p,disableFocusRipple:m,disableRipple:v,fullWidth:_,size:S,variant:k}}),[s,h,p,m,v,_,S,k,T.grouped]);return(0,Zp.jsx)(KL,(0,Ap.Z)({as:u,role:"group",className:(0,Mp.Z)(T.root,o),ref:n,ownerState:I},C,{children:(0,Zp.jsx)(r_.Provider,{value:P,children:i})}))})),QL=JL,tR=n(7267),eR=[{fuel:"Biomass",color:"#109540"},{fuel:"Coal",color:"#5c4033"},{fuel:"Gas",color:"#a450ff"},{fuel:"Geothermal",color:"#ee9000"},{fuel:"Hydro",color:"#0202ff"},{fuel:"Oil",color:"#010101"},{fuel:"Nuclear",color:"#ffff00"},{fuel:"Solar",color:"#92ff00"},{fuel:"Waste",color:"#aaaaaa"},{fuel:"Wind",color:"#50bbff"},{fuel:"Other",color:"#fff"}];function nR(e){var n=RM("(max-width:900px)"),r=RM("(max-height: 562px)"),i=(0,t.useCallback)((function(t){return function(n){var r=(0,a.Z)(e.toShow),i=r.indexOf(t);i>-1?r.splice(i,1):r.push(t),e.setToShow(r),console.log(e.toShow)}}),[e]);var o=function(){return eR.map((function(t){return(0,Zp.jsxs)(c_,{style:n?{opacity:e.toShow.includes(t.fuel)?.8:.2,backgroundColor:"#353535",color:"white",justifyContent:"left",width:105,height:22}:{opacity:e.toShow.includes(t.fuel)?.8:.2,backgroundColor:"#353535",color:"white",justifyContent:"left",width:200},onClick:i(t.fuel),children:[(0,Zp.jsx)(Zy,{variant:"h6",sx:n?{paddingLeft:3,fontSize:"10px"}:{paddingLeft:5},children:t.fuel}),(0,Zp.jsx)(tR.Z,{sx:{color:t.color,position:"absolute"}})]},t.fuel)}))};return(0,Zp.jsxs)(QL,{orientation:"vertical","aria-label":"vertical outlined button group",variant:"text",position:"right",children:[(0,Zp.jsx)(o,{}),r?(0,Zp.jsx)(Zp.Fragment,{}):(0,Zp.jsxs)(c_,{sx:n?{width:105,height:50,paddingTop:2,fontSize:"10px"}:{},onClick:function(){e.setToShow(["Biomass","Coal","Gas","Geothermal","Hydro","Nuclear","Oil","Solar","Waste","Wind","Other"])},children:[" ","Show all types"," "]})]})}function rR(e){var n=RM("(max-width:900px)"),r=(0,t.useState)(!1),i=(0,l.Z)(r,2),o=i[0],a=i[1];return(0,t.useEffect)((function(){a(!n)}),[n]),(0,Zp.jsx)(XL,{position:"fixed",sx:{borderStyle:"hidden",backgroundColor:"#353535",top:n?70:90,left:n?4:20,width:n?105:200,height:n?48:75,opacity:.8},children:(0,Zp.jsxs)(zL,{container:!0,children:[(0,Zp.jsx)(zL,{item:!0,xs:12,children:(0,Zp.jsx)(Zy,{sx:{fontSize:n?"10px":"20px",textAlign:"center",paddingTop:"10px"},children:"Fuel Types"})}),(0,Zp.jsx)(zL,{item:!0,xs:12,display:"flex",justifyContent:"center",children:(0,Zp.jsx)(iL,{sx:{color:"white",textAlign:"center",paddingTop:0},onClick:function(){return a(!o)},children:o?(0,Zp.jsx)(Zp.Fragment,{children:(0,Zp.jsx)(OL.Z,{fontSize:n?"small":"large"})}):(0,Zp.jsx)(FL.Z,{fontSize:n?"small":"large"})})}),o&&(0,Zp.jsx)(nR,{toShow:e.toShow,setToShow:e.setToShow})]})})}var iR=n(136),oR=n(9388),aR=n(1120);var sR,lR=n(8814);function uR(t,e,n){return uR=(0,lR.Z)()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&(0,Fd.Z)(i,n.prototype),i},uR.apply(null,arguments)}function cR(t){var e="function"===typeof Map?new Map:void 0;return cR=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return uR(t,arguments,(0,aR.Z)(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,Fd.Z)(r,t)},cR(t)}function hR(){return hR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hR.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(sR||(sR={}));var fR,pR="popstate";function dR(t){return{usr:t.state,key:t.key}}function mR(t,e,n,r){return void 0===n&&(n=null),hR({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?vR(e):e,{state:n,key:e&&e.key||r||Math.random().toString(36).substr(2,8)})}function gR(t){var e=t.pathname,n=void 0===e?"/":e,r=t.search,i=void 0===r?"":r,o=t.hash,a=void 0===o?"":o;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),a&&"#"!==a&&(n+="#"===a.charAt(0)?a:"#"+a),n}function vR(t){var e={};if(t){var n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));var r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function yR(t){var e="undefined"!==typeof window&&"undefined"!==typeof window.location&&"null"!==window.location.origin?window.location.origin:"unknown://unknown",n="string"===typeof t?t:gR(t);return new URL(n,e)}function _R(t,e,n,r){void 0===r&&(r={});var i=r,o=i.window,a=void 0===o?document.defaultView:o,s=i.v5Compat,l=void 0!==s&&s,u=a.history,c=sR.Pop,h=null;function f(){c=sR.Pop,h&&h({action:c,location:p.location})}var p={get action(){return c},get location(){return t(a,u)},listen:function(t){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(pR,f),h=t,function(){a.removeEventListener(pR,f),h=null}},createHref:function(t){return e(a,t)},encodeLocation:function(t){var e=yR(gR(t));return hR({},t,{pathname:e.pathname,search:e.search,hash:e.hash})},push:function(t,e){c=sR.Push;var r=mR(p.location,t,e);n&&n(r,t);var i=dR(r),o=p.createHref(r);try{u.pushState(i,"",o)}catch(s){a.location.assign(o)}l&&h&&h({action:c,location:p.location})},replace:function(t,e){c=sR.Replace;var r=mR(p.location,t,e);n&&n(r,t);var i=dR(r),o=p.createHref(r);u.replaceState(i,"",o),l&&h&&h({action:c,location:p.location})},go:function(t){return u.go(t)}};return p}function xR(t,e,n){void 0===n&&(n="/");var r=TR(("string"===typeof e?vR(e):e).pathname||"/",n);if(null==r)return null;var i=bR(t);!function(t){t.sort((function(t,e){return t.score!==e.score?e.score-t.score:function(t,e){var n=t.length===e.length&&t.slice(0,-1).every((function(t,n){return t===e[n]}));return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((function(t){return t.childrenIndex})),e.routesMeta.map((function(t){return t.childrenIndex})))}))}(i);for(var o=null,a=0;null==o&&a<i.length;++a)o=kR(i[a],IR(r));return o}function bR(t,e,n,r){return void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=""),t.forEach((function(t,i){var o={relativePath:t.path||"",caseSensitive:!0===t.caseSensitive,childrenIndex:i,route:t};o.relativePath.startsWith("/")&&(PR(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var a=DR([r,o.relativePath]),s=n.concat(o);t.children&&t.children.length>0&&(PR(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),bR(t.children,e,s,a)),(null!=t.path||t.index)&&e.push({path:a,score:ER(a,t.index),routesMeta:s})})),e}!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(fR||(fR={}));var wR=/^:\w+$/,SR=function(t){return"*"===t};function ER(t,e){var n=t.split("/"),r=n.length;return n.some(SR)&&(r+=-2),e&&(r+=2),n.filter((function(t){return!SR(t)})).reduce((function(t,e){return t+(wR.test(e)?3:""===e?1:10)}),r)}function kR(t,e){for(var n=t.routesMeta,r={},i="/",o=[],a=0;a<n.length;++a){var s=n[a],l=a===n.length-1,u="/"===i?e:e.slice(i.length)||"/",c=CR({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);var h=s.route;o.push({params:r,pathname:DR([i,c.pathname]),pathnameBase:NR(DR([i,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(i=DR([i,c.pathnameBase]))}return o}function CR(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});var n=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);AR("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');var r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(t,e){return r.push(e),"([^\\/]+)"}));t.endsWith("*")?(r.push("*"),i+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==t&&"/"!==t&&(i+="(?:(?=\\/|$))");return[new RegExp(i,e?void 0:"i"),r]}(t.path,t.caseSensitive,t.end),r=(0,l.Z)(n,2),i=r[0],o=r[1],a=e.match(i);if(!a)return null;var s=a[0],u=s.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:o.reduce((function(t,e,n){if("*"===e){var r=c[n]||"";u=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return t[e]=function(t,e){try{return decodeURIComponent(t)}catch(n){return AR(!1,'The value for the URL param "'+e+'" will not be decoded because the string "'+t+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),t}}(c[n]||"",e),t}),{}),pathname:s,pathnameBase:u,pattern:t}}function IR(t){try{return decodeURI(t)}catch(e){return AR(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function TR(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;var n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&"/"!==r?null:t.slice(n)||"/"}function PR(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function AR(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function MR(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function LR(t){return t.filter((function(t,e){return 0===e||t.route.path&&t.route.path.length>0}))}function RR(t,e,n,r){var i;void 0===r&&(r=!1),"string"===typeof t?i=vR(t):(PR(!(i=hR({},t)).pathname||!i.pathname.includes("?"),MR("?","pathname","search",i)),PR(!i.pathname||!i.pathname.includes("#"),MR("#","pathname","hash",i)),PR(!i.search||!i.search.includes("#"),MR("#","search","hash",i)));var o,a=""===t||""===i.pathname,s=a?"/":i.pathname;if(r||null==s)o=n;else{var l=e.length-1;if(s.startsWith("..")){for(var u=s.split("/");".."===u[0];)u.shift(),l-=1;i.pathname=u.join("/")}o=l>=0?e[l]:"/"}var c=function(t,e){void 0===e&&(e="/");var n="string"===typeof t?vR(t):t,r=n.pathname,i=n.search,o=void 0===i?"":i,a=n.hash,s=void 0===a?"":a,l=r?r.startsWith("/")?r:function(t,e){var n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((function(t){".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(r,e):e;return{pathname:l,search:zR(o),hash:OR(s)}}(i,o),h=s&&"/"!==s&&s.endsWith("/"),f=(a||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!h&&!f||(c.pathname+="/"),c}var DR=function(t){return t.join("/").replace(/\/\/+/g,"/")},NR=function(t){return t.replace(/\/+$/,"").replace(/^\/*/,"/")},zR=function(t){return t&&"?"!==t?t.startsWith("?")?t:"?"+t:""},OR=function(t){return t&&"#"!==t?t.startsWith("#")?t:"#"+t:""},FR=function(t){(0,iR.Z)(n,t);var e=(0,oR.Z)(n);function n(){return(0,vm.Z)(this,n),e.apply(this,arguments)}return(0,ym.Z)(n)}(cR(Error));var BR=(0,ym.Z)((function t(e,n,r){(0,vm.Z)(this,t),this.status=e,this.statusText=n||"",this.data=r}));function jR(t){return t instanceof BR}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var UR=new Set(["POST","PUT","PATCH","DELETE"]);new Set(["GET","HEAD"].concat((0,a.Z)(UR)));function VR(){return VR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VR.apply(this,arguments)}var ZR="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},qR=t.useState,GR=t.useEffect,WR=t.useLayoutEffect,XR=t.useDebugValue;function HR(t){var e=t.getSnapshot,n=t.value;try{var r=e();return!ZR(n,r)}catch(i){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement;var YR=t.createContext(null);var $R=t.createContext(null);var KR=t.createContext(null);var JR=t.createContext(null);var QR=t.createContext(null);var tD=t.createContext(null);var eD=t.createContext({outlet:null,matches:[]});var nD=t.createContext(null);function rD(){return null!=t.useContext(tD)}function iD(){return rD()||PR(!1),t.useContext(tD).location}function oD(){rD()||PR(!1);var e=t.useContext(QR),n=e.basename,r=e.navigator,i=t.useContext(eD).matches,o=iD().pathname,a=JSON.stringify(LR(i).map((function(t){return t.pathnameBase}))),s=t.useRef(!1);t.useEffect((function(){s.current=!0}));var l=t.useCallback((function(t,e){if(void 0===e&&(e={}),s.current)if("number"!==typeof t){var i=RR(t,JSON.parse(a),o,"path"===e.relative);"/"!==n&&(i.pathname="/"===i.pathname?n:DR([n,i.pathname])),(e.replace?r.replace:r.push)(i,e.state,e)}else r.go(t)}),[n,r,a,o]);return l}function aD(){var e=function(){var e,n=t.useContext(nD),r=fD(lD.UseRouteError),i=t.useContext(eD),o=i.matches[i.matches.length-1];if(n)return n;return i||PR(!1),!o.route.id&&PR(!1),null==(e=r.errors)?void 0:e[o.route.id]}(),n=jR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unhandled Thrown Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:o},r):null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own\xa0",t.createElement("code",{style:a},"errorElement")," props on\xa0",t.createElement("code",{style:a},"<Route>")))}var sD,lD,uD=function(e){(0,iR.Z)(r,e);var n=(0,oR.Z)(r);function r(t){var e;return(0,vm.Z)(this,r),(e=n.call(this,t)).state={location:t.location,error:t.error},e}return(0,ym.Z)(r,[{key:"componentDidCatch",value:function(t,e){console.error("React Router caught the following error during render",t,e)}},{key:"render",value:function(){return this.state.error?t.createElement(nD.Provider,{value:this.state.error,children:this.props.component}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(t){return{error:t}}},{key:"getDerivedStateFromProps",value:function(t,e){return e.location!==t.location?{error:t.error,location:t.location}:{error:t.error||e.error,location:e.location}}}]),r}(t.Component);function cD(e){var n=e.routeContext,r=e.match,i=e.children,o=t.useContext(YR);return o&&r.route.errorElement&&(o._deepestRenderedBoundaryId=r.route.id),t.createElement(eD.Provider,{value:n},i)}function hD(e,n,r){if(void 0===n&&(n=[]),null==e){if(null==r||!r.errors)return null;e=r.matches}var i=e,o=null==r?void 0:r.errors;if(null!=o){var a=i.findIndex((function(t){return t.route.id&&(null==o?void 0:o[t.route.id])}));a>=0||PR(!1),i=i.slice(0,Math.min(i.length,a+1))}return i.reduceRight((function(e,a,s){var l=a.route.id?null==o?void 0:o[a.route.id]:null,u=r?a.route.errorElement||t.createElement(aD,null):null,c=function(){return t.createElement(cD,{match:a,routeContext:{outlet:e,matches:n.concat(i.slice(0,s+1))}},l?u:void 0!==a.route.element?a.route.element:e)};return r&&(a.route.errorElement||0===s)?t.createElement(uD,{location:r.location,component:u,error:l,children:c()}):c()}),null)}function fD(e){var n=t.useContext(KR);return n||PR(!1),n}!function(t){t.UseRevalidator="useRevalidator"}(sD||(sD={})),function(t){t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator"}(lD||(lD={}));var pD;function dD(t){PR(!1)}function mD(e){var n=e.basename,r=void 0===n?"/":n,i=e.children,o=void 0===i?null:i,a=e.location,s=e.navigationType,l=void 0===s?sR.Pop:s,u=e.navigator,c=e.static,h=void 0!==c&&c;rD()&&PR(!1);var f=r.replace(/^\/*/,"/"),p=t.useMemo((function(){return{basename:f,navigator:u,static:h}}),[f,u,h]);"string"===typeof a&&(a=vR(a));var d=a,m=d.pathname,g=void 0===m?"/":m,v=d.search,y=void 0===v?"":v,_=d.hash,x=void 0===_?"":_,b=d.state,w=void 0===b?null:b,S=d.key,E=void 0===S?"default":S,k=t.useMemo((function(){var t=TR(g,f);return null==t?null:{pathname:t,search:y,hash:x,state:w,key:E}}),[f,g,y,x,w,E]);return null==k?null:t.createElement(QR.Provider,{value:p},t.createElement(tD.Provider,{children:o,value:{location:k,navigationType:l}}))}function gD(e){var n=e.children,r=e.location,i=t.useContext($R);return function(e,n){rD()||PR(!1);var r,i=t.useContext(KR),o=t.useContext(eD).matches,a=o[o.length-1],s=a?a.params:{},l=(a&&a.pathname,a?a.pathnameBase:"/"),u=(a&&a.route,iD());if(n){var c,h="string"===typeof n?vR(n):n;"/"===l||(null==(c=h.pathname)?void 0:c.startsWith(l))||PR(!1),r=h}else r=u;var f=r.pathname||"/",p=xR(e,{pathname:"/"===l?f:f.slice(l.length)||"/"}),d=hD(p&&p.map((function(t){return Object.assign({},t,{params:Object.assign({},s,t.params),pathname:DR([l,t.pathname]),pathnameBase:"/"===t.pathnameBase?l:DR([l,t.pathnameBase])})})),o,i||void 0);return n&&d?t.createElement(tD.Provider,{value:{location:VR({pathname:"/",search:"",hash:"",state:null,key:"default"},r),navigationType:sR.Pop}},d):d}(i&&!n?i.router.routes:yD(n),r)}!function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"}(pD||(pD={}));var vD=new Promise((function(){}));t.Component;function yD(e,n){void 0===n&&(n=[]);var r=[];return t.Children.forEach(e,(function(e,i){if(t.isValidElement(e))if(e.type!==t.Fragment){e.type!==dD&&PR(!1),e.props.index&&e.props.children&&PR(!1);var o=[].concat((0,a.Z)(n),[i]),s={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(s.children=yD(e.props.children,o)),r.push(s)}else r.push.apply(r,yD(e.props.children,n))})),r}var _D=void 0,xD=function(){var e=(0,t.useState)(!1),n=(0,l.Z)(e,2),r=n[0],i=n[1],o=TE({mapId:"map_1"}),a=(0,t.useState)(),s=(0,l.Z)(a,2),u=s[0],c=s[1],h=function(){var e=t.useContext(eD).matches,n=e[e.length-1];return n?n.params:{}}().searchWord,f=(0,t.useState)([-179.984,-62.877,180,73.122]),p=(0,l.Z)(f,2),d=p[0],m=p[1],g={},v=(0,t.useState)(["Biomass","Coal","Gas","Geothermal","Hydro","Nuclear","Oil","Solar","Waste","Wind","Other"]),y=(0,l.Z)(v,2),_=y[0],x=y[1],b=(0,t.useState)(),w=(0,l.Z)(b,2),S=w[0],E=w[1],k=(0,t.useState)(),C=(0,l.Z)(k,2),I=C[0],T=C[1];(0,t.useEffect)((function(){fetch("assets/Plant_data.json").then((function(t){return t.json()})).then((function(t){console.log(t),T(t)}))}),[]),(0,t.useEffect)((function(){null!==I&&void 0!==I&&I.features&&o.map&&(void 0!==h?function(){var t=I.features.filter((function(t){return t.properties.country_long.toUpperCase().includes(h.toUpperCase())}));if(E(t),t.length>0){var e=Math.ceil(t.length/2);console.log(e),o.map.map.flyTo({center:[t[e].properties.longitude,t[e].properties.latitude],zoom:4})}else t=I.features.filter((function(t){return t.properties.name.toUpperCase().includes(h.toUpperCase())})),E(t),console.log(t),t.length>0&&o.map.map.flyTo({center:[t[0].properties.longitude,t[0].properties.latitude],zoom:6})}():(E(void 0),A(0,0)))}),[h,I,o.map]);var P=(0,t.useMemo)((function(){return(null===S||void 0===S?void 0:S.length)>0?(g.type="FeatureCollection",g.name="results",g.features=S,g.bbox=d,g.crs={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},m(g),g):I}),[S,h,I]);function A(t,e){var n;0===t&&0===e?null===(n=o.map)||void 0===n||n.map.flyTo({center:[e,t],zoom:2}):o.map.map.flyTo({center:[e,t],zoom:7})}function M(){o.map.setFeatureState({source:"Plant_data",id:_D},{selected:!1}),_D=void 0}return function(e){var n=TE({mapId:e.mapId});(0,t.useEffect)((function(){if(n.map&&e.layerId&&e.filter&&n.map.map.getLayer(e.layerId)){var t=e.layerId;return n.map.map.setFilter(t,e.filter),function(){n.map&&n.map.map.setFilter(t,null)}}}),[e,n.map])}({layerId:"Plant_data",filter:["in",["get","primary_fuel"],["literal",_]]}),(0,Zp.jsxs)(Zp.Fragment,{children:[(0,Zp.jsx)(bA,{type:"circle",mapId:"map_1",layerId:"Plant_data",geojson:P,onClick:function(t){console.log("click"),_D||u?_D!==t.features[0].id?(M(),c(t.features[0]),_D=t.features[0].id,i(!0),o.map.setFeatureState({source:"Plant_data",id:_D},{selected:!0}),A(t.features[0].properties.latitude,t.features[0].properties.longitude)):_D===t.features[0].id&&(M(),i(!1),A(0,0)):(_D=t.features[0].id,c(t.features[0]),i(!0),o.map.setFeatureState({source:"Plant_data",id:_D},{selected:!0}),o.map.map.flyTo({center:[t.features[0].properties.longitude,t.features[0].properties.latitude],zoom:8}))},paint:{"circle-color":{property:"primary_fuel",type:"categorical",default:"#fff",stops:[["Biomass","#109540"],["Coal","#5c4033"],["Gas","#a450ff"],["Geothermal","#ee9000"],["Hydro","#0202ff"],["Oil","#000"],["Nuclear","#ffff00"],["Solar","#92ff00"],["Waste","#999999"],["Wind","#50bbff"],["Other","#fff"]]},"circle-stroke-color":["case",["boolean",["feature-state","selected"],!1],["case",["==",["get","primary_fuel"],"Oil"],"grey","black"],"silver"],"circle-stroke-width":["case",["boolean",["feature-state","selected"],!1],7,.5],"circle-radius":{property:"capacity_mw",stops:[[{zoom:2,value:1},2],[{zoom:2,value:3e3},10],[{zoom:2,value:22500},23],[{zoom:16,value:1},10],[{zoom:16,value:3e3},100],[{zoom:16,value:22500},230]]}}}),(0,Zp.jsx)(rR,{toShow:_,setToShow:x}),(0,Zp.jsx)(UL,{open:r,closeHandler:function(){i(!1),c(void 0),o.map.setFeatureState({source:"Plant_data",id:_D},{selected:!1}),A(0,0)},feature:u})]})},bD=n(5917),wD=n(104),SD=["className","component"];var ED=n(5902),kD=n(1979),CD=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultTheme,r=e.defaultClassName,i=void 0===r?"MuiBox-root":r,o=e.generateClassName,a=(0,bD.ZP)("div",{shouldForwardProp:function(t){return"theme"!==t&&"sx"!==t&&"as"!==t}})(wD.Z),s=t.forwardRef((function(t,e){var r=(0,$d.Z)(n),s=zy(t),l=s.className,u=s.component,c=void 0===u?"div":u,h=(0,Ry.Z)(s,SD);return(0,Zp.jsx)(a,(0,Ly.Z)({as:c,ref:e,className:(0,Mp.Z)(l,o?o(i):i),theme:r},h))}));return s}({defaultTheme:(0,kD.Z)(),defaultClassName:"MuiBox-root",generateClassName:ED.Z.generate}),ID=CD;function TD(t){return(0,Up.Z)("MuiToolbar",t)}(0,jp.Z)("MuiToolbar",["root","gutters","regular","dense"]);var PD=["className","component","disableGutters","variant"],AD=(0,Dp.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,Ap.Z)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&(0,s.Z)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),"dense"===n.variant&&{minHeight:48})}),(function(t){var e=t.theme;return"regular"===t.ownerState.variant&&e.mixins.toolbar})),MD=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiToolbar"}),r=n.className,i=n.component,o=void 0===i?"div":i,a=n.disableGutters,s=void 0!==a&&a,l=n.variant,u=void 0===l?"regular":l,c=(0,Pp.Z)(n,PD),h=(0,Ap.Z)({},n,{component:o,disableGutters:s,variant:u}),f=function(t){var e=t.classes,n={root:["root",!t.disableGutters&&"gutters",t.variant]};return(0,Lp.Z)(n,TD,e)}(h);return(0,Zp.jsx)(AD,(0,Ap.Z)({as:o,className:(0,Mp.Z)(f.root,r),ref:e,ownerState:h},c))})),LD=MD,RD=n(5403),DD=n(6248);function ND(t){return(0,Up.Z)("MuiFormHelperText",t)}var zD,OD=(0,jp.Z)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),FD=["children","className","component","disabled","error","filled","focused","margin","required","variant"],BD=(0,Dp.ZP)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.size&&e["size".concat((0,Op.Z)(n.size))],n.contained&&e.contained,n.filled&&e.filled]}})((function(t){var e,n=t.theme,r=t.ownerState;return(0,Ap.Z)({color:(n.vars||n).palette.text.secondary},n.typography.caption,(e={textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0},(0,s.Z)(e,"&.".concat(OD.disabled),{color:(n.vars||n).palette.text.disabled}),(0,s.Z)(e,"&.".concat(OD.error),{color:(n.vars||n).palette.error.main}),e),"small"===r.size&&{marginTop:4},r.contained&&{marginLeft:14,marginRight:14})})),jD=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiFormHelperText"}),r=n.children,i=n.className,o=n.component,a=void 0===o?"p":o,s=(0,Pp.Z)(n,FD),l=Hp({props:n,muiFormControl:Yp(),states:["variant","size","disabled","error","filled","focused","required"]}),u=(0,Ap.Z)({},n,{component:a,contained:"filled"===l.variant||"outlined"===l.variant,variant:l.variant,size:l.size,disabled:l.disabled,error:l.error,filled:l.filled,focused:l.focused,required:l.required}),c=function(t){var e=t.classes,n=t.contained,r=t.size,i=t.disabled,o=t.error,a=t.filled,s=t.focused,l=t.required,u={root:["root",i&&"disabled",o&&"error",r&&"size".concat((0,Op.Z)(r)),n&&"contained",s&&"focused",a&&"filled",l&&"required"]};return(0,Lp.Z)(u,ND,e)}(u);return(0,Zp.jsx)(BD,(0,Ap.Z)({as:a,ownerState:u,className:(0,Mp.Z)(c.root,i),ref:e},s,{children:" "===r?zD||(zD=(0,Zp.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))})),UD=jD;function VD(t){return(0,Up.Z)("MuiTextField",t)}(0,jp.Z)("MuiTextField",["root"]);var ZD=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],qD={standard:gv,filled:Ev,outlined:Ov},GD=(0,Dp.ZP)(Xp,{name:"MuiTextField",slot:"Root",overridesResolver:function(t,e){return e.root}})({}),WD=t.forwardRef((function(t,e){var n=(0,Rp.Z)({props:t,name:"MuiTextField"}),r=n.autoComplete,i=n.autoFocus,o=void 0!==i&&i,a=n.children,s=n.className,l=n.color,u=void 0===l?"primary":l,c=n.defaultValue,h=n.disabled,f=void 0!==h&&h,p=n.error,d=void 0!==p&&p,m=n.FormHelperTextProps,g=n.fullWidth,v=void 0!==g&&g,y=n.helperText,_=n.id,x=n.InputLabelProps,b=n.inputProps,w=n.InputProps,S=n.inputRef,E=n.label,k=n.maxRows,C=n.minRows,I=n.multiline,T=void 0!==I&&I,P=n.name,A=n.onBlur,M=n.onChange,L=n.onFocus,R=n.placeholder,D=n.required,N=void 0!==D&&D,z=n.rows,O=n.select,F=void 0!==O&&O,B=n.SelectProps,j=n.type,U=n.value,V=n.variant,Z=void 0===V?"outlined":V,q=(0,Pp.Z)(n,ZD),G=(0,Ap.Z)({},n,{autoFocus:o,color:u,disabled:f,error:d,fullWidth:v,multiline:T,required:N,select:F,variant:Z}),W=function(t){var e=t.classes;return(0,Lp.Z)({root:["root"]},VD,e)}(G);var X={};"outlined"===Z&&(x&&"undefined"!==typeof x.shrink&&(X.notched=x.shrink),X.label=E),F&&(B&&B.native||(X.id=void 0),X["aria-describedby"]=void 0);var H=(0,DD.Z)(_),Y=y&&H?"".concat(H,"-helper-text"):void 0,$=E&&H?"".concat(H,"-label"):void 0,K=qD[Z],J=(0,Zp.jsx)(K,(0,Ap.Z)({"aria-describedby":Y,autoComplete:r,autoFocus:o,defaultValue:c,fullWidth:v,multiline:T,name:P,rows:z,maxRows:k,minRows:C,type:j,value:U,id:H,inputRef:S,onBlur:A,onChange:M,onFocus:L,placeholder:R,inputProps:b},X,w));return(0,Zp.jsxs)(GD,(0,Ap.Z)({className:(0,Mp.Z)(W.root,s),disabled:f,error:d,fullWidth:v,ref:e,required:N,color:u,variant:Z,ownerState:G},q,{children:[null!=E&&""!==E&&(0,Zp.jsx)(sd,(0,Ap.Z)({htmlFor:H,id:$},x,{children:E})),F?(0,Zp.jsx)(qv,(0,Ap.Z)({"aria-describedby":Y,id:H,labelId:$,value:U,input:J},B,{children:a})):J,y&&(0,Zp.jsx)(UD,(0,Ap.Z)({id:Y},m,{children:y}))]}))})),XD=WD,HD=window.location.pathname;function YD(){var e=(0,t.useState)(""),n=(0,l.Z)(e,2),r=n[0],i=n[1],o=(0,t.useState)(!1),a=(0,l.Z)(o,2),s=a[0],u=a[1],c=RM("(max-width:900px)");(0,t.useEffect)((function(){0===r.length&&u(!1)}),[r]);var h=oD();function f(){h(HD+r)}return(0,Zp.jsxs)(Zp.Fragment,{children:[s&&(0,Zp.jsx)(c_,{variant:"contained",onClick:function(){h(HD),i("")},children:(0,Zp.jsx)(oL.Z,{style:{color:"white"}})}),(0,Zp.jsx)(XD,{variant:"outlined",sx:{paddingRight:"4px",paddingLeft:"4px",paddingTop:"2px",paddingBottom:"2px",width:c?"40%":"15%",backgroundColor:"#fff"},size:"small",id:"input",value:r,placeholder:"Search...",onChange:function(t){t.preventDefault(),i(t.target.value),u(!0)},onKeyDown:function(t){"Enter"===t.key&&f()}}),(0,Zp.jsx)(iL,{"aria-label":"search",type:"submit",onClick:f,children:(0,Zp.jsx)(RD.Z,{style:{color:"white"}})})]})}function $D(){var t=RM("(max-width:900px)");return(0,Zp.jsx)(ID,{sx:{flexGrow:1},children:(0,Zp.jsx)(XL,{position:"fixed",children:(0,Zp.jsxs)(LD,{children:[(0,Zp.jsx)(Zy,{variant:t?"body2":"h6",noWrap:!0,component:"div",sx:{flexGrow:51,display:{xs:"block",sm:"block"}},children:t?"Powerplants":"Energy generation across the globe"}),(0,Zp.jsx)(YD,{})]})})})}var KD=n.p+"static/media/tonerpic.f953a04713cd594e3a80.png",JD=n.p+"static/media/terrainpic.1d1659e18a4170c2ff4d.png",QD=n.p+"static/media/watercolorpic.85c9afe024c65bfdca54.jpg",tN=n(2017),eN=n(3385);function nN(e){var n=(0,t.useState)(e.current),r=(0,l.Z)(n,2),i=r[0],o=r[1],a=RM("(max-height: 562px)");return(0,t.useEffect)((function(){e.current!==i&&e.setter(i)}),[i]),(0,Zp.jsx)(Zp.Fragment,{children:(0,Zp.jsxs)(ID,{sx:{position:"fixed",bottom:a?4:38,left:a?120:4,height:100,width:140,opacity:.8,zIndex:110,display:"flex",justifyContent:"center",backgroundColor:"#353535"},children:[(0,Zp.jsx)(iL,{onClick:function(){o(0===i?e.options.length-1:i-1)},children:(0,Zp.jsx)(tN.Z,{color:"secondary"})}),(0,Zp.jsx)(c_,{onClick:function(){return e.setter(i)},children:(0,Zp.jsx)("img",{src:e.options[i].image,alt:e.options[i].title,style:{width:88,height:88,opacity:1}})}),(0,Zp.jsx)(iL,{onClick:function(){i===e.options.length-1?o(0):o(i+1)},children:(0,Zp.jsx)(eN.Z,{color:"secondary"})})]})})}var rN=n(9210),iN={width:100,height:100};function oN(e){var n=(0,t.useState)(!1),r=(0,l.Z)(n,2),i=r[0],o=r[1],a=function(){return(0,Zp.jsx)(Zp.Fragment,{children:e.options.map((function(n,r){return(0,Zp.jsx)(t.Fragment,{children:i|e.current===r?(0,Zp.jsx)(c_,{onClick:function(){e.setter(r)},children:(0,Zp.jsx)("img",{src:n.image,alt:n.title+"_layer",style:IM({opacity:r===e.current?e.disabled?.7:1:.7},iN)})},r):(0,Zp.jsx)(Zp.Fragment,{})},r)}))})};return(0,Zp.jsx)(Zp.Fragment,{children:(0,Zp.jsx)(XL,{position:"fixed",sx:{top:"auto",bottom:33,right:100,width:i?410:180,height:115,opacity:.8},children:(0,Zp.jsxs)(zL,{container:!0,children:[(0,Zp.jsx)(zL,{item:!0,children:(0,Zp.jsx)(c_,{sx:{height:115,paddingRight:3},onClick:function(){return o(!i)},children:(0,Zp.jsx)(rN.Z,{color:"secondary",sx:{alignSelf:"center",transform:"rotate(90deg)"}})})}),(0,Zp.jsx)(zL,{item:!0,position:"fixed",alignItems:"flex-end",marginLeft:5,children:(0,Zp.jsx)(a,{})})]})})})}var aN=[{title:"toner",image:KD,link:"https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{title:"terrain",image:JD,link:"https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg"},{title:"watercolor",image:QD,link:"https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"}];function sN(){var e=(0,t.useState)(1),n=(0,l.Z)(e,2),r=n[0],i=n[1],o=(0,t.useState)(aN[r].title),a=(0,l.Z)(o,2),s=a[0],u=a[1],c=(0,t.useState)(!1),h=(0,l.Z)(c,2),f=h[0],p=h[1],d=RM("(max-width:900px)"),m=function(t){t===r?p(!f):(i(t),u(aN[t].title),p(!1))},g=function(){return(0,Zp.jsx)(Zp.Fragment,{children:null===aN||void 0===aN?void 0:aN.map((function(t,e){return(0,Zp.jsx)(vM,{url:t.link,visible:s===t.title,insertBeforeLayer:"Plant_data",urlParameters:{layers:""}},t.title+"_"+e)}))})};return(0,Zp.jsxs)(Zp.Fragment,{children:[!f&&(0,Zp.jsx)(g,{}),d?(0,Zp.jsx)(nN,{options:aN,setter:m,current:r}):(0,Zp.jsx)(oN,{options:aN,setter:m,current:r,disabled:f})]})}function lN(){return lN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lN.apply(this,arguments)}var uN=n(8023),cN=n(9598),hN="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";var fN=function(e){var n=e.children,r=e.theme,i=(0,cN.Z)(),o=t.useMemo((function(){var t=null===i?r:function(t,e){return"function"===typeof e?e(t):lN({},t,e)}(i,r);return null!=t&&(t[hN]=null!==i),t}),[r,i]);return(0,Zp.jsx)(uN.Z.Provider,{value:o,children:n})},pN={};function dN(t){var e=(0,$d.Z)();return(0,Zp.jsx)(Dn.T.Provider,{value:"object"===typeof e?e:pN,children:t.children})}var mN=function(t){var e=t.children,n=t.theme;return(0,Zp.jsx)(fN,{theme:n,children:(0,Zp.jsx)(dN,{children:e})})},gN=(0,kD.Z)({palette:{primary:{main:"#353535"},secondary:{main:"#fafbfc"}}}),vN=window.location.pathname;var yN=function(){var t=RM("(max-width:900px)");return(0,Zp.jsx)(Zp.Fragment,{children:(0,Zp.jsxs)(mN,{theme:gN,children:[(0,Zp.jsx)(CE,{mapId:"map_1",options:{zoom:1.8,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[0,0]}}),(0,Zp.jsx)($D,{}),(0,Zp.jsx)(sN,{}),t?(0,Zp.jsx)(mM,{mapId:"map1",showZoomButtons:!1}):(0,Zp.jsx)(mM,{mapId:"map1",showZoomButtons:!0}),(0,Zp.jsxs)(gD,{children:[(0,Zp.jsx)(dD,{path:vN+":searchWord",element:(0,Zp.jsx)(xD,{})}),(0,Zp.jsx)(dD,{path:vN+"",element:(0,Zp.jsx)(xD,{})})]})]})})},_N=function(t){t&&t instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),r(t),i(t),o(t),a(t)}))};function xN(e){var n,r=e.basename,i=e.children,o=e.window,a=t.useRef();null==a.current&&(a.current=(void 0===(n={window:o,v5Compat:!0})&&(n={}),_R((function(t,e){var n=t.location;return mR("",{pathname:n.pathname,search:n.search,hash:n.hash},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:gR(e)}),null,n)));var s=a.current,u=t.useState({action:s.action,location:s.location}),c=(0,l.Z)(u,2),h=c[0],f=c[1];return t.useLayoutEffect((function(){return s.listen(f)}),[s]),t.createElement(mD,{basename:r,children:i,location:h.location,navigationType:h.action,navigator:s})}var bN,wN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(bN||(bN={})),function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(wN||(wN={}));r.render((0,Zp.jsx)(t.StrictMode,{children:(0,Zp.jsx)(xN,{children:(0,Zp.jsx)(EE,{children:(0,Zp.jsx)(yN,{})})})}),document.getElementById("root")),_N()}()}();
//# sourceMappingURL=main.69a63e80.js.map